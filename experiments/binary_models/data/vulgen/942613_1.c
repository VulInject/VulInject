gprel32_with_gp ( , , , , , , ) { bfd_vma relocation ; unsigned long val ; if ( bfd_is_com_section ( symbol -> section ) ) { relocation = 0 ; } else { relocation = symbol -> value ; } relocation += symbol -> section -> output_section -> vma ; relocation += symbol -> section -> output_offset ; if ( reloc_entry -> howto -> src_mask == 0 ) { val = 0 ; } else { val = bfd_get_32 ( abfd , ( bfd_byte * ) data + reloc_entry -> address ) ; } val += reloc_entry -> addend ; if ( ! relocatable || ( symbol -> flags & BSF_SECTION_SYM ) != 0 ) { val += relocation - gp ; } bfd_put_32 ( abfd , val , ( bfd_byte * ) data + reloc_entry -> address ) ; if ( relocatable ) { reloc_entry -> address += input_section -> output_offset ; } return bfd_reloc_ok ; } 