static krb5_error_code krb5int_cc_getops ( krb5_context context , const char * pfx , const krb5_cc_ops * * ops ) { struct krb5_cc_typelist * tlist ; k5_mutex_lock ( & cc_typelist_lock ) ; for ( tlist = cc_typehead ; tlist ; tlist = tlist -> next ) { if ( strcmp ( tlist -> ops -> prefix , pfx ) == 0 ) { * ops = tlist -> ops ; k5_mutex_unlock ( & cc_typelist_lock ) ; return 0 ; } } k5_mutex_unlock ( & cc_typelist_lock ) ; if ( krb5_cc_dfl_ops && ! strcmp ( pfx , krb5_cc_dfl_ops -> prefix ) ) { return 0 ; } return KRB5_CC_UNKNOWN_TYPE ; } 