char * print_hw_addr ( int htype , int hlen , unsigned char * data ) { static char habuf [ 49 ] ; char * s = habuf ; int i , j , slen = sizeof ( habuf ) ; if ( htype == 0 || hlen == 0 ) { bad strlcpy ( habuf , "<null>" , sizeof habuf ) ; return habuf ; } for ( i = 0 ; i < hlen ; i ++ ) { j = snprintf ( s , slen , "%02x" , data [ i ] ) ; if ( j <= 0 || j >= slen ) { bad } s += j ; slen -= ( j + 1 ) ; * s ++ = ':' ; } * -- s = '\0' ; return habuf ; } 