static int av1394_pcr_remote_read ( av1394_inst_t * avp , int ph , uint32_t * valp ) { cmd1394_cmd_t * cmd ; int ret = 0 ; int err ; ret = t1394_alloc_cmd ( avp -> av_t1394_hdl , 0 , & cmd ) ; if ( ret != DDI_SUCCESS ) { return ( ENOMEM ) ; } cmd -> cmd_addr = av1394_pcr_idx2addr ( av1394_pcr_ph2idx ( ph ) ) ; cmd -> cmd_type = CMD1394_ASYNCH_RD_QUAD ; if ( ( ( err = t1394_read ( avp -> av_t1394_hdl , cmd ) ) == DDI_SUCCESS ) && ( cmd -> cmd_result == CMD1394_CMDSUCCESS ) ) { * valp = cmd -> cmd_u . q . quadlet_data ; } else { ret = EIO ; } err = t1394_free_cmd ( avp -> av_t1394_hdl , 0 , & cmd ) ; ASSERT ( err == DDI_SUCCESS ) ; return ( ret ) ; } 