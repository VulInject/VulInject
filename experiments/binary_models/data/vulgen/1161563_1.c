ulong_t dtrace_getreg ( struct regs * rp , uint_t reg ) { if ( reg <= SS ) { if ( reg >= sizeof ( dtrace_regmap ) / sizeof ( int ) ) { return ( 0 ) ; } reg = dtrace_regmap [ reg ] ; } else { reg -= SS + 1 ; } switch ( reg ) { case REG_RDI : return ( rp -> r_rdi ) ; case REG_RSI : return ( rp -> r_rsi ) ; case REG_RDX : return ( rp -> r_rdx ) ; case REG_RCX : return ( rp -> r_rcx ) ; case REG_R8 : return ( rp -> r_r8 ) ; case REG_R9 : return ( rp -> r_r9 ) ; case REG_RAX : return ( rp -> r_rax ) ; case REG_RBX : return ( rp -> r_rbx ) ; case REG_RBP : return ( rp -> r_rbp ) ; case REG_R10 : return ( rp -> r_r10 ) ; case REG_R11 : return ( rp -> r_r11 ) ; case REG_R12 : return ( rp -> r_r12 ) ; case REG_R13 : return ( rp -> r_r13 ) ; case REG_R14 : return ( rp -> r_r14 ) ; case REG_R15 : return ( rp -> r_r15 ) ; case REG_DS : return ( rp -> r_ds ) ; case REG_ES : return ( rp -> r_es ) ; case REG_FS : return ( rp -> r_fs ) ; case REG_GS : return ( rp -> r_gs ) ; case REG_TRAPNO : return ( rp -> r_trapno ) ; case REG_ERR : return ( rp -> r_err ) ; case REG_RIP : return ( rp -> r_rip ) ; case REG_CS : return ( rp -> r_cs ) ; case REG_SS : return ( rp -> r_ss ) ; case REG_RFL : return ( rp -> r_rfl ) ; case REG_RSP : return ( rp -> r_rsp ) ; default : DTRACE_CPUFLAG_SET ( CPU_DTRACE_ILLOP ) ; return ( 0 ) ; } } 