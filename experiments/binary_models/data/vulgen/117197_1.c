void proto_register_sv ( void ) { static hf_register_info hf [ ] { { & hf_sv_appid { "APPID" "sv.appid" FT_UINT16 BASE_HEX NULL 0x0 NULL HFILL } } { & hf_sv_length { "Length" "sv.length" FT_UINT16 BASE_DEC NULL 0x0 NULL HFILL } } { & hf_sv_reserve1 { "Reserved 1" "sv.reserve1" FT_UINT16 BASE_HEX_DEC NULL 0x0 NULL HFILL } } { & hf_sv_reserve1_s_bit { "Simulated" "sv.reserve1.s_bit" FT_BOOLEAN 16 NULL F_RESERVE1_S_BIT NULL HFILL } } { & hf_sv_reserve2 { "Reserved 2" "sv.reserve2" FT_UINT16 BASE_HEX_DEC NULL 0x0 NULL HFILL } } { & hf_sv_phmeas_instmag_i { "value" "sv.meas_value" FT_INT32 BASE_DEC NULL 0x0 NULL HFILL } } { & hf_sv_phsmeas_q { "quality" "sv.meas_quality" FT_UINT32 BASE_HEX NULL 0x0 NULL HFILL } } { & hf_sv_phsmeas_q_validity { "validity" "sv.meas_quality.validity" FT_UINT32 BASE_HEX VALS ( sv_q_validity_vals ) Q_VALIDITY_MASK NULL HFILL } } { & hf_sv_phsmeas_q_overflow { "overflow" "sv.meas_quality.overflow" FT_BOOLEAN 32 NULL Q_OVERFLOW NULL HFILL } } { & hf_sv_phsmeas_q_outofrange { "out of range" "sv.meas_quality.outofrange" FT_BOOLEAN 32 NULL Q_OUTOFRANGE NULL HFILL } } { & hf_sv_phsmeas_q_badreference { "bad reference" "sv.meas_quality.badreference" FT_BOOLEAN 32 NULL Q_BADREFERENCE NULL HFILL } } { & hf_sv_phsmeas_q_oscillatory { "oscillatory" "sv.meas_quality.oscillatory" FT_BOOLEAN 32 NULL Q_OSCILLATORY NULL HFILL } } { & hf_sv_phsmeas_q_failure { "failure" "sv.meas_quality.failure" FT_BOOLEAN 32 NULL Q_FAILURE NULL HFILL } } { & hf_sv_phsmeas_q_olddata { "old data" "sv.meas_quality.olddata" FT_BOOLEAN 32 NULL Q_OLDDATA NULL HFILL } } { & hf_sv_phsmeas_q_inconsistent { "inconsistent" "sv.meas_quality.inconsistent" FT_BOOLEAN 32 NULL Q_INCONSISTENT NULL HFILL } } { & hf_sv_phsmeas_q_inaccurate { "inaccurate" "sv.meas_quality.inaccurate" FT_BOOLEAN 32 NULL Q_INACCURATE NULL HFILL } } { & hf_sv_phsmeas_q_source { "source" "sv.meas_quality.source" FT_UINT32 BASE_HEX VALS ( sv_q_source_vals ) Q_SOURCE_MASK NULL HFILL } } { & hf_sv_phsmeas_q_test { "test" "sv.meas_quality.test" FT_BOOLEAN 32 NULL Q_TEST NULL HFILL } } { & hf_sv_phsmeas_q_operatorblocked { "operator blocked" "sv.meas_quality.operatorblocked" FT_BOOLEAN 32 NULL Q_OPERATORBLOCKED NULL HFILL } } { & hf_sv_phsmeas_q_derived { "derived" "sv.meas_quality.derived" FT_BOOLEAN 32 NULL Q_DERIVED NULL HFILL } } { & hf_sv_gmidentity { "gmIdentity" "sv.gmidentity" FT_UINT64 BASE_HEX NULL 0x00 NULL HFILL } } { & hf_sv_gmidentity_manuf { "MAC Vendor" "sv.gmidentity_manuf" FT_BYTES BASE_NONE NULL 0x00 NULL HFILL } } } ; ; static gint * ett [ ] { & ett_sv & ett_phsmeas & ett_phsmeas_q & ett_gmidentity & ett_reserve1 } ; ; static ei_register_info ei [ ] { { & ei_sv_mal_utctime { "sv.malformed.utctime" PI_MALFORMED PI_WARN "BER Error: malformed UTCTime encoding" EXPFILL } } { & ei_sv_zero_pdu { "sv.zero_pdu" PI_PROTOCOL PI_ERROR "Internal error, zero-byte SV PDU" EXPFILL } } { & ei_sv_mal_gmidentity { "sv.malformed.gmidentity" PI_MALFORMED PI_WARN "BER Error: malformed gmIdentity encoding" EXPFILL } } } ; ; expert_module_t * expert_sv ; module_t * sv_module ; proto_sv = proto_register_protocol ( PNAME , PSNAME , PFNAME ) ; sv_handle = register_dissector ( "sv" , dissect_sv , proto_sv ) ; proto_register_field_array ( proto_sv , hf , array_length ( hf ) ) ; proto_register_subtree_array ( ett , array_length ( ett ) ) ; expert_sv = expert_register_protocol ( proto_sv ) ; expert_register_field_array ( expert_sv , ei , array_length ( ei ) ) ; sv_module = prefs_register_protocol ( proto_sv , NULL ) ; sv_tap = register_tap ( "sv" ) ; } 