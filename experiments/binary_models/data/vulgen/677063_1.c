static int kfd_gws_init ( struct kfd_dev * kfd ) { int ret = 0 ; if ( hws_gws_support || ( KFD_IS_SOC15 ( kfd ) && ( ( KFD_GC_VERSION ( kfd ) == IP_VERSION ( 9 , 0 , 1 ) && kfd -> mec2_fw_version >= 0x81b3 ) || ( KFD_GC_VERSION ( kfd ) <= IP_VERSION ( 9 , 4 , 0 ) && kfd -> mec2_fw_version >= 0x1b3 ) || ( KFD_GC_VERSION ( kfd ) == IP_VERSION ( 9 , 4 , 1 ) && kfd -> mec2_fw_version >= 0x30 ) || ( KFD_GC_VERSION ( kfd ) == IP_VERSION ( 9 , 4 , 2 ) && kfd -> mec2_fw_version >= 0x28 ) ) ) ) { ret = amdgpu_amdkfd_alloc_gws ( kfd -> adev , kfd -> adev -> gds . gws_size , & kfd -> gws ) ; } return ret ; } 