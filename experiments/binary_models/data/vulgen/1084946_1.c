void usbtv_video_free ( struct usbtv * usbtv ) { mutex_lock ( & usbtv -> vb2q_lock ) ; mutex_lock ( & usbtv -> v4l2_lock ) ; usbtv_stop ( usbtv ) ; vb2_video_unregister_device ( & usbtv -> vdev ) ; v4l2_device_disconnect ( & usbtv -> v4l2_dev ) ; mutex_unlock ( & usbtv -> vb2q_lock ) ; v4l2_device_put ( & usbtv -> v4l2_dev ) ; } 