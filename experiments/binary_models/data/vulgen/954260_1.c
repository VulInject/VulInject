static int clu_set_table ( struct vsp1_clu * clu , struct v4l2_ctrl * ctrl ) { struct vsp1_dl_body * dlb ; dlb = vsp1_dl_body_get ( clu -> pool ) ; if ( ! dlb ) { return - ENOMEM ; } vsp1_dl_body_write ( dlb , VI6_CLU_ADDR , 0 ) ; for ( i = 0 ; i < CLU_SIZE ; ++ i ) { vsp1_dl_body_write ( dlb , VI6_CLU_DATA , ctrl -> p_new . p_u32 [ i ] ) ; } spin_lock_irq ( & clu -> lock ) ; swap ( clu -> clu , dlb ) ; spin_unlock_irq ( & clu -> lock ) ; vsp1_dl_body_put ( dlb ) ; return 0 ; } 