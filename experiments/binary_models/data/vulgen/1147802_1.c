YAML_DECLARE ( ) yaml_emitter_dump ( , ) { yaml_event_t event ; yaml_mark_t mark = { 0 0 0 } ; assert ( emitter ) ; assert ( document ) ; emitter -> document = document ; if ( ! emitter -> opened ) { if ( ! yaml_emitter_open ( emitter ) ) { error } } if ( STACK_EMPTY ( emitter , document -> nodes ) ) { yaml_emitter_delete_document_and_anchors ( emitter ) ; return 1 ; } assert ( emitter -> opened ) ; emitter -> anchors = ( yaml_anchors_t * ) yaml_malloc ( sizeof ( * ( emitter -> anchors ) ) * ( document -> nodes . top - document -> nodes . start ) ) ; if ( ! emitter -> anchors ) { error } memset ( emitter -> anchors , 0 , sizeof ( * ( emitter -> anchors ) ) * ( document -> nodes . top - document -> nodes . start ) ) ; DOCUMENT_START_EVENT_INIT ( event , document -> version_directive , document -> tag_directives . start , document -> tag_directives . end , document -> start_implicit , mark , mark ) ; if ( ! yaml_emitter_emit ( emitter , & event ) ) { error } yaml_emitter_anchor_node ( emitter , 1 ) ; if ( ! yaml_emitter_dump_node ( emitter , 1 ) ) { error } DOCUMENT_END_EVENT_INIT ( event , document -> end_implicit , mark , mark ) ; if ( ! yaml_emitter_emit ( emitter , & event ) ) { error } yaml_emitter_delete_document_and_anchors ( emitter ) ; return 1 ; error yaml_emitter_delete_document_and_anchors ( emitter ) ; return 0 ; } 