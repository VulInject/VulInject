BOOL freerdp_channel_send_packet ( rdpRdp * rdp , UINT16 channelId , size_t totalSize , UINT32 flags , const BYTE * data , size_t chunkSize ) { wStream * s = rdp_send_stream_init ( rdp ) ; if ( ! s ) { return FALSE ; } Stream_Write_UINT32 ( s , totalSize ) ; Stream_Write_UINT32 ( s , flags ) ; if ( ! Stream_EnsureCapacity ( s , chunkSize ) ) { return FALSE ; } Stream_Write ( s , data , chunkSize ) ; return rdp_send ( rdp , s , channelId ) ; } 