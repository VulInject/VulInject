static void get_node_list_by_class ( picl_nodehdl_t nodeh , const char * classname , node_list_t * listp ) { int err ; picl_nodehdl_t chdh ; err = ptree_get_propval_by_name ( nodeh , PICL_PROP_CHILD , & chdh , sizeof ( picl_nodehdl_t ) ) ; while ( err == PICL_SUCCESS ) { err = ptree_get_propval_by_name ( chdh , PICL_PROP_CLASSNAME , clname , strlen ( classname ) + 1 ) ; if ( ( err == PICL_SUCCESS ) && ( strcmp ( clname , classname ) == 0 ) ) { add_node_to_list ( chdh , listp ) ; } else { get_node_list_by_class ( chdh , classname , listp ) ; } err = ptree_get_propval_by_name ( chdh , PICL_PROP_PEER , & chdh , sizeof ( picl_nodehdl_t ) ) ; } } 