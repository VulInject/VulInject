static ssize_t ath10k_dbg_sta_write_addba ( struct file * file , const char __user * user_buf , size_t count , loff_t * ppos ) { struct ieee80211_sta * sta = file -> private_data ; struct ath10k_sta * arsta = ( ath10k_sta * ) sta -> drv_priv ; struct ath10k * ar = arsta -> arvif -> ar ; u32 tid , buf_size ; int ret ; char buf [ 64 ] { 0 } ; ; ret = simple_write_to_buffer ( buf , sizeof ( buf ) - 1 , ppos , user_buf , count ) ; if ( ret <= 0 ) { return ret ; } ret = sscanf ( buf , "%u %u" , & tid , & buf_size ) ; if ( tid > HTT_DATA_TX_EXT_TID_MGMT - 2 ) { return - EINVAL ; } mutex_lock ( & ar -> conf_mutex ) ; if ( ( ar -> state != ATH10K_STATE_ON ) || ( arsta -> aggr_mode != ATH10K_DBG_AGGR_MODE_MANUAL ) ) { ret = count ; out } ret = ath10k_wmi_addba_send ( ar , arsta -> arvif -> vdev_id , sta -> addr , tid , buf_size ) ; if ( ret ) { ath10k_warn ( ar , "failed to send addba request: vdev_id %u peer %pM tid %u buf_size %u\n" , arsta -> arvif -> vdev_id , sta -> addr , tid , buf_size ) ; } ret = count ; out mutex_unlock ( & ar -> conf_mutex ) ; return ret ; } 