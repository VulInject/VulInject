i386_analyze_struct_return ( , , ) { static unsigned char proto1 [ 3 ] { 0x87 0x04 0x24 } ; ; static unsigned char proto2 [ 4 ] { 0x87 0x44 0x24 0x00 } ; ; unsigned char buf [ 4 ] ; unsigned char op ; op = read_memory_unsigned_integer ( pc , 1 ) ; if ( op != 0x58 ) { return pc ; } read_memory ( pc + 1 , buf , 4 ) ; if ( memcmp ( buf , proto1 , 3 ) != 0 && memcmp ( buf , proto2 , 4 ) != 0 ) { return pc ; } if ( current_pc == pc ) { cache -> sp_offset += 4 ; return current_pc ; } if ( current_pc == pc + 1 ) { cache -> pc_in_eax = 1 ; return current_pc ; } if ( buf [ 1 ] == proto1 [ 1 ] ) { return pc + 4 ; } else { return pc + 5 ; } } 