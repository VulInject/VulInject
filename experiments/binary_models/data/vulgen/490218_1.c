som_slurp_string_table ( ) bfd * abfd ; { char * stringtab ; bfd_size_type amt ; if ( obj_som_stringtab ( abfd ) != NULL ) { return TRUE ; } if ( obj_som_stringtab_size ( abfd ) == 0 ) { return FALSE ; } amt = obj_som_stringtab_size ( abfd ) ; stringtab = bfd_zmalloc ( amt ) ; if ( stringtab == NULL ) { return FALSE ; } if ( bfd_seek ( abfd , obj_som_str_filepos ( abfd ) , SEEK_SET ) != 0 ) { return FALSE ; } if ( bfd_bread ( stringtab , amt , abfd ) != amt ) { return FALSE ; } obj_som_stringtab ( abfd ) = stringtab ; return TRUE ; } 