static void infd_server_pool_entry_publish_with ( InfdServerPoolEntry * entry , InfdServerPoolPublisher * publisher ) { InfdTcpServer * tcp ; guint port ; switch ( publisher -> type ) { case INFD_SERVER_POOL_PUBLISHER_LOCAL : g_assert ( INFD_IS_XMPP_SERVER ( entry -> server ) ) ; if ( publisher -> shared . local . item == NULL ) { g_object_get ( G_OBJECT ( entry -> server ) , "tcp-server" , & tcp , NULL ) ; g_object_get ( G_OBJECT ( tcp ) , "local-port" , & port , NULL ) ; publisher -> shared . local . item = inf_local_publisher_publish ( publisher -> shared . local . publisher , "_infinote._tcp" , infd_server_pool_get_local_service_name ( ) , port ) ; } break ; default : g_assert_not_reached ( ) ; break ; } } 