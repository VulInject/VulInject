mpn_addmul_1 ( , , , ) { mp_limb_t cy [ n ] ; mp_limb_t a , b , r , s0 , s1 , c0 , c1 ; mp_size_t i ; int more_carries ; if ( up == rp ) { mp_limb_t xp [ n ] ; MPN_COPY ( xp , up , n ) ; return mpn_addmul_1 ( rp , xp , n , vl ) ; } a = up [ 0 ] * vl ; r = rp [ 0 ] ; s0 = a + r ; rp [ 0 ] = s0 ; c0 = ( ( a & r ) | ( ( a | r ) & ~ s0 ) ) >> 63 ; cy [ 0 ] = c0 ; for ( i = 1 ; i < n ; i ++ ) { a = up [ i ] * vl ; b = _int_mult_upper ( up [ i - 1 ] , vl ) ; s0 = a + b ; c0 = ( ( a & b ) | ( ( a | b ) & ~ s0 ) ) >> 63 ; r = rp [ i ] ; s1 = s0 + r ; rp [ i ] = s1 ; c1 = ( ( s0 & r ) | ( ( s0 | r ) & ~ s1 ) ) >> 63 ; cy [ i ] = c0 + c1 ; } more_carries = 0 ; for ( i = 1 ; i < n ; i ++ ) { r = rp [ i ] ; c0 = cy [ i - 1 ] ; s0 = r + c0 ; rp [ i ] = s0 ; c0 = ( r & ~ s0 ) >> 63 ; more_carries += c0 ; } if ( more_carries ) { mp_limb_t cyrec ; for ( i = 1 ; i < n ; i ++ ) { r = rp [ i ] ; c0 = r < cy [ i - 1 ] ; s0 = r + cyrec ; rp [ i ] = s0 ; c1 = ( r & ~ s0 ) >> 63 ; cyrec = c0 | c1 ; } return _int_mult_upper ( up [ n - 1 ] , vl ) + cyrec + cy [ n - 1 ] ; } return _int_mult_upper ( up [ n - 1 ] , vl ) + cy [ n - 1 ] ; } 