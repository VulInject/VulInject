static void ieee80211_agg_start_txq ( struct sta_info * sta , int tid , bool enable ) { struct ieee80211_txq * txq = sta -> sta . txq [ tid ] ; struct txq_info * txqi ; lockdep_assert_held ( & sta -> ampdu_mlme . mtx ) ; txqi = to_txq_info ( txq ) ; if ( enable ) { set_bit ( IEEE80211_TXQ_AMPDU , & txqi -> flags ) ; } else { clear_bit ( IEEE80211_TXQ_AMPDU , & txqi -> flags ) ; } clear_bit ( IEEE80211_TXQ_STOP , & txqi -> flags ) ; local_bh_disable ( ) ; rcu_read_lock ( ) ; schedule_and_wake_txq ( sta -> sdata -> local , txqi ) ; rcu_read_unlock ( ) ; local_bh_enable ( ) ; } 