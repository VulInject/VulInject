int perf_mem_events__init ( void ) { const char * mnt = sysfs__mount ( ) ; bool found = false ; int j ; if ( ! mnt ) { return - ENOENT ; } for ( j = 0 ; j < PERF_MEM_EVENTS__MAX ; j ++ ) { struct perf_mem_event * e = perf_mem_events__ptr ( j ) ; struct perf_pmu * pmu ; if ( ! e -> tag ) { continue ; } if ( ! perf_pmu__has_hybrid ( ) ) { scnprintf ( sysfs_name , sizeof ( sysfs_name ) , e -> sysfs_name , "cpu" ) ; e -> supported = perf_mem_event__supported ( mnt , sysfs_name ) ; } else { perf_pmu__for_each_hybrid_pmu ( ) { scnprintf ( sysfs_name , sizeof ( sysfs_name ) , e -> sysfs_name , pmu -> name ) ; e -> supported |= perf_mem_event__supported ( mnt , sysfs_name ) ; } } if ( e -> supported ) { found = true ; } } return found ?0 : - ENOENT ; } 