static void pst_poll ( int unit , struct peer * peer ) { register struct pstunit * up ; struct refclockproc * pp ; pp = peer -> procptr ; up = pp -> unitptr ; up -> tcswitch = 0 ; up -> lastptr = pp -> a_lastcode ; if ( write ( pp -> io . fd , "QTQDQMT" , 6 ) != 6 ) { refclock_report ( peer , CEVNT_FAULT ) ; } if ( pp -> coderecv == pp -> codeproc ) { refclock_report ( peer , CEVNT_TIMEOUT ) ; return ; } refclock_receive ( peer ) ; if ( debug ) { printf ( "pst: timecode %d %s\n" , pp -> lencode , pp -> a_lastcode ) ; } pp -> polls ++ ; } 