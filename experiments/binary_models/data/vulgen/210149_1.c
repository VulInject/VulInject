int lj_cconv_compatptr ( CTState * cts , CType * d , CType * s , CTInfo flags ) { if ( ! ( ( flags & CCF_CAST ) || d == s ) ) { CTInfo dqual = 0 , squal = 0 ; d = cconv_childqual ( cts , d , & dqual ) ; if ( ! ctype_isstruct ( s -> info ) ) { s = cconv_childqual ( cts , s , & squal ) ; } if ( ( flags & CCF_SAME ) ) { if ( dqual != squal ) { return 0 ; } } if ( ! ( flags & CCF_IGNQUAL ) ) { if ( ( dqual & squal ) != squal ) { return 0 ; } } if ( ctype_type ( d -> info ) != ctype_type ( s -> info ) || d -> size != s -> size ) { return 0 ; } if ( ctype_isnum ( d -> info ) ) { if ( ( ( d -> info ^ s -> info ) & ( CTF_BOOL | CTF_FP ) ) ) { return 0 ; } } if ( ctype_ispointer ( d -> info ) ) { return lj_cconv_compatptr ( cts , d , s , flags | CCF_SAME ) ; } if ( ctype_isstruct ( d -> info ) ) { if ( d != s ) { return 0 ; } } if ( ctype_isfunc ( d -> info ) ) { } } return 1 ; } 