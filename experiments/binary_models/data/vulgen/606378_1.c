static bool test_validator ( struct ConfigSubset * sub , struct Buffer * err ) { log_line ( __func__ ) ; struct ConfigSet * cs = sub -> cs ; const char * name = "Papaya" ; mutt_buffer_reset ( err ) ; int rc = cs_str_string_set ( cs , name , "hello" , err ) ; if ( TEST_CHECK ( CSR_RESULT ( rc ) == CSR_SUCCESS ) ) { TEST_MSG ( "%s\n" , mutt_buffer_string ( err ) ) ; } else { TEST_MSG ( "%s\n" , mutt_buffer_string ( err ) ) ; return false ; } TEST_MSG ( "Path: %s = %s\n" , name , VarPapaya ) ; mutt_buffer_reset ( err ) ; rc = cs_str_native_set ( cs , name , IP "world" , err ) ; if ( TEST_CHECK ( CSR_RESULT ( rc ) == CSR_SUCCESS ) ) { TEST_MSG ( "%s\n" , mutt_buffer_string ( err ) ) ; } else { TEST_MSG ( "%s\n" , mutt_buffer_string ( err ) ) ; return false ; } VarPapaya = cs_subset_path ( sub , "Papaya" ) ; TEST_MSG ( "Native: %s = %s\n" , name , VarPapaya ) ; name = "Quince" ; mutt_buffer_reset ( err ) ; rc = cs_str_string_set ( cs , name , "hello" , err ) ; if ( TEST_CHECK ( CSR_RESULT ( rc ) == CSR_SUCCESS ) ) { TEST_MSG ( "%s\n" , mutt_buffer_string ( err ) ) ; } else { TEST_MSG ( "%s\n" , mutt_buffer_string ( err ) ) ; return false ; } const char * VarQuince = cs_subset_path ( sub , "Quince" ) ; TEST_MSG ( "Path: %s = %s\n" , name , VarQuince ) ; mutt_buffer_reset ( err ) ; rc = cs_str_native_set ( cs , name , IP "world" , err ) ; if ( TEST_CHECK ( CSR_RESULT ( rc ) == CSR_SUCCESS ) ) { TEST_MSG ( "%s\n" , mutt_buffer_string ( err ) ) ; } else { TEST_MSG ( "%s\n" , mutt_buffer_string ( err ) ) ; return false ; } VarQuince = cs_subset_path ( sub , "Quince" ) ; TEST_MSG ( "Native: %s = %s\n" , name , VarQuince ) ; name = "Raspberry" ; mutt_buffer_reset ( err ) ; rc = cs_str_string_set ( cs , name , "hello" , err ) ; if ( TEST_CHECK ( CSR_RESULT ( rc ) != CSR_SUCCESS ) ) { TEST_MSG ( "Expected error: %s\n" , mutt_buffer_string ( err ) ) ; } else { TEST_MSG ( "%s\n" , mutt_buffer_string ( err ) ) ; return false ; } const char * VarRaspberry = cs_subset_path ( sub , "Raspberry" ) ; TEST_MSG ( "Path: %s = %s\n" , name , VarRaspberry ) ; mutt_buffer_reset ( err ) ; rc = cs_str_native_set ( cs , name , IP "world" , err ) ; if ( TEST_CHECK ( CSR_RESULT ( rc ) != CSR_SUCCESS ) ) { TEST_MSG ( "Expected error: %s\n" , mutt_buffer_string ( err ) ) ; } else { TEST_MSG ( "%s\n" , mutt_buffer_string ( err ) ) ; return false ; } VarRaspberry = cs_subset_path ( sub , "Raspberry" ) ; TEST_MSG ( "Native: %s = %s\n" , name , VarRaspberry ) ; log_line ( __func__ ) ; return true ; } 