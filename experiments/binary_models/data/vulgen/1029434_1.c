static int rockchip_spi_of_to_plat ( struct udevice * bus ) { struct rockchip_spi_plat * plat = dev_get_plat ( bus ) ; struct rockchip_spi_priv * priv = dev_get_priv ( bus ) ; int ret ; if ( CONFIG_IS_ENABLED ( OF_REAL ) ) { plat -> base = dev_read_addr ( bus ) ; if ( ret < 0 ) { debug ( "%s: Could not get clock for %s: %d\n" , __func__ , bus -> name , ret ) ; return ret ; } plat -> frequency = dev_read_u32_default ( bus , "spi-max-frequency" , 50000000 ) ; plat -> deactivate_delay_us = dev_read_u32_default ( bus , "spi-deactivate-delay" , 0 ) ; plat -> activate_delay_us = dev_read_u32_default ( bus , "spi-activate-delay" , 0 ) ; debug ( "%s: base=%x, max-frequency=%d, deactivate_delay=%d\n" , __func__ , ( uint ) plat -> base , plat -> frequency , plat -> deactivate_delay_us ) ; } return 0 ; } 