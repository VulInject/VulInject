static void check_threshold ( int depth ) { LOCAL_ALIGNED_32 ( uint8_t , in , [ WIDTH_PADDED ] ) ; LOCAL_ALIGNED_32 ( uint8_t , threshold , [ WIDTH_PADDED ] ) ; LOCAL_ALIGNED_32 ( uint8_t , min , [ WIDTH_PADDED ] ) ; LOCAL_ALIGNED_32 ( uint8_t , max , [ WIDTH_PADDED ] ) ; LOCAL_ALIGNED_32 ( uint8_t , out_ref , [ WIDTH_PADDED ] ) ; LOCAL_ALIGNED_32 ( uint8_t , out_new , [ WIDTH_PADDED ] ) ; ptrdiff_t line_size = WIDTH_PADDED ; int w = WIDTH ; declare_func ( , , , , , , , , , , , , ) ThresholdContext s ; s . depth = depth ; ff_threshold_init ( & s ) ; memset ( in , 0 , WIDTH_PADDED ) ; memset ( threshold , 0 , WIDTH_PADDED ) ; memset ( min , 0 , WIDTH_PADDED ) ; memset ( max , 0 , WIDTH_PADDED ) ; memset ( out_ref , 0 , WIDTH_PADDED ) ; memset ( out_new , 0 , WIDTH_PADDED ) ; randomize_buffers ( in , WIDTH ) ; randomize_buffers ( threshold , WIDTH ) ; randomize_buffers ( min , WIDTH ) ; randomize_buffers ( max , WIDTH ) ; if ( check_func ( s . threshold , "threshold%d" , depth ) ) { call_ref ( in , threshold , min , max , out_ref , line_size , line_size , line_size , line_size , line_size , w , 1 ) ; call_new ( in , threshold , min , max , out_new , line_size , line_size , line_size , line_size , line_size , w , 1 ) ; if ( memcmp ( out_ref , out_new , WIDTH ) ) { fail ( ) ; } bench_new ( in , threshold , min , max , out_new , line_size , line_size , line_size , line_size , line_size , w , 1 ) ; } } 