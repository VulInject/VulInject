static char * fix_store_name ( hx509_context contextp , const char * sn , const char * def_type ) { const char * residue = strchr ( sn , ':' ) ; char * s = NULL ; if ( residue ) { s = estrdup ( sn ) ; s [ residue - sn ] = '\0' ; if ( _hx509_ks_type ( contextp , s ) ) { return estrdup ( sn ) ; } free ( s ) ; s = NULL ; } if ( asprintf ( & s , "%s:%s" , def_type , sn ) == - 1 || s == NULL ) { err ( 1 , "Out of memory" ) ; } return s ; } 