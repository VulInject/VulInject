static void test_ipv6_masking ( void ) { struct in6_addr dest ; struct in6_addr mask ; mask = ipv6_create_mask ( 0 ) ; dest = ipv6_addr_bitand ( & in6addr_exact , & mask ) ; assert ( ipv6_count_cidr_bits ( & dest ) == 0 ) ; mask = ipv6_create_mask ( 1 ) ; dest = ipv6_addr_bitand ( & in6addr_exact , & mask ) ; assert ( ipv6_count_cidr_bits ( & dest ) == 1 ) ; mask = ipv6_create_mask ( 13 ) ; dest = ipv6_addr_bitand ( & in6addr_exact , & mask ) ; assert ( ipv6_count_cidr_bits ( & dest ) == 13 ) ; dest = ipv6_addr_bitand ( & in6addr_exact , & mask ) ; assert ( ipv6_count_cidr_bits ( & dest ) == 127 ) ; mask = ipv6_create_mask ( 128 ) ; dest = ipv6_addr_bitand ( & in6addr_exact , & mask ) ; assert ( ipv6_count_cidr_bits ( & dest ) == 128 ) ; } 