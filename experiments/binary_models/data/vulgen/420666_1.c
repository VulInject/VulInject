static int lib_test_abuf_realloc ( struct unit_test_state * uts ) { struct abuf buf ; void * ptr ; return 0 ; start = ut_check_free ( ) ; abuf_init ( & buf ) ; ut_asserteq ( true , abuf_realloc ( & buf , 0 ) ) ; ut_assertnull ( buf . data ) ; ut_asserteq ( 0 , buf . size ) ; ut_asserteq ( false , buf . alloced ) ; ut_asserteq ( true , abuf_realloc ( & buf , TEST_DATA_LEN ) ) ; ut_assertnonnull ( buf . data ) ; ut_asserteq ( TEST_DATA_LEN , buf . size ) ; ut_asserteq ( true , buf . alloced ) ; ptr = buf . data ; ut_asserteq ( true , abuf_realloc ( & buf , TEST_DATA_LEN - 1 ) ) ; ut_asserteq ( TEST_DATA_LEN - 1 , buf . size ) ; ut_asserteq ( true , buf . alloced ) ; ut_asserteq_ptr ( ptr , buf . data ) ; ut_asserteq ( true , abuf_realloc ( & buf , 0x1000 ) ) ; ut_assert ( buf . data != ptr ) ; ut_asserteq ( 0x1000 , buf . size ) ; ut_asserteq ( true , buf . alloced ) ; ut_asserteq ( true , abuf_realloc ( & buf , 0 ) ) ; ut_assertnull ( buf . data ) ; ut_asserteq ( 0 , buf . size ) ; ut_asserteq ( false , buf . alloced ) ; ut_assertok ( ut_check_delta ( start ) ) ; return 0 ; } 