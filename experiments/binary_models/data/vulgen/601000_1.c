struct acpi_device * acpi_find_child_device ( struct acpi_device * parent , u64 address , bool check_children ) { struct acpi_device * adev , * ret = NULL ; int ret_score = 0 ; list_for_each_entry ( , , ) { unsigned long long addr ; acpi_status status ; int score ; status = acpi_evaluate_integer ( adev -> handle , METHOD_NAME__ADR , NULL , & addr ) ; if ( ACPI_FAILURE ( status ) || addr != address ) { continue ; } if ( ! ret ) { ret = adev ; continue ; } if ( ! ret_score ) { ret_score = find_child_checks ( ret , check_children ) ; if ( ret_score == FIND_CHILD_MAX_SCORE ) { return ret ; } } score = find_child_checks ( adev , check_children ) ; if ( score == FIND_CHILD_MAX_SCORE ) { return adev ; } if ( score > ret_score ) { ret = adev ; ret_score = score ; } } return ret ; } 