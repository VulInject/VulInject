static int __init mlb_timer_init ( struct device_node * node ) { int ret ; unsigned long rate ; ret = timer_of_init ( node , & to ) ; rate = timer_of_rate ( & to ) / MLB_TMR_DIV_CNT ; mlb_config_clock_source ( & to ) ; clocksource_mmio_init ( timer_of_base ( & to ) + MLB_TMR_SRC_TMR_OFS , node -> name , rate , MLB_TIMER_RATING , 32 , clocksource_mmio_readl_down ) ; sched_clock_register ( mlb_timer_sched_read , 32 , rate ) ; mlb_config_clock_event ( & to ) ; clockevents_config_and_register ( & to . clkevt , timer_of_rate ( & to ) , 15 , 0xffffffff ) ; return 0 ; } 