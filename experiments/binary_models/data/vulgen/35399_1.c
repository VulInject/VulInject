static void corex_rpc_pkg_summary ( rpc_t * rpc , void * c ) { str group = str_init ( "core" ) ; str var = str_init ( "mem_dump_pkg" ) ; str sel = { 0 0 } ; int i ; if ( rpc -> scan ( c , "Sd" , & sel , & i ) < 2 ) { rpc -> fault ( c , 400 , "Selector and value not provided" ) ; return ; } if ( strncasecmp ( sel . s , "idx" , 3 ) == 0 ) { if ( i < 0 || i >= * process_count ) { rpc -> fault ( c , 500 , "Index value out of range" ) ; return ; } i = pt [ i ] . pid ; } if ( strncasecmp ( sel . s , "pid" , 3 ) != 0 ) { rpc -> fault ( c , 500 , "Unsupported selector type" ) ; return ; } if ( cfg_set_now ( _cfg_corex_ctx , & group , NULL , & var , ( void * ) ( long ) i , CFG_VAR_INT ) != 0 ) { rpc -> fault ( c , 500 , "Operation failed" ) ; return ; } } 