static void saa711x_set_v4lstd ( struct v4l2_subdev * sd , v4l2_std_id std ) { struct saa711x_state * state = to_state ( sd ) ; if ( std == state -> std ) { return ; } state -> std = std ; if ( std & V4L2_STD_525_60 ) { v4l2_dbg ( 1 , debug , sd , "decoder set standard 60 Hz\n" ) ; if ( state -> ident == GM7113C ) { u8 reg = saa711x_read ( sd , R_08_SYNC_CNTL ) ; reg &= ~ ( SAA7113_R_08_FSEL | SAA7113_R_08_AUFD ) ; reg |= SAA7113_R_08_FSEL ; saa711x_write ( sd , R_08_SYNC_CNTL , reg ) ; } else { saa711x_writeregs ( sd , saa7115_cfg_60hz_video ) ; } saa711x_set_size ( sd , 720 , 480 ) ; } else { v4l2_dbg ( 1 , debug , sd , "decoder set standard 50 Hz\n" ) ; if ( state -> ident == GM7113C ) { u8 reg = saa711x_read ( sd , R_08_SYNC_CNTL ) ; reg &= ~ ( SAA7113_R_08_FSEL | SAA7113_R_08_AUFD ) ; saa711x_write ( sd , R_08_SYNC_CNTL , reg ) ; } else { saa711x_writeregs ( sd , 0 ) ; } saa711x_set_size ( sd , 720 , 576 ) ; } if ( state -> ident <= SAA7113 || state -> ident == GM7113C ) { u8 reg = saa711x_read ( sd , R_0E_CHROMA_CNTL_1 ) & 0x8f ; if ( std == V4L2_STD_PAL_M ) { reg |= 0x30 ; } if ( std == V4L2_STD_PAL_Nc ) { reg |= 0x20 ; } if ( std == V4L2_STD_PAL_60 ) { reg |= 0x10 ; } if ( std == V4L2_STD_NTSC_M_JP ) { reg |= 0x40 ; } if ( std & V4L2_STD_SECAM ) { reg |= 0x50 ; } saa711x_write ( sd , R_0E_CHROMA_CNTL_1 , reg ) ; } else { int taskb = saa711x_read ( sd , R_80_GLOBAL_CNTL_1 ) & 0x10 ; if ( taskb && state -> ident == SAA7114 ) { saa711x_writeregs ( sd , saa7115_cfg_vbi_on ) ; } saa711x_s_clock_freq ( sd , state -> audclk_freq ) ; } } 