static irqreturn_t omap3_l3_app_irq ( int irq , void * _l3 ) { struct omap3_l3 * l3 = _l3 ; u64 status , clear ; u64 error ; u64 error_addr ; u64 err_source ; void __iomem * base ; int int_type ; irqreturn_t ret = IRQ_NONE ; int_type = irq == l3 -> app_irq ?L3_APPLICATION_ERROR : L3_DEBUG_ERROR ; if ( ! int_type ) { status = omap3_l3_readll ( l3 -> rt , L3_SI_FLAG_STATUS_0 ) ; BUG_ON ( status & L3_STATUS_0_TIMEOUT_MASK ) ; } else { status = omap3_l3_readll ( l3 -> rt , L3_SI_FLAG_STATUS_1 ) ; } err_source = __ffs ( status ) ; base = l3 -> rt + omap3_l3_bases [ int_type ] [ err_source ] ; error = omap3_l3_readll ( base , L3_ERROR_LOG ) ; if ( error ) { error_addr = omap3_l3_readll ( base , L3_ERROR_LOG_ADDR ) ; ret |= omap3_l3_block_irq ( l3 , error , error_addr ) ; } clear = ( L3_AGENT_STATUS_CLEAR_IA << int_type ) | L3_AGENT_STATUS_CLEAR_TA ; omap3_l3_writell ( base , L3_AGENT_STATUS , clear ) ; omap3_l3_writell ( base , L3_ERROR_LOG , error ) ; return ret ; } 