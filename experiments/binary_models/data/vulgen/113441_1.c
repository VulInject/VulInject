static void print_arp ( char field_id , const uchar_t * buf , const arh_t * arh , uint16_t ptype ) { char macstr [ ARP_MAX_ADDR_LEN * 3 ] ; in_addr_t inaddr ; if ( arh -> arh_hlen == 0 ) { ( void ) strcpy ( macstr , "(none)" ) ; } else { mdb_mac_addr ( buf , arh -> arh_hlen , macstr , sizeof ( macstr ) ) ; } mdb_printf ( "%?s  ar$%cha %s\n" , "" , field_id , macstr ) ; if ( arh -> arh_plen == 0 ) { mdb_printf ( "%?s  ar$%cpa (none)\n" , "" , field_id ) ; } if ( ptype == IP_ARP_PROTO_TYPE ) { mdb_printf ( "%?s  ar$%cpa (unknown)\n" , "" , field_id ) ; } if ( arh -> arh_plen == sizeof ( in_addr_t ) ) { mdb_printf ( "%?s  ar$%cpa %I\n" , "" , field_id , inaddr ) ; } else { mdb_printf ( "%?s  ar$%cpa (malformed IP)\n" , "" , field_id ) ; } } 