void div_word ( u16 s ) { u32 dvd , div , mod ; dvd = ( ( ( u32 ) M . x86 . R_DX ) << 16 ) | M . x86 . R_AX ; if ( s == 0 ) { return ; } div = dvd / ( u16 ) s ; mod = dvd % ( u16 ) s ; if ( abs ( div ) > 0xffff ) { x86emu_intr_raise ( 0 ) ; return ; } CLEAR_FLAG ( F_CF ) ; CLEAR_FLAG ( F_SF ) ; CONDITIONAL_SET_FLAG ( div == 0 , F_ZF ) ; set_parity_flag ( mod ) ; M . x86 . R_AX = ( u16 ) div ; M . x86 . R_DX = ( u16 ) mod ; } 