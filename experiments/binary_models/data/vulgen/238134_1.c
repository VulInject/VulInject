int fromhdr_proc ( str * sout , str * soutopt , struct sip_msg * msg ) { if ( ( ! msg -> from ) && ( parse_headers ( msg , HDR_FROM_F , 0 ) == - 1 ) ) { LOG ( L_ERR , "AUTH_IDENTITY:fromhdr_proc: Error while parsing FROM header\n" ) ; return AUTH_ERROR ; } if ( ! msg -> from ) { LOG ( L_ERR , "AUTH_IDENTITY:fromhdr_proc: FROM header field is not found\n" ) ; return AUTH_NOTFOUND ; } if ( ( ! ( msg -> from ) -> parsed ) && ( parse_from_header ( msg ) < 0 ) ) { LOG ( L_ERR , "AUTH_IDENTITY:fromhdr_proc: Error while parsing FROM body\n" ) ; return AUTH_ERROR ; } if ( sout ) { * sout = get_from ( msg ) -> uri ; } return AUTH_OK ; } 