static void compress ( CTX * ctx , int last ) { uint64_t m [ 16 ] ; uint64_t v [ 16 ] ; int i ; for ( i = 0 ; i < 16 ; i ++ ) { m [ i ] = load64 ( & ctx -> b [ 8 * i ] ) ; } for ( i = 0 ; i < 8 ; i ++ ) { v [ i ] = ctx -> h [ i ] ; v [ i + 8 ] = iv [ i ] ; } v [ 12 ] ^= ctx -> t [ 0 ] ; v [ 13 ] ^= ctx -> t [ 1 ] ; if ( last ) { v [ 14 ] = ~ v [ 14 ] ; } for ( i = 0 ; i < 12 ; i ++ ) { G ( 0 , 4 , 8 , 12 , m [ sigma [ i ] [ 0 ] ] , m [ sigma [ i ] [ 1 ] ] ) ; G ( 1 , 5 , 9 , 13 , m [ sigma [ i ] [ 2 ] ] , m [ sigma [ i ] [ 3 ] ] ) ; G ( 2 , 6 , 10 , 14 , m [ sigma [ i ] [ 4 ] ] , m [ sigma [ i ] [ 5 ] ] ) ; G ( 3 , 7 , 11 , 15 , m [ sigma [ i ] [ 6 ] ] , m [ sigma [ i ] [ 7 ] ] ) ; G ( 0 , 5 , 10 , 15 , m [ sigma [ i ] [ 8 ] ] , m [ sigma [ i ] [ 9 ] ] ) ; G ( 1 , 6 , 11 , 12 , m [ sigma [ i ] [ 10 ] ] , m [ sigma [ i ] [ 11 ] ] ) ; G ( 2 , 7 , 8 , 13 , m [ sigma [ i ] [ 12 ] ] , m [ sigma [ i ] [ 13 ] ] ) ; G ( 3 , 4 , 9 , 14 , m [ sigma [ i ] [ 14 ] ] , m [ sigma [ i ] [ 15 ] ] ) ; } for ( i = 0 ; i < 8 ; ++ i ) { ctx -> h [ i ] ^= v [ i ] ^ v [ i + 8 ] ; } } 