const char * sasl_errstring ( int saslerr , const char * langlist , const char * langlist __attribute__ ( ( unused ) ) , const char * * outlang ) ( const char * s , const char * s_locale , char * s_utf8 , void * tsd , ( outlang ) * outlang = "i-default" , ( outlang ) * outlang = "en-us" , ( saslerr ) { case SASL_CONTINUE : s = gettext ( "another step is needed in authentication" ) break ; } case SASL_OK : , s = gettext ( "successful result" ) , SASL_FAIL : s = gettext ( "generic failure" ) , SASL_NOMEM : s = gettext ( "no memory available" ) , SASL_BUFOVER : s = gettext ( "overflowed buffer" ) , SASL_NOMECH : s = gettext ( "no mechanism available" ) , SASL_BADPROT : s = gettext ( "bad protocol / cancel" ) , SASL_NOTDONE : s = gettext ( "can't request info until later in exchange" ) , SASL_BADPARAM : s = gettext ( "invalid parameter supplied" ) , SASL_TRYAGAIN : s = gettext ( "transient failure (e.g., weak key)" ) , SASL_BADMAC : s = gettext ( "integrity check failed" ) , SASL_NOTINIT : s = gettext ( "SASL library not initialized" ) , SASL_INTERACT : s = gettext ( "needs user interaction" ) , SASL_BADSERV : s = gettext ( "server failed mutual authentication step" ) , SASL_WRONGMECH : s = gettext ( "mechanism doesn't support requested feature" ) , SASL_BADAUTH : s = gettext ( "authentication failure" ) , SASL_NOAUTHZ : s = gettext ( "authorization failure" ) , SASL_TOOWEAK : s = gettext ( "mechanism too weak for this user" ) , SASL_ENCRYPT : s = gettext ( "encryption needed to use mechanism" ) , SASL_TRANS : s = gettext ( "One time use of a plaintext password will enable requested mechanism for user" ) , SASL_EXPIRED : s = gettext ( "passphrase expired, has to be reset" ) , SASL_DISABLED : s = gettext ( "account disabled" ) , SASL_NOUSER : s = gettext ( "user not found" ) , SASL_BADVERS : s = gettext ( "version mismatch with plug-in" ) , SASL_UNAVAIL : s = gettext ( "remote authentication server unavailable" ) , SASL_NOVERIFY : s = gettext ( "user exists, but no verifier for user" ) , SASL_PWLOCK : s = gettext ( "passphrase locked" ) , SASL_NOCHANGE : s = gettext ( "requested change was not needed" ) , SASL_WEAKPASS : s = gettext ( "passphrase is too weak for security policy" ) , SASL_NOUSERPASS : s = gettext ( "user supplied passwords are not permitted" ) , : s = gettext ( "undefined error!" ) ) ( use_locale ( langlist , 0 ) ) s_locale = dgettext ( TEXT_DOMAIN , s ) ; else { s_locale = s ; } if ( s == s_locale ) { return s ; } s_utf8 = local_to_utf ( NULL , s_locale ) ; if ( s_utf8 == NULL ) { return s ; } if ( pthread_key_create_once_np ( & errstring_key , free_err_tsd ) != 0 ) { free ( s_utf8 ) ; return s ; } tsd = pthread_getspecific ( errstring_key ) ; pthread_setspecific ( errstring_key , s_utf8 ) ; if ( outlang ) { * outlang = "*" ; } return s_utf8 ; switch ( saslerr ) { case SASL_CONTINUE : return "another step is needed in authentication" ; case SASL_OK : return "successful result" ; case SASL_FAIL : return "generic failure" ; case SASL_NOMEM : return "no memory available" ; case SASL_BUFOVER : return "overflowed buffer" ; case SASL_NOMECH : return "no mechanism available" ; case SASL_BADPROT : return "bad protocol / cancel" ; case SASL_NOTDONE : return "can't request info until later in exchange" ; case SASL_BADPARAM : return "invalid parameter supplied" ; case SASL_TRYAGAIN : return "transient failure (e.g., weak key)" ; case SASL_BADMAC : return "integrity check failed" ; case SASL_NOTINIT : return "SASL library not initialized" ; case SASL_INTERACT : return "needs user interaction" ; case SASL_BADSERV : return "server failed mutual authentication step" ; case SASL_WRONGMECH : return "mechanism doesn't support requested feature" ; case SASL_BADAUTH : return "authentication failure" ; case SASL_NOAUTHZ : return "authorization failure" ; case SASL_TOOWEAK : return "mechanism too weak for this user" ; case SASL_ENCRYPT : return "encryption needed to use mechanism" ; case SASL_TRANS : return "One time use of a plaintext password will enable requested mechanism for user" ; case SASL_EXPIRED : return "passphrase expired, has to be reset" ; case SASL_DISABLED : return "account disabled" ; case SASL_NOUSER : return "user not found" ; case SASL_BADVERS : return "version mismatch with plug-in" ; case SASL_UNAVAIL : return "remote authentication server unavailable" ; case SASL_NOVERIFY : return "user exists, but no verifier for user" ; case SASL_PWLOCK : return "passphrase locked" ; case SASL_NOCHANGE : return "requested change was not needed" ; case SASL_WEAKPASS : return "passphrase is too weak for security policy" ; case SASL_NOUSERPASS : return "user supplied passwords are not permitted" ; default : return "undefined error!" ; } 