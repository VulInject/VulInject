static void meson_g12a_crtc_atomic_disable ( struct drm_crtc * crtc , struct drm_atomic_state * state ) { struct meson_crtc * meson_crtc = to_meson_crtc ( crtc ) ; struct meson_drm * priv = meson_crtc -> priv ; DRM_DEBUG_DRIVER ( "\n" ) ; drm_crtc_vblank_off ( crtc ) ; priv -> viu . osd1_enabled = false ; priv -> viu . osd1_commit = false ; priv -> viu . vd1_enabled = false ; priv -> viu . vd1_commit = false ; if ( crtc -> state -> event && ! crtc -> state -> active ) { spin_lock_irq ( & crtc -> dev -> event_lock ) ; drm_crtc_send_vblank_event ( crtc , crtc -> state -> event ) ; crtc -> state -> event = NULL ; } } 