void setnnames ( void ) { char buf [ 80 ] ; int i , l ; struct tm tm ; for ( i = 0 ; i < 7 ; i ++ ) { tm . tm_wday = i ; l = strftime ( buf , sizeof ( buf ) , "%a" , & tm ) ; for ( ; l > 0 && isspace ( ( unsigned char ) buf [ l - 1 ] ) ; l -- ) { } buf [ l ] = '\0' ; free ( ndays [ i ] . name ) ; if ( ( ndays [ i ] . name = strdup ( buf ) ) == NULL ) { err ( 1 , NULL ) ; } ndays [ i ] . len = strlen ( buf ) ; l = strftime ( buf , sizeof ( buf ) , "%A" , & tm ) ; for ( ; l > 0 && isspace ( ( unsigned char ) buf [ l - 1 ] ) ; l -- ) { } buf [ l ] = '\0' ; free ( fndays [ i ] . name ) ; if ( ( fndays [ i ] . name = strdup ( buf ) ) == NULL ) { err ( 1 , NULL ) ; } fndays [ i ] . len = strlen ( buf ) ; } for ( i = 0 ; i < 12 ; i ++ ) { tm . tm_mon = i ; l = strftime ( buf , sizeof ( buf ) , "%b" , & tm ) ; for ( ; l > 0 && isspace ( ( unsigned char ) buf [ l - 1 ] ) ; l -- ) { } buf [ l ] = '\0' ; free ( nmonths [ i ] . name ) ; if ( ( nmonths [ i ] . name = strdup ( buf ) ) == NULL ) { err ( 1 , NULL ) ; } nmonths [ i ] . len = strlen ( buf ) ; l = strftime ( buf , sizeof ( buf ) , "%B" , & tm ) ; for ( ; l > 0 && isspace ( ( unsigned char ) buf [ l - 1 ] ) ; l -- ) { } buf [ l ] = '\0' ; free ( fnmonths [ i ] . name ) ; if ( ( fnmonths [ i ] . name = strdup ( buf ) ) == NULL ) { err ( 1 , NULL ) ; } fnmonths [ i ] . len = strlen ( buf ) ; } spev [ 0 ] . name = strdup ( PESACH ) ; spev [ 0 ] . nlen = PESACHLEN ; spev [ 0 ] . getev = pesach ; spev [ 1 ] . name = strdup ( EASTER ) ; spev [ 1 ] . nlen = EASTERNAMELEN ; spev [ 1 ] . getev = easter ; spev [ 2 ] . name = strdup ( PASKHA ) ; spev [ 2 ] . nlen = PASKHALEN ; spev [ 2 ] . getev = paskha ; for ( i = 0 ; i < NUMEV ; i ++ ) { spev [ i ] . uname = NULL ; } } 