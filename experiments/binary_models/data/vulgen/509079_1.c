PIX * pixMakeMaskFromVal ( PIX * pixs , l_int32 val ) { l_int32 w , h , d , i , j , sval , wpls , wpld ; l_uint32 * datas , * datad , * lines , * lined ; PIX * pixd ; if ( ! pixs ) { return ( PIX * ) ERROR_PTR ( "pixs not defined" , __func__ , NULL ) ; } pixGetDimensions ( pixs , & w , & h , & d ) ; if ( d != 2 && d != 4 && d != 8 ) { return ( PIX * ) ERROR_PTR ( "pix not 2, 4 or 8 bpp" , __func__ , NULL ) ; } pixCopyResolution ( pixd , pixs ) ; pixCopyInputFormat ( pixd , pixs ) ; datas = pixGetData ( pixs ) ; datad = pixGetData ( pixd ) ; wpls = pixGetWpl ( pixs ) ; wpld = pixGetWpl ( pixd ) ; for ( i = 0 ; i < h ; i ++ ) { lines = datas + i * wpls ; lined = datad + i * wpld ; for ( j = 0 ; j < w ; j ++ ) { if ( d == 2 ) { sval = GET_DATA_DIBIT ( lines , j ) ; } if ( d == 4 ) { sval = GET_DATA_QBIT ( lines , j ) ; } else { sval = GET_DATA_BYTE ( lines , j ) ; } if ( sval == val ) { SET_DATA_BIT ( lined , j ) ; } } } return pixd ; } 