static int rk_tsadcv2_alarm_temp ( const struct chip_tsadc_table * table , int chn , void __iomem * regs , int temp ) { u32 alarm_value ; u32 int_en , int_clr ; if ( temp == INT_MAX ) { int_clr = readl_relaxed ( regs + TSADCV2_INT_EN ) ; int_clr &= ~ TSADCV2_INT_SRC_EN ( chn ) ; writel_relaxed ( int_clr , regs + TSADCV2_INT_EN ) ; return 0 ; } alarm_value = rk_tsadcv2_temp_to_code ( table , temp ) ; writel_relaxed ( alarm_value & table -> data_mask , regs + TSADCV2_COMP_INT ( chn ) ) ; int_en = readl_relaxed ( regs + TSADCV2_INT_EN ) ; int_en |= TSADCV2_INT_SRC_EN ( chn ) ; writel_relaxed ( int_en , regs + TSADCV2_INT_EN ) ; return 0 ; } 