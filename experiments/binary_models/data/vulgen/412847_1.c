int ehci_hcdi_polled_input_init ( usba_pipe_handle_data_t * ph , uchar_t * * polled_buf , usb_console_info_impl_t * console_input_info ) { ehci_polled_t * ehci_polledp ; ehci_state_t * ehcip ; int ret ; ehcip = ehci_obtain_state ( ph -> p_usba_device -> usb_root_hub_dip ) ; mutex_enter ( & ehcip -> ehci_int_mutex ) ; ret = ehci_polled_init ( ph , ehcip , console_input_info ) ; if ( ret != USB_SUCCESS ) { mutex_exit ( & ehcip -> ehci_int_mutex ) ; return ( ret ) ; } ehci_polledp = ( ehci_polled_t * ) console_input_info -> uci_private ; ehci_polledp -> ehci_polled_flags |= POLLED_INPUT_MODE ; ehcip -> ehci_polled_kbd_count ++ ; * polled_buf = ehci_polledp -> ehci_polled_buf ; if ( ddi_prop_exists ( DDI_DEV_T_ANY , ehcip -> ehci_dip , DDI_PROP_NOTPROM , "no-prom-cdma-sync" ) ) { ehci_polledp -> ehci_polled_no_sync_flag = B_TRUE ; } mutex_exit ( & ehcip -> ehci_int_mutex ) ; return ( USB_SUCCESS ) ; } 