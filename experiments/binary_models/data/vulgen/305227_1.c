static void qeth_bridge_emit_host_event ( struct qeth_card * card , enum qeth_an_event_type evtype , u8 code , struct net_if_token * token , struct mac_addr_lnid * addr_lnid ) { char str [ 7 ] [ 32 ] ; char * env [ 8 ] ; int i = 0 ; switch ( evtype ) { case anev_reg_unreg : snprintf ( str [ i ] , sizeof ( str [ i ] ) , "BRIDGEDHOST=%s" , ( code & IPA_ADDR_CHANGE_CODE_REMOVAL ) ?"deregister" : "register" ) ; env [ i ] = str [ i ] ; i ++ ; if ( code & IPA_ADDR_CHANGE_CODE_VLANID ) { snprintf ( str [ i ] , sizeof ( str [ i ] ) , "VLAN=%d" , addr_lnid -> lnid ) ; env [ i ] = str [ i ] ; i ++ ; } snprintf ( str [ i ] , sizeof ( str [ i ] ) , "NTOK_BUSID=%x.%x.%04x" , token -> cssid , token -> ssid , token -> devnum ) ; env [ i ] = str [ i ] ; i ++ ; snprintf ( str [ i ] , sizeof ( str [ i ] ) , "NTOK_IID=%02x" , token -> iid ) ; env [ i ] = str [ i ] ; i ++ ; snprintf ( str [ i ] , sizeof ( str [ i ] ) , "NTOK_CHPID=%02x" , token -> chpid ) ; env [ i ] = str [ i ] ; i ++ ; snprintf ( str [ i ] , sizeof ( str [ i ] ) , "NTOK_CHID=%04x" , token -> chid ) ; env [ i ] = str [ i ] ; i ++ ; break ; case anev_abort : snprintf ( str [ i ] , sizeof ( str [ i ] ) , "BRIDGEDHOST=abort" ) ; env [ i ] = str [ i ] ; i ++ ; break ; case anev_reset : snprintf ( str [ i ] , sizeof ( str [ i ] ) , "BRIDGEDHOST=reset" ) ; env [ i ] = str [ i ] ; i ++ ; break ; } env [ i ] = NULL ; kobject_uevent_env ( & card -> gdev -> dev . kobj , KOBJ_CHANGE , env ) ; } 