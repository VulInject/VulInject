static void atmel_spi_pump_single_data ( struct atmel_spi * as , struct spi_transfer * xfer ) { u8 * rxp ; u16 * rxp16 ; if ( xfer -> bits_per_word > 8 ) { rxp16 = ( u16 * ) ( ( ( u8 * ) xfer -> rx_buf ) + xfer_pos ) ; * rxp16 = spi_readl ( as , RDR ) ; } else { rxp = ( ( u8 * ) xfer -> rx_buf ) + xfer_pos ; * rxp = spi_readl ( as , RDR ) ; } if ( xfer -> bits_per_word > 8 ) { if ( as -> current_remaining_bytes > 2 ) { as -> current_remaining_bytes -= 2 ; } else { as -> current_remaining_bytes = 0 ; } } else { as -> current_remaining_bytes -- ; } } 