void synproxy_init_timestamp_cookie ( const struct nf_synproxy_info * info , struct synproxy_options * opts ) { opts -> tsecr = opts -> tsval ; if ( opts -> options & NF_SYNPROXY_OPT_WSCALE ) { opts -> tsval |= opts -> wscale ; opts -> wscale = info -> wscale ; } else { opts -> tsval |= 0xf ; } if ( opts -> options & NF_SYNPROXY_OPT_SACK_PERM ) { opts -> tsval |= 1 << 4 ; } if ( opts -> options & NF_SYNPROXY_OPT_ECN ) { opts -> tsval |= 1 << 5 ; } } 