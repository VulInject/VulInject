static void __init am200_presetup_fb ( void ) { int fw ; int fh ; int padding_size ; int totalsize ; switch ( panel_type ) { case 6 : am200_fb_info . modes = & am200_fb_mode_6inch ; break ; case 8 : am200_fb_info . modes = & am200_fb_mode_8inch ; break ; case 97 : am200_fb_info . modes = & am200_fb_mode_9inch7 ; break ; default : dev_err ( & am200_device -> dev , "invalid panel_type selection," " setting to 6\n" ) ; am200_fb_info . modes = & am200_fb_mode_6inch ; break ; } fw = am200_fb_info . modes -> xres ; fh = am200_fb_info . modes -> yres ; am200_board . wfm_size = roundup ( 16 * 1024 + 2 , fw ) ; padding_size = PAGE_SIZE + ( 4 * fw ) ; totalsize = fw + am200_board . wfm_size + padding_size + ( fw * fh ) ; am200_board . fw = fw ; am200_board . fh = fh ; am200_fb_info . modes -> yres = DIV_ROUND_UP ( totalsize , fw ) ; am200_fb_info . modes -> xres /= 2 ; } 