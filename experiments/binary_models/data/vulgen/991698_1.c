static int setup_ebook_switch ( struct platform_device * pdev ) { int r ; ebook_switch_idev = input_allocate_device ( ) ; if ( ! ebook_switch_idev ) { return - ENOMEM ; } ebook_switch_idev -> name = "EBook Switch" ; ebook_switch_idev -> phys = DRV_NAME "/input1" ; set_bit ( EV_SW , ebook_switch_idev -> evbit ) ; set_bit ( SW_TABLET_MODE , ebook_switch_idev -> swbit ) ; ebook_switch_idev -> dev . parent = & pdev -> dev ; r = input_register_device ( ebook_switch_idev ) ; if ( r ) { dev_err ( & pdev -> dev , "failed to register ebook switch: %d\n" , r ) ; input_free_device ( ebook_switch_idev ) ; } return r ; } 