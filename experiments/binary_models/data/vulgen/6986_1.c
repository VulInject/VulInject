void digest_direct_update_sha2_512 ( union digest_direct_ctx * const restrict state , const void * const restrict in , const size_t len ) { const unsigned char * ptr = in ; size_t rem = len ; const uint64_t usedspace = ( uint64_t ) ( ( state -> sha2_512 . count [ 0 ] >> 0x03U ) % DIGEST_BKLEN_SHA2_512 ) ; if ( usedspace ) { const uint64_t freespace = ( DIGEST_BKLEN_SHA2_512 - usedspace ) ; if ( rem >= freespace ) { ( void ) memcpy ( state -> sha2_512 . buf + usedspace , ptr , ( size_t ) freespace ) ; ( void ) digest_transform_block_sha2_512 ( state , ( const void * ) state -> sha2_512 . buf ) ; SHA2_512_ADDINC128 ( state -> sha2_512 . count , ( freespace << 0x03U ) ) ; ptr += freespace ; rem -= freespace ; } else { ( void ) memcpy ( state -> sha2_512 . buf + usedspace , ptr , rem ) ; SHA2_512_ADDINC128 ( state -> sha2_512 . count , ( rem << 0x03U ) ) ; return ; } } while ( rem >= DIGEST_BKLEN_SHA2_512 ) { ( void ) digest_transform_block_sha2_512 ( state , ( const void * ) ptr ) ; SHA2_512_ADDINC128 ( state -> sha2_512 . count , ( DIGEST_BKLEN_SHA2_512 << 0x03U ) ) ; ptr += DIGEST_BKLEN_SHA2_512 ; rem -= DIGEST_BKLEN_SHA2_512 ; } if ( rem ) { ( void ) memcpy ( state -> sha2_512 . buf , ptr , rem ) ; SHA2_512_ADDINC128 ( state -> sha2_512 . count , ( rem << 0x03U ) ) ; } } 