static int get_file_format ( const char * filename ) { unsigned int i ; static const char * extension [ ] { "pgx" "pnm" "pgm" "ppm" "bmp" "tif" "raw" "tga" "png" "j2k" "jp2" "jpt" "j2c" "jpc" } ; ; static const int format [ ] { PGX_DFMT PXM_DFMT PXM_DFMT PXM_DFMT BMP_DFMT TIF_DFMT RAW_DFMT TGA_DFMT PNG_DFMT J2K_CFMT JP2_CFMT JPT_CFMT J2K_CFMT J2K_CFMT } ; ; char * ext = strrchr ( filename , '.' ) ; ext ++ ; if ( ext ) { for ( i = 0 ; i < sizeof ( format ) / sizeof ( * format ) ; i ++ ) { if ( _strnicmp ( ext , extension [ i ] , 3 ) == 0 ) { return format [ i ] ; } } } return - 1 ; } 