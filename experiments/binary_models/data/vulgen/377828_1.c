static void set_stats_message_type ( packet_info * pinfo , int type ) static const guint8 * st_str_packets = "Total Packets" ; static const guint8 * st_str_packet_types = "NGAP Packet Types" ; static int st_node_packets = - 1 ; static int st_node_packet_types = - 1 ; static int ngap_tap = - 1 ; ngap_tap_t { gint ngap_mtype ; } static const value_string mtype_names [ ] { { MTYPE_AMF_CONFIGURATION_UPDATE "AMFConfigurationUpdate" } { MTYPE_AMF_CONFIGURATION_UPDATE_ACK "AMFConfigurationUpdateAcknowledge" } { MTYPE_AMF_CONFIGURATION_UPDATE_FAILURE "AMFConfigurationUpdateFailure" } { MTYPE_AMF_CP_RELOCATION_IND "AMFCPRelocationIndication" } { MTYPE_AMF_STATUS_IND "AMFStatusIndication" } { MTYPE_BROADCAST_SESSION_MODIFICATION_REQUEST "BroadcastSessionModificationRequest" } { MTYPE_BROADCAST_SESSION_MODIFICATION_RESPONSE "BroadcastSessionModificationResponse" } { MTYPE_BROADCAST_SESSION_MODIFICATION_FAILURE "BroadcastSessionModificationFailure" } { MTYPE_BROADCAST_SESSION_RELEASE_REQUEST "BroadcastSessionReleaseRequest" } { MTYPE_BROADCAST_SESSION_RELEASE_RESPONSE "BroadcastSessionReleaseResponse" } { MTYPE_BROADCAST_SESSION_RELEASE_REQUIRED "BroadcastSessionReleaseRequired" } { MTYPE_BROADCAST_SESSION_SETUP_REQUEST "BroadcastSessionSetupRequest" } { MTYPE_BROADCAST_SESSION_SETUP_RESPONSE "BroadcastSessionSetupResponse" } { MTYPE_BROADCAST_SESSION_SETUP_FAILURE "BroadcastSessionSetupFailure" } { MTYPE_CELL_TRAFFIC_TRACE "CellTrafficTrace" } { MTYPE_CONNECTION_ESTAB_IND "ConnectionEstablishmentIndication" } { MTYPE_DEACTIVATE_TRACE "DeactivateTrace" } { MTYPE_DISTRIBUTION_SETUP_REQUEST "DistributionSetupRequest" } { MTYPE_DISTRIBUTION_SETUP_RESPONSE "DistributionSetupResponse" } { MTYPE_DISTRIBUTION_SETUP_FAILURE "DistributionSetupFailure" } { MTYPE_DISTRIBUTION_RELEASE_REQUEST "DistributionReleaseRequest" } { MTYPE_DISTRIBUTION_RELEASE_RESPONSE "DistributionReleaseResponse" } { MTYPE_DOWNLINK_NAS_TRANSPORT "DownlinkNASTransport" } { MTYPE_DOWNLINK_NON_UE_ASSOCIATED_NR_PPA_TRANSPORT "DownlinkNonUEAssociatedNRPPaTransport" } { MTYPE_DOWNLINK_RAN_CONFIGURATION_TRANSFER "DownlinkRANConfigurationTransfer" } { MTYPE_DOWNLINK_RAN_EARLY_STATUS_TRANSFER "DownlinkRANEarlyStatusTransfer" } { MTYPE_DOWNLINK_RAN_STATUS_TRANSFER "DownlinkRANStatusTransfer" } { MTYPE_DOWNLINK_UE_ASSOCIATED_NR_PPA_TRANSPORT "DownlinkUEAssociatedNRPPaTransport" } { MTYPE_ERROR_INDICATION "ErrorIndication" } { MTYPE_HANDOVER_CANCEL "HandoverCancel" } { MTYPE_HANDOVER_CANCEL_ACK "HandoverCancelAcknowledge" } { MTYPE_HANDOVER_NOTIFY "HandoverNotify" } { MTYPE_HANDOVER_REQUIRED "HandoverRequired" } { MTYPE_HANDOVER_COMMAND "HandoverCommand" } { MTYPE_HANDOVER_PREPARATION_FAILURE "HandoverPreparationFailure" } { MTYPE_HANDOVER_REQUEST "HandoverRequest" } { MTYPE_HANDOVER_REQUEST_ACK "HandoverRequestAcknowledge" } { MTYPE_HANDOVER_FAILURE "HandoverFailure" } { MTYPE_HANDOVER_SUCCESS "HandoverSuccess" } { MTYPE_INITIAL_CONTEXT_SETUP_REQUEST "InitialContextSetupRequest" } { MTYPE_INITIAL_CONTEXT_SETUP_RESPONSE "InitialContextSetupResponse" } { MTYPE_INITIAL_CONTEXT_SETUP_FAILURE "InitialContextSetupFailure" } { MTYPE_INITIAL_CONTEXT_SETUP_FAILURE "InitialContextSetupFailure" } { MTYPE_INITIAL_UE_MESSAGE "InitialUEMessage" } { MTYPE_LOCATION_REPORT "LocationReport" } { MTYPE_LOCATION_REPORTING_CONTROL "LocationReportingControl" } { MTYPE_LOCATION_REPORTING_FAILURE_IND "LocationReportingFailureIndication" } { MTYPE_MULTICAST_SESSION_ACTIVATION_REQUEST "MulticastSessionActivationRequest" } { MTYPE_MULTICAST_SESSION_ACTIVATION_RESPONSE "MulticastSessionActivationResponse" } { MTYPE_MULTICAST_SESSION_ACTIVATION_FAILURE "MulticastSessionActivationFailure" } { MTYPE_MULTICAST_SESSION_DEACTIVATION_REQUEST "MulticastSessionDeactivationRequest" } { MTYPE_MULTICAST_SESSION_DEACTIVATION_RESPONSE "MulticastSessionDeactivationResponse" } { MTYPE_MULTICAST_SESSION_UPDATE_REQUEST "MulticastSessionUpdateRequest" } { MTYPE_MULTICAST_SESSION_UPDATE_RESPONSE "MulticastSessionUpdateResponse" } { MTYPE_MULTICAST_SESSION_UPDATE_FAILURE "MulticastSessionUpdateFailure" } { MTYPE_MULTICAST_GROUP_PAGING "MulticastGroupPaging" } { MTYPE_NAS_NON_DELIVERY_IND "NASNonDeliveryIndication" } { MTYPE_NG_RESET "NGReset" } { MTYPE_NG_RESET_ACK "NGResetAcknowledge" } { MTYPE_NG_SETUP_REQUEST "NGSetupRequest" } { MTYPE_NG_SETUP_RESPONSE "NGSetupResponse" } { MTYPE_NG_SETUP_FAILURE "NGSetupFailure" } { MTYPE_OVERLOAD_START "OverloadStart" } { MTYPE_OVERLOAD_STOP "OverloadStop" } { MTYPE_PAGING "Paging" } { MTYPE_PATH_SWITCH_REQUEST "PathSwitchRequest" } { MTYPE_PATH_SWITCH_REQUEST_ACK "PathSwitchRequestAcknowledge" } { MTYPE_PATH_SWITCH_REQUEST_FAILURE "PathSwitchRequestFailure" } { MTYPE_PDU_SESSION_RESOURCE_MODIFY_REQUEST "PDUSessionResourceModifyRequest" } { MTYPE_PDU_SESSION_RESOURCE_MODIFY_RESPONSE "PDUSessionResourceModifyResponse" } { MTYPE_PDU_SESSION_RESOURCE_MODIFY_IND "PDUSessionResourceModifyIndication" } { MTYPE_PDU_SESSION_RESOURCE_MODIFY_CONFIRM "PDUSessionResourceModifyConfirm" } { MTYPE_PDU_SESSION_RESOURCE_NOTIFY "PDUSessionResourceNotify" } { MTYPE_PDU_SESSION_RESOURCE_RELEASE_COMMAND "PDUSessionResourceReleaseCommand" } { MTYPE_PDU_SESSION_RESOURCE_RELEASE_RESPONSE "PDUSessionResourceReleaseResponse" } { MTYPE_PDU_SESSION_RESOURCE_SETUP_REQUEST "PDUSessionResourceSetupRequest" } { MTYPE_PDU_SESSION_RESOURCE_SETUP_RESPONSE "PDUSessionResourceSetupResponse" } { MTYPE_PRIVATE_MESSAGE "PrivateMessage" } { MTYPE_PWS_CANCEL_REQUEST "PWSCancelRequest" } { MTYPE_PWS_CANCEL_RESPONSE "PWSCancelResponse" } { MTYPE_PWS_FAILURE_INDICATION "PWSFailureIndication" } { MTYPE_PWS_RESTART_INDICATION "PWSRestartIndication" } { MTYPE_RAN_CONFIGURATION_UPDATE "RANConfigurationUpdate" } { MTYPE_RAN_CONFIGURATION_UPDATE_ACK "RANConfigurationUpdateAcknowledge" } { MTYPE_RAN_CONFIGURATION_UPDATE_FAILURE "RANConfigurationUpdateFailure" } { MTYPE_RAN_CP_RELOCATION_IND "RANCPRelocationIndication" } { MTYPE_REROUTE_NAS_REQUEST "RerouteNASRequest" } { MTYPE_RETRIEVE_UE_INFORMATION "RetrieveUEInformation" } { MTYPE_RRC_INACTIVE_TRANSITION_REPORT "RRCInactiveTransitionReport" } { MTYPE_SECONDARY_RAT_DATA_USAGE_REPORT "SecondaryRATDataUsageReport" } { MTYPE_TRACE_FAILURE_IND "TraceFailureIndication" } { MTYPE_TRACE_START "TraceStart" } { MTYPE_UE_CONTEXT_MODIFICATION_REQUEST "UEContextModificationRequest" } { MTYPE_UE_CONTEXT_MODIFICATION_RESPONSE "UEContextModificationResponse" } { MTYPE_UE_CONTEXT_MODIFICATION_FAILURE "UEContextModificationFailure" } { MTYPE_UE_CONTEXT_RELEASE_COMMAND "UEContextReleaseCommand" } { MTYPE_UE_CONTEXT_RELEASE_COMPLETE "UEContextReleaseComplete" } { MTYPE_UE_CONTEXT_RELEASE_REQUEST "UEContextReleaseRequest" } { MTYPE_UE_CONTEXT_RESUME_REQUEST "UEContextResumeRequest" } { MTYPE_UE_CONTEXT_RESUME_RESPONSE "UEContextResumeResponse" } { MTYPE_UE_CONTEXT_RESUME_FAILURE "UEContextResumeFailure" } { MTYPE_UE_CONTEXT_SUSPEND_REQUEST "UEContextSuspendRequest" } { MTYPE_UE_CONTEXT_SUSPEND_RESPONSE "UEContextSuspendResponse" } { MTYPE_UE_CONTEXT_SUSPEND_FAILURE "UEContextSuspendFailure" } { MTYPE_UE_INFORMATION_TRANSFER "UEInformationTransfer" } { MTYPE_UE_RADIO_CAPABILITY_CHECK_REQUEST "UERadioCapabilityCheckRequest" } { MTYPE_UE_RADIO_CAPABILITY_CHECK_RESPONSE "UERadioCapabilityCheckResponse" } { MTYPE_UE_RADIO_CAPABILITY_ID_MAPPING_REQUEST "UERadioCapabilityIDMappingRequest" } { MTYPE_UE_RADIO_CAPABILITY_ID_MAPPING_RESPONSE "UERadioCapabilityIDMappingResponse" } { MTYPE_UE_RADIO_CAPABILITY_INFO_IND "UERadioCapabilityInfoIndication" } { MTYPE_UE_TN_LAB_BINDING_RELEASE_REQUEST "UETNLABindingReleaseRequest" } { MTYPE_UPLINK_NAS_TRANSPORT "UplinkNASTransport" } { MTYPE_UPLINK_NON_UE_ASSOCIATED_NR_PPA_TRANSPORT "UplinkNonUEAssociatedNRPPaTransport" } { MTYPE_UPLINK_RAN_CONFIGURATION_TRANSFER "UplinkRANConfigurationTransfer" } { MTYPE_UPLINK_RAN_EARLY_STATUS_TRANSFER "UplinkRANEarlyStatusTransfer" } { MTYPE_UPLINK_RAN_STATUS_TRANSFER "UplinkRANStatusTransfer" } { MTYPE_UPLINK_UE_ASSOCIATED_NR_PPA_TRANSPORT "UplinkUEAssociatedNRPPaTransport" } { MTYPE_WRITE_REPLACE_WARNING_REQUEST "WriteReplaceWarningRequest" } { MTYPE_WRITE_REPLACE_WARNING_RESPONSE "WriteReplaceWarningResponse" } { MTYPE_UPLINK_RIM_INFORMATION_TRANSFER "UplinkRIMInformationTransfer" } { MTYPE_DOWNLINK_RIM_INFORMATION_TRANSFER "DownlinkRIMInformationTransfer" } { 0 NULL } } ; ; _ngap_ctx_t { guint32 message_type ; guint32 ProcedureCode ; guint32 ProtocolIE_ID ; guint32 ProtocolExtensionID ; } ngap_ctx_t ngap_conv_info { address addr_a ; guint32 port_a ; GlobalRANNodeID_enum ranmode_id_a ; address addr_b ; guint32 port_b ; GlobalRANNodeID_enum ranmode_id_b ; wmem_map_t * nbiot_ta ; wmem_tree_t * nbiot_ran_ue_ngap_id ; } { SOURCE_TO_TARGET_TRANSPARENT_CONTAINER = 1 , TARGET_TO_SOURCE_TRANSPARENT_CONTAINER } ngap_supported_ta { guint32 tac ; wmem_array_t * plmn ; } ngap_tai { guint32 plmn ; guint32 tac ; } ngap_private_data { struct ngap_conv_info * ngap_conv ; guint32 procedure_code ; guint32 protocol_ie_id ; guint32 protocol_extension_id ; guint32 message_type ; guint32 handover_type_value ; guint8 data_coding_scheme ; guint8 transparent_container_type ; gboolean is_qos_flow_notify ; struct ngap_supported_ta * supported_ta ; struct ngap_tai * tai ; guint32 ran_ue_ngap_id ; e212_number_type_t number_type ; struct ngap_tap_t * stats_tap ; } { NGAP_NG_RAN_CONTAINER_AUTOMATIC , NGAP_NG_RAN_CONTAINER_GNB , NGAP_NG_RAN_CONTAINER_NG_ENB } static const enum_val_t ngap_target_ng_ran_container_vals [ ] { { "automatic" "automatic" NGAP_NG_RAN_CONTAINER_AUTOMATIC } { "gnb" "gNB" NGAP_NG_RAN_CONTAINER_GNB } { "ng-enb" "ng-eNB" NGAP_NG_RAN_CONTAINER_NG_ENB } { NULL NULL - 1 } } ; ; { NGAP_LTE_CONTAINER_AUTOMATIC , NGAP_LTE_CONTAINER_LEGACY , NGAP_LTE_CONTAINER_NBIOT } static const enum_val_t ngap_lte_container_vals [ ] { { "automatic" "Automatic" NGAP_LTE_CONTAINER_AUTOMATIC } { "legacy" "Legacy LTE" NGAP_LTE_CONTAINER_LEGACY } { "nb-iot" "NB-IoT" NGAP_LTE_CONTAINER_NBIOT } { NULL NULL - 1 } } ; ; static range_t * gbl_ngapSctpRange = NULL ; static gboolean ngap_dissect_container = TRUE ; static gint ngap_dissect_target_ng_ran_container_as = NGAP_NG_RAN_CONTAINER_AUTOMATIC ; static gint ngap_dissect_lte_container_as = NGAP_LTE_CONTAINER_AUTOMATIC ; static dissector_table_t ngap_ies_dissector_table ; static dissector_table_t ngap_ies_p1_dissector_table ; static dissector_table_t ngap_ies_p2_dissector_table ; static dissector_table_t ngap_extension_dissector_table ; static dissector_table_t ngap_proc_imsg_dissector_table ; static dissector_table_t ngap_proc_sout_dissector_table ; static dissector_table_t ngap_proc_uout_dissector_table ; static dissector_table_t ngap_n2_ie_type_dissector_table ; static proto_tree * top_tree = NULL ; static void set_message_label ( asn1_ctx_t * actx , int type ) { const char * label = val_to_str_const ( type , mtype_names , "Unknown" ) ; col_append_sep_str ( actx -> pinfo -> cinfo , COL_INFO , NULL , label ) ; } 