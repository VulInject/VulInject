int dpl_check_pv ( str * in ) { char * p ; pv_spec_t * spec = NULL ; str s ; int len ; if ( in == NULL || in -> s == NULL ) { return - 1 ; } LM_DBG ( "parsing [%.*s]\n" , in -> len , in -> s ) ; p = in -> s ; while ( is_in_str ( p , in ) ) { while ( is_in_str ( p , in ) && * p != PV_MARKER ) { p ++ ; } if ( * p == '\0' || ! is_in_str ( p , in ) ) { break ; } if ( ! is_in_str ( p + 1 , in ) ) { break ; } s . s = p ; s . len = in -> s + in -> len - p ; len = 0 ; spec = pv_spec_lookup ( & s , & len ) ; if ( spec != NULL ) { LM_DBG ( "string [%.*s] has variables\n" , in -> len , in -> s ) ; return 0 ; } if ( len ) { p += len ; } else { p ++ ; } } return 1 ; } 