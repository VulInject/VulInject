int scan_label ( char * devopts , char * progname ) { char * tok = NULL ; char * lasts , * optsarg ; if ( devopts == NULL ) { return ( 0 ) ; } if ( ( optsarg = strdup ( devopts ) ) == NULL ) { return ( 1 ) ; } if ( ( tok = strtok_r ( optsarg , KV_TOKEN_DELIMIT , & lasts ) ) == NULL ) { return ( 1 ) ; } if ( verify_label ( tok , progname ) != 0 ) { return ( 1 ) ; } while ( ( tok = strtok_r ( NULL , KV_TOKEN_DELIMIT , & lasts ) ) != NULL ) { if ( verify_label ( tok , progname ) != 0 ) { free ( optsarg ) ; return ( 1 ) ; } } return ( 0 ) ; } 