guint c_dissect_msg_osd_boot ( proto_tree * root , tvbuff_t * tvb , guint front_len , guint middle_len _U_ , guint data_len _U_ , c_pkt_data * data ) { proto_item * ti ; proto_tree * tree ; guint off = 0 ; guint32 i ; c_set_type ( data , "OSD Boot" ) ; off = c_dissect_paxos ( root , tvb , off , data ) ; ti = proto_tree_add_item ( root , hf_msg_osd_boot , tvb , off , front_len , ENC_NA ) ; off = c_dissect_osd_superblock ( tree , tvb , off , data ) ; off = c_dissect_entityaddr ( tree , hf_msg_osd_boot_addr_back , NULL , tvb , off ) ; if ( data -> header . ver >= 2 ) { off = c_dissect_entityaddr ( tree , hf_msg_osd_boot_addr_cluster , NULL , tvb , off ) ; } if ( data -> header . ver >= 3 ) { proto_tree_add_item ( tree , hf_msg_osd_boot_epoch , tvb , off , 4 , ENC_LITTLE_ENDIAN ) ; off += 4 ; } if ( data -> header . ver >= 4 ) { off = c_dissect_entityaddr ( tree , hf_msg_osd_boot_addr_front , NULL , tvb , off ) ; } if ( data -> header . ver >= 5 ) { i = tvb_get_letohl ( tvb , off ) ; off += 4 ; while ( i -- ) { off = c_dissect_kv ( tree , hf_msg_osd_boot_metadata , hf_msg_osd_boot_metadata_k , hf_msg_osd_boot_metadata_v , tvb , off ) ; } } return off ; } 