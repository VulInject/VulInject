void ocelot_fdma_deinit ( struct ocelot * ocelot ) { ocelot_fdma_writel ( ocelot , MSCC_FDMA_INTR_ENA , 0 ) ; ocelot_fdma_writel ( ocelot , MSCC_FDMA_CH_FORCEDIS , BIT ( MSCC_FDMA_XTR_CHAN ) ) ; ocelot_fdma_writel ( ocelot , MSCC_FDMA_CH_FORCEDIS , BIT ( MSCC_FDMA_INJ_CHAN ) ) ; napi_synchronize ( & fdma -> napi ) ; napi_disable ( & fdma -> napi ) ; ocelot_fdma_free_rx_ring ( ocelot ) ; ocelot_fdma_free_tx_ring ( ocelot ) ; } 