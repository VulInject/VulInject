krb5_error_code KRB5_CALLCONV krb5_c_random_make_octets ( krb5_context context , krb5_data * data ) { krb5_error_code err = 0 ; CK_RV rv ; KRB5_LOG0 ( KRB5_INFO , "krb5_c_random_make_octets() start, user space using " "krb5_get_random_octets()\n" ) ; if ( rv != CKR_OK ) { KRB5_LOG ( KRB5_ERR , "C_GenerateRandom failed in " "krb5_c_random_make_octets: rv = 0x%x." , rv ) ; err = PKCS_ERR ; } if ( err != 0 ) { KRB5_LOG0 ( KRB5_ERR , "krb5_c_random_make_octets() end, error" ) ; return ( err ) ; } KRB5_LOG0 ( KRB5_INFO , "krb5_c_random_make_octets() start, kernel using " "random_get_pseudo_bytes()\n " ) ; if ( random_get_pseudo_bytes ( ( uint8_t * ) data -> data , data -> length ) != 0 ) { KRB5_LOG0 ( KRB5_ERR , "krb5_c_random_make_octets() end, " "random_get_pseudo_bytes() error.\n" ) ; return ( KRB5_CRYPTO_INTERNAL ) ; } KRB5_LOG0 ( KRB5_INFO , "krb5_c_random_make_octets() end\n" ) ; return ( 0 ) ; } 