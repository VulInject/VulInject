static bool on_option ( char key , char * value ) { switch ( key ) { case 'c' : ctx . signing_key . ctx_path = value ; break ; case 'p' : ctx . signing_key . auth_str = value ; break ; case 'g' : ctx . halg = tpm2_alg_util_from_optarg ( value , tpm2_alg_util_flags_hash ) ; if ( ctx . halg == TPM2_ALG_ERROR ) { LOG_ERR ( "Could not convert to number or lookup algorithm, got: " "\"%s\"" , value ) ; return false ; } break ; case 's' : { ctx . sig_scheme = tpm2_alg_util_from_optarg ( value , tpm2_alg_util_flags_sig ) ; if ( ctx . sig_scheme == TPM2_ALG_ERROR ) { LOG_ERR ( "Unknown signing scheme, got: \"%s\"" , value ) ; return false ; } } break ; case 'd' : ctx . is_input_msg_digest = true ; break ; case 't' : { bool result = files_load_validation ( value , & ctx . validation ) ; if ( ! result ) { return false ; } ctx . is_hash_ticket_specified = true ; } break ; case 'o' : ctx . output_path = value ; break ; case 0 : ctx . cp_hash_path = value ; break ; case 1 : ctx . commit_index = value ; break ; case 'f' : ctx . sig_format = tpm2_convert_sig_fmt_from_optarg ( value ) ; } return true ; } 