void * trace_event_buffer_reserve ( struct trace_event_buffer * fbuffer , struct trace_event_file * trace_file , unsigned long len ) { struct trace_event_call * event_call = trace_file -> event_call ; if ( ( trace_file -> flags & EVENT_FILE_FL_PID_FILTER ) && trace_event_ignore_this_pid ( trace_file ) ) { return NULL ; } fbuffer -> trace_ctx = tracing_gen_ctx_dec ( ) ; fbuffer -> trace_file = trace_file ; fbuffer -> event = trace_event_buffer_lock_reserve ( & fbuffer -> buffer , trace_file , event_call -> event . type , len , fbuffer -> trace_ctx ) ; if ( ! fbuffer -> event ) { return NULL ; } fbuffer -> entry = ring_buffer_event_data ( fbuffer -> event ) ; return fbuffer -> entry ; } 