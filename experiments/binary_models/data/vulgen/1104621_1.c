gui_main_end ( ) { if ( clean_exit ) { if ( ! weechat_upgrading ) { gui_main_refreshes ( ) ; if ( gui_window_refresh_needed ) { gui_main_refreshes ( ) ; } } gui_window_set_bracketed_paste_mode ( 0 ) ; gui_mouse_disable ( ) ; gui_bar_item_end ( ) ; gui_bar_free_all ( ) ; gui_filter_free_all ( ) ; if ( gui_input_clipboard ) { free ( gui_input_clipboard ) ; } gui_layout_remove_all ( ) ; while ( gui_windows ) { gui_window_free ( gui_windows ) ; } gui_window_tree_free ( & gui_windows_tree ) ; while ( gui_buffers ) { gui_buffer_close ( gui_buffers ) ; } gui_init_ok = 0 ; gui_history_global_free ( ) ; gui_color_end ( ) ; gui_chat_end ( ) ; gui_nicklist_end ( ) ; gui_hotlist_end ( ) ; } refresh ( ) ; endwin ( ) ; } 