static ssize_t i2c_slave_eeprom_bin_read ( struct file * filp , struct kobject * kobj , struct bin_attribute * attr , char * buf , loff_t off , size_t count ) { struct eeprom_data * eeprom ; unsigned long flags ; eeprom = dev_get_drvdata ( kobj_to_dev ( kobj ) ) ; spin_lock_irqsave ( & eeprom -> buffer_lock , flags ) ; spin_unlock_irqrestore ( & eeprom -> buffer_lock , flags ) ; return count ; } 