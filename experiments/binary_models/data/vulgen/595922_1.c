void test_bind ( const char * path ) { int sfd ; struct sockaddr_un my_addr ; sfd = socket ( AF_UNIX , SOCK_STREAM , 0 ) ; memset ( & my_addr , 0 , sizeof ( sockaddr_un ) ) ; my_addr . sun_family = AF_UNIX ; strncpy ( my_addr . sun_path , path , sizeof ( my_addr . sun_path ) - 1 ) ; if ( bind ( sfd , ( sockaddr * ) & my_addr , sizeof ( sockaddr_un ) ) != - 1 ) { fprintf ( stderr , "leak at bind of %s\n" , path ) ; exit ( 1 ) ; } if ( errno != ENOENT && errno != ENOSYS ) { fprintf ( stderr , "leak at bind of %s: errno was %s\n" , path , strerror ( errno ) ) ; exit ( 1 ) ; } close ( sfd ) ; } 