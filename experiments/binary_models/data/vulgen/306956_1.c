static krb5_error_code pkinit_create_edata ( krb5_context context , pkinit_plg_crypto_context plg_cryptoctx , pkinit_req_crypto_context req_cryptoctx , pkinit_identity_crypto_context id_cryptoctx , pkinit_plg_opts * opts , krb5_error_code err_code , krb5_pa_data * * * e_data_out ) { krb5_error_code retval = KRB5KRB_ERR_GENERIC ; pkiDebug ( "pkinit_create_edata: creating edata for error %d (%s)\n" , err_code , error_message ( err_code ) ) ; switch ( err_code ) { case KRB5KDC_ERR_CANT_VERIFY_CERTIFICATE : retval = pkinit_create_td_trusted_certifiers ( context , plg_cryptoctx , req_cryptoctx , id_cryptoctx , e_data_out ) ; break ; case KRB5KDC_ERR_DH_KEY_PARAMETERS_NOT_ACCEPTED : break ; case KRB5KDC_ERR_INVALID_CERTIFICATE : case KRB5KDC_ERR_REVOKED_CERTIFICATE : retval = pkinit_create_td_invalid_certificate ( context , plg_cryptoctx , req_cryptoctx , id_cryptoctx , e_data_out ) ; break ; default : pkiDebug ( "no edata needed for error %d (%s)\n" , err_code , error_message ( err_code ) ) ; retval = 0 ; cleanup } cleanup return retval ; } 