static int cd_capability_compat ( Context * c ) { int capability , r ; assert ( c ) ; if ( capability < 0 ) { return log_debug_errno ( errno , "CDROM_GET_CAPABILITY failed" ) ; } if ( capability & CDC_CD_R ) { r = set_drive_feature ( c , FEATURE_CD_R ) ; if ( r < 0 ) { return log_oom_debug ( ) ; } } if ( capability & CDC_CD_RW ) { r = set_drive_feature ( c , FEATURE_CD_RW ) ; if ( r < 0 ) { return log_oom_debug ( ) ; } } if ( capability & CDC_DVD ) { r = set_drive_feature ( c , FEATURE_DVD_ROM ) ; if ( r < 0 ) { return log_oom_debug ( ) ; } } if ( capability & CDC_DVD_R ) { r = set_drive_feature ( c , FEATURE_DVD_R ) ; if ( r < 0 ) { return log_oom_debug ( ) ; } } if ( capability & CDC_DVD_RAM ) { r = set_drive_feature ( c , FEATURE_DVD_RAM ) ; if ( r < 0 ) { return log_oom_debug ( ) ; } } if ( capability & CDC_MRW ) { r = set_drive_feature ( c , FEATURE_MRW ) ; if ( r < 0 ) { return log_oom_debug ( ) ; } } if ( capability & CDC_MRW_W ) { r = set_drive_feature ( c , FEATURE_MRW_W ) ; if ( r < 0 ) { return log_oom_debug ( ) ; } } return 0 ; } 