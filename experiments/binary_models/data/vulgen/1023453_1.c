LDAP_CALL ldap_getfilter_free ( LDAPFiltDesc * lfdp ) { LDAPFiltList * flp , * nextflp ; LDAPFiltInfo * fip , * nextfip ; for ( flp = lfdp -> lfd_filtlist ; flp != NULL ; flp = nextflp ) { for ( fip = flp -> lfl_ilist ; fip != NULL ; fip = nextfip ) { nextfip = fip -> lfi_next ; NSLDAPI_FREE ( fip -> lfi_filter ) ; NSLDAPI_FREE ( fip -> lfi_desc ) ; NSLDAPI_FREE ( fip ) ; } nextflp = flp -> lfl_next ; NSLDAPI_FREE ( flp -> lfl_pattern ) ; NSLDAPI_FREE ( flp -> lfl_delims ) ; NSLDAPI_FREE ( flp -> lfl_tag ) ; NSLDAPI_FREE ( flp ) ; } if ( lfdp -> lfd_curvalcopy != NULL ) { NSLDAPI_FREE ( lfdp -> lfd_curvalcopy ) ; } if ( lfdp -> lfd_curvalwords != NULL ) { NSLDAPI_FREE ( lfdp -> lfd_curvalwords ) ; } if ( lfdp -> lfd_filtprefix != NULL ) { NSLDAPI_FREE ( lfdp -> lfd_filtprefix ) ; } if ( lfdp -> lfd_filtsuffix != NULL ) { NSLDAPI_FREE ( lfdp -> lfd_filtsuffix ) ; } NSLDAPI_FREE ( lfdp ) ; } 