struct mlx5_flow_definer * mlx5_create_match_definer ( struct mlx5_core_dev * dev , enum mlx5_flow_namespace_type ns_type , u16 format_id , u32 * match_mask ) { struct mlx5_flow_root_namespace * root ; struct mlx5_flow_definer * definer ; int id ; root = get_root_namespace ( dev , ns_type ) ; if ( ! root ) { return ERR_PTR ( - EOPNOTSUPP ) ; } definer = kzalloc ( sizeof ( * definer ) , GFP_KERNEL ) ; if ( ! definer ) { return ERR_PTR ( - ENOMEM ) ; } definer -> ns_type = ns_type ; id = root -> cmds -> create_match_definer ( root , format_id , match_mask ) ; if ( id < 0 ) { mlx5_core_warn ( root -> dev , "Failed to create match definer (%d)\n" , id ) ; return ERR_PTR ( id ) ; } definer -> id = id ; return definer ; } 