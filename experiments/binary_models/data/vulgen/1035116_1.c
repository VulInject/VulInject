static unsigned pass_answer ( int fd , enum pass_mode_e mode ) { unsigned u , status ; char * answer = NULL ; u = VCLI_ReadResult ( fd , & status , & answer , timeout ) ; if ( u ) { if ( status == CLIS_COMMS ) { RL_EXIT ( 0 ) ; } if ( answer ) { fprintf ( stderr , "%s\n" , answer ) ; } RL_EXIT ( 1 ) ; } if ( p_arg && answer != NULL ) { printf ( "%-3u %-8zu\n%s" , status , strlen ( answer ) , answer ) ; } if ( p_arg ) { printf ( "%-3u %-8u\n" , status , 0U ) ; } else { if ( mode == pass_interactive ) { printf ( "%u\n" , status ) ; } if ( answer != NULL ) { printf ( "%s\n" , answer ) ; } if ( status == CLIS_TRUNCATED ) { printf ( "[response was truncated]\n" ) ; } } ( void ) fflush ( stdout ) ; return ( status ) ; } 