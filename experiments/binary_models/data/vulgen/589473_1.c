static void secumod_cfg_input_pio ( uint8_t gpio_pin , uint32_t config ) { vaddr_t piobu_addr = 0 ; uint8_t afv = 0 ; uint8_t rfv = 0 ; uint8_t pull_mode = PIOBU_PIN_PULL_NONE ; uint8_t def_level = PIOBU_PIN_DEF_LEVEL_LOW ; assert ( gpio_pin < SECUMOD_MAX_PINS ) ; piobu_addr = secumod_base + SECUMOD_PIOBU ( gpio_pin ) ; io_clrbits32 ( piobu_addr , SECUMOD_PIOBU_OUTPUT ) ; afv = PIOBU_PIN_AFV ( config ) ; rfv = PIOBU_PIN_RFV ( config ) ; pull_mode = PIOBU_PIN_PULL_MODE ( config ) ; def_level = PIOBU_PIN_DEF_LEVEL ( config ) ; io_write32 ( piobu_addr , afv | rfv << SECUMOD_PIOBU_RFV_SHIFT | pull_mode << SECUMOD_PIOBU_PULLUP_SHIFT | def_level << SECUMOD_PIOBU_SWITCH_SHIFT ) ; gpio_set_interrupt ( & secumod_chip , gpio_pin , GPIO_INTERRUPT_ENABLE ) ; io_setbits32 ( secumod_base + SECUMOD_NMPR , SECUMOD_PIN_VAL ( gpio_pin ) ) ; if ( PIOBU_PIN_WAKEUP ( config ) ) { io_setbits32 ( secumod_base + SECUMOD_WKPR , SECUMOD_PIN_VAL ( gpio_pin ) ) ; } } 