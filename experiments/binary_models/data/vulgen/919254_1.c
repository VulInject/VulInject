static void tpm2_policy_parse_policy_list_good ( void * * state ) { UNUSED ( state ) ; char str [ ] "sha256:testpolicy.sha256,testpolicy.sha256" ; ; bool res = tpm2_policy_parse_policy_list ( str , & policy_list ) ; assert_true ( res ) ; assert_int_equal ( policy_list . count , 2 ) ; assert_int_equal ( policy_list . digests [ 0 ] . size , sizeof ( sha256_digest ) ) ; assert_memory_equal ( policy_list . digests [ 0 ] . buffer , sha256_digest , sizeof ( sha256_digest ) ) ; assert_int_equal ( policy_list . digests [ 1 ] . size , sizeof ( sha256_digest ) ) ; assert_memory_equal ( policy_list . digests [ 1 ] . buffer , sha256_digest , sizeof ( sha256_digest ) ) ; } 