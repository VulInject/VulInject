static char * setdisc ( Namval_t * np , const char * event , Namval_t * action , Namfun_t * fp ) { register Service_t * sp = ( Service_t * ) fp ; register const char * cp ; register int i ; register int n = strlen ( event ) - 1 ; register Namval_t * nq ; for ( i = 0 ; cp = disctab [ i ] ; i ++ ) { if ( memcmp ( event , cp , n ) ) { continue ; } if ( action == np ) { action = sp -> disc [ i ] ; } else { if ( nq = sp -> disc [ i ] ) { free ( 0 ) ; } if ( action ) { sp -> disc [ i ] = action ; } else { sp -> disc [ i ] = 0 ; } } return action ?( char * ) action : "" ; } return nv_setdisc ( np , event , action , fp ) ; } 