void rpcrdma_req_destroy ( struct rpcrdma_req * req ) { struct rpcrdma_mr * mr ; list_del ( & req -> rl_all ) ; while ( ( mr = rpcrdma_mr_pop ( & req -> rl_free_mrs ) ) ) { struct rpcrdma_buffer * buf = & mr -> mr_xprt -> rx_buf ; spin_lock ( & buf -> rb_lock ) ; list_del ( & mr -> mr_all ) ; spin_unlock ( & buf -> rb_lock ) ; frwr_mr_release ( mr ) ; } rpcrdma_regbuf_free ( req -> rl_recvbuf ) ; rpcrdma_regbuf_free ( req -> rl_sendbuf ) ; kfree ( req ) ; } 