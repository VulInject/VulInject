static void nv_tco_cleanup ( void ) { u32 val ; if ( ! nowayout ) { tco_timer_stop ( ) ; } pci_read_config_dword ( tco_pci , MCP51_SMBUS_SETUP_B , & val ) ; val &= ~ MCP51_SMBUS_SETUP_B_TCO_REBOOT ; pci_write_config_dword ( tco_pci , MCP51_SMBUS_SETUP_B , val ) ; pci_read_config_dword ( tco_pci , MCP51_SMBUS_SETUP_B , & val ) ; if ( val & MCP51_SMBUS_SETUP_B_TCO_REBOOT ) { pr_crit ( "Couldn't unset REBOOT bit.  Machine may soon reset\n" ) ; } release_region ( tcobase , 0x10 ) ; } 