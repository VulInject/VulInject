void DetectMQTTSubscribeTopicRegister ( void ) { sigmatch_table [ DETECT_AL_MQTT_SUBSCRIBE_TOPIC ] . name = "mqtt.subscribe.topic" ; sigmatch_table [ DETECT_AL_MQTT_SUBSCRIBE_TOPIC ] . desc = "sticky buffer to match MQTT SUBSCRIBE topic" ; sigmatch_table [ DETECT_AL_MQTT_SUBSCRIBE_TOPIC ] . url = "/rules/mqtt-keywords.html#mqtt-subscribe-topic" ; sigmatch_table [ DETECT_AL_MQTT_SUBSCRIBE_TOPIC ] . Setup = DetectMQTTSubscribeTopicSetup ; sigmatch_table [ DETECT_AL_MQTT_SUBSCRIBE_TOPIC ] . flags |= SIGMATCH_NOOPT ; sigmatch_table [ DETECT_AL_MQTT_SUBSCRIBE_TOPIC ] . flags |= SIGMATCH_INFO_STICKY_BUFFER ; intmax_t val = 0 ; if ( ConfGetInt ( "app-layer.protocols.mqtt.subscribe-topic-match-limit" , & val ) ) { subscribe_topic_match_limit = val ; } if ( subscribe_topic_match_limit <= 0 ) { SCLogDebug ( "Using unrestricted MQTT SUBSCRIBE topic matching" ) ; } else { SCLogDebug ( "Using MQTT SUBSCRIBE topic match-limit setting of: %u" , subscribe_topic_match_limit ) ; } DetectAppLayerMpmRegister2 ( "mqtt.subscribe.topic" , SIG_FLAG_TOSERVER , 1 , PrefilterMpmMQTTSubscribeTopicRegister , NULL , ALPROTO_MQTT , 1 ) ; DetectAppLayerInspectEngineRegister2 ( "mqtt.subscribe.topic" , ALPROTO_MQTT , SIG_FLAG_TOSERVER , 1 , DetectEngineInspectMQTTSubscribeTopic , NULL ) ; DetectBufferTypeSetDescriptionByName ( "mqtt.subscribe.topic" , "subscribe topic query" ) ; } 