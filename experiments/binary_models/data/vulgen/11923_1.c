static void block_mc ( DiracContext * s , DiracBlock * block , uint16_t * mctmp , uint8_t * obmc_weight , int plane , int dstx , int dsty ) { Plane * p = & s -> plane [ plane ] ; const uint8_t * src [ 5 ] ; int idx ; switch ( block -> ref & 3 ) { case 0 : add_dc ( mctmp , block -> u . dc [ plane ] , p -> stride , obmc_weight , p -> xblen , p -> yblen ) ; return ; case 1 : case 2 : idx = mc_subpel ( s , block , src , dstx , dsty , ( block -> ref & 3 ) - 1 , plane ) ; s -> put_pixels_tab [ idx ] ( s -> mcscratch , src , p -> stride , p -> yblen ) ; break ; case 3 : idx = mc_subpel ( s , block , src , dstx , dsty , 0 , plane ) ; s -> put_pixels_tab [ idx ] ( s -> mcscratch , src , p -> stride , p -> yblen ) ; idx = mc_subpel ( s , block , src , dstx , dsty , 1 , plane ) ; if ( s -> biweight_func ) { s -> put_pixels_tab [ idx ] ( s -> mcscratch + 32 , src , p -> stride , p -> yblen ) ; s -> biweight_func ( s -> mcscratch , s -> mcscratch + 32 , p -> stride , s -> weight_log2denom , s -> weight [ 0 ] , s -> weight [ 1 ] , p -> yblen ) ; } else { s -> avg_pixels_tab [ idx ] ( s -> mcscratch , src , p -> stride , p -> yblen ) ; } break ; } s -> add_obmc ( mctmp , s -> mcscratch , p -> stride , obmc_weight , p -> yblen ) ; } 