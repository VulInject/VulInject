struct bdi_writeback * wb_get_create ( struct backing_dev_info * bdi , struct cgroup_subsys_state * memcg_css , gfp_t gfp ) { struct bdi_writeback * wb ; might_sleep_if ( gfpflags_allow_blocking ( gfp ) ) ; { rcu_read_lock ( ) ; wb = radix_tree_lookup ( & bdi -> cgwb_tree , memcg_css -> id ) ; if ( wb ) { struct cgroup_subsys_state * blkcg_css ; blkcg_css = cgroup_get_e_css ( memcg_css -> cgroup , & io_cgrp_subsys ) ; if ( unlikely ( wb -> blkcg_css != blkcg_css || ! wb_tryget ( wb ) ) ) { wb = NULL ; } css_put ( blkcg_css ) ; } rcu_read_unlock ( ) ; } ! wb && ! cgwb_create ( bdi , memcg_css , gfp ) ; return wb ; } 