TEE_Result caam_dmaobj_input_sgtbuf ( struct caamdmaobj * obj , const void * data , size_t length ) { TEE_Result ret = TEE_ERROR_GENERIC ; size_t size_done = length ; ret = caam_dmaobj_init_input ( obj , data , length ) ; if ( ret ) { return ret ; } ret = caam_dmaobj_prepare ( obj , NULL , length ) ; if ( ret ) { return ret ; } ret = caam_dmaobj_sgtbuf_build ( obj , & size_done , 0 , length ) ; if ( ret ) { return ret ; } return TEE_SUCCESS ; } 