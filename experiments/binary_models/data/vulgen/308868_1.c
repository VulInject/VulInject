size_t ZSTD_CCtxParams_setParameter ( ZSTD_CCtx_params * CCtxParams , ZSTD_cParameter param , int value ) { DEBUGLOG ( 4 , "ZSTD_CCtxParams_setParameter (%i, %i)" , ( int ) param , value ) ; switch ( param ) { case ZSTD_c_format : BOUNDCHECK ( ZSTD_c_format , value ) ; CCtxParams -> format = ( ZSTD_format_e ) value ; return ( size_t ) CCtxParams -> format ; case ZSTD_c_compressionLevel : { if ( value == 0 ) { CCtxParams -> compressionLevel = ZSTD_CLEVEL_DEFAULT ; } else { CCtxParams -> compressionLevel = value ; } if ( CCtxParams -> compressionLevel >= 0 ) { return ( size_t ) CCtxParams -> compressionLevel ; } return 0 ; } case ZSTD_c_windowLog : if ( value != 0 ) { BOUNDCHECK ( ZSTD_c_windowLog , value ) ; } CCtxParams -> cParams . windowLog = ( U32 ) value ; return CCtxParams -> cParams . windowLog ; case ZSTD_c_hashLog : if ( value != 0 ) { BOUNDCHECK ( ZSTD_c_hashLog , value ) ; } CCtxParams -> cParams . hashLog = ( U32 ) value ; return CCtxParams -> cParams . hashLog ; case ZSTD_c_chainLog : if ( value != 0 ) { BOUNDCHECK ( ZSTD_c_chainLog , value ) ; } CCtxParams -> cParams . chainLog = ( U32 ) value ; return CCtxParams -> cParams . chainLog ; case ZSTD_c_searchLog : if ( value != 0 ) { BOUNDCHECK ( ZSTD_c_searchLog , value ) ; } CCtxParams -> cParams . searchLog = ( U32 ) value ; return ( size_t ) value ; case ZSTD_c_minMatch : if ( value != 0 ) { BOUNDCHECK ( ZSTD_c_minMatch , value ) ; } CCtxParams -> cParams . minMatch = value ; return CCtxParams -> cParams . minMatch ; case ZSTD_c_targetLength : BOUNDCHECK ( ZSTD_c_targetLength , value ) ; CCtxParams -> cParams . targetLength = value ; return CCtxParams -> cParams . targetLength ; case ZSTD_c_strategy : if ( value != 0 ) { BOUNDCHECK ( ZSTD_c_strategy , value ) ; } CCtxParams -> cParams . strategy = ( ZSTD_strategy ) value ; return ( size_t ) CCtxParams -> cParams . strategy ; case ZSTD_c_contentSizeFlag : DEBUGLOG ( 4 , "set content size flag = %u" , ( value != 0 ) ) ; CCtxParams -> fParams . contentSizeFlag = value != 0 ; return CCtxParams -> fParams . contentSizeFlag ; case ZSTD_c_checksumFlag : CCtxParams -> fParams . checksumFlag = value != 0 ; return CCtxParams -> fParams . checksumFlag ; case ZSTD_c_dictIDFlag : DEBUGLOG ( 4 , "set dictIDFlag = %u" , ( value != 0 ) ) ; CCtxParams -> fParams . noDictIDFlag = ! value ; return ! CCtxParams -> fParams . noDictIDFlag ; case ZSTD_c_forceMaxWindow : CCtxParams -> forceWindow = ( value != 0 ) ; return CCtxParams -> forceWindow ; case ZSTD_c_forceAttachDict : { const ZSTD_dictAttachPref_e pref = ( ZSTD_dictAttachPref_e ) value ; BOUNDCHECK ( ZSTD_c_forceAttachDict , pref ) ; CCtxParams -> attachDictPref = pref ; return CCtxParams -> attachDictPref ; } case ZSTD_c_literalCompressionMode : { const ZSTD_paramSwitch_e lcm = ( ZSTD_paramSwitch_e ) value ; BOUNDCHECK ( ZSTD_c_literalCompressionMode , lcm ) ; CCtxParams -> literalCompressionMode = lcm ; return CCtxParams -> literalCompressionMode ; } case ZSTD_c_nbWorkers : RETURN_ERROR_IF ( value != 0 , parameter_unsupported , "not compiled with multithreading" ) ; return 0 ; case ZSTD_c_jobSize : RETURN_ERROR_IF ( value != 0 , parameter_unsupported , "not compiled with multithreading" ) ; return 0 ; case ZSTD_c_overlapLog : RETURN_ERROR_IF ( value != 0 , parameter_unsupported , "not compiled with multithreading" ) ; return 0 ; case ZSTD_c_rsyncable : RETURN_ERROR_IF ( value != 0 , parameter_unsupported , "not compiled with multithreading" ) ; return 0 ; case ZSTD_c_enableDedicatedDictSearch : CCtxParams -> enableDedicatedDictSearch = ( value != 0 ) ; return CCtxParams -> enableDedicatedDictSearch ; case ZSTD_c_enableLongDistanceMatching : CCtxParams -> ldmParams . enableLdm = ( ZSTD_paramSwitch_e ) value ; return CCtxParams -> ldmParams . enableLdm ; case ZSTD_c_ldmHashLog : if ( value != 0 ) { BOUNDCHECK ( ZSTD_c_ldmHashLog , value ) ; } CCtxParams -> ldmParams . hashLog = value ; return CCtxParams -> ldmParams . hashLog ; case ZSTD_c_ldmMinMatch : if ( value != 0 ) { BOUNDCHECK ( ZSTD_c_ldmMinMatch , value ) ; } CCtxParams -> ldmParams . minMatchLength = value ; return CCtxParams -> ldmParams . minMatchLength ; case ZSTD_c_ldmBucketSizeLog : if ( value != 0 ) { BOUNDCHECK ( ZSTD_c_ldmBucketSizeLog , value ) ; } CCtxParams -> ldmParams . bucketSizeLog = value ; return CCtxParams -> ldmParams . bucketSizeLog ; case ZSTD_c_ldmHashRateLog : if ( value != 0 ) { BOUNDCHECK ( ZSTD_c_ldmHashRateLog , value ) ; } CCtxParams -> ldmParams . hashRateLog = value ; return CCtxParams -> ldmParams . hashRateLog ; case ZSTD_c_targetCBlockSize : if ( value != 0 ) { BOUNDCHECK ( ZSTD_c_targetCBlockSize , value ) ; } CCtxParams -> targetCBlockSize = value ; return CCtxParams -> targetCBlockSize ; case ZSTD_c_srcSizeHint : if ( value != 0 ) { BOUNDCHECK ( ZSTD_c_srcSizeHint , value ) ; } CCtxParams -> srcSizeHint = value ; return CCtxParams -> srcSizeHint ; case ZSTD_c_stableInBuffer : BOUNDCHECK ( ZSTD_c_stableInBuffer , value ) ; CCtxParams -> inBufferMode = ( ZSTD_bufferMode_e ) value ; return CCtxParams -> inBufferMode ; case ZSTD_c_stableOutBuffer : BOUNDCHECK ( ZSTD_c_stableOutBuffer , value ) ; CCtxParams -> outBufferMode = ( ZSTD_bufferMode_e ) value ; return CCtxParams -> outBufferMode ; case ZSTD_c_blockDelimiters : BOUNDCHECK ( ZSTD_c_blockDelimiters , value ) ; CCtxParams -> blockDelimiters = ( ZSTD_sequenceFormat_e ) value ; return CCtxParams -> blockDelimiters ; case ZSTD_c_validateSequences : BOUNDCHECK ( ZSTD_c_validateSequences , value ) ; CCtxParams -> validateSequences = value ; return CCtxParams -> validateSequences ; case ZSTD_c_useBlockSplitter : BOUNDCHECK ( ZSTD_c_useBlockSplitter , value ) ; CCtxParams -> useBlockSplitter = ( ZSTD_paramSwitch_e ) value ; return CCtxParams -> useBlockSplitter ; case ZSTD_c_useRowMatchFinder : BOUNDCHECK ( ZSTD_c_useRowMatchFinder , value ) ; CCtxParams -> useRowMatchFinder = ( ZSTD_paramSwitch_e ) value ; return CCtxParams -> useRowMatchFinder ; case ZSTD_c_deterministicRefPrefix : BOUNDCHECK ( ZSTD_c_deterministicRefPrefix , value ) ; CCtxParams -> deterministicRefPrefix = ! ! value ; return CCtxParams -> deterministicRefPrefix ; default : RETURN_ERROR ( parameter_unsupported , "unknown parameter" ) ; } } 