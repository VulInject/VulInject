struct sockaddr * rt_plentosa ( sa_family_t af , int plen , struct sockaddr_in6 * sa_mask ) { struct sockaddr_in * sin = ( sockaddr_in * ) sa_mask ; struct sockaddr_in6 * sin6 = ( sockaddr_in6 * ) sa_mask ; KASSERT ( plen >= 0 || plen == - 1 ) ; if ( plen == - 1 ) { return ( NULL ) ; } switch ( af ) { case AF_INET : sin -> sin_family = AF_INET ; sin -> sin_len = sizeof ( sockaddr_in ) ; in_prefixlen2mask ( & sin -> sin_addr , plen ) ; break ; case AF_INET6 : sin6 -> sin6_family = AF_INET6 ; sin6 -> sin6_len = sizeof ( sockaddr_in6 ) ; in6_prefixlen2mask ( & sin6 -> sin6_addr , plen ) ; break ; default : return ( NULL ) ; } return ( ( sockaddr * ) sa_mask ) ; } 