op_get_runtime_ref ( ) { g_autofree char * runtime_pref = NULL ; FlatpakDecomposed * decomposed ; if ( ! op -> resolved_metakey ) { return NULL ; } if ( flatpak_decomposed_is_app ( op -> ref ) ) { runtime_pref = g_key_file_get_string ( op -> resolved_metakey , "Application" , "runtime" , NULL ) ; } if ( g_key_file_has_group ( op -> resolved_metakey , "Extra Data" ) && ! g_key_file_get_boolean ( op -> resolved_metakey , "Extra Data" , "NoRuntime" , NULL ) ) { runtime_pref = g_key_file_get_string ( op -> resolved_metakey , "ExtensionOf" , "runtime" , NULL ) ; } if ( runtime_pref == NULL ) { return NULL ; } if ( decomposed == NULL ) { g_info ( "Invalid runtime ref %s in metadata" , runtime_pref ) ; } return decomposed ; } 