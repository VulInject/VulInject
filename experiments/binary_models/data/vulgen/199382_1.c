static void wscbor_test_require_major_type ( void ) { for ( size_t ex_ix = 0 ; ex_ix < ( sizeof ( all_examples ) / sizeof ( example_s * ) ) ; ++ ex_ix ) { const example_s * ex = all_examples [ ex_ix ] ; printf ( "simple #%zu\n" , ex_ix ) ; gint offset = 0 ; wscbor_chunk_t * chunk = wscbor_chunk_read ( test_scope , tvb , & offset ) ; g_assert_nonnull ( chunk ) ; g_assert_cmpuint ( wscbor_has_errors ( chunk ) , == , 0 ) ; g_assert_true ( wscbor_require_major_type ( chunk , ex -> type_major ) ) ; g_assert_cmpuint ( wscbor_has_errors ( chunk ) , == , 0 ) ; g_assert_false ( wscbor_require_major_type ( chunk , ex -> type_major + 1 ) ) ; g_assert_cmpuint ( wscbor_has_errors ( chunk ) , == , 1 ) ; wscbor_chunk_free ( chunk ) ; tvb_free ( tvb ) ; } } 