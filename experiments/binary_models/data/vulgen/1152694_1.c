static int __init hash_setup ( char * str ) { struct ima_template_desc * template_desc = ima_template_desc_current ( ) ; int i ; if ( hash_setup_done ) { return 1 ; } if ( strcmp ( template_desc -> name , IMA_TEMPLATE_IMA_NAME ) == 0 ) { if ( strncmp ( str , "md5" , 3 ) == 0 ) { ima_hash_algo = HASH_ALGO_MD5 ; } out } for ( i = 0 ; i < HASH_ALGO__LAST ; i ++ ) { if ( strcmp ( str , hash_algo_name [ i ] ) == 0 ) { ima_hash_algo = i ; break ; } } out hash_setup_done = 1 ; return 1 ; } 