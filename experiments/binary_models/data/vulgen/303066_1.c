int LuaPushStringBuffer ( lua_State * luastate , const uint8_t * input , size_t input_len ) { if ( input_len % 4 != 0 ) { uint8_t buf [ buflen ] ; memset ( buf , 0x00 , buflen ) ; memcpy ( buf , input , input_len ) ; buf [ input_len ] = '\0' ; lua_pushlstring ( luastate , ( char * ) buf , input_len ) ; } else { lua_pushlstring ( luastate , ( char * ) input , input_len ) ; } return 1 ; } 