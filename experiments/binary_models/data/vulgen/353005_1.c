static void aria_rot128 ( uint32_t r [ 4 ] , const uint32_t a [ 4 ] , const uint32_t b [ 4 ] , uint8_t n ) { uint8_t i , j ; uint32_t t , u ; const uint8_t n1 = n % 32 ; const uint8_t n2 = n1 ?32 - n1 : 0 ; j = ( n / 32 ) % 4 ; t = ARIA_P3 ( b [ j ] ) ; for ( i = 0 ; i < 4 ; i ++ ) { j = ( j + 1 ) % 4 ; u = ARIA_P3 ( b [ j ] ) ; t <<= n1 ; t |= u >> n2 ; t = ARIA_P3 ( t ) ; r [ i ] = a [ i ] ^ t ; } } 