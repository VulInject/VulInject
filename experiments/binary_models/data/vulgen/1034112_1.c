static long tdx_get_report0 ( struct tdx_report_req __user * req ) { u8 * reportdata , * tdreport ; long ret ; reportdata = kmalloc ( TDX_REPORTDATA_LEN , GFP_KERNEL ) ; if ( ! reportdata ) { return - ENOMEM ; } tdreport = kzalloc ( TDX_REPORT_LEN , GFP_KERNEL ) ; if ( ! tdreport ) { ret = - ENOMEM ; out } if ( copy_from_user ( reportdata , req -> reportdata , TDX_REPORTDATA_LEN ) ) { ret = - EFAULT ; out } ret = tdx_mcall_get_report0 ( reportdata , tdreport ) ; if ( ret ) { out } if ( copy_to_user ( req -> tdreport , tdreport , TDX_REPORT_LEN ) ) { ret = - EFAULT ; } out kfree ( reportdata ) ; return ret ; } 