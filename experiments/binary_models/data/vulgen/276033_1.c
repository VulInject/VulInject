java_print_value_fields ( , , , , , , ) { int i , len , n_baseclasses ; CHECK_TYPEDEF ( type ) ; fprintf_filtered ( stream , "{" ) ; len = TYPE_NFIELDS ( type ) ; n_baseclasses = TYPE_N_BASECLASSES ( type ) ; if ( n_baseclasses > 0 ) { int i , n_baseclasses = TYPE_N_BASECLASSES ( type ) ; for ( i = 0 ; i < n_baseclasses ; i ++ ) { int boffset ; struct type * baseclass = check_typedef ( TYPE_BASECLASS ( type , i ) ) ; char * basename = TYPE_NAME ( baseclass ) ; char * base_valaddr ; if ( BASETYPE_VIA_VIRTUAL ( type , i ) ) { continue ; } if ( basename != NULL && strcmp ( basename , "java.lang.Object" ) == 0 ) { continue ; } boffset = 0 ; if ( pretty ) { fprintf_filtered ( stream , "\n" ) ; } fputs_filtered ( "<" , stream ) ; fputs_filtered ( basename ?basename : "" , stream ) ; fputs_filtered ( ">= " , stream ) ; base_valaddr = valaddr ; java_print_value_fields ( baseclass , base_valaddr , address + boffset , stream , format , recurse + 1 , pretty ) ; fputs_filtered ( ", " , stream ) ; } } if ( ! len && n_baseclasses == 1 ) { fprintf_filtered ( stream , "<No data fields>" ) ; } else { int fields_seen = 0 ; for ( i = n_baseclasses ; i < len ; i ++ ) { if ( TYPE_FIELD_STATIC ( type , i ) ) { char * name = TYPE_FIELD_NAME ( type , i ) ; if ( ! static_field_print ) { continue ; } if ( name != NULL && strcmp ( name , "class" ) == 0 ) { continue ; } } if ( fields_seen ) { fprintf_filtered ( stream , ", " ) ; } if ( n_baseclasses > 0 ) { if ( pretty ) { fprintf_filtered ( stream , "\n" ) ; print_spaces_filtered ( 2 + 2 * recurse , stream ) ; fputs_filtered ( "members of " , stream ) ; fputs_filtered ( type_name_no_tag ( type ) , stream ) ; fputs_filtered ( ": " , stream ) ; } } fields_seen = 1 ; if ( pretty ) { fprintf_filtered ( stream , "\n" ) ; print_spaces_filtered ( 2 + 2 * recurse , stream ) ; } else { wrap_here ( n_spaces ( 2 + 2 * recurse ) ) ; } if ( inspect_it ) { if ( TYPE_CODE ( TYPE_FIELD_TYPE ( type , i ) ) == TYPE_CODE_PTR ) { fputs_filtered ( "\"( ptr \"" , stream ) ; } else { fputs_filtered ( "\"( nodef \"" , stream ) ; } if ( TYPE_FIELD_STATIC ( type , i ) ) { fputs_filtered ( "static " , stream ) ; } fprintf_symbol_filtered ( stream , TYPE_FIELD_NAME ( type , i ) , language_cplus , DMGL_PARAMS | DMGL_ANSI ) ; fputs_filtered ( "\" \"" , stream ) ; fprintf_symbol_filtered ( stream , TYPE_FIELD_NAME ( type , i ) , language_cplus , DMGL_PARAMS | DMGL_ANSI ) ; fputs_filtered ( "\") \"" , stream ) ; } else { annotate_field_begin ( TYPE_FIELD_TYPE ( type , i ) ) ; if ( TYPE_FIELD_STATIC ( type , i ) ) { fputs_filtered ( "static " , stream ) ; } fprintf_symbol_filtered ( stream , TYPE_FIELD_NAME ( type , i ) , language_cplus , DMGL_PARAMS | DMGL_ANSI ) ; annotate_field_name_end ( ) ; fputs_filtered ( ": " , stream ) ; annotate_field_value ( ) ; } if ( ! TYPE_FIELD_STATIC ( type , i ) && TYPE_FIELD_PACKED ( type , i ) ) { struct value * v ; if ( TYPE_FIELD_IGNORE ( type , i ) ) { fputs_filtered ( "<optimized out or zero length>" , stream ) ; } else { v = value_from_longest ( TYPE_FIELD_TYPE ( type , i ) , unpack_field_as_long ( type , valaddr , i ) ) ; val_print ( TYPE_FIELD_TYPE ( type , i ) , VALUE_CONTENTS ( v ) , 0 , 0 , stream , format , 0 , recurse + 1 , pretty ) ; } } else { if ( TYPE_FIELD_IGNORE ( type , i ) ) { fputs_filtered ( "<optimized out or zero length>" , stream ) ; } if ( TYPE_FIELD_STATIC ( type , i ) ) { struct value * v = value_static_field ( type , i ) ; if ( v == NULL ) { fputs_filtered ( "<optimized out>" , stream ) ; } else { struct type * t = check_typedef ( VALUE_TYPE ( v ) ) ; if ( TYPE_CODE ( t ) == TYPE_CODE_STRUCT ) { v = value_addr ( v ) ; } val_print ( VALUE_TYPE ( v ) , VALUE_CONTENTS ( v ) , 0 , VALUE_ADDRESS ( v ) , stream , format , 0 , recurse + 1 , pretty ) ; } } if ( TYPE_FIELD_TYPE ( type , i ) == NULL ) { fputs_filtered ( "<unknown type>" , stream ) ; } else { val_print ( TYPE_FIELD_TYPE ( type , i ) , valaddr + TYPE_FIELD_BITPOS ( type , i ) / 8 , 0 , address + TYPE_FIELD_BITPOS ( type , i ) / 8 , stream , format , 0 , recurse + 1 , pretty ) ; } } annotate_field_end ( ) ; } if ( pretty ) { fprintf_filtered ( stream , "\n" ) ; print_spaces_filtered ( 2 * recurse , stream ) ; } } fprintf_filtered ( stream , "}" ) ; } 