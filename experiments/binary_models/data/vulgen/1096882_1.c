R_API bool r_anal_xrefs_set ( RAnal * anal , ut64 from , ut64 to , const RAnalRefType _type ) { RAnalRefType type = _type ; r_return_val_if_fail ( anal , false ) ; if ( anal -> iob . is_valid_offset ) { if ( ! anal -> iob . is_valid_offset ( anal -> iob . io , from , 0 ) ) { return false ; } if ( ! anal -> iob . is_valid_offset ( anal -> iob . io , to , 0 ) ) { return false ; } } if ( ! R_ANAL_REF_TYPE_PERM ( type ) ) { switch ( R_ANAL_REF_TYPE_MASK ( type ) ) { case R_ANAL_REF_TYPE_CODE : case R_ANAL_REF_TYPE_CALL : case R_ANAL_REF_TYPE_JUMP : type |= R_ANAL_REF_TYPE_EXEC ; break ; default : type |= R_ANAL_REF_TYPE_READ ; break ; } } setxref ( anal -> dict_xrefs , to , from , type ) ; setxref ( anal -> dict_refs , from , to , type ) ; R_DIRTY ( anal ) ; return true ; } 