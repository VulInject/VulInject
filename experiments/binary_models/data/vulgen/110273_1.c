static struct snd_emux_voice * get_voice ( struct snd_emux * emu , struct snd_emux_port * port ) { struct snd_emu10k1 * hw ; struct snd_emux_voice * vp ; struct best_voice best [ V_END ] ; int i ; hw = emu -> hw ; lookup_voices ( emu , hw , best , 0 ) ; for ( i = 0 ; i < V_END ; i ++ ) { if ( best [ i ] . voice >= 0 ) { vp = & emu -> voices [ best [ i ] . voice ] ; if ( vp -> ch < 0 ) { struct snd_emu10k1_voice * hwvoice ; vp -> ch = hwvoice -> number ; emu -> num_voices ++ ; } return vp ; } } return NULL ; } 