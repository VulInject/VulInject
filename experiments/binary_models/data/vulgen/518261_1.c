static void idxd_groups_clear_state ( struct idxd_device * idxd ) { struct idxd_group * group ; int i ; lockdep_assert_held ( & idxd -> dev_lock ) ; for ( i = 0 ; i < idxd -> max_groups ; i ++ ) { group = idxd -> groups [ i ] ; group -> num_engines = 0 ; group -> num_wqs = 0 ; group -> use_rdbuf_limit = false ; group -> rdbufs_allowed = idxd -> max_rdbufs ; group -> rdbufs_reserved = 0 ; if ( idxd -> hw . version <= DEVICE_VERSION_2 && ! tc_override ) { group -> tc_a = 1 ; group -> tc_b = 1 ; } else { group -> tc_a = - 1 ; group -> tc_b = - 1 ; } group -> desc_progress_limit = 0 ; group -> batch_progress_limit = 0 ; } } 