static int skl_log_buffer_status ( struct avs_dev * adev , union avs_notify_msg * msg ) { void __iomem * buf ; u16 size , write , offset ; size = avs_log_buffer_size ( adev ) / 2 ; write = readl ( avs_sram_addr ( adev , AVS_FW_REGS_WINDOW ) + FW_REGS_DBG_LOG_WP ( msg -> log . core ) ) ; offset = ( write < size ) ?size : 0 ; buf = avs_log_buffer_addr ( adev , msg -> log . core ) + offset ; avs_dump_fw_log_wakeup ( adev , buf , size ) ; return 0 ; } 