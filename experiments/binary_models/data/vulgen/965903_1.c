mpz_out_str ( , , ) { mp_ptr xp ; mp_size_t x_size = SIZ ( x ) ; unsigned char * str ; size_t str_size ; size_t i ; size_t written ; const char * num_to_text ; TMP_DECL ; if ( stream == 0 ) { stream = stdout ; } num_to_text = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz" ; if ( base > 1 ) { if ( base <= 36 ) { num_to_text = "0123456789abcdefghijklmnopqrstuvwxyz" ; } if ( UNLIKELY ( base > 62 ) ) { return 0 ; } } if ( base > - 2 ) { base = 10 ; } else { base = - base ; if ( UNLIKELY ( base > 36 ) ) { return 0 ; } } written = 0 ; if ( x_size < 0 ) { fputc ( '-' , stream ) ; x_size = - x_size ; written = 1 ; } TMP_MARK ; DIGITS_IN_BASE_PER_LIMB ( str_size , x_size , base ) ; str_size += 3 ; str = ( unsigned char * ) TMP_ALLOC ( str_size ) ; xp = PTR ( x ) ; if ( ! POW2_P ( base ) ) { MPN_COPY ( xp , PTR ( x ) , x_size ) ; } str_size = mpn_get_str ( str , base , xp , x_size ) ; for ( i = 0 ; i < str_size ; i ++ ) { str [ i ] = num_to_text [ str [ i ] ] ; } str [ str_size ] = 0 ; { size_t fwret ; fwret = fwrite ( ( char * ) str , 1 , str_size , stream ) ; written += fwret ; } TMP_FREE ; return ferror ( stream ) ?0 : written ; } 