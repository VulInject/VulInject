static OM_uint32 attr_authorize_localname ( OM_uint32 * minor , const gss_name_t name , const gss_union_name_t unionUser ) { OM_uint32 major = GSS_S_UNAVAILABLE ; gss_buffer_t externalName ; int more = - 1 ; externalName = unionUser -> external_name ; assert ( externalName != GSS_C_NO_BUFFER ) ; while ( more != 0 && major != GSS_S_COMPLETE ) { OM_uint32 tmpMajor , tmpMinor ; gss_buffer_desc value ; gss_buffer_desc display_value ; int authenticated = 0 , complete = 0 ; tmpMajor = gss_get_name_attribute ( minor , name , GSS_C_ATTR_LOCAL_LOGIN_USER , & authenticated , & complete , & value , & display_value , & more ) ; if ( GSS_ERROR ( tmpMajor ) ) { major = tmpMajor ; break ; } if ( authenticated && value . length == externalName -> length && memcmp ( value . value , externalName -> value , externalName -> length ) == 0 ) { major = GSS_S_COMPLETE ; } else { major = GSS_S_UNAUTHORIZED ; } gss_release_buffer ( & tmpMinor , & value ) ; gss_release_buffer ( & tmpMinor , & display_value ) ; } return ( major ) ; } 