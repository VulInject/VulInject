void show_credential ( cred ) krb5_creds * cred ; { krb5_error_code retval ; krb5_ticket * tkt ; char * name , * sname , * flags ; int extra_field = 0 ; retval = krb5_unparse_name ( kcontext , cred -> client , & name ) ; if ( retval ) { com_err ( progname , retval , gettext ( "while unparsing client name" ) ) ; return ; } retval = krb5_unparse_name ( kcontext , cred -> server , & sname ) ; if ( retval ) { com_err ( progname , retval , gettext ( "while unparsing server name" ) ) ; return ; } if ( ! cred -> times . starttime ) { cred -> times . starttime = cred -> times . authtime ; } printtime ( cred -> times . starttime ) ; putchar ( ' ' ) ; putchar ( ' ' ) ; printtime ( cred -> times . endtime ) ; putchar ( ' ' ) ; putchar ( ' ' ) ; printf ( "%s\n" , sname ) ; if ( strcmp ( name , defname ) ) { printf ( gettext ( "\tfor client %s" ) , name ) ; extra_field ++ ; } if ( cred -> times . renew_till ) { if ( ! extra_field ) { fputs ( "\t" , stdout ) ; } else { fputs ( ", " , stdout ) ; } fputs ( gettext ( "renew until " ) , stdout ) ; printtime ( cred -> times . renew_till ) ; extra_field += 2 ; } if ( extra_field > 3 ) { fputs ( "\n" , stdout ) ; extra_field = 0 ; } if ( show_flags ) { flags = flags_string ( cred ) ; if ( flags && * flags ) { if ( ! extra_field ) { fputs ( "\t" , stdout ) ; } else { fputs ( ", " , stdout ) ; } printf ( gettext ( "Flags: %s" ) , flags ) ; extra_field ++ ; } } if ( extra_field > 2 ) { fputs ( "\n" , stdout ) ; extra_field = 0 ; } if ( show_etype ) { retval = decode_krb5_ticket ( & cred -> ticket , & tkt ) ; if ( retval ) { err_tkt } if ( ! extra_field ) { fputs ( "\t" , stdout ) ; } else { fputs ( ", " , stdout ) ; } printf ( gettext ( "Etype(skey, tkt): %s, " ) , etype_string ( cred -> keyblock . enctype ) ) ; printf ( "%s " , etype_string ( tkt -> enc_part . enctype ) ) ; extra_field ++ ; err_tkt if ( tkt != NULL ) { krb5_free_ticket ( kcontext , tkt ) ; } } if ( extra_field ) { putchar ( '\n' ) ; } if ( show_addresses ) { if ( ! cred -> addresses || ! cred -> addresses [ 0 ] ) { printf ( gettext ( "\tAddresses: (none)\n" ) ) ; } else { int i ; printf ( gettext ( "\tAddresses: " ) ) ; one_addr ( cred -> addresses [ 0 ] ) ; for ( i = 1 ; cred -> addresses [ i ] ; i ++ ) { printf ( ", " ) ; one_addr ( cred -> addresses [ i ] ) ; } printf ( "\n" ) ; } } krb5_free_unparsed_name ( kcontext , name ) ; krb5_free_unparsed_name ( kcontext , sname ) ; } 