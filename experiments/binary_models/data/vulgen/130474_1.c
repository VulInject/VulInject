void hexdump ( void * ptr , ut64 len , ut64 offset ) { unsigned char * data = ( unsigned char * ) ptr ; int x = 0 ; char hex [ 49 ] , * p ; char txt [ 17 ] , * c ; ut64 curr_offset ; while ( x < len ) { p = hex ; c = txt ; curr_offset = x + offset ; { p += sprintf ( p , "%02x " , data [ x ] ) ; * c ++ = ( data [ x ] >= 32 && data [ x ] <= 127 ) ?data [ x ] : '.' ; } ++ x % 16 && x < len ; * c = '\0' ; } } 