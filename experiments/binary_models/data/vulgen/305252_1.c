boolean_t smb_match ( const char * p , const char * s , boolean_t ci ) { struct match_priv priv ; int rc ; if ( p [ 0 ] == '*' && p [ 1 ] == '\0' ) { return ( B_TRUE ) ; } if ( p [ 0 ] == '<' && p [ 1 ] == '\"' && p [ 2 ] == '*' && p [ 3 ] == '\0' ) { return ( B_TRUE ) ; } if ( s [ 0 ] == '.' && s [ 1 ] == '.' && s [ 2 ] == '\0' ) { s ++ ; } if ( NULL == strpbrk ( p , smb_wildcards ) ) { else { rc = strcmp ( p , s ) ; } return ( rc == 0 ) ; } priv . depth = 0 ; priv . ci = ci ; rc = smb_match_private ( p , s , & priv ) ; return ( rc == 1 ) ; } 