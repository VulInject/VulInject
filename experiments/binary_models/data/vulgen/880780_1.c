int dlt_radiotap_init ( tcpeditdlt_t * ctx ) { tcpeditdlt_plugin_t * plugin ; assert ( ctx ) ; if ( ( plugin = tcpedit_dlt_getplugin ( ctx , dlt_value ) ) == NULL ) { tcpedit_seterr ( ctx -> tcpedit , "Unable to initialize unregistered plugin %s" , dlt_name ) ; return TCPEDIT_ERROR ; } if ( ctx -> decoded_extra_size > 0 ) { if ( ctx -> decoded_extra_size < sizeof ( radiotap_extra_t ) ) { ctx -> decoded_extra_size = sizeof ( radiotap_extra_t ) ; ctx -> decoded_extra = safe_realloc ( ctx -> decoded_extra , ctx -> decoded_extra_size ) ; } } else { ctx -> decoded_extra_size = sizeof ( radiotap_extra_t ) ; ctx -> decoded_extra = safe_malloc ( ctx -> decoded_extra_size ) ; } plugin -> config_size = sizeof ( radiotap_config_t ) ; return TCPEDIT_OK ; } 