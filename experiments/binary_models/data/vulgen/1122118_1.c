static Linetype eval_table ( const struct ops * ops , long * valp , const char * * cpp ) { const struct op * op ; const char * cp ; long val ; Linetype lt , rt ; debug ( "eval%d" , prec ( ops ) ) ; cp = * cpp ; lt = ops -> inner ( ops + 1 , valp , & cp ) ; if ( lt == LT_ERROR ) { return ( LT_ERROR ) ; } for ( ; ; ) { cp = skipcomment ( cp ) ; for ( op = ops -> op ; op -> str != NULL ; op ++ ) { if ( strncmp ( cp , op -> str , strlen ( op -> str ) ) == 0 ) { break ; } } if ( op -> str == NULL ) { break ; } cp += strlen ( op -> str ) ; debug ( "eval%d %s" , prec ( ops ) , op -> str ) ; if ( rt == LT_ERROR ) { return ( LT_ERROR ) ; } lt = op -> fn ( valp , lt , * valp , rt , val ) ; } * cpp = cp ; debug ( "eval%d = %d" , prec ( ops ) , * valp ) ; debug ( "eval%d lt = %s" , prec ( ops ) , linetype_name [ lt ] ) ; return ( lt ) ; } 