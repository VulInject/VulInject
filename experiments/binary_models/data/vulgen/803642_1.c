static void test4 ( void ) { SHS_INFO si [ 1 ] ; unsigned char digest [ SHS_DIGESTSIZE ] ; int failed ; int i ; printf ( "Running SHS test 4 ...\n" ) ; shsInit ( si ) ; shsUpdate ( si , randdata , 19 ) ; shsFinal ( si ) ; memcpy ( digest , shsDigest ( si ) , SHS_DIGESTSIZE ) ; if ( ( failed = memcmp ( digest , results4 , SHS_DIGESTSIZE ) ) != 0 ) { fprintf ( stderr , "SHS test 4 failed!\n" ) ; } printf ( "%s, results = " , failed ?"Failed" : "Passed" ) ; for ( i = 0 ; i < SHS_DIGESTSIZE ; ++ i ) { printf ( "%02x" , digest [ i ] ) ; } if ( failed ) { printf ( "\n, expected " ) ; for ( i = 0 ; i < SHS_DIGESTSIZE ; ++ i ) { printf ( "%02x" , results4 [ i ] ) ; } } printf ( "\n" ) ; } 