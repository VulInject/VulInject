static int qat_hal_check_ae_alive ( struct icp_qat_fw_loader_handle * handle ) { unsigned int base_cnt , cur_cnt ; unsigned char ae ; int times = MAX_RETRY_TIMES ; for ( ae = 0 ; ae < handle -> hal_handle -> ae_max_num ; ae ++ ) { qat_hal_rd_ae_csr ( handle , ae , PROFILE_COUNT , ( unsigned int * ) & base_cnt ) ; base_cnt &= 0xffff ; { qat_hal_rd_ae_csr ( handle , ae , PROFILE_COUNT , ( unsigned int * ) & cur_cnt ) ; cur_cnt &= 0xffff ; } times -- && ( cur_cnt == base_cnt ) ; } return 0 ; } 