static int asn1_get_sequence_of_cb ( void * ctx , int tag , unsigned char * start , size_t len ) { asn1_get_sequence_of_cb_ctx_t * cb_ctx = ( asn1_get_sequence_of_cb_ctx_t * ) ctx ; mbedtls_asn1_sequence * cur = cb_ctx -> cur ; if ( cur -> buf . p != NULL ) { cur -> next = mbedtls_calloc ( 1 , sizeof ( mbedtls_asn1_sequence ) ) ; if ( cur -> next == NULL ) { return ( MBEDTLS_ERR_ASN1_ALLOC_FAILED ) ; } cur = cur -> next ; } cur -> buf . p = start ; cur -> buf . len = len ; cur -> buf . tag = tag ; return ( 0 ) ; } 