prose_test_1 ( ) { mongoc_client_t * client ; mongoc_collection_t * coll ; bool ret ; bson_t reply ; bson_error_t error ; BSON_UNUSED ( ctx ) ; client = test_framework_new_default_client ( ) ; coll = get_test_collection ( client , "coll" ) ; ret = mongoc_client_command_simple ( client , "admin" , tmp_bson ( "{'configureFailPoint': 'failCommand', 'mode': {'times': 1}, " " 'data': {'failCommands': ['insert'], 'writeConcernError': {" "   'code': 100, 'codeName': 'UnsatisfiableWriteConcern', " "   'errmsg': 'Not enough data-bearing nodes', " "   'errInfo': {'writeConcern': {'w': 2, 'wtimeout': 0, " "               'provenance': 'clientSupplied'}}}}}" ) , NULL , NULL , & error ) ; ASSERT_OR_PRINT ( ret , error ) ; ret = mongoc_collection_insert_one ( coll , tmp_bson ( "{'x':1}" ) , NULL , & reply , & error ) ; ASSERT ( ! ret ) ; ASSERT_MATCH ( & reply , "{'writeConcernErrors': [{'errInfo': {'writeConcern': {" "'w': 2, 'wtimeout': 0, 'provenance': 'clientSupplied'}}}]}" ) ; bson_destroy ( & reply ) ; mongoc_collection_destroy ( coll ) ; } 