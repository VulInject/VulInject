void subtilde ( char * * fn , char * * path ) { char pattern [ 32 ] , * p ; int i ; i = 0 ; p = * path ; while ( * p != '\0' && * p != DIRSEP && * p != PATHSEP ) { pattern [ i ++ ] = * p ++ ; } pattern [ i ] = '\0' ; if ( pattern [ 0 ] != '~' ) { return ; } if ( pattern [ 1 ] == '\0' ) { if ( home == NULL ) { fatal ( "You don't have a HOME!\n" ) ; } sprintf ( * fn , "%s\0" , home ) ; * fn += strlen ( * fn ) ; * path = p ; } else { struct passwd * pw ; if ( pw = getpwnam ( & pattern [ 1 ] ) ) { sprintf ( * fn , "%s\0" , pw -> pw_dir ) ; * fn += strlen ( * fn ) ; * path = p ; } else { fatal ( "%s: no such user\n" , & pattern [ 1 ] ) ; } } } 