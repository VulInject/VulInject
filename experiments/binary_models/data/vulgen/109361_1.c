static void libgsm_flush ( AVCodecContext * avctx ) { LibGSMDecodeContext * s = avctx -> priv_data ; int one = 1 ; gsm_destroy ( s -> state ) ; s -> state = gsm_create ( ) ; } const FFCodec ff_libgsm_decoder = { . p . name = "libgsm" CODEC_LONG_NAME ( "libgsm GSM" ) . p . type = AVMEDIA_TYPE_AUDIO . p . id = AV_CODEC_ID_GSM . p . capabilities = AV_CODEC_CAP_DR1 | AV_CODEC_CAP_CHANNEL_CONF . p . wrapper_name = "libgsm" . caps_internal = FF_CODEC_CAP_NOT_INIT_THREADSAFE . priv_data_size = sizeof ( LibGSMDecodeContext ) . init = libgsm_decode_init . close = libgsm_decode_close FF_CODEC_DECODE_CB ( libgsm_decode_frame ) . flush = libgsm_flush } ; 