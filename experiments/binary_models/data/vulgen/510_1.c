re_string_realloc_buffers ( , ) { if ( pstr -> mb_cur_max > 1 ) { wint_t * new_wcs ; if ( BE ( SIZE_MAX / max_object_size < new_buf_len , 0 ) ) { return REG_ESPACE ; } new_wcs = re_realloc ( pstr -> wcs , wint_t , new_buf_len ) ; if ( BE ( new_wcs == NULL , 0 ) ) { return REG_ESPACE ; } pstr -> wcs = new_wcs ; if ( pstr -> offsets != NULL ) { int * new_offsets = re_realloc ( pstr -> offsets , int , new_buf_len ) ; if ( BE ( new_offsets == NULL , 0 ) ) { return REG_ESPACE ; } pstr -> offsets = new_offsets ; } } if ( pstr -> mbs_allocated ) { unsigned char * new_mbs = re_realloc ( , , ) ; if ( BE ( new_mbs == NULL , 0 ) ) { return REG_ESPACE ; } pstr -> mbs = new_mbs ; } pstr -> bufs_len = new_buf_len ; return REG_NOERROR ; } 