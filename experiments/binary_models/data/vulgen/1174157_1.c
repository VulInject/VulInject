tc_gen_reloc ( , ) asection * section ATTRIBUTE_UNUSED ; fixS * fixp ; { arelent * reloc ; reloc = ( arelent * ) xmalloc ( sizeof ( arelent ) ) ; reloc -> sym_ptr_ptr = ( asymbol * * ) xmalloc ( sizeof ( asymbol * ) ) ; * reloc -> sym_ptr_ptr = symbol_get_bfdsym ( fixp -> fx_addsy ) ; reloc -> address = fixp -> fx_frag -> fr_address + fixp -> fx_where ; assert ( ( int ) fixp -> fx_r_type > 0 ) ; reloc -> howto = bfd_reloc_type_lookup ( stdoutput , fixp -> fx_r_type ) ; if ( ! fixp -> fx_pcrel != ! reloc -> howto -> pc_relative ) { as_fatal ( _ ( "internal error? cannot generate `%s' relocation" ) , bfd_get_reloc_code_name ( fixp -> fx_r_type ) ) ; } assert ( ! fixp -> fx_pcrel == ! reloc -> howto -> pc_relative ) ; reloc -> addend = fixp -> fx_offset ; switch ( fixp -> fx_r_type ) { case BFD_RELOC_XTENSA_OP0 : case BFD_RELOC_XTENSA_OP1 : case BFD_RELOC_XTENSA_OP2 : case BFD_RELOC_XTENSA_ASM_EXPAND : case BFD_RELOC_32 : case BFD_RELOC_XTENSA_PLT : case BFD_RELOC_VTABLE_INHERIT : case BFD_RELOC_VTABLE_ENTRY : break ; case BFD_RELOC_XTENSA_ASM_SIMPLIFY : as_warn ( _ ( "emitting simplification relocation" ) ) ; break ; default : as_warn ( _ ( "emitting unknown relocation" ) ) ; } return reloc ; } 