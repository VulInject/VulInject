void register_buf_size ( int id ) { my_size_id = id ; set_dynamic_states ( my_size_id ) ; add_merge_hook ( my_size_id , & merge_estates ) ; select_caller_info_hook ( set_param_buf_size , BUF_SIZE ) ; select_return_states_hook ( BUF_SIZE , & db_returns_buf_size ) ; add_split_return_callback ( print_returned_allocations ) ; allocation_funcs = create_function_hashtable ( 100 ) ; add_allocation_function ( "malloc" , & match_alloc , 0 ) ; add_allocation_function ( "calloc" , & match_calloc , 0 ) ; add_allocation_function ( "memdup" , & match_alloc , 1 ) ; add_allocation_function ( "realloc" , & match_alloc , 1 ) ; if ( option_project == PROJ_KERNEL ) { add_allocation_function ( "kmalloc" , & match_alloc , 0 ) ; add_allocation_function ( "kmalloc_node" , & match_alloc , 0 ) ; add_allocation_function ( "kzalloc" , & match_alloc , 0 ) ; add_allocation_function ( "kzalloc_node" , & match_alloc , 0 ) ; add_allocation_function ( "vmalloc" , & match_alloc , 0 ) ; add_allocation_function ( "vzalloc" , & match_alloc , 0 ) ; add_allocation_function ( "__vmalloc" , & match_alloc , 0 ) ; add_allocation_function ( "kvmalloc" , & match_alloc , 0 ) ; add_allocation_function ( "kcalloc" , & match_calloc , 0 ) ; add_allocation_function ( "kmalloc_array" , & match_calloc , 0 ) ; add_allocation_function ( "devm_kmalloc_array" , & match_calloc , 1 ) ; add_allocation_function ( "sock_kmalloc" , & match_alloc , 1 ) ; add_allocation_function ( "kmemdup" , & match_alloc , 1 ) ; add_allocation_function ( "kmemdup_user" , & match_alloc , 1 ) ; add_allocation_function ( "dma_alloc_attrs" , & match_alloc , 1 ) ; add_allocation_function ( "pci_alloc_consistent" , & match_alloc , 1 ) ; add_allocation_function ( "pci_alloc_coherent" , & match_alloc , 1 ) ; add_allocation_function ( "devm_kmalloc" , & match_alloc , 1 ) ; add_allocation_function ( "devm_kzalloc" , & match_alloc , 1 ) ; add_allocation_function ( "krealloc" , & match_alloc , 1 ) ; add_allocation_function ( "__alloc_bootmem" , & match_alloc , 0 ) ; add_allocation_function ( "alloc_bootmem" , & match_alloc , 0 ) ; add_allocation_function ( "kmap" , & match_page , 0 ) ; add_allocation_function ( "kmap_atomic" , & match_page , 0 ) ; add_allocation_function ( "get_zeroed_page" , & match_page , 0 ) ; add_allocation_function ( "alloc_page" , & match_page , 0 ) ; add_allocation_function ( "alloc_pages" , & match_alloc_pages , 1 ) ; add_allocation_function ( "alloc_pages_current" , & match_alloc_pages , 1 ) ; add_allocation_function ( "__get_free_pages" , & match_alloc_pages , 1 ) ; add_allocation_function ( "dma_alloc_contiguous" , & match_alloc , 1 ) ; add_allocation_function ( "dma_alloc_coherent" , & match_alloc , 1 ) ; } add_allocation_function ( "strndup" , match_strndup , 0 ) ; if ( option_project == PROJ_KERNEL ) { add_allocation_function ( "kstrndup" , match_strndup , 0 ) ; } add_modification_hook ( my_size_id , & set_size_undefined ) ; add_merge_hook ( my_size_id , & merge_size_func ) ; if ( option_info ) { add_hook ( record_global_size , BASE_HOOK ) ; } } 