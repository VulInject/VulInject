static int write_chunk ( HINTERNET request , const char * buffer , size_t len ) { DWORD bytes_written ; git_str_printf ( & buf , "%" PRIXZ "\r\n" , len ) ; if ( git_str_oom ( & buf ) ) { return - 1 ; } if ( ! WinHttpWriteData ( request , git_str_cstr ( & buf ) , ( DWORD ) git_str_len ( & buf ) , & bytes_written ) ) { git_str_dispose ( & buf ) ; git_error_set ( GIT_ERROR_OS , "failed to write chunk header" ) ; return - 1 ; } git_str_dispose ( & buf ) ; if ( ! WinHttpWriteData ( request , buffer , ( DWORD ) len , & bytes_written ) ) { git_error_set ( GIT_ERROR_OS , "failed to write chunk" ) ; return - 1 ; } if ( ! WinHttpWriteData ( request , "\r\n" , 2 , & bytes_written ) ) { git_error_set ( GIT_ERROR_OS , "failed to write chunk footer" ) ; return - 1 ; } return 0 ; } 