void init_main_cfg_vars ( int first_time ) { if ( first_time ) { num_check_workers = 0 ; qh_socket_path = NULL ; } log_file = NULL ; temp_file = NULL ; temp_path = NULL ; check_result_path = NULL ; command_file = NULL ; lock_file = NULL ; debug_file = NULL ; object_precache_file = ( char * ) strdup ( DEFAULT_PRECACHED_OBJECT_FILE ) ; nagios_user = NULL ; nagios_group = NULL ; website_url = NULL ; use_regexp_matches = FALSE ; use_true_regexp_matching = FALSE ; use_syslog = DEFAULT_USE_SYSLOG ; log_service_retries = DEFAULT_LOG_SERVICE_RETRIES ; log_host_retries = DEFAULT_LOG_HOST_RETRIES ; log_initial_states = DEFAULT_LOG_INITIAL_STATES ; if ( first_time ) { log_current_states = DEFAULT_LOG_CURRENT_STATES ; } log_notifications = DEFAULT_NOTIFICATION_LOGGING ; log_event_handlers = DEFAULT_LOG_EVENT_HANDLERS ; log_external_commands = DEFAULT_LOG_EXTERNAL_COMMANDS ; log_passive_checks = DEFAULT_LOG_PASSIVE_CHECKS ; service_check_timeout = DEFAULT_SERVICE_CHECK_TIMEOUT ; if ( first_time ) { service_check_timeout_state = STATE_CRITICAL ; } host_check_timeout = DEFAULT_HOST_CHECK_TIMEOUT ; event_handler_timeout = DEFAULT_EVENT_HANDLER_TIMEOUT ; notification_timeout = DEFAULT_NOTIFICATION_TIMEOUT ; ocsp_timeout = DEFAULT_OCSP_TIMEOUT ; ochp_timeout = DEFAULT_OCHP_TIMEOUT ; if ( first_time ) { illegal_object_chars = NULL ; } service_inter_check_delay_method = ICD_SMART ; host_inter_check_delay_method = ICD_SMART ; service_interleave_factor_method = ILF_SMART ; max_service_check_spread = DEFAULT_SERVICE_CHECK_SPREAD ; max_host_check_spread = DEFAULT_HOST_CHECK_SPREAD ; use_aggressive_host_checking = DEFAULT_AGGRESSIVE_HOST_CHECKING ; cached_host_check_horizon = DEFAULT_CACHED_HOST_CHECK_HORIZON ; cached_service_check_horizon = DEFAULT_CACHED_SERVICE_CHECK_HORIZON ; enable_predictive_host_dependency_checks = DEFAULT_ENABLE_PREDICTIVE_HOST_DEPENDENCY_CHECKS ; enable_predictive_service_dependency_checks = DEFAULT_ENABLE_PREDICTIVE_SERVICE_DEPENDENCY_CHECKS ; soft_state_dependencies = FALSE ; retain_state_information = FALSE ; retention_update_interval = DEFAULT_RETENTION_UPDATE_INTERVAL ; use_retained_program_state = TRUE ; use_retained_scheduling_info = FALSE ; retention_scheduling_horizon = DEFAULT_RETENTION_SCHEDULING_HORIZON ; if ( first_time ) { retention_file = NULL ; } retained_host_attribute_mask = 0L ; retained_service_attribute_mask = 0L ; retained_process_host_attribute_mask = 0L ; retained_process_service_attribute_mask = 0L ; retained_contact_host_attribute_mask = 0L ; retained_contact_service_attribute_mask = 0L ; check_reaper_interval = DEFAULT_CHECK_REAPER_INTERVAL ; max_check_reaper_time = DEFAULT_MAX_REAPER_TIME ; max_check_result_file_age = DEFAULT_MAX_CHECK_RESULT_AGE ; service_freshness_check_interval = DEFAULT_FRESHNESS_CHECK_INTERVAL ; host_freshness_check_interval = DEFAULT_FRESHNESS_CHECK_INTERVAL ; auto_rescheduling_interval = DEFAULT_AUTO_RESCHEDULING_INTERVAL ; auto_rescheduling_window = DEFAULT_AUTO_RESCHEDULING_WINDOW ; check_orphaned_services = DEFAULT_CHECK_ORPHANED_SERVICES ; check_orphaned_hosts = DEFAULT_CHECK_ORPHANED_HOSTS ; check_service_freshness = DEFAULT_CHECK_SERVICE_FRESHNESS ; check_host_freshness = DEFAULT_CHECK_HOST_FRESHNESS ; auto_reschedule_checks = DEFAULT_AUTO_RESCHEDULE_CHECKS ; if ( first_time ) { daemon_dumps_core = TRUE ; } max_parallel_service_checks = DEFAULT_MAX_PARALLEL_SERVICE_CHECKS ; status_update_interval = DEFAULT_STATUS_UPDATE_INTERVAL ; event_broker_options = BROKER_NOTHING ; time_change_threshold = DEFAULT_TIME_CHANGE_THRESHOLD ; low_service_flap_threshold = DEFAULT_LOW_SERVICE_FLAP_THRESHOLD ; high_service_flap_threshold = DEFAULT_HIGH_SERVICE_FLAP_THRESHOLD ; low_host_flap_threshold = DEFAULT_LOW_HOST_FLAP_THRESHOLD ; high_host_flap_threshold = DEFAULT_HIGH_HOST_FLAP_THRESHOLD ; translate_passive_host_checks = DEFAULT_TRANSLATE_PASSIVE_HOST_CHECKS ; passive_host_checks_are_soft = DEFAULT_PASSIVE_HOST_CHECKS_SOFT ; use_large_installation_tweaks = DEFAULT_USE_LARGE_INSTALLATION_TWEAKS ; enable_environment_macros = FALSE ; free_child_process_memory = - 1 ; child_processes_fork_twice = - 1 ; if ( first_time ) { use_timezone = NULL ; allow_empty_hostgroup_assignment = DEFAULT_ALLOW_EMPTY_HOSTGROUP_ASSIGNMENT ; host_down_disable_service_checks = FALSE ; service_skip_check_dependency_status = - 1 ; service_skip_check_parent_status = - 1 ; service_skip_check_host_down_status = - 1 ; host_skip_check_dependency_status = - 1 ; perfdata_timeout = 0 ; host_perfdata_command = NULL ; service_perfdata_command = NULL ; host_perfdata_file_template = NULL ; service_perfdata_file_template = NULL ; host_perfdata_file = NULL ; service_perfdata_file = NULL ; host_perfdata_file_pipe = FALSE ; host_perfdata_file_append = TRUE ; service_perfdata_file_pipe = FALSE ; service_perfdata_file_append = TRUE ; host_perfdata_file_processing_interval = 0L ; service_perfdata_file_processing_interval = 0L ; host_perfdata_file_processing_command = NULL ; service_perfdata_file_processing_command = NULL ; host_perfdata_process_empty_results = DEFAULT_HOST_PERFDATA_PROCESS_EMPTY_RESULTS ; service_perfdata_process_empty_results = DEFAULT_SERVICE_PERFDATA_PROCESS_EMPTY_RESULTS ; } additional_freshness_latency = DEFAULT_ADDITIONAL_FRESHNESS_LATENCY ; if ( first_time ) { check_for_updates = DEFAULT_CHECK_FOR_UPDATES ; bare_update_check = DEFAULT_BARE_UPDATE_CHECK ; debug_level = DEFAULT_DEBUG_LEVEL ; debug_verbosity = DEFAULT_DEBUG_VERBOSITY ; max_debug_file_size = DEFAULT_MAX_DEBUG_FILE_SIZE ; } global_host_event_handler = NULL ; global_service_event_handler = NULL ; ocsp_command = NULL ; ochp_command = NULL ; return ; } static const char * worker_source_name ( const void * source ) { return source ?( const char * ) source : "unknown internal source (voodoo, perhaps?)" ; } static const char * spool_file_source_name ( const void * source ) { return "check result spool dir" ; } struct check_engine nagios_check_engine = { "Nagios Core" worker_source_name NULL } ; 