void handle_ipi ( ulong hart ) { int ret ; void * smp_function ( ulong hart , ulong arg0 , ulong arg1 ) if ( ! __smp_load_acquire ( & gd -> arch . ipi [ hart ] . valid ) ) { return ; } smp_function = ( void ( * ) ( ulong , ulong , ulong ) ) gd -> arch . ipi [ hart ] . addr ; invalidate_icache_all ( ) ; ret = riscv_clear_ipi ( hart ) ; if ( ret ) { pr_err ( "Cannot clear IPI of hart %ld (error %d)\n" , hart , ret ) ; return ; } smp_function ( hart , gd -> arch . ipi [ hart ] . arg0 , gd -> arch . ipi [ hart ] . arg1 ) ; } 