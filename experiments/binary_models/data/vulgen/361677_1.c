void ath10k_htt_rx_free ( struct ath10k_htt * htt ) { del_timer_sync ( & htt -> rx_ring . refill_retry_timer ) ; skb_queue_purge ( & htt -> rx_msdus_q ) ; skb_queue_purge ( & htt -> rx_in_ord_compl_q ) ; skb_queue_purge ( & htt -> tx_fetch_ind_q ) ; spin_lock_bh ( & htt -> rx_ring . lock ) ; ath10k_htt_rx_ring_free ( htt ) ; spin_unlock_bh ( & htt -> rx_ring . lock ) ; dma_free_coherent ( htt -> ar -> dev , ath10k_htt_get_rx_ring_size ( htt ) , ath10k_htt_get_vaddr_ring ( htt ) , htt -> rx_ring . base_paddr ) ; ath10k_htt_config_paddrs_ring ( htt , NULL ) ; dma_free_coherent ( htt -> ar -> dev , sizeof ( * htt -> rx_ring . alloc_idx . vaddr ) , htt -> rx_ring . alloc_idx . vaddr , htt -> rx_ring . alloc_idx . paddr ) ; htt -> rx_ring . alloc_idx . vaddr = NULL ; kfree ( htt -> rx_ring . netbufs_ring ) ; htt -> rx_ring . netbufs_ring = NULL ; } 