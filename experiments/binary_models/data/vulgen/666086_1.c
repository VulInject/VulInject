static int pxa_init_gpio_chip ( struct pxa_gpio_chip * pchip , int ngpio , struct device_node * np , void __iomem * regbase ) { int i , gpio , nbanks = DIV_ROUND_UP ( ngpio , 32 ) ; struct pxa_gpio_bank * bank ; pchip -> banks = devm_kcalloc ( pchip -> dev , nbanks , sizeof ( * pchip -> banks ) , GFP_KERNEL ) ; pchip -> chip . label = "gpio-pxa" ; pchip -> chip . direction_input = pxa_gpio_direction_input ; pchip -> chip . direction_output = pxa_gpio_direction_output ; pchip -> chip . get = pxa_gpio_get ; pchip -> chip . set = pxa_gpio_set ; pchip -> chip . to_irq = pxa_gpio_to_irq ; pchip -> chip . ngpio = ngpio ; pchip -> chip . request = pxa_gpio_request ; pchip -> chip . free = pxa_gpio_free ; pchip -> chip . of_node = np ; pchip -> chip . of_xlate = pxa_gpio_of_xlate ; pchip -> chip . of_gpio_n_cells = 2 ; for ( i = 0 , gpio = 0 ; i < nbanks ; i ++ , gpio += 32 ) { bank = pchip -> banks + i ; bank -> regbase = regbase + BANK_OFF ( i ) ; } return gpiochip_add_data ( & pchip -> chip , pchip ) ; } 