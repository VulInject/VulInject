static void sja1110_select_tdmaconfigidx ( struct sja1105_private * priv ) { struct sja1105_general_params_entry * general_params ; struct sja1105_table * table ; bool port_1_is_base_tx ; bool port_3_is_2500 ; bool port_4_is_2500 ; u64 tdmaconfigidx ; table = & priv -> static_config . tables [ BLK_IDX_GENERAL_PARAMS ] ; general_params = table -> entries ; port_1_is_base_tx = priv -> phy_mode [ 1 ] == PHY_INTERFACE_MODE_INTERNAL ; port_3_is_2500 = priv -> phy_mode [ 3 ] == PHY_INTERFACE_MODE_2500BASEX ; port_4_is_2500 = priv -> phy_mode [ 4 ] == PHY_INTERFACE_MODE_2500BASEX ; if ( port_1_is_base_tx ) { tdmaconfigidx = 5 ; } if ( port_3_is_2500 && port_4_is_2500 ) { tdmaconfigidx = 1 ; } if ( port_3_is_2500 ) { tdmaconfigidx = 3 ; } if ( port_4_is_2500 ) { tdmaconfigidx = 2 ; } else { tdmaconfigidx = 14 ; } general_params -> tdmaconfigidx = tdmaconfigidx ; } 