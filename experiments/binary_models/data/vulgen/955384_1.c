static bool comc_setup ( struct console * cp ) { EFI_STATUS status ; UINT32 control ; struct serial * sp = cp -> c_private ; status = sp -> sio -> Reset ( sp -> sio ) ; if ( EFI_ERROR ( status ) ) { return ( false ) ; } status = sp -> sio -> SetAttributes ( sp -> sio , sp -> baudrate , 0 , 0 , sp -> parity , sp -> databits , sp -> stopbits ) ; if ( EFI_ERROR ( status ) ) { return ( false ) ; } status = sp -> sio -> GetControl ( sp -> sio , & control ) ; if ( EFI_ERROR ( status ) ) { return ( false ) ; } if ( sp -> rtsdtr_off ) { control &= ~ ( EFI_SERIAL_REQUEST_TO_SEND | EFI_SERIAL_DATA_TERMINAL_READY ) ; } else { control |= EFI_SERIAL_REQUEST_TO_SEND ; } ( void ) sp -> sio -> SetControl ( sp -> sio , control ) ; cp -> c_flags |= ( C_PRESENTIN | C_PRESENTOUT ) ; return ( true ) ; } 