void arch_timer_init ( void ) { struct sysctr_ctlr * sysctr = ( sysctr_ctlr * ) NV_PA_TSC_BASE ; u32 freq , val ; freq = clock_get_rate ( CLOCK_ID_CLK_M ) ; debug ( "%s: clk_m freq is %dHz [0x%08X]\n" , __func__ , freq , freq ) ; debug ( "%s: setting CNTFID0 to 0x%08X\n" , __func__ , freq ) ; writel ( freq , & sysctr -> cntfid0 ) ; val = readl ( & sysctr -> cntcr ) ; writel ( val , & sysctr -> cntcr ) ; debug ( "%s: TSC CNTCR = 0x%08X\n" , __func__ , val ) ; } 