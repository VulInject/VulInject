static void rpc_kafka_stats_topic ( rpc_t * rpc , void * ctx ) { str s_topic ; if ( s_topic . len == 0 || s_topic . s == NULL ) { LM_ERR ( "Bad topic name\n" ) ; rpc -> fault ( ctx , 400 , "Bad topic name" ) ; return ; } uint64_t msg_total = 0 ; uint64_t msg_error = 0 ; if ( kfk_stats_topic_get ( & s_topic , & msg_total , & msg_error ) ) { LM_ERR ( "Failed to get statistics for topic: %.*s\n" , s_topic . len , s_topic . s ) ; rpc -> fault ( ctx , 500 , "Failed to get per topic statistics" ) ; return ; } LM_DBG ( "Topic: %.*s   messages: %" PRIu64 "  Errors: %" PRIu64 "\n" , s_topic . len , s_topic . s , msg_total , msg_error ) ; if ( rpc -> rpl_printf ( ctx , "Topic: %.*s  Total messages: %" PRIu64 "  Errors: %" PRIu64 , s_topic . len , s_topic . s , msg_total , msg_error ) < 0 ) { rpc -> fault ( ctx , 500 , "Internal error showing statistics for topic: %.*s" , s_topic . len , s_topic . s ) ; return ; } } 