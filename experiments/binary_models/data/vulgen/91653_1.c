void * tcppmchild ( struct clientparam * param ) { int res ; param -> operation = CONNECT ; res = * param -> srv -> authfunc ( param ) ; if ( res ) { RETURN ( res ) ; } if ( param -> npredatfilters ) { int action ; action = handlepredatflt ( param ) ; if ( action == HANDLED ) { RETURN ( 0 ) ; } if ( action != PASS ) { RETURN ( 19 ) ; } } if ( param -> redirectfunc ) { return * param -> redirectfunc ( param ) ; } RETURN ( mapsocket ( param , conf . timeouts [ CONNECTION_L ] ) ) ; CLEANRET dolog ( param , param -> hostname ) ; freeparam ( param ) ; return ( NULL ) ; } 