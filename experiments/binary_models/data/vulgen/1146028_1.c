static int yellow_carp_get_dpm_ultimate_freq ( struct smu_context * smu , enum smu_clk_type clk_type , uint32_t * min , uint32_t * max ) { DpmClocks_t * clk_table = smu -> smu_table . clocks_table ; uint32_t clock_limit ; uint32_t max_dpm_level , min_dpm_level ; int ret = 0 ; if ( ! yellow_carp_clk_dpm_is_enabled ( smu , clk_type ) ) { switch ( clk_type ) { case SMU_MCLK : case SMU_UCLK : clock_limit = smu -> smu_table . boot_values . uclk ; break ; case SMU_FCLK : clock_limit = smu -> smu_table . boot_values . fclk ; break ; case SMU_GFXCLK : case SMU_SCLK : clock_limit = smu -> smu_table . boot_values . gfxclk ; break ; case SMU_SOCCLK : clock_limit = smu -> smu_table . boot_values . socclk ; break ; case SMU_VCLK : clock_limit = smu -> smu_table . boot_values . vclk ; break ; case SMU_DCLK : clock_limit = smu -> smu_table . boot_values . dclk ; break ; default : clock_limit = 0 ; break ; } if ( min ) { * min = clock_limit / 100 ; } if ( max ) { * max = clock_limit / 100 ; } return 0 ; } if ( max ) { switch ( clk_type ) { case SMU_GFXCLK : case SMU_SCLK : * max = clk_table -> MaxGfxClk ; break ; case SMU_MCLK : case SMU_UCLK : case SMU_FCLK : max_dpm_level = 0 ; break ; case SMU_SOCCLK : break ; case SMU_VCLK : case SMU_DCLK : max_dpm_level = clk_table -> VcnClkLevelsEnabled - 1 ; break ; default : ret = - EINVAL ; failed } if ( clk_type != SMU_GFXCLK && clk_type != SMU_SCLK ) { ret = yellow_carp_get_dpm_freq_by_index ( smu , clk_type , max_dpm_level , max ) ; if ( ret ) { failed } } } if ( min ) { switch ( clk_type ) { case SMU_GFXCLK : case SMU_SCLK : * min = clk_table -> MinGfxClk ; break ; case SMU_MCLK : case SMU_UCLK : case SMU_FCLK : min_dpm_level = clk_table -> NumDfPstatesEnabled - 1 ; break ; case SMU_SOCCLK : min_dpm_level = 0 ; break ; case SMU_VCLK : case SMU_DCLK : min_dpm_level = 0 ; break ; default : ret = - EINVAL ; failed } if ( clk_type != SMU_GFXCLK && clk_type != SMU_SCLK ) { ret = yellow_carp_get_dpm_freq_by_index ( smu , clk_type , min_dpm_level , min ) ; if ( ret ) { failed } } } failed return ret ; } 