start2 for ( ; ; ) { int ret ; i ++ ; if ( ( attr_sk == NULL ) || ( sk_CONF_VALUE_num ( attr_sk ) <= i ) ) { break ; } v = sk_CONF_VALUE_value ( attr_sk , i ) ; type = v -> name ; if ( ( nid = OBJ_txt2nid ( type ) ) == NID_undef ) { start2 } ret = snprintf ( buf , sizeof buf , "%s_default" , type ) ; if ( ret < 0 || ret >= sizeof ( buf ) ) { BIO_printf ( bio_err , "Name '%s' too long for default\n" , v -> name ) ; return 0 ; } if ( ( def = NCONF_get_string ( req_conf , attr_sect , buf ) ) == NULL ) { ERR_clear_error ( ) ; def = "" ; } ret = snprintf ( buf , sizeof buf , "%s_value" , type ) ; if ( ret < 0 || ret >= sizeof ( buf ) ) { BIO_printf ( bio_err , "Name '%s' too long for value\n" , v -> name ) ; return 0 ; } if ( ( value = NCONF_get_string ( req_conf , attr_sect , buf ) ) == NULL ) { ERR_clear_error ( ) ; value = NULL ; } ret = snprintf ( buf , sizeof buf , "%s_min" , type ) ; if ( ret < 0 || ret >= sizeof ( buf ) ) { BIO_printf ( bio_err , "Name '%s' too long for min\n" , v -> name ) ; return 0 ; } if ( ! NCONF_get_number ( req_conf , attr_sect , buf , & n_min ) ) { ERR_clear_error ( ) ; n_min = - 1 ; } ret = snprintf ( buf , sizeof buf , "%s_max" , type ) ; if ( ret < 0 || ret >= sizeof ( buf ) ) { BIO_printf ( bio_err , "Name '%s' too long for max\n" , v -> name ) ; return 0 ; } if ( ! add_attribute_object ( req , v -> value , def , value , nid , n_min , n_max , chtype ) ) { return 0 ; } } else { BIO_printf ( bio_err , "No template, please set one up.\n" ) ; return 0 ; } return 1 ; 