int far main ( unsigned char * dest , unsigned int destlen , unsigned char * source , unsigned int sourcelen ) { struct state s ; int last , type ; int err ; s . out = dest ; s . outlen = destlen ; s . outcnt = 0 ; s . in = source ; s . inlen = sourcelen ; s . incnt = 0 ; s . bitbuf = 0 ; s . bitcnt = 0 ; { last = bits ( & s , 1 ) ; type = bits ( & s , 2 ) ; switch ( type ) { case 0 : break ; case 1 : err = fixed ( & s ) ; break ; case 2 : err = dynamic ( & s ) ; break ; default : err = - 1 ; break ; } if ( err != 0 ) { break ; } } ! last ; return err ; } 