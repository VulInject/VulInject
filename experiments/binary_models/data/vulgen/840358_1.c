static void _dpu_hw_setup_scaler3_lut ( struct dpu_hw_blk_reg_map * c , struct dpu_hw_scaler3_cfg * scaler3_cfg , u32 offset ) { int i , j , filter ; int config_lut = 0x0 ; unsigned long lut_flags ; u32 lut_addr , lut_offset , lut_len ; u32 * lut [ QSEED3_FILTERS ] { NULL NULL NULL NULL NULL } ; ; static const uint32_t off_tbl [ QSEED3_FILTERS ] [ QSEED3_LUT_REGIONS ] [ 2 ] { { { 18 0x000 } { 12 0x120 } { 12 0x1E0 } { 8 0x2A0 } } { { 6 0x320 } { 3 0x3E0 } { 3 0x440 } { 3 0x4A0 } } { { 6 0x500 } { 3 0x5c0 } { 3 0x620 } { 3 0x680 } } { { 6 0x380 } { 3 0x410 } { 3 0x470 } { 3 0x4d0 } } { { 6 0x560 } { 3 0x5f0 } { 3 0x650 } { 3 0x6b0 } } } ; ; lut_flags = ( unsigned long ) scaler3_cfg -> lut_flag ; if ( test_bit ( QSEED3_COEF_LUT_DIR_BIT , & lut_flags ) && ( scaler3_cfg -> dir_len == QSEED3_DIR_LUT_SIZE ) ) { lut [ 0 ] = scaler3_cfg -> dir_lut ; config_lut = 1 ; } if ( test_bit ( QSEED3_COEF_LUT_Y_CIR_BIT , & lut_flags ) && ( scaler3_cfg -> y_rgb_cir_lut_idx < QSEED3_CIRCULAR_LUTS ) && ( scaler3_cfg -> cir_len == QSEED3_CIR_LUT_SIZE ) ) { lut [ 1 ] = scaler3_cfg -> cir_lut + scaler3_cfg -> y_rgb_cir_lut_idx * QSEED3_LUT_SIZE ; config_lut = 1 ; } if ( test_bit ( QSEED3_COEF_LUT_UV_CIR_BIT , & lut_flags ) && ( scaler3_cfg -> uv_cir_lut_idx < QSEED3_CIRCULAR_LUTS ) && ( scaler3_cfg -> cir_len == QSEED3_CIR_LUT_SIZE ) ) { lut [ 2 ] = scaler3_cfg -> cir_lut + scaler3_cfg -> uv_cir_lut_idx * QSEED3_LUT_SIZE ; config_lut = 1 ; } if ( test_bit ( QSEED3_COEF_LUT_Y_SEP_BIT , & lut_flags ) && ( scaler3_cfg -> y_rgb_sep_lut_idx < QSEED3_SEPARABLE_LUTS ) && ( scaler3_cfg -> sep_len == QSEED3_SEP_LUT_SIZE ) ) { lut [ 3 ] = scaler3_cfg -> sep_lut + scaler3_cfg -> y_rgb_sep_lut_idx * QSEED3_LUT_SIZE ; config_lut = 1 ; } if ( test_bit ( QSEED3_COEF_LUT_UV_SEP_BIT , & lut_flags ) && ( scaler3_cfg -> uv_sep_lut_idx < QSEED3_SEPARABLE_LUTS ) && ( scaler3_cfg -> sep_len == QSEED3_SEP_LUT_SIZE ) ) { lut [ 4 ] = scaler3_cfg -> sep_lut + scaler3_cfg -> uv_sep_lut_idx * QSEED3_LUT_SIZE ; config_lut = 1 ; } if ( test_bit ( QSEED3_COEF_LUT_SWAP_BIT , & lut_flags ) ) { DPU_REG_WRITE ( c , QSEED3_COEF_LUT_CTRL + offset , BIT ( 0 ) ) ; } } 