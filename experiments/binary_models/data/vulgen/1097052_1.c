static int DetectHttpClientBodyTest22 ( void ) { DetectEngineCtx * de_ctx = NULL ; int result = 0 ; if ( ( de_ctx = DetectEngineCtxInit ( ) ) == NULL ) { end } de_ctx -> flags |= DE_QUIET ; de_ctx -> sig_list = SigInit ( de_ctx , "alert icmp any any ->any any " "(content:\"one\"; content:\"two\"; http_client_body; " "content:\"three\"; distance:10; http_client_body; content:\"four\"; sid:1;)" ) ; if ( de_ctx -> sig_list == NULL ) { printf ( "de_ctx->sig_list == NULL\n" ) ; end } if ( de_ctx -> sig_list -> sm_lists [ DETECT_SM_LIST_PMATCH ] == NULL ) { printf ( "de_ctx->sig_list->sm_lists[DETECT_SM_LIST_PMATCH] == NULL\n" ) ; end } DetectContentData * cd1 = ( DetectContentData * ) de_ctx -> sig_list -> sm_lists_tail [ DETECT_SM_LIST_PMATCH ] -> prev -> ctx ; DetectContentData * cd2 = ( DetectContentData * ) de_ctx -> sig_list -> sm_lists_tail [ DETECT_SM_LIST_PMATCH ] -> ctx ; DetectContentData * hcbd1 = ( DetectContentData * ) de_ctx -> sig_list -> sm_lists_tail [ g_http_client_body_buffer_id ] -> prev -> ctx ; DetectContentData * hcbd2 = ( DetectContentData * ) de_ctx -> sig_list -> sm_lists_tail [ g_http_client_body_buffer_id ] -> ctx ; if ( cd1 -> flags != 0 || memcmp ( cd1 -> content , "one" , cd1 -> content_len ) != 0 || cd2 -> flags != 0 || memcmp ( cd2 -> content , "four" , cd2 -> content_len ) != 0 || hcbd1 -> flags != DETECT_CONTENT_RELATIVE_NEXT || memcmp ( hcbd1 -> content , "two" , hcbd1 -> content_len ) != 0 || hcbd2 -> flags != DETECT_CONTENT_DISTANCE || memcmp ( hcbd2 -> content , "three" , hcbd1 -> content_len ) != 0 ) { end } if ( ! DETECT_CONTENT_IS_SINGLE ( cd1 ) || ! DETECT_CONTENT_IS_SINGLE ( cd2 ) || DETECT_CONTENT_IS_SINGLE ( hcbd1 ) || DETECT_CONTENT_IS_SINGLE ( hcbd2 ) ) { end } result = 1 ; end DetectEngineCtxFree ( de_ctx ) ; return result ; } 