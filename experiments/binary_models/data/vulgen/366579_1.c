static int btrfs_write_and_wait_marked_extents ( struct btrfs_fs_info * fs_info , struct extent_io_tree * dirty_pages , int mark ) { int ret ; int ret2 ; struct blk_plug plug ; blk_start_plug ( & plug ) ; ret = btrfs_write_marked_extents ( fs_info , dirty_pages , mark ) ; blk_finish_plug ( & plug ) ; ret2 = btrfs_wait_extents ( fs_info , dirty_pages ) ; if ( ret ) { return ret ; } return 0 ; } 