NTSTATUS OvsGetIfEntry ( GUID * interfaceGuid , PMIB_IF_ROW2 ifEntry ) { NTSTATUS status ; PMIB_IF_TABLE2 ifTable ; UINT32 i ; status = GetIfTable2Ex ( MibIfTableNormal , & ifTable ) ; if ( status != STATUS_SUCCESS ) { OVS_LOG_INFO ( "Fail to get if table, status: %x" , status ) ; return status ; } status = STATUS_NOT_FOUND ; for ( i = 0 ; i < ifTable -> NumEntries ; i ++ ) { PMIB_IF_ROW2 ifRow ; ifRow = & ifTable -> Table [ i ] ; if ( ! memcmp ( interfaceGuid , & ifRow -> InterfaceGuid , sizeof ( GUID ) ) ) { RtlCopyMemory ( ifEntry , ifRow , sizeof ( MIB_IF_ROW2 ) ) ; status = STATUS_SUCCESS ; OvsDumpIfRow ( ifEntry ) ; break ; } } FreeMibTable ( ifTable ) ; return status ; } 