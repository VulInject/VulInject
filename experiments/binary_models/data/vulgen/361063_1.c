static __poll_t snoop_file_poll ( struct file * file , struct poll_table_struct * pt ) { struct aspeed_lpc_snoop_channel * chan = snoop_file_to_chan ( file ) ; return ! kfifo_is_empty ( & chan -> fifo ) ?EPOLLIN : 0 ; } 