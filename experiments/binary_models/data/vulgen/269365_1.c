static void update_timeout_handler ( void * p_context ) { UNUSED_PARAMETER ( p_context ) ; if ( m_conn_handle != BLE_CONN_HANDLE_INVALID ) { m_update_count ++ ; if ( m_update_count <= m_conn_params_config . max_conn_params_update_count ) { uint32_t err_code ; err_code = sd_ble_gap_conn_param_update ( m_conn_handle , & m_preferred_conn_params ) ; if ( ( err_code != NRF_SUCCESS ) && ( m_conn_params_config . error_handler != NULL ) ) { m_conn_params_config . error_handler ( err_code ) ; } } else { m_update_count = 0 ; if ( m_conn_params_config . disconnect_on_fail ) { uint32_t err_code ; err_code = sd_ble_gap_disconnect ( m_conn_handle , BLE_HCI_CONN_INTERVAL_UNACCEPTABLE ) ; if ( ( err_code != NRF_SUCCESS ) && ( m_conn_params_config . error_handler != NULL ) ) { m_conn_params_config . error_handler ( err_code ) ; } } } } } 