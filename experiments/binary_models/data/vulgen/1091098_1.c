char * initstate ( unsigned int seed , char * arg_state , size_t size ) { unsigned int n ; struct _randomjunk * rp = _randomjunk ( ) ; char * ostate ; if ( size > UINT_MAX ) { n = UINT_MAX ; } else { n = ( unsigned int ) size ; } ostate = ( char * ) ( & rp -> state [ - 1 ] ) ; if ( rp -> rand_type == TYPE_0 ) { rp -> state [ - 1 ] = rp -> rand_type ; } else { rp -> state [ - 1 ] = ( unsigned int ) ( MAX_TYPES * ( rp -> rptr - rp -> state ) + rp -> rand_type ) ; } if ( n < BREAK_1 ) { if ( n < BREAK_0 ) { return ( NULL ) ; } rp -> rand_type = TYPE_0 ; rp -> rand_deg = DEG_0 ; rp -> rand_sep = SEP_0 ; } else { if ( n < BREAK_2 ) { rp -> rand_type = TYPE_1 ; rp -> rand_deg = DEG_1 ; rp -> rand_sep = SEP_1 ; } else { if ( n < BREAK_3 ) { rp -> rand_type = TYPE_2 ; rp -> rand_deg = DEG_2 ; rp -> rand_sep = SEP_2 ; } else { if ( n < BREAK_4 ) { rp -> rand_type = TYPE_3 ; rp -> rand_deg = DEG_3 ; rp -> rand_sep = SEP_3 ; } else { rp -> rand_type = TYPE_4 ; rp -> rand_deg = DEG_4 ; rp -> rand_sep = SEP_4 ; } } } } rp -> state = & ( ( ( unsigned int * ) ( uintptr_t ) arg_state ) [ 1 ] ) ; rp -> end_ptr = & rp -> state [ rp -> rand_deg ] ; srandom ( seed ) ; if ( rp -> rand_type == TYPE_0 ) { rp -> state [ - 1 ] = rp -> rand_type ; } else { rp -> state [ - 1 ] = ( unsigned int ) ( MAX_TYPES * ( rp -> rptr - rp -> state ) + rp -> rand_type ) ; } return ( ostate ) ; } 