void tls13_alert_received_cb ( uint8_t alert_desc , void * arg ) { struct tls13_ctx * ctx = arg ; if ( alert_desc == TLS13_ALERT_CLOSE_NOTIFY ) { ctx -> close_notify_recv = 1 ; ctx -> ssl -> shutdown |= SSL_RECEIVED_SHUTDOWN ; ctx -> ssl -> s3 -> warn_alert = alert_desc ; return ; } if ( alert_desc == TLS13_ALERT_USER_CANCELED ) { return ; } ctx -> ssl -> s3 -> fatal_alert = alert_desc ; SSLerror ( ctx -> ssl , SSL_AD_REASON_OFFSET + alert_desc ) ; ERR_asprintf_error_data ( "SSL alert number %d" , alert_desc ) ; } 