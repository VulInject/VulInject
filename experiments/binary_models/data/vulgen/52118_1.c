uintptr_t ld_lib_setup ( Ofl_desc * ofl ) { char * path , * cp = NULL ; if ( ! ( ofl -> ofl_flags & FLG_OF_IGNENV ) ) { if ( ( cp = getenv ( MSG_ORIG ( MSG_LD_LIBPATH_64 ) ) ) == NULL ) { if ( ( cp = getenv ( MSG_ORIG ( MSG_LD_LIBPATH_32 ) ) ) == NULL ) { cp = getenv ( MSG_ORIG ( MSG_LD_LIBPATH ) ) ; } } } if ( cp && cp [ 0 ] ) { ( void ) strcpy ( path , cp ) ; DBG_CALL ( Dbg_libs_path ( ofl -> ofl_lml , path , LA_SER_DEFAULT , 0 ) ) ; path = process_lib_path ( ofl , & ofl -> ofl_ulibdirs , path , FALSE ) ; if ( path ) { Lidx = aplist_nitems ( ofl -> ofl_ulibdirs ) ; * path = '\0' ; ++ path ; cp = process_lib_path ( ofl , & ofl -> ofl_ulibdirs , path , FALSE ) ; if ( cp == ( char * ) S_ERROR ) { return ( S_ERROR ) ; } if ( cp ) { ld_eprintf ( ofl , ERR_WARNING , MSG_INTL ( MSG_LIB_MALFORM ) ) ; } } } DBG_CALL ( Dbg_libs_yp ( ofl -> ofl_lml , Plibpath ) ) ; cp = process_lib_path ( ofl , & ofl -> ofl_dlibdirs , Plibpath , TRUE ) ; if ( cp == ( char * ) S_ERROR ) { return ( S_ERROR ) ; } if ( cp ) { ld_eprintf ( ofl , ERR_FATAL , MSG_INTL ( MSG_LIB_BADYP ) ) ; return ( S_ERROR ) ; } DBG_CALL ( Dbg_libs_init ( ofl -> ofl_lml , ofl -> ofl_ulibdirs , ofl -> ofl_dlibdirs ) ) ; return ( 1 ) ; } 