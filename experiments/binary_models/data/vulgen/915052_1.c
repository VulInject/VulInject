( ipu_di_put ) ; int ipu_di_init ( struct ipu_soc * ipu , struct device * dev , int id , unsigned long base , u32 module , struct clk * clk_ipu ) { struct ipu_di * di ; di = devm_kzalloc ( dev , sizeof ( * di ) , GFP_KERNEL ) ; if ( ! di ) { return - ENOMEM ; } ipu -> di_priv [ id ] = di ; di -> clk_di = devm_clk_get ( dev , id ?"di1" : "di0" ) ; if ( IS_ERR ( di -> clk_di ) ) { return PTR_ERR ( di -> clk_di ) ; } di -> module = module ; di -> id = id ; di -> clk_ipu = clk_ipu ; di -> base = devm_ioremap ( dev , base , PAGE_SIZE ) ; if ( ! di -> base ) { return - ENOMEM ; } ipu_di_write ( di , 0x10 , DI_BS_CLKGEN0 ) ; dev_dbg ( dev , "DI%d base: 0x%08lx remapped to %p\n" , id , base , di -> base ) ; di -> inuse = false ; di -> ipu = ipu ; return 0 ; } 