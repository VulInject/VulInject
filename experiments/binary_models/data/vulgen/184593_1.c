static void kvm_s390_tod_vm_state_change ( void * opaque , bool running , RunState state ) { S390TODState * td = opaque ; if ( running && td -> stopped ) { kvm_s390_set_tod_raw ( & td -> base , & local_err ) ; if ( local_err ) { warn_report_err ( local_err ) ; } td -> stopped = false ; } if ( ! running && ! td -> stopped ) { kvm_s390_get_tod_raw ( & td -> base , & local_err ) ; if ( local_err ) { warn_report_err ( local_err ) ; } else { td -> stopped = true ; } } } 