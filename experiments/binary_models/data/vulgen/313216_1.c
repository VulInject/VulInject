void pci_prd_slot_name ( uint32_t bus , dev_info_t * dip ) { char slotprop [ 256 ] ; int len ; char * slotcap_name ; if ( dip != NULL ) { if ( ddi_prop_lookup_string ( DDI_DEV_T_ANY , pci_bus_res [ bus ] . dip , DDI_PROP_DONTPASS , "slot-names" , & slotcap_name ) != DDI_SUCCESS || strcmp ( slotcap_name , "pcie0" ) != 0 ) { ( void ) ndi_prop_remove ( DDI_DEV_T_NONE , pci_bus_res [ bus ] . dip , "slot-names" ) ; } } len = pci_slot_names_prop ( bus , slotprop , sizeof ( slotprop ) ) ; if ( len > 0 ) { if ( dip != NULL ) { ASSERT ( ( len % sizeof ( int ) ) == 0 ) ; ( void ) ndi_prop_update_int_array ( DDI_DEV_T_NONE , pci_bus_res [ bus ] . dip , "slot-names" , ( int * ) slotprop , len / sizeof ( int ) ) ; } else { cmn_err ( CE_NOTE , "!BIOS BUG: Invalid bus number in PCI " "IRQ routing table; Not adding slot-names " "property for incorrect bus %d" , bus ) ; } } } 