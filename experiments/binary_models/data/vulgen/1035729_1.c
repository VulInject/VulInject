static int DetectFiledataParseTest01 ( void ) { DetectEngineCtx * de_ctx = DetectEngineCtxInit ( ) ; FAIL_IF_NULL ( de_ctx ) ; de_ctx -> flags |= DE_QUIET ; Signature * s = DetectEngineAppendSig ( de_ctx , "alert smtp any any ->any any " "(msg:\"test\"; file_data; content:\"abc\"; sid:1;)" ) ; FAIL_IF_NULL ( s ) ; FAIL_IF_NOT_NULL ( s -> sm_lists [ DETECT_SM_LIST_PMATCH ] ) ; FAIL_IF_NULL ( s -> sm_lists [ g_file_data_buffer_id ] ) ; PASS ; } 