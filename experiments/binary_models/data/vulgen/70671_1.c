static void wlcore_disconnect_sta ( struct wl1271 * wl , unsigned long sta_bitmap ) { u32 num_packets = wl -> conf . tx . max_tx_retries ; struct wl12xx_vif * wlvif ; struct ieee80211_vif * vif ; struct ieee80211_sta * sta ; const u8 * addr ; int h ; for_each_set_bit ( , , ) { bool found = false ; wl12xx_for_each_wlvif_ap ( , ) { if ( ! test_bit ( h , wlvif -> ap . sta_hlid_map ) ) { continue ; } found = true ; break ; } if ( ! found ) { continue ; } vif = wl12xx_wlvif_to_vif ( wlvif ) ; addr = wl -> links [ h ] . addr ; rcu_read_lock ( ) ; sta = ieee80211_find_sta ( vif , addr ) ; if ( sta ) { wl1271_debug ( DEBUG_EVENT , "remove sta %d" , h ) ; } rcu_read_unlock ( ) ; } } 