static uint32_t ast2600_get_uxclk_in_rate ( struct ast2600_scu * scu ) { uint32_t rate ; uint32_t clksrc5 = readl ( & scu -> clksrc5 ) ; uint32_t uxclk = ( clksrc5 & SCU_CLKSRC5_UXCLK_MASK ) >> SCU_CLKSRC5_UXCLK_SHIFT ; switch ( uxclk ) { case 0 : rate = ast2600_get_pll_rate ( scu , ASPEED_CLK_APLL ) / 4 ; break ; case 1 : rate = ast2600_get_pll_rate ( scu , ASPEED_CLK_APLL ) / 2 ; break ; case 2 : rate = ast2600_get_pll_rate ( scu , ASPEED_CLK_APLL ) ; break ; case 3 : rate = ast2600_get_hclk_rate ( scu ) ; break ; } return rate ; } 