int main ( int argc , char * argv [ ] ) { int ret = 1 ; int exit_code = MBEDTLS_EXIT_FAILURE ; unsigned char buf [ 100000 ] ; mbedtls_x509_csr csr ; int i ; char * p , * q ; mbedtls_x509_csr_init ( & csr ) ; if ( argc == 0 ) { usage mbedtls_printf ( USAGE ) ; exit } opt . filename = DFL_FILENAME ; for ( i = 1 ; i < argc ; i ++ ) { p = argv [ i ] ; if ( ( q = strchr ( p , '=' ) ) == NULL ) { usage } * q ++ = '\0' ; if ( strcmp ( p , "filename" ) == 0 ) { opt . filename = q ; } else { usage } } mbedtls_printf ( "\n  . Loading the CSR ..." ) ; fflush ( stdout ) ; ret = mbedtls_x509_csr_parse_file ( & csr , opt . filename ) ; if ( ret != 0 ) { mbedtls_printf ( " failed\n  !  mbedtls_x509_csr_parse_file returned %d\n\n" , ret ) ; exit } mbedtls_printf ( " ok\n" ) ; mbedtls_printf ( "  . CSR information    ...\n" ) ; ret = mbedtls_x509_csr_info ( ( char * ) buf , sizeof ( buf ) - 1 , "      " , & csr ) ; if ( ret == - 1 ) { mbedtls_printf ( " failed\n  !  mbedtls_x509_csr_info returned %d\n\n" , ret ) ; mbedtls_x509_csr_free ( & csr ) ; exit } mbedtls_printf ( "%s\n" , buf ) ; exit_code = MBEDTLS_EXIT_SUCCESS ; exit mbedtls_x509_csr_free ( & csr ) ; mbedtls_printf ( "  + Press Enter to exit this program.\n" ) ; fflush ( stdout ) ; getchar ( ) ; mbedtls_exit ( exit_code ) ; } 