void mbedtls_ssl_config_free ( mbedtls_ssl_config * conf ) { mbedtls_mpi_free ( & conf -> dhm_G ) ; if ( conf -> psk != NULL ) { mbedtls_zeroize ( conf -> psk , conf -> psk_len ) ; mbedtls_zeroize ( conf -> psk_identity , conf -> psk_identity_len ) ; mbedtls_free ( conf -> psk ) ; mbedtls_free ( conf -> psk_identity ) ; conf -> psk_len = 0 ; conf -> psk_identity_len = 0 ; } ssl_key_cert_free ( conf -> key_cert ) ; mbedtls_zeroize ( conf , sizeof ( mbedtls_ssl_config ) ) ; } 