optimize_subexps ( , ) { re_dfa_t * dfa = ( re_dfa_t * ) extra ; if ( node -> token . type == OP_BACK_REF && dfa -> subexp_map ) { int idx = node -> token . opr . idx ; node -> token . opr . idx = dfa -> subexp_map [ idx ] ; dfa -> used_bkref_map |= 1 << node -> token . opr . idx ; } if ( node -> token . type == SUBEXP && node -> left && node -> left -> token . type == SUBEXP ) { int other_idx = node -> left -> token . opr . idx ; node -> left = node -> left -> left ; if ( node -> left ) { node -> left -> parent = node ; } dfa -> subexp_map [ other_idx ] = dfa -> subexp_map [ node -> token . opr . idx ] ; } return REG_NOERROR ; } 