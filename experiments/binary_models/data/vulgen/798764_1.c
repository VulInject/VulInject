static int GRE_ImageChanged ( GGadget * g , GEvent * e ) { if ( e -> type == et_controlevent && e -> u . control . subtype == et_buttonactivate ) { GRE * gre = GDrawGetUserData ( GGadgetGetWindow ( g ) ) ; GResImage * ri = GGadgetGetUserData ( g ) ; const char * path ; char * new ; if ( ri -> bucket && ri -> bucket -> absname ) { path = ri -> bucket -> absname ; } else { path = ri -> ini_name ; } new = gwwv_open_filename_with_path ( "Find Image" , path , "*.{png,jpeg,jpg,tiff,bmp,xbm}" , NULL , _GGadget_GetImagePath ( ) ) ; if ( new == NULL ) { return true ; } GImageCacheBucket * newb = _GGadgetImageCache ( new , false ) ; if ( newb == NULL ) { gwwv_post_error ( _ ( "Could not open image" ) , _ ( "Could not open %s as image" ) , new ) ; } else { ri -> bucket = newb ; } ( ( GButton * ) g ) -> image = GResImageGetImage ( ri ) ; GRect size ; GGadgetGetDesiredSize ( g , & size , NULL ) ; GGadgetResize ( g , size . width , size . height ) ; GRE_RefreshAll ( gre ) ; } return true ; } 