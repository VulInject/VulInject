( LNetMDBind ) ; int LNetMDUnlink ( struct lnet_handle_md mdh ) { struct lnet_event ev ; struct lnet_libmd * md ; int cpt ; LASSERT ( the_lnet . ln_refcount > 0 ) ; cpt = lnet_cpt_of_cookie ( mdh . cookie ) ; lnet_res_lock ( cpt ) ; md = lnet_handle2md ( & mdh ) ; if ( ! md ) { lnet_res_unlock ( cpt ) ; return - ENOENT ; } md -> md_flags |= LNET_MD_FLAG_ABORTED ; if ( md -> md_eq && ! md -> md_refcount ) { lnet_build_unlink_event ( md , & ev ) ; } lnet_md_unlink ( md ) ; lnet_res_unlock ( cpt ) ; return 0 ; } 