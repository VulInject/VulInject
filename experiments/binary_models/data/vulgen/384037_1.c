void rtl_cam_del_entry ( struct ieee80211_hw * hw , u8 * sta_addr ) { struct rtl_priv * rtlpriv = rtl_priv ( hw ) ; u32 bitmap ; u8 i , * addr ; if ( is_zero_ether_addr ( sta_addr ) ) { pr_err ( "sta_addr is %pM\n" , sta_addr ) ; return ; } for ( i = 4 ; i < TOTAL_CAM_ENTRY ; i ++ ) { addr = rtlpriv -> sec . hwsec_cam_sta_addr [ i ] ; bitmap = ( rtlpriv -> sec . hwsec_cam_bitmap ) >> i ; if ( ( ( bitmap & BIT ( 0 ) ) == BIT ( 0 ) ) && ( ether_addr_equal_unaligned ( addr , sta_addr ) ) ) { eth_zero_addr ( rtlpriv -> sec . hwsec_cam_sta_addr [ i ] ) ; rtlpriv -> sec . hwsec_cam_bitmap &= ~ ( BIT ( 0 ) << i ) ; rtl_dbg ( rtlpriv , COMP_SEC , DBG_DMESG , "&&&&&&&&&del entry %d\n" , i ) ; } } return ; } 