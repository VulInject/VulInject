static void base_w ( int * output , const int out_len , const unsigned char * input , const wots_params * params ) { int in = 0 ; int out = 0 ; int consumed ; int bits = 0 ; int consumed = 0 ; for ( consumed = 0 ; consumed < out_len ; consumed ++ ) { if ( bits == 0 ) { total = input [ in ] ; in ++ ; bits += 8 ; } bits -= params -> log_w ; output [ out ] = ( total >> bits ) & ( params -> w - 1 ) ; out ++ ; } } 