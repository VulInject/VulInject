void fhctl_parse_dt ( const u8 * compatible_node , struct mtk_pllfh_data * pllfhs , int num_fhs ) { void __iomem * base ; struct device_node * node ; u32 num_clocks , pll_id , ssc_rate ; int offset , i ; node = of_find_compatible_node ( NULL , NULL , compatible_node ) ; if ( ! node ) { pr_err ( "cannot find \"%s\"\n" , compatible_node ) ; return ; } base = of_iomap ( node , 0 ) ; if ( ! base ) { pr_err ( "%s(): ioremap failed\n" , __func__ ) ; return ; } num_clocks = of_clk_get_parent_count ( node ) ; for ( i = 0 ; i < num_clocks ; i ++ ) { struct mtk_pllfh_data * pllfh ; offset = i * 2 ; of_property_read_u32_index ( node , "clocks" , offset + 1 , & pll_id ) ; of_property_read_u32_index ( node , "mediatek,hopping-ssc-percent" , i , & ssc_rate ) ; pllfh = get_pllfh_by_id ( pllfhs , num_fhs , pll_id ) ; if ( ! pllfh ) { continue ; } pllfh -> state . fh_enable = 1 ; pllfh -> state . ssc_rate = ssc_rate ; pllfh -> state . base = base ; } } 