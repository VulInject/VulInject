int thermal_zone_create_device_groups ( struct thermal_zone_device * tz , int mask ) { const struct attribute_group * * groups ; int i , size , result ; size = ARRAY_SIZE ( thermal_zone_attribute_groups ) + 2 ; groups = kcalloc ( size , sizeof ( * groups ) , GFP_KERNEL ) ; if ( ! groups ) { return - ENOMEM ; } for ( i = 0 ; i < size - 2 ; i ++ ) { groups [ i ] = thermal_zone_attribute_groups [ i ] ; } if ( tz -> num_trips ) { result = create_trip_attrs ( tz , mask ) ; if ( result ) { kfree ( groups ) ; return result ; } } tz -> device . groups = groups ; return 0 ; } 