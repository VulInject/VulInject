gui_color_get_pair ( , ) { int index ; if ( gui_color_use_term_colors ) { return COLOR_WHITE ; } if ( fg >= gui_color_term_colors ) { fg = - 1 ; } if ( bg >= gui_color_term_colors ) { bg = - 1 ; } index = ( ( bg + 1 ) * ( gui_color_term_colors + 2 ) ) + ( fg + 1 ) ; if ( gui_color_pairs [ index ] == 0 ) { if ( gui_color_pairs_used >= gui_color_num_pairs ) { if ( ! gui_color_warning_pairs_full && ( CONFIG_INTEGER ( config_look_color_pairs_auto_reset ) < 0 ) ) { hook_timer ( NULL , 1 , 0 , 1 , & gui_color_timer_warning_pairs_full , NULL , NULL ) ; gui_color_warning_pairs_full = 1 ; } return 1 ; } gui_color_pairs_used ++ ; gui_color_pairs [ index ] = gui_color_pairs_used ; init_pair ( gui_color_pairs_used , fg , bg ) ; gui_color_buffer_refresh_needed = 1 ; } return gui_color_pairs [ index ] ; } 