static boolean_t _cryptodebug_syslog = B_TRUE ; void cryptodebug ( const char * fmt , ... ) { va_list args ; char fmtbuf [ BUFSIZ ] ; char msgbuf [ BUFSIZ ] ; va_start ( args , fmt ) ; if ( _cryptodebug_prefix == NULL ) { ( void ) vsnprintf ( msgbuf , sizeof ( msgbuf ) , fmt , args ) ; } else { ( void ) snprintf ( fmtbuf , sizeof ( fmtbuf ) , "%s: %s" , _cryptodebug_prefix , fmt ) ; ( void ) vsnprintf ( msgbuf , sizeof ( msgbuf ) , fmtbuf , args ) ; } if ( _cryptodebug_syslog ) { syslog ( LOG_DEBUG , msgbuf ) ; } else { ( void ) fprintf ( stderr , "%s\n" , msgbuf ) ; } va_end ( args ) ; } 