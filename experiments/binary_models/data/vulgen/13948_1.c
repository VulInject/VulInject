static void display_warning ( pam_handle_t * pamh , int failures , char * homedir ) { char hushpath [ MAXPATHLEN ] ; struct stat buf ; ( void ) snprintf ( hushpath , sizeof ( hushpath ) , "%s/.hushlogin" , homedir ) ; if ( failures == 1 ) { error ( pamh , "Warning: 1 failed login attempt since last " "successful login." ) ; } if ( failures < FAILCOUNT_MASK ) { error ( pamh , "Warning: %d failed login attempts since last " "successful login." , failures ) ; } else { error ( pamh , "Warning: at least %d failed login attempts since " "last successful login." , failures ) ; } } 