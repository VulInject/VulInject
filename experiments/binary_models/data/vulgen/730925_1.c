int ldp_vty_nbr_session_holdtime ( struct vty * vty , const char * negate , struct in_addr lsr_id , long secs ) { struct nbr_params * nbrp ; if ( bad_addr_v4 ( lsr_id ) ) { vty_out ( vty , "%% Malformed address\n" ) ; return ( CMD_WARNING_CONFIG_FAILED ) ; } nbrp = nbr_params_find ( vty_conf , lsr_id ) ; if ( negate ) { nbrp -> keepalive = 0 ; nbrp -> flags &= ~ F_NBRP_KEEPALIVE ; } else { if ( nbrp == NULL ) { nbrp = nbr_params_new ( lsr_id ) ; RB_INSERT ( nbrp_head , & vty_conf -> nbrp_tree , nbrp ) ; QOBJ_REG ( nbrp , nbr_params ) ; } if ( nbrp -> keepalive == secs ) { return ( CMD_SUCCESS ) ; } nbrp -> keepalive = secs ; nbrp -> flags |= F_NBRP_KEEPALIVE ; } ldp_config_apply ( vty , vty_conf ) ; return ( CMD_SUCCESS ) ; } 