static void parse_cmd_args ( int argc , int start , char * * argv ) { int opt ; int option_index ; static struct option long_options [ ] { { "bucket" required_argument 0 'b' } { "level" required_argument 0 'l' } { "online" required_argument 0 'o' } { "trl-type" required_argument 0 'r' } { "trl" required_argument 0 't' } { "help" no_argument 0 'h' } { "clos" required_argument 0 'c' } { "desired" required_argument 0 'd' } { "epp" required_argument 0 'e' } { "min" required_argument 0 'n' } { "max" required_argument 0 'm' } { "priority" required_argument 0 'p' } { "weight" required_argument 0 'w' } { "auto" no_argument 0 'a' } { 0 0 0 0 } } ; ; option_index = start ; optind = start + 1 ; while ( ( opt = getopt_long ( argc , argv , "b:l:t:c:d:e:n:m:p:w:r:hoa" , long_options , & option_index ) ) != - 1 ) { switch ( opt ) { case 'a' : auto_mode = 1 ; break ; case 'b' : fact_bucket = atoi ( optarg ) ; break ; case 'h' : cmd_help = 1 ; break ; case 'l' : tdp_level = atoi ( optarg ) ; break ; case 'o' : force_online_offline = 1 ; break ; case 't' : sscanf ( optarg , "0x%llx" , & fact_trl ) ; break ; case 'r' : if ( ! strncmp ( optarg , "sse" , 3 ) ) { fact_avx = 0x01 ; } if ( ! strncmp ( optarg , "avx2" , 4 ) ) { fact_avx = 0x02 ; } if ( ! strncmp ( optarg , "avx512" , 6 ) ) { fact_avx = 0x04 ; } else { fprintf ( outf , "Invalid sse,avx options\n" ) ; exit ( 1 ) ; } break ; case 'c' : current_clos = atoi ( optarg ) ; break ; case 'd' : clos_desired = atoi ( optarg ) ; clos_desired /= DISP_FREQ_MULTIPLIER ; break ; case 'e' : clos_epp = atoi ( optarg ) ; break ; case 'n' : clos_min = atoi ( optarg ) ; clos_min /= DISP_FREQ_MULTIPLIER ; break ; case 'm' : clos_max = atoi ( optarg ) ; clos_max /= DISP_FREQ_MULTIPLIER ; break ; case 'p' : clos_priority_type = atoi ( optarg ) ; if ( is_skx_based_platform ( ) && ! clos_priority_type ) { isst_display_error_info_message ( 1 , "Invalid clos priority type: proportional for this platform" , 0 , 0 ) ; exit ( 0 ) ; } break ; case 'w' : clos_prop_prio = atoi ( optarg ) ; if ( is_skx_based_platform ( ) ) { isst_display_error_info_message ( 1 , "weight can't be specified on this platform" , 0 , 0 ) ; exit ( 0 ) ; } break ; default : printf ( "Unknown option: ignore\n" ) ; } } if ( argv [ optind ] ) { printf ( "Garbage at the end of command: ignore\n" ) ; } } 