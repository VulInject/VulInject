_gcry_pk_util_get_nbits ( , ) { char buf [ 50 ] ; const char * s ; size_t n ; * r_nbits = 0 ; list = gcry_sexp_find_token ( list , "nbits" , 0 ) ; if ( ! list ) { return 0 ; } s = gcry_sexp_nth_data ( list , 1 , & n ) ; if ( ! s || n >= DIM ( buf ) - 1 ) { return GPG_ERR_INV_OBJ ; } memcpy ( buf , s , n ) ; buf [ n ] = 0 ; * r_nbits = ( unsigned int ) strtoul ( buf , NULL , 0 ) ; gcry_sexp_release ( list ) ; return 0 ; } 