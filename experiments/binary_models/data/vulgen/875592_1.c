SQLITE_API int sqlite3_vfs_register ( sqlite3_vfs * pVfs , int makeDflt ) { MUTEX_LOGIC ( ) int rc = sqlite3_initialize ( ) ; if ( rc ) { return rc ; } MUTEX_LOGIC ( ) sqlite3_mutex_enter ( mutex ) ; vfsUnlink ( pVfs ) ; if ( makeDflt || vfsList == 0 ) { pVfs -> pNext = vfsList ; vfsList = pVfs ; } else { pVfs -> pNext = vfsList -> pNext ; vfsList -> pNext = pVfs ; } assert ( vfsList ) ; sqlite3_mutex_leave ( mutex ) ; return SQLITE_OK ; } 