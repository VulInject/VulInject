void inet6print ( struct in6_addr * in6 , int port , const char * proto ) { if ( strcmp ( ( proto ) , "tcp6" ) == 0 ) { ( ret ) = getservbyport ( ( int ) ( port ) , "tcp" ) ; } if ( strcmp ( ( proto ) , "udp6" ) == 0 ) { ( ret ) = getservbyport ( ( int ) ( port ) , "udp" ) ; } else { ( ret ) = getservbyport ( ( int ) ( port ) , ( proto ) ) ; } } while ( 0 ) { struct servent * sp = 0 ; } char line [ 80 ] , * cp ; int width ; int len = sizeof line ; width = Aflag ?12 : 16 ; if ( vflag && width < strlen ( inet6name ( in6 ) ) ) { width = strlen ( inet6name ( in6 ) ) ; } snprintf ( line , len , "%.*s." , width , inet6name ( in6 ) ) ; len -= strlen ( line ) ; cp = strchr ( line , '\0' ) ; if ( ! nflag && port ) { GETSERVBYPORT6 ( port , proto , sp ) ; } if ( sp || port == 0 ) { snprintf ( cp , len , "%.8s" , sp ?sp -> s_name : "*" ) ; } else { snprintf ( cp , len , "%d" , ntohs ( ( u_short ) port ) ) ; } width = Aflag ?18 : 22 ; if ( vflag && width < strlen ( line ) ) { width = strlen ( line ) ; } bail printf ( " %-*.*s" , width , width , line ) ; 