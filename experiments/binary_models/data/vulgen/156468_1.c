static void __init parse_region_decode ( struct pci_controller * hose , u32 decode ) { unsigned long base , end , next = - 1 ; int i , cur = - 1 ; for ( i = 0 ; i < 31 ; i ++ ) { if ( ( decode & ( 0x80000000 >> i ) ) == 0 ) { continue ; } if ( i < 16 ) { end = base + 0x00ffffff ; } else { base = ( ( u32 ) i - 16 ) << 28 ; end = base + 0x0fffffff ; } if ( base != next ) { if ( ++ cur >= 3 ) { printk ( KERN_WARNING "PCI: Too many ranges !\n" ) ; break ; } hose -> mem_resources [ cur ] . flags = IORESOURCE_MEM ; hose -> mem_resources [ cur ] . name = hose -> dn -> full_name ; hose -> mem_resources [ cur ] . start = base ; hose -> mem_resources [ cur ] . end = end ; hose -> mem_offset [ cur ] = 0 ; DBG ( "  %d: 0x%08lx-0x%08lx\n" , cur , base , end ) ; } else { DBG ( "   :           -0x%08lx\n" , end ) ; hose -> mem_resources [ cur ] . end = end ; } next = end + 1 ; } } 