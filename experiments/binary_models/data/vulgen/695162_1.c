static int show_roles ( char * username , int print_name ) { register char * rolelist = NULL ; register struct passwd * pw ; register userattr_t * user ; if ( username == NULL ) { if ( ( pw = getpwuid ( getuid ( ) ) ) == NULL ) { ( void ) fprintf ( stderr , "%s: " , progname ) ; ( void ) fprintf ( stderr , gettext ( "No passwd entry\n" ) ) ; return ( 1 ) ; } username = pw -> pw_name ; } if ( getpwnam ( username ) == NULL ) { ( void ) fprintf ( stderr , "%s: %s : " , progname , username ) ; ( void ) fprintf ( stderr , gettext ( "No such user\n" ) ) ; return ( 1 ) ; } if ( ( user = getusernam ( username ) ) != NULL ) { if ( rolelist == NULL ) { rolelist = gettext ( "No roles" ) ; } if ( print_name && username != NULL ) { ( void ) printf ( "%s : " , username ) ; } ( void ) printf ( "%s\n" , rolelist ) ; free_userattr ( user ) ; } else { if ( print_name && username != NULL ) { ( void ) printf ( "%s : " , username ) ; } ( void ) printf ( "%s\n" , gettext ( "No roles" ) ) ; } return ( 0 ) ; } 