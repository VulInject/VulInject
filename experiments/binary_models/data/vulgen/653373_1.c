static int empty_caam_fq ( struct qman_fq * fq , struct caam_drv_ctx * drv_ctx ) { int ret ; int retries = 10 ; struct qm_mcr_queryfq_np np ; { ret = qman_query_fq_np ( fq , & np ) ; if ( ret ) { return ret ; } msleep ( 20 ) ; } 1 ; { if ( refcount_read ( & drv_ctx -> refcnt ) == 1 ) { break ; } msleep ( 20 ) ; } -- retries ; if ( ! retries ) { dev_warn_once ( drv_ctx -> qidev , "%d frames from FQID %u still pending in CAAM\n" , refcount_read ( & drv_ctx -> refcnt ) , fq -> fqid ) ; } return 0 ; } 