static int lowpan_iphc_uncompress_addr ( struct sk_buff * skb , const struct net_device * dev , struct in6_addr * ipaddr , u8 address_mode , const void * lladdr ) { bool fail ; switch ( address_mode ) { case LOWPAN_IPHC_DAM_00 : fail = lowpan_fetch_skb ( skb , ipaddr -> s6_addr , 16 ) ; break ; case LOWPAN_IPHC_SAM_01 : case LOWPAN_IPHC_DAM_01 : ipaddr -> s6_addr [ 0 ] = 0xFE ; ipaddr -> s6_addr [ 1 ] = 0x80 ; fail = lowpan_fetch_skb ( skb , & ipaddr -> s6_addr [ 8 ] , 8 ) ; break ; case LOWPAN_IPHC_SAM_10 : case LOWPAN_IPHC_DAM_10 : ipaddr -> s6_addr [ 0 ] = 0xFE ; ipaddr -> s6_addr [ 1 ] = 0x80 ; ipaddr -> s6_addr [ 11 ] = 0xFF ; ipaddr -> s6_addr [ 12 ] = 0xFE ; fail = lowpan_fetch_skb ( skb , & ipaddr -> s6_addr [ 14 ] , 2 ) ; break ; case LOWPAN_IPHC_SAM_11 : case LOWPAN_IPHC_DAM_11 : fail = false ; switch ( lowpan_dev ( dev ) -> lltype ) { case LOWPAN_LLTYPE_IEEE802154 : lowpan_iphc_uncompress_802154_lladdr ( ipaddr , lladdr ) ; break ; default : lowpan_iphc_uncompress_lladdr ( dev , ipaddr , lladdr ) ; break ; } break ; default : pr_debug ( "Invalid address mode value: 0x%x\n" , address_mode ) ; return - EINVAL ; } raw_dump_inline ( NULL , "Reconstructed ipv6 addr is" , ipaddr -> s6_addr , 16 ) ; return 0 ; } 