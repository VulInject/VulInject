void mpc_group_ready ( unsigned long adev ) { struct net_device * dev = ( net_device * ) adev ; struct ctcm_priv * priv = dev -> ml_priv ; struct mpc_group * grp = priv -> mpcg ; struct channel * ch = NULL ; if ( grp == NULL ) { CTCM_DBF_TEXT_ ( MPC_ERROR , CTC_DBF_ERROR , "%s(%s): No MPC group" , CTCM_FUNTAIL , dev -> name ) ; return ; } CTCM_DBF_TEXT_ ( MPC_SETUP , CTC_DBF_NOTICE , "%s: %s: GROUP TRANSITIONED TO READY, maxbuf = %d\n" , CTCM_FUNTAIL , dev -> name , grp -> group_max_buflen ) ; fsm_newstate ( grp -> fsm , MPCG_STATE_READY ) ; ch = priv -> channel [ CTCM_READ ] ; ch -> pdu_seq = 0 ; CTCM_PR_DBGDATA ( "ctcmpc: %s() ToDCM_pdu_seq= %08x\n" , __func__ , ch -> pdu_seq ) ; ctcmpc_chx_rxidle ( ch -> fsm , CTC_EVENT_START , ch ) ; ch = priv -> channel [ CTCM_WRITE ] ; ctcm_chx_txidle ( ch -> fsm , CTC_EVENT_START , ch ) ; ctcm_clear_busy ( dev ) ; if ( grp -> estconnfunc ) { grp -> estconnfunc ( grp -> port_num , 0 , grp -> group_max_buflen ) ; grp -> estconnfunc = NULL ; } if ( grp -> allochanfunc ) { grp -> allochanfunc ( grp -> port_num , grp -> group_max_buflen ) ; } grp -> send_qllc_disc = 1 ; grp -> changed_side = 0 ; return ; } 