static __inline VOID OvsCtEntryDelete ( POVS_CT_ENTRY entry , BOOLEAN forceDelete ) { if ( entry == NULL ) { return ; } KIRQL irql = KeGetCurrentIrql ( ) ; OVS_ACQUIRE_SPIN_LOCK ( & ( entry -> lock ) , irql ) ; if ( forceDelete || OvsCtEntryExpired ( entry ) ) { if ( entry -> natInfo . natAction ) { OvsNatDeleteKey ( & entry -> key ) ; } NdisInterlockedDecrement ( ( PLONG ) & zoneInfo [ entry -> key . zone ] . entries ) ; OvsPostCtEventEntry ( entry , OVS_EVENT_CT_DELETE ) ; RemoveEntryList ( & entry -> link ) ; OVS_RELEASE_SPIN_LOCK ( & ( entry -> lock ) , irql ) ; NdisFreeSpinLock ( & ( entry -> lock ) ) ; OvsFreeMemoryWithTag ( entry , OVS_CT_POOL_TAG ) ; NdisInterlockedDecrement ( ( PLONG ) & ctTotalEntries ) ; return ; } OVS_RELEASE_SPIN_LOCK ( & ( entry -> lock ) , irql ) ; } 