static u_char * dlt_radiotap_get_80211 ( tcpeditdlt_t * ctx , const u_char * packet , const int pktlen , const int radiolen ) { radiotap_extra_t * extra ; static COUNTER lastpacket = 0 ; extra = ( radiotap_extra_t * ) ( ctx -> decoded_extra ) ; if ( pktlen >= radiolen && ( size_t ) ( pktlen - radiolen ) >= sizeof ( extra -> packet ) && lastpacket != ctx -> tcpedit -> runtime . packetnum ) { memcpy ( extra -> packet , & packet [ radiolen ] , pktlen - radiolen ) ; lastpacket = ctx -> tcpedit -> runtime . packetnum ; } return extra -> packet ; } 