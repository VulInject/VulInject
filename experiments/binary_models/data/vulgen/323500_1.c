static inline void ssi_aead_hmac_authenc ( struct aead_request * req , HwDesc_s desc [ ] , unsigned int * seq_size ) { struct crypto_aead * tfm = crypto_aead_reqtfm ( req ) ; struct ssi_aead_ctx * ctx = crypto_aead_ctx ( tfm ) ; struct aead_req_ctx * req_ctx = aead_request_ctx ( req ) ; int direct = req_ctx -> gen_ctx . op_type ; if ( req_ctx -> is_single_pass == true ) { ssi_aead_hmac_setup_digest_desc ( req , desc , seq_size ) ; ssi_aead_setup_cipher_desc ( req , desc , seq_size ) ; ssi_aead_process_digest_header_desc ( req , desc , seq_size ) ; ssi_aead_process_cipher_data_desc ( req , data_flow_mode , desc , seq_size ) ; ssi_aead_process_digest_scheme_desc ( req , desc , seq_size ) ; ssi_aead_process_digest_result_desc ( req , desc , seq_size ) ; return ; } if ( direct == DRV_CRYPTO_DIRECTION_ENCRYPT ) { ssi_aead_process_cipher ( req , desc , seq_size , data_flow_mode ) ; ssi_aead_hmac_setup_digest_desc ( req , desc , seq_size ) ; ssi_aead_process_authenc_data_desc ( req , DIN_HASH , desc , seq_size , direct ) ; ssi_aead_process_digest_scheme_desc ( req , desc , seq_size ) ; ssi_aead_process_digest_result_desc ( req , desc , seq_size ) ; } else { ssi_aead_hmac_setup_digest_desc ( req , desc , seq_size ) ; ssi_aead_process_authenc_data_desc ( req , DIN_HASH , desc , seq_size , direct ) ; ssi_aead_process_digest_scheme_desc ( req , desc , seq_size ) ; ssi_aead_process_cipher ( req , desc , seq_size , data_flow_mode ) ; ssi_aead_process_digest_result_desc ( req , desc , seq_size ) ; } } 