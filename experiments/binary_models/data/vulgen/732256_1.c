static void loongson3_boot_secondary ( int cpu , struct task_struct * idle ) { unsigned long startargs [ 4 ] ; pr_info ( "Booting CPU#%d...\n" , cpu ) ; startargs [ 0 ] = ( unsigned long ) & smp_bootstrap ; startargs [ 1 ] = ( unsigned long ) __KSTK_TOS ( idle ) ; startargs [ 2 ] = ( unsigned long ) task_thread_info ( idle ) ; pr_debug ( "CPU#%d, func_pc=%lx, sp=%lx, gp=%lx\n" , cpu , startargs [ 0 ] , startargs [ 1 ] , startargs [ 2 ] ) ; loongson3_ipi_write64 ( startargs [ 3 ] , ( void * ) ( ipi_mailbox_buf [ cpu_logical_map ( cpu ) ] + 0x18 ) ) ; loongson3_ipi_write64 ( startargs [ 2 ] , ( void * ) ( ipi_mailbox_buf [ cpu_logical_map ( cpu ) ] + 0x10 ) ) ; loongson3_ipi_write64 ( startargs [ 1 ] , ( void * ) ( ipi_mailbox_buf [ cpu_logical_map ( cpu ) ] + 0x8 ) ) ; loongson3_ipi_write64 ( startargs [ 0 ] , ( void * ) ( ipi_mailbox_buf [ cpu_logical_map ( cpu ) ] + 0x0 ) ) ; } 