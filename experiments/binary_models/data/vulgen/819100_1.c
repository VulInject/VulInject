static ssize_t circpad_negotiated_parse_into ( circpad_negotiated_t * obj , const uint8_t * input , const size_t len_in ) { const uint8_t * ptr = input ; size_t remaining = len_in ; ssize_t result = 0 ; ( void ) result ; CHECK_REMAINING ( 1 , truncated ) ; obj -> version = ( trunnel_get_uint8 ( ptr ) ) ; remaining -= 1 ; ptr += 1 ; if ( ! ( obj -> version == 0 ) ) { fail } CHECK_REMAINING ( 1 , truncated ) ; obj -> command = ( trunnel_get_uint8 ( ptr ) ) ; remaining -= 1 ; ptr += 1 ; if ( ! ( obj -> command == CIRCPAD_COMMAND_START || obj -> command == CIRCPAD_COMMAND_STOP ) ) { fail } CHECK_REMAINING ( 1 , truncated ) ; obj -> response = ( trunnel_get_uint8 ( ptr ) ) ; remaining -= 1 ; ptr += 1 ; if ( ! ( obj -> response == CIRCPAD_RESPONSE_ERR || obj -> response == CIRCPAD_RESPONSE_OK ) ) { fail } CHECK_REMAINING ( 1 , truncated ) ; obj -> machine_type = ( trunnel_get_uint8 ( ptr ) ) ; remaining -= 1 ; ptr += 1 ; CHECK_REMAINING ( 4 , truncated ) ; obj -> machine_ctr = trunnel_ntohl ( trunnel_get_uint32 ( ptr ) ) ; remaining -= 4 ; ptr += 4 ; return len_in - remaining ; truncated return - 2 ; fail result = - 1 ; return result ; } 