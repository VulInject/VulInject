static void timeline_fence_release ( struct dma_fence * fence ) { struct sync_pt * pt = dma_fence_to_sync_pt ( fence ) ; struct sync_timeline * parent = dma_fence_parent ( fence ) ; unsigned long flags ; spin_lock_irqsave ( fence -> lock , flags ) ; if ( ! list_empty ( & pt -> link ) ) { list_del ( & pt -> link ) ; rb_erase ( & pt -> node , & parent -> pt_tree ) ; } spin_unlock_irqrestore ( fence -> lock , flags ) ; dma_fence_free ( fence ) ; } 