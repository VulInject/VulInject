static int slpv1_authblock ( ) { unsigned short bsd , length ; char msgbuf [ 128 ] ; int n ; if ( msglength < 12 ) { sprintf ( get_line ( 0 , 0 ) , "  [no room for auth block: remaining msg length = %u]" , msglength ) ; return ( - 1 ) ; } for ( n = 0 ; n < 8 ; n ++ , p += 1 ) { char tmp [ 16 ] ; sprintf ( tmp , "%02x" , ( unsigned char ) ( * p ) ) ; strcat ( msgbuf , tmp ) ; } nbtohs ( ) ; bsd = netval ; p += sizeof ( short ) ; nbtohs ( ) ; length = netval ; p += sizeof ( short ) ; msglength -= 12 ; sprintf ( get_line ( 0 , 0 ) , "  Auth block: timestamp = %s" , msgbuf ) ; sprintf ( get_line ( 0 , 0 ) , "              block desc = 0x%04x, length = %u" , bsd , length ) ; if ( length > msglength ) { sprintf ( get_line ( 0 , 0 ) , "  [Framing error: remaining pkt length = %u]" , msglength ) ; return ( - 1 ) ; } p += length ; msglength -= length ; return ( 0 ) ; } 