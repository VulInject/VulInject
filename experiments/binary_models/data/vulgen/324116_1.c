static void print_attr ( kdbe_val_t * val , int vverbose ) { switch ( val -> av_type ) { case AT_ATTRFLAGS : printf ( _ ( "\t\tAttribute flags\n" ) ) ; if ( vverbose ) { print_flags ( val -> kdbe_val_t_u . av_attrflags ) ; } break ; case AT_MAX_LIFE : printf ( _ ( "\t\tMaximum ticket life\n" ) ) ; if ( vverbose ) { print_deltat ( & val -> kdbe_val_t_u . av_max_life ) ; } break ; case AT_MAX_RENEW_LIFE : printf ( _ ( "\t\tMaximum renewable life\n" ) ) ; if ( vverbose ) { print_deltat ( & val -> kdbe_val_t_u . av_max_renew_life ) ; } break ; case AT_EXP : printf ( _ ( "\t\tPrincipal expiration\n" ) ) ; if ( vverbose ) { print_time ( & val -> kdbe_val_t_u . av_exp ) ; } break ; case AT_PW_EXP : printf ( _ ( "\t\tPassword expiration\n" ) ) ; if ( vverbose ) { print_time ( & val -> kdbe_val_t_u . av_pw_exp ) ; } break ; case AT_LAST_SUCCESS : printf ( _ ( "\t\tLast successful auth\n" ) ) ; if ( vverbose ) { print_time ( & val -> kdbe_val_t_u . av_last_success ) ; } break ; case AT_LAST_FAILED : printf ( _ ( "\t\tLast failed auth\n" ) ) ; if ( vverbose ) { print_time ( & val -> kdbe_val_t_u . av_last_failed ) ; } break ; case AT_FAIL_AUTH_COUNT : printf ( _ ( "\t\tFailed passwd attempt\n" ) ) ; if ( vverbose ) { printf ( "\t\t\t%d\n" , val -> kdbe_val_t_u . av_fail_auth_count ) ; } break ; case AT_PRINC : printf ( _ ( "\t\tPrincipal\n" ) ) ; if ( vverbose ) { print_princ ( & val -> kdbe_val_t_u . av_princ ) ; } break ; case AT_KEYDATA : printf ( _ ( "\t\tKey data\n" ) ) ; if ( vverbose ) { print_keydata ( val -> kdbe_val_t_u . av_keydata . av_keydata_val , val -> kdbe_val_t_u . av_keydata . av_keydata_len ) ; } break ; case AT_TL_DATA : printf ( _ ( "\t\tTL data\n" ) ) ; if ( vverbose ) { print_tldata ( val -> kdbe_val_t_u . av_tldata . av_tldata_val , val -> kdbe_val_t_u . av_tldata . av_tldata_len ) ; } break ; case AT_LEN : printf ( _ ( "\t\tLength\n" ) ) ; if ( vverbose ) { printf ( "\t\t\t%d\n" , val -> kdbe_val_t_u . av_len ) ; } break ; case AT_PW_LAST_CHANGE : printf ( _ ( "\t\tPassword last changed\n" ) ) ; if ( vverbose ) { print_time ( & val -> kdbe_val_t_u . av_pw_last_change ) ; } break ; case AT_MOD_PRINC : printf ( _ ( "\t\tModifying principal\n" ) ) ; if ( vverbose ) { print_princ ( & val -> kdbe_val_t_u . av_mod_princ ) ; } break ; case AT_MOD_TIME : printf ( _ ( "\t\tModification time\n" ) ) ; if ( vverbose ) { print_time ( & val -> kdbe_val_t_u . av_mod_time ) ; } break ; case AT_MOD_WHERE : printf ( _ ( "\t\tModified where\n" ) ) ; if ( vverbose ) { print_str ( "where" , & val -> kdbe_val_t_u . av_mod_where ) ; } break ; case AT_PW_POLICY : printf ( _ ( "\t\tPassword policy\n" ) ) ; if ( vverbose ) { print_str ( "policy" , & val -> kdbe_val_t_u . av_pw_policy ) ; } break ; case AT_PW_POLICY_SWITCH : printf ( _ ( "\t\tPassword policy switch\n" ) ) ; if ( vverbose ) { printf ( "\t\t\t%d\n" , val -> kdbe_val_t_u . av_pw_policy_switch ) ; } break ; case AT_PW_HIST_KVNO : printf ( _ ( "\t\tPassword history KVNO\n" ) ) ; if ( vverbose ) { printf ( "\t\t\t%d\n" , val -> kdbe_val_t_u . av_pw_hist_kvno ) ; } break ; case AT_PW_HIST : printf ( _ ( "\t\tPassword history\n" ) ) ; break ; } } 