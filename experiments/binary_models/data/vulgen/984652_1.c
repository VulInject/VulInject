static void KCD_HScroll ( KernClassDlg * kcd , struct sbevent * sb ) { int newpos = kcd -> offleft ; GRect rect ; switch ( sb -> type ) { case et_sb_top : newpos = 0 ; break ; case et_sb_uppage : if ( kcd -> width / kcd -> kernw == 1 ) { -- newpos ; } else { newpos -= kcd -> width / kcd -> kernw - 1 ; } break ; case et_sb_up : -- newpos ; break ; case et_sb_down : ++ newpos ; break ; case et_sb_downpage : if ( kcd -> width / kcd -> kernw == 1 ) { ++ newpos ; } else { newpos += kcd -> width / kcd -> kernw - 1 ; } break ; case et_sb_bottom : newpos = kcd -> second_cnt - ( kcd -> width / kcd -> kernw ) ; break ; case et_sb_thumb : case et_sb_thumbrelease : newpos = sb -> pos ; break ; case et_sb_halfup : case et_sb_halfdown : break ; } if ( newpos + ( kcd -> width / kcd -> kernw ) >= kcd -> second_cnt ) { newpos = kcd -> second_cnt - ( kcd -> width / kcd -> kernw ) ; } if ( newpos < 0 ) { newpos = 0 ; } if ( newpos != kcd -> offleft ) { int diff = newpos - kcd -> offleft ; kcd -> offleft = newpos ; GScrollBarSetPos ( kcd -> hsb , newpos ) ; rect . x = kcd -> xstart2 + 1 ; rect . y = kcd -> ystart ; rect . width = kcd -> width - 1 ; rect . height = kcd -> height + ( kcd -> ystart2 - kcd -> ystart ) ; } } 