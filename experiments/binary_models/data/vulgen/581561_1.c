static void ftl_erase_callback ( struct erase_info * erase ) { partition_t * part ; struct xfer_info_t * xfer ; int i ; part = ( partition_t * ) ( erase -> priv ) ; for ( i = 0 ; i < part -> header . NumTransferUnits ; i ++ ) { if ( part -> XferInfo [ i ] . Offset == erase -> addr ) { break ; } } if ( i == part -> header . NumTransferUnits ) { printk ( KERN_NOTICE "ftl_cs: internal error: " "erase lookup failed!\n" ) ; return ; } xfer = & part -> XferInfo [ i ] ; if ( erase -> state == MTD_ERASE_DONE ) { xfer -> state = XFER_ERASED ; } else { xfer -> state = XFER_FAILED ; printk ( KERN_NOTICE "ftl_cs: erase failed: state = %d\n" , erase -> state ) ; } } 