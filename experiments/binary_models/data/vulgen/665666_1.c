static void * k3_r5f_da_to_va ( struct udevice * dev , ulong da , ulong size ) { struct k3_r5f_core * core = dev_get_priv ( dev ) ; void __iomem * va = NULL ; phys_addr_t bus_addr ; u32 dev_addr , offset ; ulong mem_size ; int i ; dev_dbg ( dev , "%s\n" , __func__ ) ; for ( i = 0 ; i < core -> num_mems ; i ++ ) { bus_addr = core -> mem [ i ] . bus_addr ; dev_addr = core -> mem [ i ] . dev_addr ; mem_size = core -> mem [ i ] . size ; if ( da >= bus_addr && ( da + size ) <= ( bus_addr + mem_size ) ) { offset = da - bus_addr ; va = core -> mem [ i ] . cpu_addr + offset ; return ( __force void * ) va ; } if ( da >= dev_addr && ( da + size ) <= ( dev_addr + mem_size ) ) { offset = da - dev_addr ; va = core -> mem [ i ] . cpu_addr + offset ; return ( __force void * ) va ; } } return map_physmem ( da , size , MAP_NOCACHE ) ; } 