MOD_INIT ( ) { CmodeInfo req ; req . paracount = 0 ; req . letter = 'K' ; req . is_ok = noknock_mode_allow ; CmodeAdd ( modinfo -> handle , req , & EXTCMODE_NOKNOCK ) ; HookAdd ( modinfo -> handle , HOOKTYPE_PRE_KNOCK , 0 , noknock_check_knock ) ; HookAdd ( modinfo -> handle , HOOKTYPE_MODECHAR_DEL , 0 , noknock_mode_del ) ; MARK_AS_OFFICIAL_MODULE ( modinfo ) ; return MOD_SUCCESS ; } 