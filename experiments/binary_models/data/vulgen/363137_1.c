void detach_server_conf ( struct Client * client_p ) { struct server_conf * server_p = client_p -> localClient -> att_sconf ; if ( server_p == NULL ) { return ; } client_p -> localClient -> att_sconf = NULL ; server_p -> servers -- ; CurrUsers ( server_p -> class ) -- ; if ( ServerConfIllegal ( server_p ) && ! server_p -> servers ) { rb_dlinkDelete ( & server_p -> node , & server_conf_list ) ; free_server_conf ( server_p ) ; } } 