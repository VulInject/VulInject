void dcc_list_print_file ( FILE_DCC_REC * dcc ) { time_t going , eta ; char * transfd_str , * size_str , etastr [ 20 ] ; uoff_t bps ; going = time ( NULL ) - dcc -> starttime ; transfd_str = dcc_get_size_str ( dcc -> transfd ) ; size_str = dcc_get_size_str ( dcc -> size ) ; bps = ( dcc -> transfd - dcc -> skipped ) / going ; if ( bps == 0 ) { strcpy ( etastr , "(stalled)" ) ; } else { eta = ( dcc -> size - dcc -> transfd ) / bps ; g_snprintf ( etastr , sizeof ( etastr ) , "%02d:%02d:%02d" , ( int ) ( eta / 3600 ) , ( int ) ( ( eta / 60 ) % 60 ) , ( int ) ( eta % 60 ) ) ; } printformat ( NULL , NULL , MSGLEVEL_DCC , IRCTXT_DCC_LIST_LINE_FILE , dcc -> nick , dcc_type2str ( dcc -> type ) , transfd_str , size_str , dcc -> size == 0 ?0 : ( int ) ( ( double ) dcc -> transfd / ( double ) dcc -> size * 100.0 ) , ( double ) bps / 1024.0 , dcc -> arg , etastr ) ; g_free ( transfd_str ) ; g_free ( size_str ) ; } 