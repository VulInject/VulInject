{ BAM_DMUX_CMD_DATA , BAM_DMUX_CMD_OPEN , BAM_DMUX_CMD_CLOSE } { BAM_DMUX_CH_DATA_0 , BAM_DMUX_CH_DATA_1 , BAM_DMUX_CH_DATA_2 , BAM_DMUX_CH_DATA_3 , BAM_DMUX_CH_DATA_4 , BAM_DMUX_CH_DATA_5 , BAM_DMUX_CH_DATA_6 , BAM_DMUX_CH_DATA_7 , BAM_DMUX_NUM_CH } bam_dmux_hdr { u16 magic ; u8 signal ; u8 cmd ; u8 pad ; u8 ch ; u16 len ; } bam_dmux_skb_dma { struct bam_dmux * dmux ; struct sk_buff * skb ; dma_addr_t addr ; } bam_dmux { struct device * dev ; int pc_irq ; bool pc_state , pc_ack_state ; struct qcom_smem_state * pc , * pc_ack ; u32 pc_mask , pc_ack_mask ; wait_queue_head_t pc_wait ; struct completion pc_ack_completion ; struct dma_chan * rx , * tx ; struct bam_dmux_skb_dma rx_skbs [ BAM_DMUX_NUM_SKB ] ; struct bam_dmux_skb_dma tx_skbs [ BAM_DMUX_NUM_SKB ] ; spinlock_t tx_lock ; unsigned int tx_next_skb ; atomic_long_t tx_deferred_skb ; struct work_struct tx_wakeup_work ; DECLARE_BITMAP ( , ) int register_netdev_work ; struct net_device * netdevs [ BAM_DMUX_NUM_CH ] ; } 