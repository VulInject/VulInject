static tap_packet_status protocolinfo_packet ( void * prs , packet_info * pinfo , epan_dissect_t * edt , const void * dummy _U_ , tap_flags_t flags _U_ ) { pci_t * rs = ( pci_t * ) prs ; GPtrArray * gp ; guint i ; char * str ; if ( ! col_get_writable ( pinfo -> cinfo , COL_INFO ) ) { cmdarg_err ( "the proto,colinfo tap doesn't work if the INFO column isn't being printed." ) ; exit ( 1 ) ; } gp = proto_get_finfo_ptr_array ( edt -> tree , rs -> hf_index ) ; if ( ! gp ) { return TAP_PACKET_DONT_REDRAW ; } for ( i = 0 ; i < gp -> len ; i ++ ) { str = ( char * ) proto_construct_match_selected_string ( ( field_info * ) gp -> pdata [ i ] , NULL ) ; if ( str ) { col_append_fstr ( pinfo -> cinfo , COL_INFO , "  %s" , str ) ; } } return TAP_PACKET_DONT_REDRAW ; } 