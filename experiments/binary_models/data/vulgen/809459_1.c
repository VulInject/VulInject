R_API RAnalClassErr r_anal_class_base_get ( RAnal * anal , const char * class_name , const char * base_id , RAnalBaseClass * base ) { char * content = r_anal_class_get_attr ( anal , class_name , R_ANAL_CLASS_ATTR_TYPE_BASE , base_id , false ) ; if ( ! content ) { return R_ANAL_CLASS_ERR_NONEXISTENT_ATTR ; } char * cur = content ; char * next ; sdb_anext ( cur , & next ) ; base -> class_name = strdup ( cur ) ; if ( ! base -> class_name ) { return R_ANAL_CLASS_ERR_OTHER ; } cur = next ; if ( ! cur ) { free ( content ) ; free ( base -> class_name ) ; return R_ANAL_CLASS_ERR_OTHER ; } sdb_anext ( cur , NULL ) ; base -> offset = r_num_math ( NULL , cur ) ; free ( content ) ; base -> id = r_str_sanitize_sdb_key ( base_id ) ; if ( ! base -> id ) { free ( base -> class_name ) ; return R_ANAL_CLASS_ERR_OTHER ; } return R_ANAL_CLASS_ERR_SUCCESS ; } 