static void drm_parse_hdmi_deep_color_info ( struct drm_connector * connector , const u8 * hdmi ) { struct drm_display_info * info = & connector -> display_info ; unsigned int dc_bpc ; info -> bpc = 8 ; if ( cea_db_payload_len ( hdmi ) < 6 ) { return ; } if ( hdmi [ 6 ] & DRM_EDID_HDMI_DC_30 ) { dc_bpc = 10 ; info -> edid_hdmi_dc_modes |= DRM_EDID_HDMI_DC_30 ; DRM_DEBUG ( "%s: HDMI sink does deep color 30.\n" , connector -> name ) ; } if ( hdmi [ 6 ] & DRM_EDID_HDMI_DC_36 ) { dc_bpc = 12 ; info -> edid_hdmi_dc_modes |= DRM_EDID_HDMI_DC_36 ; DRM_DEBUG ( "%s: HDMI sink does deep color 36.\n" , connector -> name ) ; } if ( hdmi [ 6 ] & DRM_EDID_HDMI_DC_48 ) { dc_bpc = 16 ; info -> edid_hdmi_dc_modes |= DRM_EDID_HDMI_DC_48 ; DRM_DEBUG ( "%s: HDMI sink does deep color 48.\n" , connector -> name ) ; } if ( dc_bpc == 0 ) { DRM_DEBUG ( "%s: No deep color support on this HDMI sink.\n" , connector -> name ) ; return ; } DRM_DEBUG ( "%s: Assigning HDMI sink color depth as %d bpc.\n" , connector -> name , dc_bpc ) ; info -> bpc = dc_bpc ; info -> color_formats = DRM_COLOR_FORMAT_RGB444 ; if ( hdmi [ 6 ] & DRM_EDID_HDMI_DC_Y444 ) { info -> color_formats |= DRM_COLOR_FORMAT_YCRCB444 ; DRM_DEBUG ( "%s: HDMI sink does YCRCB444 in deep color.\n" , connector -> name ) ; } if ( ! ( hdmi [ 6 ] & DRM_EDID_HDMI_DC_36 ) ) { DRM_DEBUG ( "%s: HDMI sink should do DC_36, but does not!\n" , connector -> name ) ; } } 