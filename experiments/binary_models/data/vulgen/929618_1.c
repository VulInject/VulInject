int exphy_service ( struct mii_softc * sc , struct mii_data * mii , int cmd ) { struct ifmedia_entry * ife = mii -> mii_media . ifm_cur ; if ( ( sc -> mii_dev . dv_flags & DVF_ACTIVE ) == 0 ) { return ( ENXIO ) ; } if ( IFM_INST ( ife -> ifm_media ) != sc -> mii_inst ) { panic ( "exphy_service: can't isolate 3Com PHY" ) ; } switch ( cmd ) { case MII_POLLSTAT : break ; case MII_MEDIACHG : if ( ( mii -> mii_ifp -> if_flags & IFF_UP ) == 0 ) { break ; } mii_phy_setmedia ( sc ) ; break ; case MII_TICK : if ( mii_phy_tick ( sc ) == EJUSTRETURN ) { return ( 0 ) ; } break ; case MII_DOWN : return ( 0 ) ; } mii_phy_status ( sc ) ; mii_phy_update ( sc , cmd ) ; return ( 0 ) ; } 