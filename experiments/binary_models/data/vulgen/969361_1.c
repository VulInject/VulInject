static void tx_tasklet ( struct tasklet_struct * t ) { struct b43legacy_pioqueue * queue = from_tasklet ( queue , t , txtask ) ; struct b43legacy_wldev * dev = queue -> dev ; unsigned long flags ; struct b43legacy_pio_txpacket * packet , * tmp_packet ; int err ; u16 txctl ; spin_lock_irqsave ( & dev -> wl -> irq_lock , flags ) ; if ( queue -> tx_frozen ) { out_unlock } txctl = b43legacy_pio_read ( queue , B43legacy_PIO_TXCTL ) ; list_for_each_entry_safe ( , , , ) { err = pio_tx_packet ( packet ) ; if ( err ) { break ; } } out_unlock spin_unlock_irqrestore ( & dev -> wl -> irq_lock , flags ) ; } 