static void i2c_w ( struct gspca_dev * gspca_dev , u8 i2c_addr , const u8 * data , int len ) { u8 val [ 2 ] ; int i ; reg_w ( gspca_dev , 0x0600 , data + 1 , len - 1 ) ; reg_w ( gspca_dev , 0x0600 , data , len ) ; val [ 0 ] = len ; val [ 1 ] = i2c_addr ; reg_w ( gspca_dev , 0x0502 , val , 2 ) ; val [ 0 ] = 0x01 ; for ( i = 5 ; -- i >= 0 ; ) { msleep ( 4 ) ; reg_r ( gspca_dev , 0x0505 , 1 ) ; if ( gspca_dev -> usb_err < 0 ) { return ; } if ( gspca_dev -> usb_buf [ 0 ] == 0 ) { return ; } } gspca_dev -> usb_err = - ETIME ; } 