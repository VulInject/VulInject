static void qed_cmdq_lines_rt_init ( struct qed_hwfn * p_hwfn , u8 max_ports_per_engine , u8 max_phys_tcs_per_port , struct init_qm_port_params port_params [ MAX_NUM_PORTS ] ) { u8 tc , voq , port_id , num_tcs_in_port ; for ( voq = 0 ; voq < MAX_NUM_VOQS ; voq ++ ) { STORE_RT_REG ( p_hwfn , PBF_CMDQ_LINES_RT_OFFSET ( voq ) , 0 ) ; } for ( port_id = 0 ; port_id < max_ports_per_engine ; port_id ++ ) { if ( port_params [ port_id ] . active ) { u16 phys_lines , phys_lines_per_tc ; phys_lines = port_params [ port_id ] . num_pbf_cmd_lines - PBF_CMDQ_PURE_LB_LINES ; num_tcs_in_port = 0 ; for ( tc = 0 ; tc < NUM_OF_PHYS_TCS ; tc ++ ) { if ( ( ( port_params [ port_id ] . active_phys_tcs >> tc ) & 0x1 ) == 1 ) { num_tcs_in_port ++ ; } } phys_lines_per_tc = phys_lines / num_tcs_in_port ; for ( tc = 0 ; tc < NUM_OF_PHYS_TCS ; tc ++ ) { if ( ( ( port_params [ port_id ] . active_phys_tcs >> tc ) & 0x1 ) != 1 ) { continue ; } voq = PHYS_VOQ ( port_id , tc , max_phys_tcs_per_port ) ; qed_cmdq_lines_voq_rt_init ( p_hwfn , voq , phys_lines_per_tc ) ; } } } } 