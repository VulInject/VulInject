static enum ofperr parse_intel_port_custom_property ( struct ofpbuf * payload , struct ofputil_port_stats * ops ) { const struct intel_port_custom_stats * custom_stats = ofpbuf_try_pull ( payload , sizeof custom_stats ) ; if ( ! custom_stats ) { return OFPERR_OFPBPC_BAD_LEN ; } ops -> custom_stats . size = ntohs ( custom_stats -> stats_array_size ) ; netdev_free_custom_stats_counters ( & ops -> custom_stats ) ; ops -> custom_stats . counters = xcalloc ( ops -> custom_stats . size , sizeof ops -> custom_stats . counters ) ; for ( int i = 0 ; i < ops -> custom_stats . size ; i ++ ) { struct netdev_custom_counter * c = & ops -> custom_stats . counters [ i ] ; uint8_t * name_len = ofpbuf_try_pull ( payload , sizeof name_len ) ; char * name = name_len ?ofpbuf_try_pull ( payload , * name_len ) : NULL ; if ( ! name_len || ! name ) { netdev_free_custom_stats_counters ( & ops -> custom_stats ) ; return OFPERR_OFPBPC_BAD_LEN ; } size_t len = MIN ( * name_len , sizeof c -> name - 1 ) ; memcpy ( c -> name , name , len ) ; c -> name [ len ] = '\0' ; ovs_be64 * value = ofpbuf_try_pull ( payload , sizeof value ) ; c -> value = ntohll ( get_unaligned_be64 ( value ) ) ; } return 0 ; } 