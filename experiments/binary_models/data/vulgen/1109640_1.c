static void cls_uart_init ( struct jsm_channel * ch ) { unsigned char lcrb = readb ( & ch -> ch_cls_uart -> lcr ) ; unsigned char isr_fcr = 0 ; writeb ( 0 , & ch -> ch_cls_uart -> ier ) ; writeb ( UART_EXAR654_ENHANCED_REGISTER_SET , & ch -> ch_cls_uart -> lcr ) ; isr_fcr = readb ( & ch -> ch_cls_uart -> isr_fcr ) ; isr_fcr |= ( UART_EXAR654_EFR_ECB ) ; writeb ( isr_fcr , & ch -> ch_cls_uart -> isr_fcr ) ; writeb ( lcrb , & ch -> ch_cls_uart -> lcr ) ; writeb ( ( UART_FCR_ENABLE_FIFO | UART_FCR_CLEAR_RCVR | UART_FCR_CLEAR_XMIT ) , & ch -> ch_cls_uart -> isr_fcr ) ; udelay ( 10 ) ; ch -> ch_flags |= ( CH_FIFO_ENABLED | CH_TX_FIFO_EMPTY | CH_TX_FIFO_LWM ) ; readb ( & ch -> ch_cls_uart -> lsr ) ; readb ( & ch -> ch_cls_uart -> msr ) ; } 