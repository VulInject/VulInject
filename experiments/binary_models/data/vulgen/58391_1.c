void do_trap0 ( struct pt_regs * regs ) { syscall_fn syscall ; switch ( pt_cause ( regs ) ) { case TRAP_SYSCALL : __vmsetie ( VM_INT_ENABLE ) ; regs -> syscall_nr = regs -> r06 ; regs -> restart_r0 = regs -> r00 ; if ( ( unsigned long ) regs -> syscall_nr >= __NR_syscalls ) { regs -> r00 = - 1 ; } else { syscall = ( syscall_fn ) ( sys_call_table [ regs -> syscall_nr ] ) ; regs -> r00 = syscall ( regs -> r00 , regs -> r01 , regs -> r02 , regs -> r03 , regs -> r04 , regs -> r05 ) ; } if ( unlikely ( test_thread_flag ( TIF_SYSCALL_TRACE ) ) ) { ptrace_report_syscall_exit ( regs , 0 ) ; } break ; case TRAP_DEBUG : if ( user_mode ( regs ) ) { force_sig_fault ( SIGTRAP , TRAP_BRKPT , ( void __user * ) pt_elr ( regs ) ) ; } else { kgdb_handle_exception ( pt_cause ( regs ) , SIGTRAP , TRAP_BRKPT , regs ) ; } break ; } } 