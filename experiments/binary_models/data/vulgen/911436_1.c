static void adi_spi_restore_state ( struct adi_spi_master * drv_data ) { struct adi_spi_device * chip = drv_data -> cur_chip ; iowrite32 ( 0xFFFFFFFF , & drv_data -> regs -> status ) ; iowrite32 ( 0x0 , & drv_data -> regs -> rx_control ) ; iowrite32 ( 0x0 , & drv_data -> regs -> tx_control ) ; adi_spi_disable ( drv_data ) ; iowrite32 ( chip -> control , & drv_data -> regs -> control ) ; adi_spi_enable ( drv_data ) ; drv_data -> tx_num = drv_data -> rx_num = 0 ; iowrite32 ( SPI_RXCTL_REN , & drv_data -> regs -> rx_control ) ; iowrite32 ( SPI_TXCTL_TEN | SPI_TXCTL_TTI , & drv_data -> regs -> tx_control ) ; adi_spi_cs_active ( drv_data , chip ) ; } 