void freehostent ( struct hostent * he ) { char * * cpp ; int names = 1 ; int addresses = 1 ; memput ( he -> h_name , strlen ( he -> h_name ) + 1 ) ; cpp = he -> h_addr_list ; while ( * cpp != NULL ) { memput ( * cpp , ( he -> h_addrtype == AF_INET ) ?INADDRSZ : IN6ADDRSZ ) ; * cpp = NULL ; cpp ++ ; addresses ++ ; } cpp = he -> h_aliases ; while ( * cpp != NULL ) { memput ( * cpp , strlen ( * cpp ) + 1 ) ; cpp ++ ; names ++ ; } memput ( he -> h_aliases , sizeof ( char * ) * ( names ) ) ; memput ( he -> h_addr_list , sizeof ( char * ) * ( addresses ) ) ; } 