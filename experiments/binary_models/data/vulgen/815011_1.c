void urndis_start ( struct ifnet * ifp ) { struct urndis_softc * sc ; struct mbuf * m_head = NULL ; sc = ifp -> if_softc ; if ( usbd_is_dying ( sc -> sc_udev ) || ifq_is_oactive ( & ifp -> if_snd ) ) { return ; } m_head = ifq_dequeue ( & ifp -> if_snd ) ; if ( m_head == NULL ) { return ; } if ( urndis_encap ( sc , m_head , 0 ) ) { ifq_set_oactive ( & ifp -> if_snd ) ; return ; } if ( ifp -> if_bpf ) { bpf_mtap ( ifp -> if_bpf , m_head , BPF_DIRECTION_OUT ) ; } ifq_set_oactive ( & ifp -> if_snd ) ; ifp -> if_timer = 5 ; return ; } 