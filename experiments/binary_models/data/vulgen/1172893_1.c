v850_insert_attributes ( , ) tree decl ; tree * attr_ptr ATTRIBUTE_UNUSED ; { if ( data_area_stack && data_area_stack -> data_area && current_function_decl == NULL_TREE && ( TREE_CODE ( decl ) == VAR_DECL || TREE_CODE ( decl ) == CONST_DECL ) && v850_get_data_area ( decl ) == DATA_AREA_NORMAL ) { DECL_SECTION_NAME ( 0 ) ; } if ( GHS_default_section_names [ ( int ) GHS_SECTION_KIND_SDATA ] == NULL ) { GHS_default_section_names [ ( int ) GHS_SECTION_KIND_SDATA ] = build_string ( sizeof ( ".sdata" ) - 1 , ".sdata" ) ; GHS_default_section_names [ ( int ) GHS_SECTION_KIND_ROSDATA ] = build_string ( sizeof ( ".rosdata" ) - 1 , ".rosdata" ) ; GHS_default_section_names [ ( int ) GHS_SECTION_KIND_TDATA ] = build_string ( sizeof ( ".tdata" ) - 1 , ".tdata" ) ; GHS_default_section_names [ ( int ) GHS_SECTION_KIND_ZDATA ] = build_string ( sizeof ( ".zdata" ) - 1 , ".zdata" ) ; GHS_default_section_names [ ( int ) GHS_SECTION_KIND_ROZDATA ] = build_string ( sizeof ( ".rozdata" ) - 1 , ".rozdata" ) ; } if ( current_function_decl == NULL_TREE && ( TREE_CODE ( decl ) == VAR_DECL || TREE_CODE ( decl ) == CONST_DECL || TREE_CODE ( decl ) == FUNCTION_DECL ) && ( ! DECL_EXTERNAL ( decl ) || DECL_INITIAL ( decl ) ) && ! DECL_SECTION_NAME ( decl ) ) { enum GHS_section_kind kind = GHS_SECTION_KIND_DEFAULT ; tree chosen_section ; if ( TREE_CODE ( decl ) == FUNCTION_DECL ) { kind = GHS_SECTION_KIND_TEXT ; } else { switch ( v850_get_data_area ( decl ) ) { default : abort ( ) ; case DATA_AREA_SDA : kind = ( ( TREE_READONLY ( decl ) ) ?GHS_SECTION_KIND_ROSDATA : GHS_SECTION_KIND_SDATA ) ; break ; case DATA_AREA_TDA : kind = GHS_SECTION_KIND_TDATA ; break ; case DATA_AREA_ZDA : kind = ( ( TREE_READONLY ( decl ) ) ?GHS_SECTION_KIND_ROZDATA : GHS_SECTION_KIND_ZDATA ) ; break ; case DATA_AREA_NORMAL : if ( TREE_READONLY ( decl ) ) { kind = GHS_SECTION_KIND_RODATA ; } if ( DECL_INITIAL ( decl ) ) { kind = GHS_SECTION_KIND_DATA ; } else { kind = GHS_SECTION_KIND_BSS ; } } } chosen_section = GHS_current_section_names [ ( int ) kind ] ; if ( chosen_section == NULL ) { chosen_section = GHS_default_section_names [ ( int ) kind ] ; } if ( chosen_section ) { DECL_SECTION_NAME ( decl ) = chosen_section ; } } } 