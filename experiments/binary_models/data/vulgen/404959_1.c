void nouveau_fence_context_del ( struct nouveau_fence_chan * fctx ) { struct nouveau_fence * fence ; spin_lock_irq ( & fctx -> lock ) ; while ( ! list_empty ( & fctx -> pending ) ) { fence = list_entry ( fctx -> pending . next , typeof ( * fence ) , head ) ; if ( nouveau_fence_signal ( fence ) ) { nvif_notify_put ( & fctx -> notify ) ; } } spin_unlock_irq ( & fctx -> lock ) ; nvif_notify_fini ( & fctx -> notify ) ; synchronize_rcu ( ) ; } 