md_apply_fix3 ( , , ) fixS * fixP ; valueT * valP ; segT seg ATTRIBUTE_UNUSED ; { long val = * ( long * ) valP ; char * buf = fixP -> fx_where + fixP -> fx_frag -> fr_literal ; if ( fixP -> fx_r_type == 0 ) { fixP -> fx_r_type = fixP -> fx_size == 4 ?R_H8500_IMM32 : R_H8500_IMM16 ; } switch ( fixP -> fx_r_type ) { case R_H8500_IMM8 : case R_H8500_PCREL8 : * buf ++ = val ; break ; case R_H8500_IMM16 : case R_H8500_LOW16 : case R_H8500_PCREL16 : * buf ++ = ( val >> 8 ) ; * buf ++ = val ; break ; case R_H8500_HIGH8 : * buf ++ = val >> 16 ; break ; case R_H8500_HIGH16 : * buf ++ = val >> 24 ; * buf ++ = val >> 16 ; break ; case R_H8500_IMM24 : * buf ++ = ( val >> 16 ) ; * buf ++ = ( val >> 8 ) ; * buf ++ = val ; break ; case R_H8500_IMM32 : * buf ++ = ( val >> 24 ) ; * buf ++ = ( val >> 16 ) ; * buf ++ = ( val >> 8 ) ; * buf ++ = val ; break ; default : abort ( ) ; } } 