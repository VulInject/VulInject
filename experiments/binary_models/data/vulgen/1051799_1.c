des_setkey ( , ) { static const char * selftest_failed ; int i ; if ( ! fips_mode ( ) && ! initialized ) { initialized = 1 ; selftest_failed = selftest ( ) ; if ( selftest_failed ) { log_error ( "%s\n" , 0 ) ; } } if ( selftest_failed ) { return GPG_ERR_SELFTEST_FAILED ; } des_key_schedule ( key , ctx -> encrypt_subkeys ) ; _gcry_burn_stack ( 32 ) ; for ( i = 0 ; i < 32 ; i += 2 ) { ctx -> decrypt_subkeys [ i ] = ctx -> encrypt_subkeys [ 30 - i ] ; ctx -> decrypt_subkeys [ i + 1 ] = ctx -> encrypt_subkeys [ 31 - i ] ; } return 0 ; } 