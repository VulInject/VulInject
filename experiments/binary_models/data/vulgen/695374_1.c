void nvkm_subdev_del ( struct nvkm_subdev * * psubdev ) { struct nvkm_subdev * subdev = * psubdev ; s64 time ; if ( subdev && ! WARN_ON ( ! subdev -> func ) ) { nvkm_trace ( subdev , "destroy running...\n" ) ; time = ktime_to_us ( ktime_get ( ) ) ; list_del ( & subdev -> head ) ; mutex_destroy ( & subdev -> use . mutex ) ; time = ktime_to_us ( ktime_get ( ) ) - time ; nvkm_trace ( subdev , "destroy completed in %lldus\n" , time ) ; kfree ( * psubdev ) ; * psubdev = NULL ; } } 