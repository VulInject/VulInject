static int iwl_mvm_tzone_get_temp ( struct thermal_zone_device * device , int * temperature ) { struct iwl_mvm * mvm = ( iwl_mvm * ) device -> devdata ; int ret ; int temp ; mutex_lock ( & mvm -> mutex ) ; if ( ! iwl_mvm_firmware_running ( mvm ) || mvm -> fwrt . cur_fw_img != IWL_UCODE_REGULAR ) { out } ret = iwl_mvm_get_temp ( mvm , & temp ) ; if ( ret ) { out } * temperature = temp * 1000 ; out mutex_unlock ( & mvm -> mutex ) ; return ret ; } 