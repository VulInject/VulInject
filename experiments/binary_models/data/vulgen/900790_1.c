static int dissect_ansi_tcap_T_national ( gboolean implicit_tag _U_ , tvbuff_t * tvb _U_ , int offset _U_ , asn1_ctx_t * actx _U_ , proto_tree * tree _U_ , int hf_index _U_ ) { proto_tree * subtree ; proto_item * spcifier_item ; int start_offset = offset ; guint8 family ; guint8 specifier ; offset = dissect_ber_integer ( implicit_tag , actx , tree , tvb , offset , hf_index , & ansi_tcap_private . d . OperationCode_national ) ; ansi_tcap_private . d . OperationCode_national = ( ansi_tcap_private . d . OperationCode_national & 0x7fff ) ; subtree = proto_item_add_subtree ( actx -> created_item , ett_ansi_tcap_op_code_nat ) ; family = ( ansi_tcap_private . d . OperationCode_national & 0x7f00 ) >> 8 ; specifier = ( guint8 ) ( ansi_tcap_private . d . OperationCode_national & 0xff ) ; proto_tree_add_item ( subtree , hf_ansi_tcap_bit_h , tvb , start_offset , 2 , ENC_BIG_ENDIAN ) ; proto_tree_add_item ( subtree , hf_ansi_tcap_op_family , tvb , start_offset , 2 , ENC_BIG_ENDIAN ) ; spcifier_item = proto_tree_add_item ( subtree , hf_ansi_tcap_op_specifier , tvb , start_offset , 2 , ENC_BIG_ENDIAN ) ; switch ( family ) { case 0 : break ; case 1 : if ( specifier == 1 ) { proto_item_append_text ( spcifier_item , " Provide Value" ) ; } if ( specifier == 2 ) { proto_item_append_text ( spcifier_item , " Set Value" ) ; } break ; case 2 : break ; case 3 : if ( specifier == 1 ) { proto_item_append_text ( spcifier_item , " Start" ) ; } if ( specifier == 2 ) { proto_item_append_text ( spcifier_item , " Assist" ) ; } break ; case 4 : if ( specifier == 1 ) { proto_item_append_text ( spcifier_item , " Connect" ) ; } if ( specifier == 2 ) { proto_item_append_text ( spcifier_item , " Temporary Connect" ) ; } if ( specifier == 3 ) { proto_item_append_text ( spcifier_item , " Disconnect" ) ; } if ( specifier == 4 ) { proto_item_append_text ( spcifier_item , " Forward Disconnect" ) ; } break ; default : break ; } return offset ; } 