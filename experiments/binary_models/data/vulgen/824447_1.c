List ListDeleteLevel ( L , leve ) List L ; int leve ; { List t ; ListCondPrint ( "ListDeleteLevel" ) ; if ( L == NULL ) { return ( NULL ) ; } if ( L -> level == leve ) { t = L -> rptr ; return ( ListDeleteLevel ( t , leve ) ) ; } else { return ( L ) ; } } Np ListFindNodeByLexeme ( L , lexem ) List L ; char * lexem ; { Np foundp ; ListCondPrint ( "ListFindNodeByLexeme" ) ; if ( L == NULL ) { return ( NULL ) ; } if ( lexem == NULL ) { ListErr ( 3 ) ; } if ( strcmp ( L -> lexeme , lexem ) == 0 ) { return ( L ) ; } else { foundp = ListFindNodeByLexeme ( L -> rptr , lexem ) ; } return ( foundp ) ; } Np ListFindFunProtoByLexemeInProg ( L , lexem ) List L ; char * lexem ; { Np foundp ; ListCondPrint ( "ListFindFunProtoByLexemeInProg" ) ; if ( L == NULL ) { return ( NULL ) ; } if ( lexem == NULL ) { ListErr ( 3 ) ; } while ( L != NULL ) { if ( ( strcmp ( L -> lexeme , "main" ) == 0 ) ) { break ; } L = L -> rptr ; } if ( L == NULL ) { ListErr ( 7 ) ; } foundp = ListFindNodeByLexeme ( L , lexem ) ; return ( foundp ) ; } Np ListFindNodeByLexemeInLevel ( L , lexem , leve ) List L ; char * lexem ; int leve ; { Np foundp ; ListCondPrint ( "ListFindNodeByLexemeInLevel" ) ; if ( L == NULL ) { return ( NULL ) ; } if ( lexem == NULL ) { ListErr ( 3 ) ; } if ( strcmp ( L -> lexeme , lexem ) == 0 && NodeGetLevel ( L ) == leve ) { return ( L ) ; } else { foundp = ListFindNodeByLexemeInLevel ( L -> rptr , lexem , leve ) ; return ( foundp ) ; } } Np ListFindNodeByLexemeInLine ( L , lexem , line ) List L ; char * lexem ; int line ; { Np foundp ; ListCondPrint ( "ListFindNodeByLexemeInLine" ) ; if ( L == NULL ) { return ( NULL ) ; } if ( lexem == NULL ) { ListErr ( 3 ) ; } if ( strcmp ( NodeGetLexeme ( L ) , lexem ) == 0 && NodeGetLineDef ( L ) == line ) { return ( L ) ; } else { foundp = ListFindNodeByLexemeInLine ( L -> rptr , lexem , line ) ; return ( foundp ) ; } } Np ListMatchNodeByLexemeInLine ( L , lexem , line ) List L ; char * lexem ; int line ; { Np foundp ; ListCondPrint ( "ListMatchNodeByLexemeInLine" ) ; if ( L == NULL ) { return ( NULL ) ; } if ( lexem == NULL ) { ListErr ( 3 ) ; } if ( strpbrk ( NodeGetLexeme ( L ) , lexem ) != NULL && NodeGetLineDef ( L ) == line ) { return ( L ) ; } else { foundp = ListMatchNodeByLexemeInLine ( L -> rptr , lexem , line ) ; return ( foundp ) ; } } Np ListFindNodeBeforeLexemeInLine ( L , lexem , line ) List L ; char * lexem ; int line ; { Np foundp ; ListCondPrint ( "ListFindNodeBeforeLexemeInLine" ) ; if ( L == NULL ) { return ( NULL ) ; } if ( lexem == NULL ) { ListErr ( 3 ) ; } if ( strcmp ( NodeGetLexeme ( L ) , lexem ) == 0 && NodeGetLineDef ( L ) == line ) { return ( L ) ; } if ( L -> rptr == NULL ) { return ( NULL ) ; } if ( strcmp ( NodeGetLexeme ( L -> rptr ) , lexem ) == 0 && NodeGetLineDef ( L -> rptr ) == line ) { return ( L ) ; } else { foundp = ListFindNodeBeforeLexemeInLine ( L -> rptr , lexem , line ) ; return ( foundp ) ; } } Np ListMatchNodeBeforeLexemeInLine ( L , lexem , line ) List L ; char * lexem ; int line ; { Np foundp ; ListCondPrint ( "ListFindNodeBeforeLexemeInLine" ) ; if ( L == NULL ) { return ( NULL ) ; } if ( lexem == NULL ) { ListErr ( 3 ) ; } if ( ListDF == 1 ) { printf ( "Matching %s with %s and linedef: %d with %d\n" , NodeGetLexeme ( L ) , lexem , NodeGetLineDef ( L ) , line ) ; } if ( strpbrk ( NodeGetLexeme ( L ) , lexem ) != NULL && NodeGetLineDef ( L ) == line ) { return ( L ) ; } if ( L -> rptr == NULL ) { return ( NULL ) ; } if ( ListDF == 1 ) { printf ( "Matching %s with %s and linedef: %d with %d\n" , NodeGetLexeme ( L ) , lexem , NodeGetLineDef ( L ) , line ) ; } if ( strpbrk ( NodeGetLexeme ( L -> rptr ) , lexem ) != NULL && NodeGetLineDef ( L -> rptr ) == line ) { return ( L ) ; } else { foundp = ListMatchNodeBeforeLexemeInLine ( L -> rptr , lexem , line ) ; return ( foundp ) ; } } Np ListFindNodeByLexemeAndTypeInLevel ( L , lexem , leve , type , compare_func ) List L ; char * lexem ; int leve ; int type ; int ( ) compare_func ( ) ; { Np foundp ; ListCondPrint ( "ListFindNodeByLexemeInLevel2" ) ; if ( L == NULL ) { return ( NULL ) ; } if ( lexem == NULL ) { ListErr ( 3 ) ; } if ( ( NodeGetType ( L ) == type ) && ( compare_func ( L -> lexeme , lexem ) == 0 ) && NodeGetLevel ( L ) == leve ) { return ( L ) ; } else { foundp = ListFindNodeByLexemeAndTypeInLevel ( L -> rptr , lexem , leve , type , compare_func ) ; return ( foundp ) ; } } Np ListFindAnyNodeInLevelOfType ( L , leve , type ) List L ; int leve ; int type ; { Np foundp ; ListCondPrint ( "ListFindAnyNodeInLevelOfType" ) ; if ( L == NULL ) { return ( NULL ) ; } if ( NodeGetType ( L ) == type && NodeGetLevel ( L ) == leve ) { return ( L ) ; } else { foundp = ListFindAnyNodeInLevelOfType ( L -> rptr , leve , type ) ; return ( foundp ) ; } } void ListErr ( int e ) { if ( ListFpOut == NULL ) { ListErr ( 7 ) ; } fprintf ( ListFpOut , "ListErr\n" ) ; if ( e >= ListMaxErrors ) { e = 0 ; } fprintf ( ListFpOut , "rs: %s\n" , ListErrors [ e ] ) ; exit ( 1 ) ; } 