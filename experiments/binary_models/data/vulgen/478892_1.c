static u64 read_ht_magic_addr ( struct pci_dev * pdev , unsigned int pos ) { u8 flags ; u32 tmp ; u64 addr ; pci_read_config_byte ( pdev , pos + HT_MSI_FLAGS , & flags ) ; if ( flags & HT_MSI_FLAGS_FIXED ) { return HT_MSI_FIXED_ADDR ; } pci_read_config_dword ( pdev , pos + HT_MSI_ADDR_LO , & tmp ) ; addr = tmp & HT_MSI_ADDR_LO_MASK ; pci_read_config_dword ( pdev , pos + HT_MSI_ADDR_HI , & tmp ) ; return addr ; } 