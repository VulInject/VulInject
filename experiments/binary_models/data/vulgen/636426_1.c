void map_memarea_sections ( const struct tee_mmap_region * mm , uint32_t * ttb ) { uint32_t attr = mattr_to_desc ( 1 , mm -> attr ) ; size_t idx = mm -> va >> SECTION_SHIFT ; paddr_t pa = 0 ; size_t n ; print_mmap_area ( mm , "section map" ) ; attr = mattr_to_desc ( 1 , mm -> attr ) ; if ( attr != INVALID_DESC ) { pa = mm -> pa ; } n = ROUNDUP ( mm -> size , SECTION_SIZE ) >> SECTION_SHIFT ; while ( n -- ) { assert ( ! attr || ! ttb [ idx ] || ttb [ idx ] == ( pa | attr ) ) ; ttb [ idx ] = pa | attr ; idx ++ ; pa += SECTION_SIZE ; } } 