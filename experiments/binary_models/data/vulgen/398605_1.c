static psa_status_t psa_mac_init ( psa_mac_operation_t * operation , psa_algorithm_t alg ) { psa_status_t status = PSA_ERROR_NOT_SUPPORTED ; operation -> alg = alg ; operation -> key_set = 0 ; operation -> iv_set = 0 ; operation -> iv_required = 0 ; operation -> has_input = 0 ; operation -> is_sign = 0 ; if ( alg == PSA_ALG_CMAC ) { operation -> iv_required = 0 ; mbedtls_cipher_init ( & operation -> ctx . cmac ) ; status = PSA_SUCCESS ; } if ( PSA_ALG_IS_HMAC ( operation -> alg ) ) { operation -> ctx . hmac . hash_ctx . alg = 0 ; status = PSA_SUCCESS ; } else { if ( ! PSA_ALG_IS_MAC ( alg ) ) { status = PSA_ERROR_INVALID_ARGUMENT ; } } return ( status ) ; } 