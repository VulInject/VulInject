static void tegra210_mvc_reset_vol_settings ( struct tegra210_mvc * mvc , struct device * dev ) { int i ; if ( mvc -> curve_type == CURVE_POLY ) { for ( i = 0 ; i < TEGRA210_MVC_MAX_CHAN_COUNT ; i ++ ) { mvc -> volume [ i ] = TEGRA210_MVC_INIT_VOL_DEFAULT_POLY ; } } else { for ( i = 0 ; i < TEGRA210_MVC_MAX_CHAN_COUNT ; i ++ ) { mvc -> volume [ i ] = TEGRA210_MVC_INIT_VOL_DEFAULT_LINEAR ; } } pm_runtime_get_sync ( dev ) ; for ( i = 0 ; i < TEGRA210_MVC_MAX_CHAN_COUNT ; i ++ ) { regmap_write ( mvc -> regmap , TEGRA210_MVC_REG_OFFSET ( TEGRA210_MVC_INIT_VOL , i ) , mvc -> volume [ i ] ) ; regmap_write ( mvc -> regmap , TEGRA210_MVC_REG_OFFSET ( TEGRA210_MVC_TARGET_VOL , i ) , mvc -> volume [ i ] ) ; } regmap_update_bits ( mvc -> regmap , TEGRA210_MVC_SWITCH , TEGRA210_MVC_VOLUME_SWITCH_MASK , TEGRA210_MVC_VOLUME_SWITCH_TRIGGER ) ; pm_runtime_put ( dev ) ; } 