static void i2c_pnx_stop ( struct i2c_pnx_algo_data * alg_data ) { long timeout = 1000 ; dev_dbg ( & alg_data -> adapter . dev , "%s(): entering: stat = %04x.\n" , __func__ , ioread32 ( I2C_REG_STS ( alg_data ) ) ) ; iowrite32 ( 0xff | stop_bit , I2C_REG_TX ( alg_data ) ) ; while ( timeout > 0 && ( ioread32 ( I2C_REG_STS ( alg_data ) ) & mstatus_active ) ) { timeout -- ; } dev_dbg ( & alg_data -> adapter . dev , "%s(): exiting: stat = %04x.\n" , __func__ , ioread32 ( I2C_REG_STS ( alg_data ) ) ) ; } 