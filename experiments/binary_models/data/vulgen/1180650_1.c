static uint32_t nxge_get_cl22_phy_id ( p_nxge_t nxgep , int phy_port ) { uint16_t val1 = 0 ; uint16_t val2 = 0 ; uint32_t phy_id = 0 ; npi_status_t npi_status = NPI_SUCCESS ; MUTEX_ENTER ( & nxgep -> nxge_hw_p -> nxge_mdio_lock ) ; npi_status = npi_mac_mif_mii_read ( handle , phy_port , NXGE_PHY_ID_REG_1 , & val1 ) ; if ( npi_status != NPI_SUCCESS ) { NXGE_DEBUG_MSG ( ( nxgep , MAC_CTL , "port[%d] " "clause 22 read to reg 2 failed!!!" ) ) ; exit } npi_status = npi_mac_mif_mii_read ( handle , phy_port , NXGE_PHY_ID_REG_2 , & val2 ) ; if ( npi_status != 0 ) { NXGE_DEBUG_MSG ( ( nxgep , MAC_CTL , "port[%d] " "clause 22 read to reg 3 failed!!!" ) ) ; exit } phy_id = val1 ; phy_id = ( phy_id << 16 ) ; phy_id |= val2 ; exit MUTEX_EXIT ( & nxgep -> nxge_hw_p -> nxge_mdio_lock ) ; NXGE_DEBUG_MSG ( ( nxgep , MAC_CTL , "port[%d] PHY ID [0x%llx]" , phy_port , phy_id ) ) ; return ( phy_id ) ; } 