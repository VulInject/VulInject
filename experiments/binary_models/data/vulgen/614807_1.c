static int adt7411_update_vref ( struct device * dev ) { struct adt7411_data * data = dev_get_drvdata ( dev ) ; struct i2c_client * client = data -> client ; int val ; if ( time_after_eq ( jiffies , data -> next_update ) ) { val = i2c_smbus_read_byte_data ( client , ADT7411_REG_CFG3 ) ; if ( val < 0 ) { return val ; } if ( val & ADT7411_CFG3_REF_VDD ) { if ( val < 0 ) { return val ; } } else { data -> vref_cached = 2250 ; } data -> next_update = jiffies + HZ ; } return 0 ; } 