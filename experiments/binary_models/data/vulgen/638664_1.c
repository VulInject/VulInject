static struct buffy * buffy_new ( size_t size , size_t minsize ) { struct buffy * newbuf ; newbuf = malloc ( sizeof ( buffy ) ) ; if ( newbuf == NULL ) { return NULL ; } newbuf -> realsize = size > minsize ?size : minsize ; newbuf -> data = malloc ( newbuf -> realsize ) ; if ( newbuf -> data == NULL ) { return NULL ; } newbuf -> size = 0 ; newbuf -> next = NULL ; return newbuf ; } 