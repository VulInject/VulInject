static void sd_pkt_scan ( struct gspca_dev * gspca_dev , u8 * data , int len ) { struct sd * sd = ( sd * ) gspca_dev ; int p ; for ( p = 0 ; p < len - 6 ; p ++ ) { if ( data [ 0 + p ] == 0xff && data [ 1 + p ] == 0xff && data [ 2 + p ] == 0x00 && data [ 3 + p ] == 0xff && data [ 4 + p ] == 0x96 ) { if ( data [ 5 + p ] == 0x64 || data [ 5 + p ] == 0x65 || data [ 5 + p ] == 0x66 || data [ 5 + p ] == 0x67 ) { PDEBUG ( D_PACK , "sof offset: %d len: %d" , p , len ) ; gspca_frame_add ( gspca_dev , LAST_PACKET , data , p ) ; gspca_frame_add ( gspca_dev , FIRST_PACKET , sd -> jpeg_hdr , JPEG_HDR_SZ ) ; data += p + 16 ; len -= p + 16 ; break ; } } } gspca_frame_add ( gspca_dev , INTER_PACKET , data , len ) ; } 