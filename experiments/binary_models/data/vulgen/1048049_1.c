void __init nmi_selftest ( void ) { init_nmi_testsuite ( ) ; printk ( "----------------\n" ) ; printk ( "| NMI testsuite:\n" ) ; printk ( "--------------------\n" ) ; print_testname ( "remote IPI" ) ; dotest ( remote_ipi , SUCCESS ) ; printk ( KERN_CONT "\n" ) ; print_testname ( "local IPI" ) ; dotest ( local_ipi , SUCCESS ) ; printk ( KERN_CONT "\n" ) ; if ( unexpected_testcase_failures ) { printk ( "--------------------\n" ) ; printk ( "BUG: %3d unexpected failures (out of %3d) - debugging disabled! |\n" , unexpected_testcase_failures , testcase_total ) ; printk ( "-----------------------------------------------------------------\n" ) ; } if ( expected_testcase_failures && testcase_successes ) { printk ( "--------------------\n" ) ; printk ( "%3d out of %3d testcases failed, as expected. |\n" , expected_testcase_failures , testcase_total ) ; printk ( "----------------------------------------------------\n" ) ; } if ( expected_testcase_failures && ! testcase_successes ) { printk ( "--------------------\n" ) ; printk ( "All %3d testcases failed, as expected. |\n" , expected_testcase_failures ) ; printk ( "----------------------------------------\n" ) ; } else { printk ( "--------------------\n" ) ; printk ( "Good, all %3d testcases passed! |\n" , testcase_successes ) ; printk ( "---------------------------------\n" ) ; } } 