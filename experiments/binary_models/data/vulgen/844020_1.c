static void mdeg_dump_clnt ( mdeg_clnt_t * clnt ) static void mdeg_dump_table ( void ) ( ( uint64_t ) ( _count + 1 ) & MDEG_COUNT_MASK ) ; static const char trunc_str [ ] " ... }" ; ; static mdeg_clnt_t * mdeg_alloc_clnt ( void ) static void mdeg_notify_client ( void * ) static mde_cookie_t mdeg_find_start_node ( md_t * , mdeg_node_spec_t * ) static boolean_t mdeg_node_spec_match ( md_t * , mde_cookie_t , mdeg_node_spec_t * ) static void mdeg_get_diff_results ( md_diff_cookie_t , mdeg_result_t * ) int mdeg_init ( void ) { int tblsz ; mdeg . maxclnts = MDEG_MAX_CLNTS_INIT ; tblsz = mdeg . maxclnts * sizeof ( mdeg_clnt_t ) ; mdeg . tbl = kmem_zalloc ( tblsz , KM_SLEEP ) ; rw_init ( & mdeg . rwlock , NULL , RW_DRIVER , NULL ) ; mdeg . nclnts = 0 ; mutex_init ( & mdeg . lock , NULL , MUTEX_DRIVER , NULL ) ; mdeg . taskq = taskq_create ( "mdeg_taskq" , 1 , minclsyspri , 1 , MDEG_MAX_TASKQ_THR , TASKQ_PREPOPULATE | TASKQ_DYNAMIC ) ; mdeg . enabled = B_TRUE ; return ( 0 ) ; } 