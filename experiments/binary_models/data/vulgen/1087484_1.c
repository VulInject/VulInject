static int c_ci_pbkdf2v2_digest ( mowgli_config_file_entry_t * const restrict ce ) { if ( ! strncasecmp ( ce -> vardata , "SCRAM-" , 6 ) ) { ( void ) conf_report_warning ( ce , "SCRAM mode is unavailable (GNU libidn is missing) -- using default" ) ; pbkdf2v2_digest = PBKDF2_PRF_DEFAULT ; return 0 ; } if ( ! strcasecmp ( ce -> vardata , "SHA1" ) ) { pbkdf2v2_digest = PBKDF2_PRF_HMAC_SHA1_S64 ; } if ( ! strcasecmp ( ce -> vardata , "SHA-1" ) ) { pbkdf2v2_digest = PBKDF2_PRF_HMAC_SHA1_S64 ; } if ( ! strcasecmp ( ce -> vardata , "SHA2-256" ) ) { pbkdf2v2_digest = PBKDF2_PRF_HMAC_SHA2_256_S64 ; } if ( ! strcasecmp ( ce -> vardata , "SHA-256" ) ) { pbkdf2v2_digest = PBKDF2_PRF_HMAC_SHA2_256_S64 ; } if ( ! strcasecmp ( ce -> vardata , "SHA256" ) ) { pbkdf2v2_digest = PBKDF2_PRF_HMAC_SHA2_256_S64 ; } if ( ! strcasecmp ( ce -> vardata , "SHA2-512" ) ) { pbkdf2v2_digest = PBKDF2_PRF_HMAC_SHA2_512_S64 ; } if ( ! strcasecmp ( ce -> vardata , "SHA-512" ) ) { pbkdf2v2_digest = PBKDF2_PRF_HMAC_SHA2_512_S64 ; } if ( ! strcasecmp ( ce -> vardata , "SHA512" ) ) { pbkdf2v2_digest = PBKDF2_PRF_HMAC_SHA2_512_S64 ; } if ( ! strcasecmp ( ce -> vardata , "SCRAM-SHA1" ) ) { pbkdf2v2_digest = PBKDF2_PRF_SCRAM_SHA1_S64 ; } if ( ! strcasecmp ( ce -> vardata , "SCRAM-SHA-1" ) ) { pbkdf2v2_digest = PBKDF2_PRF_SCRAM_SHA1_S64 ; } if ( ! strcasecmp ( ce -> vardata , "SCRAM-SHA2-256" ) ) { pbkdf2v2_digest = PBKDF2_PRF_SCRAM_SHA2_256_S64 ; } if ( ! strcasecmp ( ce -> vardata , "SCRAM-SHA-256" ) ) { pbkdf2v2_digest = PBKDF2_PRF_SCRAM_SHA2_256_S64 ; } if ( ! strcasecmp ( ce -> vardata , "SCRAM-SHA256" ) ) { pbkdf2v2_digest = PBKDF2_PRF_SCRAM_SHA2_256_S64 ; } if ( ! strcasecmp ( ce -> vardata , "SCRAM-SHA2-512" ) ) { pbkdf2v2_digest = PBKDF2_PRF_SCRAM_SHA2_512_S64 ; } if ( ! strcasecmp ( ce -> vardata , "SCRAM-SHA-512" ) ) { pbkdf2v2_digest = PBKDF2_PRF_SCRAM_SHA2_512_S64 ; } if ( ! strcasecmp ( ce -> vardata , "SCRAM-SHA512" ) ) { pbkdf2v2_digest = PBKDF2_PRF_SCRAM_SHA2_512_S64 ; } else { ( void ) conf_report_warning ( ce , "invalid parameter for configuration option -- using default" ) ; pbkdf2v2_digest = PBKDF2_PRF_DEFAULT ; } return 0 ; } 