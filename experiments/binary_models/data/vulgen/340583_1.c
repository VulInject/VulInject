void owid_attach ( struct device * parent , struct device * self , void * aux ) { struct owid_softc * sc = ( owid_softc * ) self ; struct onewire_attach_args * oa = aux ; sc -> sc_onewire = oa -> oa_onewire ; sc -> sc_rom = oa -> oa_rom ; strlcpy ( sc -> sc_sensordev . xname , sc -> sc_dev . dv_xname , sizeof ( sc -> sc_sensordev . xname ) ) ; sc -> sc_sensor . type = SENSOR_INTEGER ; sc -> sc_sensor . value = ONEWIRE_ROM_SN ( sc -> sc_rom ) ; snprintf ( sc -> sc_sensor . desc , sizeof ( sc -> sc_sensor . desc ) , "sn %012llx" , ONEWIRE_ROM_SN ( oa -> oa_rom ) ) ; sensor_attach ( & sc -> sc_sensordev , & sc -> sc_sensor ) ; sensordev_install ( & sc -> sc_sensordev ) ; } 