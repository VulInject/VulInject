static void cell ( struct tbl_node * tbl , struct tbl_row * rp , int ln , const char * p , int * pos ) { int i ; enum tbl_cellt c ; while ( p [ * pos ] == ' ' || p [ * pos ] == '\t' || p [ * pos ] == '|' ) { if ( p [ * pos ] == '|' ) { if ( rp -> vert < 2 ) { rp -> vert ++ ; } else { mandoc_msg ( MANDOCERR_TBLLAYOUT_VERT , ln , * pos , NULL ) ; } } ( * pos ) ++ ; } again while ( p [ * pos ] == ' ' || p [ * pos ] == '\t' ) { ( * pos ) ++ ; } for ( i = 0 ; i < KEYS_MAX ; i ++ ) { if ( tolower ( ( unsigned char ) p [ * pos ] ) == keys [ i ] . name ) { break ; } } if ( i == KEYS_MAX ) { mandoc_msg ( MANDOCERR_TBLLAYOUT_CHAR , ln , * pos , "%c" , p [ * pos ] ) ; ( * pos ) ++ ; again } c = keys [ i ] . key ; if ( c == TBL_CELL_SPAN ) { if ( rp -> last == NULL ) { mandoc_msg ( MANDOCERR_TBLLAYOUT_SPAN , ln , * pos , NULL ) ; } if ( rp -> last -> pos == TBL_CELL_HORIZ || rp -> last -> pos == TBL_CELL_DHORIZ ) { c = rp -> last -> pos ; } } if ( c == TBL_CELL_DOWN && rp == tbl -> first_row ) { mandoc_msg ( MANDOCERR_TBLLAYOUT_DOWN , ln , * pos , NULL ) ; } ( * pos ) ++ ; mods ( tbl , cell_alloc ( tbl , rp , c ) , ln , p , pos ) ; } 