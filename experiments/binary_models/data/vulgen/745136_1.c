static DEFINE_SPINLOCK ( emc_lock ) ; static struct div_nmp pllxc_nmp = { . divm_shift = 0 . divm_width = 8 . divn_shift = 8 . divn_width = 8 . divp_shift = 20 . divp_width = 4 } ; static const struct pdiv_map pllxc_p [ ] { { . pdiv = 1 . hw_val = 0 } { . pdiv = 2 . hw_val = 1 } { . pdiv = 3 . hw_val = 2 } { . pdiv = 4 . hw_val = 3 } { . pdiv = 5 . hw_val = 4 } { . pdiv = 6 . hw_val = 5 } { . pdiv = 8 . hw_val = 6 } { . pdiv = 10 . hw_val = 7 } { . pdiv = 12 . hw_val = 8 } { . pdiv = 16 . hw_val = 9 } { . pdiv = 12 . hw_val = 10 } { . pdiv = 16 . hw_val = 11 } { . pdiv = 20 . hw_val = 12 } { . pdiv = 24 . hw_val = 13 } { . pdiv = 32 . hw_val = 14 } { . pdiv = 0 . hw_val = 0 } } ; ; static struct tegra_clk_pll_freq_table pll_c_freq_table [ ] { { 12000000 624000000 104 1 2 0 } { 12000000 600000000 100 1 2 0 } { 13000000 600000000 92 1 2 0 } { 16800000 600000000 71 1 2 0 } { 19200000 600000000 62 1 2 0 } { 26000000 600000000 92 2 2 0 } { 0 0 0 0 0 0 } } ; ; static struct tegra_clk_pll_params pll_c_params = { . input_min = 12000000 . input_max = 800000000 . cf_min = 12000000 . cf_max = 19200000 . vco_min = 600000000 . vco_max = 1400000000 . base_reg = PLLC_BASE . misc_reg = PLLC_MISC . lock_mask = PLL_BASE_LOCK . lock_enable_bit_idx = PLLC_MISC_LOCK_ENABLE . lock_delay = 300 . iddq_reg = PLLC_MISC . iddq_bit_idx = PLLC_IDDQ_BIT . max_p = PLLXC_SW_MAX_P . dyn_ramp_reg = PLLC_MISC2 . stepa_shift = 17 . stepb_shift = 9 . pdiv_tohw = pllxc_p . div_nmp = & pllxc_nmp . freq_table = pll_c_freq_table . flags = TEGRA_PLL_USE_LOCK | TEGRA_PLL_HAS_LOCK_ENABLE } ; static struct div_nmp pllcx_nmp = { . divm_shift = 0 . divm_width = 2 . divn_shift = 8 . divn_width = 8 . divp_shift = 20 . divp_width = 3 } ; static const struct pdiv_map pllc_p [ ] { { . pdiv = 1 . hw_val = 0 } { . pdiv = 2 . hw_val = 1 } { . pdiv = 4 . hw_val = 3 } { . pdiv = 8 . hw_val = 5 } { . pdiv = 16 . hw_val = 7 } { . pdiv = 0 . hw_val = 0 } } ; ; static struct tegra_clk_pll_freq_table pll_cx_freq_table [ ] { { 12000000 600000000 100 1 2 0 } { 13000000 600000000 92 1 2 0 } { 16800000 600000000 71 1 2 0 } { 19200000 600000000 62 1 2 0 } { 26000000 600000000 92 2 2 0 } { 0 0 0 0 0 0 } } ; ; static struct tegra_clk_pll_params pll_c2_params = { . input_min = 12000000 . input_max = 48000000 . cf_min = 12000000 . cf_max = 19200000 . vco_min = 600000000 . vco_max = 1200000000 . base_reg = PLLC2_BASE . misc_reg = PLLC2_MISC . lock_mask = PLL_BASE_LOCK . lock_enable_bit_idx = PLL_MISC_LOCK_ENABLE . lock_delay = 300 . pdiv_tohw = pllc_p . div_nmp = & pllcx_nmp . max_p = 7 . ext_misc_reg [ 0 ] = 0x4f0 . ext_misc_reg [ 1 ] = 0x4f4 . ext_misc_reg [ 2 ] = 0x4f8 . freq_table = pll_cx_freq_table . flags = TEGRA_PLL_USE_LOCK } ; static struct tegra_clk_pll_params pll_c3_params = { . input_min = 12000000 . input_max = 48000000 . cf_min = 12000000 . cf_max = 19200000 . vco_min = 600000000 . vco_max = 1200000000 . base_reg = PLLC3_BASE . misc_reg = PLLC3_MISC . lock_mask = PLL_BASE_LOCK . lock_enable_bit_idx = PLL_MISC_LOCK_ENABLE . lock_delay = 300 . pdiv_tohw = pllc_p . div_nmp = & pllcx_nmp . max_p = 7 . ext_misc_reg [ 0 ] = 0x504 . ext_misc_reg [ 1 ] = 0x508 . ext_misc_reg [ 2 ] = 0x50c . freq_table = pll_cx_freq_table . flags = TEGRA_PLL_USE_LOCK } ; static struct div_nmp pllm_nmp = { . divm_shift = 0 . divm_width = 8 . override_divm_shift = 0 . divn_shift = 8 . divn_width = 8 . override_divn_shift = 8 . divp_shift = 20 . divp_width = 1 . override_divp_shift = 27 } ; static const struct pdiv_map pllm_p [ ] { { . pdiv = 1 . hw_val = 0 } { . pdiv = 2 . hw_val = 1 } { . pdiv = 0 . hw_val = 0 } } ; ; static struct tegra_clk_pll_freq_table pll_m_freq_table [ ] { { 12000000 800000000 66 1 1 0 } { 13000000 800000000 61 1 1 0 } { 16800000 800000000 47 1 1 0 } { 19200000 800000000 41 1 1 0 } { 26000000 800000000 61 2 1 0 } { 0 0 0 0 0 0 } } ; ; static struct tegra_clk_pll_params pll_m_params = { . input_min = 12000000 . input_max = 500000000 . cf_min = 12000000 . cf_max = 19200000 . vco_min = 400000000 . vco_max = 1066000000 . base_reg = PLLM_BASE . misc_reg = PLLM_MISC . lock_mask = PLL_BASE_LOCK . lock_enable_bit_idx = PLL_MISC_LOCK_ENABLE . lock_delay = 300 . max_p = 2 . pdiv_tohw = pllm_p . div_nmp = & pllm_nmp . pmc_divnm_reg = PMC_PLLM_WB0_OVERRIDE . pmc_divp_reg = PMC_PLLM_WB0_OVERRIDE_2 . freq_table = pll_m_freq_table . flags = TEGRA_PLL_USE_LOCK | TEGRA_PLL_HAS_LOCK_ENABLE | TEGRA_PLL_FIXED } ; static struct div_nmp pllp_nmp = { . divm_shift = 0 . divm_width = 5 . divn_shift = 8 . divn_width = 10 . divp_shift = 20 . divp_width = 3 } ; static struct tegra_clk_pll_freq_table pll_p_freq_table [ ] { { 12000000 216000000 432 12 2 8 } { 13000000 216000000 432 13 2 8 } { 16800000 216000000 360 14 2 8 } { 19200000 216000000 360 16 2 8 } { 26000000 216000000 432 26 2 8 } { 0 0 0 0 0 0 } } ; ; static struct tegra_clk_pll_params pll_p_params = { . input_min = 2000000 . input_max = 31000000 . cf_min = 1000000 . cf_max = 6000000 . vco_min = 200000000 . vco_max = 700000000 . base_reg = PLLP_BASE . misc_reg = PLLP_MISC . lock_mask = PLL_BASE_LOCK . lock_enable_bit_idx = PLL_MISC_LOCK_ENABLE . lock_delay = 300 . div_nmp = & pllp_nmp . freq_table = pll_p_freq_table . flags = TEGRA_PLL_FIXED | TEGRA_PLL_USE_LOCK | TEGRA_PLL_HAS_LOCK_ENABLE . fixed_rate = 408000000 } ; static struct tegra_clk_pll_freq_table pll_a_freq_table [ ] { { 9600000 282240000 147 5 1 4 } { 9600000 368640000 192 5 1 4 } { 9600000 240000000 200 8 1 8 } { 28800000 282240000 245 25 1 8 } { 28800000 368640000 320 25 1 8 } { 28800000 240000000 200 24 1 8 } { 0 0 0 0 0 0 } } ; ; static struct tegra_clk_pll_params pll_a_params = { . input_min = 2000000 . input_max = 31000000 . cf_min = 1000000 . cf_max = 6000000 . vco_min = 200000000 . vco_max = 700000000 . base_reg = PLLA_BASE . misc_reg = PLLA_MISC . lock_mask = PLL_BASE_LOCK . lock_enable_bit_idx = PLL_MISC_LOCK_ENABLE . lock_delay = 300 . div_nmp = & pllp_nmp . freq_table = pll_a_freq_table . flags = TEGRA_PLL_HAS_CPCON | TEGRA_PLL_USE_LOCK | TEGRA_PLL_HAS_LOCK_ENABLE } ; static struct tegra_clk_pll_freq_table pll_d_freq_table [ ] { { 12000000 216000000 864 12 4 12 } { 13000000 216000000 864 13 4 12 } { 16800000 216000000 720 14 4 12 } { 19200000 216000000 720 16 4 12 } { 26000000 216000000 864 26 4 12 } { 12000000 594000000 594 12 1 12 } { 13000000 594000000 594 13 1 12 } { 16800000 594000000 495 14 1 12 } { 19200000 594000000 495 16 1 12 } { 26000000 594000000 594 26 1 12 } { 12000000 1000000000 1000 12 1 12 } { 13000000 1000000000 1000 13 1 12 } { 19200000 1000000000 625 12 1 12 } { 26000000 1000000000 1000 26 1 12 } { 0 0 0 0 0 0 } } ; ; static struct tegra_clk_pll_params pll_d_params = { . input_min = 2000000 . input_max = 40000000 . cf_min = 1000000 . cf_max = 6000000 . vco_min = 500000000 . vco_max = 1000000000 . base_reg = PLLD_BASE . misc_reg = PLLD_MISC . lock_mask = PLL_BASE_LOCK . lock_enable_bit_idx = PLLDU_MISC_LOCK_ENABLE . lock_delay = 1000 . div_nmp = & pllp_nmp . freq_table = pll_d_freq_table . flags = TEGRA_PLL_HAS_CPCON | TEGRA_PLL_SET_LFCON | TEGRA_PLL_HAS_LOCK_ENABLE } ; static struct tegra_clk_pll_params pll_d2_params = { . input_min = 2000000 . input_max = 40000000 . cf_min = 1000000 . cf_max = 6000000 . vco_min = 500000000 . vco_max = 1000000000 . base_reg = PLLD2_BASE . misc_reg = PLLD2_MISC . lock_mask = PLL_BASE_LOCK . lock_enable_bit_idx = PLLDU_MISC_LOCK_ENABLE . lock_delay = 1000 . div_nmp = & pllp_nmp . freq_table = pll_d_freq_table . flags = TEGRA_PLL_HAS_CPCON | TEGRA_PLL_SET_LFCON | TEGRA_PLL_HAS_LOCK_ENABLE } ; static const struct pdiv_map pllu_p [ ] { { . pdiv = 1 . hw_val = 1 } { . pdiv = 2 . hw_val = 0 } { . pdiv = 0 . hw_val = 0 } } ; ; static struct div_nmp pllu_nmp = { . divm_shift = 0 . divm_width = 5 . divn_shift = 8 . divn_width = 10 . divp_shift = 20 . divp_width = 1 } ; static struct tegra_clk_pll_freq_table pll_u_freq_table [ ] { { 12000000 480000000 960 12 2 12 } { 13000000 480000000 960 13 2 12 } { 16800000 480000000 400 7 2 5 } { 19200000 480000000 200 4 2 3 } { 26000000 480000000 960 26 2 12 } { 0 0 0 0 0 0 } } ; ; static struct tegra_clk_pll_params pll_u_params = { . input_min = 2000000 . input_max = 40000000 . cf_min = 1000000 . cf_max = 6000000 . vco_min = 480000000 . vco_max = 960000000 . base_reg = PLLU_BASE . misc_reg = PLLU_MISC . lock_mask = PLL_BASE_LOCK . lock_enable_bit_idx = PLLDU_MISC_LOCK_ENABLE . lock_delay = 1000 . pdiv_tohw = pllu_p . div_nmp = & pllu_nmp . freq_table = pll_u_freq_table . flags = TEGRA_PLLU | TEGRA_PLL_HAS_CPCON | TEGRA_PLL_SET_LFCON | TEGRA_PLL_USE_LOCK | TEGRA_PLL_HAS_LOCK_ENABLE } ; static struct tegra_clk_pll_freq_table pll_x_freq_table [ ] { { 12000000 1000000000 83 1 1 0 } { 13000000 1000000000 76 1 1 0 } { 16800000 1000000000 59 1 1 0 } { 19200000 1000000000 52 1 1 0 } { 26000000 1000000000 76 2 1 0 } { 0 0 0 0 0 0 } } ; ; static struct tegra_clk_pll_params pll_x_params = { . input_min = 12000000 . input_max = 800000000 . cf_min = 12000000 . cf_max = 19200000 . vco_min = 700000000 . vco_max = 2400000000U . base_reg = PLLX_BASE . misc_reg = PLLX_MISC . lock_mask = PLL_BASE_LOCK . lock_enable_bit_idx = PLL_MISC_LOCK_ENABLE . lock_delay = 300 . iddq_reg = PLLX_MISC3 . iddq_bit_idx = PLLX_IDDQ_BIT . max_p = PLLXC_SW_MAX_P . dyn_ramp_reg = PLLX_MISC2 . stepa_shift = 16 . stepb_shift = 24 . pdiv_tohw = pllxc_p . div_nmp = & pllxc_nmp . freq_table = pll_x_freq_table . flags = TEGRA_PLL_USE_LOCK | TEGRA_PLL_HAS_LOCK_ENABLE } ; static struct tegra_clk_pll_freq_table pll_e_freq_table [ ] { { 336000000 100000000 100 21 16 11 } { 312000000 100000000 200 26 24 13 } { 12000000 100000000 200 1 24 13 } { 0 0 0 0 0 0 } } ; ; static const struct pdiv_map plle_p [ ] { { . pdiv = 1 . hw_val = 0 } { . pdiv = 2 . hw_val = 1 } { . pdiv = 3 . hw_val = 2 } { . pdiv = 4 . hw_val = 3 } { . pdiv = 5 . hw_val = 4 } { . pdiv = 6 . hw_val = 5 } { . pdiv = 8 . hw_val = 6 } { . pdiv = 10 . hw_val = 7 } { . pdiv = 12 . hw_val = 8 } { . pdiv = 16 . hw_val = 9 } { . pdiv = 12 . hw_val = 10 } { . pdiv = 16 . hw_val = 11 } { . pdiv = 20 . hw_val = 12 } { . pdiv = 24 . hw_val = 13 } { . pdiv = 32 . hw_val = 14 } { . pdiv = 0 . hw_val = 0 } } ; ; static struct div_nmp plle_nmp = { . divm_shift = 0 . divm_width = 8 . divn_shift = 8 . divn_width = 8 . divp_shift = 24 . divp_width = 4 } ; static struct tegra_clk_pll_params pll_e_params = { . input_min = 12000000 . input_max = 1000000000 . cf_min = 12000000 . cf_max = 75000000 . vco_min = 1600000000 . vco_max = 2400000000U . base_reg = PLLE_BASE . misc_reg = PLLE_MISC . aux_reg = PLLE_AUX . lock_mask = PLLE_MISC_LOCK . lock_enable_bit_idx = PLLE_MISC_LOCK_ENABLE . lock_delay = 300 . pdiv_tohw = plle_p . div_nmp = & plle_nmp . freq_table = pll_e_freq_table . flags = TEGRA_PLL_FIXED | TEGRA_PLL_HAS_LOCK_ENABLE . fixed_rate = 100000000 } ; static struct div_nmp pllre_nmp = { . divm_shift = 0 . divm_width = 8 . divn_shift = 8 . divn_width = 8 . divp_shift = 16 . divp_width = 4 } ; static struct tegra_clk_pll_params pll_re_vco_params = { . input_min = 12000000 . input_max = 1000000000 . cf_min = 12000000 . cf_max = 19200000 . vco_min = 300000000 . vco_max = 600000000 . base_reg = PLLRE_BASE . misc_reg = PLLRE_MISC . lock_mask = PLLRE_MISC_LOCK . lock_enable_bit_idx = PLLRE_MISC_LOCK_ENABLE . lock_delay = 300 . iddq_reg = PLLRE_MISC . iddq_bit_idx = PLLRE_IDDQ_BIT . div_nmp = & pllre_nmp . flags = TEGRA_PLL_USE_LOCK | TEGRA_PLL_HAS_LOCK_ENABLE | TEGRA_PLL_LOCK_MISC } ; static unsigned long tegra114_input_freq [ ] { [ 0 ] = 13000000 [ 1 ] = 16800000 [ 4 ] = 19200000 [ 5 ] = 38400000 [ 8 ] = 12000000 [ 9 ] = 48000000 [ 12 ] = 26000000 } ; ; static const char * mux_plld_out0_plld2_out0 [ ] { "pll_d_out0" "pll_d2_out0" } ; ; static const char * mux_pllmcp_clkm [ ] { "pll_m_out0" "pll_c_out0" "pll_p_out0" "clk_m" "pll_m_ud" } ; ; static const struct clk_div_table pll_re_div_table [ ] { { . val = 0 . div = 1 } { . val = 1 . div = 2 } { . val = 2 . div = 3 } { . val = 3 . div = 4 } { . val = 4 . div = 5 } { . val = 5 . div = 6 } { . val = 0 . div = 0 } } ; ; static struct tegra_clk tegra114_clks [ tegra_clk_max ] __initdata = { [ tegra_clk_rtc ] = { . dt_id = TEGRA114_CLK_RTC . present = true } [ tegra_clk_timer ] = { . dt_id = TEGRA114_CLK_TIMER . present = true } [ tegra_clk_uarta ] = { . dt_id = TEGRA114_CLK_UARTA . present = true } [ tegra_clk_uartd ] = { . dt_id = TEGRA114_CLK_UARTD . present = true } [ tegra_clk_sdmmc2_8 ] = { . dt_id = TEGRA114_CLK_SDMMC2 . present = true } [ tegra_clk_i2s1 ] = { . dt_id = TEGRA114_CLK_I2S1 . present = true } [ tegra_clk_i2c1 ] = { . dt_id = TEGRA114_CLK_I2C1 . present = true } [ tegra_clk_ndflash ] = { . dt_id = TEGRA114_CLK_NDFLASH . present = true } [ tegra_clk_sdmmc1_8 ] = { . dt_id = TEGRA114_CLK_SDMMC1 . present = true } [ tegra_clk_sdmmc4_8 ] = { . dt_id = TEGRA114_CLK_SDMMC4 . present = true } [ tegra_clk_pwm ] = { . dt_id = TEGRA114_CLK_PWM . present = true } [ tegra_clk_i2s0 ] = { . dt_id = TEGRA114_CLK_I2S0 . present = true } [ tegra_clk_i2s2 ] = { . dt_id = TEGRA114_CLK_I2S2 . present = true } [ tegra_clk_epp_8 ] = { . dt_id = TEGRA114_CLK_EPP . present = true } [ tegra_clk_gr2d_8 ] = { . dt_id = TEGRA114_CLK_GR2D . present = true } [ tegra_clk_usbd ] = { . dt_id = TEGRA114_CLK_USBD . present = true } [ tegra_clk_isp ] = { . dt_id = TEGRA114_CLK_ISP . present = true } [ tegra_clk_gr3d_8 ] = { . dt_id = TEGRA114_CLK_GR3D . present = true } [ tegra_clk_disp2 ] = { . dt_id = TEGRA114_CLK_DISP2 . present = true } [ tegra_clk_disp1 ] = { . dt_id = TEGRA114_CLK_DISP1 . present = true } [ tegra_clk_host1x_8 ] = { . dt_id = TEGRA114_CLK_HOST1X . present = true } [ tegra_clk_vcp ] = { . dt_id = TEGRA114_CLK_VCP . present = true } [ tegra_clk_apbdma ] = { . dt_id = TEGRA114_CLK_APBDMA . present = true } [ tegra_clk_kbc ] = { . dt_id = TEGRA114_CLK_KBC . present = true } [ tegra_clk_kfuse ] = { . dt_id = TEGRA114_CLK_KFUSE . present = true } [ tegra_clk_sbc1_8 ] = { . dt_id = TEGRA114_CLK_SBC1 . present = true } [ tegra_clk_nor ] = { . dt_id = TEGRA114_CLK_NOR . present = true } [ tegra_clk_sbc2_8 ] = { . dt_id = TEGRA114_CLK_SBC2 . present = true } [ tegra_clk_sbc3_8 ] = { . dt_id = TEGRA114_CLK_SBC3 . present = true } [ tegra_clk_i2c5 ] = { . dt_id = TEGRA114_CLK_I2C5 . present = true } [ tegra_clk_mipi ] = { . dt_id = TEGRA114_CLK_MIPI . present = true } [ tegra_clk_hdmi ] = { . dt_id = TEGRA114_CLK_HDMI . present = true } [ tegra_clk_csi ] = { . dt_id = TEGRA114_CLK_CSI . present = true } [ tegra_clk_i2c2 ] = { . dt_id = TEGRA114_CLK_I2C2 . present = true } [ tegra_clk_uartc ] = { . dt_id = TEGRA114_CLK_UARTC . present = true } [ tegra_clk_emc ] = { . dt_id = TEGRA114_CLK_EMC . present = true } [ tegra_clk_usb2 ] = { . dt_id = TEGRA114_CLK_USB2 . present = true } [ tegra_clk_usb3 ] = { . dt_id = TEGRA114_CLK_USB3 . present = true } [ tegra_clk_vde_8 ] = { . dt_id = TEGRA114_CLK_VDE . present = true } [ tegra_clk_bsea ] = { . dt_id = TEGRA114_CLK_BSEA . present = true } [ tegra_clk_bsev ] = { . dt_id = TEGRA114_CLK_BSEV . present = true } [ tegra_clk_i2c3 ] = { . dt_id = TEGRA114_CLK_I2C3 . present = true } [ tegra_clk_sbc4_8 ] = { . dt_id = TEGRA114_CLK_SBC4 . present = true } [ tegra_clk_sdmmc3_8 ] = { . dt_id = TEGRA114_CLK_SDMMC3 . present = true } [ tegra_clk_owr ] = { . dt_id = TEGRA114_CLK_OWR . present = true } [ tegra_clk_csite ] = { . dt_id = TEGRA114_CLK_CSITE . present = true } [ tegra_clk_la ] = { . dt_id = TEGRA114_CLK_LA . present = true } [ tegra_clk_trace ] = { . dt_id = TEGRA114_CLK_TRACE . present = true } [ tegra_clk_soc_therm ] = { . dt_id = TEGRA114_CLK_SOC_THERM . present = true } [ tegra_clk_dtv ] = { . dt_id = TEGRA114_CLK_DTV . present = true } [ tegra_clk_ndspeed ] = { . dt_id = TEGRA114_CLK_NDSPEED . present = true } [ tegra_clk_i2cslow ] = { . dt_id = TEGRA114_CLK_I2CSLOW . present = true } [ tegra_clk_tsec ] = { . dt_id = TEGRA114_CLK_TSEC . present = true } [ tegra_clk_xusb_host ] = { . dt_id = TEGRA114_CLK_XUSB_HOST . present = true } [ tegra_clk_msenc ] = { . dt_id = TEGRA114_CLK_MSENC . present = true } [ tegra_clk_csus ] = { . dt_id = TEGRA114_CLK_CSUS . present = true } [ tegra_clk_mselect ] = { . dt_id = TEGRA114_CLK_MSELECT . present = true } [ tegra_clk_tsensor ] = { . dt_id = TEGRA114_CLK_TSENSOR . present = true } [ tegra_clk_i2s3 ] = { . dt_id = TEGRA114_CLK_I2S3 . present = true } [ tegra_clk_i2s4 ] = { . dt_id = TEGRA114_CLK_I2S4 . present = true } [ tegra_clk_i2c4 ] = { . dt_id = TEGRA114_CLK_I2C4 . present = true } [ tegra_clk_sbc5_8 ] = { . dt_id = TEGRA114_CLK_SBC5 . present = true } [ tegra_clk_sbc6_8 ] = { . dt_id = TEGRA114_CLK_SBC6 . present = true } [ tegra_clk_d_audio ] = { . dt_id = TEGRA114_CLK_D_AUDIO . present = true } [ tegra_clk_apbif ] = { . dt_id = TEGRA114_CLK_APBIF . present = true } [ tegra_clk_dam0 ] = { . dt_id = TEGRA114_CLK_DAM0 . present = true } [ tegra_clk_dam1 ] = { . dt_id = TEGRA114_CLK_DAM1 . present = true } [ tegra_clk_dam2 ] = { . dt_id = TEGRA114_CLK_DAM2 . present = true } [ tegra_clk_hda2codec_2x ] = { . dt_id = TEGRA114_CLK_HDA2CODEC_2X . present = true } [ tegra_clk_audio0_2x ] = { . dt_id = TEGRA114_CLK_AUDIO0_2X . present = true } [ tegra_clk_audio1_2x ] = { . dt_id = TEGRA114_CLK_AUDIO1_2X . present = true } [ tegra_clk_audio2_2x ] = { . dt_id = TEGRA114_CLK_AUDIO2_2X . present = true } [ tegra_clk_audio3_2x ] = { . dt_id = TEGRA114_CLK_AUDIO3_2X . present = true } [ tegra_clk_audio4_2x ] = { . dt_id = TEGRA114_CLK_AUDIO4_2X . present = true } [ tegra_clk_spdif_2x ] = { . dt_id = TEGRA114_CLK_SPDIF_2X . present = true } [ tegra_clk_actmon ] = { . dt_id = TEGRA114_CLK_ACTMON . present = true } [ tegra_clk_extern1 ] = { . dt_id = TEGRA114_CLK_EXTERN1 . present = true } [ tegra_clk_extern2 ] = { . dt_id = TEGRA114_CLK_EXTERN2 . present = true } [ tegra_clk_extern3 ] = { . dt_id = TEGRA114_CLK_EXTERN3 . present = true } [ tegra_clk_hda ] = { . dt_id = TEGRA114_CLK_HDA . present = true } [ tegra_clk_se ] = { . dt_id = TEGRA114_CLK_SE . present = true } [ tegra_clk_hda2hdmi ] = { . dt_id = TEGRA114_CLK_HDA2HDMI . present = true } [ tegra_clk_cilab ] = { . dt_id = TEGRA114_CLK_CILAB . present = true } [ tegra_clk_cilcd ] = { . dt_id = TEGRA114_CLK_CILCD . present = true } [ tegra_clk_cile ] = { . dt_id = TEGRA114_CLK_CILE . present = true } [ tegra_clk_dsialp ] = { . dt_id = TEGRA114_CLK_DSIALP . present = true } [ tegra_clk_dsiblp ] = { . dt_id = TEGRA114_CLK_DSIBLP . present = true } [ tegra_clk_dds ] = { . dt_id = TEGRA114_CLK_DDS . present = true } [ tegra_clk_dp2 ] = { . dt_id = TEGRA114_CLK_DP2 . present = true } [ tegra_clk_amx ] = { . dt_id = TEGRA114_CLK_AMX . present = true } [ tegra_clk_adx ] = { . dt_id = TEGRA114_CLK_ADX . present = true } [ tegra_clk_xusb_ss ] = { . dt_id = TEGRA114_CLK_XUSB_SS . present = true } [ tegra_clk_uartb ] = { . dt_id = TEGRA114_CLK_UARTB . present = true } [ tegra_clk_vfir ] = { . dt_id = TEGRA114_CLK_VFIR . present = true } [ tegra_clk_spdif_in ] = { . dt_id = TEGRA114_CLK_SPDIF_IN . present = true } [ tegra_clk_spdif_out ] = { . dt_id = TEGRA114_CLK_SPDIF_OUT . present = true } [ tegra_clk_vi_8 ] = { . dt_id = TEGRA114_CLK_VI . present = true } [ tegra_clk_fuse ] = { . dt_id = TEGRA114_CLK_FUSE . present = true } [ tegra_clk_fuse_burn ] = { . dt_id = TEGRA114_CLK_FUSE_BURN . present = true } [ tegra_clk_clk_32k ] = { . dt_id = TEGRA114_CLK_CLK_32K . present = true } [ tegra_clk_clk_m ] = { . dt_id = TEGRA114_CLK_CLK_M . present = true } [ tegra_clk_osc ] = { . dt_id = TEGRA114_CLK_OSC . present = true } [ tegra_clk_osc_div2 ] = { . dt_id = TEGRA114_CLK_OSC_DIV2 . present = true } [ tegra_clk_osc_div4 ] = { . dt_id = TEGRA114_CLK_OSC_DIV4 . present = true } [ tegra_clk_pll_ref ] = { . dt_id = TEGRA114_CLK_PLL_REF . present = true } [ tegra_clk_pll_c ] = { . dt_id = TEGRA114_CLK_PLL_C . present = true } [ tegra_clk_pll_c_out1 ] = { . dt_id = TEGRA114_CLK_PLL_C_OUT1 . present = true } [ tegra_clk_pll_c2 ] = { . dt_id = TEGRA114_CLK_PLL_C2 . present = true } [ tegra_clk_pll_c3 ] = { . dt_id = TEGRA114_CLK_PLL_C3 . present = true } [ tegra_clk_pll_m ] = { . dt_id = TEGRA114_CLK_PLL_M . present = true } [ tegra_clk_pll_m_out1 ] = { . dt_id = TEGRA114_CLK_PLL_M_OUT1 . present = true } [ tegra_clk_pll_p ] = { . dt_id = TEGRA114_CLK_PLL_P . present = true } [ tegra_clk_pll_p_out1 ] = { . dt_id = TEGRA114_CLK_PLL_P_OUT1 . present = true } [ tegra_clk_pll_p_out2_int ] = { . dt_id = TEGRA114_CLK_PLL_P_OUT2 . present = true } [ tegra_clk_pll_p_out3 ] = { . dt_id = TEGRA114_CLK_PLL_P_OUT3 . present = true } [ tegra_clk_pll_p_out4 ] = { . dt_id = TEGRA114_CLK_PLL_P_OUT4 . present = true } [ tegra_clk_pll_a ] = { . dt_id = TEGRA114_CLK_PLL_A . present = true } [ tegra_clk_pll_a_out0 ] = { . dt_id = TEGRA114_CLK_PLL_A_OUT0 . present = true } [ tegra_clk_pll_d ] = { . dt_id = TEGRA114_CLK_PLL_D . present = true } [ tegra_clk_pll_d_out0 ] = { . dt_id = TEGRA114_CLK_PLL_D_OUT0 . present = true } [ tegra_clk_pll_d2 ] = { . dt_id = TEGRA114_CLK_PLL_D2 . present = true } [ tegra_clk_pll_d2_out0 ] = { . dt_id = TEGRA114_CLK_PLL_D2_OUT0 . present = true } [ tegra_clk_pll_u ] = { . dt_id = TEGRA114_CLK_PLL_U . present = true } [ tegra_clk_pll_u_480m ] = { . dt_id = TEGRA114_CLK_PLL_U_480M . present = true } [ tegra_clk_pll_u_60m ] = { . dt_id = TEGRA114_CLK_PLL_U_60M . present = true } [ tegra_clk_pll_u_48m ] = { . dt_id = TEGRA114_CLK_PLL_U_48M . present = true } [ tegra_clk_pll_u_12m ] = { . dt_id = TEGRA114_CLK_PLL_U_12M . present = true } [ tegra_clk_pll_x ] = { . dt_id = TEGRA114_CLK_PLL_X . present = true } [ tegra_clk_pll_x_out0 ] = { . dt_id = TEGRA114_CLK_PLL_X_OUT0 . present = true } [ tegra_clk_pll_re_vco ] = { . dt_id = TEGRA114_CLK_PLL_RE_VCO . present = true } [ tegra_clk_pll_re_out ] = { . dt_id = TEGRA114_CLK_PLL_RE_OUT . present = true } [ tegra_clk_pll_e_out0 ] = { . dt_id = TEGRA114_CLK_PLL_E_OUT0 . present = true } [ tegra_clk_spdif_in_sync ] = { . dt_id = TEGRA114_CLK_SPDIF_IN_SYNC . present = true } [ tegra_clk_i2s0_sync ] = { . dt_id = TEGRA114_CLK_I2S0_SYNC . present = true } [ tegra_clk_i2s1_sync ] = { . dt_id = TEGRA114_CLK_I2S1_SYNC . present = true } [ tegra_clk_i2s2_sync ] = { . dt_id = TEGRA114_CLK_I2S2_SYNC . present = true } [ tegra_clk_i2s3_sync ] = { . dt_id = TEGRA114_CLK_I2S3_SYNC . present = true } [ tegra_clk_i2s4_sync ] = { . dt_id = TEGRA114_CLK_I2S4_SYNC . present = true } [ tegra_clk_vimclk_sync ] = { . dt_id = TEGRA114_CLK_VIMCLK_SYNC . present = true } [ tegra_clk_audio0 ] = { . dt_id = TEGRA114_CLK_AUDIO0 . present = true } [ tegra_clk_audio1 ] = { . dt_id = TEGRA114_CLK_AUDIO1 . present = true } [ tegra_clk_audio2 ] = { . dt_id = TEGRA114_CLK_AUDIO2 . present = true } [ tegra_clk_audio3 ] = { . dt_id = TEGRA114_CLK_AUDIO3 . present = true } [ tegra_clk_audio4 ] = { . dt_id = TEGRA114_CLK_AUDIO4 . present = true } [ tegra_clk_spdif ] = { . dt_id = TEGRA114_CLK_SPDIF . present = true } [ tegra_clk_xusb_host_src ] = { . dt_id = TEGRA114_CLK_XUSB_HOST_SRC . present = true } [ tegra_clk_xusb_falcon_src ] = { . dt_id = TEGRA114_CLK_XUSB_FALCON_SRC . present = true } [ tegra_clk_xusb_fs_src ] = { . dt_id = TEGRA114_CLK_XUSB_FS_SRC . present = true } [ tegra_clk_xusb_ss_src ] = { . dt_id = TEGRA114_CLK_XUSB_SS_SRC . present = true } [ tegra_clk_xusb_ss_div2 ] = { . dt_id = TEGRA114_CLK_XUSB_SS_DIV2 . present = true } [ tegra_clk_xusb_dev_src ] = { . dt_id = TEGRA114_CLK_XUSB_DEV_SRC . present = true } [ tegra_clk_xusb_dev ] = { . dt_id = TEGRA114_CLK_XUSB_DEV . present = true } [ tegra_clk_xusb_hs_src ] = { . dt_id = TEGRA114_CLK_XUSB_HS_SRC . present = true } [ tegra_clk_sclk ] = { . dt_id = TEGRA114_CLK_SCLK . present = true } [ tegra_clk_hclk ] = { . dt_id = TEGRA114_CLK_HCLK . present = true } [ tegra_clk_pclk ] = { . dt_id = TEGRA114_CLK_PCLK . present = true } [ tegra_clk_cclk_g ] = { . dt_id = TEGRA114_CLK_CCLK_G . present = true } [ tegra_clk_cclk_lp ] = { . dt_id = TEGRA114_CLK_CCLK_LP . present = true } [ tegra_clk_dfll_ref ] = { . dt_id = TEGRA114_CLK_DFLL_REF . present = true } [ tegra_clk_dfll_soc ] = { . dt_id = TEGRA114_CLK_DFLL_SOC . present = true } [ tegra_clk_audio0_mux ] = { . dt_id = TEGRA114_CLK_AUDIO0_MUX . present = true } [ tegra_clk_audio1_mux ] = { . dt_id = TEGRA114_CLK_AUDIO1_MUX . present = true } [ tegra_clk_audio2_mux ] = { . dt_id = TEGRA114_CLK_AUDIO2_MUX . present = true } [ tegra_clk_audio3_mux ] = { . dt_id = TEGRA114_CLK_AUDIO3_MUX . present = true } [ tegra_clk_audio4_mux ] = { . dt_id = TEGRA114_CLK_AUDIO4_MUX . present = true } [ tegra_clk_spdif_mux ] = { . dt_id = TEGRA114_CLK_SPDIF_MUX . present = true } [ tegra_clk_dsia_mux ] = { . dt_id = TEGRA114_CLK_DSIA_MUX . present = true } [ tegra_clk_dsib_mux ] = { . dt_id = TEGRA114_CLK_DSIB_MUX . present = true } [ tegra_clk_cec ] = { . dt_id = TEGRA114_CLK_CEC . present = true } } ; static struct tegra_devclk devclks [ ] __initdata = { { . con_id = "clk_m" . dt_id = TEGRA114_CLK_CLK_M } { . con_id = "pll_ref" . dt_id = TEGRA114_CLK_PLL_REF } { . con_id = "clk_32k" . dt_id = TEGRA114_CLK_CLK_32K } { . con_id = "osc" . dt_id = TEGRA114_CLK_OSC } { . con_id = "osc_div2" . dt_id = TEGRA114_CLK_OSC_DIV2 } { . con_id = "osc_div4" . dt_id = TEGRA114_CLK_OSC_DIV4 } { . con_id = "pll_c" . dt_id = TEGRA114_CLK_PLL_C } { . con_id = "pll_c_out1" . dt_id = TEGRA114_CLK_PLL_C_OUT1 } { . con_id = "pll_c2" . dt_id = TEGRA114_CLK_PLL_C2 } { . con_id = "pll_c3" . dt_id = TEGRA114_CLK_PLL_C3 } { . con_id = "pll_p" . dt_id = TEGRA114_CLK_PLL_P } { . con_id = "pll_p_out1" . dt_id = TEGRA114_CLK_PLL_P_OUT1 } { . con_id = "pll_p_out2" . dt_id = TEGRA114_CLK_PLL_P_OUT2 } { . con_id = "pll_p_out3" . dt_id = TEGRA114_CLK_PLL_P_OUT3 } { . con_id = "pll_p_out4" . dt_id = TEGRA114_CLK_PLL_P_OUT4 } { . con_id = "pll_m" . dt_id = TEGRA114_CLK_PLL_M } { . con_id = "pll_m_out1" . dt_id = TEGRA114_CLK_PLL_M_OUT1 } { . con_id = "pll_x" . dt_id = TEGRA114_CLK_PLL_X } { . con_id = "pll_x_out0" . dt_id = TEGRA114_CLK_PLL_X_OUT0 } { . con_id = "pll_u" . dt_id = TEGRA114_CLK_PLL_U } { . con_id = "pll_u_480M" . dt_id = TEGRA114_CLK_PLL_U_480M } { . con_id = "pll_u_60M" . dt_id = TEGRA114_CLK_PLL_U_60M } { . con_id = "pll_u_48M" . dt_id = TEGRA114_CLK_PLL_U_48M } { . con_id = "pll_u_12M" . dt_id = TEGRA114_CLK_PLL_U_12M } { . con_id = "pll_d" . dt_id = TEGRA114_CLK_PLL_D } { . con_id = "pll_d_out0" . dt_id = TEGRA114_CLK_PLL_D_OUT0 } { . con_id = "pll_d2" . dt_id = TEGRA114_CLK_PLL_D2 } { . con_id = "pll_d2_out0" . dt_id = TEGRA114_CLK_PLL_D2_OUT0 } { . con_id = "pll_a" . dt_id = TEGRA114_CLK_PLL_A } { . con_id = "pll_a_out0" . dt_id = TEGRA114_CLK_PLL_A_OUT0 } { . con_id = "pll_re_vco" . dt_id = TEGRA114_CLK_PLL_RE_VCO } { . con_id = "pll_re_out" . dt_id = TEGRA114_CLK_PLL_RE_OUT } { . con_id = "pll_e_out0" . dt_id = TEGRA114_CLK_PLL_E_OUT0 } { . con_id = "spdif_in_sync" . dt_id = TEGRA114_CLK_SPDIF_IN_SYNC } { . con_id = "i2s0_sync" . dt_id = TEGRA114_CLK_I2S0_SYNC } { . con_id = "i2s1_sync" . dt_id = TEGRA114_CLK_I2S1_SYNC } { . con_id = "i2s2_sync" . dt_id = TEGRA114_CLK_I2S2_SYNC } { . con_id = "i2s3_sync" . dt_id = TEGRA114_CLK_I2S3_SYNC } { . con_id = "i2s4_sync" . dt_id = TEGRA114_CLK_I2S4_SYNC } { . con_id = "vimclk_sync" . dt_id = TEGRA114_CLK_VIMCLK_SYNC } { . con_id = "audio0" . dt_id = TEGRA114_CLK_AUDIO0 } { . con_id = "audio1" . dt_id = TEGRA114_CLK_AUDIO1 } { . con_id = "audio2" . dt_id = TEGRA114_CLK_AUDIO2 } { . con_id = "audio3" . dt_id = TEGRA114_CLK_AUDIO3 } { . con_id = "audio4" . dt_id = TEGRA114_CLK_AUDIO4 } { . con_id = "spdif" . dt_id = TEGRA114_CLK_SPDIF } { . con_id = "audio0_2x" . dt_id = TEGRA114_CLK_AUDIO0_2X } { . con_id = "audio1_2x" . dt_id = TEGRA114_CLK_AUDIO1_2X } { . con_id = "audio2_2x" . dt_id = TEGRA114_CLK_AUDIO2_2X } { . con_id = "audio3_2x" . dt_id = TEGRA114_CLK_AUDIO3_2X } { . con_id = "audio4_2x" . dt_id = TEGRA114_CLK_AUDIO4_2X } { . con_id = "spdif_2x" . dt_id = TEGRA114_CLK_SPDIF_2X } { . con_id = "extern1" . dt_id = TEGRA114_CLK_EXTERN1 } { . con_id = "extern2" . dt_id = TEGRA114_CLK_EXTERN2 } { . con_id = "extern3" . dt_id = TEGRA114_CLK_EXTERN3 } { . con_id = "cclk_g" . dt_id = TEGRA114_CLK_CCLK_G } { . con_id = "cclk_lp" . dt_id = TEGRA114_CLK_CCLK_LP } { . con_id = "sclk" . dt_id = TEGRA114_CLK_SCLK } { . con_id = "hclk" . dt_id = TEGRA114_CLK_HCLK } { . con_id = "pclk" . dt_id = TEGRA114_CLK_PCLK } { . con_id = "fuse" . dt_id = TEGRA114_CLK_FUSE } { . dev_id = "rtc-tegra" . dt_id = TEGRA114_CLK_RTC } { . dev_id = "timer" . dt_id = TEGRA114_CLK_TIMER } } ; static const char * mux_pllm_pllc2_c_c3_pllp_plla [ ] { "pll_m" "pll_c2" "pll_c" "pll_c3" "pll_p" "pll_a_out0" } ; ; static u32 mux_pllm_pllc2_c_c3_pllp_plla_idx [ ] { [ 0 ] = 0 [ 1 ] = 1 [ 2 ] = 2 [ 3 ] = 3 [ 4 ] = 4 [ 5 ] = 6 } ; ; static struct tegra_audio_clk_info tegra114_audio_plls [ ] { { "pll_a" & pll_a_params tegra_clk_pll_a "pll_p_out1" } } ; ; static struct clk * * clks ; static unsigned long osc_freq ; static unsigned long pll_ref_freq ; static void __init tegra114_fixed_clk_init ( void __iomem * clk_base ) { struct clk * clk ; clk = clk_register_fixed_rate ( NULL , "clk_32k" , NULL , 0 , 32768 ) ; } 