static void madera_gpio_set ( struct gpio_chip * chip , unsigned int offset , int value ) { struct madera_gpio * madera_gpio = gpiochip_get_data ( chip ) ; struct madera * madera = madera_gpio -> madera ; unsigned int reg_offset = 2 * offset ; unsigned int reg_val = value ?MADERA_GP1_LVL : 0 ; int ret ; ret = regmap_update_bits ( madera -> regmap , MADERA_GPIO1_CTRL_1 + reg_offset , MADERA_GP1_LVL_MASK , reg_val ) ; } 