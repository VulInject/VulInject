DEFUN ( , , "ipv6 nd prefix X:X::X:X/M (<0-4294967295>|infinite) " "(<0-4294967295>|infinite) (off-link|) (no-autoconfig|) (router-address|)" , "Interface IPv6 config commands\n" "Neighbor discovery\n" "Prefix information\n" "IPv6 prefix\n" "Valid lifetime in seconds\n" "Infinite valid lifetime\n" "Preferred lifetime in seconds\n" "Infinite preferred lifetime\n" "Do not use prefix for onlink determination\n" "Do not use prefix for autoconfiguration\n" "Set Router Address flag\n" ) { int i ; int ret ; int cursor = 1 ; struct interface * ifp ; struct zebra_if * zebra_if ; struct rtadv_prefix rp ; ifp = ( interface * ) vty -> index ; zebra_if = ifp -> info ; ret = str2prefix_ipv6 ( argv [ 0 ] , & rp . prefix ) ; if ( ! ret ) { vty_out ( vty , "Malformed IPv6 prefix%s" , VTY_NEWLINE ) ; return CMD_WARNING ; } apply_mask_ipv6 ( & rp . prefix ) ; rp . AdvOnLinkFlag = 1 ; rp . AdvAutonomousFlag = 1 ; rp . AdvRouterAddressFlag = 0 ; rp . AdvValidLifetime = RTADV_VALID_LIFETIME ; rp . AdvPreferredLifetime = RTADV_PREFERRED_LIFETIME ; if ( argc > 1 ) { if ( ( isdigit ( ( unsigned char ) argv [ 1 ] [ 0 ] ) ) || strncmp ( argv [ 1 ] , "i" , 1 ) == 0 ) { if ( strncmp ( argv [ 1 ] , "i" , 1 ) == 0 ) { rp . AdvValidLifetime = UINT32_MAX ; } else { rp . AdvValidLifetime = ( u_int32_t ) strtoll ( argv [ 1 ] , ( char * * ) NULL , 10 ) ; } if ( strncmp ( argv [ 2 ] , "i" , 1 ) == 0 ) { rp . AdvPreferredLifetime = UINT32_MAX ; } else { rp . AdvPreferredLifetime = ( u_int32_t ) strtoll ( argv [ 2 ] , ( char * * ) NULL , 10 ) ; } if ( rp . AdvPreferredLifetime > rp . AdvValidLifetime ) { vty_out ( vty , "Invalid preferred lifetime%s" , VTY_NEWLINE ) ; return CMD_WARNING ; } cursor = cursor + 2 ; } } rtadv_prefix_set ( zebra_if , & rp ) ; return CMD_SUCCESS ; } 