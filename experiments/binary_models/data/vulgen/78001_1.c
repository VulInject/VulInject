static snd_pcm_uframes_t snd_card_saa7134_capture_pointer ( struct snd_pcm_substream * substream ) { struct snd_pcm_runtime * runtime = substream -> runtime ; snd_card_saa7134_pcm_t * pcm = runtime -> private_data ; struct saa7134_dev * dev = pcm -> dev ; if ( dev -> dmasound . read_count ) { dev -> dmasound . read_count -= snd_pcm_lib_period_bytes ( substream ) ; dev -> dmasound . read_offset += snd_pcm_lib_period_bytes ( substream ) ; } return bytes_to_frames ( runtime , dev -> dmasound . read_offset ) ; } 