gen_conditional_branch ( , ) { enum cmp_type type = branch_type ; rtx cmp0 = branch_cmp [ 0 ] ; rtx cmp1 = branch_cmp [ 1 ] ; enum machine_mode mode ; rtx reg ; int invert ; rtx label1 , label2 ; switch ( type ) { case CMP_SI : case CMP_DI : mode = type == CMP_SI ?SImode : DImode ; invert = 0 ; if ( reg ) { cmp0 = reg ; cmp1 = const0_rtx ; test_code = NE ; } if ( GET_CODE ( cmp1 ) == CONST_INT && INTVAL ( cmp1 ) != 0 ) { cmp1 = force_reg ( mode , cmp1 ) ; } break ; case CMP_SF : case CMP_DF : reg = gen_reg_rtx ( CCmode ) ; emit_insn ( gen_rtx_SET ( VOIDmode , reg , gen_rtx_fmt_ee ( test_code == NE ?EQ : test_code , CCmode , cmp0 , cmp1 ) ) ) ; test_code = test_code == NE ?EQ : NE ; mode = CCmode ; cmp0 = reg ; cmp1 = const0_rtx ; invert = 0 ; break ; default : abort_with_insn ( gen_rtx_fmt_ee ( test_code , VOIDmode , cmp0 , cmp1 ) , "bad test" ) ; } label1 = gen_rtx_LABEL_REF ( VOIDmode , operands [ 0 ] ) ; label2 = pc_rtx ; if ( invert ) { label2 = label1 ; label1 = pc_rtx ; } emit_jump_insn ( gen_rtx_SET ( VOIDmode , pc_rtx , gen_rtx_IF_THEN_ELSE ( VOIDmode , gen_rtx_fmt_ee ( test_code , mode , cmp0 , cmp1 ) , label1 , label2 ) ) ) ; } 