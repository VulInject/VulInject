enum drm_mode_status amdgpu_dm_connector_mode_valid ( struct drm_connector * connector , struct drm_display_mode * mode ) { int result = MODE_ERROR ; struct dc_sink * dc_sink ; struct dc_stream_state * stream ; struct amdgpu_dm_connector * aconnector = to_amdgpu_dm_connector ( connector ) ; if ( aconnector -> base . force != DRM_FORCE_UNSPECIFIED && ! aconnector -> dc_em_sink ) { handle_edid_mgmt ( aconnector ) ; } dc_sink = to_amdgpu_dm_connector ( connector ) -> dc_sink ; if ( dc_sink == NULL && aconnector -> base . force != DRM_FORCE_ON_DIGITAL && aconnector -> base . force != DRM_FORCE_ON ) { DRM_ERROR ( "dc_sink is NULL!\n" ) ; fail } stream = create_validate_stream_for_sink ( aconnector , mode , NULL , NULL ) ; if ( stream ) { dc_stream_release ( stream ) ; result = MODE_OK ; } fail return result ; } 