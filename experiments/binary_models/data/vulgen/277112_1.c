int disable_uef_lib ( char * libname , boolean_t rndflag , boolean_t allflag , mechlist_t * marglist ) { uentry_t * puent ; int rc ; if ( libname == NULL ) { cryptoerror ( LOG_STDERR , gettext ( "internal error." ) ) ; cryptodebug ( "disable_uef_lib() - libname is NULL." ) ; return ( FAILURE ) ; } if ( ( puent = getent_uef ( libname ) ) == NULL ) { cryptoerror ( LOG_STDERR , gettext ( "%s does not exist." ) , libname ) ; return ( FAILURE ) ; } if ( allflag ) { puent -> policylist = NULL ; puent -> count = 0 ; puent -> flag_enabledlist = B_TRUE ; rc = SUCCESS ; } if ( marglist != NULL ) { if ( puent -> flag_enabledlist == B_TRUE ) { rc = update_policylist ( puent , marglist , DELETE_MODE ) ; } else { rc = update_policylist ( puent , marglist , ADD_MODE ) ; } } if ( ! rndflag ) { cryptoerror ( LOG_STDERR , gettext ( "internal error." ) ) ; cryptodebug ( "disable_uef_lib() - wrong arguments." ) ; return ( FAILURE ) ; } if ( rndflag ) { puent -> flag_norandom = B_TRUE ; } if ( rc == FAILURE ) { free_uentry ( puent ) ; return ( FAILURE ) ; } rc = update_pkcs11conf ( puent ) ; free_uentry ( puent ) ; return ( rc ) ; } 