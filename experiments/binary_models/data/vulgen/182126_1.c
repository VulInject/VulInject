static void program_grph_pixel_format ( struct dce_mem_input * dce_mi , enum surface_pixel_format format ) { uint32_t red_xbar = 0 , blue_xbar = 0 ; uint32_t grph_depth = 0 , grph_format = 0 ; uint32_t sign = 0 , floating ; if ( format == SURFACE_PIXEL_FORMAT_GRPH_ABGR8888 || format == SURFACE_PIXEL_FORMAT_GRPH_ABGR2101010 || format == SURFACE_PIXEL_FORMAT_GRPH_ABGR2101010_XR_BIAS || format == SURFACE_PIXEL_FORMAT_GRPH_ABGR16161616 || format == SURFACE_PIXEL_FORMAT_GRPH_ABGR16161616F ) { red_xbar = 2 ; blue_xbar = 2 ; } REG_SET_2 ( GRPH_SWAP_CNTL , 0 , GRPH_RED_CROSSBAR , red_xbar , GRPH_BLUE_CROSSBAR , blue_xbar ) ; switch ( format ) { case SURFACE_PIXEL_FORMAT_GRPH_PALETA_256_COLORS : grph_depth = 0 ; grph_format = 0 ; break ; case SURFACE_PIXEL_FORMAT_GRPH_ARGB1555 : grph_depth = 1 ; grph_format = 0 ; break ; case SURFACE_PIXEL_FORMAT_GRPH_RGB565 : grph_depth = 1 ; grph_format = 1 ; break ; case SURFACE_PIXEL_FORMAT_GRPH_ARGB8888 : case SURFACE_PIXEL_FORMAT_GRPH_ABGR8888 : grph_depth = 2 ; grph_format = 0 ; break ; case SURFACE_PIXEL_FORMAT_GRPH_ARGB2101010 : case SURFACE_PIXEL_FORMAT_GRPH_ABGR2101010 : case SURFACE_PIXEL_FORMAT_GRPH_ABGR2101010_XR_BIAS : grph_depth = 2 ; grph_format = 1 ; break ; case SURFACE_PIXEL_FORMAT_GRPH_ABGR16161616F : sign = 1 ; floating = 1 ; fallthrough ; case SURFACE_PIXEL_FORMAT_GRPH_ARGB16161616F : case SURFACE_PIXEL_FORMAT_GRPH_ARGB16161616 : case SURFACE_PIXEL_FORMAT_GRPH_ABGR16161616 : grph_depth = 3 ; grph_format = 0 ; break ; default : DC_ERR ( "unsupported grph pixel format" ) ; break ; } REG_UPDATE_2 ( GRPH_CONTROL , GRPH_DEPTH , grph_depth , GRPH_FORMAT , grph_format ) ; REG_UPDATE_4 ( PRESCALE_GRPH_CONTROL , GRPH_PRESCALE_SELECT , floating , GRPH_PRESCALE_R_SIGN , sign , GRPH_PRESCALE_G_SIGN , sign , GRPH_PRESCALE_B_SIGN , sign ) ; } 