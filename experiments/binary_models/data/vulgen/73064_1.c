void parse_numa_distance ( MachineState * ms , NumaDistOptions * dist , Error * * errp ) { uint16_t src = dist -> src ; uint16_t dst = dist -> dst ; uint8_t val = dist -> val ; NodeInfo * numa_info = ms -> numa_state -> nodes ; if ( src >= MAX_NODES || dst >= MAX_NODES ) { error_setg ( errp , "Parameter '%s' expects an integer between 0 and %d" , src >= MAX_NODES ?"src" : "dst" , MAX_NODES - 1 ) ; return ; } if ( ! numa_info [ src ] . present || ! numa_info [ dst ] . present ) { error_setg ( errp , "Source/Destination NUMA node is missing. " "Please use '-numa node' option to declare it first." ) ; return ; } if ( src == dst && val != NUMA_DISTANCE_MIN ) { error_setg ( errp , "Local distance of node %d should be %d." , src , NUMA_DISTANCE_MIN ) ; return ; } numa_info [ src ] . distance [ dst ] = val ; ms -> numa_state -> have_numa_distance = true ; } 