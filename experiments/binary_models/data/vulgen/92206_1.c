static void evrpc_schedule_request_closure ( void * arg , enum EVRPC_HOOK_RESULT hook_res ) { struct evrpc_request_wrapper * ctx = arg ; struct evhttp_connection * connection = ctx -> evcon ; struct evhttp_request * req = ctx -> req ; struct evrpc_pool * pool = ctx -> pool ; struct evrpc_status status ; char * uri = NULL ; int res = 0 ; if ( hook_res == EVRPC_TERMINATE ) { error } uri = evrpc_construct_uri ( ctx -> name ) ; if ( uri == NULL ) { error } if ( pool -> timeout > 0 ) { struct timeval tv ; evutil_timerclear ( & tv ) ; tv . tv_sec = pool -> timeout ; evtimer_add ( & ctx -> ev_timeout , & tv ) ; } res = evhttp_make_request ( connection , req , EVHTTP_REQ_POST , uri ) ; mm_free ( uri ) ; if ( res == - 1 ) { error } return ; error status . error = EVRPC_STATUS_ERR_UNSTARTED ; * ctx -> cb ( & status , ctx -> request , ctx -> reply , ctx -> cb_arg ) ; evrpc_request_wrapper_free ( ctx ) ; } 