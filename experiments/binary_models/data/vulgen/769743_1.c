int coresight_enable_path ( struct list_head * path , u32 mode , void * sink_data ) { int ret ; u32 type ; struct coresight_node * nd ; struct coresight_device * csdev , * parent , * child ; list_for_each_entry_reverse ( , , ) { csdev = nd -> csdev ; type = csdev -> type ; if ( type == CORESIGHT_DEV_TYPE_LINKSINK ) { type = ( csdev == coresight_get_sink ( path ) ) ?CORESIGHT_DEV_TYPE_SINK : CORESIGHT_DEV_TYPE_LINK ; } switch ( type ) { case CORESIGHT_DEV_TYPE_SINK : ret = coresight_enable_sink ( csdev , mode , sink_data ) ; if ( ret ) { out } break ; case CORESIGHT_DEV_TYPE_SOURCE : break ; case CORESIGHT_DEV_TYPE_LINK : parent = list_prev_entry ( nd , link ) -> csdev ; child = list_next_entry ( nd , link ) -> csdev ; ret = coresight_enable_link ( csdev , parent , child ) ; if ( ret ) { err } break ; default : err } } out return ret ; err coresight_disable_path_from ( path , nd ) ; out } 