for ( int i = 0 ; i < num_msg ; i ++ ) { uschar * arg ; switch ( msg [ i ] -> msg_style ) { case PAM_PROMPT_ECHO_ON : case PAM_PROMPT_ECHO_OFF : if ( ! ( arg = string_nextinlist ( & pam_args , & sep , NULL , 0 ) ) ) { arg = US "" ; pam_arg_ended = TRUE ; } reply [ i ] . resp = strdup ( ) ; reply [ i ] . resp_retcode = PAM_SUCCESS ; break ; case PAM_TEXT_INFO : case PAM_ERROR_MSG : reply [ i ] . resp_retcode = PAM_SUCCESS ; reply [ i ] . resp = NULL ; break ; default : pam_conv_had_error = TRUE ; return PAM_CONV_ERR ; } } * resp = reply ; return PAM_SUCCESS ; 