void Init_ossl_x509ext ( void ) { mOSSL = rb_define_module ( "OpenSSL" ) ; eOSSLError = rb_define_class_under ( mOSSL , "OpenSSLError" , rb_eStandardError ) ; mX509 = rb_define_module_under ( mOSSL , "X509" ) ; eX509ExtError = rb_define_class_under ( mX509 , "ExtensionError" , eOSSLError ) ; cX509ExtFactory = rb_define_class_under ( mX509 , "ExtensionFactory" , rb_cObject ) ; rb_define_alloc_func ( cX509ExtFactory , ossl_x509extfactory_alloc ) ; rb_define_method ( cX509ExtFactory , "initialize" , ossl_x509extfactory_initialize , - 1 ) ; rb_attr ( cX509ExtFactory , rb_intern ( "issuer_certificate" ) , 1 , 0 , Qfalse ) ; rb_attr ( cX509ExtFactory , rb_intern ( "subject_certificate" ) , 1 , 0 , Qfalse ) ; rb_attr ( cX509ExtFactory , rb_intern ( "subject_request" ) , 1 , 0 , Qfalse ) ; rb_attr ( cX509ExtFactory , rb_intern ( "crl" ) , 1 , 0 , Qfalse ) ; rb_attr ( cX509ExtFactory , rb_intern ( "config" ) , 1 , 1 , Qfalse ) ; rb_define_method ( cX509ExtFactory , "issuer_certificate=" , ossl_x509extfactory_set_issuer_cert , 1 ) ; rb_define_method ( cX509ExtFactory , "subject_certificate=" , ossl_x509extfactory_set_subject_cert , 1 ) ; rb_define_method ( cX509ExtFactory , "subject_request=" , ossl_x509extfactory_set_subject_req , 1 ) ; rb_define_method ( cX509ExtFactory , "crl=" , ossl_x509extfactory_set_crl , 1 ) ; rb_define_method ( cX509ExtFactory , "create_ext" , ossl_x509extfactory_create_ext , - 1 ) ; cX509Ext = rb_define_class_under ( mX509 , "Extension" , rb_cObject ) ; rb_define_alloc_func ( cX509Ext , ossl_x509ext_alloc ) ; rb_define_method ( cX509Ext , "initialize" , ossl_x509ext_initialize , - 1 ) ; rb_define_method ( cX509Ext , "initialize_copy" , ossl_x509ext_initialize_copy , 1 ) ; rb_define_method ( cX509Ext , "oid=" , ossl_x509ext_set_oid , 1 ) ; rb_define_method ( cX509Ext , "value=" , ossl_x509ext_set_value , 1 ) ; rb_define_method ( cX509Ext , "critical=" , ossl_x509ext_set_critical , 1 ) ; rb_define_method ( cX509Ext , "oid" , ossl_x509ext_get_oid , 0 ) ; rb_define_method ( cX509Ext , "value" , ossl_x509ext_get_value , 0 ) ; rb_define_method ( cX509Ext , "value_der" , ossl_x509ext_get_value_der , 0 ) ; rb_define_method ( cX509Ext , "critical?" , ossl_x509ext_get_critical , 0 ) ; } 