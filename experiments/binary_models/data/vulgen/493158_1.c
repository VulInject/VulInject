void notrace __sanitizer_cov_trace_pc ( void ) { struct task_struct * t ; unsigned long * area ; unsigned long ip = canonicalize_ip ( _RET_IP_ ) ; unsigned long pos ; t = current ; if ( ! check_kcov_mode ( KCOV_MODE_TRACE_PC , t ) ) { return ; } area = t -> kcov_area ; pos = READ_ONCE ( area [ 0 ] ) + 1 ; if ( likely ( pos < t -> kcov_size ) ) { WRITE_ONCE ( area [ 0 ] , pos ) ; area [ pos ] = ip ; } } 