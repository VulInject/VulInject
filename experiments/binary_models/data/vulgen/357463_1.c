void one_addr ( a ) krb5_address * a ; { struct sockaddr_storage ss ; int err ; char namebuf [ NI_MAXHOST ] ; memset ( & ss , 0 , sizeof ( ss ) ) ; switch ( a -> addrtype ) { case ADDRTYPE_INET : if ( a -> length != IPV4_ADDR_LEN ) { broken printf ( "broken address (type %d length %d)" , a -> addrtype , a -> length ) ; return ; } { struct sockaddr_in * sinp = ss2sin ( & ss ) ; sinp -> sin_family = AF_INET ; sinp -> sin_len = sizeof ( sockaddr_in ) ; memcpy ( & sinp -> sin_addr , a -> contents , IPV4_ADDR_LEN ) ; } break ; case ADDRTYPE_INET6 : { struct sockaddr_in6 * sin6p = ss2sin6 ( & ss ) ; sin6p -> sin6_family = AF_INET6 ; sin6p -> sin6_len = sizeof ( sockaddr_in6 ) ; memcpy ( & sin6p -> sin6_addr , a -> contents , IPV6_ADDR_LEN ) ; } break ; default : printf ( gettext ( "unknown addr type %d" ) , a -> addrtype ) ; return ; } namebuf [ 0 ] = 0 ; err = getnameinfo ( ss2sa ( & ss ) , socklen ( ss2sa ( & ss ) ) , namebuf , sizeof ( namebuf ) , 0 , 0 , no_resolve ?NI_NUMERICHOST : 0U ) ; if ( err ) { printf ( gettext ( "unprintable address (type %d, error %d %s)" ) , a -> addrtype , err , gai_strerror ( err ) ) ; return ; } printf ( "%s" , namebuf ) ; } 