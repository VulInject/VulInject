re -> fadeEndTime = le -> endTime ; if ( type == 999 ) { le -> startTime = cg . time ; le -> endTime = le -> startTime + 100 ; re -> fadeStartTime = le -> endTime - 100 ; re -> fadeEndTime = le -> endTime ; type = 1 ; isflyingdebris = qtrue ; } le -> lifeRate = 1.0 / ( le -> endTime - le -> startTime ) ; le -> leFlags = LEF_TUMBLE ; le -> bounceFactor = 0.4 ; le -> leMarkType = 0 ; VectorCopy ( origin , re -> origin ) ; AxisCopy ( axisDefault , re -> axis ) ; if ( type == 0 ) { if ( rval ) { re -> hModel = cgs . media . shardGlass1 ; } else { re -> hModel = cgs . media . shardGlass2 ; } } if ( type == 1 ) { if ( rval ) { re -> hModel = cgs . media . shardWood1 ; } else { re -> hModel = cgs . media . shardWood2 ; } } if ( type == 2 ) { if ( rval ) { re -> hModel = cgs . media . shardMetal1 ; } else { re -> hModel = cgs . media . shardMetal2 ; } } if ( type == 3 ) { if ( rval ) { re -> hModel = cgs . media . shardCeramic1 ; } else { re -> hModel = cgs . media . shardCeramic2 ; } } if ( type == 4 ) { rval = rand ( ) % 3 ; if ( rval == 1 ) { re -> hModel = cgs . media . shardRubble1 ; } if ( rval == 2 ) { re -> hModel = cgs . media . shardRubble2 ; } else { re -> hModel = cgs . media . shardRubble3 ; } } else { CG_Printf ( "CG_Debris has an unknown type\n" ) ; } if ( isflyingdebris ) { le -> pos . trType = TR_GRAVITY_LOW ; } else { le -> pos . trType = TR_GRAVITY ; } VectorCopy ( origin , le -> pos . trBase ) ; VectorNormalize ( dir ) ; VectorScale ( dir , 10 * howmany , le -> pos . trDelta ) ; le -> pos . trTime = cg . time ; le -> pos . trDelta [ 0 ] += ( ( random ( ) * 100 ) - 50 ) ; le -> pos . trDelta [ 1 ] += ( ( random ( ) * 100 ) - 50 ) ; if ( type ) { le -> pos . trDelta [ 2 ] = ( random ( ) * 200 ) + 100 ; } else { le -> pos . trDelta [ 2 ] = ( random ( ) * 100 ) + 50 ; } le -> angles . trType = TR_LINEAR ; le -> angles . trTime = cg . time ; le -> angles . trBase [ 0 ] = rand ( ) & 31 ; le -> angles . trBase [ 1 ] = rand ( ) & 31 ; le -> angles . trBase [ 2 ] = rand ( ) & 31 ; le -> angles . trDelta [ 0 ] = ( 100 + ( rand ( ) & 500 ) ) - 300 ; le -> angles . trDelta [ 1 ] = ( 100 + ( rand ( ) & 500 ) ) - 300 ; le -> angles . trDelta [ 2 ] = ( 100 + ( rand ( ) & 500 ) ) - 300 ; 