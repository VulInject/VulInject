static struct i2c_adapter * dumb_vga_retrieve_ddc ( struct device * dev ) { struct device_node * phandle , * remote ; struct i2c_adapter * ddc ; remote = of_graph_get_remote_node ( dev -> of_node , 1 , - 1 ) ; phandle = of_parse_phandle ( remote , "ddc-i2c-bus" , 0 ) ; of_node_put ( remote ) ; if ( ! phandle ) { return ERR_PTR ( - ENODEV ) ; } ddc = of_get_i2c_adapter_by_node ( phandle ) ; of_node_put ( phandle ) ; if ( ! ddc ) { return ERR_PTR ( - EPROBE_DEFER ) ; } return ddc ; } 