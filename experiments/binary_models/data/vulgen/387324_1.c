struct udevice * pfuze_common_init ( void ) { struct udevice * dev ; int ret ; unsigned int reg , dev_id , rev_id ; ret = pmic_get ( "pfuze100@8" , & dev ) ; dev_id = pmic_reg_read ( dev , PFUZE100_DEVICEID ) ; rev_id = pmic_reg_read ( dev , PFUZE100_REVID ) ; printf ( "PMIC: PFUZE100! DEV_ID=0x%x REV_ID=0x%x\n" , dev_id , rev_id ) ; reg = pmic_reg_read ( dev , PFUZE100_SW1ABSTBY ) ; reg &= ~ SW1x_STBY_MASK ; reg |= SW1x_0_975V ; pmic_reg_write ( dev , PFUZE100_SW1ABSTBY , reg ) ; reg = pmic_reg_read ( dev , PFUZE100_SW1ABCONF ) ; reg &= ~ SW1xCONF_DVSSPEED_MASK ; reg |= SW1xCONF_DVSSPEED_4US ; pmic_reg_write ( dev , PFUZE100_SW1ABCONF , reg ) ; reg = pmic_reg_read ( dev , PFUZE100_SW1CSTBY ) ; reg &= ~ SW1x_STBY_MASK ; reg |= SW1x_0_975V ; pmic_reg_write ( dev , PFUZE100_SW1CSTBY , reg ) ; reg = pmic_reg_read ( dev , PFUZE100_SW1CCONF ) ; reg &= ~ SW1xCONF_DVSSPEED_MASK ; reg |= SW1xCONF_DVSSPEED_4US ; pmic_reg_write ( dev , PFUZE100_SW1CCONF , reg ) ; return dev ; } 