bool id_ipseckey_allowed ( struct ike_sa * ike , enum ikev2_auth_method atype ) { const struct connection * c = ike -> sa . st_connection ; struct id id = c -> remote -> host . id ; if ( ! c -> remote -> host . config -> key_from_DNS_on_demand ) { return false ; } if ( c -> remote -> host . config -> auth == AUTH_RSASIG && ( id . kind == ID_FQDN || id_is_ipaddr ( & id ) ) ) { switch ( atype ) { case IKEv2_AUTH_RESERVED : case IKEv2_AUTH_DIGSIG : case IKEv2_AUTH_RSA : return true ; default : break ; } } return false ; } 