void mlx5e_ktls_handle_get_psv_completion ( struct mlx5e_icosq_wqe_info * wi , struct mlx5e_icosq * sq ) { struct mlx5e_ktls_rx_resync_buf * buf = wi -> tls_get_params . buf ; struct mlx5e_ktls_offload_context_rx * priv_rx ; struct mlx5e_ktls_rx_resync_ctx * resync ; u8 tracker_state , auth_state , * ctx ; struct device * dev ; u32 hw_seq ; priv_rx = buf -> priv_rx ; resync = & priv_rx -> resync ; dev = mlx5_core_dma_dev ( resync -> priv -> mdev ) ; dma_sync_single_for_cpu ( dev , buf -> dma_addr , PROGRESS_PARAMS_PADDED_SIZE , DMA_FROM_DEVICE ) ; ctx = buf -> progress . ctx ; tracker_state = MLX5_GET ( tls_progress_params , ctx , record_tracker_state ) ; auth_state = MLX5_GET ( tls_progress_params , ctx , auth_state ) ; if ( tracker_state != MLX5E_TLS_PROGRESS_PARAMS_RECORD_TRACKER_STATE_TRACKING || auth_state != MLX5E_TLS_PROGRESS_PARAMS_AUTH_STATE_NO_OFFLOAD ) { priv_rx -> rq_stats -> tls_resync_req_skip ++ ; out } hw_seq = MLX5_GET ( tls_progress_params , ctx , hw_resync_tcp_sn ) ; tls_offload_rx_resync_async_request_end ( priv_rx -> sk , cpu_to_be32 ( hw_seq ) ) ; priv_rx -> rq_stats -> tls_resync_req_end ++ ; out mlx5e_ktls_priv_rx_put ( priv_rx ) ; dma_unmap_single ( dev , buf -> dma_addr , PROGRESS_PARAMS_PADDED_SIZE , DMA_FROM_DEVICE ) ; kfree ( buf ) ; } 