RCSID ( "$Id$" ) ; kadm5_ret_t kadm5_c_rename_principal ( void * server_handle , krb5_principal source , krb5_principal target ) { kadm5_client_context * context = server_handle ; kadm5_ret_t ret ; krb5_storage * sp ; unsigned char buf [ 1024 ] ; int32_t tmp ; krb5_data reply ; ret = _kadm5_connect ( server_handle , 1 ) ; if ( ret ) { return ret ; } krb5_data_zero ( & reply ) ; sp = krb5_storage_from_mem ( buf , sizeof ( buf ) ) ; if ( sp == NULL ) { ret = krb5_enomem ( context -> context ) ; out_keep_error } ret = krb5_store_int32 ( sp , kadm_rename ) ; if ( ret ) { out } ret = krb5_store_principal ( sp , source ) ; if ( ret ) { out } ret = krb5_store_principal ( sp , target ) ; if ( ret ) { out } ret = _kadm5_client_send ( context , sp ) ; if ( ret ) { out_keep_error } ret = _kadm5_client_recv ( context , & reply ) ; if ( ret ) { out_keep_error } krb5_storage_free ( sp ) ; sp = krb5_storage_from_data ( & reply ) ; if ( sp == NULL ) { ret = krb5_enomem ( context -> context ) ; out_keep_error } ret = krb5_ret_int32 ( sp , & tmp ) ; if ( ret == 0 ) { ret = tmp ; } out krb5_clear_error_message ( context -> context ) ; out_keep_error krb5_storage_free ( sp ) ; return ret ; } 