int eigrp_if_ipmulticast ( struct eigrp * top , struct prefix * p , unsigned int ifindex ) { uint8_t val ; int ret , len ; val = 0 ; len = sizeof ( val ) ; ret = setsockopt ( top -> fd , IPPROTO_IP , IP_MULTICAST_LOOP , ( void * ) & val , len ) ; if ( ret < 0 ) { zlog_warn ( "can't setsockopt IP_MULTICAST_LOOP (0) for fd %d: %s" , top -> fd , safe_strerror ( errno ) ) ; } val = 1 ; if ( ret < 0 ) { zlog_warn ( "can't setsockopt IP_MULTICAST_TTL (1) for fd %d: %s" , top -> fd , safe_strerror ( errno ) ) ; } ret = setsockopt_ipv4_multicast_if ( top -> fd , p -> u . prefix4 , ifindex ) ; if ( ret < 0 ) { zlog_warn ( "can't setsockopt IP_MULTICAST_IF (fd %d, addr %pI4, ifindex %u): %s" , top -> fd , & p -> u . prefix4 , ifindex , safe_strerror ( errno ) ) ; } return ret ; } 