int skein_1024_update ( struct skein_1024_ctx * ctx , const u8 * msg , size_t msg_byte_cnt ) { size_t n ; skein_assert_ret ( ctx -> h . b_cnt <= SKEIN_1024_BLOCK_BYTES , SKEIN_FAIL ) ; if ( msg_byte_cnt + ctx -> h . b_cnt > SKEIN_1024_BLOCK_BYTES ) { if ( ctx -> h . b_cnt ) { n = SKEIN_1024_BLOCK_BYTES - ctx -> h . b_cnt ; if ( n ) { skein_assert ( n < msg_byte_cnt ) ; memcpy ( & ctx -> b [ ctx -> h . b_cnt ] , msg , n ) ; msg_byte_cnt -= n ; msg += n ; ctx -> h . b_cnt += n ; } skein_assert ( ctx -> h . b_cnt == SKEIN_1024_BLOCK_BYTES ) ; skein_1024_process_block ( ctx , ctx -> b , 1 , SKEIN_1024_BLOCK_BYTES ) ; ctx -> h . b_cnt = 0 ; } skein_assert ( ctx -> h . b_cnt == 0 ) ; } if ( msg_byte_cnt ) { skein_assert ( msg_byte_cnt + ctx -> h . b_cnt <= SKEIN_1024_BLOCK_BYTES ) ; memcpy ( & ctx -> b [ ctx -> h . b_cnt ] , msg , msg_byte_cnt ) ; ctx -> h . b_cnt += msg_byte_cnt ; } return SKEIN_SUCCESS ; } 