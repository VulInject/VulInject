int wc_ShaGetHash ( wc_Sha * sha , byte * hash ) { int ret ; wc_Sha tmpSha ; ! defined ( ) ; if ( sha -> ctx . mode == ESP32_SHA_INIT ) { esp_sha_try_hw_lock ( & sha -> ctx ) ; } if ( sha -> ctx . mode != ESP32_SHA_SW ) { esp_sha_digest_process ( sha , 0 ) ; } ret = wc_ShaCopy ( sha , & tmpSha ) ; if ( ret == 0 ) { ret = wc_ShaFinal ( & tmpSha , hash ) ; ! defined ( ) sha -> ctx . mode = ESP32_SHA_SW ; } return ret ; } 