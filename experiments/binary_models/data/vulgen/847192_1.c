static unsigned long maple_find_nvram_base ( void ) { struct device_node * rtcs ; unsigned long result = 0 ; rtcs = of_find_compatible_node ( NULL , "nvram" , "AMD8111" ) ; if ( rtcs ) { struct resource r ; if ( of_address_to_resource ( rtcs , 0 , & r ) ) { printk ( KERN_EMERG "Maple: Unable to translate NVRAM" " address\n" ) ; bail } if ( ! ( r . flags & IORESOURCE_IO ) ) { printk ( KERN_EMERG "Maple: NVRAM address isn't PIO!\n" ) ; bail } result = r . start ; } else { printk ( KERN_EMERG "Maple: Unable to find NVRAM\n" ) ; } bail return result ; } 