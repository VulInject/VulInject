void proto_reg_handoff_mbrtu ( void ) { dissector_handle_t mbrtu_udp_handle = create_dissector_handle ( dissect_mbrtu_udp , proto_mbrtu ) ; dissector_add_for_decode_as_with_preference ( "udp.port" , mbrtu_udp_handle ) ; dissector_add_for_decode_as_with_preference ( "tcp.port" , mbrtu_handle ) ; apply_mbrtu_prefs ( ) ; dissector_add_uint ( "mbtcp.prot_id" , MODBUS_PROTOCOL_ID , modbus_handle ) ; dissector_add_for_decode_as ( "rtacser.data" , mbrtu_handle ) ; dissector_add_for_decode_as ( "usb.device" , mbrtu_handle ) ; dissector_add_for_decode_as ( "usb.product" , mbrtu_handle ) ; } 