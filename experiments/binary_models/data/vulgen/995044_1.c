void rt2x00debug_register ( struct rt2x00_dev * rt2x00dev ) { const struct rt2x00debug * debug = rt2x00dev -> ops -> debugfs ; struct rt2x00debug_intf * intf ; struct dentry * queue_folder ; struct dentry * register_folder ; intf = kzalloc ( sizeof ( rt2x00debug_intf ) , GFP_KERNEL ) ; intf -> debug = debug ; intf -> rt2x00dev = rt2x00dev ; rt2x00dev -> debugfs_intf = intf ; intf -> driver_folder = debugfs_create_dir ( intf -> rt2x00dev -> ops -> name , rt2x00dev -> hw -> wiphy -> debugfsdir ) ; rt2x00debug_create_file_driver ( "driver" , intf , & intf -> driver_blob ) ; rt2x00debug_create_file_chipset ( "chipset" , intf , & intf -> chipset_blob ) ; debugfs_create_file ( "dev_flags" , 0400 , intf -> driver_folder , intf , & rt2x00debug_fop_dev_flags ) ; debugfs_create_file ( "cap_flags" , 0400 , intf -> driver_folder , intf , & rt2x00debug_fop_cap_flags ) ; debugfs_create_file ( "restart_hw" , 0200 , intf -> driver_folder , intf , & rt2x00debug_restart_hw ) ; register_folder = debugfs_create_dir ( "register" , intf -> driver_folder ) ; ( { if ( debug -> __name . read ) { debugfs_create_u32 ( __stringify ( __name ) "_offset" , 0600 , register_folder , & ( __intf ) -> offset_ # # __name ) ; debugfs_create_file ( __stringify ( __name ) "_value" , 0600 , register_folder , ( __intf ) , & rt2x00debug_fop_ # # __name ) ; ; } } ; } 