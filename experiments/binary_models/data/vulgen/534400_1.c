static void priv_dispatch_engine ( struct imsgproc * proc , struct imsg * imsg , void * arg ) { const char * prn ; if ( imsg == NULL ) { fatalx ( "%s: imsg connection lost" , __func__ ) ; } switch ( imsg -> hdr . type ) { case IMSG_LPR_PRINTJOB : m_get_string ( proc , & prn ) ; m_end ( proc ) ; priv_run_printer ( prn ) ; break ; default : fatalx ( "%s: unexpected imsg %s" , __func__ , log_fmt_imsgtype ( imsg -> hdr . type ) ) ; } } 