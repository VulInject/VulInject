Derived from the BSD Telnet Kerberos checksum routine . See also PR * void abort ( void ) ; extern void exit ( int ) int type32 long type32 type32 cksum ( const unsigned char * src , unsigned long size ) { type32 ck ; switch ( size & 3 ) { while ( size > 0 ) { case 0 : ck ^= ( type32 ) * src ++ << 24 ; -- size ; case 3 : ck ^= ( type32 ) * src ++ << 16 ; -- size ; case 2 : ck ^= ( type32 ) * src ++ << 8 ; -- size ; case 1 : ck ^= ( type32 ) * src ++ ; -- size ; } } return ck ; } 