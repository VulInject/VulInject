static HostnameValidationResult matches_common_name ( const char * hostname , const X509 * server_cert ) { int common_name_loc = - 1 ; X509_NAME_ENTRY * common_name_entry = NULL ; ASN1_STRING * common_name_asn1 = NULL ; if ( common_name_loc < 0 ) { return Error ; } common_name_entry = X509_NAME_get_entry ( X509_get_subject_name ( ( X509 * ) server_cert ) , common_name_loc ) ; if ( common_name_entry == NULL ) { return Error ; } common_name_asn1 = X509_NAME_ENTRY_get_data ( common_name_entry ) ; if ( common_name_asn1 == NULL ) { return Error ; } return validate_name ( hostname , common_name_asn1 ) ; } 