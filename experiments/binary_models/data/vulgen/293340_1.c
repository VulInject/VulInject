static int pm8058_pwrkey_shutdown ( struct pmic8xxx_pwrkey * pwrkey , bool reset ) { int error ; struct regmap * regmap = pwrkey -> regmap ; u8 mask , val ; if ( ! reset ) { pm8058_disable_smps_locally_set_pull_down ( regmap , PM8058_S0_CTRL , PM8058_S0_TEST2 , REG_PM8058_VREG_EN_MSM , BIT ( 7 ) ) ; pm8058_disable_smps_locally_set_pull_down ( regmap , PM8058_S1_CTRL , PM8058_S1_TEST2 , REG_PM8058_VREG_EN_MSM , BIT ( 6 ) ) ; pm8058_disable_smps_locally_set_pull_down ( regmap , PM8058_S3_CTRL , PM8058_S3_TEST2 , REG_PM8058_VREG_EN_GRP_5_4 , BIT ( 7 ) | BIT ( 4 ) ) ; pm8058_disable_ldo_locally_set_pull_down ( regmap , PM8058_L21_CTRL , REG_PM8058_VREG_EN_GRP_5_4 , BIT ( 1 ) ) ; } error = regmap_update_bits ( regmap , PM8058_L22_CTRL , 0xbf , 0x93 ) ; if ( error ) { return error ; } mask = SLEEP_CTRL_SMPL_EN_RESET ; val = 0 ; return regmap_update_bits ( regmap , PM8058_SLEEP_CTRL , mask , val ) ; } 