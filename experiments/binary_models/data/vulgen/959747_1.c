void rt2x00lib_disable_radio ( struct rt2x00_dev * rt2x00dev ) { if ( ! test_and_clear_bit ( DEVICE_STATE_ENABLED_RADIO , & rt2x00dev -> flags ) ) { return ; } rt2x00link_stop_watchdog ( rt2x00dev ) ; rt2x00link_stop_tuner ( rt2x00dev ) ; rt2x00queue_stop_queues ( rt2x00dev ) ; rt2x00queue_flush_queues ( rt2x00dev , true ) ; rt2x00dev -> ops -> lib -> set_device_state ( rt2x00dev , STATE_RADIO_OFF ) ; rt2x00dev -> ops -> lib -> set_device_state ( rt2x00dev , STATE_RADIO_IRQ_OFF ) ; rt2x00led_led_activity ( rt2x00dev , false ) ; } 