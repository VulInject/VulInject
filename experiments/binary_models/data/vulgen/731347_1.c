tic54x_get_insn ( , , , ) { const template * tm = NULL ; for ( tm = tic54x_optab ; tm -> name ; tm ++ ) { if ( tm -> opcode == ( memdata & tm -> mask ) ) { if ( tm -> flags & FL_EXT ) { bfd_vma addr2 = addr + 1 + has_lkaddr ( memdata , tm ) ; int status = * info -> read_memory_func ( addr2 , opbuf , 2 , info ) ; if ( status == 0 ) { unsigned short data2 = bfd_getl16 ( opbuf ) ; if ( tm -> opcode2 == ( data2 & tm -> mask2 ) ) { if ( size ) { * size = get_insn_size ( memdata , tm ) ; } return tm ; } } } else { if ( size ) { * size = get_insn_size ( memdata , tm ) ; } return tm ; } } } for ( tm = ( * ; tm -> name ; tm ++ ) { if ( tm -> opcode == ( memdata & tm -> mask ) ) { if ( size ) { * size = get_insn_size ( memdata , tm ) ; } return tm ; } } if ( size ) { * size = 1 ; } return & tic54x_unknown_opcode ; } 