( inet_proto_csum_replace16 ) ; void inet_proto_csum_replace_by_diff ( __sum16 * sum , struct sk_buff * skb , __wsum diff , bool pseudohdr ) { if ( skb -> ip_summed != CHECKSUM_PARTIAL ) { * sum = csum_fold ( csum_add ( diff , ~csum_unfold ( * sum ) ) ) ; } if ( pseudohdr ) { * sum = ~ csum_fold ( csum_add ( diff , csum_unfold ( * sum ) ) ) ; } } 