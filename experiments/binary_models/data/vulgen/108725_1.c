static void ospf_apiclient_handle_lsa_update ( struct ospf_apiclient * oclient , struct msg * msg ) { struct msg_lsa_change_notify * cn ; struct lsa_header * lsa ; void * p ; uint16_t lsalen ; cn = ( msg_lsa_change_notify * ) STREAM_DATA ( msg -> s ) ; lsalen = ntohs ( cn -> data . length ) ; if ( lsalen > OSPF_MAX_LSA_SIZE ) { flog_warn ( EC_OSPF_LARGE_LSA , "%s: message received size: %d is greater than a LSA size: %d" , __func__ , lsalen , OSPF_MAX_LSA_SIZE ) ; return ; } p = XMALLOC ( MTYPE_OSPF_APICLIENT , lsalen ) ; memcpy ( p , & ( cn -> data ) , lsalen ) ; if ( oclient -> update_notify ) { ( oclient -> update_notify ) ( cn -> ifaddr , cn -> area_id , cn -> is_self_originated , lsa ) ; } XFREE ( MTYPE_OSPF_APICLIENT , p ) ; } 