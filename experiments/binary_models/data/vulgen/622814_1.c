static int max98357a_daiops_trigger ( struct snd_pcm_substream * substream , int cmd , struct snd_soc_dai * dai ) { struct snd_soc_component * component = dai -> component ; struct max98357a_priv * max98357a = snd_soc_component_get_drvdata ( component ) ; switch ( cmd ) { case SNDRV_PCM_TRIGGER_START : case SNDRV_PCM_TRIGGER_RESUME : case SNDRV_PCM_TRIGGER_PAUSE_RELEASE : mdelay ( max98357a -> sdmode_delay ) ; if ( max98357a -> sdmode_switch ) { gpiod_set_value ( max98357a -> sdmode , 1 ) ; dev_dbg ( component -> dev , "set sdmode to 1" ) ; } break ; case SNDRV_PCM_TRIGGER_STOP : case SNDRV_PCM_TRIGGER_SUSPEND : case SNDRV_PCM_TRIGGER_PAUSE_PUSH : gpiod_set_value ( max98357a -> sdmode , 0 ) ; dev_dbg ( component -> dev , "set sdmode to 0" ) ; break ; } return 0 ; } 