void carp_update_lsmask ( struct carp_softc * sc ) { struct carp_vhost_entry * vhe ; int count ; sc -> sc_lsmask = 0 ; count = 0 ; KERNEL_ASSERT_LOCKED ( ) ; SRPL_FOREACH_LOCKED ( , , ) { if ( vhe -> state == MASTER && count < sizeof ( sc -> sc_lsmask ) * 8 ) { sc -> sc_lsmask |= 1 << count ; } count ++ ; } sc -> sc_lscount = count ; CARP_LOG ( LOG_DEBUG , sc , ( "carp_update_lsmask: %x" , sc -> sc_lsmask ) ) ; } 