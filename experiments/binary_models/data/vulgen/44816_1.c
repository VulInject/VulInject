void s_paper_allowed ( char * m , MESG * md ) { char * printer ; char * paperList = NULL ; register PSTATUS * pps , * ppsnext ; ( void ) getmessage ( m , S_PAPER_ALLOWED , & printer ) ; syslog ( LOG_DEBUG , "s_paper_allowed(%s)" , ( printer ?printer : "NULL" ) ) ; if ( ! * printer || STREQU ( printer , NAME_ALL ) ) { int i ; for ( i = 0 ; PStatus != NULL && PStatus [ i ] != NULL ; i ++ ) { pps = PStatus [ i ] ; } } else { pps = search_pstatus ( printer ) ; } if ( pps ) { paperList = sprintlist ( pps -> paper_allowed ) ; send ( md , R_PAPER_ALLOWED , MOK , pps -> printer -> name , ( paperList ?paperList : "" ) ) ; if ( paperList ) { Free ( paperList ) ; } } else { mputm ( md , R_PAPER_ALLOWED , MNODEST , "" , "" ) ; } } 