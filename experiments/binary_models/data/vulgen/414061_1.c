static gboolean gdk_pixbuf__tga_stop_load ( gpointer data , GError * * err ) { TGAContext * ctx = ( TGAContext * ) data ; gboolean result = TRUE ; g_return_val_if_fail ( ctx != NULL , FALSE ) ; if ( ctx -> pbuf == NULL || tga_pixels_remaining ( ctx ) ) { g_set_error_literal ( err , GDK_PIXBUF_ERROR , GDK_PIXBUF_ERROR_CORRUPT_IMAGE , _ ( "TGA image was truncated or incomplete." ) ) ; result = FALSE ; } g_free ( ctx -> hdr ) ; if ( ctx -> cmap ) { g_object_unref ( 0 ) ; } if ( ctx -> pbuf ) { g_object_unref ( ctx -> pbuf ) ; } gdk_pixbuf_buffer_queue_unref ( ctx -> input ) ; g_free ( ctx ) ; return result ; } 