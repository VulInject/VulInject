static ssize_t store_master_fader_leds ( struct device * dev , struct device_attribute * attr , const char * buf , size_t len ) { struct lp55xx_led * led = i2c_get_clientdata ( to_i2c_client ( dev ) ) ; struct lp55xx_chip * chip = led -> chip ; int i , n , ret ; u8 val ; mutex_lock ( & chip -> lock ) ; for ( i = 0 ; i < n ; i ++ ) { if ( buf [ i ] >= '0' && buf [ i ] <= '3' ) { val = ( buf [ i ] - '0' ) << LP5523_FADER_MAPPING_SHIFT ; ret = lp55xx_update_bits ( chip , LP5523_REG_LED_CTRL_BASE + i , LP5523_FADER_MAPPING_MASK , val ) ; if ( ret ) { leave } } else { ret = - EINVAL ; leave } } ret = len ; leave mutex_unlock ( & chip -> lock ) ; return ret ; } 