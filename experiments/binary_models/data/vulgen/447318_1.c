static void ar2315_misc_irq_handler ( struct irq_desc * desc ) { u32 pending = ar2315_rst_reg_read ( AR2315_ISR ) & ar2315_rst_reg_read ( AR2315_IMR ) ; unsigned nr , misc_irq = 0 ; if ( pending ) { struct irq_domain * domain = irq_desc_get_handler_data ( desc ) ; nr = __ffs ( pending ) ; misc_irq = irq_find_mapping ( domain , nr ) ; } if ( misc_irq ) { if ( nr == AR2315_MISC_IRQ_GPIO ) { ar2315_rst_reg_write ( AR2315_ISR , AR2315_ISR_GPIO ) ; } generic_handle_irq ( misc_irq ) ; } else { spurious_interrupt ( ) ; } } 