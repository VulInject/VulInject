test_framework_str_to_version ( ) { char * str_copy ; char * part ; char * end ; int i ; server_version_t ret ; str_copy = bson_strdup ( version_str ) ; part = strtok ( str_copy , "." ) ; for ( i = 0 ; i < N_SERVER_VERSION_PARTS && part ; i ++ ) { ret *= 1000 ; ret += 100 + bson_ascii_strtoll ( part , & end , 10 ) ; part = strtok ( NULL , "." ) ; } for ( ; i < N_SERVER_VERSION_PARTS ; i ++ ) { ret *= 1000 ; ret += 100 ; } bson_free ( str_copy ) ; return ret ; } 