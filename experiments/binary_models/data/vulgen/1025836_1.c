int main ( int argc ATTRIBUTE_UNUSED , char * * argv ATTRIBUTE_UNUSED ) { int ret = 0 ; int old_errors , old_tests , old_leaks ; if ( logfile == NULL ) { fprintf ( stderr , "Could not open the log file, running in verbose mode\n" ) ; verbose = 1 ; } initializeLibxml2 ( ) ; if ( ( argc >= 2 ) && ( ! strcmp ( argv [ 1 ] , "-v" ) ) ) { verbose = 1 ; } old_errors = nb_errors ; old_tests = nb_tests ; old_leaks = nb_leaks ; xsdTest ( ) ; printf ( "Ran %d tests, %d errors, %d leaks\n" , nb_tests - old_tests , nb_errors - old_errors , nb_leaks - old_leaks ) ; if ( nb_errors - old_errors == 10 ) { printf ( "10 errors were expected\n" ) ; nb_errors = old_errors ; } else { printf ( "10 errors were expected, got %d errors\n" , nb_errors - old_errors ) ; nb_errors = old_errors + 1 ; } old_errors = nb_errors ; old_tests = nb_tests ; old_leaks = nb_leaks ; rngTest1 ( ) ; if ( ( nb_errors == old_errors ) && ( nb_leaks == old_leaks ) ) { printf ( "Ran %d tests, no errors\n" , nb_tests - old_tests ) ; } else { printf ( "Ran %d tests, %d errors, %d leaks\n" , nb_tests - old_tests , nb_errors - old_errors , nb_leaks - old_leaks ) ; } old_errors = nb_errors ; old_tests = nb_tests ; old_leaks = nb_leaks ; rngTest2 ( ) ; if ( ( nb_errors == old_errors ) && ( nb_leaks == old_leaks ) ) { printf ( "Ran %d tests, no errors\n" , nb_tests - old_tests ) ; } else { printf ( "Ran %d tests, %d errors, %d leaks\n" , nb_tests - old_tests , nb_errors - old_errors , nb_leaks - old_leaks ) ; } old_errors = nb_errors ; old_tests = nb_tests ; old_leaks = nb_leaks ; nb_internals = 0 ; nb_schematas = 0 ; xstcMetadata ( "xstc/Tests/Metadata/NISTXMLSchemaDatatypes.testSet" , "xstc/Tests/Metadata/" ) ; if ( ( nb_errors == old_errors ) && ( nb_leaks == old_leaks ) ) { printf ( "Ran %d tests (%d schemata), no errors\n" , nb_tests - old_tests , nb_schematas ) ; } else { printf ( "Ran %d tests (%d schemata), %d errors (%d internals), %d leaks\n" , nb_tests - old_tests , nb_schematas , nb_errors - old_errors , nb_internals , nb_leaks - old_leaks ) ; } old_errors = nb_errors ; old_tests = nb_tests ; old_leaks = nb_leaks ; nb_internals = 0 ; nb_schematas = 0 ; xstcMetadata ( "xstc/Tests/Metadata/SunXMLSchema1-0-20020116.testSet" , "xstc/Tests/" ) ; if ( ( nb_errors == old_errors ) && ( nb_leaks == old_leaks ) ) { printf ( "Ran %d tests (%d schemata), no errors\n" , nb_tests - old_tests , nb_schematas ) ; } else { printf ( "Ran %d tests (%d schemata), %d errors (%d internals), %d leaks\n" , nb_tests - old_tests , nb_schematas , nb_errors - old_errors , nb_internals , nb_leaks - old_leaks ) ; printf ( "Some errors were expected.\n" ) ; nb_errors = old_errors ; } old_errors = nb_errors ; old_tests = nb_tests ; old_leaks = nb_leaks ; nb_internals = 0 ; nb_schematas = 0 ; xstcMetadata ( "xstc/Tests/Metadata/MSXMLSchema1-0-20020116.testSet" , "xstc/Tests/" ) ; if ( ( nb_errors == old_errors ) && ( nb_leaks == old_leaks ) ) { printf ( "Ran %d tests (%d schemata), no errors\n" , nb_tests - old_tests , nb_schematas ) ; } else { printf ( "Ran %d tests (%d schemata), %d errors (%d internals), %d leaks\n" , nb_tests - old_tests , nb_schematas , nb_errors - old_errors , nb_internals , nb_leaks - old_leaks ) ; printf ( "Some errors were expected.\n" ) ; nb_errors = old_errors ; } if ( ( nb_errors == 0 ) && ( nb_leaks == 0 ) ) { ret = 0 ; printf ( "Total %d tests, no errors\n" , nb_tests ) ; } else { ret = 1 ; printf ( "Total %d tests, %d errors, %d leaks\n" , nb_tests , nb_errors , nb_leaks ) ; } xmlXPathFreeContext ( ctxtXPath ) ; xmlCleanupParser ( ) ; xmlMemoryDump ( ) ; if ( logfile != NULL ) { fclose ( logfile ) ; } return ( ret ) ; } 