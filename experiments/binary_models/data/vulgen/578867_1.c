static unichar_t * AskSetting ( struct macsettingname * temp , GGadget * list , int index , GGadget * flist ) { GRect pos ; GWindow gw ; GWindowAttrs wattrs ; GGadgetCreateData gcd [ 17 ] ; GTextInfo label [ 17 ] ; struct setdata sd ; char buf [ 20 ] ; unichar_t ubuf3 [ 6 ] ; int32_t len , i ; GTextInfo * * ti ; memset ( & sd , 0 , sizeof ( sd ) ) ; sd . list = list ; sd . flist = flist ; sd . index = index ; memset ( & wattrs , 0 , sizeof ( wattrs ) ) ; wattrs . mask = wam_events | wam_cursor | wam_utf8_wtitle | wam_undercursor | wam_restrict | wam_isdlg ; wattrs . event_masks = ~ ( 1 << et_charup ) ; wattrs . restrict_input_to_me = 1 ; wattrs . is_dlg = 1 ; wattrs . undercursor = 1 ; wattrs . cursor = ct_pointer ; wattrs . utf8_window_title = _ ( "Mapping" ) ; pos . x = pos . y = 0 ; pos . width = GGadgetScale ( GDrawPointsToPixels ( NULL , 240 ) ) ; pos . height = GDrawPointsToPixels ( NULL , 120 ) ; gw = GDrawCreateTopWindow ( NULL , & pos , set_e_h , & sd , & wattrs ) ; sd . gw = gw ; memset ( gcd , 0 , sizeof ( gcd ) ) ; memset ( label , 0 , sizeof ( label ) ) ; label [ 0 ] . text = ( unichar_t * ) _ ( "_Feature:" ) ; label [ 0 ] . text_is_1byte = true ; label [ 0 ] . text_in_resource = true ; gcd [ 0 ] . gd . label = & label [ 0 ] ; gcd [ 0 ] . gd . pos . x = 5 ; gcd [ 0 ] . gd . pos . y = 5 + 4 ; gcd [ 0 ] . gd . flags = gg_enabled | gg_visible ; gcd [ 0 ] . creator = GLabelCreate ; gcd [ 1 ] . gd . pos . x = 50 ; gcd [ 1 ] . gd . pos . y = 5 ; gcd [ 1 ] . gd . pos . width = 170 ; gcd [ 1 ] . gd . flags = gg_enabled | gg_visible ; gcd [ 1 ] . creator = GListButtonCreate ; label [ 2 ] . text = ( unichar_t * ) _ ( "Setting" ) ; label [ 2 ] . text_is_1byte = true ; gcd [ 2 ] . gd . label = & label [ 2 ] ; gcd [ 2 ] . gd . pos . x = 5 ; gcd [ 2 ] . gd . pos . y = gcd [ 0 ] . gd . pos . y + 26 ; gcd [ 2 ] . gd . flags = gg_enabled | gg_visible ; gcd [ 2 ] . creator = GLabelCreate ; sprintf ( buf , "%d" , temp -> mac_feature_setting ) ; label [ 3 ] . text = ( unichar_t * ) buf ; label [ 3 ] . text_is_1byte = true ; gcd [ 3 ] . gd . label = & label [ 3 ] ; gcd [ 3 ] . gd . pos . x = gcd [ 1 ] . gd . pos . x ; gcd [ 3 ] . gd . pos . y = gcd [ 2 ] . gd . pos . y - 4 ; gcd [ 3 ] . gd . pos . width = 50 ; gcd [ 3 ] . gd . flags = gg_enabled | gg_visible ; gcd [ 3 ] . creator = GTextFieldCreate ; label [ 4 ] . text = ( unichar_t * ) _ ( "_Tag:" ) ; label [ 4 ] . text_is_1byte = true ; label [ 4 ] . text_in_resource = true ; gcd [ 4 ] . gd . label = & label [ 4 ] ; gcd [ 4 ] . gd . pos . x = 5 ; gcd [ 4 ] . gd . pos . y = gcd [ 3 ] . gd . pos . y + 26 ; gcd [ 4 ] . gd . flags = gg_enabled | gg_visible ; gcd [ 4 ] . creator = GLabelCreate ; ubuf3 [ 0 ] = temp -> otf_tag >> 24 ; ubuf3 [ 1 ] = ( temp -> otf_tag >> 16 ) & 0xff ; ubuf3 [ 2 ] = ( temp -> otf_tag >> 8 ) & 0xff ; ubuf3 [ 3 ] = temp -> otf_tag & 0xff ; ubuf3 [ 4 ] = 0 ; label [ 5 ] . text = ubuf3 ; gcd [ 5 ] . gd . label = & label [ 5 ] ; gcd [ 5 ] . gd . pos . x = gcd [ 3 ] . gd . pos . x ; gcd [ 5 ] . gd . pos . y = gcd [ 4 ] . gd . pos . y - 4 ; gcd [ 5 ] . gd . pos . width = 50 ; gcd [ 5 ] . gd . flags = gg_enabled | gg_visible ; gcd [ 5 ] . creator = GTextFieldCreate ; gcd [ 6 ] . gd . pos . x = 13 - 3 ; gcd [ 6 ] . gd . pos . y = gcd [ 5 ] . gd . pos . y + 30 ; gcd [ 6 ] . gd . pos . width = - 1 ; gcd [ 6 ] . gd . pos . height = 0 ; gcd [ 6 ] . gd . flags = gg_visible | gg_enabled | gg_but_default ; label [ 6 ] . text = ( unichar_t * ) _ ( "_OK" ) ; label [ 6 ] . text_is_1byte = true ; label [ 6 ] . text_in_resource = true ; gcd [ 6 ] . gd . label = & label [ 6 ] ; gcd [ 6 ] . creator = GButtonCreate ; gcd [ 7 ] . gd . pos . x = - 13 ; gcd [ 7 ] . gd . pos . y = gcd [ 7 - 1 ] . gd . pos . y + 3 ; gcd [ 7 ] . gd . pos . width = - 1 ; gcd [ 7 ] . gd . pos . height = 0 ; gcd [ 7 ] . gd . flags = gg_visible | gg_enabled | gg_but_cancel ; label [ 7 ] . text = ( unichar_t * ) _ ( "_Cancel" ) ; label [ 7 ] . text_is_1byte = true ; label [ 7 ] . text_in_resource = true ; gcd [ 7 ] . gd . label = & label [ 7 ] ; gcd [ 7 ] . creator = GButtonCreate ; GGadgetsCreate ( gw , gcd ) ; sd . feature = gcd [ 1 ] . ret ; sd . set_code = gcd [ 3 ] . ret ; sd . otf = gcd [ 5 ] . ret ; sd . ok = gcd [ 6 ] . ret ; sd . cancel = gcd [ 7 ] . ret ; ti = GGadgetGetList ( flist , & len ) ; GGadgetSetList ( sd . feature , ti , true ) ; for ( i = 0 ; i < len ; ++ i ) { int val = u_strtol ( ti [ i ] -> text , NULL , 10 ) ; } GDrawSetVisible ( gw , true ) ; GWidgetIndicateFocusGadget ( gcd [ 1 ] . ret ) ; while ( ! sd . done ) { GDrawProcessOneEvent ( NULL ) ; } GDrawDestroyWindow ( gw ) ; return ( sd . ret ) ; } 