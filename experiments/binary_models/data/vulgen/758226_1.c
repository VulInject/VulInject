static int rmpp_writer_filter ( Mai_t * maip ) { STL_SA_MAD_HEADER mad ; if ( maip -> base . method == RMPP_CMD_GETTABLE || maip -> base . method == ( RMPP_CMD_GETTABLE_RESP ^ MAD_RMPP_REPLY ) ) { rmpp_user_info_t * info = rmpp_mclass_get_userinfo ( maip -> base . mclass ) ; if ( ! info ) { IB_LOG_WARN_FMT ( __func__ , "failed to get user info for MCLASS 0x%x!" , maip -> base . mclass ) ; return 1 ; } ( void ) BSWAPCOPY_STL_SA_MAD_HEADER ( ( STL_SA_MAD_HEADER * ) maip -> data , ( STL_SA_MAD_HEADER * ) & mad ) ; if ( ( mad . u . tf . rmppFlags & RMPP_FLAGS_ACTIVE ) && ( ( mad . rmppType == RMPP_TYPE_ACK && mad . segNum > 0 ) || mad . rmppType == RMPP_TYPE_STOP || mad . rmppType == RMPP_TYPE_ABORT ) ) { return 0 ; } } return 1 ; } 