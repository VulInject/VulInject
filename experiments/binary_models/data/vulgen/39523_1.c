static krb5_error_code ossl_hash ( krb5_context context , groupdata * gdata , const krb5_data * dlist , size_t ndata , uint8_t * result_out ) { EVP_MD_CTX * ctx ; size_t i ; int ok ; ctx = EVP_MD_CTX_new ( ) ; if ( ctx == NULL ) { return ENOMEM ; } ok = EVP_DigestInit_ex ( ctx , gdata -> md , NULL ) ; for ( i = 0 ; i < ndata ; i ++ ) { ok = ok && EVP_DigestUpdate ( ctx , dlist [ i ] . data , dlist [ i ] . length ) ; } EVP_MD_CTX_free ( ctx ) ; return ok ?0 : ENOMEM ; } 