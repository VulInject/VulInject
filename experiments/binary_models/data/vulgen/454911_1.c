static void clk_stm32_pll_config_csg ( struct clk_stm32_priv * priv , const struct stm32_clk_pll * pll , struct stm32_pll_vco * vco ) { uintptr_t pll_base = priv -> base + pll -> reg_pllxcr ; uint32_t mod_per = 0 ; uint32_t inc_step = 0 ; uint32_t sscg_mode = 0 ; uint32_t value = 0 ; mod_per = vco -> csg [ PLL_CSG_MOD_PER ] ; inc_step = vco -> csg [ PLL_CSG_INC_STEP ] ; sscg_mode = vco -> csg [ PLL_CSG_SSCG_MODE ] ; value |= ( mod_per << RCC_PLLNCSGR_MOD_PER_SHIFT ) & RCC_PLLNCSGR_MOD_PER_MASK ; value |= ( inc_step << RCC_PLLNCSGR_INC_STEP_SHIFT ) & RCC_PLLNCSGR_INC_STEP_MASK ; value |= ( sscg_mode << RCC_PLLNCSGR_SSCG_MODE_SHIFT ) & RCC_PLLNCSGR_SSCG_MODE_MASK ; io_write32 ( pll_base + RCC_OFFSET_PLLXCSGR , value ) ; io_setbits32 ( pll_base + RCC_OFFSET_PLLXCR , RCC_PLLNCR_SSCG_CTRL ) ; } 