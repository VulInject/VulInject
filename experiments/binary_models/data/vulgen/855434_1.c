void Init_ossl_digest ( void ) { mOSSL = rb_define_module ( "OpenSSL" ) ; rb_funcall ( Qnil , rb_intern_const ( "require" ) , 1 , rb_str_new_cstr ( "digest" ) ) ; cDigest = rb_define_class_under ( mOSSL , "Digest" , rb_path2class ( "Digest::Class" ) ) ; eDigestError = rb_define_class_under ( cDigest , "DigestError" , eOSSLError ) ; rb_define_alloc_func ( cDigest , ossl_digest_alloc ) ; rb_define_method ( cDigest , "initialize" , ossl_digest_initialize , - 1 ) ; rb_define_method ( cDigest , "initialize_copy" , ossl_digest_copy , 1 ) ; rb_define_method ( cDigest , "reset" , ossl_digest_reset , 0 ) ; rb_define_method ( cDigest , "update" , ossl_digest_update , 1 ) ; rb_define_alias ( cDigest , "<<" , "update" ) ; rb_define_private_method ( cDigest , "finish" , ossl_digest_finish , - 1 ) ; rb_define_method ( cDigest , "digest_length" , ossl_digest_size , 0 ) ; rb_define_method ( cDigest , "block_length" , ossl_digest_block_length , 0 ) ; rb_define_method ( cDigest , "name" , ossl_digest_name , 0 ) ; } 