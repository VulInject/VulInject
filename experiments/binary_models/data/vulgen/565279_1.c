static int send_full_color_rect ( VncState * vs , int x , int y , int w , int h ) { int stream = 0 ; ssize_t bytes ; vnc_write_u8 ( vs , stream << 4 ) ; if ( vs -> tight -> pixel24 ) { tight_pack24 ( vs , vs -> tight -> tight . buffer , w * h , & vs -> tight -> tight . offset ) ; bytes = 3 ; } else { bytes = vs -> client_pf . bytes_per_pixel ; } bytes = tight_compress_data ( vs , stream , w * h * bytes , tight_conf [ vs -> tight -> compression ] . raw_zlib_level , Z_DEFAULT_STRATEGY ) ; return ( bytes >= 0 ) ; } 