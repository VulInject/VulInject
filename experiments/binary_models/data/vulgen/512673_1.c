integer f_clos ( cllist * a ) { unit * b ; if ( a -> cunit >= MXUNIT ) { return ( 0 ) ; } b = & f__units [ a -> cunit ] ; if ( b -> ufd == NULL ) { done } if ( b -> uscrtch == 1 ) { Delete } if ( ! a -> csta ) { Keep } switch ( * a -> csta ) { default : Keep case 'k' : case 'K' : if ( b -> uwrt == 1 ) { t_runc ( ( alist * ) a ) ; } if ( b -> ufnm ) { fclose ( b -> ufd ) ; free ( b -> ufnm ) ; } break ; case 'd' : case 'D' : Delete fclose ( b -> ufd ) ; if ( b -> ufnm ) { unlink ( b -> ufnm ) ; free ( b -> ufnm ) ; } } b -> ufd = NULL ; done b -> ufnm = NULL ; return ( 0 ) ; } void f_exit ( ) f_exit ( void ) ( int i , static cllist xx , ( ! xx . cerr ) { xx . cerr = 1 xx . csta = NULL for ( i = 0 ; i < MXUNIT ; i ++ ) { xx . cunit = i ( void ) f_clos ( & xx ) } ; } ) ; 