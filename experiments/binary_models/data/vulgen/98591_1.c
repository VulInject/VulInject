static void release_spnego_ctx ( spnego_gss_ctx_id_t * ctx ) { spnego_gss_ctx_id_t context ; OM_uint32 minor_stat ; context = * ctx ; if ( context != NULL ) { ( void ) gss_release_buffer ( & minor_stat , & context -> DER_mechTypes ) ; ( void ) generic_gss_release_oid ( & minor_stat , & context -> internal_mech ) ; if ( context -> optionStr != NULL ) { free ( context -> optionStr ) ; context -> optionStr = NULL ; } * ctx = NULL ; } } 