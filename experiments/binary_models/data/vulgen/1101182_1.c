void gtt_write_workarounds ( struct intel_gt * gt ) { struct drm_i915_private * i915 = gt -> i915 ; struct intel_uncore * uncore = gt -> uncore ; if ( IS_BROADWELL ( i915 ) ) { intel_uncore_write ( uncore , GEN8_L3_LRA_1_GPGPU , GEN8_L3_LRA_1_GPGPU_DEFAULT_VALUE_BDW ) ; } if ( IS_CHERRYVIEW ( i915 ) ) { intel_uncore_write ( uncore , GEN8_L3_LRA_1_GPGPU , GEN8_L3_LRA_1_GPGPU_DEFAULT_VALUE_CHV ) ; } if ( IS_GEN9_LP ( i915 ) ) { intel_uncore_write ( uncore , GEN8_L3_LRA_1_GPGPU , GEN9_L3_LRA_1_GPGPU_DEFAULT_VALUE_BXT ) ; } if ( GRAPHICS_VER ( i915 ) >= 9 && GRAPHICS_VER ( i915 ) <= 11 ) { intel_uncore_write ( uncore , GEN8_L3_LRA_1_GPGPU , GEN9_L3_LRA_1_GPGPU_DEFAULT_VALUE_SKL ) ; } if ( IS_GRAPHICS_VER ( i915 , 8 , 11 ) ) { bool can_use_gtt_cache = true ; if ( HAS_PAGE_SIZES ( i915 , I915_GTT_PAGE_SIZE_2M ) ) { can_use_gtt_cache = false ; } intel_uncore_write ( uncore , HSW_GTT_CACHE_EN , can_use_gtt_cache ?GTT_CACHE_EN_ALL : 0 ) ; gt_WARN_ON_ONCE ( gt , can_use_gtt_cache && intel_uncore_read ( uncore , HSW_GTT_CACHE_EN ) == 0 ) ; } } 