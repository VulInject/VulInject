GSSAPI_LIB_FUNCTION OM_uint32 GSSAPI_LIB_CALL gss_oid_to_str ( OM_uint32 * minor_status , gss_OID oid , gss_buffer_t oid_str ) { int ret ; size_t size ; heim_oid o ; char * p ; _mg_buffer_zero ( oid_str ) ; if ( oid == GSS_C_NULL_OID ) { return GSS_S_FAILURE ; } ret = der_get_oid ( oid -> elements , oid -> length , & o , & size ) ; if ( ret ) { * minor_status = ret ; return GSS_S_FAILURE ; } ret = der_print_heim_oid ( & o , ' ' , & p ) ; if ( ret ) { * minor_status = ret ; return GSS_S_FAILURE ; } oid_str -> value = p ; oid_str -> length = strlen ( p ) ; * minor_status = 0 ; return GSS_S_COMPLETE ; } 