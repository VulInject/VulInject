static int __init sm_smsc47m1_init ( void ) { int err ; unsigned short address ; struct smsc47m1_sio_data sio_data ; err = smsc47m1_find ( & sio_data ) ; address = err ; err = smsc47m1_device_add ( address , & sio_data ) ; if ( err ) { return err ; } err = platform_driver_probe ( & smsc47m1_driver , smsc47m1_probe ) ; if ( err ) { exit_device } return 0 ; exit_device platform_device_unregister ( pdev ) ; smsc47m1_restore ( & sio_data ) ; return err ; } 