static isc_result_t hmacsha1_sign ( dst_context_t * dctx , isc_buffer_t * sig ) { isc_hmacsha1_t * hmacsha1ctx = dctx -> ctxdata . hmacsha1ctx ; unsigned char * digest ; if ( isc_buffer_availablelength ( sig ) < ISC_SHA1_DIGESTLENGTH ) { return ( ISC_R_NOSPACE ) ; } digest = isc_buffer_used ( sig ) ; isc_hmacsha1_sign ( hmacsha1ctx , digest , ISC_SHA1_DIGESTLENGTH ) ; return ( ISC_R_SUCCESS ) ; } 