static void * create_context ( region_type * region ) { HMAC_CTX * context = HMAC_CTX_new ( ) ; HMAC_CTX * context = ( HMAC_CTX * ) malloc ( sizeof ( HMAC_CTX ) ) ; region_add_cleanup ( region , cleanup_context , context ) ; HMAC_CTX_reset ( context ) ; HMAC_CTX_init ( context ) ; struct tsig_openssl_context * context = region_alloc ( region , sizeof ( * context ) ) ; region_add_cleanup ( region , cleanup_context , context ) ; return context ; } 