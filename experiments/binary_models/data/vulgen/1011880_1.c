static void leaf_define_dest_src_infos ( int shift_mode , struct tree_balance * tb , struct buffer_info * dest_bi , struct buffer_info * src_bi , int * first_last , struct buffer_head * Snew ) { memset ( dest_bi , 0 , sizeof ( buffer_info ) ) ; memset ( src_bi , 0 , sizeof ( buffer_info ) ) ; switch ( shift_mode ) { case LEAF_FROM_S_TO_L : src_bi -> tb = tb ; src_bi -> bi_bh = PATH_PLAST_BUFFER ( tb -> tb_path ) ; src_bi -> bi_parent = PATH_H_PPARENT ( tb -> tb_path , 0 ) ; src_bi -> bi_position = PATH_H_B_ITEM_ORDER ( tb -> tb_path , 0 ) ; dest_bi -> tb = tb ; dest_bi -> bi_bh = tb -> L [ 0 ] ; dest_bi -> bi_parent = tb -> FL [ 0 ] ; dest_bi -> bi_position = get_left_neighbor_position ( tb , 0 ) ; * first_last = FIRST_TO_LAST ; break ; case LEAF_FROM_S_TO_R : src_bi -> tb = tb ; src_bi -> bi_bh = PATH_PLAST_BUFFER ( tb -> tb_path ) ; src_bi -> bi_parent = PATH_H_PPARENT ( tb -> tb_path , 0 ) ; src_bi -> bi_position = PATH_H_B_ITEM_ORDER ( tb -> tb_path , 0 ) ; dest_bi -> tb = tb ; dest_bi -> bi_bh = tb -> R [ 0 ] ; dest_bi -> bi_parent = tb -> FR [ 0 ] ; dest_bi -> bi_position = get_right_neighbor_position ( tb , 0 ) ; * first_last = LAST_TO_FIRST ; break ; case LEAF_FROM_R_TO_L : src_bi -> tb = tb ; src_bi -> bi_bh = tb -> R [ 0 ] ; src_bi -> bi_parent = tb -> FR [ 0 ] ; src_bi -> bi_position = get_right_neighbor_position ( tb , 0 ) ; dest_bi -> tb = tb ; dest_bi -> bi_bh = tb -> L [ 0 ] ; dest_bi -> bi_parent = tb -> FL [ 0 ] ; dest_bi -> bi_position = get_left_neighbor_position ( tb , 0 ) ; * first_last = FIRST_TO_LAST ; break ; case LEAF_FROM_L_TO_R : src_bi -> tb = tb ; src_bi -> bi_bh = tb -> L [ 0 ] ; src_bi -> bi_parent = tb -> FL [ 0 ] ; src_bi -> bi_position = get_left_neighbor_position ( tb , 0 ) ; dest_bi -> tb = tb ; dest_bi -> bi_bh = tb -> R [ 0 ] ; dest_bi -> bi_parent = tb -> FR [ 0 ] ; dest_bi -> bi_position = get_right_neighbor_position ( tb , 0 ) ; * first_last = LAST_TO_FIRST ; break ; case LEAF_FROM_S_TO_SNEW : src_bi -> tb = tb ; src_bi -> bi_bh = PATH_PLAST_BUFFER ( tb -> tb_path ) ; src_bi -> bi_parent = PATH_H_PPARENT ( tb -> tb_path , 0 ) ; src_bi -> bi_position = PATH_H_B_ITEM_ORDER ( tb -> tb_path , 0 ) ; dest_bi -> tb = tb ; dest_bi -> bi_bh = Snew ; dest_bi -> bi_parent = NULL ; dest_bi -> bi_position = 0 ; * first_last = LAST_TO_FIRST ; break ; default : reiserfs_panic ( sb_from_bi ( src_bi ) , "vs-10250" , "shift type is unknown (%d)" , shift_mode ) ; } } 