static nss_status_t netgr_set ( struct files_backend * be , void * a ) { struct nss_setnetgrent_args * args = ( nss_setnetgrent_args * ) a ; struct files_getnetgr_be * get_be ; nss_status_t res ; get_be = malloc ( sizeof ( * get_be ) ) ; if ( get_be == NULL ) { return ( NSS_UNAVAIL ) ; } get_be -> all_members = NULL ; res = top_down ( be , & args -> netgroup , 1 , save_triple , & get_be -> all_members ) ; if ( res == NSS_SUCCESS ) { get_be -> ops = getnetgr_ops ; get_be -> n_ops = ARRAY_SIZE ( getnetgr_ops ) ; get_be -> netgroup = strdup ( args -> netgroup ) ; if ( get_be -> netgroup == NULL ) { args -> iterator = NULL ; free ( get_be ) ; return ( NSS_UNAVAIL ) ; } args -> iterator = ( nss_backend_t * ) get_be ; } else { args -> iterator = NULL ; free ( get_be ) ; } return ( res ) ; } 