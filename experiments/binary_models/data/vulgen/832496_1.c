TmEcode NapatechStreamThreadInit ( ThreadVars * tv , const void * initdata , void * * data ) { SCEnter ( ) ; struct NapatechStreamDevConf * conf = ( NapatechStreamDevConf * ) initdata ; uint16_t stream_id = conf -> stream_id ; * data = NULL ; NapatechThreadVars * ntv = SCCalloc ( 1 , sizeof ( NapatechThreadVars ) ) ; if ( unlikely ( ntv == NULL ) ) { FatalError ( "Failed to allocate memory for NAPATECH  thread vars." ) ; } ntv -> stream_id = stream_id ; ntv -> tv = tv ; ntv -> hba = conf -> hba ; DatalinkSetGlobalType ( LINKTYPE_ETHERNET ) ; SCLogDebug ( "Started processing packets from NAPATECH  Stream: %lu" , ntv -> stream_id ) ; * data = ( void * ) ntv ; SCReturnInt ( TM_ECODE_OK ) ; } 