static void hrm_getblk ( int chunk ) { struct hrmstat * hrm , * l ; int i ; int hrm_incr ; if ( ( hrm_blist == NULL ) || ( hrm_blist_num <= hrm_blist_lowater ) || ( chunk && ( hrm_blist_num < chunk + hrm_blist_incr ) ) ) { mutex_exit ( & hat_statlock ) ; hrm_incr = chunk + hrm_blist_incr ; hrm = kmem_zalloc ( sizeof ( hrmstat ) * hrm_incr , KM_SLEEP ) ; hrm -> hrm_base = sizeof ( hrmstat ) * hrm_incr ; mutex_enter ( & hat_statlock ) ; hrm -> hrm_hnext = hrm_memlist ; hrm_memlist = hrm ; hrm_blist_total += ( hrm_incr - 1 ) ; for ( i = 1 ; i < hrm_incr ; i ++ ) { l = & hrm [ i ] ; l -> hrm_hnext = hrm_blist ; hrm_blist = l ; hrm_blist_num ++ ; } } mutex_exit ( & hat_statlock ) ; } 