static void __init exynos5x_clk_init ( struct device_node * np , enum exynos5x_soc soc ) { struct samsung_clk_provider * ctx ; struct clk_hw * * hws ; if ( np ) { reg_base = of_iomap ( np , 0 ) ; if ( ! reg_base ) { panic ( "%s: failed to map registers\n" , __func__ ) ; } } else { panic ( "%s: unable to determine soc\n" , __func__ ) ; } exynos5x_soc = soc ; ctx = samsung_clk_init ( np , reg_base , CLK_NR_CLKS ) ; hws = ctx -> clk_data . hws ; samsung_clk_of_register_fixed_ext ( ctx , exynos5x_fixed_rate_ext_clks , ARRAY_SIZE ( exynos5x_fixed_rate_ext_clks ) , ext_clk_match ) ; if ( clk_hw_get_rate ( hws [ CLK_FIN_PLL ] ) == 24 * MHZ ) { exynos5x_plls [ apll ] . rate_table = exynos5420_pll2550x_24mhz_tbl ; exynos5x_plls [ epll ] . rate_table = exynos5420_epll_24mhz_tbl ; exynos5x_plls [ kpll ] . rate_table = exynos5420_pll2550x_24mhz_tbl ; exynos5x_plls [ vpll ] . rate_table = exynos5420_vpll_24mhz_tbl ; } if ( soc == EXYNOS5420 ) { exynos5x_plls [ bpll ] . rate_table = exynos5420_pll2550x_24mhz_tbl ; } else { exynos5x_plls [ bpll ] . rate_table = exynos5422_bpll_rate_table ; } samsung_clk_register_pll ( ctx , exynos5x_plls , ARRAY_SIZE ( exynos5x_plls ) , reg_base ) ; samsung_clk_register_fixed_rate ( ctx , exynos5x_fixed_rate_clks , ARRAY_SIZE ( exynos5x_fixed_rate_clks ) ) ; samsung_clk_register_fixed_factor ( ctx , exynos5x_fixed_factor_clks , ARRAY_SIZE ( exynos5x_fixed_factor_clks ) ) ; samsung_clk_register_mux ( ctx , exynos5x_mux_clks , ARRAY_SIZE ( exynos5x_mux_clks ) ) ; samsung_clk_register_div ( ctx , exynos5x_div_clks , ARRAY_SIZE ( exynos5x_div_clks ) ) ; samsung_clk_register_gate ( ctx , exynos5x_gate_clks , ARRAY_SIZE ( exynos5x_gate_clks ) ) ; if ( soc == EXYNOS5420 ) { samsung_clk_register_mux ( ctx , exynos5420_mux_clks , ARRAY_SIZE ( exynos5420_mux_clks ) ) ; samsung_clk_register_div ( ctx , exynos5420_div_clks , ARRAY_SIZE ( exynos5420_div_clks ) ) ; samsung_clk_register_gate ( ctx , exynos5420_gate_clks , ARRAY_SIZE ( exynos5420_gate_clks ) ) ; } else { samsung_clk_register_fixed_factor ( ctx , exynos5800_fixed_factor_clks , ARRAY_SIZE ( exynos5800_fixed_factor_clks ) ) ; samsung_clk_register_mux ( ctx , exynos5800_mux_clks , ARRAY_SIZE ( exynos5800_mux_clks ) ) ; samsung_clk_register_div ( ctx , exynos5800_div_clks , ARRAY_SIZE ( exynos5800_div_clks ) ) ; samsung_clk_register_gate ( ctx , exynos5800_gate_clks , ARRAY_SIZE ( exynos5800_gate_clks ) ) ; } if ( soc == EXYNOS5420 ) { samsung_clk_register_cpu ( ctx , exynos5420_cpu_clks , ARRAY_SIZE ( exynos5420_cpu_clks ) ) ; } else { samsung_clk_register_cpu ( ctx , exynos5800_cpu_clks , ARRAY_SIZE ( exynos5800_cpu_clks ) ) ; } samsung_clk_extended_sleep_init ( reg_base , exynos5x_clk_regs , ARRAY_SIZE ( exynos5x_clk_regs ) , exynos5420_set_clksrc , ARRAY_SIZE ( exynos5420_set_clksrc ) ) ; else { exynos5_subcmus_init ( ctx , ARRAY_SIZE ( exynos5x_subcmus ) , exynos5x_subcmus ) ; } clk_prepare_enable ( hws [ CLK_MOUT_SW_ACLK_G3D ] -> clk ) ; clk_prepare_enable ( hws [ CLK_MOUT_BPLL ] -> clk ) ; samsung_clk_of_add_provider ( np , ctx ) ; } 