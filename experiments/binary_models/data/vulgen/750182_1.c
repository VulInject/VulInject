int qede_alloc_arfs ( struct qede_dev * edev ) { int i ; edev -> arfs = vzalloc ( sizeof ( * edev -> arfs ) ) ; if ( ! edev -> arfs ) { return - ENOMEM ; } for ( i = 0 ; i <= QEDE_RFS_FLW_MASK ; i ++ ) { INIT_HLIST_HEAD ( & edev -> arfs -> arfs_hl_head [ i ] ) ; } edev -> ndev -> rx_cpu_rmap = alloc_irq_cpu_rmap ( QEDE_RSS_COUNT ( edev ) ) ; if ( ! edev -> ndev -> rx_cpu_rmap ) { vfree ( edev -> arfs ) ; edev -> arfs = NULL ; return - ENOMEM ; } edev -> arfs -> arfs_fltr_bmap = vzalloc ( BITS_TO_LONGS ( QEDE_RFS_MAX_FLTR ) * sizeof ( long ) ) ; if ( ! edev -> arfs -> arfs_fltr_bmap ) { free_irq_cpu_rmap ( edev -> ndev -> rx_cpu_rmap ) ; edev -> ndev -> rx_cpu_rmap = NULL ; vfree ( edev -> arfs ) ; edev -> arfs = NULL ; return - ENOMEM ; } return 0 ; } 