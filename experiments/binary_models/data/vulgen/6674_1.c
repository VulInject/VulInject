static void dissect_q933_channel_identification_ie ( tvbuff_t * tvb , int offset , int len , proto_tree * tree ) { guint8 octet ; int identifier_offset ; int identifier_len ; guint8 coding_standard ; octet = tvb_get_guint8 ( tvb , offset ) ; proto_tree_add_item ( tree , hf_q933_interface_identified , tvb , offset , 1 , ENC_NA ) ; proto_tree_add_item ( tree , hf_q933_interface_basic , tvb , offset , 1 , ENC_NA ) ; proto_tree_add_item ( tree , hf_q933_indicated_channel_required , tvb , offset , 1 , ENC_NA ) ; proto_tree_add_item ( tree , hf_q933_indicated_channel_d_channel , tvb , offset , 1 , ENC_NA ) ; if ( octet & Q933_NOT_BASIC_CHANNEL ) { proto_tree_add_item ( tree , hf_q933_not_channel_selection , tvb , offset , 1 , ENC_BIG_ENDIAN ) ; } else { proto_tree_add_item ( tree , hf_q933_channel_selection , tvb , offset , 1 , ENC_BIG_ENDIAN ) ; } offset += 1 ; len -= 1 ; if ( octet & Q933_INTERFACE_IDENTIFIED ) { identifier_offset = offset ; identifier_len = 0 ; { if ( len == 0 ) { break ; } octet = tvb_get_guint8 ( tvb , offset ) ; offset += 1 ; len -= 1 ; identifier_len ++ ; } ! ( octet & Q933_IE_VL_EXTENSION ) ; if ( identifier_len != 0 ) { proto_tree_add_item ( tree , hf_q933_interface_identifier , tvb , identifier_offset , identifier_len , ENC_NA ) ; } } if ( octet & Q933_NOT_BASIC_CHANNEL ) { if ( len == 0 ) { return ; } octet = tvb_get_guint8 ( tvb , offset ) ; coding_standard = octet & 0x60 ; proto_tree_add_uint ( tree , hf_q933_coding_standard , tvb , offset , 1 , octet ) ; if ( coding_standard != Q933_ITU_STANDARDIZED_CODING ) { proto_tree_add_item ( tree , hf_q933_data , tvb , offset , len , ENC_NA ) ; return ; } proto_tree_add_item ( tree , hf_q933_channel_indicated_by , tvb , offset , 1 , ENC_NA ) ; proto_tree_add_item ( tree , ( octet & Q933_IS_SLOT_MAP ) ?hf_q933_map_element_type : hf_q933_channel_type , tvb , offset , 1 , ENC_NA ) ; } } 