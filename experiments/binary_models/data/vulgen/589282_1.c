static int rockusb_add ( struct usb_configuration * c ) { struct f_rockusb * f_rkusb = get_rkusb ( ) ; int status ; debug ( "%s: cdev: 0x%p\n" , __func__ , c -> cdev ) ; f_rkusb -> usb_function . name = "f_rockusb" ; f_rkusb -> usb_function . bind = rockusb_bind ; f_rkusb -> usb_function . unbind = rockusb_unbind ; f_rkusb -> usb_function . set_alt = rockusb_set_alt ; f_rkusb -> usb_function . disable = rockusb_disable ; f_rkusb -> usb_function . strings = rkusb_strings ; status = usb_add_function ( c , & f_rkusb -> usb_function ) ; if ( status ) { free ( f_rkusb -> buf_head ) ; free ( f_rkusb ) ; } return status ; } 