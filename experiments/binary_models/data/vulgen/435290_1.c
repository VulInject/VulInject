static void update_pvclock_gtod ( struct timekeeper * tk ) { struct pvclock_gtod_data * vdata = & pvclock_gtod_data ; write_seqcount_begin ( & vdata -> seq ) ; vdata -> clock . vclock_mode = tk -> tkr_mono . clock -> vdso_clock_mode ; vdata -> clock . cycle_last = tk -> tkr_mono . cycle_last ; vdata -> clock . mask = tk -> tkr_mono . mask ; vdata -> clock . mult = tk -> tkr_mono . mult ; vdata -> clock . shift = tk -> tkr_mono . shift ; vdata -> clock . base_cycles = tk -> tkr_mono . xtime_nsec ; vdata -> clock . offset = tk -> tkr_mono . base ; vdata -> raw_clock . vclock_mode = tk -> tkr_raw . clock -> vdso_clock_mode ; vdata -> raw_clock . cycle_last = tk -> tkr_raw . cycle_last ; vdata -> raw_clock . mask = tk -> tkr_raw . mask ; vdata -> raw_clock . mult = tk -> tkr_raw . mult ; vdata -> raw_clock . shift = tk -> tkr_raw . shift ; vdata -> raw_clock . base_cycles = tk -> tkr_raw . xtime_nsec ; vdata -> raw_clock . offset = tk -> tkr_raw . base ; vdata -> offs_boot = tk -> offs_boot ; write_seqcount_end ( & vdata -> seq ) ; } 