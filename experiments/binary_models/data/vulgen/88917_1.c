static int inflate_block ( BGZF * fp , int block_length ) { z_stream zs ; zs . zalloc = NULL ; zs . zfree = NULL ; zs . next_in = fp -> compressed_block + 18 ; zs . avail_in = block_length - 16 ; zs . next_out = fp -> uncompressed_block ; zs . avail_out = BGZF_BLOCK_SIZE ; if ( inflateInit2 ( & zs , - 15 ) != Z_OK ) { fp -> errcode |= BGZF_ERR_ZLIB ; return - 1 ; } if ( inflate ( & zs , Z_FINISH ) != Z_STREAM_END ) { inflateEnd ( & zs ) ; fp -> errcode |= BGZF_ERR_ZLIB ; return - 1 ; } return zs . total_out ; } 