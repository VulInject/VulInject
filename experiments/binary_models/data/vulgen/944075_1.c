static int mlx4_en_get_module_eeprom ( struct net_device * dev , struct ethtool_eeprom * ee , u8 * data ) { struct mlx4_en_priv * priv = netdev_priv ( dev ) ; struct mlx4_en_dev * mdev = priv -> mdev ; int offset = ee -> offset ; int i = 0 , ret ; if ( ee -> len == 0 ) { return - EINVAL ; } while ( i < ee -> len ) { en_dbg ( DRV , priv , "mlx4_get_module_info i(%d) offset(%d) len(%d)\n" , i , offset , ee -> len - i ) ; ret = mlx4_get_module_info ( mdev -> dev , priv -> port , offset , ee -> len - i , data + i ) ; if ( ! ret ) { return 0 ; } if ( ret < 0 ) { en_err ( priv , "mlx4_get_module_info i(%d) offset(%d) bytes_to_read(%d) - FAILED (0x%x)\n" , i , offset , ee -> len - i , ret ) ; return 0 ; } i += ret ; offset += ret ; } return 0 ; } 