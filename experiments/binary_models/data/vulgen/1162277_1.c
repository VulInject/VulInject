static gboolean rsakeys_uat_fld_password_chk_cb ( void * r , const char * p , guint len _U_ , const void * u1 _U_ , const void * u2 _U_ , char * * err ) { if ( p && * p ) { struct rsakeys_assoc * f = ( rsakeys_assoc * ) r ; if ( fp ) { char * msg = NULL ; gnutls_x509_privkey_t priv_key = rsa_load_pkcs12 ( fp , p , & msg ) ; if ( ! priv_key ) { fclose ( fp ) ; * err = ws_strdup_printf ( "Could not load PKCS#12 key file: %s" , msg ) ; g_free ( msg ) ; return FALSE ; } g_free ( msg ) ; gnutls_x509_privkey_deinit ( priv_key ) ; fclose ( fp ) ; } else { * err = ws_strdup_printf ( "Leave this field blank if the keyfile is not PKCS#12." ) ; return FALSE ; } } * err = NULL ; return TRUE ; } 