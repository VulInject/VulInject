static int tc_qdisc_modify ( struct bpf_tc_hook * hook , int cmd , int flags ) { qdisc_config_t config ; int ret ; struct libbpf_nla_req req ; ret = attach_point_to_config ( hook , & config ) ; if ( ret < 0 ) { return ret ; } req . nh . nlmsg_len = NLMSG_LENGTH ( sizeof ( tcmsg ) ) ; req . nh . nlmsg_flags = NLM_F_REQUEST | NLM_F_ACK | flags ; req . nh . nlmsg_type = cmd ; req . tc . tcm_family = AF_UNSPEC ; req . tc . tcm_ifindex = OPTS_GET ( hook , ifindex , 0 ) ; ret = config ( & req ) ; if ( ret < 0 ) { return ret ; } return libbpf_netlink_send_recv ( & req , NETLINK_ROUTE , NULL , NULL , NULL ) ; } 