static void btmrvl_init_adapter ( struct btmrvl_private * priv ) { int buf_size ; skb_queue_head_init ( & priv -> adapter -> tx_queue ) ; priv -> adapter -> ps_state = PS_AWAKE ; buf_size = ALIGN_SZ ( SDIO_BLOCK_SIZE , BTSDIO_DMA_ALIGN ) ; priv -> adapter -> hw_regs_buf = kzalloc ( buf_size , GFP_KERNEL ) ; if ( ! priv -> adapter -> hw_regs_buf ) { priv -> adapter -> hw_regs = NULL ; BT_ERR ( "Unable to allocate buffer for hw_regs." ) ; } else { priv -> adapter -> hw_regs = ( u8 * ) ALIGN_ADDR ( priv -> adapter -> hw_regs_buf , BTSDIO_DMA_ALIGN ) ; BT_DBG ( "hw_regs_buf=%p hw_regs=%p" , priv -> adapter -> hw_regs_buf , priv -> adapter -> hw_regs ) ; } init_waitqueue_head ( & priv -> adapter -> cmd_wait_q ) ; } 