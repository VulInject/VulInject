static void rkisp1_rsz_set_sink_crop ( struct rkisp1_resizer * rsz , struct v4l2_subdev_state * sd_state , struct v4l2_rect * r , unsigned int which ) { const struct rkisp1_mbus_info * mbus_info ; struct v4l2_mbus_framefmt * sink_fmt ; struct v4l2_rect * sink_crop ; sink_fmt = rkisp1_rsz_get_pad_fmt ( rsz , sd_state , RKISP1_RSZ_PAD_SINK , which ) ; sink_crop = rkisp1_rsz_get_pad_crop ( rsz , sd_state , RKISP1_RSZ_PAD_SINK , which ) ; if ( rsz -> id == RKISP1_MAINPATH && mbus_info -> pixel_enc == V4L2_PIXEL_ENC_BAYER ) { sink_crop -> left = 0 ; sink_crop -> top = 0 ; sink_crop -> width = sink_fmt -> width ; sink_crop -> height = sink_fmt -> height ; * r = * sink_crop ; return ; } sink_crop -> left = ALIGN ( r -> left , 2 ) ; sink_crop -> width = ALIGN ( r -> width , 2 ) ; sink_crop -> top = r -> top ; sink_crop -> height = r -> height ; rkisp1_sd_adjust_crop ( sink_crop , sink_fmt ) ; * r = * sink_crop ; } 