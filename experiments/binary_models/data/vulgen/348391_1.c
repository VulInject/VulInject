int process_request ( tcp_chan * chan ) { return ( 0 ) ; } unsigned disrui_peek ( tcp_chan * chan , int * retval , unsigned int timeout ) { if ( peek_count ++ % 2 == 0 ) { return ( 2 ) ; } else { chan -> IsTimeout = 1 ; } return ( 0 ) ; } void * svr_is_request ( void * vp ) { return ( NULL ) ; } char * netaddr ( struct sockaddr_in * ap ) { fprintf ( stderr , "The call to netaddr needs to be mocked!!\n" ) ; exit ( 1 ) ; return 0 ; } struct tcp_chan * DIS_tcp_setup ( int fd ) { fprintf ( stderr , "The call to DIS_tcp_setup needs to be mocked!!\n" ) ; exit ( 1 ) ; return 0 ; } void DIS_tcp_cleanup ( tcp_chan * chan ) { fprintf ( stderr , "The call to DIS_tcp_cleanup needs to be mocked!!\n" ) ; } void netcounter_incr ( ) { } "C" { void close_conn ( int sd , int has_mutex ) { } } 