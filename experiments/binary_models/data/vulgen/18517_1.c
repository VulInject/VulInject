static msIOContextGroup * msIO_GetContextGroup ( ) { void * nThreadId = msGetThreadId ( ) ; msIOContextGroup * prev = NULL , * group = io_context_list ; if ( group != NULL && group -> thread_id == nThreadId ) { return group ; } msAcquireLock ( TLOCK_IOCONTEXT ) ; msIO_Initialize ( ) ; group = io_context_list ; while ( group != NULL && group -> thread_id != nThreadId ) { prev = group ; group = group -> next ; } if ( group != NULL ) { if ( prev != NULL ) { group -> next = io_context_list ; io_context_list = group ; } msReleaseLock ( TLOCK_IOCONTEXT ) ; return group ; } group = ( msIOContextGroup * ) calloc ( sizeof ( msIOContextGroup ) , 1 ) ; group -> stdin_context = default_contexts . stdin_context ; group -> stdout_context = default_contexts . stdout_context ; group -> stderr_context = default_contexts . stderr_context ; group -> thread_id = nThreadId ; group -> next = io_context_list ; io_context_list = group ; msReleaseLock ( TLOCK_IOCONTEXT ) ; return group ; } 