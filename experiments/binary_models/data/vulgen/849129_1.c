double complex cpow ( double complex a , double complex z ) { double complex w ; double x , y , r , theta , absa , arga ; x = creal ( z ) ; y = cimag ( z ) ; absa = cabs ( a ) ; if ( absa == 0.0 ) { return ( 0.0 + 0.0 * I ) ; } arga = carg ( a ) ; r = pow ( absa , x ) ; theta = x * arga ; if ( y != 0.0 ) { theta = theta + y * log ( absa ) ; } w = r * cos ( theta ) + ( r * sin ( theta ) ) * I ; return ( w ) ; } 