static UINT16 earlyClientCapsFromSettings ( const rdpSettings * settings ) { UINT32 earlyCapabilityFlags = 0 ; WINPR_ASSERT ( settings ) ; if ( settings -> SupportErrorInfoPdu ) { earlyCapabilityFlags |= RNS_UD_CS_SUPPORT_ERRINFO_PDU ; } if ( freerdp_settings_get_uint32 ( settings , FreeRDP_ColorDepth ) == 32 ) { earlyCapabilityFlags |= RNS_UD_CS_WANT_32BPP_SESSION ; } if ( settings -> SupportStatusInfoPdu ) { earlyCapabilityFlags |= RNS_UD_CS_SUPPORT_STATUSINFO_PDU ; } if ( settings -> ConnectionType ) { earlyCapabilityFlags |= RNS_UD_CS_VALID_CONNECTION_TYPE ; } if ( settings -> SupportMonitorLayoutPdu ) { earlyCapabilityFlags |= RNS_UD_CS_SUPPORT_MONITOR_LAYOUT_PDU ; } if ( freerdp_settings_get_bool ( settings , FreeRDP_NetworkAutoDetect ) ) { earlyCapabilityFlags |= RNS_UD_CS_SUPPORT_NETCHAR_AUTODETECT ; } if ( settings -> SupportGraphicsPipeline ) { earlyCapabilityFlags |= RNS_UD_CS_SUPPORT_DYNVC_GFX_PROTOCOL ; } if ( settings -> SupportDynamicTimeZone ) { earlyCapabilityFlags |= RNS_UD_CS_SUPPORT_DYNAMIC_TIME_ZONE ; } if ( settings -> SupportHeartbeatPdu ) { earlyCapabilityFlags |= RNS_UD_CS_SUPPORT_HEARTBEAT_PDU ; } if ( settings -> SupportSkipChannelJoin ) { earlyCapabilityFlags |= RNS_UD_CS_SUPPORT_SKIP_CHANNELJOIN ; } return filterAndLogEarlyClientCapabilityFlags ( earlyCapabilityFlags ) ; } 