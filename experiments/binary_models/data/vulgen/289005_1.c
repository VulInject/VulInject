static OutputInitResult OutputHttp2LogInitSub ( ConfNode * conf , OutputCtx * parent_ctx ) { OutputInitResult result = { NULL false } ; OutputJsonCtx * ojc = parent_ctx -> data ; OutputHttp2Ctx * http2_ctx = SCMalloc ( sizeof ( OutputHttp2Ctx ) ) ; if ( unlikely ( http2_ctx == NULL ) ) { return result ; } OutputCtx * output_ctx = SCCalloc ( 1 , sizeof ( OutputCtx ) ) ; if ( unlikely ( output_ctx == NULL ) ) { return result ; } http2_ctx -> eve_ctx = ojc ; output_ctx -> data = http2_ctx ; output_ctx -> DeInit = OutputHttp2LogDeinitSub ; AppLayerParserRegisterLogger ( IPPROTO_TCP , ALPROTO_HTTP2 ) ; result . ctx = output_ctx ; result . ok = true ; return result ; } 