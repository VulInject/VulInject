static int __lapb_disconnect_request ( struct lapb_cb * lapb ) { switch ( lapb -> state ) { case LAPB_STATE_0 : return LAPB_NOTCONNECTED ; case LAPB_STATE_1 : lapb_dbg ( 1 , "(%p) S1 TX DISC(1)\n" , lapb -> dev ) ; lapb_dbg ( 0 , "(%p) S1 ->S0\n" , lapb -> dev ) ; lapb_send_control ( lapb , LAPB_DISC , LAPB_POLLON , LAPB_COMMAND ) ; lapb -> state = LAPB_STATE_0 ; lapb_start_t1timer ( lapb ) ; return LAPB_NOTCONNECTED ; case LAPB_STATE_2 : return LAPB_OK ; } lapb_clear_queues ( lapb ) ; lapb_send_control ( lapb , LAPB_DISC , LAPB_POLLON , LAPB_COMMAND ) ; lapb_start_t1timer ( lapb ) ; lapb_stop_t2timer ( lapb ) ; lapb -> state = LAPB_STATE_2 ; lapb_dbg ( 1 , "(%p) S3 DISC(1)\n" , lapb -> dev ) ; lapb_dbg ( 0 , "(%p) S3 ->S2\n" , lapb -> dev ) ; return LAPB_OK ; } 