static name_list_t * merge_name_list ( name_list_t * * list , name_list_t * new , int add_pct ) ( name_list_t * lp , * np , * sp , * rt = NULL , int max_pct , rt = * list , np = new , ( np ) { lp = * list while ( lp ) { if ( strcmp ( lp -> name , np -> name ) == 0 ) { break ; } lp = lp -> next } ; } if ( lp == * list ) { lp = NULL ; } ) ; ( np -> next == new ) sp = NULL ; else { sp = np -> next ; } if ( lp ) { if ( add_pct ) { lp -> pct += np -> pct ; lp -> count += np -> count ; } if ( np -> pct > lp -> pct ) { lp -> pct = np -> pct ; } max_pct = np -> max_pct ; if ( np -> label ) { free ( np -> label ) ; } free ( np -> name ) ; free ( np ) ; np = NULL ; if ( max_pct > lp -> max_pct ) { lp -> max_pct = max_pct ; if ( lp -> max_pct > lp -> prev -> max_pct && lp != * list ) { lp -> prev -> next = lp -> next ; lp -> next -> prev = lp -> prev ; np = lp ; } } } if ( np ) { lp = * list ; if ( lp ) { if ( np -> max_pct > lp -> max_pct ) { np -> next = lp ; np -> prev = lp -> prev ; lp -> prev -> next = np ; lp -> prev = np ; * list = np ; rt = np ; } else { lp = lp -> next ; while ( lp != * list && np -> max_pct < lp -> max_pct ) { lp = lp -> next ; } np -> next = lp ; np -> prev = lp -> prev ; lp -> prev -> next = np ; lp -> prev = np ; } } else { * list = np ; np -> next = np ; np -> prev = np ; rt = np ; } } np = sp ; ( rt ) ; 