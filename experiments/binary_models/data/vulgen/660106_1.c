static DecodeStatus DecodeVLD1LN ( MCInst * Inst , unsigned Insn , uint64_t Address , const void * Decoder ) { DecodeStatus S = MCDisassembler_Success ; unsigned size , align = 0 , index = 0 ; unsigned Rn = fieldFromInstruction_4 ( Insn , 16 , 4 ) ; unsigned Rm = fieldFromInstruction_4 ( Insn , 0 , 4 ) ; unsigned Rd = fieldFromInstruction_4 ( Insn , 12 , 4 ) ; size = fieldFromInstruction_4 ( Insn , 10 , 2 ) ; switch ( size ) { default : return MCDisassembler_Fail ; case 0 : if ( fieldFromInstruction_4 ( Insn , 4 , 1 ) ) { return MCDisassembler_Fail ; } index = fieldFromInstruction_4 ( Insn , 5 , 3 ) ; break ; case 1 : if ( fieldFromInstruction_4 ( Insn , 5 , 1 ) ) { return MCDisassembler_Fail ; } index = fieldFromInstruction_4 ( Insn , 6 , 2 ) ; if ( fieldFromInstruction_4 ( Insn , 4 , 1 ) ) { align = 2 ; } break ; case 2 : if ( fieldFromInstruction_4 ( Insn , 6 , 1 ) ) { return MCDisassembler_Fail ; } index = fieldFromInstruction_4 ( Insn , 7 , 1 ) ; switch ( fieldFromInstruction_4 ( Insn , 4 , 2 ) ) { case 0 : align = 0 ; break ; case 3 : align = 4 ; break ; default : return MCDisassembler_Fail ; } break ; } if ( ! Check ( & S , DecodeDPRRegisterClass ( Inst , Rd , Address , Decoder ) ) ) { return MCDisassembler_Fail ; } if ( Rm != 0xF ) { if ( ! Check ( & S , DecodeGPRRegisterClass ( Inst , Rn , Address , Decoder ) ) ) { return MCDisassembler_Fail ; } } if ( ! Check ( & S , DecodeGPRRegisterClass ( Inst , Rn , Address , Decoder ) ) ) { return MCDisassembler_Fail ; } MCOperand_CreateImm0 ( Inst , align ) ; if ( Rm != 0xF ) { if ( Rm != 0xD ) { if ( ! Check ( & S , DecodeGPRRegisterClass ( Inst , Rm , Address , Decoder ) ) ) { return MCDisassembler_Fail ; } } else { MCOperand_CreateReg0 ( Inst , 0 ) ; } } if ( ! Check ( & S , DecodeDPRRegisterClass ( Inst , Rd , Address , Decoder ) ) ) { return MCDisassembler_Fail ; } MCOperand_CreateImm0 ( Inst , index ) ; return S ; } 