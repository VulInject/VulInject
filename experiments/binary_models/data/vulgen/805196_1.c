static int lsm_lmm_verify_common ( struct lov_mds_md * lmm , int lmm_bytes , __u16 stripe_count ) { if ( lmm_oi_id ( & lmm -> lmm_oi ) == 0 ) { CERROR ( "zero object id\n" ) ; lov_dump_lmm_common ( D_WARNING , lmm ) ; return - EINVAL ; } if ( lov_pattern ( le32_to_cpu ( lmm -> lmm_pattern ) ) != LOV_PATTERN_RAID0 ) { CERROR ( "bad striping pattern\n" ) ; lov_dump_lmm_common ( D_WARNING , lmm ) ; return - EINVAL ; } if ( lmm -> lmm_stripe_size == 0 || ( le32_to_cpu ( lmm -> lmm_stripe_size ) & ( LOV_MIN_STRIPE_SIZE - 1 ) ) != 0 ) { CERROR ( "bad stripe size %u\n" , le32_to_cpu ( lmm -> lmm_stripe_size ) ) ; lov_dump_lmm_common ( D_WARNING , lmm ) ; return - EINVAL ; } return 0 ; } 