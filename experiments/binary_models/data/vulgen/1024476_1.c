get_token ( , ) { char * p = src -> text ; char * end = p + src -> len ; while ( p < end ) { if ( is_whitespace ( * p ) ) { p ++ ; } if ( get_comment ( tok , p , end ) ) { p += tok -> len ; } if ( get_pp_number ( tok , p , end ) || get_character_constant ( tok , p , end ) || get_string_literal ( tok , p , end ) || get_identifier ( tok , p , end ) || get_punctuator ( tok , p , end ) ) { int consumed = p - src -> text + tok -> len ; src -> text += consumed ; src -> len -= consumed ; return 1 ; } else { int consumed ; set_token ( tok , p , p + 1 ) ; consumed = p - src -> text + tok -> len ; src -> text += consumed ; src -> len -= consumed ; return 1 ; } } return 0 ; } 