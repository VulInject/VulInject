static void test_c2 ( unsigned mode ) { struct vhd_decode d [ 1 ] ; uint8_t in [ 256 ] ; size_t in_l ; char out [ 256 ] ; enum vhd_ret_e r ; VHD_Init ( d ) ; in_l = hexbuf ( in , sizeof in , "400a 6375 7374 6f6d 2d6b 6579 0d63 7573" "746f 6d2d 6865 6164 6572" ) ; r = decode ( d , NULL , in , in_l , out , sizeof out , mode ) ; CHECK_RET ( r , VHD_OK ) ; AZ ( match ( out , sizeof out , "custom-key" , "custom-header" , NULL ) ) ; in_l = hexbuf ( in , sizeof in , "040c 2f73 616d 706c 652f 7061 7468" ) ; r = decode ( d , NULL , in , in_l , out , sizeof out , mode ) ; CHECK_RET ( r , VHD_OK ) ; in_l = hexbuf ( in , sizeof in , "1008 7061 7373 776f 7264 0673 6563 7265" "74" ) ; r = decode ( d , NULL , in , in_l , out , sizeof out , mode ) ; CHECK_RET ( r , VHD_OK ) ; AZ ( match ( out , sizeof out , "password" , "secret" , NULL ) ) ; in_l = hexbuf ( in , sizeof in , "82" ) ; r = decode ( d , NULL , in , in_l , out , sizeof out , mode ) ; CHECK_RET ( r , VHD_OK ) ; AZ ( match ( out , sizeof out , ":method" , "GET" , NULL ) ) ; } 