static int ls_pcie_g4_rc_inbound_win_set ( struct ls_pcie_g4 * pcie , int idx , int type , u64 phys , u64 bus_addr , pci_size_t size ) { u32 val ; val = ccsr_readl ( pcie , PAB_PEX_AMAP_CTRL ( idx ) ) ; val &= ~ ( PEX_AMAP_CTRL_TYPE_MASK << PEX_AMAP_CTRL_TYPE_SHIFT ) ; val &= ~ ( PEX_AMAP_CTRL_EN_MASK << PEX_AMAP_CTRL_EN_SHIFT ) ; val = ( val | ( type << PEX_AMAP_CTRL_TYPE_SHIFT ) ) ; val = ( val | ( 1 << PEX_AMAP_CTRL_EN_SHIFT ) ) ; ccsr_writel ( pcie , PAB_PEX_AMAP_CTRL ( idx ) , val | lower_32_bits ( win_size ) ) ; ccsr_writel ( pcie , PAB_EXT_PEX_AMAP_SIZE ( idx ) , upper_32_bits ( win_size ) ) ; ccsr_writel ( pcie , PAB_PEX_AMAP_AXI_WIN ( idx ) , lower_32_bits ( phys ) ) ; ccsr_writel ( pcie , PAB_EXT_PEX_AMAP_AXI_WIN ( idx ) , upper_32_bits ( phys ) ) ; ccsr_writel ( pcie , PAB_PEX_AMAP_PEX_WIN_L ( idx ) , lower_32_bits ( bus_addr ) ) ; ccsr_writel ( pcie , PAB_PEX_AMAP_PEX_WIN_H ( idx ) , upper_32_bits ( bus_addr ) ) ; return 0 ; } 