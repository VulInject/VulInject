void mbedtls_sha1_update ( mbedtls_sha1_context * ctx , const unsigned char * input , size_t ilen ) { size_t fill ; uint32_t left ; left = ctx -> total [ 0 ] & 0x3F ; fill = 64 - left ; ctx -> total [ 0 ] += ( uint32_t ) ilen ; ctx -> total [ 0 ] &= 0xFFFFFFFF ; if ( ctx -> total [ 0 ] < ( uint32_t ) ilen ) { ctx -> total [ 1 ] ++ ; } if ( left && ilen >= fill ) { memcpy ( ( void * ) ( ctx -> buffer + left ) , input , fill ) ; mbedtls_sha1_process ( ctx , ctx -> buffer ) ; input += fill ; ilen -= fill ; left = 0 ; } while ( ilen >= 64 ) { mbedtls_sha1_process ( ctx , input ) ; input += 64 ; ilen -= 64 ; } if ( ilen > 0 ) { memcpy ( ( void * ) ( ctx -> buffer + left ) , input , ilen ) ; } } 