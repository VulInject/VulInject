nautilus_mime_get_default_application_for_file ( ) { GAppInfo * app ; char * mime_type ; char * uri_scheme ; mime_type = nautilus_file_get_mime_type ( file ) ; app = g_app_info_get_default_for_type ( mime_type , ! nautilus_file_has_local_path ( file ) ) ; g_free ( mime_type ) ; if ( app == NULL ) { uri_scheme = nautilus_file_get_uri_scheme ( file ) ; if ( uri_scheme != NULL ) { app = g_app_info_get_default_for_uri_scheme ( uri_scheme ) ; g_free ( uri_scheme ) ; } } return app ; } 