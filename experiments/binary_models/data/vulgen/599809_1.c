CK_RV meta_EncryptInit ( CK_SESSION_HANDLE hSession , CK_MECHANISM_PTR pMechanism , CK_OBJECT_HANDLE hKey ) { CK_RV rv ; meta_session_t * session ; meta_object_t * key ; rv = meta_handle2session ( hSession , & session ) ; if ( rv != CKR_OK ) { return ( rv ) ; } rv = meta_handle2object ( hKey , & key ) ; if ( rv != CKR_OK ) { REFRELEASE ( session ) ; return ( rv ) ; } rv = meta_operation_init_defer ( CKF_ENCRYPT , session , pMechanism , key ) ; OBJRELEASE ( key ) ; REFRELEASE ( session ) ; return ( rv ) ; } 