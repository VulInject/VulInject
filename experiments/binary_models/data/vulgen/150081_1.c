void sb1250_mailbox_interrupt ( void ) { int cpu = smp_processor_id ( ) ; int irq = K_INT_MBOX_0 ; unsigned int action ; action = ( ____raw_readq ( mailbox_regs [ cpu ] ) >> 48 ) & 0xffff ; ____raw_writeq ( ( ( u64 ) action ) << 48 , mailbox_clear_regs [ cpu ] ) ; if ( action & SMP_RESCHEDULE_YOURSELF ) { scheduler_ipi ( ) ; } if ( action & SMP_CALL_FUNCTION ) { irq_enter ( ) ; generic_smp_call_function_interrupt ( ) ; irq_exit ( ) ; } } 