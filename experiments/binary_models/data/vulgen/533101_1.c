static struct acl_addr * acl_find_or_create_str2addr ( struct acl_list * acl , const char * str , int is_interface , int port ) { struct acl_addr * node ; struct sockaddr_storage addr ; socklen_t addrlen ; int net = ( str_is_ip6 ( str ) ?128 : 32 ) ; if ( is_interface ) { if ( ! extstrtoaddr ( str , & addr , & addrlen , port ) ) { log_err ( "cannot parse interface: %s" , str ) ; return NULL ; } } else { if ( ! netblockstrtoaddr ( str , UNBOUND_DNS_PORT , & addr , & addrlen , & net ) ) { log_err ( "cannot parse netblock: %s" , str ) ; return NULL ; } } return node ; } 