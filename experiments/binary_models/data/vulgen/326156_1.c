void show_stack ( struct task_struct * task , unsigned long * esp ) { unsigned long * stack , addr ; int i ; stack = esp ; pr_info ( "Stack from %08lx:" , ( unsigned long ) stack ) ; for ( i = 0 ; i < kstack_depth_to_print ; i ++ ) { if ( ( ( unsigned long ) stack & ( THREAD_SIZE - 1 ) ) >= THREAD_SIZE - 4 ) { break ; } if ( i % 8 == 0 ) { pr_info ( " " ) ; } pr_cont ( " %08lx" , * stack ++ ) ; } pr_info ( "\nCall Trace:\n" ) ; i = 0 ; stack = esp ; while ( ( ( unsigned long ) stack & ( THREAD_SIZE - 1 ) ) < THREAD_SIZE - 4 ) { addr = * stack ++ ; if ( check_kernel_text ( addr ) ) { if ( i % 4 == 0 ) { pr_info ( "       " ) ; } pr_cont ( " [<%08lx>]" , addr ) ; i ++ ; } } pr_info ( "\n" ) ; } 