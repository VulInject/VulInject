wmem_tree_t * file_scope_stream_number = NULL ; static int proto_btavdtp = - 1 ; static int hf_btavdtp_data = - 1 ; static int hf_btavdtp_message_type = - 1 ; static int hf_btavdtp_packet_type = - 1 ; static int hf_btavdtp_transaction = - 1 ; static int hf_btavdtp_signal = - 1 ; static int hf_btavdtp_signal_id = - 1 ; static int hf_btavdtp_rfa0 = - 1 ; static int hf_btavdtp_number_of_signal_packets = - 1 ; static int hf_btavdtp_sep_seid = - 1 ; static int hf_btavdtp_sep_inuse = - 1 ; static int hf_btavdtp_sep_rfa0 = - 1 ; static int hf_btavdtp_sep_media_type = - 1 ; static int hf_btavdtp_sep_type = - 1 ; static int hf_btavdtp_sep_rfa1 = - 1 ; static int hf_btavdtp_error_code = - 1 ; static int hf_btavdtp_acp_sep = - 1 ; static int hf_btavdtp_acp_seid_item = - 1 ; static int hf_btavdtp_int_seid_item = - 1 ; static int hf_btavdtp_acp_seid = - 1 ; static int hf_btavdtp_int_seid = - 1 ; static int hf_btavdtp_service_category = - 1 ; static int hf_btavdtp_rfa_seid = - 1 ; static int hf_btavdtp_delay = - 1 ; static int hf_btavdtp_length_of_service_category = - 1 ; static int hf_btavdtp_recovery_type = - 1 ; static int hf_btavdtp_maximum_recovery_window_size = - 1 ; static int hf_btavdtp_maximum_number_of_media_packet_in_parity_code = - 1 ; static int hf_btavdtp_multiplexing_fragmentation = - 1 ; static int hf_btavdtp_multiplexing_rfa = - 1 ; static int hf_btavdtp_multiplexing_tsid = - 1 ; static int hf_btavdtp_multiplexing_tcid = - 1 ; static int hf_btavdtp_multiplexing_entry_rfa = - 1 ; static int hf_btavdtp_header_compression_backch = - 1 ; static int hf_btavdtp_header_compression_media = - 1 ; static int hf_btavdtp_header_compression_recovery = - 1 ; static int hf_btavdtp_header_compression_rfa = - 1 ; static int hf_btavdtp_content_protection_type = - 1 ; static int hf_btavdtp_media_codec_media_type = - 1 ; static int hf_btavdtp_media_codec_rfa = - 1 ; static int hf_btavdtp_media_codec_unknown_type = - 1 ; static int hf_btavdtp_media_codec_audio_type = - 1 ; static int hf_btavdtp_media_codec_video_type = - 1 ; static int hf_btavdtp_sbc_sampling_frequency_16000 = - 1 ; static int hf_btavdtp_sbc_sampling_frequency_32000 = - 1 ; static int hf_btavdtp_sbc_sampling_frequency_44100 = - 1 ; static int hf_btavdtp_sbc_sampling_frequency_48000 = - 1 ; static int hf_btavdtp_sbc_channel_mode_mono = - 1 ; static int hf_btavdtp_sbc_channel_mode_dual_channel = - 1 ; static int hf_btavdtp_sbc_channel_mode_stereo = - 1 ; static int hf_btavdtp_sbc_channel_mode_joint_stereo = - 1 ; static int hf_btavdtp_sbc_block_4 = - 1 ; static int hf_btavdtp_sbc_block_8 = - 1 ; static int hf_btavdtp_sbc_block_12 = - 1 ; static int hf_btavdtp_sbc_block_16 = - 1 ; static int hf_btavdtp_sbc_subbands_4 = - 1 ; static int hf_btavdtp_sbc_subbands_8 = - 1 ; static int hf_btavdtp_sbc_allocation_method_snr = - 1 ; static int hf_btavdtp_sbc_allocation_method_loudness = - 1 ; static int hf_btavdtp_sbc_min_bitpool = - 1 ; static int hf_btavdtp_sbc_max_bitpool = - 1 ; static int hf_btavdtp_mpeg12_layer_1 = - 1 ; static int hf_btavdtp_mpeg12_layer_2 = - 1 ; static int hf_btavdtp_mpeg12_layer_3 = - 1 ; static int hf_btavdtp_mpeg12_crc_protection = - 1 ; static int hf_btavdtp_mpeg12_channel_mode_mono = - 1 ; static int hf_btavdtp_mpeg12_channel_mode_dual_channel = - 1 ; static int hf_btavdtp_mpeg12_channel_mode_stereo = - 1 ; static int hf_btavdtp_mpeg12_channel_mode_joint_stereo = - 1 ; static int hf_btavdtp_mpeg12_rfa = - 1 ; static int hf_btavdtp_mpeg12_mpf_2 = - 1 ; static int hf_btavdtp_mpeg12_sampling_frequency_16000 = - 1 ; static int hf_btavdtp_mpeg12_sampling_frequency_22050 = - 1 ; static int hf_btavdtp_mpeg12_sampling_frequency_24000 = - 1 ; static int hf_btavdtp_mpeg12_sampling_frequency_32000 = - 1 ; static int hf_btavdtp_mpeg12_sampling_frequency_44100 = - 1 ; static int hf_btavdtp_mpeg12_sampling_frequency_48000 = - 1 ; static int hf_btavdtp_mpeg12_vbr_supported = - 1 ; static int hf_btavdtp_mpeg12_bit_rate = - 1 ; static int hf_btavdtp_mpeg24_object_type_mpeg2_aac_lc = - 1 ; static int hf_btavdtp_mpeg24_object_type_mpeg4_aac_lc = - 1 ; static int hf_btavdtp_mpeg24_object_type_mpeg4_aac_ltp = - 1 ; static int hf_btavdtp_mpeg24_object_type_mpeg4_aac_scalable = - 1 ; static int hf_btavdtp_mpeg24_object_type_rfa = - 1 ; static int hf_btavdtp_mpeg24_sampling_frequency_8000 = - 1 ; static int hf_btavdtp_mpeg24_sampling_frequency_11025 = - 1 ; static int hf_btavdtp_mpeg24_sampling_frequency_12000 = - 1 ; static int hf_btavdtp_mpeg24_sampling_frequency_16000 = - 1 ; static int hf_btavdtp_mpeg24_sampling_frequency_22050 = - 1 ; static int hf_btavdtp_mpeg24_sampling_frequency_24000 = - 1 ; static int hf_btavdtp_mpeg24_sampling_frequency_32000 = - 1 ; static int hf_btavdtp_mpeg24_sampling_frequency_44100 = - 1 ; static int hf_btavdtp_mpeg24_sampling_frequency_48000 = - 1 ; static int hf_btavdtp_mpeg24_sampling_frequency_64000 = - 1 ; static int hf_btavdtp_mpeg24_sampling_frequency_88200 = - 1 ; static int hf_btavdtp_mpeg24_sampling_frequency_96000 = - 1 ; static int hf_btavdtp_mpeg24_channels_1 = - 1 ; static int hf_btavdtp_mpeg24_channels_2 = - 1 ; static int hf_btavdtp_mpeg24_rfa = - 1 ; static int hf_btavdtp_mpeg24_vbr_supported = - 1 ; static int hf_btavdtp_mpeg24_bit_rate = - 1 ; static int hf_btavdtp_atrac_version = - 1 ; static int hf_btavdtp_atrac_channel_mode_single_channel = - 1 ; static int hf_btavdtp_atrac_channel_mode_dual_channel = - 1 ; static int hf_btavdtp_atrac_channel_mode_joint_stereo = - 1 ; static int hf_btavdtp_atrac_rfa1 = - 1 ; static int hf_btavdtp_atrac_rfa2 = - 1 ; static int hf_btavdtp_atrac_sampling_frequency_44100 = - 1 ; static int hf_btavdtp_atrac_sampling_frequency_48000 = - 1 ; static int hf_btavdtp_atrac_vbr_supported = - 1 ; static int hf_btavdtp_atrac_bit_rate = - 1 ; static int hf_btavdtp_atrac_maximum_sul = - 1 ; static int hf_btavdtp_atrac_rfa3 = - 1 ; static int hf_btavdtp_vendor_specific_aptx_sampling_frequency_16000 = - 1 ; static int hf_btavdtp_vendor_specific_aptx_sampling_frequency_32000 = - 1 ; static int hf_btavdtp_vendor_specific_aptx_sampling_frequency_44100 = - 1 ; static int hf_btavdtp_vendor_specific_aptx_sampling_frequency_48000 = - 1 ; static int hf_btavdtp_vendor_specific_aptx_channel_mode_mono = - 1 ; static int hf_btavdtp_vendor_specific_aptx_channel_mode_dual_channel = - 1 ; static int hf_btavdtp_vendor_specific_aptx_channel_mode_stereo = - 1 ; static int hf_btavdtp_vendor_specific_aptx_channel_mode_joint_stereo = - 1 ; static int hf_btavdtp_vendor_specific_aptxhd_sampling_frequency_16000 = - 1 ; static int hf_btavdtp_vendor_specific_aptxhd_sampling_frequency_32000 = - 1 ; static int hf_btavdtp_vendor_specific_aptxhd_sampling_frequency_44100 = - 1 ; static int hf_btavdtp_vendor_specific_aptxhd_sampling_frequency_48000 = - 1 ; static int hf_btavdtp_vendor_specific_aptxhd_channel_mode_mono = - 1 ; static int hf_btavdtp_vendor_specific_aptxhd_channel_mode_dual_channel = - 1 ; static int hf_btavdtp_vendor_specific_aptxhd_channel_mode_stereo = - 1 ; static int hf_btavdtp_vendor_specific_aptxhd_channel_mode_joint_stereo = - 1 ; static int hf_btavdtp_vendor_specific_aptxhd_rfa = - 1 ; static int hf_btavdtp_vendor_specific_ldac_rfa1 = - 1 ; static int hf_btavdtp_vendor_specific_ldac_sampling_frequency_44100 = - 1 ; static int hf_btavdtp_vendor_specific_ldac_sampling_frequency_48000 = - 1 ; static int hf_btavdtp_vendor_specific_ldac_sampling_frequency_88200 = - 1 ; static int hf_btavdtp_vendor_specific_ldac_sampling_frequency_96000 = - 1 ; static int hf_btavdtp_vendor_specific_ldac_sampling_frequency_176400 = - 1 ; static int hf_btavdtp_vendor_specific_ldac_sampling_frequency_192000 = - 1 ; static int hf_btavdtp_vendor_specific_ldac_rfa2 = - 1 ; static int hf_btavdtp_vendor_specific_ldac_channel_mode_mono = - 1 ; static int hf_btavdtp_vendor_specific_ldac_channel_mode_dual_channel = - 1 ; static int hf_btavdtp_vendor_specific_ldac_channel_mode_stereo = - 1 ; static int hf_btavdtp_h263_level_10 = - 1 ; static int hf_btavdtp_h263_level_20 = - 1 ; static int hf_btavdtp_h263_level_30 = - 1 ; static int hf_btavdtp_h263_level_rfa = - 1 ; static int hf_btavdtp_mpeg4_level_0 = - 1 ; static int hf_btavdtp_mpeg4_level_1 = - 1 ; static int hf_btavdtp_mpeg4_level_2 = - 1 ; static int hf_btavdtp_mpeg4_level_3 = - 1 ; static int hf_btavdtp_mpeg4_level_rfa = - 1 ; static int hf_btavdtp_vendor_id = - 1 ; static int hf_btavdtp_vendor_specific_codec_id = - 1 ; static int hf_btavdtp_vendor_specific_value = - 1 ; static int hf_btavdtp_vendor_specific_apt_codec_id = - 1 ; static int hf_btavdtp_vendor_specific_ldac_codec_id = - 1 ; static int hf_btavdtp_capabilities = - 1 ; static int hf_btavdtp_service = - 1 ; static int hf_btavdtp_service_multiplexing_entry = - 1 ; static gint ett_btavdtp = - 1 ; static gint ett_btavdtp_sep = - 1 ; static gint ett_btavdtp_capabilities = - 1 ; static gint ett_btavdtp_service = - 1 ; static expert_field ei_btavdtp_sbc_min_bitpool_out_of_range = EI_INIT ; static expert_field ei_btavdtp_sbc_max_bitpool_out_of_range = EI_INIT ; static expert_field ei_btavdtp_unexpected_losc_data = EI_INIT ; static dissector_handle_t btavdtp_handle ; static dissector_handle_t bta2dp_handle ; static dissector_handle_t btvdp_handle ; static dissector_handle_t rtp_handle ; static wmem_tree_t * channels = NULL ; static wmem_tree_t * sep_list = NULL ; static wmem_tree_t * sep_open = NULL ; static wmem_tree_t * media_packet_times = NULL ; static gint proto_bta2dp = - 1 ; static gint ett_bta2dp = - 1 ; static gint proto_bta2dp_cph_scms_t = - 1 ; static gint ett_bta2dp_cph_scms_t = - 1 ; static int hf_bta2dp_acp_seid = - 1 ; static int hf_bta2dp_int_seid = - 1 ; static int hf_bta2dp_codec = - 1 ; static int hf_bta2dp_vendor_id = - 1 ; static int hf_bta2dp_vendor_codec_id = - 1 ; static int hf_bta2dp_content_protection = - 1 ; static int hf_bta2dp_stream_start_in_frame = - 1 ; static int hf_bta2dp_stream_end_in_frame = - 1 ; static int hf_bta2dp_stream_number = - 1 ; static int hf_bta2dp_l_bit = - 1 ; static int hf_bta2dp_cp_bit = - 1 ; static int hf_bta2dp_reserved = - 1 ; static dissector_handle_t sbc_handle ; static dissector_handle_t mp2t_handle ; static dissector_handle_t mpeg_audio_handle ; static dissector_handle_t atrac_handle ; static gboolean force_a2dp_scms_t = FALSE ; static gint force_a2dp_codec = CODEC_DEFAULT ; static const enum_val_t pref_a2dp_codec [ ] { { "default" "Default" CODEC_DEFAULT } { "sbc" "SBC" CODEC_SBC } { "mp2t" "MPEG12 AUDIO" CODEC_MPEG12_AUDIO } { "mpeg-audio" "MPEG24 AAC" CODEC_MPEG24_AAC } { "aptx" "aptX" CODEC_APT_X } { "aptx-hd" "aptX HD" CODEC_APT_X_HD } { "ldac" "LDAC" CODEC_LDAC } { NULL NULL 0 } } ; ; static gint proto_btvdp = - 1 ; static gint ett_btvdp = - 1 ; static gint proto_btvdp_cph_scms_t = - 1 ; static gint ett_btvdp_cph_scms_t = - 1 ; static int hf_btvdp_acp_seid = - 1 ; static int hf_btvdp_int_seid = - 1 ; static int hf_btvdp_codec = - 1 ; static int hf_btvdp_vendor_id = - 1 ; static int hf_btvdp_vendor_codec_id = - 1 ; static int hf_btvdp_content_protection = - 1 ; static int hf_btvdp_stream_start_in_frame = - 1 ; static int hf_btvdp_stream_end_in_frame = - 1 ; static int hf_btvdp_stream_number = - 1 ; static int hf_btvdp_l_bit = - 1 ; static int hf_btvdp_cp_bit = - 1 ; static int hf_btvdp_reserved = - 1 ; static dissector_handle_t h263_handle ; static dissector_handle_t mp4v_es_handle ; static gboolean force_vdp_scms_t = FALSE ; static gint force_vdp_codec = CODEC_H263_BASELINE ; static const enum_val_t pref_vdp_codec [ ] { { "h263" "H263" CODEC_H263_BASELINE } { "mp4v-es" "MPEG4 VSP" CODEC_MPEG4_VSP } { NULL NULL 0 } } ; ; static int proto_aptx = - 1 ; static int hf_aptx_data = - 1 ; static int hf_aptx_cumulative_frame_duration = - 1 ; static int hf_aptx_delta_time = - 1 ; static int hf_aptx_avrcp_song_position = - 1 ; static int hf_aptx_delta_time_from_the_beginning = - 1 ; static int hf_aptx_cumulative_duration = - 1 ; static int hf_aptx_diff = - 1 ; static gint ett_aptx = - 1 ; static dissector_handle_t aptx_handle ; static int proto_ldac = - 1 ; static int hf_ldac_fragmented = - 1 ; static int hf_ldac_starting_packet = - 1 ; static int hf_ldac_last_packet = - 1 ; static int hf_ldac_rfa = - 1 ; static int hf_ldac_number_of_frames = - 1 ; static int hf_ldac_syncword = - 1 ; static int hf_ldac_sampling_frequency = - 1 ; static int hf_ldac_channel_config_index = - 1 ; static int hf_ldac_frame_length_h = - 1 ; static int hf_ldac_frame_length_l = - 1 ; static int hf_ldac_frame_status = - 1 ; static int hf_ldac_expected_data_speed = - 1 ; static int hf_ldac_data = - 1 ; static gint ett_ldac = - 1 ; static gint ett_ldac_list = ; static expert_field ei_ldac_syncword = EI_INIT ; static expert_field ei_ldac_truncated_or_bad_length = EI_INIT ; static dissector_handle_t ldac_handle ; static const value_string ldac_channel_config_index_vals [ ] { { LDAC_CCI_MONO "Mono" } { LDAC_CCI_DUAL "Dual Channel" } { LDAC_CCI_STEREO "Stereo" } { 0 NULL } } ; ; static const value_string ldac_sampling_frequency_vals [ ] { { LDAC_FSID_044 "44.1 kHz" } { LDAC_FSID_048 "48.0 kHz" } { LDAC_FSID_088 "88.2 kHz" } { LDAC_FSID_096 "96.0 kHz" } { LDAC_FSID_176 "176.4 kHz" } { LDAC_FSID_192 "192.0 kHz" } { 0 NULL } } ; ; static const value_string message_type_vals [ ] { { 0x00 "Command" } { 0x01 "GeneralReject" } { 0x02 "ResponseAccept" } { 0x03 "ResponseReject" } { 0 NULL } } ; ; static const value_string packet_type_vals [ ] { { 0x00 "Single" } { 0x01 "Start" } { 0x02 "Continue" } { 0x03 "End" } { 0 NULL } } ; ; static const value_string signal_id_vals [ ] { { 0x00 "Reserved" } { 0x01 "Discover" } { 0x02 "GetCapabilities" } { 0x03 "SetConfiguration" } { 0x04 "GetConfiguration" } { 0x05 "Reconfigure" } { 0x06 "Open" } { 0x07 "Start" } { 0x08 "Close" } { 0x09 "Suspend" } { 0x0A "Abort" } { 0x0B "SecurityControl" } { 0x0C "GetAllCapabilities" } { 0x0D "DelayReport" } { 0 NULL } } ; ; static const value_string media_type_vals [ ] { { 0x00 "Audio" } { 0x01 "Video" } { 0x02 "Multimedia" } { 0 NULL } } ; ; static const value_string sep_type_vals [ ] { { 0x00 "Source" } { 0x01 "Sink" } { 0 NULL } } ; ; static const value_string true_false [ ] { { 0x00 "False" } { 0x01 "True" } { 0 NULL } } ; ; static const value_string error_code_vals [ ] { { 0x01 "Bad Header Format" } { 0x11 "Bad Length" } { 0x12 "Bad ACP SEID" } { 0x13 "SEP In Use" } { 0x14 "SEP Not In Use" } { 0x17 "Bad Service Category" } { 0x18 "Bad Payload Format" } { 0x19 "Not Supported Command" } { 0x1A "Invalid Capabilities" } { 0x22 "Bad Recovery Type" } { 0x23 "Bad Media Transport Format" } { 0x25 "Bad Recovery Format" } { 0x26 "Bad Header Compression Format" } { 0x27 "Bad Content Protection Format" } { 0x28 "Bad Multiplexing Format" } { 0x29 "Unsupported Configuration" } { 0x31 "Bad State" } { 0x80 "The Service Category Stated is Invalid" } { 0x81 "Lack of Resource New Stream Context" } { 0xC1 "Invalid Codec Type" } { 0xC2 "Not Supported Codec Type" } { 0xC3 "Invalid Sampling Frequency" } { 0xC4 "Not Supported Sampling Frequency" } { 0xC5 "Invalid Channel Mode" } { 0xC6 "Not Supported Channel Mode" } { 0xC7 "Invalid Subbands" } { 0xC8 "Not Supported Subbands" } { 0xC9 "Invalid Allocation Method" } { 0xCA "Not Supported Allocation Method" } { 0xCB "Invalid Minimum Bitpool Value" } { 0xCC "Not Supported Minimum Bitpool Value" } { 0xCD "Invalid Maximum Bitpool Value" } { 0xCE "Not Supported Maximum Bitpool Value" } { 0xCF "Invalid Layer" } { 0xD0 "Not Supported Layer" } { 0xD1 "Not Supported CRC" } { 0xD2 "Not Supported MPF" } { 0xD3 "Not Supported VBR" } { 0xD4 "Invalid Bit Rate" } { 0xD5 "Not Supported Bit Rate" } { 0xD6 "Invalid Object Type" } { 0xD7 "Not Supported Object Type" } { 0xD8 "Invalid Channels" } { 0xD9 "Not Supported Channels" } { 0xDA "Invalid Version" } { 0xDB "Not Supported Version" } { 0xDC "Not Supported Maximum SUL" } { 0xDD "Invalid Block Length" } { 0xE0 "Invalid Content Protection Type" } { 0xE1 "Invalid Content Protection Format" } { 0xE2 "Invalid Coded Parameter" } { 0xE3 "Not Supported Codec Parameter" } { 0 NULL } } ; ; static const value_string service_category_vals [ ] { { 0x01 "Media Transport" } { 0x02 "Reporting" } { 0x03 "Recovery" } { 0x04 "Content Protection" } { 0x05 "Header Compression" } { 0x06 "Multiplexing" } { 0x07 "Media Codec" } { 0x08 "Delay Reporting" } { 0 NULL } } ; ; static const value_string recovery_type_vals [ ] { { 0x00 "Forbidden" } { 0x01 "RFC2733" } { 0 NULL } } ; ; static const value_string multiplexing_tsid_vals [ ] { { 0x00 "Used for TSID query" } { 0x1F "RFD" } { 0 NULL } } ; ; static const value_string multiplexing_tcid_vals [ ] { { 0x00 "Used for TCID query" } { 0x1F "RFD" } { 0 NULL } } ; ; static const value_string media_codec_audio_type_vals [ ] { { 0x00 "SBC" } { 0x01 "MPEG-1,2 Audio" } { 0x02 "MPEG-2,4 AAC" } { 0x04 "ATRAC family" } { 0xFF "non-A2DP" } { 0 NULL } } ; ; static const value_string media_codec_video_type_vals [ ] { { 0x01 "H.263 baseline" } { 0x02 "MPEG-4 Visual Simple Profile" } { 0x03 "H.263 profile 3" } { 0x04 "H.263 profile 8" } { 0xFF "non-VDP" } { 0 NULL } } ; ; static const value_string content_protection_type_vals [ ] { { 0x01 "DTCP" } { 0x02 "SCMS-T" } { 0 NULL } } ; ; static const value_string vendor_apt_codec_vals [ ] { { CODECID_APT_X "aptX" } { CODECID_APT_X_HD "aptX HD" } { 0 NULL } } ; ; static const value_string vendor_ldac_codec_vals [ ] { { 0x00AA "LDAC" } { 0 NULL } } ; ; sep_state { SEP_STATE_FREE , SEP_STATE_OPEN , SEP_STATE_IN_USE } _sep_entry_t { guint8 seid ; guint8 type ; guint8 media_type ; guint8 int_seid ; gint codec ; guint32 vendor_id ; guint16 vendor_codec ; guint8 configuration_length ; guint8 * configuration ; gint content_protection_type ; enum sep_state state ; } sep_entry_t 