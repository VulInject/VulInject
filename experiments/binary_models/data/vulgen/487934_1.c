obj_som_compiler ( ) int unused ; { char * buf ; char c ; char * filename ; char * language_name ; char * p ; char * version_id ; if ( compiler_seen ) { as_bad ( "Only one .compiler pseudo-op per file!" ) ; ignore_rest_of_line ( ) ; return ; } SKIP_WHITESPACE ( ) ; if ( * input_line_pointer == '\"' ) { buf = input_line_pointer ; ++ input_line_pointer ; while ( is_a_char ( next_char_of_string ( ) ) ) { } c = * input_line_pointer ; * input_line_pointer = '\000' ; } else { as_bad ( "Expected quoted string" ) ; ignore_rest_of_line ( ) ; return ; } filename = buf + 1 ; p = filename ; while ( * p != ' ' && * p != '\000' ) { p ++ ; } if ( * p == '\000' ) { as_bad ( ".compiler directive missing language and version" ) ; return ; } * p = '\000' ; language_name = ++ p ; while ( * p != ' ' && * p != '\000' ) { p ++ ; } if ( * p == '\000' ) { as_bad ( ".compiler directive missing version" ) ; return ; } * p = '\000' ; version_id = ++ p ; while ( * p != '\000' ) { p ++ ; } * ( -- p ) = '\000' ; compiler_seen = 1 ; if ( ! bfd_som_attach_compilation_unit ( stdoutput , filename , language_name , "GNU Tools" , version_id ) ) { bfd_perror ( stdoutput -> filename ) ; as_fatal ( "FATAL: Attaching compiler header %s" , stdoutput -> filename ) ; } * input_line_pointer = c ; } 