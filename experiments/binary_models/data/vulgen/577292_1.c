ospf_delete_discard_route ( , ) { struct route_node * rn ; ospf_route * or ; if ( IS_DEBUG_OSPF_EVENT ) { zlog_debug ( "ospf_delete_discard_route(): " "deleting %s/%d" , inet_ntoa ( p -> prefix ) , p -> prefixlen ) ; } rn = route_node_lookup ( rt , ( prefix * ) p ) ; if ( rn == NULL ) { if ( IS_DEBUG_OSPF_EVENT ) { zlog_debug ( "ospf_delete_discard_route(): no route found" ) ; } return ; } or = rn -> info ; if ( or -> path_type == OSPF_PATH_INTRA_AREA ) { if ( IS_DEBUG_OSPF_EVENT ) { zlog_debug ( "ospf_delete_discard_route(): " "an intra-area route exists" ) ; } return ; } if ( or -> type != OSPF_DESTINATION_DISCARD ) { if ( IS_DEBUG_OSPF_EVENT ) { zlog_debug ( "ospf_delete_discard_route(): " "not a discard entry" ) ; } return ; } rn -> info = NULL ; route_unlock_node ( rn ) ; route_unlock_node ( rn ) ; ospf_zebra_delete_discard ( p ) ; return ; } 