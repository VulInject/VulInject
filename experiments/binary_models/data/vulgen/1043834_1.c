sds_read ( , , , ) { int count , total = 0 ; while ( total < len ) { if ( psds -> read_block * psds -> samplesperblock >= psds -> frames ) { memset ( & ( ptr [ total ] ) , 0 , ( len - total ) * sizeof ( int ) ) ; return total ; } count = ( psds -> samplesperblock - psds -> read_count ) ; count = ( len - total > count ) ?count : len - total ; memcpy ( & ( ptr [ total ] ) , & ( psds -> read_samples [ psds -> read_count ] ) , count * sizeof ( int ) ) ; total += count ; psds -> read_count += count ; } return total ; } 