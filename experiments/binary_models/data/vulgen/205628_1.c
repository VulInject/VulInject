static void radeon_ttm_tt_unpopulate ( struct ttm_device * bdev , struct ttm_tt * ttm ) { struct radeon_device * rdev = radeon_get_rdev ( bdev ) ; struct radeon_ttm_tt * gtt = radeon_ttm_tt_to_gtt ( rdev , ttm ) ; bool slave = ! ! ( ttm -> page_flags & TTM_TT_FLAG_EXTERNAL ) ; radeon_ttm_tt_unbind ( bdev , ttm ) ; if ( gtt && gtt -> userptr ) { kfree ( ttm -> sg ) ; return ; } if ( slave ) { return ; } return ttm_pool_free ( & rdev -> mman . bdev . pool , ttm ) ; } 