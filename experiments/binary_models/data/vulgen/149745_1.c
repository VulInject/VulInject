BOOL freerdp_client_send_button_event ( rdpClientContext * cctx , BOOL relative , UINT16 mflags , INT32 x , INT32 y ) { BOOL handled = FALSE ; WINPR_ASSERT ( cctx ) ; if ( cctx -> ainput ) { UINT64 flags = 0 ; BOOL relativeInput = freerdp_settings_get_bool ( cctx -> context . settings , FreeRDP_MouseUseRelativeMove ) ; if ( relative ) { flags |= AINPUT_FLAGS_REL ; } if ( mflags & PTR_FLAGS_DOWN ) { flags |= AINPUT_FLAGS_DOWN ; } if ( mflags & PTR_FLAGS_BUTTON1 ) { flags |= AINPUT_FLAGS_BUTTON1 ; } if ( mflags & PTR_FLAGS_BUTTON2 ) { flags |= AINPUT_FLAGS_BUTTON2 ; } if ( mflags & PTR_FLAGS_BUTTON3 ) { flags |= AINPUT_FLAGS_BUTTON3 ; } if ( mflags & PTR_FLAGS_MOVE ) { flags |= AINPUT_FLAGS_MOVE ; } handled = ainput_send_diff_event ( cctx , flags , x , y ) ; } if ( ! handled ) { if ( relative ) { cctx -> lastX += x ; cctx -> lastY += y ; WLog_WARN ( TAG , "Relative mouse input channel not available, sending absolute!" ) ; } else { cctx -> lastX = x ; cctx -> lastY = y ; } freerdp_input_send_mouse_event ( cctx -> context . input , mflags , ( UINT16 ) cctx -> lastX , ( UINT16 ) cctx -> lastY ) ; } return TRUE ; } 