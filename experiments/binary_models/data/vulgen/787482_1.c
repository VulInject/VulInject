DDII ddi_xbuf_attr_t ddi_xbuf_attr_create ( size_t xsize , void * xa_strategy ( struct buf * bp , ddi_xbuf_t xp , void * attr_arg ) , void * attr_arg , uint32_t active_limit , uint32_t reserve_limit , major_t major , int flags ) { ddi_xbuf_attr_t xap ; xap = kmem_zalloc ( sizeof ( __ddi_xbuf_attr ) , KM_SLEEP ) ; mutex_init ( & xap -> xa_mutex , NULL , MUTEX_DRIVER , NULL ) ; mutex_init ( & xap -> xa_reserve_mutex , NULL , MUTEX_DRIVER , NULL ) ; xap -> xa_allocsize = max ( xsize , sizeof ( void * ) ) ; xap -> xa_active_limit = active_limit ; xap -> xa_active_lowater = xap -> xa_active_limit / 2 ; xap -> xa_reserve_limit = reserve_limit ; xap -> xa_strategy = xa_strategy ; xap -> xa_attr_arg = attr_arg ; mutex_enter ( & xbuf_mutex ) ; xbuf_refcount ++ ; mutex_exit ( & xbuf_mutex ) ; xap -> xa_tq = xbuf_tq ; return ( xap ) ; } 