void tpm2_util_tpmt_public_to_yaml ( TPMT_PUBLIC * public , char * indent ) { if ( ! indent ) { indent = "" ; } tpm2_tool_output ( "%sname-alg:\n" , indent ) ; tpm2_tool_output ( "%s  value: %s\n" , indent , tpm2_alg_util_algtostr ( public -> nameAlg , tpm2_alg_util_flags_any ) ) ; tpm2_tool_output ( "%s  raw: 0x%x\n" , indent , public -> nameAlg ) ; tpm2_util_tpma_object_to_yaml ( public -> objectAttributes , indent ) ; tpm2_tool_output ( "%stype:\n" , indent ) ; tpm2_tool_output ( "%s  value: %s\n" , indent , tpm2_alg_util_algtostr ( public -> type , tpm2_alg_util_flags_any ) ) ; tpm2_tool_output ( "%s  raw: 0x%x\n" , indent , public -> type ) ; switch ( public -> type ) { case TPM2_ALG_SYMCIPHER : { TPMS_SYMCIPHER_PARMS * s = & public -> parameters . symDetail ; } break ; case TPM2_ALG_KEYEDHASH : { TPMS_KEYEDHASH_PARMS * k = & public -> parameters . keyedHashDetail ; tpm2_tool_output ( "%salgorithm: \n" , indent ) ; tpm2_tool_output ( "%s  value: %s\n" , indent , tpm2_alg_util_algtostr ( k -> scheme . scheme , tpm2_alg_util_flags_any ) ) ; tpm2_tool_output ( "%s  raw: 0x%x\n" , indent , k -> scheme . scheme ) ; if ( k -> scheme . scheme == TPM2_ALG_HMAC ) { tpm2_tool_output ( "%shash-alg:\n" , indent ) ; tpm2_tool_output ( "%s  value: %s\n" , indent , tpm2_alg_util_algtostr ( k -> scheme . details . hmac . hashAlg , tpm2_alg_util_flags_any ) ) ; tpm2_tool_output ( "%s  raw: 0x%x\n" , indent , k -> scheme . details . hmac . hashAlg ) ; } if ( k -> scheme . scheme == TPM2_ALG_XOR ) { tpm2_tool_output ( "%shash-alg:\n" , indent ) ; tpm2_tool_output ( "%s  value: %s\n" , indent , tpm2_alg_util_algtostr ( k -> scheme . details . exclusiveOr . hashAlg , tpm2_alg_util_flags_any ) ) ; tpm2_tool_output ( "%s  raw: 0x%x\n" , indent , k -> scheme . details . exclusiveOr . hashAlg ) ; tpm2_tool_output ( "%skdfa-alg:\n" , indent ) ; tpm2_tool_output ( "%s  value: %s\n" , indent , tpm2_alg_util_algtostr ( k -> scheme . details . exclusiveOr . kdf , tpm2_alg_util_flags_any ) ) ; tpm2_tool_output ( "%s  raw: 0x%x\n" , indent , k -> scheme . details . exclusiveOr . kdf ) ; } } break ; case TPM2_ALG_RSA : { TPMS_RSA_PARMS * r = & public -> parameters . rsaDetail ; tpm2_tool_output ( "%sexponent: %u\n" , indent , r -> exponent ?r -> exponent : 65537 ) ; tpm2_tool_output ( "%sbits: %u\n" , indent , r -> keyBits ) ; print_rsa_scheme ( & r -> scheme , indent ) ; print_sym ( & r -> symmetric , indent ) ; } break ; case TPM2_ALG_ECC : { TPMS_ECC_PARMS * e = & public -> parameters . eccDetail ; tpm2_tool_output ( "%scurve-id:\n" , indent ) ; tpm2_tool_output ( "%s  value: %s\n" , indent , tpm2_alg_util_ecc_to_str ( e -> curveID ) ) ; tpm2_tool_output ( "%s  raw: 0x%x\n" , indent , e -> curveID ) ; print_kdf_scheme ( & e -> kdf , indent ) ; print_ecc_scheme ( & e -> scheme , indent ) ; print_sym ( & e -> symmetric , indent ) ; } break ; } tpm2_util_keydata keydata = TPM2_UTIL_KEYDATA_INIT ; tpm2_util_public_to_keydata ( public , & keydata ) ; UINT16 i ; for ( i = 0 ; i < keydata . len ; i ++ ) { tpm2_tool_output ( "%s%s: " , indent , keydata . entries [ i ] . name ) ; tpm2_util_print_tpm2b ( keydata . entries [ i ] . value ) ; tpm2_tool_output ( "%s\n" , indent ) ; } if ( public -> authPolicy . size ) { tpm2_tool_output ( "%sauthorization policy: " , indent ) ; tpm2_util_hexdump ( public -> authPolicy . buffer , public -> authPolicy . size ) ; tpm2_tool_output ( "%s\n" , indent ) ; } } 