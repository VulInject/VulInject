void spriteset_unref ( spriteset_t * it ) { iter_t iter ; struct pose * pose ; if ( it == NULL || -- it -> refcount > 0 ) { return ; } console_log ( 3 , "disposing spriteset #%u no longer in use" , it -> id ) ; iter = vector_enum ( it -> images ) ; while ( iter_next ( & iter ) ) { image_unref ( * ( image_t * * ) iter . ptr ) ; } vector_free ( it -> images ) ; iter = vector_enum ( it -> poses ) ; while ( iter_next ( & iter ) ) { pose = iter . ptr ; vector_free ( pose -> frames ) ; lstr_free ( pose -> name ) ; } vector_free ( it -> poses ) ; free ( it ) ; } 