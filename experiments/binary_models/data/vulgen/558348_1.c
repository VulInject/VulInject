static int pcmcia_probe ( struct sa1111_dev * dev ) { void __iomem * base ; int ret ; ret = sa1111_enable_device ( dev ) ; if ( ret ) { return ret ; } dev_set_drvdata ( & dev -> dev , NULL ) ; if ( ! request_mem_region ( dev -> res . start , 512 , SA1111_DRIVER_NAME ( dev ) ) ) { return - EBUSY ; } base = dev -> mapbase ; sa1111_writel ( PCSSR_S0_SLEEP | PCSSR_S1_SLEEP , base + PCSSR ) ; sa1111_writel ( PCCR_S0_FLT | PCCR_S1_FLT , base + PCCR ) ; ret = - ENODEV ; if ( machine_is_badge4 ( ) ) { ret = pcmcia_badge4_init ( dev ) ; } if ( machine_is_jornada720 ( ) ) { ret = pcmcia_jornada720_init ( dev ) ; } if ( machine_is_lubbock ( ) ) { ret = pcmcia_lubbock_init ( dev ) ; } if ( machine_is_assabet ( ) ) { ret = pcmcia_neponset_init ( dev ) ; } if ( ret ) { release_mem_region ( dev -> res . start , 512 ) ; sa1111_disable_device ( dev ) ; } return ret ; } 