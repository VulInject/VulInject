void vce_v1_0_enable_mgcg ( struct radeon_device * rdev , bool enable ) { u32 tmp ; if ( enable && ( rdev -> cg_flags & RADEON_CG_SUPPORT_VCE_MGCG ) ) { tmp = RREG32 ( VCE_CLOCK_GATING_A ) ; tmp |= CGC_DYN_CLOCK_MODE ; WREG32 ( VCE_CLOCK_GATING_A , tmp ) ; tmp = RREG32 ( VCE_UENC_CLOCK_GATING ) ; tmp &= ~ 0x1ff000 ; tmp |= 0xff800000 ; WREG32 ( VCE_UENC_CLOCK_GATING , tmp ) ; tmp = RREG32 ( VCE_UENC_REG_CLOCK_GATING ) ; tmp &= ~ 0x3ff ; WREG32 ( VCE_UENC_REG_CLOCK_GATING , tmp ) ; } else { tmp = RREG32 ( VCE_CLOCK_GATING_A ) ; tmp &= ~ CGC_DYN_CLOCK_MODE ; WREG32 ( VCE_CLOCK_GATING_A , tmp ) ; tmp = RREG32 ( VCE_UENC_CLOCK_GATING ) ; tmp |= 0x1ff000 ; tmp &= ~ 0xff800000 ; WREG32 ( VCE_UENC_CLOCK_GATING , tmp ) ; tmp = RREG32 ( VCE_UENC_REG_CLOCK_GATING ) ; tmp |= 0x3ff ; } } 