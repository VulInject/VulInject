static int rtl8192eu_identify_chip ( struct rtl8xxxu_priv * priv ) { struct device * dev = & priv -> udev -> dev ; u32 val32 , bonding , sys_cfg , vendor ; int ret = 0 ; sys_cfg = rtl8xxxu_read32 ( priv , REG_SYS_CFG ) ; priv -> chip_cut = u32_get_bits ( sys_cfg , SYS_CFG_CHIP_VERSION_MASK ) ; if ( sys_cfg & SYS_CFG_TRP_VAUX_EN ) { dev_info ( dev , "Unsupported test chip\n" ) ; ret = - ENOTSUPP ; out } bonding = rtl8xxxu_read32 ( priv , REG_HPON_FSM ) ; bonding &= HPON_FSM_BONDING_MASK ; if ( bonding == HPON_FSM_BONDING_1T2R ) { strscpy ( priv -> chip_name , "8191EU" , sizeof ( priv -> chip_name ) ) ; priv -> tx_paths = 1 ; priv -> rtl_chip = RTL8191E ; } else { strscpy ( priv -> chip_name , "8192EU" , sizeof ( priv -> chip_name ) ) ; priv -> tx_paths = 2 ; priv -> rtl_chip = RTL8192E ; } priv -> rf_paths = 2 ; priv -> rx_paths = 2 ; priv -> has_wifi = 1 ; vendor = sys_cfg & SYS_CFG_VENDOR_EXT_MASK ; rtl8xxxu_identify_vendor_2bits ( priv , vendor ) ; val32 = rtl8xxxu_read32 ( priv , REG_GPIO_OUTSTS ) ; rtl8xxxu_config_endpoints_sie ( priv ) ; if ( ! priv -> ep_tx_count ) { ret = rtl8xxxu_config_endpoints_no_sie ( priv ) ; } out return ret ; } 