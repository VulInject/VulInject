digest_HA2 ( , , ) { ret_t ret ; const char * method ; cuint_t method_len ; ret = cherokee_http_method_to_string ( conn -> header . method , & method , & method_len ) ; if ( unlikely ( ret != ret_ok ) ) { return ret ; } cherokee_buffer_ensure_size ( buf , method_len + 1 + validator -> uri . len ) ; cherokee_buffer_add ( buf , method , method_len ) ; cherokee_buffer_add_str ( buf , ":" ) ; cherokee_buffer_add_buffer ( buf , & validator -> uri ) ; cherokee_buffer_encode_md5_digest ( buf ) ; return ret_ok ; } 