static void config_acp_dma ( struct acp_dev_data * adata , struct acp_stream * stream , int size ) { struct snd_pcm_substream * substream = stream -> substream ; struct acp_resource * rsrc = adata -> rsrc ; dma_addr_t addr = substream -> dma_buffer . addr ; int num_pages = ( PAGE_ALIGN ( size ) >> PAGE_SHIFT ) ; u32 low , high , val ; u16 page_idx ; val = stream -> pte_offset ; for ( page_idx = 0 ; page_idx < num_pages ; page_idx ++ ) { low = lower_32_bits ( addr ) ; high = upper_32_bits ( addr ) ; writel ( low , adata -> acp_base + rsrc -> scratch_reg_offset + val ) ; writel ( high , adata -> acp_base + rsrc -> scratch_reg_offset + val + 4 ) ; val += 8 ; addr += PAGE_SIZE ; } } 