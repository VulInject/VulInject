static void can_receive ( struct sk_buff * skb , struct net_device * dev ) { struct can_dev_rcv_lists * dev_rcv_lists ; struct net * net = dev_net ( dev ) ; struct can_pkg_stats * pkg_stats = net -> can . pkg_stats ; int matches ; pkg_stats -> rx_frames ++ ; pkg_stats -> rx_frames_delta ++ ; while ( ! ( can_skb_prv ( skb ) -> skbcnt ) ) { can_skb_prv ( skb ) -> skbcnt = atomic_inc_return ( & skbcounter ) ; } rcu_read_lock ( ) ; matches = can_rcv_filter ( net -> can . rx_alldev_list , skb ) ; dev_rcv_lists = can_dev_rcv_lists_find ( net , dev ) ; matches += can_rcv_filter ( dev_rcv_lists , skb ) ; rcu_read_unlock ( ) ; consume_skb ( skb ) ; } 