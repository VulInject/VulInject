static inline int verify_sec_ctx_len ( struct nlattr * * attrs , struct netlink_ext_ack * extack ) { struct nlattr * rt = attrs [ XFRMA_SEC_CTX ] ; struct xfrm_user_sec_ctx * uctx ; uctx = nla_data ( rt ) ; if ( uctx -> len > nla_len ( rt ) || uctx -> len != ( sizeof ( xfrm_user_sec_ctx ) + uctx -> ctx_len ) ) { NL_SET_ERR_MSG ( extack , "Invalid security context length" ) ; return - EINVAL ; } return 0 ; } 