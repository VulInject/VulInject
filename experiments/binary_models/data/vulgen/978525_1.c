char * httpMD5Final ( const char * nonce , const char * method , const char * resource , char md5 [ 33 ] ) { char line [ 1024 ] ; char a2 [ 33 ] ; snprintf ( line , sizeof ( line ) , "%s:%s" , method , resource ) ; cupsHashData ( "md5" , ( unsigned char * ) line , strlen ( line ) , sum , sizeof ( sum ) ) ; cupsHashString ( sum , sizeof ( sum ) , a2 , sizeof ( a2 ) ) ; snprintf ( line , sizeof ( line ) , "%s:%s:%s" , md5 , nonce , a2 ) ; cupsHashData ( "md5" , ( unsigned char * ) line , strlen ( line ) , sum , sizeof ( sum ) ) ; return ( ( char * ) cupsHashString ( sum , sizeof ( sum ) , md5 , 33 ) ) ; } 