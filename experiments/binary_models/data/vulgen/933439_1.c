static void ospf6_handle_external_aggr_update ( struct ospf6 * ospf6 ) { struct route_node * rn = NULL ; int ret ; if ( IS_OSPF6_DEBUG_AGGR ) { zlog_debug ( "%s: Process modified aggregators." , __func__ ) ; } for ( rn = route_top ( ospf6 -> rt_aggr_tbl ) ; rn ; rn = route_next ( rn ) ) { struct ospf6_external_aggr_rt * aggr ; aggr = rn -> info ; if ( aggr -> action == OSPF6_ROUTE_AGGR_DEL ) { aggr -> action = OSPF6_ROUTE_AGGR_NONE ; ospf6_asbr_summary_config_delete ( ospf6 , rn ) ; if ( OSPF6_EXTERNAL_RT_COUNT ( aggr ) ) { hash_clean ( aggr -> match_extnl_hash , ospf6_aggr_handle_external_info ) ; } hash_free ( aggr -> match_extnl_hash ) ; XFREE ( MTYPE_OSPF6_EXTERNAL_RT_AGGR , aggr ) ; } if ( aggr -> action == OSPF6_ROUTE_AGGR_MODIFY ) { aggr -> action = OSPF6_ROUTE_AGGR_NONE ; if ( CHECK_FLAG ( aggr -> aggrflags , OSPF6_EXTERNAL_AGGRT_ORIGINATED ) && ! CHECK_FLAG ( aggr -> aggrflags , OSPF6_EXTERNAL_AGGRT_NO_ADVERTISE ) ) { ret = ospf6_handle_external_aggr_modify ( ospf6 , aggr ) ; if ( ret == OSPF6_FAILURE ) { continue ; } } ospf6_aggr_handle_advertise_change ( ospf6 , aggr ) ; } } } 