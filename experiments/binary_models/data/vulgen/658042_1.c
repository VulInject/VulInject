static u32 imx_ahci_parse_props ( struct device * dev , const struct reg_property * prop , size_t num ) { struct device_node * np = dev -> of_node ; u32 reg_value = 0 ; int i , j ; for ( i = 0 ; i < num ; i ++ , prop ++ ) { u32 of_val ; if ( prop -> num_values == 0 ) { if ( of_property_read_bool ( np , prop -> name ) ) { reg_value |= prop -> set_value ; } else { reg_value |= prop -> def_value ; } continue ; } if ( of_property_read_u32 ( np , prop -> name , & of_val ) ) { dev_info ( dev , "%s not specified, using %08x\n" , prop -> name , prop -> def_value ) ; reg_value |= prop -> def_value ; continue ; } for ( j = 0 ; j < prop -> num_values ; j ++ ) { if ( prop -> values [ j ] . of_value == of_val ) { dev_info ( dev , "%s value %u, using %08x\n" , prop -> name , of_val , prop -> values [ j ] . reg_value ) ; reg_value |= prop -> values [ j ] . reg_value ; break ; } } } return reg_value ; } 