static int rxkad_preparse_server_key ( struct key_preparsed_payload * prep ) { struct crypto_skcipher * ci ; memcpy ( & prep -> payload . data [ 2 ] , prep -> data , 8 ) ; ci = crypto_alloc_skcipher ( "pcbc(des)" , 0 , CRYPTO_ALG_ASYNC ) ; if ( IS_ERR ( ci ) ) { _leave ( " = %ld" , PTR_ERR ( ci ) ) ; return PTR_ERR ( ci ) ; } if ( crypto_skcipher_setkey ( ci , prep -> data , 8 ) < 0 ) { BUG ( ) ; } prep -> payload . data [ 0 ] = ci ; _leave ( " = 0" ) ; return 0 ; } 