_mongoc_rand_bytes ( , ) { NTSTATUS status ; NTSTATUS status = 0 ; if ( ! algorithm ) { status = BCryptOpenAlgorithmProvider ( & algorithm , BCRYPT_RNG_ALGORITHM , NULL , 0 ) ; if ( ! NT_SUCCESS ( status ) ) { MONGOC_ERROR ( "BCryptOpenAlgorithmProvider(): %ld" , status ) ; return 0 ; } } status = BCryptGenRandom ( algorithm , buf , num , 0 ) ; if ( NT_SUCCESS ( status ) ) { return 1 ; } MONGOC_ERROR ( "BCryptGenRandom(): %ld" , status ) ; return 0 ; } 