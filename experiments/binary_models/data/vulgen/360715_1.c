static struct usb_rx * alloc_rx_struct ( void ) { struct usb_rx * r = NULL ; int ret = 0 ; r = kmalloc ( sizeof ( * r ) , GFP_KERNEL ) ; if ( ! r ) { ret = - ENOMEM ; out } r -> urb = usb_alloc_urb ( 0 , GFP_KERNEL ) ; if ( ! r -> urb || ! r -> buf ) { ret = - ENOMEM ; out } out if ( ret < 0 ) { if ( r ) { usb_free_urb ( r -> urb ) ; kfree ( r -> buf ) ; kfree ( r ) ; } return NULL ; } return r ; } 