static int rt5659_set_tdm_slot ( struct snd_soc_dai * dai , unsigned int tx_mask , unsigned int rx_mask , int slots , int slot_width ) { struct snd_soc_codec * codec = dai -> codec ; unsigned int val = 0 ; switch ( slots ) { case 4 : val |= ( 1 << 10 ) ; val |= ( 1 << 8 ) ; break ; case 6 : val |= ( 2 << 10 ) ; val |= ( 2 << 8 ) ; break ; case 8 : val |= ( 3 << 10 ) ; val |= ( 3 << 8 ) ; break ; case 2 : break ; default : return - EINVAL ; } switch ( slot_width ) { case 20 : val |= ( 1 << 6 ) ; val |= ( 1 << 4 ) ; break ; case 24 : val |= ( 2 << 6 ) ; val |= ( 2 << 4 ) ; break ; case 32 : val |= ( 3 << 6 ) ; val |= ( 3 << 4 ) ; break ; case 16 : break ; default : return - EINVAL ; } snd_soc_update_bits ( codec , RT5659_TDM_CTRL_1 , 0x8ff0 , val ) ; return 0 ; } 