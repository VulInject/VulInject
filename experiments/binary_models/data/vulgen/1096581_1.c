int pvrdma_uar_table_init ( struct pvrdma_dev * dev ) { u32 num = dev -> dsr -> caps . max_uar ; u32 mask = num - 1 ; struct pvrdma_id_table * tbl = & dev -> uar_table . tbl ; if ( ! is_power_of_2 ( num ) ) { return - EINVAL ; } tbl -> last = 0 ; tbl -> top = 0 ; tbl -> max = num ; tbl -> mask = mask ; spin_lock_init ( & tbl -> lock ) ; tbl -> table = bitmap_zalloc ( num , GFP_KERNEL ) ; __set_bit ( 0 , tbl -> table ) ; return 0 ; } 