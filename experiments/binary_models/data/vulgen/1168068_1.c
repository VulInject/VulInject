static void GFileChooserCreateChildren ( GFileChooser * gfc , int flags ) { GGadgetCreateData gcd [ 9 ] , boxes [ 4 ] , * varray [ 9 ] , * harray [ 12 ] , * harray2 [ 4 ] ; GTextInfo label [ 9 ] ; int k = 0 , l = 0 , homek , upk , bookk , confk , dirsk , subdirsk , filesk , textk ; memset ( & gcd , '\0' , sizeof ( gcd ) ) ; memset ( & boxes , '\0' , sizeof ( boxes ) ) ; memset ( & label , '\0' , sizeof ( label ) ) ; gcd [ k ] . gd . flags = gg_visible | gg_enabled ; gcd [ k ] . gd . popup_msg = _ ( "Home Folder" ) ; label [ k ] . image = & _GIcon_homefolder ; gcd [ k ] . gd . label = & label [ k ] ; gcd [ k ] . gd . handle_controlevent = GFileChooserHome ; homek = k ; gcd [ k ++ ] . creator = GButtonCreate ; harray [ l ++ ] = & gcd [ k - 1 ] ; harray [ l ++ ] = GCD_Glue ; gcd [ k ] . gd . flags = gg_visible | gg_enabled ; gcd [ k ] . gd . popup_msg = _ ( "Bookmarks" ) ; label [ k ] . image = & _GIcon_bookmark ; gcd [ k ] . gd . label = & label [ k ] ; gcd [ k ] . gd . handle_controlevent = GFileChooserBookmarks ; bookk = k ; gcd [ k ++ ] . creator = GButtonCreate ; harray [ l ++ ] = & gcd [ k - 1 ] ; harray [ l ++ ] = GCD_Glue ; gcd [ k ] . gd . flags = gg_visible | gg_enabled | gg_list_exactlyone ; gcd [ k ] . gd . handle_controlevent = GFileChooserDListChanged ; dirsk = k ; gcd [ k ++ ] . creator = GListButtonCreate ; harray [ l ++ ] = & gcd [ k - 1 ] ; harray [ l ++ ] = GCD_Glue ; gcd [ k ] . gd . flags = gg_visible | gg_enabled ; gcd [ k ] . gd . popup_msg = _ ( "Parent Folder" ) ; label [ k ] . image = & _GIcon_updir ; gcd [ k ] . gd . label = & label [ k ] ; gcd [ k ] . gd . handle_controlevent = GFileChooserUpDirButton ; upk = k ; gcd [ k ++ ] . creator = GButtonCreate ; harray [ l ++ ] = & gcd [ k - 1 ] ; harray [ l ++ ] = GCD_Glue ; gcd [ k ] . gd . flags = gg_visible | gg_enabled ; gcd [ k ] . gd . popup_msg = _ ( "Configure" ) ; label [ k ] . image = & _GIcon_configtool ; gcd [ k ] . gd . label = & label [ k ] ; gcd [ k ] . gd . handle_controlevent = GFileChooserConfigure ; confk = k ; gcd [ k ++ ] . creator = GButtonCreate ; harray [ l ++ ] = & gcd [ k - 1 ] ; harray [ l ++ ] = NULL ; boxes [ 2 ] . gd . flags = gg_enabled | gg_visible ; boxes [ 2 ] . gd . u . boxelements = harray ; boxes [ 2 ] . creator = GHBoxCreate ; l = 0 ; varray [ l ++ ] = & boxes [ 2 ] ; if ( dir_placement == dirs_separate ) { gcd [ k ] . gd . flags = gg_visible | gg_enabled | gg_list_alphabetic | gg_list_exactlyone ; } else { gcd [ k ] . gd . flags = gg_enabled | gg_list_alphabetic | gg_list_exactlyone ; } gcd [ k ] . gd . handle_controlevent = GFileChooserFListSelected ; subdirsk = k ; gcd [ k ++ ] . creator = GListCreate ; harray2 [ 0 ] = & gcd [ k - 1 ] ; if ( flags & gg_file_multiple ) { gcd [ k ] . gd . flags = gg_visible | gg_enabled | gg_list_alphabetic | gg_list_multiplesel ; } else { gcd [ k ] . gd . flags = gg_visible | gg_enabled | gg_list_alphabetic | gg_list_exactlyone ; } gcd [ k ] . gd . handle_controlevent = GFileChooserFListSelected ; filesk = k ; gcd [ k ++ ] . creator = GListCreate ; harray2 [ 1 ] = & gcd [ k - 1 ] ; harray2 [ 2 ] = NULL ; boxes [ 3 ] . gd . flags = gg_enabled | gg_visible ; boxes [ 3 ] . gd . u . boxelements = harray2 ; boxes [ 3 ] . creator = GHBoxCreate ; varray [ l ++ ] = & boxes [ 3 ] ; gcd [ k ] . gd . flags = gg_visible | gg_enabled ; gcd [ k ] . gd . handle_controlevent = GFileChooserTextChanged ; textk = k ; else { gcd [ k ++ ] . creator = GTextCompletionCreate ; } varray [ l ++ ] = & gcd [ k - 1 ] ; varray [ l ] = NULL ; boxes [ 0 ] . gd . pos . x = gfc -> g . r . x ; boxes [ 0 ] . gd . pos . y = gfc -> g . r . y ; boxes [ 0 ] . gd . pos . width = gfc -> g . r . width ; boxes [ 0 ] . gd . pos . height = gfc -> g . r . height ; boxes [ 0 ] . gd . flags = gg_enabled | gg_visible ; boxes [ 0 ] . gd . u . boxelements = varray ; boxes [ 0 ] . creator = GVBoxCreate ; for ( l = 0 ; l < k ; ++ l ) { gcd [ l ] . data = gfc ; } GGadgetsCreate ( gfc -> g . base , boxes ) ; gfc -> topbox = ( GHVBox * ) boxes [ 0 ] . ret ; gfc -> home = ( GButton * ) gcd [ homek ] . ret ; gfc -> bookmarks = ( GButton * ) gcd [ bookk ] . ret ; gfc -> directories = ( GListButton * ) gcd [ dirsk ] . ret ; gfc -> up = ( GButton * ) gcd [ upk ] . ret ; gfc -> config = ( GButton * ) gcd [ confk ] . ret ; gfc -> subdirs = ( GList * ) gcd [ subdirsk ] . ret ; gfc -> files = ( GList * ) gcd [ filesk ] . ret ; gfc -> name = ( GTextField * ) gcd [ textk ] . ret ; gfc -> home -> g . contained = true ; gfc -> bookmarks -> g . contained = true ; gfc -> directories -> g . contained = true ; gfc -> up -> g . contained = true ; gfc -> config -> g . contained = true ; gfc -> subdirs -> g . contained = true ; gfc -> files -> g . contained = true ; gfc -> name -> g . contained = true ; gfc -> topbox -> g . contained = true ; GCompletionFieldSetCompletion ( & gfc -> name -> g , GFileChooserCompletion ) ; GCompletionFieldSetCompletionMode ( & gfc -> name -> g , true ) ; GHVBoxSetExpandableRow ( boxes [ 0 ] . ret , 1 ) ; GHVBoxSetExpandableCol ( boxes [ 2 ] . ret , 4 ) ; if ( boxes [ 0 ] . gd . pos . width != 0 && boxes [ 0 ] . gd . pos . height != 0 ) { GGadgetResize ( boxes [ 0 ] . ret , boxes [ 0 ] . gd . pos . width , boxes [ 0 ] . gd . pos . height ) ; } } 