void test_editor_delete_char ( void ) { { TEST_CHECK ( editor_delete_char ( NULL ) == FR_ERROR ) ; } { struct EnterState * es = enter_state_new ( ) ; TEST_CHECK ( editor_delete_char ( es ) == FR_ERROR ) ; enter_state_free ( & es ) ; } { struct EnterState * es = enter_state_new ( ) ; editor_buffer_set ( es , "test string" ) ; TEST_CHECK ( editor_buffer_get_lastchar ( es ) == 11 ) ; TEST_CHECK ( editor_buffer_get_cursor ( es ) == 11 ) ; TEST_CHECK ( editor_delete_char ( es ) == FR_ERROR ) ; enter_state_free ( & es ) ; } { struct EnterState * es = enter_state_new ( ) ; editor_buffer_set ( es , "test string" ) ; TEST_CHECK ( editor_buffer_get_lastchar ( es ) == 11 ) ; TEST_CHECK ( editor_buffer_get_cursor ( es ) == 11 ) ; editor_buffer_set_cursor ( es , 3 ) ; TEST_CHECK ( editor_delete_char ( es ) == FR_SUCCESS ) ; TEST_CHECK ( editor_buffer_get_lastchar ( es ) == 10 ) ; TEST_CHECK ( editor_buffer_get_cursor ( es ) == 3 ) ; enter_state_free ( & es ) ; } { struct EnterState * es = enter_state_new ( ) ; editor_buffer_set ( es , "ä¹åå" ) ; TEST_CHECK ( editor_buffer_get_lastchar ( es ) == 3 ) ; TEST_CHECK ( editor_buffer_get_cursor ( es ) == 3 ) ; TEST_CHECK ( editor_buffer_get_cursor ( es ) == 1 ) ; TEST_CHECK ( editor_delete_char ( es ) == FR_SUCCESS ) ; TEST_CHECK ( editor_buffer_get_lastchar ( es ) == 2 ) ; TEST_CHECK ( editor_buffer_get_cursor ( es ) == 1 ) ; enter_state_free ( & es ) ; } { struct EnterState * es = enter_state_new ( ) ; editor_buffer_set ( es , "I â¤ï¸" ) ; TEST_CHECK ( editor_buffer_get_lastchar ( es ) == 4 ) ; TEST_CHECK ( editor_buffer_get_cursor ( es ) == 4 ) ; editor_buffer_set_cursor ( es , 2 ) ; TEST_CHECK ( editor_buffer_get_cursor ( es ) == 2 ) ; TEST_CHECK ( editor_delete_char ( es ) == FR_SUCCESS ) ; TEST_CHECK ( editor_buffer_get_lastchar ( es ) == 2 ) ; TEST_CHECK ( editor_buffer_get_cursor ( es ) == 2 ) ; enter_state_free ( & es ) ; } } 