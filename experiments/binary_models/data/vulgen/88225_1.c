static void _buffer_queue ( struct vb2_buffer * vb ) { struct dvb_vb2_ctx * ctx = vb2_get_drv_priv ( vb -> vb2_queue ) ; struct dvb_buffer * buf = container_of ( vb , dvb_buffer , vb ) ; unsigned long flags ; spin_lock_irqsave ( & ctx -> slock , flags ) ; list_add_tail ( & buf -> list , & ctx -> dvb_q ) ; spin_unlock_irqrestore ( & ctx -> slock , flags ) ; dprintk ( 3 , "[%s]\n" , ctx -> name ) ; } 