void release_l3_process ( struct l3_process * p ) { struct l3_process * np , * pp = NULL ; np = p -> st -> l3 . proc ; while ( np ) { if ( np == p ) { StopAllL3Timer ( p ) ; if ( pp ) { pp -> next = np -> next ; } if ( ! ( p -> st -> l3 . proc = np -> next ) && ! test_bit ( FLG_PTP , & p -> st -> l2 . flag ) ) { if ( p -> debug ) { l3_debug ( p -> st , "release_l3_process: last process" ) ; } if ( skb_queue_empty ( & p -> st -> l3 . squeue ) ) { if ( p -> debug ) { l3_debug ( p -> st , "release_l3_process: release link" ) ; } if ( p -> st -> protocol != ISDN_PTYPE_NI1 ) { FsmEvent ( & p -> st -> l3 . l3m , EV_RELEASE_REQ , NULL ) ; } else { FsmEvent ( & p -> st -> l3 . l3m , EV_RELEASE_IND , NULL ) ; } } else { if ( p -> debug ) { l3_debug ( p -> st , "release_l3_process: not release link" ) ; } } } kfree ( p ) ; return ; } pp = np ; np = np -> next ; } printk ( KERN_ERR "HiSax internal L3 error CR(%d) not in list\n" , p -> callref ) ; l3_debug ( p -> st , "HiSax internal L3 error CR(%d) not in list" , p -> callref ) ; } 