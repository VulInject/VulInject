static void __gmap_unshadow_r2t ( struct gmap * sg , unsigned long raddr , unsigned long * r2t ) { phys_addr_t r3t ; struct page * page ; int i ; BUG_ON ( ! gmap_is_shadow ( sg ) ) ; for ( i = 0 ; i < _CRST_ENTRIES ; i ++ , raddr += _REGION2_SIZE ) { if ( ! ( r2t [ i ] & _REGION_ENTRY_ORIGIN ) ) { continue ; } r3t = r2t [ i ] & _REGION_ENTRY_ORIGIN ; r2t [ i ] = _REGION2_ENTRY_EMPTY ; __gmap_unshadow_r3t ( sg , raddr , __va ( r3t ) ) ; page = phys_to_page ( r3t ) ; list_del ( & page -> lru ) ; } } 