static void tsi721_advance_work ( struct tsi721_bdma_chan * bdma_chan , struct tsi721_tx_desc * desc ) { int err ; tsi_debug ( DMA , & bdma_chan -> dchan . dev -> device , "DMAC%d" , bdma_chan -> id ) ; if ( ! tsi721_dma_is_idle ( bdma_chan ) ) { return ; } if ( ! desc && ! bdma_chan -> active_tx && ! list_empty ( & bdma_chan -> queue ) ) { desc = list_first_entry ( & bdma_chan -> queue , tsi721_tx_desc , desc_node ) ; list_del_init ( ( & desc -> desc_node ) ) ; bdma_chan -> active_tx = desc ; } if ( desc ) { err = tsi721_submit_sg ( desc ) ; if ( ! err ) { tsi721_start_dma ( bdma_chan ) ; } else { tsi_debug ( DMA , & bdma_chan -> dchan . dev -> device , "DMAC%d ERR: tsi721_submit_sg failed with err=%d" , bdma_chan -> id , err ) ; } } tsi_debug ( DMA , & bdma_chan -> dchan . dev -> device , "DMAC%d Exit" , bdma_chan -> id ) ; } 