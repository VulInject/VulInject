static int rtsx_acquire_irq ( struct rtsx_dev * dev ) { struct rtsx_chip * chip = dev -> chip ; dev_info ( & dev -> pci -> dev , "%s: chip->msi_en = %d, pci->irq = %d\n" , __func__ , chip -> msi_en , dev -> pci -> irq ) ; if ( request_irq ( dev -> pci -> irq , rtsx_interrupt , chip -> msi_en ?0 : IRQF_SHARED , CR_DRIVER_NAME , dev ) ) { dev_err ( & dev -> pci -> dev , "rtsx: unable to grab IRQ %d, disabling device\n" , dev -> pci -> irq ) ; return - 1 ; } pci_intx ( dev -> pci , ! chip -> msi_en ) ; return 0 ; } 