static int vr_active ( struct task_struct * target , const struct user_regset * regset ) { flush_altivec_to_thread ( target ) ; return target -> thread . used_vr ?regset -> n : 0 ; } static int vr_get ( struct task_struct * target , const struct user_regset * regset , unsigned int pos , unsigned int count , void * kbuf , void __user * ubuf ) { int ret ; flush_altivec_to_thread ( target ) ; BUILD_BUG_ON ( offsetof ( thread_vr_state , vscr ) != offsetof ( thread_vr_state , vr [ 32 ] ) ) ; ret = user_regset_copyout ( & pos , & count , & kbuf , & ubuf , & target -> thread . vr_state , 0 , 33 * sizeof ( vector128 ) ) ; if ( ! ret ) { { elf_vrreg_t reg ; u32 word ; } , vrsave vrsave . word = target -> thread . vrsave ; ret = user_regset_copyout ( & pos , & count , & kbuf , & ubuf , & vrsave , 33 * sizeof ( vector128 ) , - 1 ) ; } return ret ; } 