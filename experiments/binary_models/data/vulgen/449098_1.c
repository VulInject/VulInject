zyd_res zyd_read32 ( struct zyd_softc * sc , uint16_t reg , uint32_t * val ) { zyd_res result ; uint16_t tmp [ 4 ] ; uint16_t regs [ 2 ] ; regs [ 0 ] = LE_16 ( ZYD_REG32_HI ( reg ) ) ; regs [ 1 ] = LE_16 ( ZYD_REG32_LO ( reg ) ) ; result = zyd_usb_ioread_req ( & sc -> usb , regs , sizeof ( regs ) , tmp , sizeof ( tmp ) ) ; if ( result != USB_SUCCESS ) { return ( ZYD_FAILURE ) ; } if ( tmp [ 0 ] != regs [ 0 ] || tmp [ 2 ] != regs [ 1 ] ) { ZYD_WARN ( "ioread response doesn't match request\n" ) ; ZYD_WARN ( "requested regs %04x, %04x; got %04x, %04x\n" , LE_16 ( regs [ 0 ] ) , LE_16 ( regs [ 1 ] ) , LE_16 ( tmp [ 0 ] ) , LE_16 ( tmp [ 2 ] ) ) ; return ( ZYD_FAILURE ) ; } return ( ZYD_SUCCESS ) ; } 