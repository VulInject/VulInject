switch ( c ) { case 'p' : if ( ppem ) { break ; } ppem = 1 ; break ; case 'v' : verb ++ ; break ; default : errx ( 1 , "bad argument %c" , c ) ; } argv += optind ; argc -= optind ; if ( argc == 0 ) { errx ( 1 , "argument missing" ) ; } for ( i = 0 ; i < argc ; i ++ ) { buf = load_file ( argv [ i ] , & len ) ; if ( ( p = mft_parse ( & xp , argv [ i ] , buf , len ) ) == NULL ) { free ( buf ) ; break ; } if ( verb ) { mft_print ( xp , p ) ; } if ( ppem ) { if ( ! PEM_write_X509 ( stdout , xp ) ) { errx ( 1 , "PEM_write_X509: unable to write cert" ) ; } } free ( buf ) ; mft_free ( p ) ; X509_free ( xp ) ; } EVP_cleanup ( ) ; CRYPTO_cleanup_all_ex_data ( ) ; ERR_free_strings ( ) ; printf ( "OK\n" ) ; return 0 ; 