static void ras_stride_increase_window ( struct ll_readahead_state * ras , struct ll_ra_info * ra , unsigned long inc_len ) { unsigned long left , step , window_len ; unsigned long stride_len ; LASSERT ( ras -> ras_stride_length > 0 ) ; LASSERTF ( ras -> ras_window_start + ras -> ras_window_len >= ras -> ras_stride_offset , "window_start %lu, window_len %lu stride_offset %lu\n" , ras -> ras_window_start , ras -> ras_window_len , ras -> ras_stride_offset ) ; stride_len = ras -> ras_window_start + ras -> ras_window_len - ras -> ras_stride_offset ; left = stride_len % ras -> ras_stride_length ; window_len = ras -> ras_window_len - left ; if ( left < ras -> ras_stride_pages ) { left += inc_len ; } else { left = ras -> ras_stride_pages + inc_len ; } LASSERT ( ras -> ras_stride_pages != 0 ) ; step = left / ras -> ras_stride_pages ; left %= ras -> ras_stride_pages ; window_len += step * ras -> ras_stride_length + left ; RAS_CDEBUG ( ras ) ; } 