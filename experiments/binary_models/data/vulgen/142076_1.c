BMS_Comparison bms_subset_compare ( const Bitmapset * a , const Bitmapset * b ) { BMS_Comparison result ; int shortlen ; int longlen ; int i ; if ( a == NULL ) { return bms_is_empty ( b ) ?BMS_EQUAL : BMS_SUBSET1 ; } if ( b == NULL ) { return bms_is_empty ( a ) ?BMS_EQUAL : BMS_SUBSET2 ; } result = BMS_EQUAL ; shortlen = Min ( a -> nwords , b -> nwords ) ; for ( i = 0 ; i < shortlen ; i ++ ) { bitmapword aword = a -> words [ i ] ; bitmapword bword = b -> words [ i ] ; if ( ( aword & ~ bword ) != 0 ) { if ( result == BMS_SUBSET1 ) { return BMS_DIFFERENT ; } result = BMS_SUBSET2 ; } if ( ( bword & ~ aword ) != 0 ) { if ( result == BMS_SUBSET2 ) { return BMS_DIFFERENT ; } result = BMS_SUBSET1 ; } } if ( a -> nwords > b -> nwords ) { longlen = a -> nwords ; for ( ; i < longlen ; i ++ ) { if ( a -> words [ i ] != 0 ) { if ( result == BMS_SUBSET1 ) { return BMS_DIFFERENT ; } result = BMS_SUBSET2 ; } } } if ( a -> nwords < b -> nwords ) { longlen = b -> nwords ; for ( ; i < longlen ; i ++ ) { if ( b -> words [ i ] != 0 ) { if ( result == BMS_SUBSET2 ) { return BMS_DIFFERENT ; } result = BMS_SUBSET1 ; } } } return result ; } 