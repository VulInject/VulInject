static inline void netdata_set_trampoline_target ( struct cachestat_bpf * obj ) { bpf_program__set_attach_target ( obj -> progs . netdata_add_to_page_cache_lru_fentry , 0 , cachestat_targets [ NETDATA_KEY_CALLS_ADD_TO_PAGE_CACHE_LRU ] . name ) ; bpf_program__set_attach_target ( obj -> progs . netdata_mark_page_accessed_fentry , 0 , cachestat_targets [ NETDATA_KEY_CALLS_MARK_PAGE_ACCESSED ] . name ) ; if ( ! strcmp ( cachestat_targets [ NETDATA_KEY_CALLS_ACCOUNT_PAGE_DIRTIED ] . name , account_page [ NETDATA_CACHESTAT_FOLIO_DIRTY ] ) ) { bpf_program__set_attach_target ( obj -> progs . netdata_folio_mark_dirty_fentry , 0 , cachestat_targets [ NETDATA_KEY_CALLS_ACCOUNT_PAGE_DIRTIED ] . name ) ; } if ( ! strcmp ( cachestat_targets [ NETDATA_KEY_CALLS_ACCOUNT_PAGE_DIRTIED ] . name , account_page [ NETDATA_CACHESTAT_SET_PAGE_DIRTY ] ) ) { bpf_program__set_attach_target ( obj -> progs . netdata_set_page_dirty_fentry , 0 , cachestat_targets [ NETDATA_KEY_CALLS_ACCOUNT_PAGE_DIRTIED ] . name ) ; } else { bpf_program__set_attach_target ( obj -> progs . netdata_account_page_dirtied_fentry , 0 , cachestat_targets [ NETDATA_KEY_CALLS_ACCOUNT_PAGE_DIRTIED ] . name ) ; } bpf_program__set_attach_target ( obj -> progs . netdata_mark_buffer_dirty_fentry , 0 , cachestat_targets [ NETDATA_KEY_CALLS_MARK_BUFFER_DIRTY ] . name ) ; } 