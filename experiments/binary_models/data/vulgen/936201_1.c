static void mlx5e_encap_dealloc ( struct mlx5e_priv * priv , struct mlx5e_encap_entry * e ) { WARN_ON ( ! list_empty ( & e -> flows ) ) ; if ( e -> compl_result > 0 ) { mlx5e_rep_encap_entry_detach ( netdev_priv ( e -> out_dev ) , e ) ; if ( e -> flags & MLX5_ENCAP_ENTRY_VALID ) { mlx5_packet_reformat_dealloc ( priv -> mdev , e -> pkt_reformat ) ; } } kfree ( e -> tun_info ) ; kfree_rcu ( e , rcu ) ; } 