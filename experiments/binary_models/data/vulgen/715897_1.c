static void xilinx_cpm_mask_leg_irq ( struct irq_data * data ) { struct xilinx_cpm_pcie * port = irq_data_get_irq_chip_data ( data ) ; unsigned long flags ; u32 mask ; u32 val ; mask = BIT ( data -> hwirq + XILINX_CPM_PCIE_IDRN_SHIFT ) ; raw_spin_lock_irqsave ( & port -> lock , flags ) ; pcie_write ( port , ( val & ( ~ mask ) ) , XILINX_CPM_PCIE_REG_IDRN_MASK ) ; raw_spin_unlock_irqrestore ( & port -> lock , flags ) ; } 