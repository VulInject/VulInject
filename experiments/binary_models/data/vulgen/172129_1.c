ffeintrin_fulfill_specific ( , , , ) { ffebld symter ; ffebldOp op ; ffeintrinGen gen ; ffeintrinSpec spec ; ffeintrinImp imp ; ffeinfoBasictype bt = FFEINFO_basictypeNONE ; ffeinfoKindtype kt = FFEINFO_kindtypeNONE ; ffetargetCharacterSize sz = FFETARGET_charactersizeNONE ; ffeIntrinsicState state ; ffebad error ; bool any = FALSE ; const char * name ; op = ffebld_op ( * expr ) ; assert ( ( op == FFEBLD_opFUNCREF ) || ( op == FFEBLD_opSUBRREF ) ) ; assert ( ffebld_op ( ffebld_left ( * expr ) ) == FFEBLD_opSYMTER ) ; gen = ffebld_symter_generic ( ffebld_left ( * expr ) ) ; spec = ffebld_symter_specific ( ffebld_left ( * expr ) ) ; assert ( spec != FFEINTRIN_specNONE ) ; if ( gen != FFEINTRIN_genNONE ) { name = ffeintrin_gens_ [ gen ] . name ; } else { name = ffeintrin_specs_ [ spec ] . name ; } state = ffeintrin_state_family ( ffeintrin_specs_ [ spec ] . family ) ; imp = ffeintrin_specs_ [ spec ] . implementation ; any = ffeintrin_check_any_ ( ffebld_right ( * expr ) ) ; if ( state == FFE_intrinsicstateDISABLED ) { error = FFEBAD_INTRINSIC_DISABLED ; } if ( imp == FFEINTRIN_impNONE ) { error = FFEBAD_INTRINSIC_UNIMPL ; } if ( ! any ) { error = ffeintrin_check_ ( imp , ffebld_op ( * expr ) , ffebld_right ( * expr ) , & bt , & kt , & sz , check_intrin , t , TRUE ) ; } else { error = FFEBAD ; } if ( any || ( error != FFEBAD ) ) { if ( ! any ) { ffebad_start ( error ) ; ffebad_here ( 0 , ffelex_token_where_line ( t ) , ffelex_token_where_column ( t ) ) ; ffebad_string ( name ) ; ffebad_finish ( ) ; } * expr = ffebld_new_any ( ) ; * info = ffeinfo_new_any ( ) ; } else { * info = ffeinfo_new ( bt , kt , 0 , FFEINFO_kindENTITY , FFEINFO_whereFLEETING , sz ) ; symter = ffebld_left ( * expr ) ; ffebld_set_info ( symter , ffeinfo_new ( bt , kt , 0 , ( bt == FFEINFO_basictypeNONE ) ?FFEINFO_kindSUBROUTINE : FFEINFO_kindFUNCTION , FFEINFO_whereINTRINSIC , sz ) ) ; if ( ( ffesymbol_attrs ( ffebld_symter ( symter ) ) & FFESYMBOL_attrsTYPE ) && ( ( ( bt != ffesymbol_basictype ( ffebld_symter ( symter ) ) ) || ( kt != ffesymbol_kindtype ( ffebld_symter ( symter ) ) ) || ( sz != ffesymbol_size ( ffebld_symter ( symter ) ) ) ) ) ) { ffebad_start ( FFEBAD_INTRINSIC_TYPE ) ; ffebad_here ( 0 , ffelex_token_where_line ( t ) , ffelex_token_where_column ( t ) ) ; ffebad_string ( name ) ; ffebad_finish ( ) ; } if ( ffeintrin_imps_ [ imp ] . y2kbad ) { ffebad_start ( FFEBAD_INTRINSIC_Y2KBAD ) ; ffebad_here ( 0 , ffelex_token_where_line ( t ) , ffelex_token_where_column ( t ) ) ; ffebad_string ( name ) ; ffebad_finish ( ) ; } } } 