d_paint_line ( ) { DobjPoints * spnt ; gdouble * line_pnts ; gint seg_count = 0 ; gint i = 0 ; for ( spnt = obj -> points ; spnt ; spnt = spnt -> next ) { seg_count ++ ; } line_pnts = g_new0 ( gdouble , 2 * seg_count + 1 ) ; for ( spnt = obj -> points ; spnt ; spnt = spnt -> next ) { line_pnts [ i ++ ] = spnt -> pnt . x ; line_pnts [ i ++ ] = spnt -> pnt . y ; } if ( selvals . scaletoimage ) { scale_to_original_xy ( & line_pnts [ 0 ] , i / 2 ) ; } else { scale_to_xy ( & line_pnts [ 0 ] , i / 2 ) ; } if ( obj -> style . paint_type == PAINT_BRUSH_TYPE ) { gfig_paint ( selvals . brshtype , gfig_context -> drawable , seg_count * 2 , line_pnts ) ; } g_free ( line_pnts ) ; } 