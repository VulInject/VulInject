void wolfSSL_TLS_client_init ( const char * cipherlist ) { char * cert = "./certs/ca-ecc-cert.pem" ; char * cert = "./certs/ca-cert.pem" ; const unsigned char * cert = ca_ecc_cert_der_256 ; const unsigned char * cert = ca_cert_der_2048 ; wolfSSL_Init ( ) ; wolfSSL_Debugging_ON ( ) ; if ( ( client_ctx = wolfSSL_CTX_new_ex ( wolfSSLv23_client_method_ex ( heapHint ) , heapHint ) ) == NULL ) { printf ( "ERROR: faild to create WOLFSSL_CTX\n" ) ; return ; } if ( ( wolfSSL_CTX_load_static_memory ( & client_ctx , NULL , heapBufIO , sizeof ( heapBufIO ) , WOLFMEM_IO_POOL , 10 ) ) != WOLFSSL_SUCCESS ) { printf ( "ERROR: faild to set static memory for IO\n" ) ; return ; } if ( ( client_ctx = wolfSSL_CTX_new ( wolfSSLv23_client_method_ex ( ( void * ) NULL ) ) ) == NULL ) { printf ( "ERROR: failed to create WOLFSSL_CTX\n" ) ; return ; } tsip_set_callbacks ( client_ctx ) ; if ( wolfSSL_CTX_load_verify_buffer ( client_ctx , cert , SIZEOF_CERT , SSL_FILETYPE_ASN1 ) != SSL_SUCCESS ) { printf ( "ERROR: can't load certificate data\n" ) ; return ; } wolfSSL_SetIORecv ( client_ctx , my_IORecv ) ; wolfSSL_SetIOSend ( client_ctx , my_IOSend ) ; if ( cipherlist != NULL && wolfSSL_CTX_set_cipher_list ( client_ctx , cipherlist ) != WOLFSSL_SUCCESS ) { client_ctx = NULL ; printf ( "client can't set cipher list" ) ; return ; } if ( wolfSSL_CTX_UseSupportedCurve ( client_ctx , WOLFSSL_ECC_SECP256R1 ) != WOLFSSL_SUCCESS ) { wolfSSL_CTX_free ( client_ctx ) ; client_ctx = NULL ; printf ( "client can't set use supported curves\n" ) ; return ; } } 