int main ( int argc , char * * argv ) { int c ; int errflg = 0 ; int any_failed = 0 ; int u_cnt , o_cnt , s_cnt ; char * pc ; char job_id [ PBS_MAXCLTJOBID ] ; char job_id_out [ PBS_MAXCLTJOBID ] ; char server_out [ MAXSERVERNAME ] "" ; ; char rmt_server [ MAXSERVERNAME ] ; char extend [ MAXPATHLEN ] ; hold_type [ 0 ] = '\0' ; while ( ( c = getopt ( argc , argv , GETOPT_ARGS ) ) != EOF ) { switch ( c ) { case 'h' : while ( isspace ( ( int ) * optarg ) ) { optarg ++ ; } if ( strlen ( optarg ) == 0 ) { fprintf ( stderr , "qrls: illegal -h value\n" ) ; errflg ++ ; break ; } pc = optarg ; u_cnt = o_cnt = s_cnt = 0 ; while ( * pc ) { if ( * pc == 'u' ) { u_cnt ++ ; } if ( * pc == 'o' ) { o_cnt ++ ; } if ( * pc == 's' ) { s_cnt ++ ; } else { fprintf ( stderr , "qrls: illegal -h value\n" ) ; errflg ++ ; break ; } pc ++ ; } strcpy ( hold_type , optarg ) ; break ; case 't' : pc = optarg ; if ( strlen ( pc ) == 0 ) { fprintf ( stderr , "qrls: illegal -t value (array range cannot be zero length)\n" ) ; errflg ++ ; break ; } snprintf ( extend , sizeof ( extend ) , "%s%s" , ARRAY_RANGE , pc ) ; break ; default : errflg ++ ; break ; } } if ( errflg || optind >= argc ) { static char usage [ ] "usage: qrls [-h {uos}] [-t array_range]job_identifier...\n" ; ; fprintf ( stderr , "%s" , usage ) ; exit ( 2 ) ; } for ( ; optind < argc ; optind ++ ) { int connect ; int stat = 0 ; int located = FALSE ; std :: string server_name ; std :: vector ( std :: string ) id_list ; snprintf ( job_id , sizeof ( job_id ) , "%s" , argv [ optind ] ) ; if ( get_server_and_job_ids ( job_id , id_list , server_name ) ) { fprintf ( stderr , "qrls: illegally formed job identifier: %s\n" , job_id ) ; any_failed = 1 ; } } } 