static void hysdn_pci_remove_one ( struct pci_dev * akt_pcidev ) { hysdn_card * card = pci_get_drvdata ( akt_pcidev ) ; pci_set_drvdata ( akt_pcidev , NULL ) ; if ( card -> stopcard ) { card -> stopcard ( card ) ; } hycapi_capi_release ( card ) ; if ( card -> releasehardware ) { card -> releasehardware ( card ) ; } if ( card == card_root ) { card_root = card_root -> next ; } else { hysdn_card * tmp = card_root ; while ( tmp ) { if ( tmp -> next == card ) { tmp -> next = card -> next ; } card_last = tmp ; tmp = tmp -> next ; } } kfree ( card ) ; pci_disable_device ( akt_pcidev ) ; } static struct pci_driver hysdn_pci_driver = { . name = "hysdn" . id_table = hysdn_pci_tbl . probe = hysdn_pci_init_one . remove = hysdn_pci_remove_one } ; 