static int rtsx_scan_thread ( void * __dev ) { struct rtsx_dev * dev = __dev ; struct rtsx_chip * chip = dev -> chip ; if ( delay_use > 0 ) { dev_info ( & dev -> pci -> dev , "%s: waiting for device to settle before scanning\n" , CR_DRIVER_NAME ) ; wait_event_interruptible_timeout ( dev -> delay_wait , rtsx_chk_stat ( chip , RTSX_STAT_DISCONNECT ) , delay_use * HZ ) ; } if ( ! rtsx_chk_stat ( chip , RTSX_STAT_DISCONNECT ) ) { scsi_scan_host ( rtsx_to_host ( dev ) ) ; dev_info ( & dev -> pci -> dev , "%s: device scan complete\n" , CR_DRIVER_NAME ) ; } } 