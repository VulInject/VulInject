static void __init doc2000_count_chips ( struct mtd_info * mtd ) { struct nand_chip * this = mtd_to_nand ( mtd ) ; struct doc_priv * doc = nand_get_controller_data ( this ) ; uint16_t mfrid ; int i ; doc -> chips_per_floor = 4 ; mfrid = doc200x_ident_chip ( mtd , 0 ) ; for ( i = 1 ; i < 4 ; i ++ ) { } doc -> chips_per_floor = i ; pr_debug ( "Detected %d chips per floor.\n" , i ) ; } 