static void client_alive_check ( struct ssh * ssh ) { char remote_id [ 512 ] ; int r , channel_id ; if ( options . client_alive_count_max > 0 && ssh_packet_inc_alive_timeouts ( ssh ) > options . client_alive_count_max ) { sshpkt_fmt_connection_id ( ssh , remote_id , sizeof ( remote_id ) ) ; logit ( "Timeout, client not responding from %s" , remote_id ) ; } if ( ( channel_id = channel_find_open ( ssh ) ) == - 1 ) { if ( ( r = sshpkt_start ( ssh , SSH2_MSG_GLOBAL_REQUEST ) ) != 0 || ( r = sshpkt_put_cstring ( ssh , "keepalive@openssh.com" ) ) != 0 || ( r = sshpkt_put_u8 ( ssh , 1 ) ) != 0 ) { fatal_fr ( r , "compose" ) ; } } else { channel_request_start ( ssh , channel_id , "keepalive@openssh.com" , 1 ) ; } if ( ( r = sshpkt_send ( ssh ) ) != 0 ) { fatal_fr ( r , "send" ) ; } } 