void expire_rb_timeouts ( struct uwsgi_rbtree * tree ) { uint64_t current = ( uint64_t ) uwsgi_now ( ) ; struct uwsgi_rb_timer * urbt ; struct uwsgi_signal_rb_timer * usrbt ; for ( ; ; ) { urbt = uwsgi_min_rb_timer ( tree , NULL ) ; if ( urbt == NULL ) { return ; } if ( urbt -> value <= current ) { usrbt = ( uwsgi_signal_rb_timer * ) urbt -> data ; uwsgi_del_rb_timer ( tree , urbt ) ; usrbt -> iterations_done ++ ; uwsgi_route_signal ( usrbt -> sig ) ; if ( ! usrbt -> iterations || usrbt -> iterations_done < usrbt -> iterations ) { usrbt -> uwsgi_rb_timer = uwsgi_add_rb_timer ( tree , uwsgi_now ( ) + usrbt -> value , usrbt ) ; } continue ; } break ; } } 