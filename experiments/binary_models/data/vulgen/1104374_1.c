void DetectSNMPUsmRegister ( void ) { sigmatch_table [ DETECT_AL_SNMP_USM ] . name = "snmp.usm" ; sigmatch_table [ DETECT_AL_SNMP_USM ] . desc = "SNMP content modifier to match on the SNMP usm" ; sigmatch_table [ DETECT_AL_SNMP_USM ] . Setup = DetectSNMPUsmSetup ; sigmatch_table [ DETECT_AL_SNMP_USM ] . flags |= SIGMATCH_NOOPT | SIGMATCH_INFO_STICKY_BUFFER ; DetectAppLayerInspectEngineRegister2 ( "snmp.usm" , ALPROTO_SNMP , SIG_FLAG_TOSERVER , 0 , DetectEngineInspectBufferGeneric , GetData ) ; DetectAppLayerMpmRegister2 ( "snmp.usm" , SIG_FLAG_TOSERVER , 2 , PrefilterGenericMpmRegister , GetData , ALPROTO_SNMP , 0 ) ; DetectAppLayerInspectEngineRegister2 ( "snmp.usm" , ALPROTO_SNMP , SIG_FLAG_TOCLIENT , 0 , DetectEngineInspectBufferGeneric , GetData ) ; DetectAppLayerMpmRegister2 ( "snmp.usm" , SIG_FLAG_TOCLIENT , 2 , PrefilterGenericMpmRegister , GetData , ALPROTO_SNMP , 0 ) ; DetectBufferTypeSetDescriptionByName ( "snmp.usm" , "SNMP USM" ) ; } 