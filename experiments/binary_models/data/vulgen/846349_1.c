static void test_lru ( struct lruhash * table ) { testkey_type * k = newkey ( 12 ) ; testkey_type * k2 = newkey ( 14 ) ; lock_quick_lock ( & table -> lock ) ; unit_assert ( table -> lru_start == NULL && table -> lru_end == NULL ) ; lru_remove ( table , & k -> entry ) ; unit_assert ( table -> lru_start == NULL && table -> lru_end == NULL ) ; lru_front ( table , & k -> entry ) ; unit_assert ( table -> lru_start == & k -> entry && table -> lru_end == & k -> entry ) ; lru_remove ( table , & k -> entry ) ; unit_assert ( table -> lru_start == NULL && table -> lru_end == NULL ) ; lru_front ( table , & k -> entry ) ; unit_assert ( table -> lru_start == & k -> entry && table -> lru_end == & k -> entry ) ; lru_front ( table , & k2 -> entry ) ; unit_assert ( table -> lru_start == & k2 -> entry && table -> lru_end == & k -> entry ) ; lru_remove ( table , & k2 -> entry ) ; unit_assert ( table -> lru_start == & k -> entry && table -> lru_end == & k -> entry ) ; lru_front ( table , & k2 -> entry ) ; unit_assert ( table -> lru_start == & k2 -> entry && table -> lru_end == & k -> entry ) ; lru_remove ( table , & k -> entry ) ; unit_assert ( table -> lru_start == & k2 -> entry && table -> lru_end == & k2 -> entry ) ; lru_remove ( table , & k2 -> entry ) ; unit_assert ( table -> lru_start == NULL && table -> lru_end == NULL ) ; lock_quick_unlock ( & table -> lock ) ; delkey ( k ) ; } 