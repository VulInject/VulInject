CK_RV init_token_data ( TSS_HCONTEXT hContext , TOKEN_DATA * td ) { CK_RV rc ; ( void ) memcpy ( td -> user_pin_sha , "00000000000000000000" , SHA1_DIGEST_LENGTH ) ; ( void ) memcpy ( td -> so_pin_sha , default_so_pin_sha , SHA1_DIGEST_LENGTH ) ; ( void ) memset ( user_pin_md5 , 0x0 , MD5_DIGEST_LENGTH ) ; ( void ) memcpy ( so_pin_md5 , default_so_pin_md5 , MD5_DIGEST_LENGTH ) ; ( void ) memcpy ( td -> next_token_object_name , "00000000" , 8 ) ; td -> tweak_vector . allow_key_mods = TRUE ; init_token_info ( td ) ; rc = token_get_tpm_info ( hContext , td ) ; if ( rc != CKR_OK ) { return ( rc ) ; } rc = save_token_data ( td ) ; return ( rc ) ; } 