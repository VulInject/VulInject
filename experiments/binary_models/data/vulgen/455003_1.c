extern void init_fec_ioports ( struct fs_platform_info * ) extern void init_smc_ioports ( struct fs_uart_platform_info * ) static phys_addr_t immrbase = - 1 ; phys_addr_t get_immrbase ( void ) { struct device_node * soc ; if ( immrbase != - 1 ) { return immrbase ; } soc = of_find_node_by_type ( NULL , "soc" ) ; if ( soc ) { int size ; u32 naddr ; const __be32 * prop = of_get_property ( soc , "#address-cells" , & size ) ; if ( prop && size == 4 ) { naddr = be32_to_cpup ( prop ) ; } else { naddr = 2 ; } prop = of_get_property ( soc , "ranges" , & size ) ; of_node_put ( soc ) ; } return immrbase ; } 