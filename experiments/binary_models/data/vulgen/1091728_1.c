test_mongoc_matcher_eq_utf8 ( ) { bson_t * doc ; bson_t * spec ; bson_error_t error ; mongoc_matcher_t * matcher ; bool r ; spec = BCON_NEW ( "hello" , "world" ) ; matcher = mongoc_matcher_new ( spec , & error ) ; BSON_ASSERT ( matcher ) ; r = mongoc_matcher_match ( matcher , spec ) ; BSON_ASSERT ( r ) ; bson_destroy ( spec ) ; mongoc_matcher_destroy ( matcher ) ; spec = BCON_NEW ( "hello" , "world" ) ; doc = BCON_NEW ( "hello" , BCON_NULL ) ; matcher = mongoc_matcher_new ( spec , & error ) ; BSON_ASSERT ( matcher ) ; r = mongoc_matcher_match ( matcher , doc ) ; BSON_ASSERT ( ! r ) ; bson_destroy ( spec ) ; bson_destroy ( doc ) ; mongoc_matcher_destroy ( matcher ) ; spec = BCON_NEW ( "hello" , "world" ) ; doc = BCON_NEW ( "hello" , BCON_UNDEFINED ) ; matcher = mongoc_matcher_new ( spec , & error ) ; BSON_ASSERT ( matcher ) ; r = mongoc_matcher_match ( matcher , doc ) ; BSON_ASSERT ( ! r ) ; bson_destroy ( spec ) ; bson_destroy ( doc ) ; } 