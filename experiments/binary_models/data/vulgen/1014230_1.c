infer_loop_bounds_from_undefined ( ) { unsigned i ; basic_block bb , * bbs ; block_stmt_iterator bsi ; bbs = get_loop_body ( loop ) ; for ( i = 0 ; i < loop -> num_nodes ; i ++ ) { bb = bbs [ i ] ; if ( ! dominated_by_p ( CDI_DOMINATORS , loop -> latch , bb ) ) { continue ; } for ( bsi = bsi_start ( bb ) ; ! bsi_end_p ( bsi ) ; bsi_next ( & bsi ) ) { tree stmt = bsi_stmt ( bsi ) ; switch ( TREE_CODE ( stmt ) ) { case MODIFY_EXPR : { tree op0 = TREE_OPERAND ( stmt , 0 ) ; tree op1 = TREE_OPERAND ( stmt , 1 ) ; if ( TREE_CODE ( op1 ) == ARRAY_REF && ! array_ref_contains_indirect_ref ( op1 ) ) { estimate_iters_using_array ( stmt , op1 ) ; } if ( TREE_CODE ( op0 ) == ARRAY_REF && ! array_ref_contains_indirect_ref ( op0 ) ) { estimate_iters_using_array ( stmt , op0 ) ; } if ( ! flag_wrapv && TREE_CODE ( op0 ) == SSA_NAME ) { tree init , step , diff , estimation ; tree scev = instantiate_parameters ( loop , analyze_scalar_evolution ( loop , op0 ) ) ; tree type = chrec_type ( scev ) ; init = initial_condition_in_loop_num ( scev , loop -> num ) ; step = evolution_part_in_loop_num ( scev , loop -> num ) ; if ( init == NULL_TREE || step == NULL_TREE || TREE_CODE ( init ) != INTEGER_CST || TREE_CODE ( step ) != INTEGER_CST || TYPE_MIN_VALUE ( type ) == NULL_TREE || TYPE_MAX_VALUE ( type ) == NULL_TREE ) { break ; } if ( integer_nonzerop ( step ) ) { tree utype ; if ( tree_int_cst_lt ( step , integer_zero_node ) ) { diff = fold_build2 ( MINUS_EXPR , type , init , TYPE_MIN_VALUE ( type ) ) ; } else { diff = fold_build2 ( MINUS_EXPR , type , TYPE_MAX_VALUE ( type ) , init ) ; } utype = unsigned_type_for ( type ) ; estimation = fold_build2 ( CEIL_DIV_EXPR , type , diff , step ) ; record_estimate ( loop , fold_convert ( utype , estimation ) , boolean_true_node , stmt ) ; } } break ; } case CALL_EXPR : { tree args ; for ( args = TREE_OPERAND ( stmt , 1 ) ; args ; args = TREE_CHAIN ( args ) ) { if ( TREE_CODE ( TREE_VALUE ( args ) ) == ARRAY_REF && ! array_ref_contains_indirect_ref ( TREE_VALUE ( args ) ) ) { estimate_iters_using_array ( stmt , TREE_VALUE ( args ) ) ; } } break ; } default : break ; } } } compute_estimated_nb_iterations ( loop ) ; free ( bbs ) ; } 