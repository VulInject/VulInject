new_ircwindow ( , , , ) { session * sess ; switch ( type ) { case SESS_SERVER : serv = server_new ( ) ; if ( prefs . hex_gui_tab_server ) { sess = session_new ( serv , name , SESS_SERVER , focus ) ; } else { sess = session_new ( serv , name , SESS_CHANNEL , focus ) ; } serv -> server_session = sess ; serv -> front_session = sess ; break ; case SESS_DIALOG : sess = session_new ( serv , name , type , focus ) ; break ; default : sess = session_new ( serv , name , type , focus ) ; break ; } irc_init ( sess ) ; chanopt_load ( sess ) ; scrollback_load ( sess ) ; if ( type == SESS_DIALOG ) { struct User * user ; log_open_or_close ( sess ) ; user = userlist_find_global ( serv , name ) ; if ( user && user -> hostname ) { set_topic ( sess , user -> hostname , user -> hostname ) ; } } plugin_emit_dummy_print ( sess , "Open Context" ) ; return sess ; } 