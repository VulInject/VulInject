main ( int argc , char * argv [ ] ) { const char * progname , * infilename , * outfilename ; SNDFILE * infile = NULL , * outfile = NULL ; SF_INFO in_sfinfo , out_sfinfo ; progname = program_name ( argv [ 0 ] ) ; if ( argc ( 3 || argc ) 5 ) { usage_exit ( progname ) ; } infilename = argv [ argc - 2 ] ; outfilename = argv [ argc - 1 ] ; if ( strcmp ( infilename , outfilename ) == 0 ) { printf ( "Error : Input and output filenames are the same.\n\n" ) ; usage_exit ( progname ) ; } if ( strlen ( infilename ) > 1 && infilename [ 0 ] == '-' ) { printf ( "Error : Input filename (%s) looks like an option.\n\n" , infilename ) ; usage_exit ( progname ) ; } if ( outfilename [ 0 ] == '-' ) { printf ( "Error : Output filename (%s) looks like an option.\n\n" , outfilename ) ; usage_exit ( progname ) ; } if ( ( infile = sf_open ( infilename , SFM_READ , & in_sfinfo ) ) == NULL ) { printf ( "Not able to open input file %s.\n" , infilename ) ; puts ( sf_strerror ( NULL ) ) ; return 1 ; } memcpy ( & out_sfinfo , & in_sfinfo , sizeof ( out_sfinfo ) ) ; if ( ( outfile = sf_open ( outfilename , SFM_WRITE , & out_sfinfo ) ) == NULL ) { printf ( "Not able to open output file %s : %s\n" , outfilename , sf_strerror ( NULL ) ) ; sf_close ( infile ) ; return 1 ; } add_instrument_data ( outfile , & in_sfinfo ) ; sfe_copy_data_int ( outfile , infile , in_sfinfo . channels ) ; sf_close ( infile ) ; sf_close ( outfile ) ; return 0 ; } 