static void torture_asn1_put_tag_long_tag ( void * * state ) { unsigned int tag = 0xFFFFFF7F ; const u8 expected [ ] { 0xFF 0xFF 0xFF 0x7F 0x01 0x02 } ; ; const u8 data [ ] { 0x02 } ; ; size_t data_len = 1 ; u8 out [ 10 ] ; size_t out_len = sizeof ( out ) ; u8 * p = out ; int rv ; rv = sc_asn1_put_tag ( tag , data , data_len , NULL , 0 , & p ) ; assert_int_equal ( rv , sizeof ( expected ) ) ; assert_ptr_equal ( p , out ) ; rv = sc_asn1_put_tag ( tag , data , data_len , out , out_len , & p ) ; assert_int_equal ( rv , SC_SUCCESS ) ; assert_ptr_equal ( p , out + sizeof ( expected ) ) ; rv = sc_asn1_put_tag ( tag , data , data_len , out , 5 , & p ) ; assert_int_equal ( rv , SC_ERROR_BUFFER_TOO_SMALL ) ; tag = 0xFFFFFF8F ; rv = sc_asn1_put_tag ( tag , data , data_len , NULL , 0 , NULL ) ; assert_int_equal ( rv , SC_ERROR_INVALID_DATA ) ; tag = 0xFFFF7F7F ; rv = sc_asn1_put_tag ( tag , data , data_len , NULL , 0 , NULL ) ; assert_int_equal ( rv , SC_ERROR_INVALID_DATA ) ; tag = 0xE0FFFF7F ; rv = sc_asn1_put_tag ( tag , data , data_len , NULL , 0 , NULL ) ; assert_int_equal ( rv , SC_ERROR_INVALID_DATA ) ; } 