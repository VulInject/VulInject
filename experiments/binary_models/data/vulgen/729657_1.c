static int __init acpi_cpufreq_init ( void ) { int ret ; if ( acpi_disabled ) { return - ENODEV ; } if ( cpufreq_get_current_driver ( ) ) { return - EEXIST ; } pr_debug ( "acpi_cpufreq_init\n" ) ; ret = acpi_cpufreq_early_init ( ) ; if ( ret ) { return ret ; } if ( ! check_amd_hwpstate_cpu ( 0 ) ) { struct freq_attr * * attr ; pr_debug ( "CPB unsupported, do not expose it\n" ) ; for ( attr = acpi_cpufreq_attr ; * attr ; attr ++ ) { if ( * attr == & cpb ) { * attr = NULL ; break ; } } } acpi_cpufreq_boost_init ( ) ; ret = cpufreq_register_driver ( & acpi_cpufreq_driver ) ; if ( ret ) { acpi_cpufreq_boost_exit ( ) ; } return ret ; } 