PHP_METHOD ( , ) { php_random_engine * engine = Z_RANDOM_ENGINE_P ( ZEND_THIS ) ; uint64_t generated ; size_t size ; zend_string * bytes ; ZEND_PARSE_PARAMETERS_NONE ( ) ; generated = engine -> algo -> generate ( engine -> status ) ; size = engine -> status -> last_generated_size ; if ( EG ( exception ) ) { RETURN_THROWS ( ) ; } for ( size_t i = 0 ; i < size ; i ++ ) { ZSTR_VAL ( bytes ) [ i ] = ( generated >> ( i * 8 ) ) & 0xff ; } ZSTR_VAL ( bytes ) [ size ] = '\0' ; RETURN_STR ( bytes ) ; } 