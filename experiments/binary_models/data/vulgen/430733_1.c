static void slip_close ( struct tty_struct * tty ) { struct slip * sl = tty -> disc_data ; spin_lock_bh ( & sl -> lock ) ; rcu_assign_pointer ( tty -> disc_data , NULL ) ; sl -> tty = NULL ; spin_unlock_bh ( & sl -> lock ) ; synchronize_rcu ( ) ; flush_work ( & sl -> tx_work ) ; del_timer_sync ( & sl -> keepalive_timer ) ; del_timer_sync ( & sl -> outfill_timer ) ; unregister_netdev ( sl -> dev ) ; } 