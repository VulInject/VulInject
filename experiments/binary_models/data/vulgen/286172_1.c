void smb_ctx_done ( struct smb_ctx * ctx ) { rpc_cleanup_smbctx ( ctx ) ; if ( ctx -> ct_dev_fd != - 1 ) { nsmb_close ( ctx -> ct_dev_fd ) ; ctx -> ct_dev_fd = - 1 ; } if ( ctx -> ct_door_fd != - 1 ) { close ( ctx -> ct_door_fd ) ; ctx -> ct_door_fd = - 1 ; } if ( ctx -> ct_srvaddr_s ) { free ( ctx -> ct_srvaddr_s ) ; ctx -> ct_srvaddr_s = NULL ; } if ( ctx -> ct_nb ) { nb_ctx_done ( ctx -> ct_nb ) ; ctx -> ct_nb = NULL ; } if ( ctx -> ct_locname ) { free ( ctx -> ct_locname ) ; ctx -> ct_locname = NULL ; } if ( ctx -> ct_origshare ) { free ( ctx -> ct_origshare ) ; ctx -> ct_origshare = NULL ; } if ( ctx -> ct_fullserver ) { free ( ctx -> ct_fullserver ) ; ctx -> ct_fullserver = NULL ; } if ( ctx -> ct_addrinfo ) { freeaddrinfo ( ctx -> ct_addrinfo ) ; ctx -> ct_addrinfo = NULL ; } if ( ctx -> ct_home ) { free ( ctx -> ct_home ) ; ctx -> ct_home = NULL ; } if ( ctx -> ct_rpath ) { free ( ctx -> ct_rpath ) ; ctx -> ct_rpath = NULL ; } if ( ctx -> ct_ssnkey_buf ) { ctx -> ct_ssnkey_buf = NULL ; } } 