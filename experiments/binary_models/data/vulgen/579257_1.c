static void cpsw_adjust_link ( struct net_device * ndev ) { struct cpsw_priv * priv = netdev_priv ( ndev ) ; struct cpsw_common * cpsw = priv -> cpsw ; bool link = false ; for_each_slave ( priv , _cpsw_adjust_link , priv , & link ) ; if ( link ) { netif_carrier_on ( ndev ) ; if ( netif_running ( ndev ) ) { netif_tx_wake_all_queues ( ndev ) ; } } else { netif_carrier_off ( ndev ) ; netif_tx_stop_all_queues ( ndev ) ; } } 