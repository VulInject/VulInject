__attribute__ ( 2 0 ) vlog ( , , ) { if ( nslmatches ) { int e = errno ; va_list args2 ; unsigned int i ; int r ; char line [ 2048 ] ; va_copy ( args2 , args ) ; vsnprintf ( line , sizeof ( line ) , fmt , args2 ) ; va_end ( args2 ) ; for ( i = 0 ; i < MAX_SLMATCH ; i ++ ) { if ( ! slmatches [ i ] . re ) { continue ; } r = regexec ( & slmatches [ i ] . cre , line , 0 , NULL , 0 ) ; if ( ! r ) { if ( verbose >= 2 ) { fprintf ( stderr , "\nSYSLOG matched /%s/\n" , slmatches [ i ] . re ) ; } slmatches [ i ] . count ++ ; break ; } else { if ( nslmatches == 1 || verbose >= 2 ) { fprintf ( stderr , "\nSYSLOG didn't match '%s' against '%s'\n" , line , slmatches [ i ] . re ) ; } } if ( r != REG_NOMATCH ) { const char * msg = match_error ( & slmatches [ i ] , r ) ; break ; } } errno = e ; } if ( verbose < 2 ) { return ; } fprintf ( stderr , "\nSYSLOG %d[" , prio & LOG_PRIMASK ) ; vfprintf ( stderr , fmt , args ) ; fprintf ( stderr , "]\n" ) ; fflush ( stderr ) ; } 