static int decode_load_store ( const ut8 * instr , int len , struct v850_cmd * cmd ) { ut16 word1 = r_read_le16 ( instr ) ; ut16 word2 = r_read_at_le16 ( instr , 2 ) ; switch ( get_opcode ( word1 ) ) { case V850_STB : snprintf ( cmd -> instr , V850_INSTR_MAXLEN - 1 , "%s.b" , instrs [ get_opcode ( word1 ) ] ) ; snprintf ( cmd -> operands , V850_INSTR_MAXLEN - 1 , "r%d, 0x%x[r%d]" , get_reg2 ( word1 ) , word2 , get_reg1 ( word1 ) ) ; break ; case V850_LDB : snprintf ( cmd -> instr , V850_INSTR_MAXLEN - 1 , "%s.b" , instrs [ get_opcode ( word1 ) ] ) ; snprintf ( cmd -> operands , V850_INSTR_MAXLEN - 1 , "0x%x[r%d], r%d" , get_reg1 ( word1 ) , word2 , get_reg2 ( word1 ) ) ; break ; case V850_LDHW : snprintf ( cmd -> instr , V850_INSTR_MAXLEN - 1 , "%s.%c" , instrs [ get_opcode ( word1 ) ] , word2 & 1 ?'w' : 'h' ) ; snprintf ( cmd -> operands , V850_INSTR_MAXLEN - 1 , "0x%x[r%d], r%d" , word2 & 0xFFFE , get_reg1 ( word1 ) , get_reg2 ( word1 ) ) ; break ; case V850_STHW : snprintf ( cmd -> instr , V850_INSTR_MAXLEN - 1 , "%s.%c" , instrs [ get_opcode ( word1 ) ] , word2 & 1 ?'w' : 'h' ) ; snprintf ( cmd -> operands , V850_INSTR_MAXLEN - 1 , "r%d, 0x%x[r%d]" , get_reg2 ( word1 ) , word2 & 0xFFFE , get_reg1 ( word1 ) ) ; break ; } return 4 ; } 