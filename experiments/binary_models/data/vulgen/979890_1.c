instrumet_rw_test ( ) { SNDFILE * sndfile ; SF_INFO sfinfo ; SF_INSTRUMENT inst ; sndfile = test_open_file_or_die ( filename , SFM_RDWR , & sfinfo , SF_FALSE , __LINE__ ) ; if ( sf_command ( sndfile , SFC_GET_INSTRUMENT , & inst , sizeof ( inst ) ) == SF_TRUE ) { inst . basenote = 22 ; if ( sf_command ( sndfile , SFC_SET_INSTRUMENT , & inst , sizeof ( inst ) ) == SF_TRUE ) { printf ( "Sucess: [%s] updated\n" , filename ) ; } else { printf ( "Error: SFC_SET_INSTRUMENT on [%s] [%s]\n" , filename , sf_strerror ( sndfile ) ) ; } } else { printf ( "Error: SFC_GET_INSTRUMENT on [%s] [%s]\n" , filename , sf_strerror ( sndfile ) ) ; } if ( sf_command ( sndfile , SFC_UPDATE_HEADER_NOW , NULL , 0 ) != 0 ) { printf ( "Error: SFC_UPDATE_HEADER_NOW on [%s] [%s]\n" , filename , sf_strerror ( sndfile ) ) ; } sf_write_sync ( sndfile ) ; sf_close ( sndfile ) ; return ; } 