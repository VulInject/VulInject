static int stdout_stream_restore ( Server * s , const char * fname , int fd ) { StdoutStream * stream ; int r ; assert ( s ) ; assert ( fname ) ; assert ( fd >= 0 ) ; if ( s -> n_stdout_streams >= STDOUT_STREAMS_MAX ) { log_warning ( "Too many stdout streams, refusing restoring of stream." ) ; return - ENOBUFS ; } r = stdout_stream_install ( s , fd , & stream ) ; if ( r < 0 ) { return r ; } stream -> state = STDOUT_STREAM_RUNNING ; ( void ) stdout_stream_load ( stream , fname ) ; return 0 ; } 