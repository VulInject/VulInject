static ssize_t vbi_read ( struct file * file , char __user * data , size_t count , loff_t * ppos ) { struct saa7146_fh * fh = file -> private_data ; struct saa7146_dev * dev = fh -> dev ; struct saa7146_vv * vv = dev -> vv_data ; ssize_t ret = 0 ; DEB_VBI ( "dev:%p, fh:%p\n" , dev , fh ) ; if ( NULL == vv -> vbi_streaming ) { vv -> vbi_streaming = fh ; } if ( fh != vv -> vbi_streaming ) { DEB_VBI ( "open %p is already using vbi capture\n" , vv -> vbi_streaming ) ; return - EBUSY ; } ret = videobuf_read_stream ( & fh -> vbi_q , data , count , ppos , 1 , file -> f_flags & O_NONBLOCK ) ; return ret ; } 