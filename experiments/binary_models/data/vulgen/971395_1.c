static int zfs_project_load_projid ( const char * name , zfs_project_control_t * zpc ) { zfsxattr_t fsx ; int ret , fd ; if ( fd < 0 ) { ( void ) fprintf ( stderr , gettext ( "failed to open %s: %s\n" ) , name , strerror ( errno ) ) ; return ( fd ) ; } ret = ioctl ( fd , ZFS_IOC_FSGETXATTR , & fsx ) ; if ( ret ) { ( void ) fprintf ( stderr , gettext ( "failed to get xattr for %s: %s\n" ) , name , strerror ( errno ) ) ; } else { zpc -> zpc_expected_projid = fsx . fsx_projid ; } ( void ) close ( fd ) ; return ( ret ) ; } 