int mbedtls_hmac_drbg_seed ( mbedtls_hmac_drbg_context * ctx , const mbedtls_md_info_t * md_info , int * f_entropy ( void * , unsigned char * , size_t ) , void * p_entropy , const unsigned char * custom , size_t len ) { int ret = MBEDTLS_ERR_ERROR_CORRUPTION_DETECTED ; size_t md_size ; if ( ( ret = mbedtls_md_setup ( & ctx -> md_ctx , md_info , 1 ) ) != 0 ) { return ( ret ) ; } md_size = mbedtls_md_get_size ( md_info ) ; if ( ( ret = mbedtls_md_hmac_starts ( & ctx -> md_ctx , ctx -> V , md_size ) ) != 0 ) { return ( ret ) ; } memset ( ctx -> V , 0x01 , md_size ) ; ctx -> f_entropy = f_entropy ; ctx -> p_entropy = p_entropy ; if ( ( ret = hmac_drbg_reseed_core ( ctx , custom , len , 1 ) ) != 0 ) { return ( ret ) ; } return ( 0 ) ; } 