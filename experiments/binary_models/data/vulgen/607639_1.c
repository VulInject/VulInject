int memac_del_hash_mac_address ( struct fman_mac * memac , enet_addr_t * eth_addr ) { struct memac_regs __iomem * regs = memac -> regs ; struct eth_hash_entry * hash_entry = NULL ; struct list_head * pos ; u32 hash ; u64 addr ; addr = ENET_ADDR_TO_UINT64 ( * eth_addr ) ; hash = get_mac_addr_hash_code ( addr ) & HASH_CTRL_ADDR_MASK ; list_for_each ( , ) { hash_entry = ETH_HASH_ENTRY_OBJ ( pos ) ; if ( hash_entry -> addr == addr ) { list_del_init ( & hash_entry -> node ) ; kfree ( hash_entry ) ; break ; } } if ( list_empty ( & memac -> multicast_addr_hash -> lsts [ hash ] ) ) { iowrite32be ( hash & ~ HASH_CTRL_MCAST_EN , & regs -> hashtable_ctrl ) ; } return 0 ; } 