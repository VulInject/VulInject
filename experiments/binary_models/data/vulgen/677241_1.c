static int em_u32_match ( struct sk_buff * skb , struct tcf_ematch * em , struct tcf_pkt_info * info ) { struct tc_u32_key * key = ( tc_u32_key * ) em -> data ; const unsigned char * ptr = skb_network_header ( skb ) ; if ( info ) { if ( info -> ptr ) { ptr = info -> ptr ; } ptr += ( info -> nexthdr & key -> offmask ) ; } ptr += key -> off ; return ! ( ( ( * ( __be32 * ) ptr ) ^ key -> val ) & key -> mask ) ; } 