static unsigned int pca_probe_chip ( struct i2c_adapter * adap ) { struct i2c_algo_pca_data * pca_data = adap -> algo_data ; pca_outw ( pca_data , I2C_PCA_INDPTR , I2C_PCA_IADR ) ; pca_outw ( pca_data , I2C_PCA_IND , 0xAA ) ; pca_outw ( pca_data , I2C_PCA_IND , 0x00 ) ; pca_outw ( pca_data , I2C_PCA_INDPTR , I2C_PCA_IADR ) ; if ( pca_inw ( pca_data , I2C_PCA_IND ) == 0xAA ) { printk ( KERN_INFO "%s: PCA9665 detected.\n" , adap -> name ) ; pca_data -> chip = I2C_PCA_CHIP_9665 ; } else { printk ( KERN_INFO "%s: PCA9564 detected.\n" , adap -> name ) ; pca_data -> chip = I2C_PCA_CHIP_9564 ; } return pca_data -> chip ; } 