void __init vmem_map_init ( void ) { struct memblock_region * reg ; for_each_memblock ( , ) vmem_add_mem ( reg -> base , reg -> size ) ; __set_memory ( ( unsigned long ) _stext , ( _etext - _stext ) >> PAGE_SHIFT , SET_MEMORY_RO | SET_MEMORY_X ) ; __set_memory ( ( unsigned long ) _etext , ( _eshared - _etext ) >> PAGE_SHIFT , SET_MEMORY_RO ) ; __set_memory ( ( unsigned long ) _sinittext , ( _einittext - _sinittext ) >> PAGE_SHIFT , SET_MEMORY_RO | SET_MEMORY_X ) ; } 