void intel_tc_port_set_fia_lane_count ( struct intel_digital_port * dig_port , int required_lanes ) { struct drm_i915_private * i915 = to_i915 ( dig_port -> base . base . dev ) ; bool lane_reversal = dig_port -> saved_port_bits & DDI_BUF_PORT_REVERSAL ; u32 val ; drm_WARN_ON ( & i915 -> drm , lane_reversal && dig_port -> tc_mode != TC_PORT_LEGACY ) ; val = intel_de_read ( i915 , PORT_TX_DFLEXDPMLE1 ( dig_port -> tc_phy_fia ) ) ; val &= ~ DFLEXDPMLE1_DPMLETC_MASK ( dig_port -> tc_phy_fia_idx ) ; switch ( required_lanes ) { case 1 : val |= lane_reversal ?DFLEXDPMLE1_DPMLETC_ML3 ( dig_port -> tc_phy_fia_idx ) : DFLEXDPMLE1_DPMLETC_ML0 ( dig_port -> tc_phy_fia_idx ) ; break ; case 2 : val |= lane_reversal ?DFLEXDPMLE1_DPMLETC_ML3_2 ( dig_port -> tc_phy_fia_idx ) : DFLEXDPMLE1_DPMLETC_ML1_0 ( dig_port -> tc_phy_fia_idx ) ; break ; case 4 : val |= DFLEXDPMLE1_DPMLETC_ML3_0 ( dig_port -> tc_phy_fia_idx ) ; break ; default : MISSING_CASE ( required_lanes ) ; } intel_de_write ( i915 , PORT_TX_DFLEXDPMLE1 ( dig_port -> tc_phy_fia ) , val ) ; } 