static int build_deg2_base ( struct bch_control * bch ) { const int m = GF_M ( bch ) ; int i , j , r ; unsigned int sum , x , y , remaining , ak = 0 , xi [ m ] ; for ( i = 0 ; i < m ; i ++ ) { for ( j = 0 , sum = 0 ; j < m ; j ++ ) { sum ^= a_pow ( bch , i * ( 1 << j ) ) ; } if ( sum ) { ak = bch -> a_pow_tab [ i ] ; break ; } } remaining = m ; memset ( xi , 0 , sizeof ( xi ) ) ; for ( x = 0 ; ( x <= GF_N ( bch ) ) && remaining ; x ++ ) { y = gf_sqr ( bch , x ) ^ x ; for ( i = 0 ; i < 2 ; i ++ ) { r = a_log ( bch , y ) ; if ( y && ( r < m ) && ! xi [ r ] ) { bch -> xi_tab [ r ] = x ; xi [ r ] = 1 ; dbg ( "x%d = %x\n" , r , x ) ; break ; } y ^= ak ; } } return remaining ?- 1 : 0 ; } 