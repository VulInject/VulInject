int test_one_aead ( ptls_aead_algorithm_t * aead , wchar_t * name , wchar_t * chain_mode , size_t chain_mode_sz ) { printf ( "For %s, test one shot returns %d\n" , aead -> name , ret ) ; if ( ret == 0 ) { ret = test_decrypt ( aead , name , chain_mode , chain_mode_sz ) ; printf ( "For %s, test decrypt returns %d\n" , aead -> name , ret ) ; } if ( ret == 0 ) { ret = test_encrypt ( aead , name , chain_mode , chain_mode_sz ) ; printf ( "For %s, test encrypt returns %d\n" , aead -> name , ret ) ; } if ( ret == 0 ) { ret = test_encrypt_vector ( aead , name , chain_mode , chain_mode_sz ) ; printf ( "For %s, test encrypt returns %d\n" , aead -> name , ret ) ; } if ( ret == 0 ) { ret = test_for_size ( aead , name , chain_mode , chain_mode_sz ) ; printf ( "For %s, test packet sizes returns %d\n" , aead -> name , ret ) ; } return ret ; } 