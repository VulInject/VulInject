int ena_stat_device_extended_update ( kstat_t * ksp , int rw ) { ena_t * ena = ksp -> ks_private ; ena_extended_stat_t * ees = ksp -> ks_data ; enahw_resp_desc_t resp ; enahw_resp_eni_stats_t * stats = & resp . erd_resp . erd_eni_stats ; int ret = 0 ; if ( rw == KSTAT_WRITE ) { return ( EACCES ) ; } if ( ( ret = ena_admin_get_eni_stats ( ena , & resp ) ) != 0 ) { return ( ret ) ; } ees -> ees_bw_in_exceeded . value . ui64 = stats -> eres_bw_in_exceeded ; ees -> ees_bw_out_exceeded . value . ui64 = stats -> eres_bw_out_exceeded ; ees -> ees_pps_exceeded . value . ui64 = stats -> eres_pps_exceeded ; ees -> ees_conns_exceeded . value . ui64 = stats -> eres_conns_exceeded ; ees -> ees_linklocal_exceeded . value . ui64 = stats -> eres_linklocal_exceeded ; mutex_exit ( & ena -> ena_lock ) ; return ( 0 ) ; } 