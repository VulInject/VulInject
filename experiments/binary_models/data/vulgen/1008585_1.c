struct clk_hw * imx_clk_hw_fixup_mux ( const char * name , void __iomem * reg , u8 shift , u8 width , const char * const * parents , int num_parents , void * fixup ( u32 * val ) ) { struct clk_fixup_mux * fixup_mux ; struct clk_hw * hw ; struct clk_init_data init ; int ret ; if ( ! fixup ) { return ERR_PTR ( - EINVAL ) ; } fixup_mux = kzalloc ( sizeof ( * fixup_mux ) , GFP_KERNEL ) ; if ( ! fixup_mux ) { return ERR_PTR ( - ENOMEM ) ; } init . name = name ; init . ops = & clk_fixup_mux_ops ; init . parent_names = parents ; init . num_parents = num_parents ; init . flags = 0 ; fixup_mux -> mux . reg = reg ; fixup_mux -> mux . shift = shift ; fixup_mux -> mux . mask = BIT ( width ) - 1 ; fixup_mux -> mux . lock = & imx_ccm_lock ; fixup_mux -> mux . hw . init = & init ; fixup_mux -> ops = & clk_mux_ops ; fixup_mux -> fixup = fixup ; hw = & fixup_mux -> mux . hw ; ret = clk_hw_register ( NULL , hw ) ; return hw ; } 