static int pkt_get_disc_info ( struct pktcdvd_device * pd , disc_information * di ) { struct packet_command cgc ; int ret ; cgc . cmd [ 0 ] = GPCMD_READ_DISC_INFO ; cgc . cmd [ 8 ] = cgc . buflen = 2 ; cgc . quiet = 1 ; ret = pkt_generic_packet ( pd , & cgc ) ; if ( ret ) { return ret ; } cgc . buflen = be16_to_cpu ( di -> disc_information_length ) + sizeof ( di -> disc_information_length ) ; if ( cgc . buflen > sizeof ( disc_information ) ) { cgc . buflen = sizeof ( disc_information ) ; } cgc . cmd [ 8 ] = cgc . buflen ; return pkt_generic_packet ( pd , & cgc ) ; } 