static int imx258_start_streaming ( struct imx258 * imx258 ) { struct i2c_client * client = v4l2_get_subdevdata ( & imx258 -> sd ) ; const struct imx258_reg_list * reg_list ; int ret , link_freq_index ; link_freq_index = imx258 -> cur_mode -> link_freq_index ; reg_list = & link_freq_configs [ link_freq_index ] . reg_list ; ret = imx258_write_regs ( imx258 , reg_list -> regs , reg_list -> num_of_regs ) ; if ( ret ) { dev_err ( & client -> dev , "%s failed to set plls\n" , __func__ ) ; return ret ; } reg_list = & imx258 -> cur_mode -> reg_list ; ret = imx258_write_regs ( imx258 , reg_list -> regs , reg_list -> num_of_regs ) ; if ( ret ) { dev_err ( & client -> dev , "%s failed to set mode\n" , __func__ ) ; return ret ; } ret = imx258_write_reg ( imx258 , REG_MIRROR_FLIP_CONTROL , IMX258_REG_VALUE_08BIT , REG_CONFIG_MIRROR_FLIP ) ; if ( ret ) { dev_err ( & client -> dev , "%s failed to set orientation\n" , __func__ ) ; return ret ; } ret = __v4l2_ctrl_handler_setup ( imx258 -> sd . ctrl_handler ) ; return imx258_write_reg ( imx258 , IMX258_REG_MODE_SELECT , IMX258_REG_VALUE_08BIT , IMX258_MODE_STREAMING ) ; } 