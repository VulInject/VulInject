create_basic_block_structure ( , , , ) rtx head , end , bb_note ; basic_block after ; { if ( bb_note && ! RTX_INTEGRATED_P ( bb_note ) && ( bb = NOTE_BASIC_BLOCK ( bb_note ) ) != NULL && bb -> aux == NULL ) { rtx after ; if ( GET_CODE ( head ) == CODE_LABEL ) { after = head ; } else { after = PREV_INSN ( head ) ; head = bb_note ; } if ( after != bb_note && NEXT_INSN ( after ) != bb_note ) { reorder_insns_nobb ( bb_note , bb_note , after ) ; } } else { bb = alloc_block ( ) ; if ( ! head && ! end ) { head = end = bb_note = emit_note_after ( NOTE_INSN_BASIC_BLOCK , get_last_insn ( ) ) ; } if ( GET_CODE ( head ) == CODE_LABEL && end ) { bb_note = emit_note_after ( NOTE_INSN_BASIC_BLOCK , head ) ; if ( head == end ) { end = bb_note ; } } else { bb_note = emit_note_before ( NOTE_INSN_BASIC_BLOCK , head ) ; head = bb_note ; if ( ! end ) { end = head ; } } NOTE_BASIC_BLOCK ( bb_note ) = bb ; } if ( NEXT_INSN ( end ) == bb_note ) { end = bb_note ; } bb -> head = head ; bb -> end = end ; bb -> index = last_basic_block ++ ; bb -> flags = BB_NEW ; link_block ( bb , after ) ; BASIC_BLOCK ( bb -> index ) = bb ; update_bb_for_insn ( bb ) ; bb -> aux = bb ; return bb ; } 