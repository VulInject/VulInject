static void av1394_ic_cleanup ( av1394_ic_t * icp , int level ) { av1394_inst_t * avp = icp -> ic_avp ; av1394_isoch_t * ip = & avp -> av_i ; ASSERT ( ( level > 0 ) && ( level <= AV1394_CLEANUP_LEVEL_MAX ) ) ; switch ( level ) { default : if ( icp -> ic_dir == AV1394_IR ) { av1394_ir_fini ( icp ) ; } else { av1394_it_fini ( icp ) ; } case 3 : mutex_enter ( & ip -> i_mutex ) ; av1394_as_free ( & ip -> i_mmap_as , icp -> ic_mmap_off ) ; ip -> i_ic [ icp -> ic_num ] = NULL ; mutex_exit ( & ip -> i_mutex ) ; case 2 : av1394_ic_free_channel ( icp ) ; case 1 : cv_destroy ( & icp -> ic_xfer_cv ) ; mutex_destroy ( & icp -> ic_mutex ) ; } } 