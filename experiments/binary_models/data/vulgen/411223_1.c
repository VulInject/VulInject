static void dr_ste_v1_build_eth_l2_tnl_bit_mask ( struct mlx5dr_match_param * value , bool inner , u8 * bit_mask ) { struct mlx5dr_match_spec * mask = inner ?& value -> inner : & value -> outer ; struct mlx5dr_match_misc * misc = & value -> misc ; DR_STE_SET_TAG ( eth_l2_tnl_v1 , bit_mask , dmac_47_16 , mask , dmac_47_16 ) ; DR_STE_SET_TAG ( eth_l2_tnl_v1 , bit_mask , dmac_15_0 , mask , dmac_15_0 ) ; DR_STE_SET_TAG ( eth_l2_tnl_v1 , bit_mask , first_vlan_id , mask , first_vid ) ; DR_STE_SET_TAG ( eth_l2_tnl_v1 , bit_mask , first_cfi , mask , first_cfi ) ; DR_STE_SET_TAG ( eth_l2_tnl_v1 , bit_mask , first_priority , mask , first_prio ) ; DR_STE_SET_TAG ( eth_l2_tnl_v1 , bit_mask , ip_fragmented , mask , frag ) ; DR_STE_SET_TAG ( eth_l2_tnl_v1 , bit_mask , l3_ethertype , mask , ethertype ) ; DR_STE_SET_ONES ( eth_l2_tnl_v1 , bit_mask , l3_type , mask , ip_version ) ; if ( misc -> vxlan_vni ) { MLX5_SET ( ste_eth_l2_tnl_v1 , bit_mask , l2_tunneling_network_id , ( misc -> vxlan_vni << 8 ) ) ; misc -> vxlan_vni = 0 ; } if ( mask -> svlan_tag || mask -> cvlan_tag ) { mask -> cvlan_tag = 0 ; mask -> svlan_tag = 0 ; } } 