static int lpc32xx_pm_enter ( suspend_state_t state ) { int * lpc32xx_suspend_ptr ( void ) void * iram_swap_area ; iram_swap_area = kmemdup ( ( void * ) TEMP_IRAM_AREA , lpc32xx_sys_suspend_sz , GFP_KERNEL ) ; if ( ! iram_swap_area ) { return - ENOMEM ; } memcpy ( ( void * ) TEMP_IRAM_AREA , & lpc32xx_sys_suspend , lpc32xx_sys_suspend_sz ) ; flush_icache_range ( ( unsigned long ) TEMP_IRAM_AREA , ( unsigned long ) ( TEMP_IRAM_AREA ) + lpc32xx_sys_suspend_sz ) ; lpc32xx_suspend_ptr = ( void * ) TEMP_IRAM_AREA ; flush_cache_all ( ) ; ( void ) lpc32xx_suspend_ptr ( ) ; memcpy ( ( void * ) TEMP_IRAM_AREA , iram_swap_area , lpc32xx_sys_suspend_sz ) ; return 0 ; } 