static void device_illegal_req ( amd_iommu_t * iommu , uint32_t * event ) { uint16_t deviceid ; uint8_t TR ; uint32_t addr_lo ; uint32_t addr_hi ; uint8_t type ; const char * reqerr ; const char * driver = ddi_driver_name ( iommu -> aiomt_dip ) ; int instance = ddi_get_instance ( iommu -> aiomt_dip ) ; const char * f = "device_illegal_req" ; ASSERT ( AMD_IOMMU_REG_GET32 ( & event [ 1 ] , AMD_IOMMU_EVENT_TYPE ) == AMD_IOMMU_EVENT_DEVICE_ILLEGAL_REQ ) ; deviceid = AMD_IOMMU_REG_GET32 ( & event [ 0 ] , AMD_IOMMU_EVENT_DEVICE_ILLEGAL_REQ_DEVICEID ) ; TR = AMD_IOMMU_REG_GET32 ( & event [ 1 ] , AMD_IOMMU_EVENT_DEVICE_ILLEGAL_REQ_TR ) ; type = AMD_IOMMU_REG_GET32 ( & event [ 1 ] , AMD_IOMMU_EVENT_DEVICE_ILLEGAL_REQ_TYPE ) ; reqerr = get_illegal_req ( type , TR ) ; addr_lo = event [ 2 ] ; addr_hi = event [ 3 ] ; } 