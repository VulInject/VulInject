static void fcontract ( u8 * output , limb * input_limbs ) { int i ; s32 input [ 10 ] ; s32 mask ; for ( i = 0 ; i < 10 ; i ++ ) { input [ i ] = input_limbs [ i ] ; } for ( j = 0 ; j < 2 ; ++ j ) { for ( i = 0 ; i < 9 ; ++ i ) { if ( ( i & 1 ) == 1 ) { const s32 mask = input [ i ] >> 31 ; const s32 carry = - ( ( input [ i ] & mask ) >> 25 ) ; input [ i ] = input [ i ] + ( carry << 25 ) ; input [ i + 1 ] = input [ i + 1 ] - carry ; } else { const s32 mask = input [ i ] >> 31 ; const s32 carry = - ( ( input [ i ] & mask ) >> 26 ) ; input [ i ] = input [ i ] + ( carry << 26 ) ; input [ i + 1 ] = input [ i + 1 ] - carry ; } } { const s32 mask = input [ 9 ] >> 31 ; const s32 carry = - ( ( input [ 9 ] & mask ) >> 25 ) ; input [ 9 ] = input [ 9 ] + ( carry << 25 ) ; input [ 0 ] = input [ 0 ] - ( carry * 19 ) ; } } { const s32 mask = input [ 0 ] >> 31 ; const s32 carry = - ( ( input [ 0 ] & mask ) >> 26 ) ; input [ 0 ] = input [ 0 ] + ( carry << 26 ) ; input [ 1 ] = input [ 1 ] - carry ; } for ( j = 0 ; j < 2 ; j ++ ) { for ( i = 0 ; i < 9 ; i ++ ) { if ( ( i & 1 ) == 1 ) { const s32 carry = input [ i ] >> 25 ; input [ i ] &= 0x1ffffff ; input [ i + 1 ] += carry ; } else { const s32 carry = input [ i ] >> 26 ; input [ i ] &= 0x3ffffff ; input [ i + 1 ] += carry ; } } { const s32 carry = input [ 9 ] >> 25 ; input [ 9 ] &= 0x1ffffff ; input [ 0 ] += 19 * carry ; } } mask = s32_gte ( input [ 0 ] , 0x3ffffed ) ; for ( i = 1 ; i < 10 ; i ++ ) { if ( ( i & 1 ) == 1 ) { mask &= s32_eq ( input [ i ] , 0x1ffffff ) ; } else { mask &= s32_eq ( input [ i ] , 0x3ffffff ) ; } } input [ 0 ] -= mask & 0x3ffffed ; for ( i = 1 ; i < 10 ; i ++ ) { if ( ( i & 1 ) == 1 ) { input [ i ] -= mask & 0x1ffffff ; } else { input [ i ] -= mask & 0x3ffffff ; } } input [ 1 ] <<= 2 ; input [ 2 ] <<= 3 ; input [ 3 ] <<= 5 ; input [ 4 ] <<= 6 ; input [ 6 ] <<= 1 ; input [ 7 ] <<= 3 ; input [ 8 ] <<= 4 ; input [ 9 ] <<= 6 ; output [ s + 0 ] |= input [ i ] & 0xff ; output [ s + 1 ] = ( input [ i ] >> 8 ) & 0xff ; output [ s + 2 ] = ( input [ i ] >> 16 ) & 0xff ; output [ s + 3 ] = ( input [ i ] >> 24 ) & 0xff ; output [ 0 ] = 0 ; output [ 16 ] = 0 ; F ( 0 , 0 ) ; F ( 1 , 3 ) ; F ( 2 , 6 ) ; F ( 3 , 9 ) ; F ( 4 , 12 ) ; F ( 5 , 16 ) ; F ( 6 , 19 ) ; F ( 7 , 22 ) ; F ( 8 , 25 ) ; F ( 9 , 28 ) ; } 