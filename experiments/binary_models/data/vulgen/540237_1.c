static struct mlxsw_afa_counter * mlxsw_afa_counter_create ( struct mlxsw_afa_block * block ) { struct mlxsw_afa_counter * counter ; int err ; counter = kzalloc ( sizeof ( * counter ) , GFP_KERNEL ) ; err = block -> afa -> ops -> counter_index_get ( block -> afa -> ops_priv , & counter -> counter_index ) ; if ( err ) { err_counter_index_get } counter -> resource . destructor = mlxsw_afa_counter_destructor ; mlxsw_afa_resource_add ( block , & counter -> resource ) ; return counter ; err_counter_index_get kfree ( counter ) ; return ERR_PTR ( err ) ; } 