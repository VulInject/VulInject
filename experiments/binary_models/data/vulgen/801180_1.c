struct connection * ecpg_get_connection ( const char * connection_name ) { struct connection * ret = NULL ; if ( ( connection_name == NULL ) || ( strcmp ( connection_name , "CURRENT" ) == 0 ) ) { ecpg_pthreads_init ( ) ; ret = pthread_getspecific ( actual_connection_key ) ; ret = actual_connection ; } else { pthread_mutex_lock ( & connections_mutex ) ; ret = ecpg_get_connection_nr ( connection_name ) ; pthread_mutex_unlock ( & connections_mutex ) ; } return ret ; } 