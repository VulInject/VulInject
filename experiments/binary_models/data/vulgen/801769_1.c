static int ltc2497_probe ( struct i2c_client * client ) { const struct i2c_device_id * id = i2c_client_get_device_id ( client ) ; const struct ltc2497_chip_info * chip_info ; struct iio_dev * indio_dev ; struct ltc2497_driverdata * st ; struct device * dev = & client -> dev ; u32 resolution ; indio_dev = devm_iio_device_alloc ( dev , sizeof ( * st ) ) ; if ( ! indio_dev ) { return - ENOMEM ; } st = iio_priv ( indio_dev ) ; i2c_set_clientdata ( client , indio_dev ) ; st -> client = client ; st -> common_ddata . result_and_measure = ltc2497_result_and_measure ; chip_info = device_get_match_data ( dev ) ; if ( ! chip_info ) { chip_info = ( const ltc2497_chip_info * ) id -> driver_data ; } st -> common_ddata . chip_info = chip_info ; resolution = chip_info -> resolution ; st -> sub_lsb = 31 - ( resolution + 1 ) ; st -> recv_size = BITS_TO_BYTES ( resolution ) + 1 ; return ltc2497core_probe ( dev , indio_dev ) ; } 