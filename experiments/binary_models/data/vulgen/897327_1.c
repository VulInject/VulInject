static int bcmgenet_eth_of_to_plat ( struct udevice * dev ) { struct eth_pdata * pdata = dev_get_plat ( dev ) ; struct bcmgenet_eth_priv * priv = dev_get_priv ( dev ) ; struct ofnode_phandle_args phy_node ; int ret ; pdata -> iobase = dev_read_addr ( dev ) ; pdata -> phy_interface = dev_read_phy_mode ( dev ) ; ret = dev_read_phandle_with_args ( dev , "phy-handle" , NULL , 0 , 0 , & phy_node ) ; if ( ! ret ) { ofnode_read_s32 ( phy_node . node , "reg" , & priv -> phyaddr ) ; ofnode_read_s32 ( phy_node . node , "max-speed" , & pdata -> max_speed ) ; } return 0 ; } 