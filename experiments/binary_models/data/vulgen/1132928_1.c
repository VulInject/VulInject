int main ( int argc , char * * argv ) { int ret ; netloc_topology_t topology ; netloc_map_t map ; if ( 0 != parse_args ( argc , argv ) ) { printf ( "Usage: %s\n" "\t%s|%s<directory with hwloc and netloc data directories>\n" "\t[%s|%s<output directory>]\n" "\t[%s|%s<IB Fabric ID, eg. fec0:0000:0000:0000>]\n" "\t[%s|%s] [--help|-h]\n" , argv [ 0 ] , ARG_DATADIR , ARG_SHORT_DATADIR , ARG_OUTDIR , ARG_SHORT_OUTDIR , ARG_FABRIC , ARG_SHORT_FABRIC , ARG_VERBOSE , ARG_SHORT_VERBOSE ) ; printf ( "     Default %-10s = current working directory\n" , ARG_OUTDIR ) ; return NETLOC_ERROR ; } asprintf ( & file_location , "%stopology.conf" , outdir ) ; topology = setup_topology ( datadir ) ; ( verbose ) ?printf ( "Successfully Created Network Topology \n" ) : 0 ; map = setup_map ( datadir ) ; ( verbose ) ?printf ( "Successfully Created Network Map\n" ) : 0 ; node_group_table = malloc ( sizeof ( node_group ) * node_groups_max ) ; switch_name_table = malloc ( sizeof ( switch_name * ) * switch_name_max ) ; ret = generate_topology_file ( & topology , & map ) ; if ( NETLOC_SUCCESS == ret ) { printf ( "\nDone generating topology.conf file from NetLoc data\n" ) ; } else { printf ( "Error: Couldn't Create topology.conf file from NetLoc data\n" ) ; } netloc_detach ( topology ) ; netloc_map_destroy ( map ) ; return ret ; } 