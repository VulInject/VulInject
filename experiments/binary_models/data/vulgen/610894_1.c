void ehci_handle_ue ( ehci_state_t * ehcip ) void ehci_handle_frame_list_rollover ( ehci_state_t * ehcip ) void ehci_handle_endpoint_reclaimation ( ehci_state_t * ehcip ) void ehci_traverse_active_qtd_list ( ehci_state_t * ehcip ) static ehci_qtd_t * ehci_create_done_qtd_list ( ehci_state_t * ehcip ) static usb_cr_t ehci_parse_error ( ehci_state_t * ehcip , ehci_qtd_t * qtd ) usb_cr_t ehci_check_for_error ( ehci_state_t * ehcip , ehci_pipe_private_t * pp , ehci_trans_wrapper_t * tw , ehci_qtd_t * qtd , uint_t ctrl ) static usb_cr_t ehci_check_for_short_xfer ( ehci_state_t * ehcip , ehci_pipe_private_t * pp , ehci_trans_wrapper_t * tw , ehci_qtd_t * qtd ) void ehci_handle_error ( ehci_state_t * ehcip , ehci_qtd_t * qtd , usb_cr_t error ) static void ehci_cleanup_data_underrun ( ehci_state_t * ehcip , ehci_trans_wrapper_t * tw , ehci_qtd_t * qtd ) static void ehci_handle_normal_qtd ( ehci_state_t * ehcip , ehci_qtd_t * qtd , ehci_trans_wrapper_t * tw ) void ehci_handle_ctrl_qtd ( ehci_state_t * ehcip , ehci_pipe_private_t * pp , ehci_trans_wrapper_t * tw , ehci_qtd_t * qtd , void * ) void ehci_handle_bulk_qtd ( ehci_state_t * ehcip , ehci_pipe_private_t * pp , ehci_trans_wrapper_t * tw , ehci_qtd_t * qtd , void * ) void ehci_handle_intr_qtd ( ehci_state_t * ehcip , ehci_pipe_private_t * pp , ehci_trans_wrapper_t * tw , ehci_qtd_t * qtd , void * ) static void ehci_handle_one_xfer_completion ( ehci_state_t * ehcip , ehci_trans_wrapper_t * tw ) static void ehci_sendup_qtd_message ( ehci_state_t * ehcip , ehci_pipe_private_t * pp , ehci_trans_wrapper_t * tw , ehci_qtd_t * qtd , usb_cr_t error ) void ehci_handle_ue ( ehci_state_t * ehcip ) { usb_frame_number_t before_frame_number , after_frame_number ; ASSERT ( mutex_owned ( & ehcip -> ehci_int_mutex ) ) ; USB_DPRINTF_L3 ( PRINT_MASK_INTR , ehcip -> ehci_log_hdl , "ehci_handle_ue: Handling of UE interrupt" ) ; before_frame_number = ehci_get_current_frame_number ( ehcip ) ; drv_usecwait ( EHCI_TIMEWAIT ) ; after_frame_number = ehci_get_current_frame_number ( ehcip ) ; USB_DPRINTF_L3 ( PRINT_MASK_INTR , ehcip -> ehci_log_hdl , "ehci_handle_ue: Before Frame Number 0x%llx " "After Frame Number 0x%llx" , ( unsigned long long ) before_frame_number , ( unsigned long long ) after_frame_number ) ; if ( ( ehci_do_soft_reset ( ehcip ) ) != USB_SUCCESS ) { USB_DPRINTF_L0 ( PRINT_MASK_INTR , ehcip -> ehci_log_hdl , "Unrecoverable USB Hardware Error" ) ; Set_OpReg ( ehci_interrupt , ( Get_OpReg ( ehci_interrupt ) & ~ EHCI_INTR_HOST_SYSTEM_ERROR ) ) ; Set_OpReg ( ehci_config_flag , EHCI_CONFIG_FLAG_CLASSIC ) ; ehcip -> ehci_hc_soft_state = EHCI_CTLR_ERROR_STATE ; } } 