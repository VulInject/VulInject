PHP_COM_DOTNET_API IDispatch * php_com_wrapper_export ( zval * val ) { php_dispatchex * disp = NULL ; if ( Z_TYPE_P ( val ) != IS_OBJECT ) { return NULL ; } if ( php_com_is_valid_object ( val ) ) { php_com_dotnet_object * obj = CDNO_FETCH ( val ) ; if ( obj == NULL ) { return NULL ; } if ( V_VT ( & obj -> v ) == VT_DISPATCH && V_DISPATCH ( & obj -> v ) ) { return V_DISPATCH ( & obj -> v ) ; } return NULL ; } disp = disp_constructor ( val ) ; generate_dispids ( disp ) ; return ( IDispatch * ) disp ; } 