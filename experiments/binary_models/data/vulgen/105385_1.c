static void pr_operations ( struct node * node , CBFUNC cbf , void * cb ) { char buf [ 64 ] ; int operation ; int delim = 0 ; * buf = 0 ; if ( ! node -> value || ! ( operation = * ( int * ) node -> value ) ) { * cbf ( cb , "*" , 1 ) ; return ; } if ( operation & HTTP ) { if ( ( operation & HTTP ) == HTTP ) { * cbf ( cb , buf , sprintf ( buf , "HTTP" ) ) ; } else { * cbf ( cb , buf , sprintf ( buf , "%s%s%s%s%s%s%s%s%s" , ( operation & HTTP_GET ) ?"HTTP_GET" : "" , ( ( operation & HTTP_GET ) && ( operation & ( HTTP_PUT | HTTP_POST | HTTP_HEAD | HTTP_OTHER ) ) ) ?"," : "" , ( operation & HTTP_PUT ) ?"HTTP_PUT" : "" , ( ( operation & HTTP_PUT ) && ( operation & ( HTTP_POST | HTTP_HEAD | HTTP_OTHER ) ) ) ?"," : "" , ( operation & HTTP_POST ) ?"HTTP_POST" : "" , ( ( operation & HTTP_POST ) && ( operation & ( HTTP_HEAD | HTTP_OTHER ) ) ) ?"," : "" , ( operation & HTTP_HEAD ) ?"HTTP_HEAD" : "" , ( ( operation & HTTP_HEAD ) && ( operation & HTTP_OTHER ) ) ?"," : "" , ( operation & HTTP_OTHER ) ?"HTTP_OTHER" : "" ) ) ; } delim = 1 ; } if ( operation & HTTP_CONNECT ) { * cbf ( cb , buf , sprintf ( buf , "%s%s" , delim ?"," : "" , "HTTP_CONNECT" ) ) ; delim = 1 ; } if ( operation & FTP ) { if ( ( operation & FTP ) == FTP ) { * cbf ( cb , buf , sprintf ( buf , "%s%s" , delim ?"," : "" , "FTP" ) ) ; } else { * cbf ( cb , buf , sprintf ( buf , "%s%s%s%s%s%s" , delim ?"," : "" , ( operation & FTP_GET ) ?"FTP_GET" : "" , ( ( operation & FTP_GET ) && ( operation & ( FTP_PUT | FTP_LIST ) ) ) ?"," : "" , ( operation & FTP_PUT ) ?"FTP_PUT" : "" , ( ( operation & FTP_PUT ) && ( operation & FTP_LIST ) ) ?"," : "" , ( operation & FTP_LIST ) ?"FTP_LIST" : "" ) ) ; } delim = 1 ; } if ( operation & CONNECT ) { * cbf ( cb , buf , sprintf ( buf , "%s%s" , delim ?"," : "" , "CONNECT" ) ) ; delim = 1 ; } if ( operation & BIND ) { * cbf ( cb , buf , sprintf ( buf , "%s%s" , delim ?"," : "" , "BIND" ) ) ; delim = 1 ; } if ( operation & UDPASSOC ) { * cbf ( cb , buf , sprintf ( buf , "%s%s" , delim ?"," : "" , "UDPASSOC" ) ) ; delim = 1 ; } if ( operation & ICMPASSOC ) { * cbf ( cb , buf , sprintf ( buf , "%s%s" , delim ?"," : "" , "ICMPASSOC" ) ) ; delim = 1 ; } if ( operation & DNSRESOLVE ) { * cbf ( cb , buf , sprintf ( buf , "%s%s" , delim ?"," : "" , "DNSRESOLVE" ) ) ; delim = 1 ; } } 