static u8 * rtw89_hex2bin_user ( struct rtw89_dev * rtwdev , const char __user * user_buf , size_t count ) { char * buf ; u8 * bin ; int num ; int err = 0 ; buf = memdup_user ( user_buf , count ) ; num = count / 2 ; bin = kmalloc ( num , GFP_KERNEL ) ; if ( ! bin ) { err = - EFAULT ; out } if ( hex2bin ( bin , buf , num ) ) { rtw89_info ( rtwdev , "valid format: H1H2H3...\n" ) ; kfree ( bin ) ; err = - EINVAL ; } out kfree ( buf ) ; return err ?ERR_PTR ( err ) : bin ; } 