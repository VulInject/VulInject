rf64_write_tailer ( ) { psf -> header . ptr [ 0 ] = 0 ; psf -> header . indx = 0 ; if ( psf -> bytewidth > 0 && psf -> sf . seekable == SF_TRUE ) { psf -> datalength = psf -> sf . frames * psf -> bytewidth * psf -> sf . channels ; psf -> dataend = psf -> dataoffset + psf -> datalength ; } if ( psf -> dataend > 0 ) { psf_fseek ( psf , psf -> dataend , SEEK_SET ) ; } else { psf -> dataend = psf_fseek ( psf , 0 , SEEK_END ) ; } if ( psf -> dataend & 1 ) { psf_binheader_writef ( psf , "z" , BHWz ( 1 ) ) ; } if ( psf -> strings . flags & SF_STR_LOCATE_END ) { psf_fwrite ( psf -> header . ptr , psf -> header . indx , 1 , 0 ) ; } if ( psf -> header . indx > 0 ) { psf_fwrite ( psf -> header . ptr , psf -> header . indx , 1 , psf ) ; } return 0 ; } 