static int enable_8960 ( struct tsens_priv * priv , int id ) { int ret ; u32 reg , mask = BIT ( id ) ; ret = regmap_read ( priv -> tm_map , CNTL_ADDR , & reg ) ; if ( ret ) { return ret ; } if ( id > 5 ) { mask = GENMASK ( 10 , 6 ) ; } if ( ( reg & mask ) == mask ) { return 0 ; } ret = regmap_write ( priv -> tm_map , CNTL_ADDR , reg | SW_RST ) ; if ( ret ) { return ret ; } reg |= MEASURE_PERIOD ; if ( priv -> num_sensors > 1 ) { reg |= mask | SLP_CLK_ENA | EN ; } else { reg |= mask | SLP_CLK_ENA_8660 | EN ; } ret = regmap_write ( priv -> tm_map , CNTL_ADDR , reg ) ; if ( ret ) { return ret ; } return 0 ; } 