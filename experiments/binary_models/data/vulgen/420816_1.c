uint32_t smb_opipe_fsctl ( smb_request_t * sr , smb_fsctl_t * fsctl ) { uint32_t status ; switch ( fsctl -> CtlCode ) { case FSCTL_PIPE_TRANSCEIVE : status = smb_opipe_transceive ( sr , fsctl ) ; break ; case FSCTL_PIPE_PEEK : status = NT_STATUS_INVALID_DEVICE_REQUEST ; break ; case FSCTL_PIPE_WAIT : status = smb_opipe_wait ( sr , fsctl ) ; break ; default : ASSERT ( ! "CtlCode" ) ; status = NT_STATUS_INTERNAL_ERROR ; break ; } return ( status ) ; } 