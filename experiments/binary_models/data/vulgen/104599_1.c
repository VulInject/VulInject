enum sci_status sci_remote_node_context_destruct ( struct sci_remote_node_context * sci_rnc , scics_sds_remote_node_context_callback cb_fn , void * cb_p ) { enum scis_sds_remote_node_context_states state ; state = sci_rnc -> sm . current_state_id ; switch ( state ) { case SCI_RNC_INVALIDATING : sci_remote_node_context_setup_to_destroy ( sci_rnc , cb_fn , cb_p ) ; return SCI_SUCCESS ; case SCI_RNC_POSTING : case SCI_RNC_RESUMING : case SCI_RNC_READY : case SCI_RNC_TX_SUSPENDED : case SCI_RNC_TX_RX_SUSPENDED : sci_remote_node_context_setup_to_destroy ( sci_rnc , cb_fn , cb_p ) ; return SCI_SUCCESS ; case SCI_RNC_AWAIT_SUSPENSION : sci_remote_node_context_setup_to_destroy ( sci_rnc , cb_fn , cb_p ) ; return SCI_SUCCESS ; case SCI_RNC_INITIAL : dev_warn ( scirdev_to_dev ( rnc_to_dev ( sci_rnc ) ) , "%s: invalid state: %s\n" , __func__ , rnc_state_name ( state ) ) ; return SCI_SUCCESS ; default : dev_warn ( scirdev_to_dev ( rnc_to_dev ( sci_rnc ) ) , "%s: invalid state %s\n" , __func__ , rnc_state_name ( state ) ) ; return SCI_FAILURE_INVALID_STATE ; } } 