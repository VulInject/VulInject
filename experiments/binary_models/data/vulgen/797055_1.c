dcc_prepare_row_send ( , , , ) { static char pos [ 16 ] , size [ 16 ] , kbs [ 14 ] , perc [ 14 ] , eta [ 14 ] ; int to_go ; float per ; per = ( float ) ( ( dcc -> ack * 100.00 ) / dcc -> size ) ; proper_unit ( dcc -> size , size , sizeof ( size ) ) ; proper_unit ( dcc -> pos , pos , sizeof ( pos ) ) ; g_snprintf ( kbs , sizeof ( kbs ) , "%.1f" , ( ( float ) dcc -> cps ) / 1024 ) ; g_snprintf ( perc , sizeof ( perc ) , "%.0f%%" , per ) ; if ( dcc -> cps != 0 ) { to_go = ( dcc -> size - dcc -> ack ) / dcc -> cps ; g_snprintf ( eta , sizeof ( eta ) , "%.2d:%.2d:%.2d" , to_go / 3600 , ( to_go / 60 ) % 60 , to_go % 60 ) ; } else { strcpy ( eta , "--:--:--" ) ; } if ( update_only ) { gtk_list_store_set ( store , iter , COL_STATUS , _ ( dccstat [ dcc -> dccstat ] . name ) , COL_POS , pos , COL_PERC , perc , COL_SPEED , kbs , COL_ETA , eta , COL_COLOR , dccstat [ dcc -> dccstat ] . color == 1 ?NULL : colors + dccstat [ dcc -> dccstat ] . color , - 1 ) ; } else { gtk_list_store_set ( store , iter , COL_TYPE , pix_up , COL_STATUS , _ ( dccstat [ dcc -> dccstat ] . name ) , COL_FILE , file_part ( dcc -> file ) , COL_SIZE , size , COL_POS , pos , COL_PERC , perc , COL_SPEED , kbs , COL_ETA , eta , COL_NICK , dcc -> nick , COL_DCC , dcc , COL_COLOR , dccstat [ dcc -> dccstat ] . color == 1 ?NULL : colors + dccstat [ dcc -> dccstat ] . color , - 1 ) ; } } 