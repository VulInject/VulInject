void recv_pcap_packet ( u_char * user , const struct pcap_pkthdr * h , const u_char * bytes ) { struct state * st ; struct pcr_kenonce * kn = & crypto_req -> pcr_d . kn ; zero ( kn ) ; recv_pcap_packet_gen ( user , h , bytes ) ; st = state_with_serialno ( 1 ) ; if ( st ) { st -> st_connection -> extra_debugging = DBG_PARSING | DBG_EMITTING | DBG_CONTROL | DBG_CONTROLMORE ; clonetowirechunk ( & kn -> thespace , kn -> space , & kn -> secret , SS ( secret . ptr ) , SS ( secret . len ) ) ; clonetowirechunk ( & kn -> thespace , kn -> space , & kn -> n , SS ( nr . ptr ) , SS ( nr . len ) ) ; clonetowirechunk ( & kn -> thespace , kn -> space , & kn -> gi , SS ( gr . ptr ) , SS ( gr . len ) ) ; run_continuation ( crypto_req ) ; } } 