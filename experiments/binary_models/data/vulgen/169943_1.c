static void vmmouse_mouse_event ( void * opaque , int x , int y , int dz , int buttons_state ) { VMMouseState * s = opaque ; int buttons = 0 ; DPRINTF ( "vmmouse_mouse_event(%d, %d, %d, %d)\n" , x , y , dz , buttons_state ) ; if ( ( buttons_state & MOUSE_EVENT_LBUTTON ) ) { buttons |= 0x20 ; } if ( ( buttons_state & MOUSE_EVENT_RBUTTON ) ) { buttons |= 0x10 ; } if ( ( buttons_state & MOUSE_EVENT_MBUTTON ) ) { buttons |= 0x08 ; } if ( s -> absolute ) { x <<= 1 ; y <<= 1 ; } s -> queue [ s -> nb_queue ++ ] = buttons ; s -> queue [ s -> nb_queue ++ ] = x ; s -> queue [ s -> nb_queue ++ ] = y ; s -> queue [ s -> nb_queue ++ ] = dz ; i8042_isa_mouse_fake_event ( s -> i8042 ) ; } 