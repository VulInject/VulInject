static void igb_set_itr ( struct igb_q_vector * q_vector ) { struct igb_adapter * adapter = q_vector -> adapter ; u32 new_itr = q_vector -> itr_val ; u8 current_itr = 0 ; if ( adapter -> link_speed != SPEED_1000 ) { current_itr = 0 ; new_itr = IGB_4K_ITR ; set_itr_now } igb_update_itr ( q_vector , & q_vector -> tx ) ; igb_update_itr ( q_vector , & q_vector -> rx ) ; current_itr = max ( q_vector -> rx . itr , q_vector -> tx . itr ) ; if ( current_itr == lowest_latency && ( ( q_vector -> rx . ring && adapter -> rx_itr_setting == 3 ) || ( ! q_vector -> rx . ring && adapter -> tx_itr_setting == 3 ) ) ) { current_itr = low_latency ; } switch ( current_itr ) { case lowest_latency : new_itr = IGB_70K_ITR ; break ; case low_latency : new_itr = IGB_20K_ITR ; break ; case bulk_latency : new_itr = IGB_4K_ITR ; break ; default : break ; } set_itr_now } 