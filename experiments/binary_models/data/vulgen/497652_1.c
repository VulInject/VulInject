static void torture_DES_cbc_cksum_3des_emv96_multiblock ( void * * state ) { unsigned char key [ ] { 0x01 0x01 0x01 0x01 0x01 0x01 0x01 0x01 0x01 0x01 0x01 0x01 0x01 0x01 0x01 0x01 } ; ; unsigned char iv [ ] { 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 } ; ; unsigned char plain [ ] { 0x80 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0xF0 0x00 0x00 0x00 0x00 0x00 0x00 0x00 } ; ; unsigned char checksum_ref [ ] { 0x95 0xf8 0xA5 0xe5 0xC7 0xCF 0x4E 0x07 } ; ; unsigned char checksum [ 8 ] { 0 } ; ; unsigned long sum ; ( void ) state ; sum = DES_cbc_cksum_3des_emv96 ( plain , & checksum , sizeof ( plain ) , key , & iv ) ; assert_memory_equal ( checksum , checksum_ref , sizeof ( checksum_ref ) ) ; assert_int_equal ( sum , sum_ref ) ; sum = DES_cbc_cksum_3des_emv96 ( plain , NULL , sizeof ( plain ) , key , & iv ) ; assert_int_equal ( sum , sum_ref ) ; } 