static int gen_options ( char * * newfile ) { static char tempfile [ LY_MAXPATH ] "\0" ; ; int i ; char * buffer = NULL ; BOOLEAN disable_all = FALSE ; FILE * fp0 ; size_t cset_len = 0 ; size_t text_len = ( size_t ) ( ( LYcolLimit > 45 ) ?LYcolLimit - ( LABEL_LEN + 2 + MARGIN_LEN ) : 7 ) ; if ( ( fp0 = InternalPageFP ( tempfile , TRUE ) ) == 0 ) { return ( NOT_FOUND ) ; } LYLocalFileToURL ( newfile , tempfile ) ; LYforce_no_cache = TRUE ; if ( ! LYUseFormsOptions ) { disable_all = TRUE ; } BeginInternalPage ( fp0 , OPTIONS_TITLE , NULL ) ; fprintf ( fp0 , "<form action=\"%s\" method=\"post\">\n" , STR_LYNXOPTIONS ) ; fprintf ( fp0 , "<input name=\"%s\" type=\"hidden\" value=\"%s\">\n" , secure_string , NewSecureValue ( ) ) ; fprintf ( fp0 , "<p align=center>\n" ) ; if ( ! disable_all ) { fprintf ( fp0 , "<input type=\"submit\" value=\"%s\">- \n" , LYEntifyValue ( & buffer , ACCEPT_CHANGES ) ) ; fprintf ( fp0 , "<input type=\"reset\" value=\"%s\">- \n" , LYEntifyValue ( & buffer , RESET_CHANGES ) ) ; fprintf ( fp0 , "%s - \n" , LYEntifyTitle ( & buffer , CANCEL_CHANGES ) ) ; } fprintf ( fp0 , "<a href=\"%s%s\">%s</a>\n" , helpfilepath , LYEntifyTitle ( & buffer , OPTIONS_HELP ) , TO_HELP ) ; if ( ! no_option_save ) { if ( ! disable_all ) { fprintf ( fp0 , "<p align=center>%s: " , LYEntifyTitle ( & buffer , SAVE_OPTIONS ) ) ; fprintf ( fp0 , "<input type=\"checkbox\" name=\"%s\">\n" , save_options_string ) ; } fprintf ( fp0 , "<br>%s\n" , LYEntifyTitle ( & buffer , gettext ( "(options marked with (!) will not be saved)" ) ) ) ; } fprintf ( fp0 , "<pre>\n" ) ; PutHeader ( fp0 , gettext ( "General Preferences" ) ) ; PutLabel ( fp0 , gettext ( "User mode" ) , user_mode_string ) ; BeginSelect ( fp0 , user_mode_string ) ; PutOptValues ( fp0 , user_mode , user_mode_values ) ; EndSelect ( fp0 ) ; PutLabel ( fp0 , gettext ( "Editor" ) , editor_string ) ; PutTextInput ( fp0 , editor_string , NonNull ( editor ) , text_len , DISABLED ( no_editor || system_editor ) ) ; PutLabel ( fp0 , gettext ( "Type of Search" ) , search_type_string ) ; BeginSelect ( fp0 , search_type_string ) ; PutOptValues ( fp0 , LYcase_sensitive , search_type_values ) ; EndSelect ( fp0 ) ; PutHeader ( fp0 , gettext ( "Security and Privacy" ) ) ; PutLabel ( fp0 , gettext ( "Cookies" ) , will_save_cookies ( ) ) ; BeginSelect ( fp0 , cookies_string ) ; PutOption ( fp0 , ! LYSetCookies , cookies_ignore_all_string , cookies_ignore_all_string ) ; PutOption ( fp0 , LYSetCookies && ! LYAcceptAllCookies , cookies_up_to_user_string , cookies_up_to_user_string ) ; PutOption ( fp0 , LYSetCookies && LYAcceptAllCookies , cookies_accept_all_string , cookies_accept_all_string ) ; EndSelect ( fp0 ) ; PutLabel ( fp0 , gettext ( "Cookie RFC-version" ) , cookie_version_string ) ; BeginSelect ( fp0 , cookie_version_string ) ; PutOptValues ( fp0 , cookie_version , cookies_values ) ; EndSelect ( fp0 ) ; PutLabel ( fp0 , gettext ( "Invalid-Cookie Prompting" ) , cookie_prompt_string ) ; BeginSelect ( fp0 , cookie_prompt_string ) ; PutOptValues ( fp0 , cookie_noprompt , prompt_values ) ; EndSelect ( fp0 ) ; PutLabel ( fp0 , gettext ( "SSL Prompting" ) , ssl_prompt_string ) ; BeginSelect ( fp0 , ssl_prompt_string ) ; PutOptValues ( fp0 , ssl_noprompt , prompt_values ) ; EndSelect ( fp0 ) ; PutLabel ( fp0 , gettext ( "SSL client certificate file" ) , ssl_client_certificate_file ) ; PutTextInput ( fp0 , ssl_client_certificate_file , NonNull ( SSL_client_cert_file ) , text_len , "" ) ; PutLabel ( fp0 , gettext ( "SSL client key file" ) , ssl_client_key_file ) ; PutTextInput ( fp0 , ssl_client_key_file , NonNull ( SSL_client_key_file ) , text_len , "" ) ; PutHeader ( fp0 , gettext ( "Keyboard Input" ) ) ; PutLabel ( fp0 , gettext ( "Keypad mode" ) , keypad_mode_string ) ; BeginSelect ( fp0 , keypad_mode_string ) ; PutOptValues ( fp0 , keypad_mode , keypad_mode_values ) ; EndSelect ( fp0 ) ; PutLabel ( fp0 , gettext ( "Emacs keys" ) , emacs_keys_string ) ; BeginSelect ( fp0 , emacs_keys_string ) ; PutOptValues ( fp0 , emacs_keys , bool_values ) ; EndSelect ( fp0 ) ; PutLabel ( fp0 , gettext ( "VI keys" ) , vi_keys_string ) ; BeginSelect ( fp0 , vi_keys_string ) ; PutOptValues ( fp0 , vi_keys , bool_values ) ; EndSelect ( fp0 ) ; if ( LYEditorNames [ 1 ] ) { PutLabel ( fp0 , gettext ( "Line edit style" ) , lineedit_mode_string ) ; BeginSelect ( fp0 , lineedit_mode_string ) ; for ( i = 0 ; LYEditorNames [ i ] ; i ++ ) { char temp [ DigitsOf ( i ) + 3 ] ; sprintf ( temp , "%d" , i ) ; PutOption ( fp0 , i == current_lineedit , temp , LYEditorNames [ i ] ) ; } EndSelect ( fp0 ) ; } PutLabel ( fp0 , gettext ( "Keyboard layout" ) , kblayout_string ) ; BeginSelect ( fp0 , kblayout_string ) ; for ( i = 0 ; LYKbLayoutNames [ i ] ; i ++ ) { char temp [ DigitsOf ( i ) + 3 ] ; sprintf ( temp , "%d" , i ) ; PutOption ( fp0 , i == current_layout , temp , LYKbLayoutNames [ i ] ) ; } EndSelect ( fp0 ) ; PutHeader ( fp0 , gettext ( "Display and Character Set" ) ) ; PutLabel ( fp0 , gettext ( "Use locale-based character set" ) , locale_charset_string ) ; BeginSelect ( fp0 , locale_charset_string ) ; PutOptValues ( fp0 , LYLocaleCharset , bool_values ) ; EndSelect ( fp0 ) ; PutLabel ( fp0 , gettext ( "Use HTML5 charset replacements" ) , html5_charsets_string ) ; BeginSelect ( fp0 , html5_charsets_string ) ; PutOptValues ( fp0 , html5_charsets , bool_values ) ; EndSelect ( fp0 ) ; PutLabel ( fp0 , gettext ( "Display character set" ) , display_char_set_string ) ; MaybeSelect ( fp0 , LYLocaleCharset , display_char_set_string ) ; for ( i = 0 ; LYchar_set_names [ i ] ; i ++ ) { char temp [ DigitsOf ( i ) + 3 ] ; size_t len = strlen ( LYchar_set_names [ i ] ) ; if ( len > cset_len ) { cset_len = len ; } sprintf ( temp , "%d" , i ) ; if ( ! charset_subsets [ i ] . hide_display ) { PutOption ( fp0 , i == current_char_set , temp , LYchar_set_names [ i ] ) ; } } EndSelect ( fp0 ) ; { int curval ; curval = UCLYhndl_for_unspec ; PutLabel ( fp0 , gettext ( "Assumed document character set" ) , assume_char_set_string ) ; BeginSelect ( fp0 , assume_char_set_string ) ; for ( i = 0 ; i < LYNumCharsets ; i ++ ) { if ( ! charset_subsets [ i ] . hide_assumed ) { PutOption ( fp0 , i == curval , LYCharSet_UC [ i ] . MIMEname , LYCharSet_UC [ i ] . MIMEname ) ; } } EndSelect ( fp0 ) ; } { PutLabel ( fp0 , gettext ( "Internationalized domain names" ) , idna_mode_string ) ; BeginSelect ( fp0 , idna_mode_string ) ; for ( i = 0 ; idna_values [ i ] . value != 0 ; i ++ ) { PutOption ( fp0 , idna_values [ i ] . value == LYidnaMode , idna_values [ i ] . HtmlName , idna_values [ i ] . LongName ) ; } EndSelect ( fp0 ) ; } if ( LYHaveCJKCharacterSet ) { PutLabel ( fp0 , gettext ( "CJK mode" ) , raw_mode_string ) ; } else { PutLabel ( fp0 , gettext ( "Raw 8-bit" ) , raw_mode_string ) ; } BeginSelect ( fp0 , raw_mode_string ) ; PutOptValues ( fp0 , LYRawMode , bool_values ) ; EndSelect ( fp0 ) ; PutLabel ( fp0 , gettext ( "X Display" ) , x_display_string ) ; PutTextInput ( fp0 , x_display_string , NonNull ( x_display ) , text_len , "" ) ; PutHeader ( fp0 , gettext ( "Document Appearance" ) ) ; SetupChosenShowColor ( ) ; PutLabel ( fp0 , gettext ( "Show color" ) , show_color_string ) ; if ( no_option_save ) { MaybeSelect ( fp0 , ! can_do_colors , show_color_string ) ; if ( LYShowColor == SHOW_COLOR_NEVER ) { LYShowColor = SHOW_COLOR_OFF ; } if ( LYShowColor == SHOW_COLOR_ALWAYS ) { LYShowColor = SHOW_COLOR_ON ; } PutOptValues ( fp0 , LYShowColor - SHOW_COLOR_OFF , bool_values ) ; } else { BeginSelect ( fp0 , show_color_string ) ; if ( can_do_colors ) { show_color_values [ 2 ] . HtmlName = on_string ; show_color_values [ 3 ] . LongName = always_string ; } else { show_color_values [ 2 ] . HtmlName = NULL ; show_color_values [ 3 ] . LongName = "Always try" ; } PutOptValues ( fp0 , LYChosenShowColor , show_color_values ) ; } EndSelect ( fp0 ) ; if ( HasOptValues ( color_style_values ) ) { PutLabel ( fp0 , gettext ( "Color style" ) , color_style_string ) ; BeginSelect ( fp0 , color_style_string ) ; PutOptValues ( fp0 , get_color_style_value ( ) , color_style_values ) ; EndSelect ( fp0 ) ; } if ( has_colors ( ) ) { PutLabel ( fp0 , gettext ( "Default colors" ) , default_colors_string ) ; BeginSelect ( fp0 , default_colors_string ) ; PutOptValues ( fp0 , LYuse_default_colors , bool_values ) ; EndSelect ( fp0 ) ; } PutLabel ( fp0 , gettext ( "Show cursor" ) , show_cursor_string ) ; BeginSelect ( fp0 , show_cursor_string ) ; PutOptValues ( fp0 , LYShowCursor , bool_values ) ; EndSelect ( fp0 ) ; PutLabel ( fp0 , gettext ( "Underline links" ) , underline_links_string ) ; BeginSelect ( fp0 , underline_links_string ) ; PutOptValues ( fp0 , LYUnderlineLinks , bool_values ) ; EndSelect ( fp0 ) ; PutLabel ( fp0 , gettext ( "Show scrollbar" ) , show_scrollbar_string ) ; BeginSelect ( fp0 , show_scrollbar_string ) ; PutOptValues ( fp0 , LYShowScrollbar , bool_values ) ; EndSelect ( fp0 ) ; PutLabel ( fp0 , gettext ( "Popups for select fields" ) , select_popups_string ) ; BeginSelect ( fp0 , select_popups_string ) ; PutOptValues ( fp0 , LYSelectPopups , bool_values ) ; EndSelect ( fp0 ) ; PutLabel ( fp0 , gettext ( "HTML error recovery" ) , DTD_recovery_string ) ; BeginSelect ( fp0 , DTD_recovery_string ) ; PutOptValues ( fp0 , Old_DTD , DTD_type_values ) ; EndSelect ( fp0 ) ; PutLabel ( fp0 , gettext ( "Bad HTML messages" ) , bad_html_string ) ; BeginSelect ( fp0 , bad_html_string ) ; PutOptValues ( fp0 , cfg_bad_html , bad_html_values ) ; EndSelect ( fp0 ) ; PutLabel ( fp0 , gettext ( "Show images" ) , will_save_images ( ) ) ; BeginSelect ( fp0 , images_string ) ; PutOption ( fp0 , ! pseudo_inline_alts && ! clickable_images , images_ignore_all_string , images_ignore_all_string ) ; PutOption ( fp0 , pseudo_inline_alts && ! clickable_images , images_use_label_string , images_use_label_string ) ; PutOption ( fp0 , clickable_images , images_use_links_string , images_use_links_string ) ; EndSelect ( fp0 ) ; PutLabel ( fp0 , gettext ( "Verbose images" ) , verbose_images_string ) ; BeginSelect ( fp0 , verbose_images_string ) ; PutOptValues ( fp0 , verbose_img , verbose_images_type_values ) ; EndSelect ( fp0 ) ; PutLabel ( fp0 , gettext ( "Collapse BR tags" ) , collapse_br_tags_string ) ; BeginSelect ( fp0 , collapse_br_tags_string ) ; PutOptValues ( fp0 , LYCollapseBRs , collapse_br_tags_values ) ; EndSelect ( fp0 ) ; PutLabel ( fp0 , gettext ( "Trim blank lines" ) , trim_blank_lines_string ) ; BeginSelect ( fp0 , trim_blank_lines_string ) ; PutOptValues ( fp0 , LYtrimBlankLines , trim_blank_lines_values ) ; EndSelect ( fp0 ) ; PutHeader ( fp0 , gettext ( "Headers Transferred to Remote Servers" ) ) ; PutLabel ( fp0 , gettext ( "Personal mail address" ) , mail_address_string ) ; PutTextInput ( fp0 , mail_address_string , NonNull ( personal_mail_address ) , text_len , "" ) ; PutLabel ( fp0 , gettext ( "Personal name for mail" ) , personal_name_string ) ; PutTextInput ( fp0 , personal_name_string , NonNull ( personal_mail_name ) , text_len , "" ) ; PutLabel ( fp0 , gettext ( "Password for anonymous ftp" ) , anonftp_password_string ) ; PutTextInput ( fp0 , anonftp_password_string , NonNull ( anonftp_password ) , text_len , "" ) ; PutLabel ( fp0 , gettext ( "Preferred content type" ) , preferred_content_string ) ; BeginSelect ( fp0 , preferred_content_string ) ; PutOptValues ( fp0 , LYContentType , content_values ) ; EndSelect ( fp0 ) ; PutLabel ( fp0 , gettext ( "Preferred media type" ) , preferred_media_string ) ; BeginSelect ( fp0 , preferred_media_string ) ; PutOptValues ( fp0 , LYAcceptMedia , media_values ) ; EndSelect ( fp0 ) ; PutLabel ( fp0 , gettext ( "Preferred encoding" ) , preferred_encoding_string ) ; BeginSelect ( fp0 , preferred_encoding_string ) ; PutOptValues ( fp0 , LYAcceptEncoding , encoding_values ) ; EndSelect ( fp0 ) ; PutLabel ( fp0 , gettext ( "Preferred document character set" ) , preferred_doc_char_string ) ; PutTextInput ( fp0 , preferred_doc_char_string , NonNull ( pref_charset ) , cset_len + 2 , "" ) ; PutLabel ( fp0 , gettext ( "Preferred document language" ) , preferred_doc_lang_string ) ; PutTextInput ( fp0 , preferred_doc_lang_string , NonNull ( language ) , cset_len + 2 , "" ) ; PutLabel ( fp0 , gettext ( "HTTP protocol" ) , http_protocol_string ) ; BeginSelect ( fp0 , http_protocol_string ) ; PutOptValues ( fp0 , HTprotocolLevel , http_protocol_values ) ; EndSelect ( fp0 ) ; if ( ! no_useragent ) { PutLabel ( fp0 , gettext ( "Send User-Agent header" ) , send_user_agent_string ) ; PutCheckBox ( fp0 , send_user_agent_string , LYSendUserAgent , "" ) ; PutLabel ( fp0 , gettext ( "User-Agent header" ) , user_agent_string ) ; PutTextInput ( fp0 , user_agent_string , NonNull ( LYUserAgent ) , text_len , "" ) ; } PutHeader ( fp0 , gettext ( "Listing and Accessing Files" ) ) ; PutLabel ( fp0 , gettext ( "Use Passive FTP" ) , passive_ftp_string ) ; BeginSelect ( fp0 , passive_ftp_string ) ; PutOptValues ( fp0 , ftp_passive , bool_values ) ; EndSelect ( fp0 ) ; PutLabel ( fp0 , gettext ( "FTP sort criteria" ) , ftp_sort_string ) ; BeginSelect ( fp0 , ftp_sort_string ) ; PutOptValues ( fp0 , HTfileSortMethod , ftp_sort_values ) ; EndSelect ( fp0 ) ; PutLabel ( fp0 , gettext ( "Local directory sort criteria" ) , dired_list_string ) ; BeginSelect ( fp0 , dired_list_string ) ; PutOptValues ( fp0 , dir_list_style , dired_list_values ) ; EndSelect ( fp0 ) ; PutLabel ( fp0 , gettext ( "Local directory sort order" ) , dired_sort_string ) ; BeginSelect ( fp0 , dired_sort_string ) ; PutOptValues ( fp0 , dir_list_order , dired_sort_values ) ; EndSelect ( fp0 ) ; if ( ! no_dotfiles ) { PutLabel ( fp0 , gettext ( "Show dot files" ) , show_dotfiles_string ) ; BeginSelect ( fp0 , show_dotfiles_string ) ; PutOptValues ( fp0 , show_dotfiles , bool_values ) ; EndSelect ( fp0 ) ; } PutLabel ( fp0 , gettext ( "Execution links" ) , exec_links_string ) ; BeginSelect ( fp0 , exec_links_string ) ; PutOptValues ( fp0 , local_exec ?EXEC_ALWAYS : ( local_exec_on_local_files ?EXEC_LOCAL : EXEC_NEVER ) , exec_links_values ) ; PutOptValues ( fp0 , local_exec_on_local_files ?EXEC_LOCAL : EXEC_NEVER , exec_links_values ) ; EndSelect ( fp0 ) ; PutLabel ( fp0 , gettext ( "Pause when showing message" ) , no_pause_string ) ; BeginSelect ( fp0 , no_pause_string ) ; PutOptValues ( fp0 , ! no_pause , bool_values ) ; EndSelect ( fp0 ) ; PutLabel ( fp0 , gettext ( "Show transfer rate" ) , show_rate_string ) ; BeginSelect ( fp0 , show_rate_string ) ; for ( i = 0 ; rate_values [ i ] . LongName != 0 ; ++ i ) { char * message = NULL ; HTSprintf0 ( & message , rate_values [ i ] . LongName , HTProgressUnits ( rate_values [ i ] . value ) ) ; PutOption ( fp0 , LYTransferRate == rate_values [ i ] . value , rate_values [ i ] . HtmlName , message ) ; FREE ( message ) ; } EndSelect ( fp0 ) ; PutHeader ( fp0 , gettext ( "Special Files and Screens" ) ) ; if ( ! LYMBMBlocked ) { PutLabel ( fp0 , gettext ( "Multi-bookmarks" ) , mbm_string ) ; BeginSelect ( fp0 , mbm_string ) ; PutOptValues ( fp0 , LYMultiBookmarks , mbm_values ) ; EndSelect ( fp0 ) ; } if ( LYMultiBookmarks ) { PutLabel ( fp0 , gettext ( "Review/edit Bookmarks files" ) , mbm_string ) ; fprintf ( fp0 , "<a href=\"%s\">%s</a>\n" , LYNXOPTIONS_PAGE ( MBM_LINK ) , LYEntifyTitle ( & buffer , gettext ( "Goto multi-bookmark menu" ) ) ) ; } else { PutLabel ( fp0 , gettext ( "Bookmarks file" ) , single_bookmark_string ) ; PutTextInput ( fp0 , single_bookmark_string , NonNull ( bookmark_page ) , text_len , "" ) ; } PutLabel ( fp0 , gettext ( "Auto Session" ) , auto_session_string ) ; BeginSelect ( fp0 , auto_session_string ) ; PutOptValues ( fp0 , LYAutoSession , bool_values ) ; EndSelect ( fp0 ) ; PutLabel ( fp0 , gettext ( "Session file" ) , single_session_string ) ; PutTextInput ( fp0 , single_session_string , NonNull ( LYSessionFile ) , text_len , "" ) ; PutLabel ( fp0 , gettext ( "Visited Pages" ) , visited_links_string ) ; LYMenuVisitedLinks ( fp0 , disable_all ) ; if ( ! no_lynxcfg_info ) { fprintf ( fp0 , "\n  %s<a href=\"%s\">lynx.cfg</a>.\n" , LYEntifyTitle ( & buffer , gettext ( "View the file " ) ) , STR_LYNXCFG ) ; } fprintf ( fp0 , "\n</pre>\n" ) ; if ( ! disable_all ) { fprintf ( fp0 , "<p align=center>\n" ) ; fprintf ( fp0 , "<input type=\"submit\" value=\"%s\">- \n" , LYEntifyValue ( & buffer , ACCEPT_CHANGES ) ) ; fprintf ( fp0 , "<input type=\"reset\" value=\"%s\">- \n" , LYEntifyValue ( & buffer , RESET_CHANGES ) ) ; fprintf ( fp0 , "%s\n" , LYEntifyTitle ( & buffer , CANCEL_CHANGES ) ) ; } fprintf ( fp0 , "</form>\n" ) ; EndInternalPage ( fp0 ) ; FREE ( buffer ) ; LYCloseTempFP ( fp0 ) ; return ( NORMAL ) ; } 