static int generic_pw_cmd ( u8 * key , size_t key_len , u8 * cpin_uid , struct opal_dev * dev ) { int err = 0 ; set_comid ( dev , dev -> comid ) ; add_token_u8 ( & err , dev , OPAL_CALL ) ; add_token_bytestring ( & err , dev , cpin_uid , OPAL_UID_LENGTH ) ; add_token_bytestring ( & err , dev , opalmethod [ OPAL_SET ] , OPAL_UID_LENGTH ) ; add_token_u8 ( & err , dev , OPAL_STARTLIST ) ; add_token_u8 ( & err , dev , OPAL_STARTNAME ) ; add_token_u8 ( & err , dev , OPAL_VALUES ) ; add_token_u8 ( & err , dev , OPAL_STARTLIST ) ; add_token_u8 ( & err , dev , OPAL_STARTNAME ) ; add_token_u8 ( & err , dev , 3 ) ; add_token_bytestring ( & err , dev , key , key_len ) ; add_token_u8 ( & err , dev , OPAL_ENDNAME ) ; add_token_u8 ( & err , dev , OPAL_ENDLIST ) ; add_token_u8 ( & err , dev , OPAL_ENDNAME ) ; add_token_u8 ( & err , dev , OPAL_ENDLIST ) ; return err ; } 