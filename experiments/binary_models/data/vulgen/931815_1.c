static inline bool IsHeaderLengthConsistentWithOptions ( const GeneveHeader * geneve_hdr ) { uint8_t * geneve_opt_ptr = ( uint8_t * ) geneve_hdr -> options ; int remaining_hdr_len = GENEVE_TOTAL_OPT_LEN ( geneve_hdr ) ; while ( remaining_hdr_len > 0 ) { const GeneveOption * cur_opt = ( const GeneveOption * ) geneve_opt_ptr ; const uint8_t cur_option_len = GENEVE_SINGLE_OPT_TOTAL_LEN ( cur_opt ) ; geneve_opt_ptr += cur_option_len ; } return ( remaining_hdr_len == 0 ) ; } 