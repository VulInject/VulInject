tnode_t * pcifn_declare ( topo_mod_t * mod , tnode_t * parent , di_node_t dn , topo_instance_t i ) { did_t * pd ; tnode_t * ntn ; if ( ( pd = did_find ( mod , dn ) ) == NULL ) { return ( NULL ) ; } if ( ( ntn = pci_tnode_create ( mod , parent , PCI_FUNCTION , i , dn ) ) == NULL ) { return ( NULL ) ; } if ( did_props_set ( ntn , pd , Fn_common_props , Fn_propcnt ) < 0 ) { topo_node_unbind ( ntn ) ; return ( NULL ) ; } if ( child_range_add ( mod , ntn , PCI_BUS , 0 , MAX_HB_BUSES ) < 0 ) { topo_node_unbind ( ntn ) ; return ( NULL ) ; } return ( ntn ) ; } 