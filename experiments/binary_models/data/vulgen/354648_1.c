PIX * pixDitherToBinarySpec ( PIX * pixs , l_int32 lowerclip , l_int32 upperclip ) { l_int32 w , h , d , wplt , wpld ; l_uint32 * datat , * datad ; l_uint32 * bufs1 , * bufs2 ; PIX * pixt , * pixd ; if ( ! pixs ) { return ( PIX * ) ERROR_PTR ( "pixs not defined" , __func__ , NULL ) ; } pixGetDimensions ( pixs , & w , & h , & d ) ; if ( lowerclip ( 0 || lowerclip ) 255 ) { return ( PIX * ) ERROR_PTR ( "invalid value for lowerclip" , __func__ , NULL ) ; } if ( upperclip ( 0 || upperclip ) 255 ) { return ( PIX * ) ERROR_PTR ( "invalid value for upperclip" , __func__ , NULL ) ; } if ( ( pixd = pixCreate ( w , h , 1 ) ) == NULL ) { return ( PIX * ) ERROR_PTR ( "pixd not made" , __func__ , NULL ) ; } pixCopyResolution ( pixd , pixs ) ; pixCopyInputFormat ( pixd , pixs ) ; datad = pixGetData ( pixd ) ; wpld = pixGetWpl ( pixd ) ; if ( ( pixt = pixRemoveColormap ( pixs , REMOVE_CMAP_TO_GRAYSCALE ) ) == NULL ) { pixDestroy ( & pixd ) ; return ( PIX * ) ERROR_PTR ( "pixt not made" , __func__ , NULL ) ; } datat = pixGetData ( pixt ) ; wplt = pixGetWpl ( pixt ) ; bufs1 = ( l_uint32 * ) LEPT_CALLOC ( wplt , sizeof ( l_uint32 ) ) ; bufs2 = ( l_uint32 * ) LEPT_CALLOC ( wplt , sizeof ( l_uint32 ) ) ; if ( ! bufs1 || ! bufs2 ) { LEPT_FREE ( bufs1 ) ; LEPT_FREE ( bufs2 ) ; pixDestroy ( & pixd ) ; pixDestroy ( & pixt ) ; return ( PIX * ) ERROR_PTR ( "bufs1, bufs2 not both made" , __func__ , NULL ) ; } ditherToBinaryLow ( datad , w , h , wpld , datat , wplt , bufs1 , bufs2 , lowerclip , upperclip ) ; LEPT_FREE ( bufs1 ) ; LEPT_FREE ( bufs2 ) ; pixDestroy ( & pixt ) ; return pixd ; } 