static void addf_vsl ( enum VSL_tag_e tag , long i , const char * prefix ) { struct vsl_watch * w ; ALLOC_OBJ ( w , VSL_WATCH_MAGIC ) ; AN ( w ) ; if ( VSL_tagflags [ tag ] && CTX . quote_how != VSB_QUOTE_JSON ) { VUT_Error ( vut , 1 , "Tag %s can contain control characters" , VSL_tags [ tag ] ) ; } w -> tag = tag ; assert ( i <= INT_MAX ) ; w -> idx = i ; VTAILQ_INSERT_TAIL ( & CTX . watch_vsl , w , list ) ; addf_fragment ( & w -> frag , CTX . missing_string ) ; } 