static krb5_error_code KRB5_CALLCONV any_start_seq_get ( krb5_context context , krb5_keytab id , krb5_kt_cursor * c ) { struct any_data * a = id -> data ; struct any_cursor_extra_data * ed ; krb5_error_code ret ; c -> data = malloc ( sizeof ( any_cursor_extra_data ) ) ; if ( c -> data == NULL ) { return krb5_enomem ( context ) ; } ed = ( any_cursor_extra_data * ) c -> data ; for ( ed -> a = a ; ed -> a != NULL ; ed -> a = ed -> a -> next ) { ret = krb5_kt_start_seq_get ( context , ed -> a -> kt , & ed -> cursor ) ; if ( ret == 0 ) { break ; } } if ( ed -> a == NULL ) { free ( c -> data ) ; krb5_clear_error_message ( context ) ; return KRB5_KT_END ; } return 0 ; } 