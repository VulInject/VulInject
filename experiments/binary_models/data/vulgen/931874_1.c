static struct controller * alloc_ebda_hpc ( u32 slot_count , u32 bus_count ) { struct controller * controller ; struct ebda_hpc_slot * slots ; struct ebda_hpc_bus * buses ; controller = kzalloc ( sizeof ( controller ) , GFP_KERNEL ) ; slots = kcalloc ( slot_count , sizeof ( ebda_hpc_slot ) , GFP_KERNEL ) ; if ( ! slots ) { error_contr } controller -> slots = slots ; buses = kcalloc ( bus_count , sizeof ( ebda_hpc_bus ) , GFP_KERNEL ) ; if ( ! buses ) { error_slots } controller -> buses = buses ; return controller ; error_slots kfree ( controller -> slots ) ; error_contr kfree ( controller ) ; error return NULL ; } 