static void arc_ps2_check_rx ( struct arc_ps2_data * arc_ps2 , struct arc_ps2_port * port ) { unsigned int timeout = 1000 ; unsigned int flag , status ; unsigned char data ; { status = ioread32 ( port -> status_addr ) ; if ( ! ( status & PS2_STAT_RX_VAL ) ) { return ; } data = ioread32 ( port -> data_addr ) & 0xff ; flag = 0 ; arc_ps2 -> total_int ++ ; if ( status & PS2_STAT_RX_FRM_ERR ) { arc_ps2 -> frame_error ++ ; flag |= SERIO_PARITY ; } serio_interrupt ( port -> io , data , flag ) ; } -- timeout ; dev_err ( & port -> io -> dev , "PS/2 hardware stuck\n" ) ; } 