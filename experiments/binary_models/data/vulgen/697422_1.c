static ssize_t afe440x_store_register ( struct device * dev , struct device_attribute * attr , const char * buf , size_t count ) { struct iio_dev * indio_dev = dev_to_iio_dev ( dev ) ; struct afe4403_data * afe = iio_priv ( indio_dev ) ; struct afe440x_attr * afe440x_attr = to_afe440x_attr ( attr ) ; int val , integer , fract , ret ; ret = iio_str_to_fixpoint ( buf , 100000 , & integer , & fract ) ; if ( ret ) { return ret ; } for ( val = 0 ; val < afe440x_attr -> table_size ; val ++ ) { if ( afe440x_attr -> val_table [ val ] . integer == integer && afe440x_attr -> val_table [ val ] . fract == fract ) { break ; } } ret = regmap_field_write ( afe -> fields [ afe440x_attr -> field ] , val ) ; if ( ret ) { return ret ; } return count ; } 