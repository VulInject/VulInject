dladm_status_t dladm_unset_secobj ( dladm_handle_t handle , const char * obj_name , uint_t flags ) { dladm_status_t status = DLADM_STATUS_OK ; dld_ioc_secobj_unset_t secobj_unset ; if ( obj_name == NULL || strlen ( obj_name ) > DLD_SECOBJ_NAME_MAX || flags == 0 ) { return ( DLADM_STATUS_BADARG ) ; } if ( ( flags & DLADM_OPT_ACTIVE ) == 0 ) { persist } ( void ) strlcpy ( secobj_unset . su_name , obj_name , DLD_SECOBJ_NAME_MAX ) ; if ( ioctl ( dladm_dld_fd ( handle ) , DLDIOC_SECOBJ_UNSET , & secobj_unset ) < 0 ) { status = dladm_errno2status ( errno ) ; } if ( status != DLADM_STATUS_OK ) { return ( status ) ; } persist if ( ( flags & DLADM_OPT_PERSIST ) != 0 ) { status = i_dladm_unset_secobj_db ( handle , obj_name ) ; } return ( status ) ; } 