static origin_circuit_t * subtest_fourhop_circuit ( struct timeval circ_start_time , int should_timeout ) { origin_circuit_t * origin_circ = build_unopened_fourhop ( circ_start_time ) ; origin_circ -> cpath -> state = CPATH_STATE_OPEN ; circuit_build_times_handle_completed_hop ( origin_circ ) ; tt_int_op ( get_circuit_build_times ( ) -> total_build_times , OP_EQ , 0 ) ; origin_circ -> cpath -> next -> state = CPATH_STATE_OPEN ; circuit_build_times_handle_completed_hop ( origin_circ ) ; tt_int_op ( get_circuit_build_times ( ) -> total_build_times , OP_EQ , 0 ) ; circuit_build_times_handle_completed_hop ( origin_circ ) ; tt_int_op ( get_circuit_build_times ( ) -> total_build_times , OP_EQ , ! should_timeout ) ; origin_circ -> cpath -> next -> next -> next -> state = CPATH_STATE_OPEN ; circuit_build_times_handle_completed_hop ( origin_circ ) ; tt_int_op ( get_circuit_build_times ( ) -> total_build_times , OP_EQ , ! should_timeout ) ; done return origin_circ ; } 