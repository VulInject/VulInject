static inline void cgroup2_read_pressure ( struct pressure * res ) { static procfile * ff = NULL ; if ( likely ( res -> filename ) ) { ff = procfile_reopen ( ff , res -> filename , " =" , CGROUP_PROCFILE_FLAG ) ; if ( unlikely ( ! ff ) ) { res -> updated = 0 ; cgroups_check = 1 ; return ; } ff = procfile_readall ( ff ) ; if ( unlikely ( ! ff ) ) { res -> updated = 0 ; cgroups_check = 1 ; return ; } size_t lines = procfile_lines ( ff ) ; if ( lines < 1 ) { collector_error ( "CGROUP: file '%s' should have 1+ lines." , res -> filename ) ; res -> updated = 0 ; return ; } res -> some . share_time . value10 = strtod ( procfile_lineword ( ff , 0 , 2 ) , NULL ) ; res -> some . share_time . value60 = strtod ( procfile_lineword ( ff , 0 , 4 ) , NULL ) ; res -> some . share_time . value300 = strtod ( procfile_lineword ( ff , 0 , 6 ) , NULL ) ; res -> some . total_time . value_total = str2ull ( procfile_lineword ( ff , 0 , 8 ) , NULL ) / 1000 ; res -> updated = 1 ; if ( unlikely ( res -> some . enabled == CONFIG_BOOLEAN_AUTO ) ) { res -> some . enabled = CONFIG_BOOLEAN_YES ; if ( lines > 2 ) { res -> full . enabled = CONFIG_BOOLEAN_YES ; } else { res -> full . enabled = CONFIG_BOOLEAN_NO ; } } } } 