int pr_filter_allow_path ( xaset_t * set , const char * path ) { pr_regex_t * pre ; int res ; if ( set == NULL || path == NULL ) { return - 1 ; } pre = get_param_ptr ( set , "PathAllowFilter" , FALSE ) ; if ( pre != NULL ) { res = pr_regexp_exec ( pre , path , 0 , NULL , 0 , 0 , 0 ) ; if ( res != 0 ) { return PR_FILTER_ERR_FAILS_ALLOW_FILTER ; } pr_trace_msg ( trace_channel , 8 , "'%s' allowed by PathAllowFilter '%s'" , path , pr_regexp_get_pattern ( pre ) ) ; } pre = get_param_ptr ( set , "PathDenyFilter" , FALSE ) ; if ( pre != NULL ) { res = pr_regexp_exec ( pre , path , 0 , NULL , 0 , 0 , 0 ) ; if ( res == 0 ) { return PR_FILTER_ERR_FAILS_DENY_FILTER ; } pr_trace_msg ( trace_channel , 8 , "'%s' allowed by PathDenyFilter '%s'" , path , pr_regexp_get_pattern ( pre ) ) ; } return 0 ; return 0 ; } 