static bool ipf_purge_list_check ( ipf * ipf , ipf_list * ipf_list , long long now ) OVS_REQUIRES ( ipf -> ipf_lock ) ( { IPF_FRAG_LIST_PURGE_TIME_ADJ = 10000 } , ( now < ipf_list -> expiration + IPF_FRAG_LIST_PURGE_TIME_ADJ ) { return false ; } while ( ipf_list -> last_sent_idx < ipf_list -> last_inuse_idx ) { dp_packet * pkt = ipf_list -> frag_list [ ipf_list -> last_sent_idx ] . pkt dp_packet_delete ( pkt ) atomic_count_dec ( & ipf -> nfrag ) COVERAGE_INC ( ipf_stuck_frag_list_purged ) ipf_count ( ipf , ipf_list -> key . dl_type == htons ( ETH_TYPE_IPV6 ) , IPF_NFRAGS_PURGED ) ipf_list -> last_sent_idx ++ } ; ) ; return true ; 