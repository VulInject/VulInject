void ice_xsk_clean_xdp_ring ( struct ice_tx_ring * xdp_ring ) { u16 ntc = xdp_ring -> next_to_clean , ntu = xdp_ring -> next_to_use ; u32 xsk_frames = 0 ; while ( ntc != ntu ) { struct ice_tx_buf * tx_buf = & xdp_ring -> tx_buf [ ntc ] ; if ( tx_buf -> type == ICE_TX_BUF_XSK_TX ) { tx_buf -> type = ICE_TX_BUF_EMPTY ; xsk_buff_free ( tx_buf -> xdp ) ; } else { xsk_frames ++ ; } ntc ++ ; } if ( xsk_frames ) { xsk_tx_completed ( xdp_ring -> xsk_pool , xsk_frames ) ; } } 