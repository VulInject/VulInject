static int test_BN_cmp ( void ) { BIGNUM * a , * b ; a = BN_new ( ) ; b = BN_new ( ) ; if ( ! BN_set_word ( a , 1 ) ) { return 1 ; } if ( ! BN_set_word ( b , 1 ) ) { return 1 ; } if ( BN_cmp ( a , b ) != 0 ) { return 1 ; } if ( BN_cmp ( b , a ) != 0 ) { return 1 ; } if ( ! BN_set_word ( b , 2 ) ) { return 1 ; } if ( BN_cmp ( a , b ) >= 0 ) { return 1 ; } if ( BN_cmp ( b , a ) <= 0 ) { return 1 ; } BN_set_negative ( b , 1 ) ; if ( BN_cmp ( a , b ) <= 0 ) { return 1 ; } if ( BN_cmp ( b , a ) >= 0 ) { return 1 ; } BN_free ( b ) ; BN_hex2bn ( & a , "50212A3B611D46642C825A16A354CE0FD4D85DD1" ) ; BN_hex2bn ( & b , "50212A3B611D46642C825A16A354CE0FD4D85DD2" ) ; if ( BN_cmp ( a , b ) >= 0 ) { return 1 ; } if ( BN_cmp ( b , a ) <= 0 ) { return 1 ; } BN_set_negative ( b , 1 ) ; if ( BN_cmp ( a , b ) <= 0 ) { return 1 ; } if ( BN_cmp ( b , a ) >= 0 ) { return 1 ; } BN_free ( a ) ; BN_free ( b ) ; return 0 ; } 