void v4l2_m2m_job_finish ( struct v4l2_m2m_dev * m2m_dev , struct v4l2_m2m_ctx * m2m_ctx ) { unsigned long flags ; bool schedule_next ; WARN_ON ( m2m_ctx -> out_q_ctx . q . subsystem_flags & VB2_V4L2_FL_SUPPORTS_M2M_HOLD_CAPTURE_BUF ) ; spin_lock_irqsave ( & m2m_dev -> job_spinlock , flags ) ; schedule_next = _v4l2_m2m_job_finish ( m2m_dev , m2m_ctx ) ; spin_unlock_irqrestore ( & m2m_dev -> job_spinlock , flags ) ; } 