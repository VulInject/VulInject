static int __init fsl_mc_bus_driver_init ( void ) { int error ; error = bus_register ( & fsl_mc_bus_type ) ; if ( error < 0 ) { pr_err ( "bus type registration failed: %d\n" , error ) ; error_cleanup_cache } error = platform_driver_register ( & fsl_mc_bus_driver ) ; if ( error < 0 ) { pr_err ( "platform_driver_register() failed: %d\n" , error ) ; error_cleanup_bus } error = dprc_driver_init ( ) ; if ( error < 0 ) { error_cleanup_driver } error = fsl_mc_allocator_driver_init ( ) ; if ( error < 0 ) { error_cleanup_dprc_driver } error = its_fsl_mc_msi_init ( ) ; return 0 ; error_cleanup_mc_allocator fsl_mc_allocator_driver_exit ( ) ; error_cleanup_dprc_driver dprc_driver_exit ( ) ; error_cleanup_driver platform_driver_unregister ( & fsl_mc_bus_driver ) ; error_cleanup_bus bus_unregister ( & fsl_mc_bus_type ) ; error_cleanup_cache return error ; } 