static int __init sp5100_tco_init_module ( void ) { int err ; pr_info ( "SP5100/SB800 TCO WatchDog Timer Driver v%s\n" , TCO_VERSION ) ; err = platform_driver_register ( & sp5100_tco_driver ) ; sp5100_tco_platform_device = platform_device_register_simple ( TCO_MODULE_NAME , - 1 , NULL , 0 ) ; if ( IS_ERR ( sp5100_tco_platform_device ) ) { err = PTR_ERR ( sp5100_tco_platform_device ) ; unreg_platform_driver } return 0 ; unreg_platform_driver platform_driver_unregister ( & sp5100_tco_driver ) ; return err ; } 