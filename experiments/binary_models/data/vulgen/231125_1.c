extern void admin_edit_resv ( GtkCellRendererText * cell , const char * path_string , const char * new_text , gpointer data ) { GtkTreeStore * treestore = NULL ; GtkTreePath * path = NULL ; GtkTreeIter iter ; resv_desc_msg_t * resv_msg = NULL ; char * temp = NULL ; char * old_text = NULL ; const char * type = NULL ; int column ; if ( ! new_text || ! xstrcmp ( new_text , "" ) ) { no_input } if ( cluster_flags & CLUSTER_FLAG_FED ) { display_fed_disabled_popup ( type ) ; no_input } column = GPOINTER_TO_INT ( g_object_get_data ( G_OBJECT ( cell ) , "column" ) ) ; path = gtk_tree_path_new_from_string ( path_string ) ; treestore = GTK_TREE_STORE ( data ) ; gtk_tree_model_get_iter ( GTK_TREE_MODEL ( treestore ) , & iter , path ) ; gtk_tree_model_get ( GTK_TREE_MODEL ( treestore ) , & iter , SORTID_NAME , & temp , column , & old_text , - 1 ) ; resv_msg = xmalloc ( sizeof ( resv_desc_msg_t ) ) ; slurm_init_resv_desc_msg ( resv_msg ) ; resv_msg -> name = xstrdup ( temp ) ; g_free ( temp ) ; type = _set_resv_msg ( resv_msg , new_text , column ) ; if ( global_edit_error ) { print_error } if ( got_edit_signal ) { temp = got_edit_signal ; got_edit_signal = NULL ; _admin_resv ( GTK_TREE_MODEL ( treestore ) , & iter , temp ) ; no_input } if ( old_text && ! xstrcmp ( old_text , new_text ) ) { temp = g_strdup_printf ( "No change in value." ) ; } if ( slurm_update_reservation ( resv_msg ) == SLURM_SUCCESS ) { gtk_tree_store_set ( treestore , & iter , column , new_text , - 1 ) ; temp = g_strdup_printf ( "Reservation %s %s changed to %s" , resv_msg -> name , type , new_text ) ; } if ( errno == ESLURM_DISABLED ) { temp = g_strdup_printf ( "Can only edit %s on reservations not yet started." , type ) ; } else { print_error temp = g_strdup_printf ( "Reservation %s %s can't be " "set to %s" , resv_msg -> name , type , new_text ) ; } display_edit_note ( temp ) ; g_free ( temp ) ; no_input slurm_free_resv_desc_msg ( resv_msg ) ; gtk_tree_path_free ( path ) ; g_free ( old_text ) ; g_mutex_unlock ( sview_mutex ) ; } 