static void mmc_omap_xfer_data ( struct mmc_omap_host * host , int write ) { int n , nwords ; if ( host -> buffer_bytes_left == 0 ) { host -> sg_idx ++ ; BUG_ON ( host -> sg_idx == host -> sg_len ) ; mmc_omap_sg_to_buf ( host ) ; } n = 64 ; if ( n > host -> buffer_bytes_left ) { n = host -> buffer_bytes_left ; } host -> buffer_bytes_left -= n ; host -> total_bytes_left -= n ; host -> data -> bytes_xfered += n ; if ( write ) { __raw_writesw ( host -> virt_base + OMAP_MMC_REG ( host , DATA ) , host -> buffer , nwords ) ; } else { __raw_readsw ( host -> virt_base + OMAP_MMC_REG ( host , DATA ) , host -> buffer , nwords ) ; } host -> buffer += nwords ; } 