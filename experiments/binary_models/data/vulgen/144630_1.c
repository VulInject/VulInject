static acpi_status sar_get_device_mode ( struct platform_device * device ) { struct wwan_sar_context * context = dev_get_drvdata ( & device -> dev ) ; acpi_status status = AE_OK ; union acpi_object * out ; u32 rev ; out = acpi_evaluate_dsm_typed ( context -> handle , & context -> guid , rev , COMMAND_ID_DEV_MODE , NULL , ACPI_TYPE_INTEGER ) ; if ( ! out ) { dev_err ( & device -> dev , "DSM cmd:%d Failed to retrieve value\n" , COMMAND_ID_DEV_MODE ) ; status = AE_ERROR ; dev_mode_error } context -> sar_data . device_mode = out -> integer . value ; update_sar_data ( context ) ; sysfs_notify ( & device -> dev . kobj , NULL , SYSFS_DATANAME ) ; dev_mode_error ACPI_FREE ( out ) ; return status ; } 