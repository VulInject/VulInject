static const struct bpf_func_proto * bpf_tracing_func_proto ( enum bpf_func_id func_id , const struct bpf_prog * prog ) { switch ( func_id ) { case BPF_FUNC_map_lookup_elem : return & bpf_map_lookup_elem_proto ; case BPF_FUNC_map_update_elem : return & bpf_map_update_elem_proto ; case BPF_FUNC_map_delete_elem : return & bpf_map_delete_elem_proto ; case BPF_FUNC_map_push_elem : return & bpf_map_push_elem_proto ; case BPF_FUNC_map_pop_elem : return & bpf_map_pop_elem_proto ; case BPF_FUNC_map_peek_elem : return & bpf_map_peek_elem_proto ; case BPF_FUNC_map_lookup_percpu_elem : return & bpf_map_lookup_percpu_elem_proto ; case BPF_FUNC_ktime_get_ns : return & bpf_ktime_get_ns_proto ; case BPF_FUNC_ktime_get_boot_ns : return & bpf_ktime_get_boot_ns_proto ; case BPF_FUNC_tail_call : return & bpf_tail_call_proto ; case BPF_FUNC_get_current_pid_tgid : return & bpf_get_current_pid_tgid_proto ; case BPF_FUNC_get_current_task : return & bpf_get_current_task_proto ; case BPF_FUNC_get_current_task_btf : return & bpf_get_current_task_btf_proto ; case BPF_FUNC_task_pt_regs : return & bpf_task_pt_regs_proto ; case BPF_FUNC_get_current_uid_gid : return & bpf_get_current_uid_gid_proto ; case BPF_FUNC_get_current_comm : return & bpf_get_current_comm_proto ; case BPF_FUNC_trace_printk : return bpf_get_trace_printk_proto ( ) ; case BPF_FUNC_get_smp_processor_id : return & bpf_get_smp_processor_id_proto ; case BPF_FUNC_get_numa_node_id : return & bpf_get_numa_node_id_proto ; case BPF_FUNC_perf_event_read : return & bpf_perf_event_read_proto ; case BPF_FUNC_current_task_under_cgroup : return & bpf_current_task_under_cgroup_proto ; case BPF_FUNC_get_prandom_u32 : return & bpf_get_prandom_u32_proto ; case BPF_FUNC_probe_write_user : return security_locked_down ( LOCKDOWN_BPF_WRITE_USER ) < 0 ?NULL : bpf_get_probe_write_proto ( ) ; case BPF_FUNC_probe_read_user : return & bpf_probe_read_user_proto ; case BPF_FUNC_probe_read_kernel : return security_locked_down ( LOCKDOWN_BPF_READ_KERNEL ) < 0 ?NULL : & bpf_probe_read_kernel_proto ; case BPF_FUNC_probe_read_user_str : return & bpf_probe_read_user_str_proto ; case BPF_FUNC_probe_read_kernel_str : return security_locked_down ( LOCKDOWN_BPF_READ_KERNEL ) < 0 ?NULL : & bpf_probe_read_kernel_str_proto ; case BPF_FUNC_probe_read : return security_locked_down ( LOCKDOWN_BPF_READ_KERNEL ) < 0 ?NULL : & bpf_probe_read_compat_proto ; case BPF_FUNC_probe_read_str : return security_locked_down ( LOCKDOWN_BPF_READ_KERNEL ) < 0 ?NULL : & bpf_probe_read_compat_str_proto ; case BPF_FUNC_get_current_cgroup_id : return & bpf_get_current_cgroup_id_proto ; case BPF_FUNC_get_current_ancestor_cgroup_id : return & bpf_get_current_ancestor_cgroup_id_proto ; case BPF_FUNC_cgrp_storage_get : return & bpf_cgrp_storage_get_proto ; case BPF_FUNC_cgrp_storage_delete : return & bpf_cgrp_storage_delete_proto ; case BPF_FUNC_send_signal : return & bpf_send_signal_proto ; case BPF_FUNC_send_signal_thread : return & bpf_send_signal_thread_proto ; case BPF_FUNC_perf_event_read_value : return & bpf_perf_event_read_value_proto ; case BPF_FUNC_get_ns_current_pid_tgid : return & bpf_get_ns_current_pid_tgid_proto ; case BPF_FUNC_ringbuf_output : return & bpf_ringbuf_output_proto ; case BPF_FUNC_ringbuf_reserve : return & bpf_ringbuf_reserve_proto ; case BPF_FUNC_ringbuf_submit : return & bpf_ringbuf_submit_proto ; case BPF_FUNC_ringbuf_discard : return & bpf_ringbuf_discard_proto ; case BPF_FUNC_ringbuf_query : return & bpf_ringbuf_query_proto ; case BPF_FUNC_jiffies64 : return & bpf_jiffies64_proto ; case BPF_FUNC_get_task_stack : return & bpf_get_task_stack_proto ; case BPF_FUNC_copy_from_user : return & bpf_copy_from_user_proto ; case BPF_FUNC_copy_from_user_task : return & bpf_copy_from_user_task_proto ; case BPF_FUNC_snprintf_btf : return & bpf_snprintf_btf_proto ; case BPF_FUNC_per_cpu_ptr : return & bpf_per_cpu_ptr_proto ; case BPF_FUNC_this_cpu_ptr : return & bpf_this_cpu_ptr_proto ; case BPF_FUNC_task_storage_get : return & bpf_task_storage_get_proto ; case BPF_FUNC_task_storage_delete : if ( bpf_prog_check_recur ( prog ) ) { return & bpf_task_storage_delete_recur_proto ; } return & bpf_task_storage_delete_proto ; case BPF_FUNC_for_each_map_elem : return & bpf_for_each_map_elem_proto ; case BPF_FUNC_snprintf : return & bpf_snprintf_proto ; case BPF_FUNC_get_func_ip : return & bpf_get_func_ip_proto_tracing ; case BPF_FUNC_get_branch_snapshot : return & bpf_get_branch_snapshot_proto ; case BPF_FUNC_find_vma : return & bpf_find_vma_proto ; case BPF_FUNC_trace_vprintk : return bpf_get_trace_vprintk_proto ( ) ; default : return bpf_base_func_proto ( func_id ) ; } } 