void dpp1_set_cursor_position ( struct dpp * dpp_base , const struct dc_cursor_position * pos , const struct dc_cursor_mi_param * param , uint32_t width , uint32_t height ) { struct dcn10_dpp * dpp = TO_DCN10_DPP ( dpp_base ) ; int x_pos = pos -> x - param -> viewport . x ; int y_pos = pos -> y - param -> viewport . y ; int x_hotspot = pos -> x_hotspot ; int y_hotspot = pos -> y_hotspot ; int src_x_offset = x_pos - pos -> x_hotspot ; int src_y_offset = y_pos - pos -> y_hotspot ; int cursor_height = ( int ) height ; int cursor_width = ( int ) width ; uint32_t cur_en = pos -> enable ?1 : 0 ; if ( param -> rotation == ROTATION_ANGLE_90 || param -> rotation == ROTATION_ANGLE_270 ) { swap ( cursor_height , cursor_width ) ; swap ( x_hotspot , y_hotspot ) ; if ( param -> rotation == ROTATION_ANGLE_90 ) { src_x_offset = x_pos - ( cursor_width - x_hotspot ) ; src_y_offset = y_pos - y_hotspot ; } if ( param -> rotation == ROTATION_ANGLE_270 ) { src_x_offset = x_pos - x_hotspot ; src_y_offset = y_pos - ( cursor_height - y_hotspot ) ; } } if ( src_x_offset >= ( int ) param -> viewport . width ) { cur_en = 0 ; } if ( src_x_offset + cursor_width <= 0 ) { cur_en = 0 ; } if ( src_y_offset >= ( int ) param -> viewport . height ) { cur_en = 0 ; } if ( src_y_offset + cursor_height <= 0 ) { cur_en = 0 ; } REG_UPDATE ( CURSOR0_CONTROL , CUR0_ENABLE , cur_en ) ; dpp_base -> pos . cur0_ctl . bits . cur0_enable = cur_en ; } 