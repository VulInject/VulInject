static void pmcs_kill_port ( pmcs_hw_t * pwp , int portid ) { pmcs_phy_t * pptr = pwp -> ports [ portid ] ; mutex_enter ( & pwp -> lock ) ; for ( pptr = pwp -> root_phys ; pptr ; pptr = pptr -> sibling ) { pmcs_lock_phy ( pptr ) ; if ( pptr -> link_rate && pptr -> portid == portid && pptr -> subsidiary ) { pmcs_clear_phy ( pwp , pptr ) ; } pmcs_unlock_phy ( pptr ) ; } pptr = pwp -> ports [ portid ] ; pwp -> ports [ portid ] = NULL ; mutex_exit ( & pwp -> lock ) ; pmcs_lock_phy ( pptr ) ; pmcs_kill_changed ( pwp , pptr , 0 ) ; pmcs_unlock_phy ( pptr ) ; RESTART_DISCOVERY ( pwp ) ; pmcs_prt ( pwp , PMCS_PRT_INFO , NULL , NULL , "PortID 0x%x Cleared" , portid ) ; } 