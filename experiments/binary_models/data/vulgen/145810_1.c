module_param ( use_dma , bool , 0644 ) ; MODULE_PARM_DESC ( use_dma , "Using DMA engine to measure performance" ) ; perf_mw { phys_addr_t phys_addr ; resource_size_t phys_size ; resource_size_t xlat_align ; resource_size_t xlat_align_size ; void __iomem * vbase ; size_t xlat_size ; size_t buf_size ; void * virt_addr ; dma_addr_t dma_addr ; } perf_ctx pthr_ctx { struct task_struct * thread ; struct perf_ctx * perf ; atomic_t dma_sync ; struct dma_chan * dma_chan ; int dma_prep_err ; int src_idx ; void * srcs [ MAX_SRCS ] ; wait_queue_head_t * wq ; int status ; u64 copied ; u64 diff_us ; } perf_ctx { struct ntb_dev * ntb ; spinlock_t db_lock ; struct perf_mw mw ; bool link_is_up ; struct delayed_work link_work ; wait_queue_head_t link_wq ; struct dentry * debugfs_node_dir ; struct dentry * debugfs_run ; struct dentry * debugfs_threads ; u8 perf_threads ; struct pthr_ctx pthr_ctx [ MAX_THREADS ] ; atomic_t tsync ; atomic_t tdone ; } 