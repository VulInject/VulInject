static lwres_result_t lwres_conf_parsedomain ( lwres_conf_t * confdata , FILE * fp ) { char word [ LWRES_CONFMAXLINELEN ] ; int res , i ; res = getword ( fp , word , sizeof ( word ) ) ; if ( strlen ( word ) == 0U ) { return ( LWRES_R_FAILURE ) ; } if ( res == ' ' || res == '\t' ) { res = eatwhite ( fp ) ; } if ( res != EOF && res != '\n' ) { return ( LWRES_R_FAILURE ) ; } for ( i = 0 ; i < LWRES_CONFMAXSEARCH ; i ++ ) { free ( confdata -> search [ i ] ) ; confdata -> search [ i ] = NULL ; } confdata -> searchnxt = 0 ; confdata -> domainname = strdup ( word ) ; if ( confdata -> domainname == NULL ) { return ( LWRES_R_FAILURE ) ; } return ( LWRES_R_SUCCESS ) ; } 