int bzrtp_iterate ( bzrtpContext_t * zrtpContext , uint32_t selfSSRC , uint64_t timeReference ) { bzrtpChannelContext_t * zrtpChannelContext = getChannelContext ( zrtpContext , selfSSRC ) ; if ( zrtpChannelContext == NULL ) { return BZRTP_ERROR_INVALIDCONTEXT ; } zrtpContext -> timeReference = timeReference ; if ( zrtpChannelContext -> timer . status == BZRTP_TIMER_ON ) { if ( zrtpChannelContext -> timer . firingTime <= timeReference ) { bzrtpEvent_t timerEvent ; zrtpChannelContext -> timer . firingCount ++ ; timerEvent . eventType = BZRTP_EVENT_TIMER ; timerEvent . bzrtpPacketString = NULL ; timerEvent . bzrtpPacketStringLength = 0 ; timerEvent . bzrtpPacket = NULL ; timerEvent . zrtpContext = zrtpContext ; timerEvent . zrtpChannelContext = zrtpChannelContext ; } } return 0 ; } 