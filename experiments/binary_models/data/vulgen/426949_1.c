ssize_t ft232r_write_all ( struct ft232r_device_handle * const dev , const void * const data_p , size_t count ) { const uint8_t * data = data_p ; if ( dev -> mpsse ) { ssize_t e ; while ( count > 0x10000 ) { e = ft232r_write_all ( dev , data , 0x10000 ) ; if ( e != 0x10000 ) { return e ; } data += 0x10000 ; count -= 0x10000 ; } const uint16_t ftdilen = count - 1 ; const uint8_t cmd [ ] { 0x11 ftdilen & 0xff ftdilen >> 8 } ; ; e = ft232r_rw_all ( ft232r_write , dev , ( void * ) cmd , 3 ) ; } return ft232r_rw_all ( ft232r_write , dev , ( void * ) data , count ) + ( data - ( uint8_t * ) data_p ) ; } 