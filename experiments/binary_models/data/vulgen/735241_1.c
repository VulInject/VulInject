static void make_reference_headers ( struct EmailList * el , struct Envelope * env , struct ConfigSubset * sub ) { if ( ! el || ! env || STAILQ_EMPTY ( el ) ) { return ; } struct EmailNode * en = STAILQ_FIRST ( el ) ; bool single = ! STAILQ_NEXT ( en , entries ) ; if ( ! single ) { STAILQ_FOREACH ( , , ) { mutt_add_to_reference_headers ( env , en -> email -> env , sub ) ; } } else { mutt_add_to_reference_headers ( env , en -> email -> env , sub ) ; } if ( ! single && ! STAILQ_EMPTY ( & env -> in_reply_to ) && STAILQ_NEXT ( STAILQ_FIRST ( & env -> in_reply_to ) , entries ) ) { mutt_list_free ( 0 ) ; } } 