static int __init f71882fg_device_add ( int address , const struct f71882fg_sio_data * sio_data ) { struct resource res = { . start = address . end = address + REGION_LENGTH - 1 . flags = IORESOURCE_IO } ; int err ; f71882fg_pdev = platform_device_alloc ( DRVNAME , address ) ; if ( ! f71882fg_pdev ) { return - ENOMEM ; } res . name = f71882fg_pdev -> name ; err = acpi_check_resource_conflict ( & res ) ; if ( err ) { exit_device_put } err = platform_device_add_resources ( f71882fg_pdev , & res , 1 ) ; if ( err ) { pr_err ( "Device resource addition failed\n" ) ; exit_device_put } err = platform_device_add_data ( f71882fg_pdev , sio_data , sizeof ( f71882fg_sio_data ) ) ; if ( err ) { pr_err ( "Platform data allocation failed\n" ) ; exit_device_put } err = platform_device_add ( f71882fg_pdev ) ; if ( err ) { pr_err ( "Device addition failed\n" ) ; exit_device_put } return 0 ; exit_device_put return err ; } 