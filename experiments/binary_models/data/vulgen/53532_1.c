static int StartMonitorCRL ( WOLFSSL_CRL * crl ) { int ret = WOLFSSL_SUCCESS ; WOLFSSL_ENTER ( "StartMonitorCRL" ) ; if ( crl == NULL ) { return BAD_FUNC_ARG ; } if ( crl -> tid != 0 ) { WOLFSSL_MSG ( "Monitor thread already running" ) ; return ret ; } if ( pthread_create ( & crl -> tid , NULL , DoMonitor , crl ) != 0 ) { WOLFSSL_MSG ( "Thread creation error" ) ; return THREAD_CREATE_E ; } if ( wc_LockMutex ( & crl -> crlLock ) != 0 ) { WOLFSSL_MSG ( "wc_LockMutex crlLock error" ) ; return BAD_MUTEX_E ; } while ( crl -> setup == 0 ) { if ( pthread_cond_wait ( & crl -> cond , & crl -> crlLock ) != 0 ) { ret = BAD_COND_E ; break ; } } if ( crl -> setup < 0 ) { ret = crl -> setup ; } wc_UnLockMutex ( & crl -> crlLock ) ; return ret ; } 