int fbtft_write_gpio8_wr ( struct fbtft_par * par , void * buf , size_t len ) { u8 data ; int i ; static u8 prev_data ; fbtft_par_dbg_hex ( DEBUG_WRITE , par , par -> info -> device , u8 , buf , len , "%s(len=%zu): " , __func__ , len ) ; while ( len -- ) { data = * ( u8 * ) buf ; gpiod_set_value ( par -> gpio . wr , 1 ) ; else { for ( i = 0 ; i < 8 ; i ++ ) { if ( ( data & 1 ) != ( prev_data & 1 ) ) { gpiod_set_value ( par -> gpio . db [ i ] , data & 1 ) ; } data >>= 1 ; prev_data >>= 1 ; } } for ( i = 0 ; i < 8 ; i ++ ) { gpiod_set_value ( par -> gpio . db [ i ] , data & 1 ) ; data >>= 1 ; } gpiod_set_value ( par -> gpio . wr , 0 ) ; prev_data = * ( u8 * ) buf ; buf ++ ; } return 0 ; } 