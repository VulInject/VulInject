static void settzname ( void ) { struct state * const sp = lclptr ; int i ; tzname [ 0 ] = wildabbr ; tzname [ 1 ] = wildabbr ; daylight = 0 ; timezone = 0 ; if ( sp == NULL ) { tzname [ 0 ] = tzname [ 1 ] = ( char * ) gmt ; return ; } for ( i = 0 ; i < sp -> timecnt ; ++ i ) { const struct ttinfo * ttisp = & sp -> ttis [ sp -> types [ i ] ] ; tzname [ ttisp -> tt_isdst ] = & sp -> chars [ ttisp -> tt_abbrind ] ; if ( ttisp -> tt_isdst ) { daylight = 1 ; } if ( ! ttisp -> tt_isdst ) { timezone = - ( ttisp -> tt_gmtoff ) ; } } for ( i = 0 ; i < sp -> charcnt ; ++ i ) { if ( strchr ( TZ_ABBR_CHAR_SET , sp -> chars [ i ] ) == NULL ) { sp -> chars [ i ] = TZ_ABBR_ERR_CHAR ; } } for ( i = 0 ; i < sp -> typecnt ; ++ i ) { const struct ttinfo * ttisp = & sp -> ttis [ i ] ; char * cp = & sp -> chars [ ttisp -> tt_abbrind ] ; } } 