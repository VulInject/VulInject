struct sio_hdl * sio_open ( const char * str , unsigned int mode , int nbio ) { static char devany [ ] SIO_DEVANY ; ; struct sio_hdl * hdl ; _sndio_debug_init ( ) ; if ( ( mode & ( SIO_PLAY | SIO_REC ) ) == 0 ) { return NULL ; } if ( str == NULL ) { str = devany ; } if ( strcmp ( str , devany ) == 0 && ! issetugid ( ) ) { if ( ( mode & SIO_REC ) == 0 ) { str = getenv ( "AUDIOPLAYDEVICE" ) ; } if ( mode == ( SIO_PLAY | SIO_REC ) || str == NULL ) { str = getenv ( "AUDIODEVICE" ) ; } if ( str == NULL ) { str = devany ; } } if ( strcmp ( str , devany ) == 0 ) { hdl = _sio_aucat_open ( "snd/default" , mode , nbio ) ; if ( hdl != NULL ) { return hdl ; } return _sio_sun_open ( "rsnd/0" , mode , nbio ) ; } if ( _sndio_parsetype ( str , "snd" ) ) { return _sio_aucat_open ( str , mode , nbio ) ; } if ( _sndio_parsetype ( str , "rsnd" ) ) { return _sio_sun_open ( str , mode , nbio ) ; } DPRINTF ( "sio_open: %s: unknown device type\n" , str ) ; return NULL ; } 