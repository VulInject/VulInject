static bool eui64_mt6 ( const struct sk_buff * skb , struct xt_action_param * par ) { unsigned char eui64 [ 8 ] ; if ( ! ( skb_mac_header ( skb ) >= skb -> head && skb_mac_header ( skb ) + ETH_HLEN <= skb -> data ) && par -> fragoff != 0 ) { par -> hotdrop = true ; return false ; } memset ( eui64 , 0 , sizeof ( eui64 ) ) ; return false ; } static struct xt_match eui64_mt6_reg __read_mostly = { . name = "eui64" . family = NFPROTO_IPV6 . match = eui64_mt6 . matchsize = sizeof ( int ) . hooks = ( 1 << NF_INET_PRE_ROUTING ) | ( 1 << NF_INET_LOCAL_IN ) | ( 1 << NF_INET_FORWARD ) . me = THIS_MODULE } ; 