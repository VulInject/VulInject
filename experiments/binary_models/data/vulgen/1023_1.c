void __kprobes arch_optimize_kprobes ( struct list_head * oplist ) { struct optimized_kprobe * op , * tmp ; list_for_each_entry_safe ( , , , ) { unsigned long insn ; WARN_ON ( kprobe_disabled ( & op -> kp ) ) ; memcpy ( op -> optinsn . copied_insn , op -> kp . addr , RELATIVEJUMP_SIZE ) ; insn = arm_gen_branch ( ( unsigned long ) op -> kp . addr , ( unsigned long ) op -> optinsn . insn ) ; BUG_ON ( insn == 0 ) ; insn = ( __mem_to_opcode_arm ( op -> optinsn . copied_insn [ 0 ] ) & 0xf0000000 ) | ( insn & 0x0fffffff ) ; kprobes_remove_breakpoint ( op -> kp . addr , insn ) ; } } 