size_t jam_protoport ( struct jambuf * buf , const ip_protoport * protoport ) { if ( protoport == NULL ) { return jam ( buf , "<null-protoport>" ) ; } if ( ! protoport -> is_set ) { return jam ( buf , "<unset-protoport>" ) ; } if ( protoport -> ipproto == 0 ) { pexpect ( protoport -> has_port_wildcard == false ) ; pexpect ( protoport -> hport == 0 ) ; return jam_string ( buf , "%any" ) ; } size_t s = 0 ; if ( protoport -> has_port_wildcard ) { pexpect ( protoport -> hport == 0 ) ; s += jam_string ( buf , "%any" ) ; } else { s += jam ( buf , "%u" , protoport -> hport ) ; } return s ; } 