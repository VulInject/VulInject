static int reply_pkt_is_ack ( struct notify_zone * zone , buffer_type * packet , int index ) { if ( ( OPCODE ( packet ) != OPCODE_NOTIFY ) || ( QR ( packet ) == 0 ) ) { log_msg ( LOG_ERR , "xfrd: zone %s: received bad notify reply opcode/flags from %s" , zone -> apex_str , zone -> pkts [ index ] . dest -> ip_address_spec ) ; return 0 ; } if ( ID ( packet ) != zone -> pkts [ index ] . notify_query_id ) { log_msg ( LOG_ERR , "xfrd: zone %s: received notify-ack with bad ID from %s" , zone -> apex_str , zone -> pkts [ index ] . dest -> ip_address_spec ) ; return 0 ; } if ( RCODE ( packet ) != RCODE_OK ) { log_msg ( LOG_ERR , "xfrd: zone %s: received notify response error %s from %s" , zone -> apex_str , rcode2str ( RCODE ( packet ) ) , zone -> pkts [ index ] . dest -> ip_address_spec ) ; return 0 ; } DEBUG ( DEBUG_XFRD , 1 , ( LOG_INFO , "xfrd: zone %s: host %s acknowledges notify" , zone -> apex_str , zone -> pkts [ index ] . dest -> ip_address_spec ) ) ; return 1 ; } 