FT_CALLBACK_DEF ( ) ft_bitmap_glyph_init ( , ) { FT_BitmapGlyph glyph = ( FT_BitmapGlyph ) bitmap_glyph ; FT_Error error = FT_Err_Ok ; FT_Library library = FT_GLYPH ( glyph ) -> library ; if ( slot -> format != FT_GLYPH_FORMAT_BITMAP ) { Exit } glyph -> left = slot -> bitmap_left ; glyph -> top = slot -> bitmap_top ; if ( slot -> internal -> flags & FT_GLYPH_OWN_BITMAP ) { glyph -> bitmap = slot -> bitmap ; slot -> internal -> flags &= ~ FT_GLYPH_OWN_BITMAP ; } else { FT_Bitmap_Init ( & glyph -> bitmap ) ; error = FT_Bitmap_Copy ( library , & slot -> bitmap , & glyph -> bitmap ) ; } Exit return error ; } FT_CALLBACK_DEF ( ) ft_bitmap_glyph_copy ( , ) { FT_Library library = bitmap_source -> library ; FT_BitmapGlyph source = ( FT_BitmapGlyph ) bitmap_source ; FT_BitmapGlyph target = ( FT_BitmapGlyph ) bitmap_target ; target -> left = source -> left ; target -> top = source -> top ; return FT_Bitmap_Copy ( library , & source -> bitmap , & target -> bitmap ) ; } FT_CALLBACK_DEF ( ) ft_bitmap_glyph_done ( ) { FT_BitmapGlyph glyph = ( FT_BitmapGlyph ) bitmap_glyph ; FT_Library library = FT_GLYPH ( glyph ) -> library ; FT_Bitmap_Done ( library , & glyph -> bitmap ) ; } FT_CALLBACK_DEF ( ) ft_bitmap_glyph_bbox ( , ) { FT_BitmapGlyph glyph = ( FT_BitmapGlyph ) bitmap_glyph ; cbox -> xMin = glyph -> left * 64 ; cbox -> xMax = cbox -> xMin + ( FT_Pos ) ( glyph -> bitmap . width * 64 ) ; cbox -> yMax = glyph -> top * 64 ; cbox -> yMin = cbox -> yMax - ( FT_Pos ) ( glyph -> bitmap . rows * 64 ) ; } 