authority_cert_t * authority_cert_get_by_sk_digest ( const char * sk_digest ) { authority_cert_t * c ; if ( ( c = get_my_v3_authority_cert ( ) ) && tor_memeq ( c -> signing_key_digest , sk_digest , DIGEST_LEN ) ) { return c ; } if ( ( c = get_my_v3_legacy_cert ( ) ) && tor_memeq ( c -> signing_key_digest , sk_digest , DIGEST_LEN ) ) { return c ; } DIGESTMAP_FOREACH ( , , , ) { SMARTLIST_FOREACH ( , , , ) } DIGESTMAP_FOREACH_END ; return NULL ; } 