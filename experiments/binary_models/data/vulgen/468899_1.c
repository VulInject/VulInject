void sas_ata_device_link_abort ( struct domain_device * device , bool force_reset ) { struct ata_port * ap = device -> sata_dev . ap ; struct ata_link * link = & ap -> link ; unsigned long flags ; spin_lock_irqsave ( ap -> lock , flags ) ; device -> sata_dev . fis [ 2 ] = ATA_ERR | ATA_DRDY ; device -> sata_dev . fis [ 3 ] = ATA_ABORTED ; link -> eh_info . err_mask |= AC_ERR_DEV ; ata_link_abort ( link ) ; spin_unlock_irqrestore ( ap -> lock , flags ) ; } 