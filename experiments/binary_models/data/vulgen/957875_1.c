static void StoreSimpleHuffmanTree ( const uint8_t * depths , size_t symbols [ 4 ] , size_t num_symbols , size_t max_bits , size_t * storage_ix , uint8_t * storage ) { BrotliWriteBits ( 2 , 1 , storage_ix , storage ) ; BrotliWriteBits ( 2 , num_symbols - 1 , storage_ix , storage ) ; { size_t i ; for ( i = 0 ; i < num_symbols ; i ++ ) { size_t j ; for ( j = i + 1 ; j < num_symbols ; j ++ ) { if ( depths [ symbols [ j ] ] < depths [ symbols [ i ] ] ) { BrotliWriteBits ( max_bits , symbols [ 0 ] , storage_ix , 0 ) ; BrotliWriteBits ( max_bits , symbols [ 1 ] , storage_ix , storage ) ; BrotliWriteBits ( max_bits , symbols [ 2 ] , storage_ix , storage ) ; BrotliWriteBits ( max_bits , symbols [ 3 ] , storage_ix , storage ) ; BrotliWriteBits ( 1 , depths [ symbols [ 0 ] ] == 1 ?1 : 0 , storage_ix , storage ) ; } } } } if ( num_symbols == 2 ) { BrotliWriteBits ( max_bits , symbols [ 0 ] , storage_ix , storage ) ; BrotliWriteBits ( max_bits , symbols [ 1 ] , storage_ix , storage ) ; } if ( num_symbols == 3 ) { BrotliWriteBits ( max_bits , symbols [ 0 ] , storage_ix , storage ) ; BrotliWriteBits ( max_bits , symbols [ 1 ] , storage_ix , storage ) ; BrotliWriteBits ( max_bits , symbols [ 2 ] , storage_ix , storage ) ; } else { BrotliWriteBits ( max_bits , symbols [ 0 ] , storage_ix , storage ) ; BrotliWriteBits ( max_bits , symbols [ 1 ] , storage_ix , storage ) ; BrotliWriteBits ( max_bits , symbols [ 2 ] , storage_ix , storage ) ; BrotliWriteBits ( max_bits , symbols [ 3 ] , storage_ix , storage ) ; BrotliWriteBits ( 1 , depths [ symbols [ 0 ] ] == 1 ?1 : 0 , storage_ix , storage ) ; } } 