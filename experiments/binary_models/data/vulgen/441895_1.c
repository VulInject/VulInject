static void AfmBuildMarkCombos ( SplineChar * sc , AnchorPoint * ap , struct cc_container * cc ) { if ( ap == NULL ) { AnchorPoint * ap ; struct cc_data * this = & cc -> ccs [ cc -> cnt ++ ] ; int acnt = 0 ; AnchorPoint * map ; this -> base = sc ; this -> accents = NULL ; for ( ap = sc -> anchor ; ap != NULL ; ap = ap -> next ) { if ( ap -> ticked ) { struct cc_accents * cca = chunkalloc ( sizeof ( cc_accents ) ) ; cca -> accent = cc -> marks [ ap -> anchor -> ac_num ] [ cc -> mpos [ ap -> anchor -> ac_num ] ] ; for ( map = cca -> accent -> anchor ; map -> anchor != ap -> anchor || map -> type != at_mark ; map = map -> next ) { } cca -> next = this -> accents ; this -> accents = cca ; ++ acnt ; } } if ( ! AfmBuildCCName ( this , cc ) ) { struct cc_accents * cca , * next ; -- cc -> cnt ; for ( cca = this -> accents ; cca != NULL ; cca = next ) { next = cca -> next ; chunkfree ( cca , sizeof ( cc_accents ) ) ; } } else { this -> acnt = acnt ; } } if ( ap -> ticked ) { int ac_num = ap -> anchor -> ac_num ; for ( cc -> mpos [ ac_num ] = 0 ; cc -> mpos [ ac_num ] < cc -> mcnt [ ac_num ] ; ++ cc -> mpos [ ac_num ] ) { AfmBuildMarkCombos ( sc , ap -> next , cc ) ; } } else { AfmBuildMarkCombos ( sc , ap -> next , cc ) ; } } 