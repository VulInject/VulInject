static void forensic_sess_reinit_ev ( const void * event_data , void * user_data ) { int res ; pr_event_unregister ( & log_forensic_module , "core.exit" , forensic_exit_ev ) ; pr_event_unregister ( & log_forensic_module , "core.log.unspec" , forensic_log_ev ) ; pr_event_unregister ( & log_forensic_module , "core.log.xferlog" , forensic_log_ev ) ; pr_event_unregister ( & log_forensic_module , "core.log.syslog" , forensic_log_ev ) ; pr_event_unregister ( & log_forensic_module , "core.log.systemlog" , forensic_log_ev ) ; pr_event_unregister ( & log_forensic_module , "core.log.extlog" , forensic_log_ev ) ; pr_event_unregister ( & log_forensic_module , "core.log.tracelog" , forensic_log_ev ) ; pr_event_unregister ( & log_forensic_module , "core.session-reinit" , forensic_sess_reinit_ev ) ; forensic_engine = FALSE ; ( void ) close ( forensic_logfd ) ; forensic_logfd = - 1 ; forensic_criteria = FORENSIC_CRIT_DEFAULT ; forensic_msgs = NULL ; forensic_nmsgs = FORENSIC_DEFAULT_NMSGS ; forensic_msg_idx = 0 ; if ( forensic_subpool != NULL ) { destroy_pool ( forensic_subpool ) ; forensic_subpool = NULL ; } forensic_subpool_msgno = 1 ; res = forensic_sess_init ( ) ; } 