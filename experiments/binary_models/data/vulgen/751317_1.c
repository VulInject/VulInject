static gboolean snoop_read ( wtap * wth , wtap_rec * rec , Buffer * buf , int * err , gchar * * err_info , gint64 * data_offset ) { int padbytes ; * data_offset = file_tell ( wth -> fh ) ; padbytes = snoop_read_packet ( wth , wth -> fh , rec , buf , err , err_info ) ; if ( padbytes != 0 ) { if ( ! wtap_read_bytes ( wth -> fh , NULL , padbytes , err , err_info ) ) { return FALSE ; } } return TRUE ; } 