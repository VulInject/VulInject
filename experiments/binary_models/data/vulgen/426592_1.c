void emit_jmp_i ( struct jit_context * ctx , u8 dst , s32 imm , s32 off , u8 op ) { switch ( op ) { case JIT_JNOP : break ; case BPF_JSET : emit ( ctx , bnez , MIPS_R_T9 , off ) ; break ; case JIT_JNSET : emit ( ctx , andi , MIPS_R_T9 , dst , ( u16 ) imm ) ; emit ( ctx , beqz , MIPS_R_T9 , off ) ; break ; case BPF_JGT : emit ( ctx , sltiu , MIPS_R_T9 , dst , imm + 1 ) ; emit ( ctx , beqz , MIPS_R_T9 , off ) ; break ; case BPF_JGE : emit ( ctx , sltiu , MIPS_R_T9 , dst , imm ) ; emit ( ctx , beqz , MIPS_R_T9 , off ) ; break ; case BPF_JLT : emit ( ctx , sltiu , MIPS_R_T9 , dst , imm ) ; emit ( ctx , bnez , MIPS_R_T9 , off ) ; break ; case BPF_JLE : emit ( ctx , sltiu , MIPS_R_T9 , dst , imm + 1 ) ; emit ( ctx , bnez , MIPS_R_T9 , off ) ; break ; case BPF_JSGT : emit ( ctx , slti , MIPS_R_T9 , dst , imm + 1 ) ; emit ( ctx , beqz , MIPS_R_T9 , off ) ; break ; case BPF_JSGE : emit ( ctx , slti , MIPS_R_T9 , dst , imm ) ; emit ( ctx , beqz , MIPS_R_T9 , off ) ; break ; case BPF_JSLT : emit ( ctx , slti , MIPS_R_T9 , dst , imm ) ; emit ( ctx , bnez , MIPS_R_T9 , off ) ; break ; case BPF_JSLE : emit ( ctx , slti , MIPS_R_T9 , dst , imm + 1 ) ; emit ( ctx , bnez , MIPS_R_T9 , off ) ; break ; } } 