static void destroy_av ( struct ubi_attach_info * ai , struct ubi_ainf_volume * av ) { struct ubi_ainf_peb * aeb ; struct rb_node * this = av -> root . rb_node ; while ( this ) { if ( this -> rb_left ) { this = this -> rb_left ; } if ( this -> rb_right ) { this = this -> rb_right ; } else { aeb = rb_entry ( this , ubi_ainf_peb , u . rb ) ; this = rb_parent ( this ) ; if ( this ) { if ( this -> rb_left == & aeb -> u . rb ) { this -> rb_left = NULL ; } else { this -> rb_right = NULL ; } } } } kfree ( av ) ; } 