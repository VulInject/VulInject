void ath5k_hw_pcu_init ( struct ath5k_hw * ah , enum nl80211_iftype op_mode ) { ath5k_hw_set_bssid ( ah ) ; ath5k_hw_set_opmode ( ah , op_mode ) ; if ( ah -> ah_version == AR5K_AR5212 && ah -> nvifs ) { ath5k_hw_write_rate_duration ( ah ) ; } ath5k_hw_reg_write ( ah , ( AR5K_TUNE_RSSI_THRES | AR5K_TUNE_BMISS_THRES << AR5K_RSSI_THR_BMISS_S ) , AR5K_RSSI_THR ) ; if ( ah -> ah_mac_srev >= AR5K_SREV_AR2413 ) { ath5k_hw_reg_write ( ah , 0x000100aa , AR5K_MIC_QOS_CTL ) ; ath5k_hw_reg_write ( ah , 0x00003210 , AR5K_MIC_QOS_SEL ) ; } if ( ah -> ah_version == AR5K_AR5212 ) { ath5k_hw_reg_write ( ah , AR5K_REG_SM ( 2 , AR5K_QOS_NOACK_2BIT_VALUES ) | AR5K_REG_SM ( 5 , AR5K_QOS_NOACK_BIT_OFFSET ) | AR5K_REG_SM ( 0 , AR5K_QOS_NOACK_BYTE_OFFSET ) , AR5K_QOS_NOACK ) ; } if ( ah -> ah_coverage_class > 0 ) { ath5k_hw_set_coverage_class ( ah , ah -> ah_coverage_class ) ; } return ; } 