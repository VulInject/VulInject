static int rrip_check ( struct iso_directory_record * dp , int * lenskip ) { ISO_SUSP_PRESENT * sp ; ISO_RRIP_EXTREF * er ; char * p ; p = dp -> name + isonum_711 ( dp -> name_len ) ; sp = ( ISO_SUSP_PRESENT * ) p ; if ( bcmp ( sp -> h . type , SUSP_PRESENT , 2 ) != 0 ) { return ( 0 ) ; } if ( isonum_711 ( sp -> h . length ) != sizeof ( ISO_SUSP_PRESENT ) ) { return ( 0 ) ; } if ( sp -> signature [ 0 ] != 0xbe || sp -> signature [ 1 ] != 0xef ) { return ( 0 ) ; } * lenskip = isonum_711 ( sp -> len_skp ) ; er = ( ISO_RRIP_EXTREF * ) susp_lookup_record ( SUSP_EXTREF , dp , 0 ) ; if ( er == NULL ) { return ( 0 ) ; } return ( 1 ) ; } 