zprivs_terminate ( ) { if ( ! zprivs ) { fprintf ( stderr , "%s: no privs struct given, terminating" , __func__ ) ; exit ( 0 ) ; } if ( zprivs_state . zuid ) { if ( setreuid ( zprivs_state . zuid , zprivs_state . zuid ) ) { fprintf ( stderr , "privs_terminate: could not setreuid, %s" , safe_strerror ( errno ) ) ; exit ( 1 ) ; } } zprivs -> change = zprivs_change_null ; zprivs -> current_state = zprivs_state_null ; zprivs_null_state = ZPRIVS_LOWERED ; return ; } 