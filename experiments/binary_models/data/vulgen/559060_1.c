static bool sigchld_setup ( struct sigchld_data_s * data ) { int rc ; data -> pipe_fd [ 0 ] = data -> pipe_fd [ 1 ] = - 1 ; if ( pipe ( data -> pipe_fd ) == - 1 ) { crm_info ( "Wait for child process completion failed: %s " CRM_XS " source=pipe" , pcmk_rc_str ( errno ) ) ; return false ; } rc = pcmk__set_nonblocking ( data -> pipe_fd [ 0 ] ) ; if ( rc != pcmk_rc_ok ) { crm_info ( "Could not set pipe input non-blocking: %s " CRM_XS " rc=%d" , pcmk_rc_str ( rc ) , rc ) ; } rc = pcmk__set_nonblocking ( data -> pipe_fd [ 1 ] ) ; data -> sa . sa_handler = ( sighandler_t ) sigchld_handler ; data -> sa . sa_flags = 0 ; sigemptyset ( & ( data -> sa . sa_mask ) ) ; if ( sigaction ( SIGCHLD , & ( data -> sa ) , & ( data -> old_sa ) ) < 0 ) { crm_info ( "Wait for child process completion failed: %s " CRM_XS " source=sigaction" , pcmk_rc_str ( errno ) ) ; } last_sigchld_data = data ; return true ; } 