struct ipv6hdr * nf_reject_ip6hdr_put ( struct sk_buff * nskb , const struct sk_buff * oldskb , __u8 protocol , int hoplimit ) { struct ipv6hdr * ip6h ; const __u8 tclass = DEFAULT_TOS_VALUE ; skb_put ( nskb , sizeof ( ipv6hdr ) ) ; skb_reset_network_header ( nskb ) ; ip6h = ipv6_hdr ( nskb ) ; ip6_flow_hdr ( ip6h , tclass , 0 ) ; ip6h -> hop_limit = hoplimit ; ip6h -> nexthdr = protocol ; ip6h -> saddr = oip6h -> daddr ; ip6h -> daddr = oip6h -> saddr ; nskb -> protocol = htons ( ETH_P_IPV6 ) ; return ip6h ; } 