static void ufx_dpy_deferred_io ( struct fb_info * info , struct list_head * pagereflist ) { struct ufx_data * dev = info -> par ; struct fb_deferred_io_pageref * pageref ; if ( ! atomic_read ( & dev -> usb_active ) ) { return ; } list_for_each_entry ( , , ) { const int x = 0 ; const int width = dev -> info -> var . xres ; const int y = pageref -> offset / ( width * 2 ) ; int height = ( PAGE_SIZE / ( width * 2 ) ) + 1 ; height = min ( height , ( int ) ( dev -> info -> var . yres - y ) ) ; BUG_ON ( y >= dev -> info -> var . yres ) ; BUG_ON ( ( y + height ) > dev -> info -> var . yres ) ; ufx_handle_damage ( dev , x , y , width , height ) ; } } 