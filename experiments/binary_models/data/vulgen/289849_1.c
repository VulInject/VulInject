static void intel_hdcp_prop_work ( struct work_struct * work ) { struct intel_hdcp * hdcp = container_of ( work , intel_hdcp , prop_work ) ; struct intel_connector * connector = intel_hdcp_to_connector ( hdcp ) ; struct drm_i915_private * dev_priv = to_i915 ( connector -> base . dev ) ; drm_modeset_lock ( & dev_priv -> drm . mode_config . connection_mutex , NULL ) ; mutex_lock ( & hdcp -> mutex ) ; if ( hdcp -> value != DRM_MODE_CONTENT_PROTECTION_UNDESIRED ) { drm_hdcp_update_content_protection ( & connector -> base , hdcp -> value ) ; } mutex_unlock ( & hdcp -> mutex ) ; drm_modeset_unlock ( & dev_priv -> drm . mode_config . connection_mutex ) ; } 