gimp_curves_tool_update_point ( ) { GimpFilterTool * filter_tool = GIMP_FILTER_TOOL ( tool ) ; GimpCurvesConfig * config = GIMP_CURVES_CONFIG ( filter_tool -> config ) ; GimpCurve * curve = config -> curve [ config -> channel ] ; gint point ; point = gimp_curve_view_get_selected ( GIMP_CURVE_VIEW ( tool -> graph ) ) ; gtk_widget_set_sensitive ( tool -> point_box , point >= 0 ) ; if ( point >= 0 ) { gdouble min = 0.0 ; gdouble max = 1.0 ; gdouble x ; gdouble y ; if ( point > 0 ) { gimp_curve_get_point ( curve , point - 1 , & min , NULL ) ; } if ( point < gimp_curve_get_n_points ( curve ) - 1 ) { gimp_curve_get_point ( curve , point + 1 , & max , NULL ) ; } gimp_curve_get_point ( curve , point , & x , & y ) ; x *= tool -> scale ; y *= tool -> scale ; min *= tool -> scale ; max *= tool -> scale ; g_signal_handlers_block_by_func ( tool -> point_input , curves_point_coords_callback , tool ) ; g_signal_handlers_block_by_func ( tool -> point_output , curves_point_coords_callback , tool ) ; gtk_spin_button_set_range ( GTK_SPIN_BUTTON ( tool -> point_input ) , min , max ) ; gtk_spin_button_set_value ( GTK_SPIN_BUTTON ( tool -> point_input ) , x ) ; gtk_spin_button_set_value ( GTK_SPIN_BUTTON ( tool -> point_output ) , y ) ; g_signal_handlers_unblock_by_func ( tool -> point_input , curves_point_coords_callback , tool ) ; g_signal_handlers_unblock_by_func ( tool -> point_output , curves_point_coords_callback , tool ) ; g_signal_handlers_block_by_func ( tool -> point_type , curves_point_type_callback , tool ) ; gimp_int_radio_group_set_active ( GTK_RADIO_BUTTON ( tool -> point_type ) , gimp_curve_get_point_type ( curve , point ) ) ; } } 