static char * createtmpfile ( char * filename ) { char * p , * tempname ; p = strrchr ( filename , '/' ) ; if ( p != NULL ) { filename = p + 1 ; } assert ( strlen ( filename ) >= 5 ) ; if ( tempname == NULL ) { LogError ( _ ( "Out of memory\n" ) ) ; exit ( 1 ) ; } strcpy ( tempname , filename ) ; strcpy ( tempname + strlen ( tempname ) - 5 , "XXXXXX" ) ; { int i = mkstemp ( tempname ) ; if ( i ) { close ( i ) ; } } mktemp ( tempname ) ; return tempname ; } 