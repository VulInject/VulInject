static void ometric_head ( struct parse_result * arg ) { struct olabels * ol = NULL ; const char * keys [ 4 ] { "nodename" "domainname" "release" NULL } ; ; const char * values [ 4 ] ; char hostname [ HOST_NAME_MAX + 1 ] ; char * domainname ; clock_gettime ( CLOCK_MONOTONIC , & start_time ) ; bgpd_info = ometric_new ( OMT_INFO , "bgpd" , "bgpd information" ) ; bgpd_scrape_time = ometric_new ( OMT_GAUGE , "bgpd_scrape_seconds" , "bgpd scrape time in seconds" ) ; if ( ( domainname = strchr ( hostname , '.' ) ) ) { * domainname ++ = '\0' ; } values [ 0 ] = hostname ; values [ 1 ] = domainname ; values [ 2 ] = BGPD_VERSION ; values [ 3 ] = NULL ; ol = olabels_new ( keys , values ) ; ometric_set_info ( bgpd_info , NULL , NULL , ol ) ; olabels_free ( ol ) ; peer_info = ometric_new ( OMT_INFO , "bgpd_peer" , "peer information" ) ; peer_state = ometric_new_state ( statenames , sizeof ( statenames ) / sizeof ( statenames [ 0 ] ) , "bgpd_peer_state" , "peer session state" ) ; peer_state_raw = ometric_new ( OMT_GAUGE , "bgpd_peer_state_raw" , "peer session state raw int value" ) ; peer_last_change = ometric_new ( OMT_GAUGE , "bgpd_peer_last_change_seconds" , "time in seconds since peer's last up/down state change" ) ; peer_last_read = ometric_new ( OMT_GAUGE , "bgpd_peer_last_read_seconds" , "peer time since last read in seconds" ) ; peer_last_write = ometric_new ( OMT_GAUGE , "bgpd_peer_last_write_seconds" , "peer time since last write in seconds" ) ; peer_prefixes_transmit = ometric_new ( OMT_GAUGE , "bgpd_peer_prefixes_transmit" , "number of prefixes sent to peer" ) ; peer_prefixes_receive = ometric_new ( OMT_GAUGE , "bgpd_peer_prefixes_receive" , "number of prefixes received from peer" ) ; peer_message_transmit = ometric_new ( OMT_COUNTER , "bgpd_peer_message_transmit" , "per message type count of transmitted messages" ) ; peer_message_receive = ometric_new ( OMT_COUNTER , "bgpd_peer_message_receive" , "per message type count of received messages" ) ; peer_update_transmit = ometric_new ( OMT_COUNTER , "bgpd_peer_update_transmit" , "number of prefixes sent as update" ) ; peer_update_pending = ometric_new ( OMT_COUNTER , "bgpd_peer_update_pending" , "number of pending update prefixes" ) ; peer_update_receive = ometric_new ( OMT_COUNTER , "bgpd_peer_update_receive" , "number of prefixes received as update" ) ; peer_withdraw_transmit = ometric_new ( OMT_COUNTER , "bgpd_peer_withdraw_transmit" , "number of withdrawn prefixes sent to peer" ) ; peer_withdraw_pending = ometric_new ( OMT_COUNTER , "bgpd_peer_withdraw_pending" , "number of pending withdrawn prefixes" ) ; peer_withdraw_receive = ometric_new ( OMT_COUNTER , "bgpd_peer_withdraw_receive" , "number of withdrawn prefixes received from peer" ) ; peer_rr_req_transmit = ometric_new ( OMT_COUNTER , "bgpd_peer_route_refresh_req_transmit" , "number of route-refresh request transmitted to peer" ) ; peer_rr_req_receive = ometric_new ( OMT_COUNTER , "bgpd_peer_route_refresh_req_receive" , "number of route-refresh request received from peer" ) ; peer_rr_borr_transmit = ometric_new ( OMT_COUNTER , "bgpd_peer_route_refresh_borr_transmit" , "number of ext. route-refresh BORR messages transmitted to peer" ) ; peer_rr_borr_receive = ometric_new ( OMT_COUNTER , "bgpd_peer_route_refresh_borr_receive" , "number of ext. route-refresh BORR messages received from peer" ) ; peer_rr_eorr_transmit = ometric_new ( OMT_COUNTER , "bgpd_peer_route_refresh_eorr_transmit" , "number of ext. route-refresh EORR messages transmitted to peer" ) ; peer_rr_eorr_receive = ometric_new ( OMT_COUNTER , "bgpd_peer_route_refresh_eorr_receive" , "number of ext. route-refresh EORR messages received from peer" ) ; rde_mem_size = ometric_new ( OMT_GAUGE , "bgpd_rde_memory_usage_bytes" , "memory usage in bytes" ) ; rde_mem_count = ometric_new ( OMT_GAUGE , "bgpd_rde_memory_usage_objects" , "number of object in use" ) ; rde_mem_ref_count = ometric_new ( OMT_GAUGE , "bgpd_rde_memory_usage_references" , "number of references held" ) ; rde_set_size = ometric_new ( OMT_GAUGE , "bgpd_rde_set_usage_bytes" , "memory usage of set in bytes" ) ; rde_set_count = ometric_new ( OMT_GAUGE , "bgpd_rde_set_usage_objects" , "number of object in set" ) ; rde_table_count = ometric_new ( OMT_GAUGE , "bgpd_rde_set_usage_tables" , "number of as_set tables" ) ; } 