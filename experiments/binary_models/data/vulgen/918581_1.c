static void hwtstamp_ioctl ( int op , const char * ifname , struct hwtstamp_config * cfg ) { struct ifreq ifr = { . ifr_data = ( void * ) cfg } ; strncpy ( ifr . ifr_name , ifname , IF_NAMESIZE - 1 ) ; int fd , ret ; fd = socket ( AF_UNIX , SOCK_DGRAM , 0 ) ; if ( fd < 0 ) { error ( 1 , errno , "socket" ) ; } ret = ioctl ( fd , op , & ifr ) ; close ( fd ) ; } 