static void init_proc ( ) { int pfd ; char procname [ PROCSIZE ] ; sigset_t sigset ; fltset_t fltset ; sysset_t sysset ; long oper , pflags ; struct iovec piov [ 2 ] ; if ( ( pfd = open ( procname , O_WRONLY ) ) < 0 ) { ( void ) fprintf ( stderr , "can't open %s\n" , procname ) ; exit ( 1 ) ; } oper = PCSET ; piov [ 0 ] . iov_base = ( caddr_t ) ( & oper ) ; piov [ 0 ] . iov_len = sizeof ( oper ) ; pflags = PR_FORK ; piov [ 1 ] . iov_base = ( caddr_t ) & pflags ; piov [ 1 ] . iov_len = sizeof ( pflags ) ; if ( writev ( pfd , piov , 2 ) == - 1 ) { perr ( "init_proc: PCSET" ) ; } oper = PCSTRACE ; premptyset ( & sigset ) ; piov [ 1 ] . iov_base = ( caddr_t ) & sigset ; piov [ 1 ] . iov_len = sizeof ( sigset ) ; if ( writev ( pfd , piov , 2 ) == - 1 ) { perr ( "PCSTRACE" ) ; } oper = PCSFAULT ; premptyset ( & fltset ) ; piov [ 1 ] . iov_base = ( caddr_t ) & fltset ; piov [ 1 ] . iov_len = sizeof ( fltset ) ; if ( writev ( pfd , piov , 2 ) == - 1 ) { perr ( "PCSFAULT" ) ; } oper = PCSENTRY ; premptyset ( & sysset ) ; piov [ 1 ] . iov_base = ( caddr_t ) & sysset ; piov [ 1 ] . iov_len = sizeof ( sysset ) ; if ( writev ( pfd , piov , 2 ) == - 1 ) { perr ( "PSENTRY" ) ; } oper = PCSEXIT ; premptyset ( & sysset ) ; praddset ( & sysset , SYS_execve ) ; if ( writev ( pfd , piov , 2 ) == - 1 ) { perr ( "PCSEXIT" ) ; } ( void ) close ( pfd ) ; } 