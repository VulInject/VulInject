static int mt6358_regulator_probe ( struct platform_device * pdev ) { struct mt6397_chip * mt6397 = dev_get_drvdata ( pdev -> dev . parent ) ; struct regulator_config config = { } ; struct regulator_dev * rdev ; struct mt6358_regulator_info * mt6358_info ; int i , max_regulator ; else { max_regulator = MT6358_MAX_REGULATOR ; mt6358_info = mt6358_regulators ; } for ( i = 0 ; i < max_regulator ; i ++ ) { config . dev = & pdev -> dev ; config . driver_data = & mt6358_info [ i ] ; config . regmap = mt6397 -> regmap ; rdev = devm_regulator_register ( & pdev -> dev , & mt6358_info [ i ] . desc , & config ) ; if ( IS_ERR ( rdev ) ) { dev_err ( & pdev -> dev , "failed to register %s\n" , mt6358_info [ i ] . desc . name ) ; return PTR_ERR ( rdev ) ; } } return 0 ; } 