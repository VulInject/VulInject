static __always_inline int is_tcp_mem ( struct bpf_sysctl * ctx ) { unsigned char i ; char name [ sizeof ( tcp_mem_name ) ] ; int ret ; ret = bpf_sysctl_get_name ( ctx , name , sizeof ( name ) , 0 ) ; if ( ret < 0 || ret != sizeof ( tcp_mem_name ) - 1 ) { return 0 ; } for ( i = 0 ; i < sizeof ( tcp_mem_name ) ; ++ i ) { if ( name [ i ] != tcp_mem_name [ i ] ) { return 0 ; } } return 1 ; } 