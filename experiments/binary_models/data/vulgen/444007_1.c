static irqreturn_t pm8821_irq_handler ( int irq , void * data ) { struct pm_irq_chip * chip = data ; unsigned int master ; int ret ; ret = regmap_read ( chip -> regmap , PM8821_SSBI_REG_ADDR_IRQ_MASTER0 , & master ) ; if ( ret ) { pr_err ( "Failed to read master 0 ret=%d\n" , ret ) ; return IRQ_NONE ; } if ( ! ( master & BIT ( 0 ) ) ) { return IRQ_NONE ; } ret = regmap_read ( chip -> regmap , PM8821_SSBI_REG_ADDR_IRQ_MASTER1 , & master ) ; if ( ret ) { pr_err ( "Failed to read master 1 ret=%d\n" , ret ) ; return IRQ_NONE ; } pm8821_irq_master_handler ( chip , 1 , master ) ; return IRQ_HANDLED ; } 