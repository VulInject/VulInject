static void zap_leaf_chunk_free ( zap_leaf_t * l , uint16_t chunk ) { struct zap_leaf_free * zlf = & ZAP_LEAF_CHUNK ( l , chunk ) . l_free ; ASSERT3U ( zap_leaf_phys ( l ) -> l_hdr . lh_nfree , < , ZAP_LEAF_NUMCHUNKS ( l ) ) ; ASSERT3U ( chunk , < , ZAP_LEAF_NUMCHUNKS ( l ) ) ; ASSERT ( zlf -> lf_type != ZAP_CHUNK_FREE ) ; zlf -> lf_type = ZAP_CHUNK_FREE ; zlf -> lf_next = zap_leaf_phys ( l ) -> l_hdr . lh_freelist ; zap_leaf_phys ( l ) -> l_hdr . lh_freelist = chunk ; zap_leaf_phys ( l ) -> l_hdr . lh_nfree ++ ; } 