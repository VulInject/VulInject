static void __iomem * wii_ioremap_hw_regs ( char * name , char * compatible ) { void __iomem * hw_regs = NULL ; struct device_node * np ; struct resource res ; int error = - ENODEV ; np = of_find_compatible_node ( NULL , NULL , compatible ) ; error = of_address_to_resource ( np , 0 , & res ) ; if ( error ) { pr_err ( "no valid reg found for %s\n" , np -> name ) ; out_put } hw_regs = ioremap ( res . start , resource_size ( & res ) ) ; if ( hw_regs ) { pr_info ( "%s at 0x%08x mapped to 0x%p\n" , name , res . start , hw_regs ) ; } out_put of_node_put ( np ) ; out return hw_regs ; } 