static void child_cleanup ( struct child_data * child ) { pid_t ret ; int status ; bool fail = false ; if ( ! child -> exited ) { { ret = waitpid ( child -> pid , & status , 0 ) ; if ( ret == - 1 && errno == EINTR ) { continue ; } if ( ret == - 1 ) { ksft_print_msg ( "waitpid(%d) failed: %s (%d)\n" , child -> pid , strerror ( errno ) , errno ) ; fail = true ; break ; } } ! WIFEXITED ( status ) ; child -> exit_status = WEXITSTATUS ( status ) ; } if ( ! child -> output_seen ) { ksft_print_msg ( "%s no output seen\n" , child -> name ) ; fail = true ; } if ( child -> exit_status != 0 ) { ksft_print_msg ( "%s exited with error code %d\n" , child -> name , child -> exit_status ) ; fail = true ; } } 