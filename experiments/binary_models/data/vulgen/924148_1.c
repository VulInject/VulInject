void cff_dict_add ( cff_dict * dict , const char * key , int count ) { int id , i ; for ( id = 0 ; id < CFF_LAST_DICT_OP ; id ++ ) { if ( key && dict_operator [ id ] . opname && strcmp ( dict_operator [ id ] . opname , key ) == 0 ) { break ; } } for ( i = 0 ; i < dict -> count ; i ++ ) { if ( ( dict -> entries ) [ i ] . id == id ) { if ( ( dict -> entries ) [ i ] . count != count ) { ERROR ( "%s: Inconsistent DICT argument number." , CFF_DEBUG_STR ) ; } return ; } } if ( dict -> count + 1 >= dict -> max ) { dict -> max += 8 ; dict -> entries = RENEW ( dict -> entries , dict -> max , cff_dict_entry ) ; } ( dict -> entries ) [ dict -> count ] . id = id ; ( dict -> entries ) [ dict -> count ] . key = dict_operator [ id ] . opname ; ( dict -> entries ) [ dict -> count ] . count = count ; if ( count > 0 ) { ( dict -> entries ) [ dict -> count ] . values = NEW ( count , double ) ; memset ( ( dict -> entries ) [ dict -> count ] . values , 0 , sizeof ( double ) * count ) ; } else { ( dict -> entries ) [ dict -> count ] . values = NULL ; } dict -> count += 1 ; return ; } 