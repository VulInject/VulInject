build_java_class_ref ( ) tree type ; { tree name = NULL_TREE , class_decl ; static tree CL_suffix = NULL_TREE ; if ( CL_suffix == NULL_TREE ) { CL_suffix = get_identifier ( "class$" ) ; } if ( jclass_node == NULL_TREE ) { jclass_node = IDENTIFIER_GLOBAL_VALUE ( get_identifier ( "jclass" ) ) ; if ( jclass_node == NULL_TREE ) { fatal_error ( "call to Java constructor, while `jclass' undefined" ) ; } jclass_node = TREE_TYPE ( jclass_node ) ; } { tree field ; for ( field = TYPE_FIELDS ( type ) ; field ; field = TREE_CHAIN ( field ) ) { if ( DECL_NAME ( field ) == CL_suffix ) { mangle_decl ( field ) ; name = DECL_ASSEMBLER_NAME ( field ) ; break ; } } if ( ! field ) { internal_error ( "can't find class$" ) ; } } class_decl = IDENTIFIER_GLOBAL_VALUE ( name ) ; return class_decl ; } 