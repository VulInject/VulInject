static int __init pcibios_init ( void ) { void * extra_ack ( struct irq_data * ) int link , irq ; pci_set_flags ( PCI_PROBE_ONLY ) ; ioport_resource . start = 0 ; ioport_resource . end = ~ 0 ; set_io_port_base ( CKSEG1 ) ; nlm_pci_controller . io_map_base = CKSEG1 ; pr_info ( "Registering XLR/XLS PCIX/PCIE Controller.\n" ) ; register_pci_controller ( & nlm_pci_controller ) ; if ( ! nlm_chip_is_xls ( ) ) { nlm_set_pic_extra_ack ( 0 , PIC_PCIX_IRQ , xlr_pci_ack ) ; } else { if ( nlm_chip_is_xls_b ( ) ) { extra_ack = xls_pcie_ack_b ; } else { extra_ack = xls_pcie_ack ; } for ( link = 0 ; link < 4 ; link ++ ) { irq = nlm_pci_link_to_irq ( link ) ; nlm_set_pic_extra_ack ( 0 , irq , extra_ack ) ; } } return 0 ; } 