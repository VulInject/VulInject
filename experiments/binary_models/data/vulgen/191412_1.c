static void readAnnotation ( RBinDexObj * dex , bool readVisibility ) { ut64 stringIndex , i ; RBuffer * buf = dex -> b ; if ( readVisibility ) { bprintf ( "    Visibility: " ) ; ut8 b = r_buf_read8 ( buf ) ; switch ( b ) { case R_DEX_VISIBILITY_BUILD : bprintf ( "BUILD\n" ) ; break ; case R_DEX_VISIBILITY_RUNTIME : bprintf ( "RUNTIME\n" ) ; break ; case R_DEX_VISIBILITY_SYSTEM : bprintf ( "SYSTEM\n" ) ; break ; default : bprintf ( "UNKNOWN (0x%02x)\n" , b ) ; break ; } } st64 typeIndex = ST64_MAX ; st64 typeSize = ST64_MAX ; r_buf_sleb128 ( buf , & typeIndex ) ; r_buf_sleb128 ( buf , & typeSize ) ; if ( typeIndex ( 0 || typeIndex ) 10000 ) { return ; } if ( typeSize ( 0 || typeSize ) 10000 ) { return ; } const char * typeString = className ( dex , typeIndex ) ; if ( typeString ) { bprintf ( "      TypeSize: %d %d (%s)\n" , ( int ) typeIndex , ( int ) typeSize , typeString ) ; for ( i = 0 ; i < typeSize ; i ++ ) { r_buf_uleb128 ( buf , & stringIndex ) ; ut64 at = r_buf_seek ( dex -> b , 0 , R_BUF_CUR ) ; const char * name = className ( dex , stringIndex ) ; if ( ! name ) { break ; } bprintf ( "      Item %d %s\n" , ( int ) stringIndex , name ) ; r_buf_seek ( dex -> b , at , R_BUF_SET ) ; parseValue ( dex ) ; } } else { bprintf ( "      TypeSize: %d %d (?)\n" , ( int ) typeIndex , ( int ) typeSize ) ; } } 