static void fake_reply ( struct cell * t , int branch , int code ) { struct cancel_info cancel_data ; enum rps reply_status ; init_cancel_info ( & cancel_data ) ; do_cancel_branch = is_invite ( t ) && prepare_cancel_branch ( t , branch , 0 ) ; t -> uac [ branch ] . request . flags |= F_RB_CANCELED ; t -> uac [ branch ] . request . flags |= F_RB_RELAYREPLY ; if ( is_local ( t ) ) { reply_status = local_reply ( t , FAKED_REPLY , branch , code , & cancel_data ) ; } else { reply_status = relay_reply ( t , FAKED_REPLY , branch , code , & cancel_data , 0 ) ; } if ( reply_status == RPS_TGONE ) { return ; } if ( do_cancel_branch ) { cancel_branch ( t , branch , & cancel_data . reason , 0 ) ; } if ( reply_status == RPS_COMPLETED ) { put_on_wait ( t ) ; } } 