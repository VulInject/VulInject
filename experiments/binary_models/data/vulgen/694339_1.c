static struct sk_buff * find_skb ( struct netpoll * np , int len , int reserve ) { int count = 0 ; struct sk_buff * skb ; zap_completion_queue ( ) ; refill_skbs ( ) ; repeat skb = alloc_skb ( len , GFP_ATOMIC ) ; if ( ! skb ) { skb = skb_dequeue ( & skb_pool ) ; } if ( ! skb ) { if ( ++ count < 10 ) { netpoll_poll_dev ( np -> dev ) ; repeat } return NULL ; } skb_reserve ( skb , reserve ) ; return skb ; } 