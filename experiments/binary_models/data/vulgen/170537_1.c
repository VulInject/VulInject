static int init_fw_ctxt ( struct hinic_hwdev * hwdev ) { struct hinic_hwif * hwif = hwdev -> hwif ; struct pci_dev * pdev = hwif -> pdev ; struct hinic_cmd_fw_ctxt fw_ctxt ; int err ; fw_ctxt . func_idx = HINIC_HWIF_FUNC_IDX ( hwif ) ; fw_ctxt . rx_buf_sz = HINIC_RX_BUF_SZ ; err = hinic_port_msg_cmd ( hwdev , HINIC_PORT_CMD_FWCTXT_INIT , & fw_ctxt , sizeof ( fw_ctxt ) , & fw_ctxt , & out_size ) ; if ( err || out_size != sizeof ( fw_ctxt ) || fw_ctxt . status ) { dev_err ( & pdev -> dev , "Failed to init FW ctxt, err: %d, status: 0x%x, out size: 0x%x\n" , err , fw_ctxt . status , out_size ) ; return - EIO ; } return 0 ; } 