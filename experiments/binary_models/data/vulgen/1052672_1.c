static void ingenic_drm_crtc_atomic_enable ( struct drm_crtc * crtc , struct drm_atomic_state * state ) { struct ingenic_drm * priv = drm_crtc_get_priv ( crtc ) ; struct ingenic_drm_private_state * priv_state ; unsigned int next_id ; priv_state = ingenic_drm_get_priv_state ( priv , state ) ; next_id = priv_state -> use_palette ?HWDESC_PALETTE : 0 ; regmap_write ( priv -> map , JZ_REG_LCD_DA0 , dma_hwdesc_addr ( priv , next_id ) ) ; regmap_write ( priv -> map , JZ_REG_LCD_DA1 , dma_hwdesc_addr ( priv , 1 ) ) ; drm_crtc_vblank_on ( crtc ) ; } 