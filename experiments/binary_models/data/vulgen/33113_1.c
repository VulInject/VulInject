extern void TransposetoAxes ( coord_t * X , int b , int n ) { coord_t M , P , Q , t ; int i ; t = X [ n - 1 ] >> 1 ; for ( i = n - 1 ; i ; i -- ) { X [ i ] ^= X [ i - 1 ] ; } X [ 0 ] ^= t ; M = 2 << ( b - 1 ) ; for ( Q = 2 ; Q != M ; Q <<= 1 ) { P = Q - 1 ; for ( i = n - 1 ; i ; i -- ) { if ( X [ i ] & Q ) { X [ 0 ] ^= P ; } else { X [ 0 ] ^= t ; X [ i ] ^= t ; } } if ( X [ 0 ] & Q ) { X [ 0 ] ^= P ; } } } 