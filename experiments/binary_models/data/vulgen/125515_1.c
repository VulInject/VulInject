static sendpacket_t * sendpacket_open_libdnet ( const char * device , char * errbuf ) { eth_t * ldnet ; sendpacket_t * sp ; assert ( device ) ; assert ( errbuf ) ; dbg ( 1 , "sendpacket: using Libdnet" ) ; if ( ( ldnet = eth_open ( device ) ) == NULL ) { return NULL ; } sp = ( sendpacket_t * ) safe_malloc ( sizeof ( sendpacket_t ) ) ; sp -> handle . ldnet = ldnet ; sp -> handle_type = SP_TYPE_LIBDNET ; return sp ; } 