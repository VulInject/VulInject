int efc_ns_send_gidpt ( struct efc_node * node ) { struct efc_els_io_req * els = NULL ; struct efc * efc = node -> efc ; { struct fc_ct_hdr hdr ; struct fc_ns_gid_pt gidpt ; } , * ct node_els_trace ( ) ; els = efc_els_io_alloc_size ( node , sizeof ( * ct ) , EFC_ELS_GID_PT_RSP_LEN ) ; if ( ! els ) { efc_log_err ( efc , "IO alloc failed\n" ) ; return - EIO ; } els -> io . iparam . ct . r_ctl = FC_RCTL_ELS_REQ ; els -> io . iparam . ct . type = FC_TYPE_CT ; els -> io . iparam . ct . df_ctl = 0 ; els -> io . iparam . ct . timeout = EFC_FC_ELS_SEND_DEFAULT_TIMEOUT ; els -> display_name = "gidpt" ; ct = els -> io . req . virt ; fcct_build_req_header ( & ct -> hdr , FC_NS_GID_PT , sizeof ( fc_ns_gid_pt ) ) ; ct -> gidpt . fn_pt_type = FC_TYPE_FCP ; return efc_els_send_req ( node , els , EFC_DISC_IO_CT_REQ ) ; } 