static void * __alloc ( struct bpf_mem_cache * c , int node ) { if ( c -> percpu_size ) { void * * obj = kmalloc_node ( c -> percpu_size , flags , node ) ; void * pptr = __alloc_percpu_gfp ( c -> unit_size , 8 , flags ) ; if ( ! obj || ! pptr ) { free_percpu ( pptr ) ; kfree ( obj ) ; return NULL ; } obj [ 1 ] = pptr ; return obj ; } return kmalloc_node ( c -> unit_size , flags | __GFP_ZERO , node ) ; } 