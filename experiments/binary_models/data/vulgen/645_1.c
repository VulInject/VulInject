void test_ignore_status__subdirectories ( void ) { status_entry_single st ; g_repo = cl_git_sandbox_init ( "empty_standard_repo" ) ; cl_git_mkfile ( "empty_standard_repo/ignore_me" , "I'm going to be ignored!" ) ; cl_git_rewritefile ( "empty_standard_repo/.gitignore" , "ignore_me\n" ) ; memset ( & st , 0 , sizeof ( st ) ) ; cl_git_pass ( git_status_foreach ( g_repo , cb_status__single , & st ) ) ; cl_assert_equal_i ( 2 , st . count ) ; cl_assert ( st . status == GIT_STATUS_IGNORED ) ; cl_git_pass ( git_status_file ( & st . status , g_repo , "ignore_me" ) ) ; cl_assert ( st . status == GIT_STATUS_IGNORED ) ; assert_is_ignored ( "ignore_me" ) ; cl_git_mkfile ( "empty_standard_repo/test/ignore_me/file" , "I'm going to be ignored!" ) ; cl_git_mkfile ( "empty_standard_repo/test/ignore_me/file2" , "Me, too!" ) ; memset ( & st , 0 , sizeof ( st ) ) ; cl_git_pass ( git_status_foreach ( g_repo , cb_status__single , & st ) ) ; cl_assert_equal_i ( 3 , st . count ) ; cl_git_pass ( git_status_file ( & st . status , g_repo , "test/ignore_me/file" ) ) ; cl_assert ( st . status == GIT_STATUS_IGNORED ) ; assert_is_ignored ( "test/ignore_me/file" ) ; } 