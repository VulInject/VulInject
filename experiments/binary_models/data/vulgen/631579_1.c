static int query_mf_symlink ( const unsigned int xid , struct cifs_tcon * tcon , struct cifs_sb_info * cifs_sb , const unsigned char * path , char * * symlinkinfo ) { int rc ; u8 * buf = NULL ; unsigned int link_len = 0 ; unsigned int bytes_read = 0 ; buf = kmalloc ( CIFS_MF_SYMLINK_FILE_SIZE , GFP_KERNEL ) ; if ( tcon -> ses -> server -> ops -> query_mf_symlink ) { rc = tcon -> ses -> server -> ops -> query_mf_symlink ( xid , tcon , cifs_sb , path , buf , & bytes_read ) ; } else { rc = - ENOSYS ; } if ( rc ) { out } if ( bytes_read == 0 ) { rc = - EINVAL ; out } rc = parse_mf_symlink ( buf , bytes_read , & link_len , symlinkinfo ) ; out kfree ( buf ) ; return rc ; } 