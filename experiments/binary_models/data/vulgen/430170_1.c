errcode_t profile_parse_file ( FILE * f , struct profile_node * * root , char * * ret_modspec ) { struct parse_state state ; errcode_t retval ; * root = NULL ; state . state = STATE_INIT_COMMENT ; state . group_level = 0 ; state . current_section = NULL ; retval = profile_create_node ( "(root)" , 0 , & state . root_section ) ; if ( retval ) { return retval ; } if ( retval ) { profile_free_node ( state . root_section ) ; return retval ; } * root = state . root_section ; return 0 ; } 