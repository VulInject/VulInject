test_columns ( ) { Column columns [ ] { { "column1" "col1" "col1" 0 0 1 1 } { "install" "install" "install" 0 0 0 1 } { "helper" "helper" "helper" 0 0 1 0 } { "column2" "col2" "col2" 0 0 0 0 } { NULL } } ; ; Column * cols ; g_autofree char * help = NULL ; g_autoptr ( GError ) error = NULL ; const char * args [ 3 ] ; help = column_help ( columns ) ; g_assert_cmpstr ( help , == , "Available columns:\n" "  column1     col1\n" "  install     install\n" "  helper      helper\n" "  column2     col2\n" "  all         Show all columns\n" "  help        Show available columns\n" "\n" "Append :s[tart], :m[iddle], :e[nd] or :f[ull]to change ellipsization\n" ) ; cols = handle_column_args ( columns , FALSE , NULL , & error ) ; g_assert_no_error ( error ) ; g_assert_cmpstr ( cols [ 0 ] . name , == , "column1" ) ; g_assert_cmpstr ( cols [ 1 ] . name , == , "install" ) ; g_assert_null ( cols [ 2 ] . name ) ; cols = handle_column_args ( columns , TRUE , NULL , & error ) ; g_assert_no_error ( error ) ; g_assert_cmpstr ( cols [ 0 ] . name , == , "column1" ) ; g_assert_cmpstr ( cols [ 1 ] . name , == , "install" ) ; g_assert_cmpstr ( cols [ 2 ] . name , == , "helper" ) ; g_assert_null ( cols [ 3 ] . name ) ; g_free ( cols ) ; args [ 0 ] = "all" ; args [ 1 ] = NULL ; cols = handle_column_args ( columns , FALSE , args , & error ) ; g_assert_no_error ( error ) ; g_assert_cmpstr ( cols [ 0 ] . name , == , "column1" ) ; g_assert_cmpstr ( cols [ 1 ] . name , == , "install" ) ; g_assert_cmpstr ( cols [ 2 ] . name , == , "helper" ) ; g_assert_null ( cols [ 3 ] . name ) ; g_free ( cols ) ; args [ 0 ] = "column1,column2" ; args [ 1 ] = "helper" ; args [ 2 ] = NULL ; cols = handle_column_args ( columns , FALSE , args , & error ) ; g_assert_no_error ( error ) ; g_assert_cmpstr ( cols [ 0 ] . name , == , "column1" ) ; g_assert_cmpstr ( cols [ 1 ] . name , == , "column2" ) ; g_assert_cmpstr ( cols [ 2 ] . name , == , "helper" ) ; g_assert_null ( cols [ 3 ] . name ) ; g_free ( cols ) ; args [ 0 ] = "column" ; args [ 1 ] = NULL ; cols = handle_column_args ( columns , FALSE , args , & error ) ; g_assert_null ( cols ) ; g_assert_error ( error , G_IO_ERROR , G_IO_ERROR_FAILED ) ; g_clear_error ( & error ) ; args [ 0 ] = "app" ; args [ 1 ] = NULL ; cols = handle_column_args ( columns , FALSE , args , & error ) ; g_assert_null ( cols ) ; g_assert_error ( error , G_IO_ERROR , G_IO_ERROR_FAILED ) ; g_clear_error ( & error ) ; } 