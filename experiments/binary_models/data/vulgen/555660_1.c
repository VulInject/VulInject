void sv_inactive ( vnode_t * vp ) { svnode_t * svp ; rnode4_t * rp ; vnode_t * mvp ; sv_stats . sv_inactive ++ ; svp = VTOSV ( vp ) ; rp = VTOR4 ( vp ) ; mvp = rp -> r_vnode ; ASSERT ( mvp != vp ) ; mutex_enter ( & rp -> r_svlock ) ; mutex_enter ( & vp -> v_lock ) ; if ( vp -> v_count > 1 ) { VN_RELE_LOCKED ( vp ) ; mutex_exit ( & vp -> v_lock ) ; mutex_exit ( & rp -> r_svlock ) ; return ; } remque ( svp ) ; mutex_exit ( & vp -> v_lock ) ; mutex_exit ( & rp -> r_svlock ) ; sv_uninit ( svp ) ; svp -> sv_forw = svp -> sv_back = NULL ; kmem_cache_free ( svnode_cache , svp ) ; vn_invalid ( vp ) ; VN_RELE ( mvp ) ; } 