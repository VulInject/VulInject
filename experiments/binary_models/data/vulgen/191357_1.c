remote_fileio_func_gettimeofday ( ) { LONGEST lnum ; CORE_ADDR ptrval ; int ret , retlength ; struct timeval tv ; struct fio_timeval ftv ; if ( remote_fileio_extract_long ( & buf , & lnum ) ) { remote_fileio_ioerror ( ) ; return ; } ptrval = ( CORE_ADDR ) lnum ; if ( remote_fileio_extract_long ( & buf , & lnum ) ) { remote_fileio_ioerror ( ) ; return ; } if ( lnum ) { remote_fileio_reply ( - 1 , FILEIO_EINVAL ) ; return ; } ret = gettimeofday ( & tv , NULL ) ; if ( ret == - 1 ) { remote_fileio_return_errno ( - 1 ) ; return ; } if ( ptrval ) { remote_fileio_to_fio_timeval ( & tv , & ftv ) ; retlength = remote_fileio_write_bytes ( ptrval , ( char * ) & ftv , sizeof ftv ) ; if ( retlength != sizeof ftv ) { remote_fileio_return_errno ( - 1 ) ; return ; } } remote_fileio_return_success ( ret ) ; } 