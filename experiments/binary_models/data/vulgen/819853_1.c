static krb5_error_code dec_wchar_pointer ( struct k5input * in , char * * out ) { const uint8_t * bytes ; uint32_t actual_count ; ( void ) k5_input_get_uint32_le ( in ) ; ( void ) k5_input_get_uint32_le ( in ) ; actual_count = k5_input_get_uint32_le ( in ) ; bytes = k5_input_get_bytes ( in , actual_count * 2 ) ; if ( bytes == NULL || k5_utf16le_to_utf8 ( bytes , actual_count * 2 , out ) != 0 ) { return EINVAL ; } if ( actual_count % 2 == 1 ) { ( void ) k5_input_get_uint16_le ( in ) ; } return 0 ; } 