extern popup_info_t * create_popup_info ( int type , int dest_type , char * title ) { GtkScrolledWindow * window = NULL , * grid_window = NULL ; GtkBin * bin = NULL ; GtkViewport * view = NULL ; GtkWidget * label = NULL ; GtkWidget * table = NULL ; GtkWidget * close_btn = NULL ; popup_info_t * popup_win = xmalloc ( sizeof ( popup_info_t ) ) ; list_push ( popup_list , popup_win ) ; popup_win -> spec_info = xmalloc ( sizeof ( specific_info_t ) ) ; popup_win -> spec_info -> search_info = xmalloc ( sizeof ( sview_search_info_t ) ) ; popup_win -> spec_info -> search_info -> search_type = 0 ; popup_win -> spec_info -> search_info -> int_data = NO_VAL ; popup_win -> spec_info -> search_info -> int_data2 = NO_VAL ; popup_win -> spec_info -> type = type ; popup_win -> spec_info -> title = xstrdup ( title ) ; popup_win -> popup = gtk_dialog_new_with_buttons ( title , GTK_WINDOW ( main_window ) , GTK_DIALOG_DESTROY_WITH_PARENT , GTK_STOCK_REFRESH , GTK_RESPONSE_OK , NULL ) ; close_btn = gtk_dialog_add_button ( GTK_DIALOG ( popup_win -> popup ) , GTK_STOCK_CLOSE , GTK_RESPONSE_CLOSE ) ; gtk_window_set_type_hint ( GTK_WINDOW ( popup_win -> popup ) , GDK_WINDOW_TYPE_HINT_NORMAL ) ; gtk_window_set_focus ( GTK_WINDOW ( popup_win -> popup ) , close_btn ) ; gtk_dialog_add_button ( GTK_DIALOG ( popup_win -> popup ) , "Close All Popups" , GTK_RESPONSE_CANCEL ) ; popup_win -> show_grid = 1 ; popup_win -> toggled = 0 ; popup_win -> force_refresh = 0 ; popup_win -> type = dest_type ; popup_win -> not_found = false ; gtk_window_set_default_size ( GTK_WINDOW ( popup_win -> popup ) , working_sview_config . fi_popup_width , working_sview_config . fi_popup_height ) ; gtk_window_set_transient_for ( GTK_WINDOW ( popup_win -> popup ) , NULL ) ; popup_win -> event_box = gtk_event_box_new ( ) ; label = gtk_label_new ( popup_win -> spec_info -> title ) ; gtk_container_add ( GTK_CONTAINER ( popup_win -> event_box ) , label ) ; g_signal_connect ( G_OBJECT ( popup_win -> event_box ) , "button-press-event" , G_CALLBACK ( redo_popup ) , popup_win ) ; gtk_event_box_set_above_child ( GTK_EVENT_BOX ( popup_win -> event_box ) , false ) ; gtk_box_pack_start ( GTK_BOX ( GTK_DIALOG ( popup_win -> popup ) -> vbox ) , popup_win -> event_box , false , false , 0 ) ; grid_window = create_scrolled_window ( ) ; gtk_scrolled_window_set_policy ( grid_window , GTK_POLICY_NEVER , GTK_POLICY_AUTOMATIC ) ; bin = GTK_BIN ( & grid_window -> container ) ; view = GTK_VIEWPORT ( bin -> child ) ; bin = GTK_BIN ( & view -> bin ) ; popup_win -> grid_table = GTK_TABLE ( bin -> child ) ; popup_win -> grid_button_list = NULL ; table = gtk_table_new ( 1 , 2 , false ) ; gtk_table_attach ( GTK_TABLE ( table ) , GTK_WIDGET ( grid_window ) , 0 , 1 , 0 , 1 , GTK_SHRINK , GTK_EXPAND | GTK_FILL , 0 , 0 ) ; window = create_scrolled_window ( ) ; bin = GTK_BIN ( & window -> container ) ; view = GTK_VIEWPORT ( bin -> child ) ; bin = GTK_BIN ( & view -> bin ) ; popup_win -> table = GTK_TABLE ( bin -> child ) ; gtk_table_attach_defaults ( GTK_TABLE ( table ) , GTK_WIDGET ( window ) , 1 , 2 , 0 , 1 ) ; gtk_box_pack_start ( GTK_BOX ( GTK_DIALOG ( popup_win -> popup ) -> vbox ) , table , true , true , 0 ) ; g_signal_connect ( G_OBJECT ( popup_win -> popup ) , "delete_event" , G_CALLBACK ( delete_popup ) , popup_win -> spec_info -> title ) ; g_signal_connect ( G_OBJECT ( popup_win -> popup ) , "response" , G_CALLBACK ( _handle_response ) , popup_win ) ; g_signal_connect ( G_OBJECT ( popup_win -> popup ) , "configure-event" , G_CALLBACK ( _frame_callback ) , popup_win ) ; gtk_window_move ( GTK_WINDOW ( popup_win -> popup ) , popup_pos . x , popup_pos . y ) ; gtk_widget_show_all ( popup_win -> popup ) ; if ( cluster_flags & CLUSTER_FLAG_FED ) { gtk_widget_hide ( GTK_WIDGET ( grid_window ) ) ; } return popup_win ; } 