static cmi_errno_t inb_patounum ( void * arg , uint64_t pa , uint8_t valid_hi , uint8_t valid_lo , uint32_t synd , int syndtype , mc_unum_t * unump ) { struct rank_base * rp ; int i ; int last ; uint64_t offset ; cmi_errno_t rt = CMIERR_UNKNOWN ; for ( i = 0 ; i < last ; i ++ ) { rp = & rank_base [ i ] ; if ( rp && pa >= rp -> base && pa < rp -> limit ) { break ; } } if ( i < last ) { offset = pa - rp -> base ; if ( offset > rp -> hole ) { offset -= rp -> hole_size ; } unump -> unum_offset = offset / rp -> interleave ; unump -> unum_mc = i / nb_dimms_per_channel ; unump -> unum_cs = 0 ; unump -> unum_rank = i % nb_dimms_per_channel ; rt = CMI_SUCCESS ; } return ( rt ) ; } 