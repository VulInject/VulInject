ordered_list_node * ordered_list_add_node ( ordered_list_handle * handle , void * data ) { if ( handle == NULL ) { pcep_log ( LOG_WARNING , "%s: ordered_list_add_node, the list has not been initialized" , __func__ ) ; return NULL ; } handle -> num_entries ++ ; ordered_list_node * new_node = pceplib_malloc ( PCEPLIB_INFRA , sizeof ( ordered_list_node ) ) ; new_node -> data = data ; new_node -> next_node = NULL ; if ( handle -> head == NULL ) { handle -> head = new_node ; return new_node ; } ordered_list_node * prev_node = handle -> head ; ordered_list_node * node = prev_node ; int compare_result ; while ( node != NULL ) { compare_result = handle -> compare_function ( node -> data , data ) ; if ( compare_result < 0 ) { new_node -> next_node = node ; if ( handle -> head == node ) { handle -> head = new_node ; } else { prev_node -> next_node = new_node ; } return new_node ; } prev_node = node ; node = node -> next_node ; } prev_node -> next_node = new_node ; return new_node ; } 