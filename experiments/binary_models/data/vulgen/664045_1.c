static int FDECL3 ( parse_rr , unsigned char * , pnt , int , len , struct directory_entry * , dpnt ) { int cont_extent , cont_offset , cont_size ; char name_buf [ 256 ] ; cont_extent = cont_offset = cont_size = 0 ; while ( len >= 4 ) { if ( pnt [ 3 ] != 1 ) { fprintf ( stderr , "**BAD RRVERSION" ) ; return - 1 ; } if ( strncmp ( ( char * ) pnt , "NM" , 2 ) == 0 ) { strncpy ( name_buf , ( char * ) pnt + 5 , pnt [ 2 ] - 5 ) ; name_buf [ pnt [ 2 ] - 5 ] = 0 ; dpnt -> name = strdup ( name_buf ) ; dpnt -> got_rr_name = 1 ; return 0 ; } if ( strncmp ( ( char * ) pnt , "CE" , 2 ) == 0 ) { cont_extent = isonum_733 ( pnt + 4 ) ; cont_offset = isonum_733 ( pnt + 12 ) ; cont_size = isonum_733 ( pnt + 20 ) ; } pnt += pnt [ 2 ] ; if ( len <= 3 && cont_extent ) { unsigned char sector [ SECTOR_SIZE ] ; readsecs ( cont_extent , sector , 1 ) ; parse_rr ( & sector [ cont_offset ] , cont_size , dpnt ) ; } } if ( dpnt -> name == NULL ) { char * cp ; strcpy ( name_buf , dpnt -> isorec . name ) ; cp = strchr ( name_buf , ';' ) ; if ( cp != NULL ) { * cp = '\0' ; } dpnt -> name = strdup ( name_buf ) ; } return 0 ; } 