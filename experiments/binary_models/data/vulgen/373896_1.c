static void rxrpc_activate_one_channel ( struct rxrpc_connection * conn , unsigned int channel ) { struct rxrpc_channel * chan = & conn -> channels [ channel ] ; struct rxrpc_bundle * bundle = conn -> bundle ; struct rxrpc_call * call = list_entry ( bundle -> waiting_calls . next , rxrpc_call , wait_link ) ; u32 call_id = chan -> call_counter + 1 ; _enter ( "C=%x,%u" , conn -> debug_id , channel ) ; list_del_init ( & call -> wait_link ) ; trace_rxrpc_client ( conn , channel , rxrpc_client_chan_activate ) ; clear_bit ( RXRPC_CONN_FINAL_ACK_0 + channel , & conn -> flags ) ; clear_bit ( conn -> bundle_shift + channel , & bundle -> avail_chans ) ; rxrpc_see_call ( call , rxrpc_call_see_activate_client ) ; call -> conn = rxrpc_get_connection ( conn , rxrpc_conn_get_activate_call ) ; call -> cid = conn -> proto . cid | channel ; call -> call_id = call_id ; call -> dest_srx . srx_service = conn -> service_id ; call -> cong_ssthresh = call -> peer -> cong_ssthresh ; if ( call -> cong_cwnd >= call -> cong_ssthresh ) { call -> cong_mode = RXRPC_CALL_CONGEST_AVOIDANCE ; } else { call -> cong_mode = RXRPC_CALL_SLOW_START ; } chan -> call_id = call_id ; chan -> call_debug_id = call -> debug_id ; chan -> call = call ; rxrpc_see_call ( call , rxrpc_call_see_connected ) ; trace_rxrpc_connect_call ( call ) ; rxrpc_start_call_timer ( call ) ; rxrpc_set_call_state ( call , RXRPC_CALL_CLIENT_SEND_REQUEST ) ; wake_up ( & call -> waitq ) ; } 