static void save_struct ( const RAnal * anal , const RAnalBaseType * type ) { r_return_if_fail ( anal && type && type -> name && type -> kind == R_ANAL_BASE_TYPE_KIND_STRUCT ) ; char * kind = "struct" ; char * sname = r_str_sanitize_sdb_key ( type -> name ) ; sdb_set ( anal -> sdb_types , sname , kind , 0 ) ; RStrBuf * arglist = r_strbuf_new ( "" ) ; int i = 0 ; RAnalStructMember * member ; r_vector_foreach ( , ) { char * member_sname = r_str_sanitize_sdb_key ( member -> name ) ; r_strf_var ( k , KSZ , "%s.%s.%s" , kind , sname , member_sname ) ; r_strf_var ( v , KSZ , "%s,%u,0" , member -> type , ( unsigned int ) member -> offset ) ; sdb_set ( anal -> sdb_types , k , v , 0 ) ; free ( member_sname ) ; r_strbuf_appendf ( arglist , ( i ++ == 0 ) ?"%s" : ",%s" , member -> name ) ; } char * key = r_str_newf ( "%s.%s" , kind , sname ) ; sdb_set_owned ( anal -> sdb_types , key , r_strbuf_drain ( arglist ) , 0 ) ; free ( key ) ; } 