static void * vmem_sbrk_tryfail ( vmem_t * src , size_t size , int vmflags ) { sbrk_fail_t * fp ; ( void ) mutex_lock ( & sbrk_faillock ) ; for ( fp = sbrk_fails . sf_next ; fp != & sbrk_fails ; fp = fp -> sf_next ) { if ( fp -> sf_size >= size ) { fp -> sf_next -> sf_prev = fp -> sf_prev ; fp -> sf_prev -> sf_next = fp -> sf_next ; fp -> sf_next = fp -> sf_prev = NULL ; break ; } } ( void ) mutex_unlock ( & sbrk_faillock ) ; if ( fp != & sbrk_fails ) { return ( vmem_sbrk_extend_alloc ( src , fp , fp -> sf_size , size , vmflags ) ) ; } return ( NULL ) ; } 