void squashfs_decompressor_destroy ( struct squashfs_sb_info * msblk ) { struct squashfs_stream * stream = msblk -> stream ; if ( stream ) { struct decomp_stream * decomp_strm ; while ( ! list_empty ( & stream -> strm_list ) ) { decomp_strm = list_entry ( stream -> strm_list . prev , decomp_stream , list ) ; list_del ( & decomp_strm -> list ) ; msblk -> decompressor -> free ( decomp_strm -> stream ) ; kfree ( decomp_strm ) ; stream -> avail_decomp -- ; } WARN_ON ( stream -> avail_decomp ) ; kfree ( stream ) ; } } 