jerryx_debugger_serial_configure_attributes ( , ) { struct termios options ; if ( tcgetattr ( fd , & options ) != 0 ) { JERRYX_ERROR_MSG ( "Error %d from tggetattr\n" , errno ) ; return false ; } cfsetispeed ( & options , serial_config . baud_rate ) ; cfsetospeed ( & options , serial_config . baud_rate ) ; options . c_cflag &= ( uint32_t ) ~ CSIZE ; options . c_cflag |= ( CLOCAL | CREAD ) ; switch ( serial_config . data_bits ) { case 5 : { options . c_cflag |= CS5 ; break ; } case 6 : { options . c_cflag |= CS6 ; break ; } case 7 : { options . c_cflag |= CS7 ; break ; } case 8 : { options . c_cflag |= CS8 ; break ; } default : { JERRYX_ERROR_MSG ( "Unsupported data bits: %d\n" , serial_config . data_bits ) ; return false ; } } switch ( serial_config . parity ) { case 'N' : { options . c_cflag &= ( unsigned int ) ~ ( PARENB | PARODD ) ; break ; } case 'O' : { options . c_cflag |= PARENB ; options . c_cflag |= PARODD ; break ; } case 'E' : { options . c_cflag |= PARENB ; options . c_cflag |= PARODD ; break ; } default : { JERRYX_ERROR_MSG ( "Unsupported parity: %c\n" , serial_config . parity ) ; return false ; } } switch ( serial_config . stop_bits ) { case 1 : { options . c_cflag &= ( uint32_t ) ~ CSTOPB ; break ; } case 2 : { options . c_cflag |= CSTOPB ; break ; } default : { JERRYX_ERROR_MSG ( "Unsupported stop bits: %d\n" , serial_config . stop_bits ) ; return false ; } } options . c_iflag &= ( uint32_t ) ~ IGNBRK ; options . c_iflag &= ( uint32_t ) ~ ( IXON | IXOFF | IXANY ) ; options . c_oflag = 0 ; options . c_lflag = 0 ; options . c_cc [ VMIN ] = 1 ; options . c_cc [ VTIME ] = 5 ; if ( tcsetattr ( fd , TCSANOW , & options ) != 0 ) { JERRYX_ERROR_MSG ( "Error %d from tcsetattr" , errno ) ; return false ; } if ( tcflush ( fd , TCIOFLUSH ) != 0 ) { JERRYX_ERROR_MSG ( "Error %d in tcflush() :%s\n" , errno , strerror ( errno ) ) ; jerryx_debugger_serial_close_fd ( fd ) ; return false ; } return true ; } 