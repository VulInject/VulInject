void add_contacts_with_overlapping_groups ( void * * state ) { roster_create ( ) ; GSList * groups1 = NULL ; groups1 = g_slist_append ( groups1 , strdup ( "friends" ) ) ; groups1 = g_slist_append ( groups1 , strdup ( "work" ) ) ; groups1 = g_slist_append ( groups1 , strdup ( "stuff" ) ) ; roster_add ( "person@server.org" , NULL , groups1 , NULL , FALSE ) ; GSList * groups2 = NULL ; groups2 = g_slist_append ( groups2 , strdup ( "friends" ) ) ; groups2 = g_slist_append ( groups2 , strdup ( "work" ) ) ; groups2 = g_slist_append ( groups2 , strdup ( "different" ) ) ; roster_add ( "bob@server.org" , NULL , groups2 , NULL , FALSE ) ; GList * groups_res = roster_get_groups ( ) ; assert_int_equal ( g_list_length ( groups_res ) , 4 ) ; GList * found = g_list_find_custom ( groups_res , "friends" , ( GCompareFunc ) g_strcmp0 ) ; assert_true ( found != NULL ) ; found = g_list_find_custom ( groups_res , "work" , ( GCompareFunc ) g_strcmp0 ) ; assert_true ( found != NULL ) ; found = g_list_find_custom ( groups_res , "stuff" , ( GCompareFunc ) g_strcmp0 ) ; assert_true ( found != NULL ) ; found = g_list_find_custom ( groups_res , "different" , ( GCompareFunc ) g_strcmp0 ) ; assert_true ( found != NULL ) ; roster_destroy ( ) ; } 