switch ( addr ) { case NAND_DATA + 0 : case NAND_DATA + 1 : case NAND_DATA + 2 : case NAND_DATA + 3 : nand_setio ( s -> flash , value ) ; s -> nand . isr |= 1 ; tc6393xb_nand_irq ( s ) ; return ; case NAND_MODE : s -> nand . mode = value ; switch ( value & NAND_MODE_ECC_MASK ) { case NAND_MODE_ECC_RST : ecc_reset ( & s -> ecc ) ; break ; case NAND_MODE_ECC_READ : break ; case NAND_MODE_ECC_EN : ecc_reset ( & s -> ecc ) ; } return ; case NAND_ISR : s -> nand . isr = value ; tc6393xb_nand_irq ( s ) ; return ; case NAND_IMR : s -> nand . imr = value ; tc6393xb_nand_irq ( s ) ; return ; } fprintf ( stderr , "tc6393xb_nand: unhandled write at %08x: %02x\n" , ( uint32_t ) addr , value & 0xff ) ; 