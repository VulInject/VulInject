void immu_qinv_intr_caches ( immu_t * immu , uint_t iidx , uint_t cnt , immu_inv_wait_t * iwp ) { uint_t i , mask = 0 ; ASSERT ( cnt != 0 ) ; if ( ! ISP2 ( cnt ) ) { for ( i = 0 ; i < cnt ; i ++ ) { qinv_iec_common ( immu , iidx + cnt , 0 , IEC_INV_INDEX ) ; } return ; } while ( ( 2 << mask ) < cnt ) { mask ++ ; } if ( mask > IMMU_ECAP_GET_MHMV ( immu -> immu_regs_excap ) ) { for ( i = 0 ; i < cnt ; i ++ ) { qinv_iec_common ( immu , iidx + cnt , 0 , IEC_INV_INDEX ) ; } qinv_wait_sync ( immu , iwp ) ; return ; } qinv_iec_common ( immu , iidx , mask , IEC_INV_INDEX ) ; qinv_wait_sync ( immu , iwp ) ; } 