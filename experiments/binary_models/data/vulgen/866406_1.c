void set_huge_pte_at ( struct mm_struct * mm , unsigned long addr , pte_t * ptep , pte_t pte ) { unsigned long rste ; rste = __pte_to_rste ( pte ) ; if ( ( pte_val ( * ptep ) & _REGION_ENTRY_TYPE_MASK ) == _REGION_ENTRY_TYPE_R3 ) { if ( likely ( pte_present ( pte ) ) ) { rste |= _REGION3_ENTRY_LARGE ; } rste |= _REGION_ENTRY_TYPE_R3 ; } if ( likely ( pte_present ( pte ) ) ) { rste |= _SEGMENT_ENTRY_LARGE ; } clear_huge_pte_skeys ( mm , rste ) ; set_pte ( ptep , __pte ( rste ) ) ; } 