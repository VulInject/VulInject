static inline int pre_match_parse ( struct sip_msg * req , str * callid , str * ftag , str * ttag , int with_ttag ) { if ( get_to ( req ) -> tag_value . len == 0 ) { if ( with_ttag == 1 ) { return - 1 ; } else { ttag -> s = NULL ; ttag -> len = 0 ; } } else { * ttag = get_to ( req ) -> tag_value ; } if ( parse_from_header ( req ) < 0 || get_from ( req ) -> tag_value . len == 0 ) { LM_ERR ( "failed to get From header\n" ) ; return - 1 ; } * callid = req -> callid -> body ; trim ( callid ) ; * ftag = get_from ( req ) -> tag_value ; return 0 ; } 