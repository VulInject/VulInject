test_rename ( ) { int ret ; errno = 0 ; ret = rename ( FILENAME , RENAMED ) ; if ( ! ret ) { errno = 0 ; ret = stat ( FILENAME , & st ) ; if ( ret && errno == ENOENT ) { errno = 0 ; ret = stat ( RENAMED , & st ) ; printf ( "rename 1: ret = %d, errno = %d %s\n" , ret , errno , strerrno ( errno ) ) ; errno = 0 ; } else { printf ( "rename 1: ret = %d, errno = %d\n" , ret , errno ) ; } } else { printf ( "rename 1: ret = %d, errno = %d\n" , ret , errno ) ; } errno = 0 ; ret = rename ( RENAMED , TESTDIR2 ) ; printf ( "rename 2: ret = %d, errno = %d %s\n" , ret , errno , strerrno ( errno ) ) ; errno = 0 ; ret = rename ( TESTDIR2 , TESTDIR1 ) ; printf ( "rename 3: ret = %d, errno = %d %s\n" , ret , errno , strerrno ( errno ) ) ; errno = 0 ; ret = rename ( TESTDIR1 , TESTSUBDIR ) ; printf ( "rename 4: ret = %d, errno = %d %s\n" , ret , errno , strerrno ( errno ) ) ; errno = 0 ; ret = rename ( NONEXISTANT , FILENAME ) ; printf ( "rename 5: ret = %d, errno = %d %s\n" , ret , errno , strerrno ( errno ) ) ; } 