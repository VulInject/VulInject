static M_state_machine_status_t M_state_rcpt_to ( void * data , M_uint64 * next ) { M_net_smtp_session_t * session = data ; char * address = NULL ; address = M_list_str_take_last ( session -> tcp . rcpt_to ) ; M_buf_add_str ( session -> out_buf , "RCPT TO:<" ) ; M_buf_add_str ( session -> out_buf , address ) ; M_buf_add_str ( session -> out_buf , ">\r\n" ) ; * next = STATE_RCPT_TO_RESPONSE ; return M_STATE_MACHINE_STATUS_NEXT ; } 