static void sparc_disassemble ( unsigned int insn ) { int op_idx ; for ( op_idx = 0 ; op_idx < SPARC_NUM_OPCODES ; op_idx ++ ) { int i , flt , rd_flt ; if ( ( insn & op -> mask ) != op -> opcode ) { continue ; } flt = ( op -> name [ 0 ] == 'f' ) ; rd_flt = flt || ( op -> name [ 2 ] == 'f' ) ; Com_Printf ( "ASM: %7s\t" , op -> name ) ; for ( i = 0 ; op -> args [ i ] != ARG_NONE ; i ++ ) { switch ( op -> args [ i ] ) { case ARG_RS1 : pgreg ( ( insn >> 14 ) & 0x1f , i , flt ) ; break ; case ARG_RS2 : pgreg ( ( insn >> 0 ) & 0x1f , i , flt ) ; break ; case ARG_RD : pgreg ( ( insn >> 25 ) & 0x1f , i , rd_flt ) ; break ; case ARG_SIMM13 : pimm ( insn , 13 , 0 , 1 , i ) ; break ; case ARG_DISP30 : pimm ( insn , 30 , 0 , 0 , i ) ; break ; case ARG_IMM22 : pimm ( insn , 22 , 0 , 0 , i ) ; break ; case ARG_DISP22 : pimm ( insn , 22 , 0 , 0 , i ) ; break ; case ARG_SWTRAP : pimm ( insn , 7 , 0 , 0 , i ) ; break ; } } Com_Printf ( "\n" ) ; return ; } } 