void free_value ( struct val * vp ) { if ( vp -> type == string ) { free ( vp -> u . s ) ; } } int is_integer ( struct val * vp , int64_t * r , const char * * errstr ) { const char * errstrp ; if ( errstr == NULL ) { errstr = & errstrp ; } * errstr = NULL ; if ( vp -> type == integer ) { * r = vp -> u . i ; return 1 ; } * r = strtonum ( vp -> u . s , INT64_MIN , INT64_MAX , errstr ) ; return * errstr == NULL ; } 