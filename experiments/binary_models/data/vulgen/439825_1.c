static int dissect_BISPDU_ERROR ( tvbuff_t * tvb , int offset , proto_tree * tree ) { guint8 error_code = 0 ; gint data_length ; error_code = tvb_get_guint8 ( tvb , offset ) ; proto_tree_add_item ( tree , hf_idrp_error_code , tvb , offset , 1 , ENC_BIG_ENDIAN ) ; offset += 1 ; switch ( error_code ) { case IDRP_ERROR_OPEN : proto_tree_add_item ( tree , hf_idrp_error_open_subcode , tvb , offset , 1 , ENC_BIG_ENDIAN ) ; break ; case IDRP_ERROR_UPDATE : proto_tree_add_item ( tree , hf_idrp_error_update_subcode , tvb , offset , 1 , ENC_BIG_ENDIAN ) ; break ; case IDRP_ERROR_HOLD_TIMER : proto_tree_add_item ( tree , hf_idrp_error_hold_timer_subcode , tvb , offset , 1 , ENC_BIG_ENDIAN ) ; break ; case IDRP_ERROR_FSM : proto_tree_add_item ( tree , hf_idrp_error_fsm_subcode , tvb , offset , 1 , ENC_BIG_ENDIAN ) ; break ; case IDRP_ERROR_RIB_REFRESH : proto_tree_add_item ( tree , hf_idrp_error_rib_refresh_subcode , tvb , offset , 1 , ENC_BIG_ENDIAN ) ; break ; default : break ; } offset += 1 ; if ( data_length > 0 ) { proto_tree_add_item ( tree , hf_idrp_error_data , tvb , offset , data_length , ENC_NA ) ; offset += data_length ; } return offset ; } 