static int berlin_pwm_suspend ( struct device * dev ) { struct berlin_pwm_chip * bpc = dev_get_drvdata ( dev ) ; unsigned int i ; for ( i = 0 ; i < bpc -> chip . npwm ; i ++ ) { struct berlin_pwm_channel * channel ; channel = pwm_get_chip_data ( & bpc -> chip . pwms [ i ] ) ; channel -> enable = berlin_pwm_readl ( bpc , i , BERLIN_PWM_ENABLE ) ; channel -> ctrl = berlin_pwm_readl ( bpc , i , BERLIN_PWM_CONTROL ) ; channel -> duty = berlin_pwm_readl ( bpc , i , BERLIN_PWM_DUTY ) ; channel -> tcnt = berlin_pwm_readl ( bpc , i , BERLIN_PWM_TCNT ) ; } clk_disable_unprepare ( bpc -> clk ) ; return 0 ; } 