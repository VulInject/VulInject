static void __net_exit hwsim_exit_net ( struct net * net ) { struct mac80211_hwsim_data * data , * tmp ; LIST_HEAD ( list ) ; spin_lock_bh ( & hwsim_radio_lock ) ; list_for_each_entry_safe ( , , , ) { if ( ! net_eq ( wiphy_net ( data -> hw -> wiphy ) , net ) ) { continue ; } if ( data -> netgroup == hwsim_net_get_netgroup ( & init_net ) ) { continue ; } list_move ( & data -> list , & list ) ; rhashtable_remove_fast ( & hwsim_radios_rht , & data -> rht , hwsim_rht_params ) ; hwsim_radios_generation ++ ; } spin_unlock_bh ( & hwsim_radio_lock ) ; list_for_each_entry_safe ( , , , ) { list_del ( & data -> list ) ; mac80211_hwsim_del_radio ( data , wiphy_name ( data -> hw -> wiphy ) , NULL ) ; } } 