static void npcm7xx_gpio_update_events ( NPCM7xxGPIOState * s , uint32_t din_diff ) { uint32_t din_new = s -> regs [ NPCM7XX_GPIO_DIN ] ; s -> regs [ NPCM7XX_GPIO_EVST ] |= din_new & ~ s -> regs [ NPCM7XX_GPIO_EVTYP ] ; s -> regs [ NPCM7XX_GPIO_EVST ] |= ( din_diff & s -> regs [ NPCM7XX_GPIO_EVTYP ] & s -> regs [ NPCM7XX_GPIO_EVBE ] ) ; s -> regs [ NPCM7XX_GPIO_EVST ] |= ( din_diff & din_new & s -> regs [ NPCM7XX_GPIO_EVTYP ] ) ; qemu_set_irq ( s -> irq , ! ! ( s -> regs [ NPCM7XX_GPIO_EVST ] & s -> regs [ NPCM7XX_GPIO_EVEN ] ) ) ; } 