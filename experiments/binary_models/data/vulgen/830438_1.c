gimp_color_selection_init ( ) { GimpColorSelectionPrivate * priv ; GtkWidget * main_hbox ; GtkWidget * hbox ; GtkWidget * vbox ; GtkWidget * frame ; GtkWidget * label ; GtkWidget * entry ; GtkWidget * button ; GtkSizeGroup * new_group ; GtkSizeGroup * old_group ; selection -> priv = gimp_color_selection_get_instance_private ( selection ) ; priv = selection -> priv ; priv -> show_alpha = TRUE ; gtk_orientable_set_orientation ( GTK_ORIENTABLE ( selection ) , GTK_ORIENTATION_VERTICAL ) ; gimp_rgba_set ( & priv -> rgb , 0.0 , 0.0 , 0.0 , 1.0 ) ; gimp_rgb_to_hsv ( & priv -> rgb , & priv -> hsv ) ; priv -> channel = GIMP_COLOR_SELECTOR_RED ; main_hbox = gtk_box_new ( GTK_ORIENTATION_HORIZONTAL , 6 ) ; gtk_box_pack_start ( GTK_BOX ( selection ) , main_hbox , TRUE , TRUE , 0 ) ; gtk_widget_show ( main_hbox ) ; priv -> left_vbox = gtk_box_new ( GTK_ORIENTATION_VERTICAL , 6 ) ; gtk_box_pack_start ( GTK_BOX ( main_hbox ) , priv -> left_vbox , TRUE , TRUE , 0 ) ; gtk_widget_show ( priv -> left_vbox ) ; if ( _gimp_ensure_modules_func ) { g_type_class_ref ( GIMP_TYPE_COLOR_SELECT ) ; _gimp_ensure_modules_func ( ) ; } priv -> notebook = gimp_color_selector_new ( GIMP_TYPE_COLOR_NOTEBOOK , & priv -> rgb , & priv -> hsv , priv -> channel ) ; gimp_color_selector_set_toggles_visible ( GIMP_COLOR_SELECTOR ( priv -> notebook ) , FALSE ) ; gtk_box_pack_start ( GTK_BOX ( priv -> left_vbox ) , priv -> notebook , TRUE , TRUE , 0 ) ; gtk_widget_show ( priv -> notebook ) ; g_signal_connect ( priv -> notebook , "color-changed" , G_CALLBACK ( gimp_color_selection_notebook_changed ) , selection ) ; g_signal_connect ( gimp_color_notebook_get_notebook ( GIMP_COLOR_NOTEBOOK ( priv -> notebook ) ) , "switch-page" , G_CALLBACK ( gimp_color_selection_switch_page ) , selection ) ; hbox = gtk_box_new ( GTK_ORIENTATION_HORIZONTAL , 6 ) ; gtk_box_pack_end ( GTK_BOX ( priv -> left_vbox ) , hbox , FALSE , FALSE , 0 ) ; gtk_widget_show ( hbox ) ; vbox = gtk_box_new ( GTK_ORIENTATION_VERTICAL , 0 ) ; gtk_box_pack_start ( GTK_BOX ( hbox ) , vbox , FALSE , FALSE , 0 ) ; gtk_widget_show ( vbox ) ; label = gtk_label_new ( _ ( "Current:" ) ) ; gtk_label_set_xalign ( GTK_LABEL ( label ) , 1.0 ) ; gtk_box_pack_start ( GTK_BOX ( vbox ) , label , TRUE , TRUE , 0 ) ; gtk_widget_show ( label ) ; new_group = gtk_size_group_new ( GTK_SIZE_GROUP_VERTICAL ) ; gtk_size_group_add_widget ( new_group , label ) ; g_object_unref ( new_group ) ; label = gtk_label_new ( _ ( "Old:" ) ) ; gtk_label_set_xalign ( GTK_LABEL ( label ) , 1.0 ) ; gtk_box_pack_start ( GTK_BOX ( vbox ) , label , TRUE , TRUE , 0 ) ; gtk_widget_show ( label ) ; old_group = gtk_size_group_new ( GTK_SIZE_GROUP_VERTICAL ) ; gtk_size_group_add_widget ( old_group , label ) ; g_object_unref ( old_group ) ; frame = gtk_frame_new ( NULL ) ; gtk_frame_set_shadow_type ( GTK_FRAME ( frame ) , GTK_SHADOW_IN ) ; gtk_box_pack_start ( GTK_BOX ( hbox ) , frame , TRUE , TRUE , 0 ) ; gtk_widget_show ( frame ) ; vbox = gtk_box_new ( GTK_ORIENTATION_VERTICAL , 0 ) ; gtk_container_add ( GTK_CONTAINER ( frame ) , vbox ) ; gtk_widget_show ( vbox ) ; priv -> new_color = gimp_color_area_new ( & priv -> rgb , priv -> show_alpha ?GIMP_COLOR_AREA_SMALL_CHECKS : GIMP_COLOR_AREA_FLAT , GDK_BUTTON1_MASK | GDK_BUTTON2_MASK ) ; gtk_size_group_add_widget ( new_group , priv -> new_color ) ; gtk_box_pack_start ( GTK_BOX ( vbox ) , priv -> new_color , FALSE , FALSE , 0 ) ; gtk_widget_show ( priv -> new_color ) ; g_signal_connect ( priv -> new_color , "color-changed" , G_CALLBACK ( gimp_color_selection_new_color_changed ) , selection ) ; priv -> old_color = gimp_color_area_new ( & priv -> rgb , priv -> show_alpha ?GIMP_COLOR_AREA_SMALL_CHECKS : GIMP_COLOR_AREA_FLAT , GDK_BUTTON1_MASK | GDK_BUTTON2_MASK ) ; gtk_drag_dest_unset ( priv -> old_color ) ; gtk_size_group_add_widget ( old_group , priv -> old_color ) ; gtk_box_pack_start ( GTK_BOX ( vbox ) , priv -> old_color , FALSE , FALSE , 0 ) ; gtk_widget_show ( priv -> old_color ) ; priv -> right_vbox = gtk_box_new ( GTK_ORIENTATION_VERTICAL , 6 ) ; gtk_box_pack_start ( GTK_BOX ( main_hbox ) , priv -> right_vbox , TRUE , TRUE , 0 ) ; gtk_widget_show ( priv -> right_vbox ) ; priv -> scales = gimp_color_selector_new ( GIMP_TYPE_COLOR_SCALES , & priv -> rgb , & priv -> hsv , priv -> channel ) ; gimp_color_selector_set_toggles_visible ( GIMP_COLOR_SELECTOR ( priv -> scales ) , TRUE ) ; gimp_color_selector_set_show_alpha ( GIMP_COLOR_SELECTOR ( priv -> scales ) , priv -> show_alpha ) ; gtk_box_pack_start ( GTK_BOX ( priv -> right_vbox ) , priv -> scales , TRUE , TRUE , 0 ) ; gtk_widget_show ( priv -> scales ) ; g_signal_connect ( priv -> scales , "channel-changed" , G_CALLBACK ( gimp_color_selection_channel_changed ) , selection ) ; g_signal_connect ( priv -> scales , "color-changed" , G_CALLBACK ( gimp_color_selection_scales_changed ) , selection ) ; hbox = gtk_box_new ( GTK_ORIENTATION_HORIZONTAL , 6 ) ; gtk_box_pack_start ( GTK_BOX ( priv -> right_vbox ) , hbox , FALSE , FALSE , 0 ) ; gtk_widget_show ( hbox ) ; button = gimp_pick_button_new ( ) ; gtk_box_pack_end ( GTK_BOX ( hbox ) , button , FALSE , FALSE , 0 ) ; gtk_widget_show ( button ) ; g_signal_connect ( button , "color-picked" , G_CALLBACK ( gimp_color_selection_color_picked ) , selection ) ; entry = gimp_color_hex_entry_new ( ) ; gtk_box_pack_end ( GTK_BOX ( hbox ) , entry , TRUE , TRUE , 0 ) ; gtk_widget_show ( entry ) ; label = gtk_label_new_with_mnemonic ( _ ( "HTML _notation:" ) ) ; gtk_label_set_mnemonic_widget ( GTK_LABEL ( label ) , entry ) ; gtk_box_pack_end ( GTK_BOX ( hbox ) , label , FALSE , FALSE , 0 ) ; gtk_widget_show ( label ) ; g_object_set_data ( G_OBJECT ( selection ) , "color-hex-entry" , entry ) ; g_signal_connect ( entry , "color-changed" , G_CALLBACK ( gimp_color_selection_entry_changed ) , selection ) ; } 