static void scan_utmps ( ) { struct utmpx * utmpx ; int i ; dprintf ( ( "Scan utmps\n" ) ) ; setutxent ( ) ; while ( ( utmpx = getutxent ( ) ) != NULL ) { if ( utmpx -> ut_type == USER_PROCESS ) { if ( proc_is_alive ( utmpx -> ut_pid ) ) { if ( find_pid ( utmpx -> ut_pid , & i ) == 0 ) { add_pid ( utmpx -> ut_pid ) ; } } else { if ( find_pid ( utmpx -> ut_pid , & i ) == 1 ) { rem_pid ( utmpx -> ut_pid , i , CLEANIT ) ; } else { clean_utmpx_ent ( 0 ) ; } } } } endutxent ( ) ; } 