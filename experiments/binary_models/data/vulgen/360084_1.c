void rpc_call_text ( Client * client , const char * readbuf , int len ) { char buf [ 2048 ] ; json_t * request = NULL ; json_error_t jerr ; * buf = '\0' ; strlncpy ( buf , readbuf , sizeof ( buf ) , len ) ; request = json_loads ( buf , JSON_REJECT_DUPLICATES , & jerr ) ; if ( ! request ) { unreal_log ( ULOG_INFO , "rpc" , "RPC_INVALID_JSON" , client , "Received unparsable JSON request from $client" , log_data_string ( "json_incoming" , buf ) ) ; rpc_error ( client , NULL , JSON_RPC_ERROR_PARSE_ERROR , "Unparsable JSON data" ) ; return ; } rpc_call ( client , request ) ; json_decref ( request ) ; } 