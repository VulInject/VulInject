static void _scsih_determine_boot_device ( struct MPT3SAS_ADAPTER * ioc , void * device , u8 is_raid ) { struct _sas_device * sas_device ; struct _raid_device * raid_device ; u64 sas_address ; u64 device_name ; u64 enclosure_logical_id ; u16 slot ; if ( ! ioc -> bios_pg3 . BiosVersion ) { return ; } if ( ! is_raid ) { sas_device = device ; sas_address = sas_device -> sas_address ; device_name = sas_device -> device_name ; enclosure_logical_id = sas_device -> enclosure_logical_id ; slot = sas_device -> slot ; } else { raid_device = device ; sas_address = raid_device -> wwid ; device_name = 0 ; enclosure_logical_id = 0 ; slot = 0 ; } if ( ! ioc -> req_boot_device . device ) { if ( _scsih_is_boot_device ( sas_address , device_name , enclosure_logical_id , slot , ( ioc -> bios_pg2 . ReqBootDeviceForm & MPI2_BIOSPAGE2_FORM_MASK ) , & ioc -> bios_pg2 . RequestedBootDevice ) ) { dinitprintk ( ioc , pr_info ( MPT3SAS_FMT "%s: req_boot_device(0x%016llx)\n" , ioc -> name , __func__ , ( unsigned long long ) sas_address ) ) ; ioc -> req_boot_device . device = device ; ioc -> req_boot_device . is_raid = is_raid ; } } if ( ! ioc -> req_alt_boot_device . device ) { if ( _scsih_is_boot_device ( sas_address , device_name , enclosure_logical_id , slot , ( ioc -> bios_pg2 . ReqAltBootDeviceForm & MPI2_BIOSPAGE2_FORM_MASK ) , & ioc -> bios_pg2 . RequestedAltBootDevice ) ) { dinitprintk ( ioc , pr_info ( MPT3SAS_FMT "%s: req_alt_boot_device(0x%016llx)\n" , ioc -> name , __func__ , ( unsigned long long ) sas_address ) ) ; ioc -> req_alt_boot_device . device = device ; ioc -> req_alt_boot_device . is_raid = is_raid ; } } if ( ! ioc -> current_boot_device . device ) { if ( _scsih_is_boot_device ( sas_address , device_name , enclosure_logical_id , slot , ( ioc -> bios_pg2 . CurrentBootDeviceForm & MPI2_BIOSPAGE2_FORM_MASK ) , & ioc -> bios_pg2 . CurrentBootDevice ) ) { dinitprintk ( ioc , pr_info ( MPT3SAS_FMT "%s: current_boot_device(0x%016llx)\n" , ioc -> name , __func__ , ( unsigned long long ) sas_address ) ) ; ioc -> current_boot_device . device = device ; ioc -> current_boot_device . is_raid = is_raid ; } } } 