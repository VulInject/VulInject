static void vss_respond_to_host ( int error ) { struct icmsg_hdr * icmsghdrp ; u32 buf_len ; struct vmbus_channel * channel ; u64 req_id ; buf_len = vss_transaction . recv_len ; channel = vss_transaction . recv_channel ; req_id = vss_transaction . recv_req_id ; icmsghdrp = ( icmsg_hdr * ) & recv_buffer [ sizeof ( vmbuspipe_hdr ) ] ; icmsghdrp -> status = error ; icmsghdrp -> icflags = ICMSGHDRFLAG_TRANSACTION | ICMSGHDRFLAG_RESPONSE ; vmbus_sendpacket ( channel , recv_buffer , buf_len , req_id , VM_PKT_DATA_INBAND , 0 ) ; } 