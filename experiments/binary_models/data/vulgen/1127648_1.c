static InspectionBuffer * TlsCertsGetData ( DetectEngineThreadCtx * det_ctx , const DetectEngineTransforms * transforms , Flow * f , struct TlsCertsGetDataArgs * cbdata , int list_id ) { SCEnter ( ) ; InspectionBuffer * buffer = InspectionBufferMultipleForListGet ( det_ctx , list_id , cbdata -> local_id ) ; const SSLState * ssl_state = ( SSLState * ) f -> alstate ; const SSLStateConnp * connp ; if ( f -> flags & STREAM_TOSERVER ) { connp = & ssl_state -> client_connp ; } else { connp = & ssl_state -> server_connp ; } if ( TAILQ_EMPTY ( & connp -> certs ) ) { InspectionBufferSetupMultiEmpty ( buffer ) ; return NULL ; } if ( cbdata -> cert == NULL ) { cbdata -> cert = TAILQ_FIRST ( & connp -> certs ) ; } else { cbdata -> cert = TAILQ_NEXT ( cbdata -> cert , next ) ; } if ( cbdata -> cert == NULL ) { InspectionBufferSetupMultiEmpty ( buffer ) ; return NULL ; } InspectionBufferSetupMulti ( buffer , transforms , cbdata -> cert -> cert_data , cbdata -> cert -> cert_len ) ; SCReturnPtr ( buffer , "InspectionBuffer" ) ; } 