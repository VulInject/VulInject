static struct mlxsw_sp_acl_tcam_region * mlxsw_sp_acl_tcam_region_create ( struct mlxsw_sp * mlxsw_sp , struct mlxsw_sp_acl_tcam * tcam , struct mlxsw_afk_element_usage * elusage ) { struct mlxsw_afk * afk = mlxsw_sp_acl_afk ( mlxsw_sp -> acl ) ; struct mlxsw_sp_acl_tcam_region * region ; int err ; region = kzalloc ( sizeof ( * region ) , GFP_KERNEL ) ; INIT_LIST_HEAD ( & region -> chunk_list ) ; region -> mlxsw_sp = mlxsw_sp ; region -> parman = parman_create ( & mlxsw_sp_acl_tcam_region_parman_ops , region ) ; if ( ! region -> parman ) { err = - ENOMEM ; err_parman_create } region -> key_info = mlxsw_afk_key_info_get ( afk , elusage ) ; if ( IS_ERR ( region -> key_info ) ) { err = PTR_ERR ( region -> key_info ) ; err_key_info_get } err = mlxsw_sp_acl_tcam_region_id_get ( tcam , & region -> id ) ; if ( err ) { err_region_id_get } err = mlxsw_sp_acl_tcam_region_alloc ( mlxsw_sp , region ) ; if ( err ) { err_tcam_region_alloc } err = mlxsw_sp_acl_tcam_region_enable ( mlxsw_sp , region ) ; if ( err ) { err_tcam_region_enable } err = mlxsw_sp_acl_tcam_region_catchall_add ( mlxsw_sp , region ) ; if ( err ) { err_tcam_region_catchall_add } return region ; err_tcam_region_catchall_add mlxsw_sp_acl_tcam_region_disable ( mlxsw_sp , region ) ; err_tcam_region_enable mlxsw_sp_acl_tcam_region_free ( mlxsw_sp , region ) ; err_tcam_region_alloc mlxsw_sp_acl_tcam_region_id_put ( tcam , region -> id ) ; err_region_id_get mlxsw_afk_key_info_put ( region -> key_info ) ; err_key_info_get parman_destroy ( region -> parman ) ; err_parman_create kfree ( region ) ; return ERR_PTR ( err ) ; } 