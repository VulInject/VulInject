static void fw_caps_to_lmm ( enum fw_port_type port_type , fw_port_cap32_t fw_caps , unsigned long * link_mode_mask ) { { __set_bit ( ETHTOOL_LINK_MODE_ # # __lmm_name # # _BIT , link_mode_mask ) ; } 0 ; { } while ( 0 ) { switch ( port_type ) { case FW_PORT_TYPE_BT_SGMII : case FW_PORT_TYPE_BT_XFI : case FW_PORT_TYPE_BT_XAUI : SET_LMM ( TP ) ; FW_CAPS_TO_LMM ( SPEED_100M , 100baseT_Full ) ; FW_CAPS_TO_LMM ( SPEED_1G , 1000baseT_Full ) ; FW_CAPS_TO_LMM ( SPEED_10G , 10000baseT_Full ) ; break ; case FW_PORT_TYPE_KX4 : case FW_PORT_TYPE_KX : SET_LMM ( Backplane ) ; FW_CAPS_TO_LMM ( SPEED_1G , 1000baseKX_Full ) ; FW_CAPS_TO_LMM ( SPEED_10G , 10000baseKX4_Full ) ; break ; case FW_PORT_TYPE_KR : SET_LMM ( Backplane ) ; FW_CAPS_TO_LMM ( SPEED_10G , 10000baseKR_Full ) ; break ; case FW_PORT_TYPE_BP_AP : SET_LMM ( Backplane ) ; FW_CAPS_TO_LMM ( SPEED_1G , 1000baseKX_Full ) ; FW_CAPS_TO_LMM ( SPEED_10G , 10000baseR_FEC ) ; FW_CAPS_TO_LMM ( SPEED_10G , 10000baseKR_Full ) ; break ; case FW_PORT_TYPE_BP4_AP : SET_LMM ( Backplane ) ; FW_CAPS_TO_LMM ( SPEED_1G , 1000baseKX_Full ) ; FW_CAPS_TO_LMM ( SPEED_10G , 10000baseR_FEC ) ; FW_CAPS_TO_LMM ( SPEED_10G , 10000baseKR_Full ) ; FW_CAPS_TO_LMM ( SPEED_10G , 10000baseKX4_Full ) ; break ; case FW_PORT_TYPE_FIBER_XFI : case FW_PORT_TYPE_FIBER_XAUI : case FW_PORT_TYPE_SFP : case FW_PORT_TYPE_QSFP_10G : case FW_PORT_TYPE_QSA : SET_LMM ( FIBRE ) ; FW_CAPS_TO_LMM ( SPEED_1G , 1000baseT_Full ) ; FW_CAPS_TO_LMM ( SPEED_10G , 10000baseT_Full ) ; break ; case FW_PORT_TYPE_BP40_BA : case FW_PORT_TYPE_QSFP : SET_LMM ( FIBRE ) ; FW_CAPS_TO_LMM ( SPEED_1G , 1000baseT_Full ) ; FW_CAPS_TO_LMM ( SPEED_10G , 10000baseT_Full ) ; FW_CAPS_TO_LMM ( SPEED_40G , 40000baseSR4_Full ) ; break ; case FW_PORT_TYPE_CR_QSFP : case FW_PORT_TYPE_SFP28 : SET_LMM ( FIBRE ) ; FW_CAPS_TO_LMM ( SPEED_1G , 1000baseT_Full ) ; FW_CAPS_TO_LMM ( SPEED_10G , 10000baseT_Full ) ; FW_CAPS_TO_LMM ( SPEED_25G , 25000baseCR_Full ) ; break ; case FW_PORT_TYPE_KR_SFP28 : SET_LMM ( Backplane ) ; FW_CAPS_TO_LMM ( SPEED_1G , 1000baseT_Full ) ; FW_CAPS_TO_LMM ( SPEED_10G , 10000baseKR_Full ) ; FW_CAPS_TO_LMM ( SPEED_25G , 25000baseKR_Full ) ; break ; case FW_PORT_TYPE_KR_XLAUI : SET_LMM ( Backplane ) ; FW_CAPS_TO_LMM ( SPEED_1G , 1000baseKX_Full ) ; FW_CAPS_TO_LMM ( SPEED_10G , 10000baseKR_Full ) ; FW_CAPS_TO_LMM ( SPEED_40G , 40000baseKR4_Full ) ; break ; case FW_PORT_TYPE_CR2_QSFP : SET_LMM ( FIBRE ) ; FW_CAPS_TO_LMM ( SPEED_50G , 50000baseSR2_Full ) ; break ; case FW_PORT_TYPE_KR4_100G : case FW_PORT_TYPE_CR4_QSFP : SET_LMM ( FIBRE ) ; FW_CAPS_TO_LMM ( SPEED_1G , 1000baseT_Full ) ; FW_CAPS_TO_LMM ( SPEED_10G , 10000baseKR_Full ) ; FW_CAPS_TO_LMM ( SPEED_40G , 40000baseSR4_Full ) ; FW_CAPS_TO_LMM ( SPEED_25G , 25000baseCR_Full ) ; FW_CAPS_TO_LMM ( SPEED_50G , 50000baseCR2_Full ) ; FW_CAPS_TO_LMM ( SPEED_100G , 100000baseCR4_Full ) ; break ; default : break ; } } if ( fw_caps & FW_PORT_CAP32_FEC_V ( FW_PORT_CAP32_FEC_M ) ) { FW_CAPS_TO_LMM ( FEC_RS , FEC_RS ) ; FW_CAPS_TO_LMM ( FEC_BASER_RS , FEC_BASER ) ; } else { SET_LMM ( FEC_NONE ) ; } FW_CAPS_TO_LMM ( ANEG , Autoneg ) ; FW_CAPS_TO_LMM ( 802_3_PAUSE , Pause ) ; FW_CAPS_TO_LMM ( 802_3_ASM_DIR , Asym_Pause ) ; } 