static void print_elem ( FILE * fp , elem * e ) { elem p ; pkg_list * l ; char maj [ TYPESIZE ] , min [ TYPESIZE ] ; char perm [ 12 ] , ref_cnt [ 12 ] ; if ( ! check_majmin || e -> major == - 1 ) { maj [ 0 ] = '-' ; maj [ 1 ] = '\0' ; } else { ( void ) sprintf ( maj , "%d" , e -> major ) ; } if ( ! check_majmin || e -> minor == - 1 ) { min [ 0 ] = '-' ; min [ 1 ] = '\0' ; } else { ( void ) sprintf ( min , "%d" , e -> minor ) ; } if ( ! check_perm ) { perm [ 0 ] = '-' ; perm [ 1 ] = '\0' ; } else { ( void ) snprintf ( perm , sizeof ( perm ) , "%o" , e -> perm ) ; } if ( ! check_link ) { ref_cnt [ 0 ] = '-' ; ref_cnt [ 1 ] = '\0' ; } else { ( void ) snprintf ( ref_cnt , sizeof ( ref_cnt ) , "%d" , e -> ref_cnt ) ; } ( void ) fprintf ( fp , "%c %-30s %-20s %4s %-5s %-5s %6d %2s %2s %2s   " , e -> file_type , e -> name , check_sym && e -> symsrc != NULL ?e -> symsrc : "-" , perm , check_user ?e -> owner : "-" , check_group ?e -> group : "-" , e -> inode , ref_cnt , maj , min ) ; if ( ! e -> pkgs ) { ( void ) fputs ( " proto" , fp ) ; } for ( l = e -> pkgs ; l ; l = l -> next ) { ( void ) fputc ( ' ' , fp ) ; ( void ) fputs ( l -> pkg_name , fp ) ; } ( void ) fputc ( '\n' , fp ) ; } 