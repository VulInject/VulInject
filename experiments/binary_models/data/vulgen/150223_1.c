static const long double R5 = - 8.828896441624934385266096344596648080902E - 1L , R4 = 8.057002716646055371965756206836056074715E1L , R3 = - 2.024301798136027039250415126250455056397E3L , R2 = 2.048819892795278657810231591630928516206E4L , R1 = - 8.977257995689735303686582344659576526998E4L , R0 = 1.418134209872192732479751274970992665513E5L , S5 = - 1.186359407982897997337150403816839480438E2L , S4 = 3.998526750980007367835804959888064681098E3L , S3 = - 5.748542087379434595104154610899551484314E4L , S2 = 4.001557694070773974936904547424676279307E5L , S1 = - 1.332535117259762928288745111081235577029E6L , S0 = 1.701761051846631278975701529965589676574E6L ; static const long double C1 = 6.93145751953125E - 1L ; static const long double C2 = 1.428606820309417232121458176568075500134E - 6L ; static const long double sqrth = 0.7071067811865475244008443621048490392848L ; static const long double zero = 0.0L ; long double log1pl ( long double xm1 ) { long double x , y , z , r , s ; ieee_quad_shape_type u ; int e ; u . value = xm1 ; hx = u . parts32 . mswhi ; if ( hx >= 0x7fff0000 ) { return xm1 ; } if ( ( ( hx & 0x7fffffff ) == 0 ) && ( u . parts32 . mswlo | u . parts32 . lswhi | u . parts32 . lswlo ) == 0 ) { return xm1 ; } x = xm1 + 1.0L ; if ( x <= 0.0L ) { if ( x == 0.0L ) { return ( - 1.0L / ( x - x ) ) ; } else { return ( zero / ( x - x ) ) ; } } x = frexpl ( x , & e ) ; if ( ( e > 2 ) || ( e < - 2 ) ) { if ( x < sqrth ) { e -= 1 ; z = x - 0.5L ; y = 0.5L * z + 0.5L ; } else { z = x - 0.5L ; z -= 0.5L ; y = 0.5L * x + 0.5L ; } x = z / y ; z = x * x ; r = ( ( ( ( R5 * z + R4 ) * z + R3 ) * z + R2 ) * z + R1 ) * z + R0 ; s = ( ( ( ( ( z + S5 ) * z + S4 ) * z + S3 ) * z + S2 ) * z + S1 ) * z + S0 ; z = x * ( z * r / s ) ; z = z + e * C2 ; z = z + x ; z = z + e * C1 ; return ( z ) ; } if ( x < sqrth ) { e -= 1 ; if ( e != 0 ) { x = 2.0L * x - 1.0L ; } else { x = xm1 ; } } else { if ( e != 0 ) { x = x - 1.0L ; } else { x = xm1 ; } } z = x * x ; r = ( ( ( ( ( ( ( ( ( ( ( P12 * x + P11 ) * x + P10 ) * x + P9 ) * x + P8 ) * x + P7 ) * x + P6 ) * x + P5 ) * x + P4 ) * x + P3 ) * x + P2 ) * x + P1 ) * x + P0 ; s = ( ( ( ( ( ( ( ( ( ( ( x + Q11 ) * x + Q10 ) * x + Q9 ) * x + Q8 ) * x + Q7 ) * x + Q6 ) * x + Q5 ) * x + Q4 ) * x + Q3 ) * x + Q2 ) * x + Q1 ) * x + Q0 ; y = x * ( z * r / s ) ; y = y + e * C2 ; z = y - 0.5L * z ; z = z + x ; z = z + e * C1 ; return ( z ) ; } 