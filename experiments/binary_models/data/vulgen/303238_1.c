ssize_t vfs_listxattr ( struct dentry * dentry , char * list , size_t size ) { struct inode * inode = d_inode ( dentry ) ; ssize_t error ; error = security_inode_listxattr ( dentry ) ; if ( error ) { return error ; } if ( inode -> i_op -> listxattr && ( inode -> i_opflags & IOP_XATTR ) ) { error = - EOPNOTSUPP ; error = inode -> i_op -> listxattr ( dentry , list , size ) ; } else { if ( size && error > size ) { error = - ERANGE ; } } return error ; } 