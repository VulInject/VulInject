uint8_t gen_clock_data ( uint8_t clock , uint8_t prescaler , uint8_t data [ 4 ] ) { uint8_t i ; uint32_t data32 = 0x00000000 ; if ( ( prescaler != 0 ) && ( prescaler != 1 ) ) { return - 1 ; } uint32_t magic_const = 0x38 ; uint32_t prescaler1 = prescaler ; uint32_t clock1 = clock ; uint32_t prescaler2 = prescaler ; uint32_t clock2 = clock ; magic_const <<= 20 ; if ( prescaler == 1 ) { prescaler1 <<= 19 ; prescaler2 <<= 12 ; } clock1 <<= 13 ; clock2 <<= 6 ; data32 = magic_const | prescaler1 | clock1 | prescaler2 | clock2 ; for ( i = 0 ; i < 4 ; i ++ ) { data [ i ] = ( data32 >> ( 8 * ( 4 - i - 1 ) ) ) & 0xff ; } return 0 ; } 