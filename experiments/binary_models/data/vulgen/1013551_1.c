TEST_F_FORK ( , ) { const struct rule rules [ ] { { . path = dir_s1d2 . access = LANDLOCK_ACCESS_FS_EXECUTE } { } } ; ; const int ruleset_fd = create_ruleset ( _metadata , rules [ 0 ] . access , rules ) ; ASSERT_LE ( 0 , ruleset_fd ) ; copy_binary ( _metadata , file1_s1d1 ) ; copy_binary ( _metadata , file1_s1d2 ) ; copy_binary ( _metadata , file1_s1d3 ) ; enforce_ruleset ( _metadata , ruleset_fd ) ; ASSERT_EQ ( 0 , close ( ruleset_fd ) ) ; ASSERT_EQ ( 0 , test_open ( dir_s1d1 , O_RDONLY ) ) ; ASSERT_EQ ( 0 , test_open ( file1_s1d1 , O_RDONLY ) ) ; test_execute ( _metadata , EACCES , file1_s1d1 ) ; ASSERT_EQ ( 0 , test_open ( dir_s1d2 , O_RDONLY ) ) ; ASSERT_EQ ( 0 , test_open ( file1_s1d2 , O_RDONLY ) ) ; test_execute ( _metadata , 0 , file1_s1d2 ) ; ASSERT_EQ ( 0 , test_open ( dir_s1d3 , O_RDONLY ) ) ; ASSERT_EQ ( 0 , test_open ( file1_s1d3 , O_RDONLY ) ) ; } 