char getopt ( int argc , char * * argv , char * optstring ) { int c ; char * place ; static int optind = 0 ; static char * scan = NULL ; optarg = NULL ; if ( scan == NULL || * scan == '\0' ) { if ( optind == 0 ) { optind ++ ; } if ( optind >= argc ) { return ':' ; } optarg = place = argv [ optind ++ ] ; if ( place [ 0 ] != '-' || place [ 1 ] == '\0' ) { return '?' ; } if ( place [ 1 ] == '-' && place [ 2 ] == '\0' ) { return '?' ; } scan = place + 1 ; } c = * scan ++ ; place = strchr ( optstring , c ) ; if ( place == NULL || c == ':' || c == ';' ) { ( void ) fprintf ( stderr , "%s: unknown option %c\n" , argv [ 0 ] , c ) ; scan = NULL ; return '!' ; } if ( * ++ place == ':' ) { if ( * scan != '\0' ) { optarg = scan ; scan = NULL ; } else { optarg = argv [ optind ] ; optind ++ ; } } if ( * place == ';' ) { if ( * scan != '\0' ) { optarg = scan ; scan = NULL ; } else { if ( optind >= argc || * argv [ optind ] == '-' ) { optarg = NULL ; } else { optarg = argv [ optind ] ; optind ++ ; } } } return c ; } 