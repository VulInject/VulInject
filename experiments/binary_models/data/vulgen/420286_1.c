static uint_t srcid_nextid ( ip_stack_t * ipst ) { uint_t id ; srcid_map_t * * smpp ; if ( ! ipst -> ips_srcid_wrapped ) { id = ipst -> ips_ip_src_id ++ ; if ( ipst -> ips_ip_src_id == 0 ) { ipst -> ips_srcid_wrapped = B_TRUE ; } return ( id ) ; } for ( id = 0 ; id < 0xffffffff ; id ++ ) { smpp = srcid_lookup_id ( id , ipst ) ; if ( * smpp == NULL ) { return ( id ) ; } } panic ( "srcid_nextid: No free identifiers!" ) ; } 