void mpi_rshift ( MPI x , MPI a , unsigned int n ) { mpi_size_t xsize ; unsigned int i ; unsigned int nlimbs = ( n / BITS_PER_MPI_LIMB ) ; unsigned int nbits = ( n % BITS_PER_MPI_LIMB ) ; if ( x == a ) { if ( nlimbs >= x -> nlimbs ) { x -> nlimbs = 0 ; return ; } if ( nlimbs ) { for ( i = 0 ; i < x -> nlimbs - nlimbs ; i ++ ) { x -> d [ i ] = x -> d [ i + nlimbs ] ; } x -> d [ i ] = 0 ; x -> nlimbs -= nlimbs ; } if ( x -> nlimbs && nbits ) { mpihelp_rshift ( x -> d , x -> d , x -> nlimbs , nbits ) ; } } if ( nlimbs ) { xsize = a -> nlimbs ; x -> sign = a -> sign ; RESIZE_IF_NEEDED ( x , xsize ) ; x -> nlimbs = xsize ; for ( i = 0 ; i < a -> nlimbs ; i ++ ) { x -> d [ i ] = a -> d [ i ] ; } x -> nlimbs = i ; if ( nlimbs >= x -> nlimbs ) { x -> nlimbs = 0 ; return ; } if ( nlimbs ) { for ( i = 0 ; i < x -> nlimbs - nlimbs ; i ++ ) { x -> d [ i ] = x -> d [ i + nlimbs ] ; } x -> d [ i ] = 0 ; x -> nlimbs -= nlimbs ; } } else { xsize = a -> nlimbs ; x -> sign = a -> sign ; RESIZE_IF_NEEDED ( x , xsize ) ; x -> nlimbs = xsize ; if ( xsize ) { if ( nbits ) { mpihelp_rshift ( x -> d , a -> d , x -> nlimbs , nbits ) ; } else { for ( i = 0 ; i < x -> nlimbs ; i ++ ) { x -> d [ i ] = a -> d [ i ] ; } } } } MPN_NORMALIZE ( x -> d , x -> nlimbs ) ; } 