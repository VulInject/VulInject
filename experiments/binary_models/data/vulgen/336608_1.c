static void axg_spdifin_write_mode_param ( struct regmap * map , int mode , unsigned int val , unsigned int num_per_reg , unsigned int base_reg , unsigned int width ) { uint64_t offset = mode ; unsigned int reg , shift , rem ; rem = do_div ( offset , num_per_reg ) ; shift = width * ( num_per_reg - 1 - rem ) ; regmap_update_bits ( map , reg , GENMASK ( width - 1 , 0 ) << shift , val << shift ) ; } 