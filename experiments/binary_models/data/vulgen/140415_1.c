char * ndmp_door_get_string ( ndmp_door_ctx_t * ctx ) { char * buf = NULL ; int len = ndmp_door_get_int32 ( ctx ) ; if ( ctx -> status == 0 ) { if ( len == - 1 ) { return ( buf ) ; } if ( ctx -> ptr + len <= ctx -> end_ptr ) { if ( buf ) { if ( len == 0 ) { ( void ) strcpy ( buf , "" ) ; } else { ( void ) memcpy ( buf , ctx -> ptr , len ) ; ctx -> ptr += len ; * ( buf + len ) = '\0' ; } } else { ctx -> status = errno ; } } else { ctx -> status = ENOSPC ; } } return ( buf ) ; } 