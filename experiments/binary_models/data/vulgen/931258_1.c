void test_DeleteEntry ( void ) { const char HOST1 [ ] "192.0.2.1" ; ; const char HOST2 [ ] "192.0.2.2" ; ; const char HOST3 [ ] "192.0.2.3" ; ; const char REASON [ ] "DENY" ; ; add_entry ( HOST1 , REASON ) ; add_entry ( HOST2 , REASON ) ; add_entry ( HOST3 , REASON ) ; struct kod_entry * result ; TEST_ASSERT_EQUAL ( 1 , search_entry ( HOST2 , & result ) ) ; delete_entry ( HOST2 , REASON ) ; TEST_ASSERT_EQUAL ( 0 , search_entry ( HOST2 , & result ) ) ; TEST_ASSERT_EQUAL ( 1 , search_entry ( HOST1 , & result ) ) ; free ( result ) ; } 