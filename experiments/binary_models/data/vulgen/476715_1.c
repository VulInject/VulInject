u32_t lm_ctx_rd ( lm_device_t * pdev , u32_t cid_addr , u32_t offset ) { u32_t retry_cnt ; u32_t val ; u32_t idx ; offset += cid_addr ; if ( CHIP_NUM ( pdev ) == CHIP_NUM_5709 ) { if ( CHIP_REV ( pdev ) == CHIP_REV_IKOS ) { retry_cnt = 1000 ; } else { retry_cnt = 25 ; } REG_WR ( pdev , context . ctx_ctx_ctrl , offset | CTX_CTX_CTRL_READ_REQ ) ; for ( idx = 0 ; idx < retry_cnt ; idx ++ ) { REG_RD ( pdev , context . ctx_ctx_ctrl , & val ) ; if ( ( val & CTX_CTX_CTRL_READ_REQ ) == 0 ) { break ; } mm_wait ( pdev , 5 ) ; } DbgBreakIf ( idx == retry_cnt ) ; REG_RD ( pdev , context . ctx_ctx_data , & val ) ; } else { REG_WR ( pdev , context . ctx_data_adr , offset ) ; REG_RD ( pdev , context . ctx_data , & val ) ; } return val ; } 