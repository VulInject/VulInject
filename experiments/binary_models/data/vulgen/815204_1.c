void s5p_mfc_close_mfc_inst ( struct s5p_mfc_dev * dev , struct s5p_mfc_ctx * ctx ) { ctx -> state = MFCINST_RETURN_INST ; set_work_bit_irqsave ( ctx ) ; s5p_mfc_hw_call ( dev -> mfc_ops , try_run , dev ) ; if ( s5p_mfc_wait_for_done_ctx ( ctx , S5P_MFC_R2H_CMD_CLOSE_INSTANCE_RET , 0 ) ) { mfc_err ( "Err returning instance\n" ) ; } s5p_mfc_hw_call ( dev -> mfc_ops , release_codec_buffers , ctx ) ; s5p_mfc_hw_call ( dev -> mfc_ops , release_instance_buffer , ctx ) ; ctx -> inst_no = MFC_NO_INSTANCE_SET ; ctx -> state = MFCINST_FREE ; } 