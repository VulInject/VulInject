static int can_modify_feature ( struct btrfs_feature_attr * fa ) { int val = 0 ; u64 set , clear ; switch ( fa -> feature_set ) { case FEAT_COMPAT : set = BTRFS_FEATURE_COMPAT_SAFE_SET ; clear = BTRFS_FEATURE_COMPAT_SAFE_CLEAR ; break ; case FEAT_COMPAT_RO : set = BTRFS_FEATURE_COMPAT_RO_SAFE_SET ; clear = BTRFS_FEATURE_COMPAT_RO_SAFE_CLEAR ; break ; case FEAT_INCOMPAT : set = BTRFS_FEATURE_INCOMPAT_SAFE_SET ; clear = BTRFS_FEATURE_INCOMPAT_SAFE_CLEAR ; break ; default : pr_warn ( "btrfs: sysfs: unknown feature set %d\n" , fa -> feature_set ) ; return 0 ; } if ( set & fa -> feature_bit ) { val |= 1 ; } return val ; } 