static int test_one_file ( const char * file_name , format_list * formats , png_uint_32 opts , int stride_extra , int log_pass ) { int result ; Image image ; if ( ! ( opts & NO_RESEED ) ) { reseed ( ) ; } newimage ( & image ) ; initimage ( & image , opts , file_name , stride_extra ) ; result = read_one_file ( & image ) ; if ( result ) { result = testimage ( & image , opts , formats ) ; } fflush ( stderr ) ; if ( log_pass ) { if ( result ) { printf ( "PASS:" ) ; } else { printf ( "FAIL:" ) ; } printf ( " (no write)" ) ; print_opts ( opts ) ; printf ( " %s\n" , file_name ) ; fflush ( stdout ) ; } if ( ! result ) { exit ( 1 ) ; } return result ; } 