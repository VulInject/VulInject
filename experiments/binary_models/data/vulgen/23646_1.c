void TmqhOutputFlowHash ( ThreadVars * t , Packet * p ) void TmqhOutputFlowIPPair ( ThreadVars * t , Packet * p ) static void TmqhOutputFlowFTPHash ( ThreadVars * t , Packet * p ) void * TmqhOutputFlowSetupCtx ( const char * queue_str ) void TmqhOutputFlowFreeCtx ( void * ctx ) void TmqhFlowRegisterTests ( void ) void TmqhFlowRegister ( void ) { tmqh_table [ TMQH_FLOW ] . name = "flow" ; tmqh_table [ TMQH_FLOW ] . InHandler = TmqhInputFlow ; tmqh_table [ TMQH_FLOW ] . OutHandlerCtxSetup = TmqhOutputFlowSetupCtx ; tmqh_table [ TMQH_FLOW ] . OutHandlerCtxFree = TmqhOutputFlowFreeCtx ; tmqh_table [ TMQH_FLOW ] . RegisterTests = TmqhFlowRegisterTests ; if ( ConfGet ( "autofp-scheduler" , & scheduler ) == 1 ) { if ( strcasecmp ( scheduler , "round-robin" ) == 0 ) { SCLogNotice ( "using flow hash instead of round robin" ) ; tmqh_table [ TMQH_FLOW ] . OutHandler = TmqhOutputFlowHash ; } if ( strcasecmp ( scheduler , "active-packets" ) == 0 ) { SCLogNotice ( "using flow hash instead of active packets" ) ; tmqh_table [ TMQH_FLOW ] . OutHandler = TmqhOutputFlowHash ; } if ( strcasecmp ( scheduler , "hash" ) == 0 ) { tmqh_table [ TMQH_FLOW ] . OutHandler = TmqhOutputFlowHash ; } if ( strcasecmp ( scheduler , "ippair" ) == 0 ) { tmqh_table [ TMQH_FLOW ] . OutHandler = TmqhOutputFlowIPPair ; } if ( strcasecmp ( scheduler , "ftp-hash" ) == 0 ) { tmqh_table [ TMQH_FLOW ] . OutHandler = TmqhOutputFlowFTPHash ; } else { SCLogError ( "Invalid entry \"%s\" " "for autofp-scheduler in conf.  Killing engine." , scheduler ) ; exit ( EXIT_FAILURE ) ; } } else { tmqh_table [ TMQH_FLOW ] . OutHandler = TmqhOutputFlowHash ; } return ; } 