void ldom_reboot ( const char * boot_command ) { if ( boot_command && strlen ( boot_command ) ) { unsigned long len ; snprintf ( full_boot_str , sizeof ( full_boot_str ) , "boot %s" , boot_command ) ; if ( reboot_data_supported ) { unsigned long ra = kimage_addr_to_ra ( full_boot_str ) ; unsigned long hv_ret ; hv_ret = sun4v_reboot_data_set ( ra , len ) ; if ( hv_ret != HV_EOK ) { pr_err ( "SUN4V: Unable to set reboot data " "hv_ret=%lu\n" , hv_ret ) ; } } else { ldom_set_var ( "reboot-command" , full_boot_str ) ; } } sun4v_mach_sir ( ) ; } 