void camif_hw_set_effect ( struct camif_dev * camif , unsigned int effect , unsigned int cr , unsigned int cb ) { static const struct v4l2_control colorfx [ ] { { V4L2_COLORFX_NONE CIIMGEFF_FIN_BYPASS } { V4L2_COLORFX_BW CIIMGEFF_FIN_ARBITRARY } { V4L2_COLORFX_SEPIA CIIMGEFF_FIN_ARBITRARY } { V4L2_COLORFX_NEGATIVE CIIMGEFF_FIN_NEGATIVE } { V4L2_COLORFX_ART_FREEZE CIIMGEFF_FIN_ARTFREEZE } { V4L2_COLORFX_EMBOSS CIIMGEFF_FIN_EMBOSSING } { V4L2_COLORFX_SILHOUETTE CIIMGEFF_FIN_SILHOUETTE } { V4L2_COLORFX_SET_CBCR CIIMGEFF_FIN_ARBITRARY } } ; ; unsigned int i , cfg ; for ( i = 0 ; i < ARRAY_SIZE ( colorfx ) ; i ++ ) { if ( colorfx [ i ] . id == effect ) { break ; } } cfg = camif_read ( camif , S3C_CAMIF_REG_CIIMGEFF ( camif -> vp -> offset ) ) ; cfg &= ~ CIIMGEFF_FIN_MASK ; cfg |= colorfx [ i ] . value ; if ( camif -> variant -> ip_revision >= S3C6400_CAMIF_IP_REV ) { if ( effect == V4L2_COLORFX_NONE ) { cfg &= ~ CIIMGEFF_IE_ENABLE_MASK ; } else { cfg |= CIIMGEFF_IE_ENABLE_MASK ; } } cfg &= ~ CIIMGEFF_PAT_CBCR_MASK ; cfg |= cr | ( cb << 13 ) ; camif_write ( camif , S3C_CAMIF_REG_CIIMGEFF ( camif -> vp -> offset ) , cfg ) ; } 