static int _tree_listen_read ( eio_obj_t * obj , List objs ) { int sd ; slurm_addr_t addr ; socklen_t size = sizeof ( addr ) ; debug2 ( "mpi/pmi2: _tree_listen_read" ) ; while ( 1 ) { while ( ( sd = accept4 ( obj -> fd , ( sockaddr * ) & addr , & size , SOCK_CLOEXEC ) ) < 0 ) { if ( errno == EINTR ) { continue ; } if ( errno == EAGAIN ) { return 0 ; } if ( ( errno == ECONNABORTED ) || ( errno == EWOULDBLOCK ) ) { return 0 ; } error ( "mpi/pmi2: unable to accept new connection: %m" ) ; return 0 ; } if ( ! in_stepd ( ) ) { debug3 ( "mpi/pmi2: accepted tree connection: ip=%pA sd=%d" , & addr , sd ) ; } _handle_tree_request ( sd ) ; close ( sd ) ; } return 0 ; } 