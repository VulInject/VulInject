void smoke_think ( gentity_t * ent ) { gentity_t * tent ; ent -> nextthink = level . time + ent -> delay ; if ( ! ( ent -> spawnflags & 4 ) ) { return ; } if ( ent -> health ) { ent -> health -- ; if ( ! ent -> health ) { ent -> nextthink = level . time + FRAMETIME ; } } tent = G_TempEntity ( ent -> r . currentOrigin , EV_SMOKE ) ; VectorCopy ( ent -> r . currentOrigin , tent -> s . origin ) ; tent -> s . time = ent -> speed ; tent -> s . time2 = ent -> duration ; tent -> s . density = ent -> s . density ; tent -> s . angles2 [ 0 ] = ent -> start_size ; tent -> s . angles2 [ 1 ] = ent -> end_size ; tent -> s . angles2 [ 2 ] = ent -> wait ; VectorCopy ( ent -> pos3 , tent -> s . origin2 ) ; if ( ent -> s . frame ) { tent -> s . frame = 1 ; } } 