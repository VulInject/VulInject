static void SpaceOne ( CharView * cv , SplinePoint * sp ) { SplinePoint * prev , * next ; BasePoint v ; real len , off ; prev = sp -> prev -> from ; next = sp -> next -> to ; if ( prev == next ) { return ; } v . x = next -> me . x - prev -> me . x ; v . y = next -> me . y - prev -> me . y ; len = sqrt ( v . x * v . x + v . y * v . y ) ; if ( len == 0 ) { return ; } v . x /= len ; v . y /= len ; off = ( sp -> me . x - prev -> me . x ) * v . y - ( sp -> me . y - prev -> me . y ) * v . x ; new . x = ( next -> me . x + prev -> me . x ) / 2 + off * v . y ; new . y = ( next -> me . y + prev -> me . y ) / 2 - off * v . x ; CVPreserveState ( ( CharViewBase * ) cv ) ; SpAdjustTo ( sp , new . x , new . y ) ; SplineRefigure ( sp -> prev ) ; SplineRefigure ( sp -> next ) ; CVCharChangedUpdate ( & cv -> b ) ; } 