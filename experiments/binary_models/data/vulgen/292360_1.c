void c4iw_release_dev_ucontext ( struct c4iw_rdev * rdev , struct c4iw_dev_ucontext * uctx ) { struct list_head * pos , * nxt ; struct c4iw_qid_list * entry ; mutex_lock ( & uctx -> lock ) ; list_for_each_safe ( , , ) { entry = list_entry ( pos , c4iw_qid_list , entry ) ; list_del_init ( & entry -> entry ) ; if ( ! ( entry -> qid & rdev -> qpmask ) ) { c4iw_put_resource ( & rdev -> resource . qid_table , entry -> qid ) ; mutex_lock ( & rdev -> stats . lock ) ; rdev -> stats . qid . cur -= rdev -> qpmask + 1 ; mutex_unlock ( & rdev -> stats . lock ) ; } kfree ( entry ) ; } list_for_each_safe ( , , ) { entry = list_entry ( pos , c4iw_qid_list , entry ) ; list_del_init ( & entry -> entry ) ; kfree ( entry ) ; } } 