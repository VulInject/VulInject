static char * bgp_vpn_ip_print ( netdissect_options * ndo , const u_char * pptr , u_int addr_length ) { char * pos = addr ; switch ( addr_length ) { case ( sizeof ( nd_ipv4 ) << 3 ) : snprintf ( pos , sizeof ( addr ) , "%s" , GET_IPADDR_STRING ( pptr ) ) ; break ; case ( sizeof ( nd_ipv6 ) << 3 ) : snprintf ( pos , sizeof ( addr ) , "%s" , GET_IP6ADDR_STRING ( pptr ) ) ; break ; default : snprintf ( pos , sizeof ( addr ) , "bogus address length %u" , addr_length ) ; break ; } pos += strlen ( pos ) ; * ( pos ) = '\0' ; return ( addr ) ; } 