bgp_capability_vty_out ( , ) { char * pnt ; char * end ; struct capability_mp_data mpc ; struct capability_header * hdr ; pnt = peer -> notify . data ; end = pnt + peer -> notify . length ; while ( pnt < end ) { if ( pnt + sizeof ( capability_mp_data ) + 2 > end ) { return ; } hdr = ( capability_header * ) pnt ; if ( pnt + hdr -> length + 2 > end ) { return ; } memcpy ( & mpc , pnt + 2 , sizeof ( capability_mp_data ) ) ; if ( hdr -> code >= 128 ) { vty_out ( vty , "  Capability error: vendor specific capability code %d" , hdr -> code ) ; } else { vty_out ( vty , "  Capability error: unknown capability code %d" , hdr -> code ) ; } pnt += hdr -> length + 2 ; } } 