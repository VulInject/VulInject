rd_err_e validate_rdebug32 ( struct rd_agent * rap ) { struct ps_prochandle * php = rap -> rd_psp ; psaddr_t db_privp ; Rtld_db_priv db_priv ; db_privp = rap -> rd_rdebug ; if ( ps_pread ( php , db_privp , ( char * ) & db_priv , sizeof ( Rtld_db_priv ) ) != PS_OK ) { LOG ( ps_plog ( MSG_ORIG ( MSG_DB_READPRIVFAIL_1 ) , EC_ADDR ( db_privp ) ) ) ; return ( RD_DBERR ) ; } if ( ( db_priv . rtd_version < R_RTLDDB_VERSION1 ) || ( db_priv . rtd_version > R_RTLDDB_VERSION ) ) { LOG ( ps_plog ( MSG_ORIG ( MSG_DB_BADPVERS ) , db_priv . rtd_version , R_RTLDDB_VERSION ) ) ; return ( RD_NOCAPAB ) ; } if ( ps_pwrite ( php , db_privp , ( char * ) & db_priv , sizeof ( Rtld_db_priv ) ) != PS_OK ) { rap -> rd_flags |= RDF_FL_COREFILE ; } rap -> rd_rdebugvers = db_priv . rtd_version ; rap -> rd_rtlddbpriv = db_privp ; LOG ( ps_plog ( MSG_ORIG ( MSG_DB_VALIDRDEBUG ) , EC_ADDR ( rap -> rd_rdebug ) , R_RTLDDB_VERSION , rap -> rd_rdebugvers , rap -> rd_flags & RDF_FL_COREFILE ) ) ; return ( RD_OK ) ; } 