CLIENT * yp_bind_host ( char * server , u_long program , u_long version , u_short port , int usetcp ) { struct sockaddr_in rsrv_sin ; static CLIENT * client ; struct hostent * h ; struct timeval tv ; int rsrv_sock ; memset ( & rsrv_sin , 0 , sizeof rsrv_sin ) ; rsrv_sin . sin_len = sizeof rsrv_sin ; rsrv_sin . sin_family = AF_INET ; rsrv_sock = RPC_ANYSOCK ; if ( port != 0 ) { rsrv_sin . sin_port = htons ( port ) ; } if ( * server >= '0' && * server <= '9' ) { if ( inet_aton ( server , & rsrv_sin . sin_addr ) == 0 ) { fprintf ( stderr , "inet_aton: invalid address %s.\n" , server ) ; exit ( 1 ) ; } } else { h = gethostbyname ( server ) ; if ( h == NULL ) { fprintf ( stderr , "gethostbyname: unknown host %s.\n" , server ) ; exit ( 1 ) ; } rsrv_sin . sin_addr . s_addr = * ( u_int32_t * ) h -> h_addr ; } tv . tv_sec = 10 ; tv . tv_usec = 0 ; if ( usetcp ) { client = clnttcp_create ( & rsrv_sin , program , version , & rsrv_sock , 0 , 0 ) ; } else { client = clntudp_create ( & rsrv_sin , program , version , tv , & rsrv_sock ) ; } return ( client ) ; } 