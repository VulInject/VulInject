void csio_mb_params ( struct csio_hw * hw , struct csio_mb * mbp , uint32_t tmo , unsigned int pf , unsigned int vf , unsigned int nparams , const u32 * params , u32 * val , bool wr , void * cbfn ( struct csio_hw * , struct csio_mb * ) ) { uint32_t i ; uint32_t temp_params = 0 , temp_val ; struct fw_params_cmd * cmdp = ( fw_params_cmd * ) ( mbp -> mb ) ; __be32 * p = & cmdp -> param [ 0 ] . mnem ; CSIO_INIT_MBP ( mbp , cmdp , tmo , hw , cbfn , 1 ) ; cmdp -> op_to_vfn = htonl ( FW_CMD_OP_V ( FW_PARAMS_CMD ) | FW_CMD_REQUEST_F | ( wr ?FW_CMD_WRITE_F : FW_CMD_READ_F ) | FW_PARAMS_CMD_PFN_V ( pf ) | FW_PARAMS_CMD_VFN_V ( vf ) ) ; cmdp -> retval_len16 = htonl ( FW_CMD_LEN16_V ( sizeof ( * cmdp ) / 16 ) ) ; if ( wr ) { while ( nparams -- ) { temp_params = * params ++ ; temp_val = * val ++ ; * p ++ = htonl ( temp_params ) ; * p ++ = htonl ( temp_val ) ; } } else { for ( i = 0 ; i < nparams ; i ++ , p += 2 ) { temp_params = * params ++ ; * p = htonl ( temp_params ) ; } } } 