void table_block_parallelscan_startblock_init ( Relation rel , ParallelBlockTableScanWorker pbscanwork , ParallelBlockTableScanDesc pbscan ) { BlockNumber sync_startpage = InvalidBlockNumber ; memset ( pbscanwork , 0 , sizeof ( * pbscanwork ) ) ; StaticAssertStmt ( MaxBlockNumber <= 0xFFFFFFFE , "pg_nextpower2_32 may be too small for non-standard BlockNumber width" ) ; pbscanwork -> phsw_chunk_size = pg_nextpower2_32 ( Max ( pbscan -> phs_nblocks / PARALLEL_SEQSCAN_NCHUNKS , 1 ) ) ; pbscanwork -> phsw_chunk_size = Min ( pbscanwork -> phsw_chunk_size , PARALLEL_SEQSCAN_MAX_CHUNK_SIZE ) ; retry SpinLockAcquire ( & pbscan -> phs_mutex ) ; SpinLockRelease ( & pbscan -> phs_mutex ) ; } 