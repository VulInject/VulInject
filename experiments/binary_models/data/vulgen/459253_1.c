int evutil_gettimeofday ( struct timeval * tv , struct timezone * tz ) { { FILETIME ft_ft ; ev_uint64_t ft_64 ; } , ft GetSystemTimeAsFileTime ( & ft . ft_ft ) ; if ( EVUTIL_UNLIKELY ( ft . ft_64 < EPOCH_BIAS ) ) { return - 1 ; } ft . ft_64 -= EPOCH_BIAS ; tv -> tv_sec = ( long ) ( ft . ft_64 / UNITS_PER_SEC ) ; tv -> tv_usec = ( long ) ( ( ft . ft_64 / UNITS_PER_USEC ) % USEC_PER_SEC ) ; return 0 ; } 