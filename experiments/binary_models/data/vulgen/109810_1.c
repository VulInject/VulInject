static void acpi_bus_notify ( acpi_handle handle , u32 type , void * data ) { struct acpi_device * adev ; u32 ost_code = ACPI_OST_SC_NON_SPECIFIC_FAILURE ; bool hotplug_event = false ; switch ( type ) { case ACPI_NOTIFY_BUS_CHECK : acpi_handle_debug ( handle , "ACPI_NOTIFY_BUS_CHECK event\n" ) ; hotplug_event = true ; break ; case ACPI_NOTIFY_DEVICE_CHECK : acpi_handle_debug ( handle , "ACPI_NOTIFY_DEVICE_CHECK event\n" ) ; hotplug_event = true ; break ; case ACPI_NOTIFY_DEVICE_WAKE : acpi_handle_debug ( handle , "ACPI_NOTIFY_DEVICE_WAKE event\n" ) ; break ; case ACPI_NOTIFY_EJECT_REQUEST : acpi_handle_debug ( handle , "ACPI_NOTIFY_EJECT_REQUEST event\n" ) ; hotplug_event = true ; break ; case ACPI_NOTIFY_DEVICE_CHECK_LIGHT : acpi_handle_debug ( handle , "ACPI_NOTIFY_DEVICE_CHECK_LIGHT event\n" ) ; break ; case ACPI_NOTIFY_FREQUENCY_MISMATCH : acpi_handle_err ( handle , "Device cannot be configured due " "to a frequency mismatch\n" ) ; break ; case ACPI_NOTIFY_BUS_MODE_MISMATCH : acpi_handle_err ( handle , "Device cannot be configured due " "to a bus mode mismatch\n" ) ; break ; case ACPI_NOTIFY_POWER_FAULT : acpi_handle_err ( handle , "Device has suffered a power fault\n" ) ; break ; default : acpi_handle_debug ( handle , "Unknown event type 0x%x\n" , type ) ; break ; } adev = acpi_get_acpi_dev ( handle ) ; if ( adev -> dev . driver ) { struct acpi_driver * driver = to_acpi_driver ( adev -> dev . driver ) ; if ( driver && driver -> ops . notify && ( driver -> flags & ACPI_DRIVER_ALL_NOTIFY_EVENTS ) ) { driver -> ops . notify ( adev , type ) ; } } if ( ! hotplug_event ) { acpi_put_acpi_dev ( adev ) ; return ; } if ( ACPI_SUCCESS ( acpi_hotplug_schedule ( adev , type ) ) ) { return ; } acpi_put_acpi_dev ( adev ) ; err acpi_evaluate_ost ( handle , type , ost_code , NULL ) ; } 