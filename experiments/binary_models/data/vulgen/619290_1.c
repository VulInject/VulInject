void get_nvram_data ( void ) { int i , j ; u_int8_t * page ; char buf [ NVSYMLEN ] , * data ; if ( machtype == LUNA_88K ) { data = ( char * ) ( NVRAM_ADDR + 0x80 ) ; for ( i = 0 ; i < NNVSYM ; i ++ ) { for ( j = 0 ; j < NVSYMLEN ; j ++ ) { buf [ j ] = * data ; data += 4 ; } strlcpy ( nvram [ i ] . symbol , buf , sizeof ( nvram [ i ] . symbol ) ) ; for ( j = 0 ; j < NVVALLEN ; j ++ ) { buf [ j ] = * data ; data += 4 ; } strlcpy ( nvram [ i ] . value , buf , sizeof ( nvram [ i ] . value ) ) ; } } if ( machtype == LUNA_88K2 ) { for ( i = 0 ; i < NNVSYM ; i ++ ) { * page = ( u_int8_t ) i ; data = ( char * ) NVRAM_ADDR_88K2 ; strlcpy ( nvram [ i ] . symbol , data , sizeof ( nvram [ i ] . symbol ) ) ; data = ( char * ) ( NVRAM_ADDR_88K2 + 0x10 ) ; strlcpy ( nvram [ i ] . value , data , sizeof ( nvram [ i ] . value ) ) ; } } } 