static LIST_HEAD ( psmouse_smbus_list ) ; static DEFINE_MUTEX ( psmouse_smbus_mutex ) ; static void psmouse_smbus_check_adapter ( struct i2c_adapter * adapter ) { struct psmouse_smbus_dev * smbdev ; if ( ! i2c_check_functionality ( adapter , I2C_FUNC_SMBUS_HOST_NOTIFY ) ) { return ; } mutex_lock ( & psmouse_smbus_mutex ) ; list_for_each_entry ( , , ) { if ( smbdev -> dead ) { continue ; } if ( smbdev -> client ) { continue ; } psmouse_dbg ( smbdev -> psmouse , "SMBus candidate adapter appeared, triggering rescan\n" ) ; serio_rescan ( smbdev -> psmouse -> ps2dev . serio ) ; } } 