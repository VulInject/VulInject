static strarray_t * mygroups ( const struct auth_state * auth_state ) { strarray_t * sa = strarray_new ( ) ; tmp = make_krb_wildcard ( NULL , NULL , NULL ) ; strarray_appendm ( sa , tmp ) ; if ( auth_state -> realm ) { tmp = make_krb_wildcard ( NULL , NULL , auth_state -> realm ) ; strarray_appendm ( sa , tmp ) ; } if ( auth_state -> inst ) { tmp = make_krb_wildcard ( NULL , auth_state -> inst , NULL ) ; strarray_appendm ( sa , tmp ) ; if ( auth_state -> realm ) { tmp = make_krb_wildcard ( NULL , auth_state -> inst , auth_state -> realm ) ; strarray_appendm ( sa , tmp ) ; } } if ( auth_state -> aname ) { tmp = make_krb_wildcard ( auth_state -> aname , NULL , NULL ) ; strarray_appendm ( sa , tmp ) ; if ( auth_state -> realm ) { tmp = make_krb_wildcard ( auth_state -> aname , NULL , auth_state -> realm ) ; strarray_appendm ( sa , tmp ) ; } if ( auth_state -> inst ) { tmp = make_krb_wildcard ( auth_state -> aname , auth_state -> inst , NULL ) ; strarray_appendm ( sa , tmp ) ; } } return sa ; } 