static inline void gfmul_do_step256 ( struct ptls_fusion_gfmul_state256 * gstate , __m256i X , union ptls_fusion_aesgcm_ghash_precompute256 * precompute ) { __m256i t = _mm256_clmulepi64_epi128 ( precompute -> Hx2 , X , 0x00 ) ; gstate -> lo = _mm256_xor_si256 ( gstate -> lo , t ) ; t = _mm256_clmulepi64_epi128 ( precompute -> Hx2 , X , 0x11 ) ; gstate -> hi = _mm256_xor_si256 ( gstate -> hi , t ) ; t = _mm256_shuffle_epi32 ( X , 78 ) ; t = _mm256_xor_si256 ( t , X ) ; gstate -> mid = _mm256_xor_si256 ( gstate -> mid , t ) ; } 