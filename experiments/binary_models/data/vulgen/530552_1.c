void boot_fb_init ( int console ) { fb_info_pixel_coord_t window ; fb_info . fb = ( uint8_t * ) ( uintptr_t ) fb_info . paddr ; boot_fb_set_font ( fb_info . screen . y , fb_info . screen . x ) ; window . x = ( fb_info . screen . x - fb_info . terminal . x * boot_fb_font . vf_width ) / 2 ; window . y = ( fb_info . screen . y - fb_info . terminal . y * boot_fb_font . vf_height ) / 2 ; fb_info . terminal_origin . x = window . x ; fb_info . terminal_origin . y = window . y ; if ( fb_info . cursor . pos . x != 0 || fb_info . cursor . pos . y != 0 ) { fb_info . cursor . origin . x = window . x + fb_info . cursor . pos . x * boot_fb_font . vf_width ; fb_info . cursor . origin . y = window . y + fb_info . cursor . pos . y * boot_fb_font . vf_height ; } if ( fb_info . cursor . pos . x == 0 && fb_info . cursor . pos . y == 0 ) { fb_info . cursor . origin . x = window . x ; fb_info . cursor . origin . y = window . y ; } if ( fb_info . cursor . pos . x == 0 && fb_info . cursor . pos . y == 0 ) { uint32_t fg , bg , toffset ; uint16_t y ; boot_get_color ( & fg , & bg ) ; bg = boot_color_map ( bg ) ; toffset = 0 ; for ( y = 0 ; y < fb_info . screen . y ; y ++ ) { uint8_t * dest = fb_info . fb + toffset ; boot_fb_fill ( dest , bg , fb_info . pitch ) ; toffset += fb_info . pitch ; } } } 