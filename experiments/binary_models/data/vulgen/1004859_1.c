static errcode_t parse_include_dir ( const char * dirname , struct profile_node * root_section ) { errcode_t retval = 0 ; char * * fnames , * pathname ; int i ; if ( k5_dir_filenames ( dirname , & fnames ) != 0 ) { return PROF_FAIL_INCLUDE_DIR ; } for ( i = 0 ; fnames != NULL && fnames [ i ] != NULL ; i ++ ) { if ( ! valid_name ( fnames [ i ] ) ) { continue ; } if ( asprintf ( & pathname , "%s/%s" , dirname , fnames [ i ] ) < 0 ) { retval = ENOMEM ; break ; } retval = parse_include_file ( pathname , root_section ) ; free ( pathname ) ; if ( retval ) { break ; } } return retval ; } 