void ospf_reset_hello_timer ( struct interface * ifp , struct in_addr addr , bool is_addr ) { struct route_node * rn ; if ( is_addr ) { struct prefix p ; struct ospf_interface * oi = NULL ; p . u . prefix4 = addr ; p . family = AF_INET ; p . prefixlen = IPV4_MAX_BITLEN ; oi = ospf_if_table_lookup ( ifp , & p ) ; if ( oi ) { ospf_hello_send ( oi ) ; THREAD_OFF ( oi -> t_hello ) ; OSPF_HELLO_TIMER_ON ( oi ) ; } return ; } for ( rn = route_top ( IF_OIFS ( ifp ) ) ; rn ; rn = route_next ( rn ) ) { struct ospf_interface * oi = rn -> info ; if ( OSPF_IF_PARAM_CONFIGURED ( oi -> params , v_hello ) ) { continue ; } ospf_hello_send ( oi ) ; THREAD_OFF ( oi -> t_hello ) ; OSPF_HELLO_TIMER_ON ( oi ) ; } } 