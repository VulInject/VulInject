static bool ATHEME_FATTR_WUR _digest_init ( struct digest_context * const restrict ctx , const enum digest_algorithm alg ) { ( void ) memset ( ctx , 0x00 , sizeof ctx ) ; ctx -> alg = alg ; if ( ! ( ctx -> md = _digest_decide_md ( alg ) ) ) { ( void ) slog ( LG_ERROR , "%s: _digest_decide_md() failed (BUG?)" , MOWGLI_FUNC_NAME ) ; return false ; } if ( ! ( ctx -> ictx = EVP_MD_CTX_create ( ) ) ) { ( void ) slog ( LG_ERROR , "%s: EVP_MD_CTX_create(3): unknown error" , MOWGLI_FUNC_NAME ) ; return false ; } if ( EVP_DigestInit_ex ( ctx -> ictx , ctx -> md , NULL ) != 1 ) { ( void ) slog ( LG_ERROR , "%s: EVP_DigestInit_ex(3): unknown error" , MOWGLI_FUNC_NAME ) ; return false ; } return true ; } 