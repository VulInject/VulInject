PIX * pixs , * pixmin , * pix1 , * pix2 , * pix3 , * pix4 , * pix5 ; PIX * pix6 , * pix7 , * pix8 , * pix9 , * pix10 , * pix11 ; PIXA * pixa1 ; L_REGPARAMS * rp ; if ( regTestSetup ( argc , argv , & rp ) ) { return 1 ; } pixa1 = pixaCreate ( 0 ) ; pixs = pixRead ( "lighttext.jpg" ) ; pixGetDimensions ( pixs , & w , & h , NULL ) ; regTestWritePixAndCheck ( rp , pixs , IFF_JFIF_JPEG ) ; pixaAddPix ( pixa1 , pixs , L_INSERT ) ; startTimer ( ) ; pix1 = pixContrastNorm ( NULL , pixs , 10 , 10 , 40 , 2 , 2 ) ; lept_stderr ( "Time: Contrast norm: %7.3f Mpix/sec\n" , mps ) ; pixaAddPix ( pixa1 , pix1 , L_INSERT ) ; regTestWritePixAndCheck ( rp , pix1 , IFF_JFIF_JPEG ) ; pix2 = pixGammaTRC ( NULL , pix1 , 1.5 , 50 , 235 ) ; pixaAddPix ( pixa1 , pix2 , L_INSERT ) ; regTestWritePixAndCheck ( rp , pix2 , IFF_JFIF_JPEG ) ; pix3 = pixDitherTo2bpp ( pix2 , 1 ) ; pixaAddPix ( pixa1 , pix3 , L_INSERT ) ; regTestWritePixAndCheck ( rp , pix3 , IFF_PNG ) ; pix4 = pixThresholdTo4bpp ( pix2 , 7 , 1 ) ; pixaAddPix ( pixa1 , pix4 , L_INSERT ) ; regTestWritePixAndCheck ( rp , pix4 , IFF_PNG ) ; pix5 = pixThresholdToBinary ( pix1 , 180 ) ; pixaAddPix ( pixa1 , pix5 , L_INSERT ) ; regTestWritePixAndCheck ( rp , pix5 , IFF_PNG ) ; pix6 = pixThresholdToBinary ( pix2 , 200 ) ; pixaAddPix ( pixa1 , pix6 , L_INSERT ) ; regTestWritePixAndCheck ( rp , pix6 , IFF_PNG ) ; pix7 = pixaDisplayTiledInColumns ( pixa1 , 3 , 1.0 , 30 , 2 ) ; pixDisplayWithTitle ( pix7 , 0 , 0 , NULL , rp -> display ) ; regTestWritePixAndCheck ( rp , pix7 , IFF_JFIF_JPEG ) ; pixDestroy ( & pix7 ) ; pixaDestroy ( & pixa1 ) ; pixa1 = pixaCreate ( 0 ) ; pixs = pixRead ( "w91frag.jpg" ) ; pixGetDimensions ( pixs , & w , & h , NULL ) ; pixaAddPix ( pixa1 , pixs , L_INSERT ) ; regTestWritePixAndCheck ( rp , pixs , IFF_JFIF_JPEG ) ; startTimer ( ) ; pix1 = pixBackgroundNormFlex ( pixs , 7 , 7 , 1 , 1 , 10 ) ; mps = 0.000001 * w * h / stopTimer ( ) ; lept_stderr ( "Time: Flexible bg norm: %7.3f Mpix/sec\n" , mps ) ; pixaAddPix ( pixa1 , pix1 , L_INSERT ) ; regTestWritePixAndCheck ( rp , pix1 , IFF_JFIF_JPEG ) ; pix2 = pixScaleSmooth ( pixs , 1. / 7. , 1. / 7. ) ; pix3 = pixScale ( pix2 , 7.0 , 7.0 ) ; pixaAddPix ( pixa1 , pix3 , L_INSERT ) ; regTestWritePixAndCheck ( rp , pix3 , IFF_JFIF_JPEG ) ; pixLocalExtrema ( pix2 , 0 , 0 , & pixmin , NULL ) ; pix4 = pixExpandBinaryReplicate ( pixmin , 7 , 7 ) ; pixaAddPix ( pixa1 , pix4 , L_INSERT ) ; regTestWritePixAndCheck ( rp , pix4 , IFF_JFIF_JPEG ) ; pix5 = pixSeedfillGrayBasin ( pixmin , pix2 , 10 , 4 ) ; pix6 = pixExtendByReplication ( pix5 , 1 , 1 ) ; regTestWritePixAndCheck ( rp , pix6 , IFF_JFIF_JPEG ) ; pixDestroy ( & pixmin ) ; pixDestroy ( & pix5 ) ; pixDestroy ( & pix2 ) ; pix7 = pixGetInvBackgroundMap ( pix6 , 200 , 1 , 1 ) ; pix8 = pixApplyInvBackgroundGrayMap ( pixs , pix7 , 7 , 7 ) ; pixaAddPix ( pixa1 , pix8 , L_INSERT ) ; regTestWritePixAndCheck ( rp , pix8 , IFF_JFIF_JPEG ) ; pixDestroy ( & pix6 ) ; pixDestroy ( & pix7 ) ; pix9 = pixGammaTRCMasked ( NULL , pix1 , NULL , 1.0 , 100 , 175 ) ; pixaAddPix ( pixa1 , pix9 , L_INSERT ) ; regTestWritePixAndCheck ( rp , pix9 , IFF_JFIF_JPEG ) ; pix10 = pixThresholdTo4bpp ( pix9 , 10 , 1 ) ; pixaAddPix ( pixa1 , pix10 , L_INSERT ) ; regTestWritePixAndCheck ( rp , pix10 , IFF_JFIF_JPEG ) ; pix11 = pixThresholdToBinary ( pix9 , 190 ) ; pixaAddPix ( pixa1 , pix11 , L_INSERT ) ; regTestWritePixAndCheck ( rp , pix11 , IFF_JFIF_JPEG ) ; pix2 = pixaDisplayTiledInColumns ( pixa1 , 3 , 1.0 , 30 , 2 ) ; pixDisplayWithTitle ( pix2 , 0 , 700 , NULL , rp -> display ) ; regTestWritePixAndCheck ( rp , pix2 , IFF_JFIF_JPEG ) ; pixDestroy ( & pix2 ) ; pixaDestroy ( & pixa1 ) ; return regTestCleanup ( rp ) ; 