void sctp_transport_lower_cwnd ( struct sctp_transport * transport , sctp_lower_cwnd_t reason ) { struct sctp_association * asoc = transport -> asoc ; switch ( reason ) { case SCTP_LOWER_CWND_T3_RTX : transport -> ssthresh = max ( transport -> cwnd / 2 , 4 * asoc -> pathmtu ) ; transport -> cwnd = asoc -> pathmtu ; asoc -> fast_recovery = 0 ; break ; case SCTP_LOWER_CWND_FAST_RTX : if ( asoc -> fast_recovery ) { return ; } asoc -> fast_recovery = 1 ; transport -> ssthresh = max ( transport -> cwnd / 2 , 4 * asoc -> pathmtu ) ; transport -> cwnd = transport -> ssthresh ; break ; case SCTP_LOWER_CWND_ECNE : if ( time_after ( jiffies , transport -> last_time_ecne_reduced + transport -> rtt ) ) { transport -> ssthresh = max ( transport -> cwnd / 2 , 4 * asoc -> pathmtu ) ; transport -> cwnd = transport -> ssthresh ; transport -> last_time_ecne_reduced = jiffies ; } break ; case SCTP_LOWER_CWND_INACTIVE : transport -> cwnd = max ( transport -> cwnd / 2 , 4 * asoc -> pathmtu ) ; break ; } transport -> partial_bytes_acked = 0 ; pr_debug ( "%s: transport:%p, reason:%d, cwnd:%d, ssthresh:%d\n" , __func__ , transport , reason , transport -> cwnd , transport -> ssthresh ) ; } 