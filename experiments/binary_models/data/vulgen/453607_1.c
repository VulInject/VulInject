static void test_event_deprecated_data ( TestEventData * data , const void * unused ) { data -> expect = qdict_from_jsonf_nofail ( "{ 'event': 'TEST_EVENT_FEATURES0'," " 'data': { 'foo': 42 } }" ) ; qapi_event_send_test_event_features0 ( 42 ) ; g_assert ( data -> emitted ) ; qobject_unref ( data -> expect ) ; compat_policy . has_deprecated_output = true ; compat_policy . deprecated_output = COMPAT_POLICY_OUTPUT_HIDE ; data -> expect = qdict_from_jsonf_nofail ( "{ 'event': 'TEST_EVENT_FEATURES0' }" ) ; qapi_event_send_test_event_features0 ( 42 ) ; g_assert ( data -> emitted ) ; qobject_unref ( data -> expect ) ; } 