static ACPI_STATUS OslMapTable ( ACPI_SIZE Address , char * Signature , ACPI_TABLE_HEADER * * Table ) { ACPI_TABLE_HEADER * MappedTable ; UINT32 Length ; if ( Address == 0 ) { return ( AE_BAD_ADDRESS ) ; } MappedTable = AcpiOsMapMemory ( Address , sizeof ( ACPI_TABLE_HEADER ) ) ; if ( MappedTable == NULL ) { ( void ) fprintf ( stderr , "Could not map table header at " "0x%8.8X%8.8X\n" , ACPI_FORMAT_UINT64 ( Address ) ) ; return ( OslGetLastStatus ( AE_BAD_ADDRESS ) ) ; } if ( Signature != NULL ) { if ( ACPI_VALIDATE_RSDP_SIG ( Signature ) ) { if ( ! ACPI_VALIDATE_RSDP_SIG ( MappedTable -> Signature ) ) { AcpiOsUnmapMemory ( MappedTable , sizeof ( ACPI_TABLE_HEADER ) ) ; return ( AE_BAD_SIGNATURE ) ; } } if ( ! ACPI_COMPARE_NAME ( Signature , MappedTable -> Signature ) ) { AcpiOsUnmapMemory ( MappedTable , sizeof ( ACPI_TABLE_HEADER ) ) ; return ( AE_BAD_SIGNATURE ) ; } } Length = ApGetTableLength ( MappedTable ) ; AcpiOsUnmapMemory ( MappedTable , sizeof ( ACPI_TABLE_HEADER ) ) ; MappedTable = AcpiOsMapMemory ( Address , Length ) ; if ( MappedTable == NULL ) { ( void ) fprintf ( stderr , "Could not map table at 0x%8.8X%8.8X " "length %8.8X\n" , ACPI_FORMAT_UINT64 ( Address ) , Length ) ; return ( OslGetLastStatus ( AE_INVALID_TABLE_LENGTH ) ) ; } ( void ) ApIsValidChecksum ( MappedTable ) ; * Table = MappedTable ; return ( AE_OK ) ; } 