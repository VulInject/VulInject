u64 fscrypt_limit_io_blocks ( const struct inode * inode , u64 lblk , u64 nr_blocks ) { const struct fscrypt_info * ci ; u32 dun ; if ( nr_blocks <= 1 ) { return nr_blocks ; } ci = inode -> i_crypt_info ; if ( ! ( fscrypt_policy_flags ( & ci -> ci_policy ) & FSCRYPT_POLICY_FLAG_IV_INO_LBLK_32 ) ) { return nr_blocks ; } dun = ci -> ci_hashed_ino + lblk ; return min_t ( u64 , nr_blocks , ( u64 ) U32_MAX + 1 - dun ) ; } 