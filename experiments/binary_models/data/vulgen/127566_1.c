static void nand_davinci_hwctl_1bit ( struct mtd_info * mtd , int mode ) { struct davinci_nand_info * info ; uint32_t nandcfr ; unsigned long flags ; info = to_davinci_nand ( mtd ) ; spin_lock_irqsave ( & davinci_nand_lock , flags ) ; nandcfr = davinci_nand_readl ( info , NANDFCR_OFFSET ) ; nandcfr |= BIT ( 8 + info -> core_chipsel ) ; davinci_nand_writel ( info , NANDFCR_OFFSET , nandcfr ) ; spin_unlock_irqrestore ( & davinci_nand_lock , flags ) ; } 