static void inf_gtk_certificate_manager_check_certificate ( InfCertificateVerify * verify , InfXmppConnection * connection , InfCertificateChain * certificate_chain , gnutls_x509_crt_t pinned_certificate , InfCertificateVerifyFlags flags ) { InfGtkCertificateManager * manager ; InfGtkCertificateManagerPrivate * priv ; InfGtkCertificateManagerDialog * item ; InfGtkCertificateDialog * dialog ; gchar * hostname ; gchar * text ; GtkWidget * label ; GtkWidget * vbox ; manager = INF_GTK_CERTIFICATE_MANAGER ( verify ) ; priv = INF_GTK_CERTIFICATE_MANAGER_PRIVATE ( manager ) ; g_object_get ( G_OBJECT ( connection ) , "remote-hostname" , & hostname , NULL ) ; dialog = inf_gtk_certificate_dialog_new ( priv -> parent_window , 0 , flags , hostname , certificate_chain , pinned_certificate ) ; gtk_dialog_add_button ( GTK_DIALOG ( dialog ) , _ ( "_Cancel connection" ) , GTK_RESPONSE_REJECT ) ; gtk_dialog_add_button ( GTK_DIALOG ( dialog ) , _ ( "C_ontinue connection" ) , GTK_RESPONSE_ACCEPT ) ; text = g_strdup_printf ( _ ( "Do you want to continue the connection to host \"%s\"? If you " "choose to continue, this certificate will be trusted in the " "future when connecting to this host." ) , hostname ) ; label = gtk_label_new ( text ) ; gtk_label_set_line_wrap ( GTK_LABEL ( label ) , TRUE ) ; gtk_label_set_max_width_chars ( GTK_LABEL ( label ) , 75 ) ; gtk_widget_set_halign ( GTK_WIDGET ( label ) , GTK_ALIGN_START ) ; gtk_widget_set_valign ( GTK_WIDGET ( label ) , GTK_ALIGN_START ) ; gtk_label_set_xalign ( GTK_LABEL ( label ) , 0.0 ) ; gtk_misc_set_alignment ( GTK_MISC ( label ) , 0.0 , 0.0 ) ; gtk_widget_show ( label ) ; g_free ( text ) ; vbox = gtk_dialog_get_content_area ( GTK_DIALOG ( dialog ) ) ; gtk_box_pack_start ( GTK_BOX ( vbox ) , label , FALSE , TRUE , 6 ) ; item = g_slice_new ( InfGtkCertificateManagerDialog ) ; item -> manager = manager ; item -> connection = connection ; item -> dialog = dialog ; priv -> dialogs = g_slist_prepend ( priv -> dialogs , item ) ; g_signal_connect ( G_OBJECT ( dialog ) , "response" , G_CALLBACK ( inf_gtk_certificate_manager_response_cb ) , item ) ; gtk_window_present ( GTK_WINDOW ( dialog ) ) ; } 