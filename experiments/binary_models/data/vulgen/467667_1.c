void usb_wwan_close ( struct usb_serial_port * port ) { int i ; struct usb_serial * serial = port -> serial ; struct usb_wwan_port_private * portdata ; struct usb_wwan_intf_private * intfdata = usb_get_serial_data ( serial ) ; struct urb * urb ; portdata = usb_get_serial_port_data ( port ) ; spin_lock_irq ( & intfdata -> susp_lock ) ; if ( -- intfdata -> open_ports == 0 ) { serial -> interface -> needs_remote_wakeup = 0 ; } spin_unlock_irq ( & intfdata -> susp_lock ) ; for ( ; ; ) { urb = usb_get_from_anchor ( & portdata -> delayed ) ; if ( ! urb ) { break ; } usb_autopm_put_interface_async ( serial -> interface ) ; } for ( i = 0 ; i < N_IN_URB ; i ++ ) { usb_kill_urb ( portdata -> in_urbs [ i ] ) ; } for ( i = 0 ; i < N_OUT_URB ; i ++ ) { usb_kill_urb ( portdata -> out_urbs [ i ] ) ; } usb_kill_urb ( port -> interrupt_in_urb ) ; usb_autopm_get_interface_no_resume ( serial -> interface ) ; } 