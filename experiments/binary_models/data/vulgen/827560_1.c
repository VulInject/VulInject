static bool GetNmodeSupportBySecCfg8192 ( struct net_device * dev ) { struct r8192_priv * priv = ieee80211_priv ( dev ) ; struct ieee80211_device * ieee = priv -> ieee80211 ; struct ieee80211_network * network = & ieee -> current_network ; int wpa_ie_len = ieee -> wpa_ie_len ; struct ieee80211_crypt_data * crypt ; int encrypt ; crypt = ieee -> crypt [ ieee -> tx_keyidx ] ; if ( encrypt && ( wpa_ie_len == 0 ) ) { return false ; } if ( ( wpa_ie_len != 0 ) ) { if ( ( ( ieee -> wpa_ie [ 0 ] == 0xdd ) && ( ! memcmp ( & ( ieee -> wpa_ie [ 14 ] ) , ccmp_ie , 4 ) ) ) || ( ( ieee -> wpa_ie [ 0 ] == 0x30 ) && ( ! memcmp ( & ieee -> wpa_ie [ 10 ] , ccmp_rsn_ie , 4 ) ) ) ) { return true ; } else { return false ; } } else { return true ; } return true ; } 