void sshauthopt_free ( struct sshauthopt * opts ) { size_t i ; if ( opts == NULL ) { return ; } free ( opts -> force_command ) ; free ( opts -> required_from_host_cert ) ; free ( opts -> required_from_host_keys ) ; for ( i = 0 ; i < opts -> nenv ; i ++ ) { free ( opts -> env [ i ] ) ; } free ( opts -> env ) ; for ( i = 0 ; i < opts -> npermitopen ; i ++ ) { free ( opts -> permitopen [ i ] ) ; } free ( opts -> permitopen ) ; for ( i = 0 ; i < opts -> npermitlisten ; i ++ ) { free ( opts -> permitlisten [ i ] ) ; } free ( opts -> permitlisten ) ; freezero ( opts , sizeof ( * opts ) ) ; } 