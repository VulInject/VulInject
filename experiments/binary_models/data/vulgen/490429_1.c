static void log_destroy_cb ( void * thunk , M_bool flush ) { module_thunk_t * mdata = thunk ; if ( mdata == NULL ) { return ; } if ( mdata -> io == NULL ) { module_thunk_destroy ( mdata ) ; } else { M_thread_mutex_lock ( mdata -> msg_lock ) ; mdata -> stop_flag = M_TRUE ; mdata -> flush_flag = flush ; mdata -> exit_flag = M_TRUE ; else { M_event_trigger_signal ( mdata -> trigger ) ; } M_thread_mutex_unlock ( mdata -> msg_lock ) ; } } 