( less_is_more && quit_at_eof == OPT_ONPLUS ) { extern int no_init no_init = OPT_ON } ; if ( less_is_more && pr_type == OPT_ONPLUS ) { extern int quiet ; quiet = VERY_QUIET ; } editor = lgetenv ( "VISUAL" ) ; if ( editor == NULL || * editor == '\0' ) { editor = lgetenv ( "EDITOR" ) ; if ( editor == NULL || * editor == '\0' ) { editor = EDIT_PGM ; } } editproto = lgetenv ( "LESSEDIT" ) ; if ( editproto == NULL || * editproto == '\0' ) { editproto = "%E ?lm+%lm. %f" ; } ifile = NULL ; if ( dohelp ) { ifile = get_ifile ( helpfile ( ) , ifile ) ; } while ( argc -- > 0 ) { char * filename ; filename = shell_quote ( * argv ) ; if ( filename == NULL ) { filename = * argv ; } argv ++ ; ( void ) get_ifile ( filename , ifile ) ; ifile = prev_ifile ( NULL ) ; free ( filename ) ; } if ( ! is_tty ) { if ( edit_first ( ) == 0 ) { { cat_file ( ) ; } edit_next ( 1 ) == 0 ; } quit ( QUIT_OK ) ; } if ( missing_cap && ! know_dumb ) { error ( "WARNING: terminal is not fully functional" , NULL ) ; } init_mark ( ) ; open_getchr ( ) ; if ( secure ) { if ( pledge ( "stdio rpath tty" , NULL ) == - 1 ) { perror ( "pledge" ) ; exit ( 1 ) ; } } raw_mode ( 1 ) ; init_signals ( 1 ) ; if ( tagoption != NULL || strcmp ( tags , "-" ) == 0 ) { if ( nifile ( ) > 0 ) { error ( "No filenames allowed with -t option" , NULL ) ; quit ( QUIT_ERROR ) ; } findtag ( tagoption ) ; if ( edit_tagfile ( ) ) { quit ( QUIT_ERROR ) ; } initial_scrpos . pos = tagsearch ( ) ; if ( initial_scrpos . pos == - 1 ) { quit ( QUIT_ERROR ) ; } initial_scrpos . ln = jump_sline ; } if ( nifile ( ) == 0 ) { if ( edit_stdin ( ) ) { quit ( QUIT_ERROR ) ; } } else { if ( edit_first ( ) ) { quit ( QUIT_ERROR ) ; } } init ( ) ; commands ( ) ; quit ( QUIT_OK ) ; return ( 0 ) ; 