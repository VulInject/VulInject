static int logparser_config_logfile ( oconfig_item_t * ci ) { char * filename = NULL ; bool first_read = false ; int ret = 0 ; ret = cf_util_get_string ( ci , & filename ) ; if ( ret != 0 ) { ERROR ( PLUGIN_NAME ": Error getting filename" ) ; return - 1 ; } for ( int i = 0 ; i < ci -> children_num ; i ++ ) { oconfig_item_t * child = ci -> children + i ; if ( strcasecmp ( "FirstFullRead" , child -> key ) == 0 ) { ret = cf_util_get_boolean ( child , & first_read ) ; } if ( strcasecmp ( "Message" , child -> key ) == 0 ) { ret = logparser_config_message ( child , filename , first_read ) ; } else { ERROR ( PLUGIN_NAME ": Invalid configuration option \"%s\"." , child -> key ) ; error } if ( ret != 0 ) { ERROR ( PLUGIN_NAME ": Error getting %s option" , child -> key ) ; error } } return 0 ; error return - 1 ; } 