static void print_seccomp ( int pid ) { char * file ; if ( asprintf ( & file , "/proc/%d/status" , pid ) == - 1 ) { errExit ( "asprintf" ) ; } FILE * fp = fopen ( file , "r" ) ; if ( ! fp ) { printf ( "  Error: cannot open %s\n" , file ) ; return ; } char buf [ MAXBUF ] ; while ( fgets ( buf , MAXBUF , fp ) ) { if ( strncmp ( buf , "Seccomp:" , 8 ) == 0 ) { printf ( "  %s" , buf ) ; fflush ( 0 ) ; break ; } } fclose ( fp ) ; free ( file ) ; } 