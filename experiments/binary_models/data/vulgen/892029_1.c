static VALUE ossl_ts_resp_get_tsa_certificate ( VALUE self ) { TS_RESP * resp ; PKCS7 * p7 ; PKCS7_SIGNER_INFO * ts_info ; X509 * cert ; GetTSResponse ( self , resp ) ; if ( ! ( p7 = TS_RESP_get_token ( resp ) ) ) { return Qnil ; } ts_info = sk_PKCS7_SIGNER_INFO_value ( p7 -> d . sign -> signer_info , 0 ) ; cert = PKCS7_cert_from_signer_info ( p7 , ts_info ) ; return ossl_x509_new ( cert ) ; } 