static ssize_t ccwgroup_ungroup_store ( struct device * dev , struct device_attribute * attr , const char * buf , size_t count ) { struct ccwgroup_device * gdev = to_ccwgroupdev ( dev ) ; int rc = 0 ; if ( gdev -> state != CCWGROUP_OFFLINE ) { rc = - EINVAL ; out } if ( device_remove_file_self ( dev , attr ) ) { ccwgroup_ungroup ( gdev ) ; } else { rc = - ENODEV ; } out if ( rc ) { atomic_set ( & gdev -> onoff , 0 ) ; return rc ; } return count ; } 