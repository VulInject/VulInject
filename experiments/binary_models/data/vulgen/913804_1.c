config_write_distribute ( ) { unsigned int i ; int j ; int output , v6 ; int write = 0 ; for ( i = 0 ; i < disthash -> size ; i ++ ) { for ( mp = disthash -> index [ i ] ; mp ; mp = mp -> next ) { struct distribute * dist ; dist = mp -> data ; for ( j = 0 ; j < DISTRIBUTE_MAX ; j ++ ) { if ( dist -> list [ j ] ) { output = j == DISTRIBUTE_V4_OUT || j == DISTRIBUTE_V6_OUT ; v6 = j == DISTRIBUTE_V6_IN || j == DISTRIBUTE_V6_OUT ; vty_out ( vty , " %sdistribute-list %s %s %s%s" , v6 ?"ipv6 " : "" , dist -> list [ j ] , output ?"out" : "in" , dist -> ifname ?dist -> ifname : "" , VTY_NEWLINE ) ; write ++ ; } } for ( j = 0 ; j < DISTRIBUTE_MAX ; j ++ ) { if ( dist -> prefix [ j ] ) { output = j == DISTRIBUTE_V4_OUT || j == DISTRIBUTE_V6_OUT ; v6 = j == DISTRIBUTE_V6_IN || j == DISTRIBUTE_V6_OUT ; vty_out ( vty , " %sdistribute-list prefix %s %s %s%s" , v6 ?"ipv6 " : "" , dist -> prefix [ j ] , output ?"out" : "in" , dist -> ifname ?dist -> ifname : "" , VTY_NEWLINE ) ; write ++ ; } } } } return write ; } 