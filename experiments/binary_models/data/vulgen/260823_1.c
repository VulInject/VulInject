JsVar * jsvNewFromStringVar ( const JsVar * str , size_t stridx , size_t maxLength ) { if ( jsvIsNativeString ( str ) || jsvIsFlashString ( str ) ) { size_t l = jsvGetStringLength ( str ) ; if ( stridx > l ) { stridx = l ; } JsVar * res = jsvNewWithFlags ( str -> flags & JSV_VARTYPEMASK ) ; res -> varData . nativeStr . ptr = str -> varData . nativeStr . ptr + stridx ; res -> varData . nativeStr . len = ( JsVarDataNativeStrLength ) maxLength ; return res ; } JsVar * var = jsvNewFromEmptyString ( ) ; if ( var ) { jsvAppendStringVar ( var , str , stridx , maxLength ) ; } return var ; } 