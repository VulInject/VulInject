static void _build_node2task_map ( pmixp_namespace_t * nsptr , uint32_t * node2tasks ) { uint32_t * node_offs = xcalloc ( nsptr -> nnodes , sizeof ( * node_offs ) ) ; uint32_t * node_tasks = xcalloc ( nsptr -> nnodes , sizeof ( * node_tasks ) ) ; for ( int i = 1 ; i < nsptr -> nnodes ; i ++ ) { node_offs [ i ] = node_offs [ i - 1 ] + nsptr -> task_cnts [ i - 1 ] ; } xassert ( nsptr -> ntasks == ( node_offs [ nsptr -> nnodes - 1 ] + nsptr -> task_cnts [ nsptr -> nnodes - 1 ] ) ) ; for ( int i = 0 ; i < nsptr -> ntasks ; i ++ ) { int node = nsptr -> task_map [ i ] , offset ; xassert ( node < nsptr -> nnodes ) ; offset = node_offs [ node ] + node_tasks [ node ] ++ ; xassert ( nsptr -> task_cnts [ node ] >= node_tasks [ node ] ) ; node2tasks [ offset ] = i ; } xfree ( node_offs ) ; } 