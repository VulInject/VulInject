void test_repo_open__validates_bare_repo_ownership ( void ) { git_repository * repo ; cl_git_pass ( git_libgit2_opts ( GIT_OPT_SET_OWNER_VALIDATION , 1 ) ) ; cl_fixture_sandbox ( "testrepo.git" ) ; git_fs_path__set_owner ( GIT_FS_PATH_OWNER_CURRENT_USER ) ; cl_git_pass ( git_repository_open ( & repo , "testrepo.git" ) ) ; git_fs_path__set_owner ( GIT_FS_PATH_OWNER_ADMINISTRATOR ) ; cl_git_fail_with ( GIT_EOWNER , git_repository_open ( & repo , "testrepo.git" ) ) ; git_fs_path__set_owner ( GIT_FS_PATH_USER_IS_ADMINISTRATOR ) ; cl_git_pass ( git_repository_open ( & repo , "testrepo.git" ) ) ; git_repository_free ( repo ) ; git_fs_path__set_owner ( GIT_FS_PATH_OWNER_OTHER ) ; cl_git_fail_with ( GIT_EOWNER , git_repository_open ( & repo , "testrepo.git" ) ) ; } 