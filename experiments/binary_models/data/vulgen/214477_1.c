void dr_req_remove ( char * rsrcname , uint_t flag ) { req_t * req ; char * device = resolve_name ( rsrcname ) ; rcm_log_message ( RCM_TRACE3 , "dr_req_remove(%s)\n" , rsrcname ) ; ( void ) mutex_lock ( & rcm_req_lock ) ; req = find_req_entry ( device , flag , - 1 , dr_req_list ) ; if ( req == NULL ) { ( void ) mutex_unlock ( & rcm_req_lock ) ; rcm_log_message ( RCM_WARNING , gettext ( "dr_req entry %s not found\n" ) , rsrcname ) ; return ; } req -> state = RCM_STATE_REMOVE ; dr_req_list -> n_req -- ; ( void ) fsync ( state_fd ) ; remove_from_polling_list ( req -> pid ) ; ( void ) mutex_unlock ( & rcm_req_lock ) ; } 