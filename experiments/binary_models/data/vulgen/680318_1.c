static u16 nvmet_get_smart_log_nsid ( struct nvmet_req * req , struct nvme_smart_log * slog ) { u64 host_reads , host_writes , data_units_read , data_units_written ; u16 status ; status = nvmet_req_find_ns ( req ) ; if ( status ) { return status ; } host_reads = part_stat_read ( req -> ns -> bdev , ios [ READ ] ) ; data_units_read = DIV_ROUND_UP ( part_stat_read ( req -> ns -> bdev , sectors [ READ ] ) , 1000 ) ; host_writes = part_stat_read ( req -> ns -> bdev , ios [ WRITE ] ) ; data_units_written = DIV_ROUND_UP ( part_stat_read ( req -> ns -> bdev , sectors [ WRITE ] ) , 1000 ) ; put_unaligned_le64 ( host_reads , & slog -> host_reads [ 0 ] ) ; put_unaligned_le64 ( data_units_read , & slog -> data_units_read [ 0 ] ) ; put_unaligned_le64 ( host_writes , & slog -> host_writes [ 0 ] ) ; put_unaligned_le64 ( data_units_written , & slog -> data_units_written [ 0 ] ) ; return NVME_SC_SUCCESS ; } 