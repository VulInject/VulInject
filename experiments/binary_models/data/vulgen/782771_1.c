static void dec_kn20aa_cons_init ( ) { struct ctb * ctb ; struct cia_config * ccp ; extern struct cia_config cia_configuration ; ccp = & cia_configuration ; cia_init ( ccp , 0 ) ; ctb = ( ctb * ) ( ( ( caddr_t ) hwrpb ) + hwrpb -> rpb_ctb_off ) ; switch ( ctb -> ctb_term_type ) { case CTB_PRINTERPORT : { DELAY ( 160000000 / comcnrate ) ; if ( comcnattach ( & ccp -> cc_iot , 0x3f8 , comcnrate , COM_FREQ , ( TTYDEF_CFLAG & ~ ( CSIZE | PARENB ) ) | CS8 ) ) { panic ( "can't init serial console" ) ; } break ; } case CTB_GRAPHICS : if ( CTB_TURBOSLOT_TYPE ( ctb -> ctb_turboslot ) == CTB_TURBOSLOT_TYPE_ISA ) { isa_display_console ( & ccp -> cc_iot , & ccp -> cc_memt ) ; } else { pci_display_console ( & ccp -> cc_iot , & ccp -> cc_memt , & ccp -> cc_pc , CTB_TURBOSLOT_BUS ( ctb -> ctb_turboslot ) , CTB_TURBOSLOT_SLOT ( ctb -> ctb_turboslot ) , 0 ) ; } panic ( "not configured to use display&&keyboard console" ) ; break ; default : printf ( "ctb->ctb_term_type = 0x%lx\n" , ( unsigned long ) ctb -> ctb_term_type ) ; printf ( "ctb->ctb_turboslot = 0x%lx\n" , ( unsigned long ) ctb -> ctb_turboslot ) ; panic ( "consinit: unknown console type %lu" , ( unsigned long ) ctb -> ctb_term_type ) ; } } 