struct memtype * rbt_memtype_erase ( u64 start , u64 end ) { struct memtype * data ; data = memtype_rb_match ( & memtype_rbroot , start , end , MEMTYPE_EXACT_MATCH ) ; if ( ! data ) { data = memtype_rb_match ( & memtype_rbroot , start , end , MEMTYPE_END_MATCH ) ; if ( ! data ) { return ERR_PTR ( - EINVAL ) ; } } if ( data -> start == start ) { rb_erase_augmented ( & data -> rb , & memtype_rbroot , & memtype_rb_augment_cb ) ; } else { rb_erase_augmented ( & data -> rb , & memtype_rbroot , & memtype_rb_augment_cb ) ; data -> end = start ; data -> subtree_max_end = data -> end ; return NULL ; } return data ; } 