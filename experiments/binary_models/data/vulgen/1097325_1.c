void __init kasan_init ( void ) { phys_addr_t start , end ; u64 i ; pte_t zero_pte = pfn_pte ( virt_to_pfn ( kasan_early_shadow_page ) , PAGE_KERNEL_RO ) ; for_each_mem_range ( , , ) kasan_init_phys_region ( ( void * ) start , ( void * ) end ) ; if ( IS_ENABLED ( CONFIG_KASAN_VMALLOC ) ) { __set_pte_at ( & init_mm , ( unsigned long ) kasan_early_shadow_page , & kasan_early_shadow_pte [ i ] , zero_pte , 0 ) ; } for ( i = 0 ; i < PTRS_PER_PTE ; i ++ ) { __set_pte_at ( & init_mm , ( unsigned long ) kasan_early_shadow_page , & kasan_early_shadow_pte [ i ] , zero_pte , 0 ) ; } flush_tlb_kernel_range ( KASAN_SHADOW_START , KASAN_SHADOW_END ) ; memset ( kasan_early_shadow_page , 0 , PAGE_SIZE ) ; init_task . kasan_depth = 0 ; pr_info ( "KASAN init done\n" ) ; } 