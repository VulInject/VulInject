int verb_list_paths ( int argc , char * argv [ ] , void * userdata ) { _cleanup_set_free_ Set * replies = NULL ; _cleanup_strv_free_ char * * units = NULL ; _cleanup_free_ UnitInfo * unit_infos = NULL ; PathInfo * paths = NULL ; size_t n_paths = 0 ; sd_bus * bus ; int r ; r = acquire_bus ( BUS_MANAGER , & bus ) ; if ( r < 0 ) { return r ; } pager_open ( arg_pager_flags ) ; r = expand_unit_names ( bus , strv_skip ( argv , 1 ) , ".path" , & units , NULL ) ; if ( r < 0 ) { return r ; } if ( argc == 1 || units ) { int n ; n = get_unit_list_recursive ( bus , units , & unit_infos , & replies ) ; if ( n < 0 ) { return n ; } for ( const UnitInfo * u = unit_infos ; u < unit_infos + n ; u ++ ) { r = path_info_add ( bus , u , & paths , & n_paths ) ; if ( r < 0 ) { return r ; } } } typesafe_qsort ( paths , n_paths , path_info_compare ) ; output_paths_list ( paths , n_paths ) ; return 0 ; } 