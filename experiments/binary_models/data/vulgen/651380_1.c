static int SCLogTestInit02 ( void ) { SCLogInitData * sc_lid = NULL ; SCLogOPIfaceCtx * sc_iface_ctx = NULL ; char * logfile = SCLogGetLogFilename ( "boo.txt" ) ; sc_lid = SCLogAllocLogInitData ( ) ; FAIL_IF_NULL ( sc_lid ) ; sc_lid -> startup_message = "Test02" ; sc_lid -> global_log_level = SC_LOG_DEBUG ; sc_lid -> op_filter = "boo" ; sc_iface_ctx = SCLogInitOPIfaceCtx ( "file" , "%m - %d" , SC_LOG_WARNING , logfile ) ; SCLogAppendOPIfaceCtx ( sc_iface_ctx , sc_lid ) ; sc_iface_ctx = SCLogInitOPIfaceCtx ( "console" , NULL , SC_LOG_ERROR , NULL ) ; SCLogAppendOPIfaceCtx ( sc_iface_ctx , sc_lid ) ; SCLogInitLogModule ( sc_lid ) ; FAIL_IF_NULL ( sc_log_config ) ; FAIL_IF_NOT ( SC_LOG_DEBUG == sc_log_config -> log_level ) ; FAIL_IF_NOT ( sc_log_config -> op_ifaces != NULL && SC_LOG_OP_IFACE_FILE == sc_log_config -> op_ifaces -> iface ) ; FAIL_IF_NOT ( sc_log_config -> op_ifaces != NULL && sc_log_config -> op_ifaces -> next != NULL && SC_LOG_OP_IFACE_CONSOLE == sc_log_config -> op_ifaces -> next -> iface ) ; FAIL_IF_NOT ( sc_log_config -> log_format != NULL && strcmp ( SCLogGetDefaultLogFormat ( sc_log_config -> log_level ) , sc_log_config -> log_format ) == 0 ) ; FAIL_IF_NOT ( sc_log_config -> op_ifaces != NULL && sc_log_config -> op_ifaces -> log_format != NULL && strcmp ( "%m - %d" , sc_log_config -> op_ifaces -> log_format ) == 0 ) ; FAIL_IF_NOT ( sc_log_config -> op_ifaces != NULL && sc_log_config -> op_ifaces -> next != NULL && sc_log_config -> op_ifaces -> next -> log_format == NULL ) ; SCLogFreeLogInitData ( sc_lid ) ; SCLogDeInitLogModule ( ) ; sc_lid = SCLogAllocLogInitData ( ) ; FAIL_IF_NULL ( sc_lid ) ; sc_lid -> startup_message = "Test02" ; sc_lid -> global_log_level = SC_LOG_DEBUG ; sc_lid -> op_filter = "boo" ; sc_lid -> global_log_format = "kaboo" ; SCLogInitLogModule ( sc_lid ) ; FAIL_IF_NULL ( sc_log_config ) ; FAIL_IF_NOT ( SC_LOG_DEBUG == sc_log_config -> log_level ) ; FAIL_IF_NOT ( sc_log_config -> op_ifaces != NULL && SC_LOG_OP_IFACE_CONSOLE == sc_log_config -> op_ifaces -> iface ) ; FAIL_IF_NOT ( sc_log_config -> op_ifaces != NULL && sc_log_config -> op_ifaces -> next == NULL ) ; FAIL_IF_NOT ( sc_log_config -> log_format != NULL && strcmp ( "kaboo" , sc_log_config -> log_format ) == 0 ) ; FAIL_IF_NOT ( sc_log_config -> op_ifaces != NULL && sc_log_config -> op_ifaces -> log_format == NULL ) ; FAIL_IF_NOT ( sc_log_config -> op_ifaces != NULL && sc_log_config -> op_ifaces -> next == NULL ) ; SCLogFreeLogInitData ( sc_lid ) ; SCLogDeInitLogModule ( ) ; PASS ; } 