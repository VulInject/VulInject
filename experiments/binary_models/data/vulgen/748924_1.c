static int start_autofs_svcs ( void ) { int doorfd ; int dfd ; if ( ( doorfd = door_create ( autofs_doorfunc , NULL , DOOR_REFUSE_DESC | DOOR_NO_CANCEL ) ) == - 1 ) { syslog ( LOG_ERR , gettext ( "Unable to create door\n" ) ) ; return ( 1 ) ; } if ( ( dfd = open ( AUTOFS_DOOR , O_RDWR | O_CREAT | O_TRUNC , S_IRUSR | S_IWUSR | S_IRGRP | S_IROTH ) ) == - 1 ) { syslog ( LOG_ERR , "Unable to open %s: %m\n" , AUTOFS_DOOR ) ; ( void ) close ( doorfd ) ; return ( 1 ) ; } ( void ) fdetach ( AUTOFS_DOOR ) ; if ( fattach ( doorfd , AUTOFS_DOOR ) == - 1 ) { syslog ( LOG_ERR , "Unable to fattach door %m\n" , AUTOFS_DOOR ) ; ( void ) close ( dfd ) ; ( void ) close ( doorfd ) ; return ( 1 ) ; } autofs_setdoor ( doorfd ) ; while ( 1 ) { ( void ) pause ( ) ; } syslog ( LOG_ERR , gettext ( "Door server exited" ) ) ; return ( 10 ) ; } 