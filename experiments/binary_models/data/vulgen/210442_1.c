int mlx5_hv_vhca_init ( struct mlx5_hv_vhca * hv_vhca ) { struct mlx5_hv_vhca_agent * agent ; int err ; if ( IS_ERR_OR_NULL ( hv_vhca ) ) { return IS_ERR_OR_NULL ( hv_vhca ) ; } err = mlx5_hv_register_invalidate ( hv_vhca -> dev , hv_vhca , mlx5_hv_vhca_invalidate ) ; if ( err ) { return err ; } agent = mlx5_hv_vhca_control_agent_create ( hv_vhca ) ; if { mlx5_hv_unregister_invalidate ( hv_vhca -> dev ) ; return IS_ERR_OR_NULL ( agent ) ; } hv_vhca -> agents [ MLX5_HV_VHCA_AGENT_CONTROL ] = agent ; return 0 ; } 