static void dissect_gsm_map_ext2_qos_subscribed ( tvbuff_t * tvb , packet_info * pinfo _U_ , proto_tree * tree _U_ , asn1_ctx_t * actx ) { int offset = 0 ; proto_tree * subtree ; const gchar * str ; guint8 oct , tmp_oct ; guint32 temp32 ; int length = tvb_reported_length ( tvb ) ; oct = tvb_get_guint8 ( tvb , offset ) ; proto_tree_add_bits_item ( subtree , hf_gsm_map_spare_bits , tvb , ( offset << 3 ) , 3 , ENC_BIG_ENDIAN ) ; proto_tree_add_item ( subtree , hf_gsm_map_qos_signalling_ind , tvb , offset , 1 , ENC_BIG_ENDIAN ) ; tmp_oct = oct & 7 ; if ( tmp_oct == 0x01 ) { str = "speech" ; } else { str = "unknown" ; } proto_tree_add_uint_format_value ( subtree , hf_gsm_map_qos_source_stat_desc , tvb , offset , 1 , oct , "%s (%u)" , str , tmp_oct ) ; offset += 1 ; if ( length == offset ) { return ; } oct = tvb_get_guint8 ( tvb , offset ) ; if ( oct == 0x00 ) { str = "Use the value indicated by the Maximum bit rate for downlink" ; } else { temp32 = qos_calc_ext_bitrate ( oct ) ; if ( temp32 % 1000 == 0 ) { str = wmem_strdup_printf ( pinfo -> pool , "%u Mbps" , temp32 / 1000 ) ; } else { str = wmem_strdup_printf ( pinfo -> pool , "%u kbps" , temp32 ) ; } } proto_tree_add_uint_format_value ( subtree , hf_gsm_map_qos_max_bitrate_downl_ext , tvb , offset , 1 , oct , "%s (%u)" , str , oct ) ; offset += 1 ; if ( length == offset ) { return ; } oct = tvb_get_guint8 ( tvb , offset ) ; if ( oct == 0x00 ) { str = "Use the value indicated by the Guaranteed bit rate for downlink" ; } else { temp32 = qos_calc_ext_bitrate ( oct ) ; if ( temp32 % 1000 == 0 ) { str = wmem_strdup_printf ( pinfo -> pool , "%u Mbps" , temp32 / 1000 ) ; } else { str = wmem_strdup_printf ( pinfo -> pool , "%u kbps" , temp32 ) ; } } proto_tree_add_uint_format_value ( subtree , hf_gsm_map_qos_guar_bitrate_downl_ext , tvb , offset , 1 , oct , "%s (%u)" , str , oct ) ; } 