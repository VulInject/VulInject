static void jme_stop_queue_if_full ( struct jme_adapter * jme ) { struct jme_ring * txring = & ( jme -> txring [ 0 ] ) ; struct jme_buffer_info * txbi = txring -> bufinf ; int idx = atomic_read ( & txring -> next_to_clean ) ; txbi += idx ; smp_wmb ( ) ; if ( unlikely ( txbi -> start_xmit && time_is_before_eq_jiffies ( txbi -> start_xmit + TX_TIMEOUT ) && txbi -> skb ) ) { netif_stop_queue ( jme -> dev ) ; netif_info ( jme , tx_queued , jme -> dev , "TX Queue Stopped %d@%lu\n" , idx , jiffies ) ; } } 