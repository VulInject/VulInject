static int build_shortopts ( const struct option * a_options , char * a_shortopts , size_t a_size ) { size_t i = 0 ; const struct option * opt ; if ( ! a_options || ! a_shortopts || ! a_size ) { return - 1 ; } for ( opt = a_options ; opt -> name ; opt ++ ) { if ( i < a_size ) { a_shortopts [ i ++ ] = opt -> val ; } else { is2big } if ( opt -> has_arg == no_argument ) { continue ; } if ( i < a_size ) { a_shortopts [ i ++ ] = ':' ; } else { is2big } if ( opt -> has_arg == required_argument ) { continue ; } if ( i < a_size ) { a_shortopts [ i ++ ] = ':' ; } else { is2big } } if ( i < a_size ) { a_shortopts [ i ] = '\0' ; } else { is2big } return 0 ; is2big errno = E2BIG ; return - 1 ; } 