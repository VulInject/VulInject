static TSK_WALK_RET_ENUM slack_file_act ( TSK_FS_FILE * fs_file , TSK_OFF_T a_off , TSK_DADDR_T addr , char * buf , size_t size , TSK_FS_BLOCK_FLAG_ENUM flags , void * ptr ) { BLKLS_DATA * data = ( BLKLS_DATA * ) ptr ; if ( tsk_verbose ) { tsk_fprintf ( stderr , "slack_file_act: File: %" PRIuINUM " Remaining File:  %" PRIdOFF "  Buffer: %u\n" , fs_file -> meta -> addr , data -> flen , size ) ; } if ( data -> flen >= ( TSK_OFF_T ) size ) { data -> flen -= size ; } else { if ( data -> flen != 0 ) { data -> flen = 0 ; } if ( fwrite ( buf , size , 1 , stdout ) != 1 ) { tsk_error_reset ( ) ; tsk_error_set_errno ( TSK_ERR_FS_WRITE ) ; tsk_error_set_errstr ( "blkls_lib: error writing to stdout: %s" , strerror ( errno ) ) ; return TSK_WALK_ERROR ; } } return TSK_WALK_CONT ; } 