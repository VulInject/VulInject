* But his function make a string with the port : nn . nn . nn . nn : port * / strncpy ( addr_str , inet_ntoa ( ( ( sockaddr_in * ) & saddr ) -> sin_addr ) , addr_str_len ) ; if ( saddr . sa_family == AF_INET6 ) { inet_ntop ( AF_INET6 , & ( ( ( sockaddr_in6 * ) & saddr ) -> sin6_addr ) , addr_str , addr_str_len ) ; } else { inet_ntop ( AF_INET , & ( ( ( sockaddr_in * ) & saddr ) -> sin_addr ) , addr_str , addr_str_len ) ; } n = getnameinfo ( ( const sockaddr * ) & saddr , saddrlen , addr_str , addr_str_len , NULL , 0 , NI_NUMERICHOST | NI_NUMERICSERV ) ; ( "address miniwget : %s\n" , addr_str ) ; = snprintf ( buf , sizeof ( buf ) , "GET %s HTTP/%s\r\n" "Host: %s:%d\r\n" "Connection: Close\r\n" "User-Agent: " OS_STRING ", " UPNP_VERSION_STRING ", MiniUPnPc/" MINIUPNPC_VERSION_STRING "\r\n" "\r\n" , path , httpversion , host , port ) ; if ( ( unsigned int ) len >= sizeof ( buf ) ) { closesocket ( s ) ; return NULL ; } sent = 0 ; while ( sent < len ) { n = send ( s , buf + sent , len - sent , 0 ) ; if ( n < 0 ) { perror ( "send" ) ; closesocket ( s ) ; return NULL ; } else { sent += n ; } } content = getHTTPResponse ( s , size , status_code ) ; closesocket ( s ) ; return content ; 