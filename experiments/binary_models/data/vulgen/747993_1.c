bool cyapa_sort_tsg_pip_app_resp_data ( struct cyapa * cyapa , u8 * data , int len ) { struct cyapa_pip_cmd_states * pip = & cyapa -> cmd_states . pip ; int resp_len ; if ( data [ PIP_RESP_REPORT_ID_OFFSET ] == PIP_APP_RESP_REPORT_ID && data [ PIP_RESP_RSVD_OFFSET ] == PIP_RESP_RSVD_KEY ) { resp_len = get_unaligned_le16 ( & data [ PIP_RESP_LENGTH_OFFSET ] ) ; if ( GET_PIP_CMD_CODE ( data [ PIP_RESP_APP_CMD_OFFSET ] ) == 0x00 && resp_len == PIP_UNSUPPORTED_CMD_RESP_LENGTH && data [ 5 ] == pip -> in_progress_cmd ) { return false ; } if ( GET_PIP_CMD_CODE ( data [ PIP_RESP_APP_CMD_OFFSET ] ) == pip -> in_progress_cmd ) { return true ; } } return false ; } 