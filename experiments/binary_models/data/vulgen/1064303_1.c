AppLayerParserThreadCtx * AppLayerParserThreadCtxAlloc ( void ) { SCEnter ( ) ; if ( tctx == NULL ) { end } for ( uint8_t flow_proto = 0 ; flow_proto < FLOW_PROTO_DEFAULT ; flow_proto ++ ) { for ( AppProto alproto = 0 ; alproto < ALPROTO_MAX ; alproto ++ ) { uint8_t ipproto = FlowGetReverseProtoMapping ( flow_proto ) ; tctx -> alproto_local_storage [ flow_proto ] [ alproto ] = AppLayerParserGetProtocolParserLocalStorage ( ipproto , alproto ) ; } } end SCReturnPtr ( tctx , "void *" ) ; } 