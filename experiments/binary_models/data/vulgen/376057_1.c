static void dissect_DATA_v1 ( tvbuff_t * tvb , packet_info * pinfo , gint offset , guint8 flags , const guint encoding , int octets_to_next_header , proto_tree * tree ) { int min_len ; gboolean is_builtin_entity = FALSE ; gint old_offset = offset ; guint32 wid ; proto_item * octet_item ; proto_tree_add_bitmask_value ( tree , tvb , offset + 1 , hf_rtps_sm_flags , ett_rtps_flags , DATA_FLAGSv1 , flags ) ; octet_item = proto_tree_add_item ( tree , hf_rtps_sm_octets_to_next_header , tvb , offset + 2 , 2 , encoding ) ; min_len = 20 ; if ( ( flags & FLAG_DATA_H ) != 0 ) { min_len += 8 ; } if ( ( flags & FLAG_DATA_Q ) != 0 ) { min_len += 4 ; } if ( ( flags & FLAG_DATA_D ) != 0 ) { min_len += 4 ; } offset += 4 ; is_builtin_entity |= rtps_util_add_entity_id ( tree , tvb , offset , hf_rtps_sm_rdentity_id , hf_rtps_sm_rdentity_id_key , hf_rtps_sm_rdentity_id_kind , ett_rtps_rdentity , "readerEntityId" , NULL ) ; offset += 4 ; is_builtin_entity |= rtps_util_add_entity_id ( tree , tvb , offset , hf_rtps_sm_wrentity_id , hf_rtps_sm_wrentity_id_key , hf_rtps_sm_wrentity_id_kind , ett_rtps_wrentity , "writerEntityId" , & wid ) ; offset += 4 ; if ( wid == ENTITYID_BUILTIN_PUBLICATIONS_WRITER && ( flags & FLAG_DATA_A ) != 0 ) { col_append_str ( pinfo -> cinfo , COL_INFO , SM_EXTRA_WPLUS ) ; } if ( wid == ENTITYID_BUILTIN_PUBLICATIONS_WRITER && ( flags & FLAG_DATA_A ) == 0 ) { col_append_str ( pinfo -> cinfo , COL_INFO , SM_EXTRA_WMINUS ) ; } if ( wid == ENTITYID_BUILTIN_SUBSCRIPTIONS_WRITER && ( flags & FLAG_DATA_A ) != 0 ) { col_append_str ( pinfo -> cinfo , COL_INFO , SM_EXTRA_RPLUS ) ; } if ( wid == ENTITYID_BUILTIN_SUBSCRIPTIONS_WRITER && ( flags & FLAG_DATA_A ) == 0 ) { col_append_str ( pinfo -> cinfo , COL_INFO , SM_EXTRA_RMINUS ) ; } if ( wid == ENTITYID_BUILTIN_PARTICIPANT_WRITER && ( flags & FLAG_DATA_A ) != 0 ) { col_append_str ( pinfo -> cinfo , COL_INFO , SM_EXTRA_PPLUS ) ; } if ( wid == ENTITYID_BUILTIN_PARTICIPANT_WRITER && ( flags & FLAG_DATA_A ) == 0 ) { col_append_str ( pinfo -> cinfo , COL_INFO , SM_EXTRA_PMINUS ) ; } if ( wid == ENTITYID_BUILTIN_TOPIC_WRITER && ( flags & FLAG_DATA_A ) != 0 ) { col_append_str ( pinfo -> cinfo , COL_INFO , SM_EXTRA_TPLUS ) ; } if ( wid == ENTITYID_BUILTIN_TOPIC_WRITER && ( flags & FLAG_DATA_A ) == 0 ) { col_append_str ( pinfo -> cinfo , COL_INFO , SM_EXTRA_TMINUS ) ; } if ( ( flags & FLAG_DATA_H ) != 0 ) { rtps_util_add_guid_prefix_v1 ( tree , tvb , offset , hf_rtps_sm_guid_prefix_v1 , hf_rtps_sm_host_id , hf_rtps_sm_app_id , hf_rtps_sm_instance_id_v1 , hf_rtps_sm_app_kind , "keyHashPrefix" ) ; offset += 8 ; } else { } rtps_util_add_entity_id ( tree , tvb , offset , hf_rtps_sm_entity_id , hf_rtps_sm_entity_id_key , hf_rtps_sm_entity_id_kind , ett_rtps_entity , "keyHashSuffix" , NULL ) ; offset += 4 ; rtps_util_add_seq_number ( tree , tvb , offset , encoding , "writerSeqNumber" ) ; offset += 8 ; if ( ( flags & FLAG_DATA_Q ) != 0 ) { gboolean is_inline_qos = TRUE ; offset = dissect_parameter_sequence ( tree , pinfo , tvb , offset , encoding , octets_to_next_header , "inlineQos" , 0x0102 , NULL , 0 , is_inline_qos , NULL ) ; } if ( ( flags & FLAG_DATA_D ) != 0 ) { if ( is_builtin_entity ) { dissect_parameter_sequence ( tree , pinfo , tvb , offset , encoding , octets_to_next_header , "serializedData" , 0x0102 , NULL , 0 , FALSE , NULL ) ; } else { proto_tree_add_item ( tree , hf_rtps_issue_data , tvb , offset , octets_to_next_header - ( offset - old_offset ) + 4 , ENC_NA ) ; } } } 