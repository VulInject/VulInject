BOOL WINAPI Win32_WTSVirtualChannelWrite ( HANDLE hChannel , LPCVOID lpBuffer , DWORD nNumberOfBytesToWrite , LPDWORD lpNumberOfBytesTransferred ) { OVERLAPPED overlapped = { 0 } ; WTSAPI_CHANNEL * pChannel = ( WTSAPI_CHANNEL * ) hChannel ; if ( ! pChannel || ( pChannel -> magic != WTSAPI_CHANNEL_MAGIC ) ) { SetLastError ( ERROR_INVALID_PARAMETER ) ; return FALSE ; } if ( GetLastError ( ) == ERROR_IO_PENDING ) { return GetOverlappedResult ( pChannel -> hFile , & overlapped , lpNumberOfBytesTransferred , TRUE ) ; } return FALSE ; } 