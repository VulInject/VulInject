static void remap_memory ( MPS2TZMachineState * mms , int map ) { MPS2TZMachineClass * mmc = MPS2TZ_MACHINE_GET_CLASS ( mms ) ; int i ; memory_region_transaction_begin ( ) ; for ( i = 0 ; i < 2 ; i ++ ) { TZMPC * mpc = & mms -> mpc [ i ] ; MemoryRegion * upstream = sysbus_mmio_get_region ( SYS_BUS_DEVICE ( mpc ) , 1 ) ; hwaddr addr = ( i ^ map ) ?0x28000000 : 0 ; memory_region_set_address ( upstream , addr ) ; } memory_region_transaction_commit ( ) ; } 