static void * session_keys_copy_cb ( void * n , const void * o , size_t siz _U_ ) { session_key_t * new_rec = ( session_key_t * ) n ; const session_key_t * old_rec = ( const session_key_t * ) o ; if ( old_rec -> dev_addr_string ) { new_rec -> dev_addr_string = g_strdup ( old_rec -> dev_addr_string ) ; GByteArray * addr = g_byte_array_new ( ) ; if ( hex_str_to_bytes ( new_rec -> dev_addr_string , addr , FALSE ) ) { if ( addr -> len == 4 ) { byte_array_reverse ( addr ) ; memcpy ( & new_rec -> dev_addr , addr -> data , sizeof ( new_rec -> dev_addr ) ) ; } else { new_rec -> dev_addr = 0 ; } } } else { new_rec -> dev_addr_string = NULL ; new_rec -> dev_addr = 0 ; } if ( old_rec -> nwkskey_string ) { new_rec -> nwkskey_string = g_strdup ( old_rec -> nwkskey_string ) ; new_rec -> nwkskey = g_byte_array_new ( ) ; hex_str_to_bytes ( new_rec -> nwkskey_string , new_rec -> nwkskey , FALSE ) ; } else { new_rec -> nwkskey_string = NULL ; new_rec -> nwkskey = NULL ; } if ( old_rec -> appskey_string ) { new_rec -> appskey_string = g_strdup ( old_rec -> appskey_string ) ; new_rec -> appskey = g_byte_array_new ( ) ; hex_str_to_bytes ( new_rec -> appskey_string , new_rec -> appskey , FALSE ) ; } else { new_rec -> appskey_string = NULL ; new_rec -> appskey = NULL ; } return new_rec ; } 