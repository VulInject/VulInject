static void test_icr ( struct xapic_vcpu * x ) { struct kvm_vcpu * vcpu = x -> vcpu ; uint64_t icr , i , j ; icr = APIC_DEST_SELF | APIC_INT_ASSERT | APIC_DM_FIXED ; for ( i = 0 ; i <= 0xff ; i ++ ) { __test_icr ( x , icr | i ) ; } icr = APIC_INT_ASSERT | APIC_DM_FIXED ; for ( i = 0 ; i <= 0xff ; i ++ ) { __test_icr ( x , icr | i ) ; } icr = APIC_INT_ASSERT | 0xff ; for ( i = 0 ; i < 0xff ; i ++ ) { for ( j = 0 ; j < 8 ; j ++ ) { __test_icr ( x , i << ( 32 + 24 ) | icr | ( j << 8 ) ) ; } } icr = APIC_DEST_ALLBUT | APIC_INT_ASSERT ; for ( i = 0 ; i < 8 ; i ++ ) { __test_icr ( x , icr | ( i << 8 ) ) ; } __test_icr ( x , 0xa5a5a5a5a5a5a5a5 & ~ APIC_DM_FIXED_MASK ) ; __test_icr ( x , 0x5a5a5a5a5a5a5a5a & ~ APIC_DM_FIXED_MASK ) ; __test_icr ( x , - 1ull & ~ APIC_DM_FIXED_MASK ) ; } 