static void sis900_set_mode ( struct sis900_private * sp , int speed , int duplex ) { void __iomem * ioaddr = sp -> ioaddr ; u32 tx_flags = 0 , rx_flags = 0 ; if ( sr32 ( cfg ) & EDB_MASTER_EN ) { tx_flags = TxATP | ( DMA_BURST_64 << TxMXDMA_shift ) | ( TX_FILL_THRESH << TxFILLT_shift ) ; rx_flags = DMA_BURST_64 << RxMXDMA_shift ; } else { tx_flags = TxATP | ( DMA_BURST_512 << TxMXDMA_shift ) | ( TX_FILL_THRESH << TxFILLT_shift ) ; rx_flags = DMA_BURST_512 << RxMXDMA_shift ; } if ( speed == HW_SPEED_HOME || speed == HW_SPEED_10_MBPS ) { rx_flags |= ( RxDRNT_10 << RxDRNT_shift ) ; tx_flags |= ( TxDRNT_10 << TxDRNT_shift ) ; } else { rx_flags |= ( RxDRNT_100 << RxDRNT_shift ) ; tx_flags |= ( TxDRNT_100 << TxDRNT_shift ) ; } if ( duplex == FDX_CAPABLE_FULL_SELECTED ) { tx_flags |= ( TxCSI | TxHBI ) ; rx_flags |= RxATX ; } sw32 ( txcfg , tx_flags ) ; sw32 ( rxcfg , rx_flags ) ; } 