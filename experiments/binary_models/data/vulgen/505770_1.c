static int __init param_setup ( char * string ) { char * pos = string , * next ; int slot = - 1 , siop = - 1 ; while ( pos != NULL && ( next = strchr ( pos , ':' ) ) != NULL ) { int val = ( int ) simple_strtoul ( ++ next , NULL , 0 ) ; if ( ! strncmp ( pos , "slot:" , 5 ) ) { slot = val ; } if ( ! strncmp ( pos , "siop:" , 5 ) ) { siop = val ; } if ( ! strncmp ( pos , "id:" , 3 ) ) { if ( slot == - 1 ) { printk ( KERN_WARNING "NCR D700: Must specify slot for id parameter\n" ) ; } if ( slot > MCA_MAX_SLOT_NR ) { printk ( KERN_WARNING "NCR D700: Illegal slot %d for id %d\n" , slot , val ) ; } else { if ( siop != 0 && siop != 1 ) { id_array [ slot * 2 ] = val ; id_array [ slot * 2 + 1 ] = val ; } else { id_array [ slot * 2 + siop ] = val ; } } } if ( ( pos = strchr ( pos , ARG_SEP ) ) != NULL ) { pos ++ ; } } return 1 ; } static struct scsi_host_template NCR_D700_driver_template = { . module = THIS_MODULE . name = "NCR Dual 700 MCA" . proc_name = "NCR_D700" . this_id = 7 } ; NCR_D700_private { struct device * dev ; struct Scsi_Host * hosts [ 2 ] ; char name [ 30 ] ; } 