static void destroy_client ( svc_rpc_gss_data * client_data ) { OM_uint32 minor ; int index = ( client_data -> key & HASHMASK ) ; if ( client_data -> prev == NULL ) { clients [ index ] = client_data -> next ; } else { client_data -> prev -> next = client_data -> next ; } if ( client_data -> next != NULL ) { client_data -> next -> prev = client_data -> prev ; } if ( client_data -> lru_prev == NULL ) { lru_first = client_data -> lru_next ; } else { client_data -> lru_prev -> lru_next = client_data -> lru_next ; } if ( client_data -> lru_next != NULL ) { client_data -> lru_next -> lru_prev = client_data -> lru_prev ; } else { lru_last = client_data -> lru_prev ; } if ( client_data -> context != GSS_C_NO_CONTEXT ) { ( void ) gss_delete_sec_context ( & minor , & client_data -> context , NULL ) ; if ( client_data -> client_name ) { ( void ) gss_release_name ( & minor , & client_data -> client_name ) ; } free ( client_data -> raw_cred . client_principal ) ; free ( client_data -> u_cred . gidlist ) ; if ( client_data -> deleg != GSS_C_NO_CREDENTIAL ) { ( void ) gss_release_cred ( & minor , & client_data -> deleg ) ; } } free ( client_data ) ; num_gss_contexts -- ; } 