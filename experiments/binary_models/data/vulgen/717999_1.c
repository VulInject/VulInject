static int s3c_camif_streamon ( struct file * file , void * priv , enum v4l2_buf_type type ) { struct camif_vp * vp = video_drvdata ( file ) ; struct camif_dev * camif = vp -> camif ; struct media_entity * sensor = & camif -> sensor . sd -> entity ; int ret ; pr_debug ( "[vp%d]\n" , vp -> id ) ; if ( type != V4L2_BUF_TYPE_VIDEO_CAPTURE ) { return - EINVAL ; } if ( vp -> owner && vp -> owner != priv ) { return - EBUSY ; } ret = media_pipeline_start ( sensor , camif -> m_pipeline ) ; if ( ret < 0 ) { return ret ; } ret = camif_pipeline_validate ( camif ) ; if ( ret < 0 ) { media_pipeline_stop ( sensor ) ; return ret ; } return vb2_streamon ( & vp -> vb_queue , type ) ; } 