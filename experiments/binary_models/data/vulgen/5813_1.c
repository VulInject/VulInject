void TestPartition ( L_REGPARAMS * rp , const char * fname , l_int32 sorttype , l_int32 maxboxes , l_int32 ovlap , const char * fileout , PIXA * pixad ) { char pathout [ 256 ] ; l_int32 w , h ; BOX * box ; BOXA * boxa1 , * boxa2 , * boxa3 ; PIX * pix , * pix1 , * pix2 , * pix3 , * pix4 ; PIXA * pixa ; pixa = pixaCreate ( 0 ) ; pix = pixRead ( fname ) ; pixaAddPix ( pixa , pix , L_COPY ) ; pix1 = pixConvertTo1 ( pix , 128 ) ; pixDilateBrick ( pix1 , pix1 , 5 , 5 ) ; pixaAddPix ( pixa , pix1 , L_COPY ) ; boxa1 = pixConnComp ( pix1 , NULL , 4 ) ; pixGetDimensions ( pix1 , & w , & h , NULL ) ; box = boxCreate ( 0 , 0 , w , h ) ; startTimer ( ) ; boxa2 = boxaSelectBySize ( boxa1 , 500 , 500 , L_SELECT_IF_BOTH , L_SELECT_IF_LT , NULL ) ; pix2 = pixCopyWithBoxa ( pix1 , boxa2 , L_SET_WHITE ) ; pixaAddPix ( pixa , pix2 , L_COPY ) ; boxa3 = boxaGetWhiteblocks ( boxa2 , box , sorttype , maxboxes , ovlap , 200 , 0.15 , 20000 ) ; pix3 = pixDrawBoxaRandom ( pix2 , boxa3 , 7 ) ; pixaAddPix ( pixa , pix3 , L_INSERT ) ; pix3 = pixPaintBoxaRandom ( pix2 , boxa3 ) ; pixaAddPix ( pixa , pix3 , L_INSERT ) ; snprintf ( pathout , sizeof ( pathout ) , "/tmp/lept/part/%s" , fileout ) ; lept_stderr ( "Writing to: %s\n" , pathout ) ; pixaConvertToPdf ( pixa , 300 , 1.0 , L_FLATE_ENCODE , 0 , fileout , pathout ) ; regTestCheckFile ( rp , pathout ) ; if ( rp -> display ) { pix4 = pixaDisplayTiledInColumns ( pixa , 1 , 0.7 , 20 , 2 ) ; pixaAddPix ( pixad , pix4 , L_INSERT ) ; } pixDestroy ( & pix ) ; pixDestroy ( & pix1 ) ; pixDestroy ( & pix2 ) ; pixaDestroy ( & pixa ) ; boxDestroy ( & box ) ; boxaDestroy ( & boxa1 ) ; boxaDestroy ( & boxa2 ) ; boxaDestroy ( & boxa3 ) ; } 