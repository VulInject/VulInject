struct drbd_interval * drbd_find_overlap ( struct rb_root * root , sector_t sector , unsigned int size ) { struct rb_node * node = root -> rb_node ; struct drbd_interval * overlap = NULL ; sector_t end = sector + ( size >> 9 ) ; BUG_ON ( ! IS_ALIGNED ( size , 512 ) ) ; while ( node ) { struct drbd_interval * here = rb_entry ( node , drbd_interval , rb ) ; if ( node -> rb_left && sector < interval_end ( node -> rb_left ) ) { node = node -> rb_left ; } if ( here -> sector < end && sector < here -> sector + ( here -> size >> 9 ) ) { overlap = here ; break ; } else { break ; } } return overlap ; } 