static void vio_legacy_del_vq ( VirtIOQueueInfo * info ) { struct virtqueue * vq = info -> vq ; VirtIODevice * vdev = vq -> vdev ; iowrite16 ( vdev , ( u16 ) vq -> index , vdev -> addr + VIRTIO_PCI_QUEUE_SEL ) ; if ( vdev -> msix_used ) { iowrite16 ( vdev , VIRTIO_MSI_NO_VECTOR , vdev -> addr + VIRTIO_MSI_QUEUE_VECTOR ) ; ioread8 ( vdev , vdev -> addr + VIRTIO_PCI_ISR ) ; } iowrite32 ( vdev , 0 , vdev -> addr + VIRTIO_PCI_QUEUE_PFN ) ; } 