rdpGraphics * graphics_new ( rdpContext * context ) { rdpGraphics * graphics ; graphics = ( rdpGraphics * ) calloc ( 1 , sizeof ( rdpGraphics ) ) ; if ( graphics ) { graphics -> context = context ; graphics -> Bitmap_Prototype = ( rdpBitmap * ) calloc ( 1 , sizeof ( rdpBitmap ) ) ; if ( ! graphics -> Bitmap_Prototype ) { return NULL ; } graphics -> Bitmap_Prototype -> size = sizeof ( rdpBitmap ) ; graphics -> Pointer_Prototype = ( rdpPointer * ) calloc ( 1 , sizeof ( rdpPointer ) ) ; if ( ! graphics -> Pointer_Prototype ) { free ( graphics -> Bitmap_Prototype ) ; free ( graphics ) ; return NULL ; } graphics -> Pointer_Prototype -> size = sizeof ( rdpPointer ) ; graphics -> Glyph_Prototype = ( rdpGlyph * ) calloc ( 1 , sizeof ( rdpGlyph ) ) ; if ( ! graphics -> Glyph_Prototype ) { free ( graphics -> Pointer_Prototype ) ; free ( graphics -> Bitmap_Prototype ) ; free ( graphics ) ; return NULL ; } graphics -> Glyph_Prototype -> size = sizeof ( rdpGlyph ) ; } return graphics ; } 