static int DetectByteMathParseTest13 ( void ) { DetectByteMathData * bmd = DetectByteMathParse ( NULL , "bytes 4, offset 2, oper +, " "rvalue 39, result bar, " "relative,  string dec, bitmask " "0x8f40" , NULL ) ; FAIL_IF ( bmd == NULL ) ; FAIL_IF_NOT ( bmd -> nbytes == 4 ) ; FAIL_IF_NOT ( bmd -> offset == 2 ) ; FAIL_IF_NOT ( bmd -> oper == Addition ) ; FAIL_IF_NOT ( bmd -> rvalue == 39 ) ; FAIL_IF_NOT ( strcmp ( bmd -> result , "bar" ) == 0 ) ; FAIL_IF_NOT ( bmd -> bitmask_val == 0x8f40 ) ; FAIL_IF_NOT ( bmd -> bitmask_shift_count == 6 ) ; FAIL_IF_NOT ( bmd -> flags == flags ) ; FAIL_IF_NOT ( bmd -> endian == BigEndian ) ; FAIL_IF_NOT ( bmd -> base == BaseDec ) ; DetectByteMathFree ( NULL , bmd ) ; PASS ; } 