int dsa_set_pqg ( const unsigned char * p , unsigned long plen , const unsigned char * q , unsigned long qlen , const unsigned char * g , unsigned long glen , dsa_key * key ) { int err , stat ; LTC_ARGCHK ( p != NULL ) ; LTC_ARGCHK ( q != NULL ) ; LTC_ARGCHK ( g != NULL ) ; LTC_ARGCHK ( key != NULL ) ; LTC_ARGCHK ( ltc_mp . name != NULL ) ; err = mp_init_multi ( & key -> p , & key -> g , & key -> q , & key -> x , & key -> y , LTC_NULL ) ; if ( err != CRYPT_OK ) { return err ; } if ( ( err = mp_read_unsigned_bin ( key -> p , ( unsigned char * ) p , plen ) ) != CRYPT_OK ) { LBL_ERR } if ( ( err = mp_read_unsigned_bin ( key -> g , ( unsigned char * ) g , glen ) ) != CRYPT_OK ) { LBL_ERR } if ( ( err = mp_read_unsigned_bin ( key -> q , ( unsigned char * ) q , qlen ) ) != CRYPT_OK ) { LBL_ERR } if ( ( err = dsa_int_validate_pqg ( key , & stat ) ) != CRYPT_OK ) { LBL_ERR } if ( stat == 0 ) { err = CRYPT_INVALID_PACKET ; LBL_ERR } return CRYPT_OK ; LBL_ERR dsa_free ( key ) ; return err ; } 