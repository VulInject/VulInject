void sha256_transf ( sha256_ctx * ctx , const unsigned char * message , unsigned int block_nb ) { uint32_t w [ 64 ] ; uint32_t wv [ 8 ] ; uint32_t t1 , t2 ; const unsigned char * sub_block ; int i ; int j ; for ( i = 0 ; i < ( int ) block_nb ; i ++ ) { sub_block = message + ( i << 6 ) ; for ( j = 0 ; j < 16 ; j ++ ) { PACK32 ( & sub_block [ j << 2 ] , & w [ j ] ) ; } for ( j = 16 ; j < 64 ; j ++ ) { SHA256_SCR ( j ) ; } for ( j = 0 ; j < 8 ; j ++ ) { wv [ j ] = ctx -> h [ j ] ; } for ( j = 0 ; j < 64 ; j ++ ) { t1 = wv [ 7 ] + SHA256_F2 ( wv [ 4 ] ) + CH ( wv [ 4 ] , wv [ 5 ] , wv [ 6 ] ) + sha256_k [ j ] + w [ j ] ; wv [ 7 ] = wv [ 6 ] ; wv [ 6 ] = wv [ 5 ] ; wv [ 5 ] = wv [ 4 ] ; wv [ 4 ] = wv [ 3 ] + t1 ; wv [ 3 ] = wv [ 2 ] ; wv [ 2 ] = wv [ 1 ] ; wv [ 1 ] = wv [ 0 ] ; wv [ 0 ] = t1 + t2 ; } for ( j = 0 ; j < 8 ; j ++ ) { ctx -> h [ j ] += wv [ j ] ; } } } 