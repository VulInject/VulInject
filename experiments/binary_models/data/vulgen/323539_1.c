void SpectatorClientEndFrame ( gentity_t * ent ) { gclient_t * cl ; if ( ent -> client -> sess . spectatorState == SPECTATOR_FOLLOW ) { int clientNum , flags ; clientNum = ent -> client -> sess . spectatorClient ; if ( clientNum == - 1 ) { clientNum = level . follow1 ; } if ( clientNum == - 2 ) { clientNum = level . follow2 ; } if ( clientNum >= 0 ) { cl = & level . clients [ clientNum ] ; if ( cl -> pers . connected == CON_CONNECTED && cl -> sess . sessionTeam != TEAM_SPECTATOR ) { flags = ( cl -> ps . eFlags & ~ ( EF_VOTED | EF_TEAMVOTED ) ) | ( ent -> client -> ps . eFlags & ( EF_VOTED | EF_TEAMVOTED ) ) ; ent -> client -> ps = cl -> ps ; ent -> client -> ps . pm_flags |= PMF_FOLLOW ; ent -> client -> ps . eFlags = flags ; return ; } } if ( ent -> client -> ps . pm_flags & PMF_FOLLOW ) { ClientBegin ( ent -> client - level . clients ) ; } } if ( ent -> client -> sess . spectatorState == SPECTATOR_SCOREBOARD ) { ent -> client -> ps . pm_flags |= PMF_SCOREBOARD ; } else { ent -> client -> ps . pm_flags &= ~ PMF_SCOREBOARD ; } } 