( xfrm4_tunnel_deregister ) ; for ( handler = rcu_dereference ( head ) ; handler != NULL ; handler = rcu_dereference ( handler -> next ) ) { static int tunnel4_rcv ( struct sk_buff * skb ) { struct xfrm_tunnel * handler ; if ( ! pskb_may_pull ( skb , sizeof ( iphdr ) ) ) { drop } for_each_tunnel_rcu ( , ) icmp_send ( skb , ICMP_DEST_UNREACH , ICMP_PORT_UNREACH , 0 ) ; drop kfree_skb ( skb ) ; return 0 ; } } 