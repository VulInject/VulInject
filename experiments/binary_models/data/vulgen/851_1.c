test_bson_b64_encode ( ) { int ret ; _test_encode_helper ( "" , 0 , "" , 0 ) ; _test_encode_helper ( "f" , 1 , "Zg==" , 4 ) ; _test_encode_helper ( "fo" , 2 , "Zm8=" , 4 ) ; _test_encode_helper ( "foo" , 3 , "Zm9v" , 4 ) ; _test_encode_helper ( "foob" , 4 , "Zm9vYg==" , 8 ) ; _test_encode_helper ( "fooba" , 5 , "Zm9vYmE=" , 8 ) ; _test_encode_helper ( "foobar" , 6 , "Zm9vYmFy" , 8 ) ; output [ 0 ] = 'a' ; ret = mcommon_b64_ntop ( ( uint8_t * ) "" , 0 , output , 1 ) ; ASSERT_CMPINT ( ret , == , 0 ) ; BSON_ASSERT ( output [ 0 ] == '\0' ) ; ret = mcommon_b64_ntop ( NULL , 0 , output , 32 ) ; ASSERT_CMPINT ( 0 , == , ret ) ; BSON_ASSERT ( output [ 0 ] == '\0' ) ; ret = mcommon_b64_ntop ( NULL , 0 , NULL , 0 ) ; ASSERT_CMPINT ( - 1 , == , ret ) ; ret = mcommon_b64_ntop ( ( uint8_t * ) "test" , 4 , output , 1 ) ; ASSERT_CMPINT ( - 1 , == , ret ) ; } 