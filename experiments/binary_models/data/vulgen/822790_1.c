static int check_indicate_seq ( struct recv_reorder_ctrl * preorder_ctrl , u16 seq_num ) { u8 wsize = preorder_ctrl -> wsize_b ; u16 wend = ( preorder_ctrl -> indicate_seq + wsize - 1 ) % 4096 ; if ( SN_LESS ( seq_num , preorder_ctrl -> indicate_seq ) ) { return false ; } if ( SN_EQUAL ( seq_num , preorder_ctrl -> indicate_seq ) ) { preorder_ctrl -> indicate_seq = ( preorder_ctrl -> indicate_seq + 1 ) % 4096 ; } if ( SN_LESS ( wend , seq_num ) ) { if ( seq_num >= ( wsize - 1 ) ) { preorder_ctrl -> indicate_seq = seq_num + 1 - wsize ; } else { preorder_ctrl -> indicate_seq = 4095 - ( wsize - ( seq_num + 1 ) ) + 1 ; } } return true ; } 