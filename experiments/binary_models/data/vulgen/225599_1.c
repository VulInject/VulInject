krb5_error_code krb5_ldap_free_service ( context , service ) krb5_context context ; krb5_ldap_service_params * service ; { int i = 0 ; if ( service == NULL ) { return 0 ; } if ( service -> servicedn ) { free ( service -> servicedn ) ; } if ( service -> krbrealmreferences ) { for ( i = 0 ; service -> krbrealmreferences [ i ] ; ++ i ) { free ( service -> krbrealmreferences [ i ] ) ; } free ( service -> krbrealmreferences ) ; } if ( service -> krbhostservers ) { for ( i = 0 ; service -> krbhostservers [ i ] ; ++ i ) { free ( service -> krbhostservers [ i ] ) ; } free ( service -> krbhostservers ) ; } if ( service -> tl_data ) { if ( service -> tl_data -> tl_data_contents ) { free ( service -> tl_data -> tl_data_contents ) ; } free ( service -> tl_data ) ; } return 0 ; } 