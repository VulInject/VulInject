static gchar * f5_ip_conv_filter ( packet_info * pinfo ) { gchar * buf = NULL ; gchar src_addr [ WS_INET6_ADDRSTRLEN ] ; gchar dst_addr [ WS_INET6_ADDRSTRLEN ] ; if ( pinfo -> net_src . type == AT_IPv4 && pinfo -> net_dst . type == AT_IPv4 ) { address_to_str_buf ( & pinfo -> src , src_addr , WS_INET6_ADDRSTRLEN ) ; address_to_str_buf ( & pinfo -> dst , dst_addr , WS_INET6_ADDRSTRLEN ) ; if ( * src_addr != '\0' && * dst_addr != '\0' ) { buf = ws_strdup_printf ( "(ip.addr eq %s and ip.addr eq %s) or" " (f5ethtrailer.peeraddr eq %s and f5ethtrailer.peeraddr eq %s)" , src_addr , dst_addr , src_addr , dst_addr ) ; } } if ( pinfo -> net_src . type == AT_IPv6 && pinfo -> net_dst . type == AT_IPv6 ) { address_to_str_buf ( & pinfo -> src , src_addr , WS_INET6_ADDRSTRLEN ) ; address_to_str_buf ( & pinfo -> dst , dst_addr , WS_INET6_ADDRSTRLEN ) ; if ( * src_addr != '\0' && * dst_addr != '\0' ) { buf = ws_strdup_printf ( "(ipv6.addr eq %s and ipv6.addr eq %s) or" " (f5ethtrailer.peeraddr6 eq %s and f5ethtrailer.peeraddr6 eq %s)" , src_addr , dst_addr , src_addr , dst_addr ) ; } } return buf ; } 