void coroutine_fn fsdev_co_throttle_request ( FsThrottle * fst , bool is_write , struct iovec * iov , int iovcnt ) { if ( throttle_enabled ( & fst -> cfg ) ) { if ( throttle_schedule_timer ( & fst -> ts , & fst -> tt , is_write ) || ! qemu_co_queue_empty ( & fst -> throttled_reqs [ is_write ] ) ) { qemu_co_queue_wait ( & fst -> throttled_reqs [ is_write ] , NULL ) ; } if ( ! qemu_co_queue_empty ( & fst -> throttled_reqs [ is_write ] ) && ! throttle_schedule_timer ( & fst -> ts , & fst -> tt , is_write ) ) { qemu_co_queue_next ( & fst -> throttled_reqs [ is_write ] ) ; } } } 