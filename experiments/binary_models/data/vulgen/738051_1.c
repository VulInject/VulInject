test_implicit ( ) { int ret = 0 ; struct test_case tests [ ] { { NULL 16 "\x30\x0e\x80\x01\x00\xa1\x06\xbf\x7f\x03\x02\x01\x02\x82\x01\x03" "implicit 1" } } ; ; struct test_case tests2 [ ] { { NULL 12 "\x30\x0a\x80\x01\x01\x82\x01\x03\x9f\x33\x01\x04" "implicit 2" } } ; ; struct test_case tests3 [ ] { { NULL 7 "\xa5\x05\xa1\x03\x02\x01\x05" "implicit 3" } } ; ; struct test_case tests4 [ ] { { NULL 7 "\xa5\x05\xa1\x03\x02\x01\x05" "implicit 4" } } ; ; TESTImplicit c0 ; TESTImplicit2 c1 ; TESTImplicit3 c2 ; TESTImplicit4 c3 ; int ti4 = 4 ; memset ( & c0 , 0 , sizeof ( c0 ) ) ; c0 . ti1 = 0 ; c0 . ti2 . foo = 2 ; c0 . ti3 = 3 ; tests [ 0 ] . val = & c0 ; memset ( & c1 , 0 , sizeof ( c1 ) ) ; c1 . ti1 = 1 ; c1 . ti3 = 3 ; c1 . ti4 = & ti4 ; tests2 [ 0 ] . val = & c1 ; memset ( & c2 , 0 , sizeof ( c2 ) ) ; c2 . element = choice_TESTImplicit3_ti2 ; c2 . u . ti2 . element = choice_TESTImplicit3_ti2_i1 ; c2 . u . ti2 . u . i1 = 5 ; tests3 [ 0 ] . val = & c2 ; memset ( & c3 , 0 , sizeof ( c3 ) ) ; c3 . element = choice_TESTImplicit4_ti2 ; c3 . u . ti2 . element = choice_TESTChoice2_i1 ; c3 . u . ti2 . u . i1 = 5 ; tests4 [ 0 ] . val = & c3 ; ret += generic_test ( tests , sizeof ( tests ) / sizeof ( * tests ) , sizeof ( TESTImplicit ) , ( generic_encode ) encode_TESTImplicit , ( generic_length ) length_TESTImplicit , ( generic_decode ) decode_TESTImplicit , ( generic_free ) free_TESTImplicit , cmp_TESTImplicit , ( generic_copy ) copy_TESTImplicit ) ; ret += generic_test ( tests2 , sizeof ( tests2 ) / sizeof ( * tests2 ) , sizeof ( TESTImplicit2 ) , ( generic_encode ) encode_TESTImplicit2 , ( generic_length ) length_TESTImplicit2 , ( generic_decode ) decode_TESTImplicit2 , ( generic_free ) free_TESTImplicit2 , cmp_TESTImplicit2 , NULL ) ; ret += generic_test ( tests3 , sizeof ( tests3 ) / sizeof ( * tests3 ) , sizeof ( TESTImplicit3 ) , ( generic_encode ) encode_TESTImplicit3 , ( generic_length ) length_TESTImplicit3 , ( generic_decode ) decode_TESTImplicit3 , ( generic_free ) free_TESTImplicit3 , cmp_TESTImplicit3 , NULL ) ; return ret ; } 