void proto_register_banana ( void ) { static hf_register_info hf [ ] { { & hf_banana_list { "List Length" "banana.list" FT_UINT32 BASE_DEC NULL 0 "Banana list" HFILL } } { & hf_banana_int { "Integer" "banana.int" FT_UINT32 BASE_DEC NULL 0 "Banana integer" HFILL } } { & hf_banana_string { "String" "banana.string" FT_STRING BASE_NONE NULL 0 "Banana string" HFILL } } { & hf_banana_neg_int { "Negative Integer" "banana.neg_int" FT_INT32 BASE_DEC NULL 0 "Banana negative integer" HFILL } } { & hf_banana_float { "Float" "banana.float" FT_DOUBLE BASE_NONE NULL 0 "Banana float" HFILL } } { & hf_banana_lg_int { "Float" "banana.lg_int" FT_BYTES BASE_NONE NULL 0 "Banana large integer" HFILL } } { & hf_banana_lg_neg_int { "Float" "banana.lg_neg_int" FT_BYTES BASE_NONE NULL 0 "Banana large negative integer" HFILL } } { & hf_banana_pb { "pb Profile Value" "banana.pb" FT_UINT8 BASE_HEX VALS ( pb_vals ) 0 "Banana Perspective Broker Profile Value" HFILL } } } ; ; expert_module_t * expert_banana ; static gint * ett [ ] { & ett_banana & ett_list } ; ; static ei_register_info ei [ ] { { & ei_banana_unknown_type { "banana.unknown_type" PI_UNDECODED PI_ERROR "Unknown type" EXPFILL } } { & ei_banana_too_many_value_bytes { "banana.too_many_value_bytes" PI_UNDECODED PI_ERROR "Too many value/length bytes" EXPFILL } } { & ei_banana_length_too_long { "banana.length_too_long" PI_UNDECODED PI_ERROR "Length too long" EXPFILL } } { & ei_banana_value_too_large { "banana.value_too_large" PI_MALFORMED PI_ERROR "Value too large" EXPFILL } } { & ei_banana_pb_error { "banana.pb_error" PI_MALFORMED PI_ERROR "More than 1 byte before pb" EXPFILL } } } ; ; proto_banana = proto_register_protocol ( "Twisted Banana" , "Banana" , "banana" ) ; proto_register_field_array ( proto_banana , hf , array_length ( hf ) ) ; proto_register_subtree_array ( ett , array_length ( ett ) ) ; expert_banana = expert_register_protocol ( proto_banana ) ; } 