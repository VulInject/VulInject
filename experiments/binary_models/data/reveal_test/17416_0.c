void vp9_idct4x4_16_add_sse2 ( const int16_t * input , uint8_t * dest , int stride ) {
 const __m128i zero = _mm_setzero_si128 ( ) ;
 const __m128i eight = _mm_set1_epi16 ( 8 ) ;
 const __m128i cst = _mm_setr_epi16 ( ( int16_t ) cospi_16_64 , ( int16_t ) cospi_16_64 , ( int16_t ) cospi_16_64 , ( int16_t ) - cospi_16_64 , ( int16_t ) cospi_24_64 , ( int16_t ) - cospi_8_64 , ( int16_t ) cospi_8_64 , ( int16_t ) cospi_24_64 ) ;
 const __m128i rounding = _mm_set1_epi32 ( DCT_CONST_ROUNDING ) ;
 __m128i input0 , input1 , input2 , input3 ;
 input0 = _mm_load_si128 ( ( const __m128i * ) input ) ;
 input2 = _mm_load_si128 ( ( const __m128i * ) ( input + 8 ) ) ;
 input0 = _mm_shufflelo_epi16 ( input0 , 0xd8 ) ;
 input0 = _mm_shufflehi_epi16 ( input0 , 0xd8 ) ;
 input2 = _mm_shufflelo_epi16 ( input2 , 0xd8 ) ;
 input2 = _mm_shufflehi_epi16 ( input2 , 0xd8 ) ;
 input1 = _mm_unpackhi_epi32 ( input0 , input0 ) ;
 input0 = _mm_unpacklo_epi32 ( input0 , input0 ) ;
 input3 = _mm_unpackhi_epi32 ( input2 , input2 ) ;
 input2 = _mm_unpacklo_epi32 ( input2 , input2 ) ;
 input0 = _mm_madd_epi16 ( input0 , cst ) ;
 input1 = _mm_madd_epi16 ( input1 , cst ) ;
 input2 = _mm_madd_epi16 ( input2 , cst ) ;
 input3 = _mm_madd_epi16 ( input3 , cst ) ;
 input0 = _mm_add_epi32 ( input0 , rounding ) ;
 input1 = _mm_add_epi32 ( input1 , rounding ) ;
 input2 = _mm_add_epi32 ( input2 , rounding ) ;
 input3 = _mm_add_epi32 ( input3 , rounding ) ;
 input0 = _mm_srai_epi32 ( input0 , DCT_CONST_BITS ) ;
 input1 = _mm_srai_epi32 ( input1 , DCT_CONST_BITS ) ;
 input2 = _mm_srai_epi32 ( input2 , DCT_CONST_BITS ) ;
 input3 = _mm_srai_epi32 ( input3 , DCT_CONST_BITS ) ;
 input0 = _mm_packs_epi32 ( input0 , input1 ) ;
 input1 = _mm_packs_epi32 ( input2 , input3 ) ;
 input2 = _mm_unpacklo_epi16 ( input0 , input1 ) ;
 input3 = _mm_unpackhi_epi16 ( input0 , input1 ) ;
 input0 = _mm_unpacklo_epi32 ( input2 , input3 ) ;
 input1 = _mm_unpackhi_epi32 ( input2 , input3 ) ;
 input1 = _mm_shuffle_epi32 ( input1 , 0x4e ) ;
 input2 = _mm_add_epi16 ( input0 , input1 ) ;
 input3 = _mm_sub_epi16 ( input0 , input1 ) ;
 input0 = _mm_unpacklo_epi32 ( input2 , input2 ) ;
 input1 = _mm_unpackhi_epi32 ( input2 , input2 ) ;
 input2 = _mm_unpackhi_epi32 ( input3 , input3 ) ;
 input3 = _mm_unpacklo_epi32 ( input3 , input3 ) ;
 input0 = _mm_madd_epi16 ( input0 , cst ) ;
 input1 = _mm_madd_epi16 ( input1 , cst ) ;
 input2 = _mm_madd_epi16 ( input2 , cst ) ;
 input3 = _mm_madd_epi16 ( input3 , cst ) ;
 input0 = _mm_add_epi32 ( input0 , rounding ) ;
 input1 = _mm_add_epi32 ( input1 , rounding ) ;
 input2 = _mm_add_epi32 ( input2 , rounding ) ;
 input3 = _mm_add_epi32 ( input3 , rounding ) ;
 input0 = _mm_srai_epi32 ( input0 , DCT_CONST_BITS ) ;
 input1 = _mm_srai_epi32 ( input1 , DCT_CONST_BITS ) ;
 input2 = _mm_srai_epi32 ( input2 , DCT_CONST_BITS ) ;
 input3 = _mm_srai_epi32 ( input3 , DCT_CONST_BITS ) ;
 input0 = _mm_packs_epi32 ( input0 , input2 ) ;
 input1 = _mm_packs_epi32 ( input1 , input3 ) ;
 input2 = _mm_unpacklo_epi16 ( input0 , input1 ) ;
 input3 = _mm_unpackhi_epi16 ( input0 , input1 ) ;
 input0 = _mm_unpacklo_epi32 ( input2 , input3 ) ;
 input1 = _mm_unpackhi_epi32 ( input2 , input3 ) ;
 input1 = _mm_shuffle_epi32 ( input1 , 0x4e ) ;
 input2 = _mm_add_epi16 ( input0 , input1 ) ;
 input3 = _mm_sub_epi16 ( input0 , input1 ) ;
 input2 = _mm_add_epi16 ( input2 , eight ) ;
 input3 = _mm_add_epi16 ( input3 , eight ) ;
 input2 = _mm_srai_epi16 ( input2 , 4 ) ;
 input3 = _mm_srai_epi16 ( input3 , 4 ) ;
 {
 __m128i d0 = _mm_cvtsi32_si128 ( * ( const int * ) ( dest ) ) ;
 __m128i d2 = _mm_cvtsi32_si128 ( * ( const int * ) ( dest + stride * 2 ) ) ;
 d0 = _mm_unpacklo_epi32 ( d0 , _mm_cvtsi32_si128 ( * ( const int * ) ( dest + stride ) ) ) ;
 d2 = _mm_unpacklo_epi32 ( _mm_cvtsi32_si128 ( * ( const int * ) ( dest + stride * 3 ) ) , d2 ) ;
 d0 = _mm_unpacklo_epi8 ( d0 , zero ) ;
 d2 = _mm_unpacklo_epi8 ( d2 , zero ) ;
 d0 = _mm_add_epi16 ( d0 , input2 ) ;
 d2 = _mm_add_epi16 ( d2 , input3 ) ;
 d0 = _mm_packus_epi16 ( d0 , d2 ) ;
 * ( int * ) dest = _mm_cvtsi128_si32 ( d0 ) ;
 d0 = _mm_srli_si128 ( d0 , 4 ) ;
 * ( int * ) ( dest + stride ) = _mm_cvtsi128_si32 ( d0 ) ;
 d0 = _mm_srli_si128 ( d0 , 4 ) ;
 * ( int * ) ( dest + stride * 3 ) = _mm_cvtsi128_si32 ( d0 ) ;
 d0 = _mm_srli_si128 ( d0 , 4 ) ;
 * ( int * ) ( dest + stride * 2 ) = _mm_cvtsi128_si32 ( d0 ) ;
 }
 }