static int parse_files_in_dir ( const char * dirname ) { DIR * dp ; struct dirent * dirp ; struct stat stats ; char buf [ MAXPATHLEN ] ; if ( ( dp = opendir ( dirname ) ) == NULL ) { fprintf ( stderr , gettext ( "failed to open directory '%s': %s\n" ) , dirname , strerror ( errno ) ) ; return ( 1 ) ; } while ( ( dirp = readdir ( dp ) ) != NULL ) { if ( dirp -> d_name [ 0 ] == '.' ) { continue ; } if ( snprintf ( buf , sizeof ( buf ) , "%s/%s" , dirname , dirp -> d_name ) >= sizeof ( buf ) ) { fprintf ( stderr , gettext ( "path name is too long: %s/%s\n" ) , dirname , dirp -> d_name ) ; continue ; } if ( stat ( buf , & stats ) == - 1 ) { fprintf ( stderr , gettext ( "failed to stat '%s': %s\n" ) , buf , strerror ( errno ) ) ; continue ; } if ( ! S_ISREG ( stats . st_mode ) ) { continue ; } ( void ) parse_file ( buf ) ; } closedir ( dp , NULL ) ; return ( 0 ) ; } 