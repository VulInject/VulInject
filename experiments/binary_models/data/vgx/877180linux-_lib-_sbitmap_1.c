( sbitmap_queue_clear ) ; void sbitmap_queue_wake_all ( struct sbitmap_queue * sbq ) { int i , wake_index ; smp_mb ( ) ; wake_index = atomic_read ( & sbq -> wake_index ) ; for ( i = 0 ; i < SBQ_WAIT_QUEUES ; i ++ ) { struct sbq_wait_state * ws = & sbq -> ws [ wake_index ] ; if ( waitqueue_active ( & ws -> wait ) ) { wake_up ( & ws -> wait ) ; } wake_index = sbq_index_inc ( wake_index , NULL ) ; } } 