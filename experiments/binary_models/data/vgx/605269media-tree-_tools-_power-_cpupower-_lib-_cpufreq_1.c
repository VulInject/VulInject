struct cpufreq_policy * cpufreq_get_policy ( unsigned int cpu ) { struct cpufreq_policy * policy ; policy = malloc ( sizeof ( cpufreq_policy ) ) ; if ( ! policy ) { return NULL ; } policy -> governor = sysfs_cpufreq_get_one_string ( cpu , SCALING_GOVERNOR ) ; if ( ! policy -> governor ) { free ( policy ) ; return NULL ; } policy -> min = sysfs_cpufreq_get_one_value ( cpu , SCALING_MIN_FREQ ) ; policy -> max = sysfs_cpufreq_get_one_value ( cpu , SCALING_MAX_FREQ ) ; if ( ( ! policy -> min ) || ( ! policy -> max ) ) { free ( policy ) ; return NULL ; } return policy ; } 