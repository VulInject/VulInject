bool source_map_add_source ( const char * filename , const char * text ) { char * filename_copy = NULL ; struct source source_obj ; char * text_copy = NULL ; if ( s_sources == NULL ) { return true ; } if ( ! ( filename_copy = strdup ( filename ) ) ) { on_error } if ( ! ( text_copy = strdup ( text ) ) ) { on_error } source_obj . filename = filename_copy ; source_obj . text = text_copy ; if ( ! vector_push ( s_sources , & source_obj ) ) { on_error } return true ; on_error free ( text_copy ) ; return false ; } 