void wihap_mgmt_input ( struct wi_softc * sc , struct wi_frame * rxfrm , struct mbuf * m ) { caddr_t pkt ; int s , len ; if ( sc -> sc_ic . ic_if . if_flags & IFF_DEBUG ) { wihap_debug_frame_type ( rxfrm ) ; } pkt = mtod ( m , caddr_t ) + WI_802_11_OFFSET_RAW ; len = m -> m_len - WI_802_11_OFFSET_RAW ; if ( ( rxfrm -> wi_frame_ctl & htole16 ( WI_FCTL_FTYPE ) ) == htole16 ( WI_FTYPE_MGMT ) ) { s = splsoftclock ( ) ; switch ( letoh16 ( rxfrm -> wi_frame_ctl ) & WI_FCTL_STYPE ) { case WI_STYPE_MGMT_ASREQ : wihap_assoc_req ( sc , rxfrm , pkt , len ) ; break ; case WI_STYPE_MGMT_ASRESP : break ; case WI_STYPE_MGMT_REASREQ : wihap_assoc_req ( sc , rxfrm , pkt , len ) ; break ; case WI_STYPE_MGMT_REASRESP : break ; case WI_STYPE_MGMT_PROBEREQ : break ; case WI_STYPE_MGMT_PROBERESP : break ; case WI_STYPE_MGMT_BEACON : break ; case WI_STYPE_MGMT_ATIM : break ; case WI_STYPE_MGMT_DISAS : wihap_disassoc_req ( sc , rxfrm , pkt , len ) ; break ; case WI_STYPE_MGMT_AUTH : wihap_auth_req ( sc , rxfrm , pkt , len ) ; break ; case WI_STYPE_MGMT_DEAUTH : wihap_deauth_req ( sc , rxfrm , pkt , len ) ; break ; } splx ( s , NULL ) ; } m_freem ( m ) ; } 