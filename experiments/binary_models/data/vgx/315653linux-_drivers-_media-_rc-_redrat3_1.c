static void redrat3_get_firmware_rev ( struct redrat3_dev * rr3 ) { int rc ; char * buffer ; buffer = kcalloc ( RR3_FW_VERSION_LEN + 1 , sizeof ( * buffer ) , GFP_KERNEL ) ; if ( ! buffer ) { return ; } rc = usb_control_msg ( rr3 -> udev , usb_rcvctrlpipe ( rr3 -> udev , 0 ) , RR3_FW_VERSION , USB_TYPE_VENDOR | USB_RECIP_DEVICE | USB_DIR_IN , 0 , 0 , buffer , RR3_FW_VERSION_LEN , 5000 ) ; if ( rc >= 0 ) { dev_info ( rr3 -> dev , "Firmware rev: %s" , buffer ) ; } else { dev_err ( rr3 -> dev , "Problem fetching firmware ID\n" ) ; } } 