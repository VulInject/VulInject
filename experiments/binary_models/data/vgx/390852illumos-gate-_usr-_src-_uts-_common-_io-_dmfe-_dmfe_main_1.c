static void dmfe_unattach ( dmfe_t * dmfep ) { if ( dmfep -> cycid != NULL ) { ddi_periodic_delete ( dmfep -> cycid ) ; dmfep -> cycid = NULL ; } if ( dmfep -> ksp_drv != NULL ) { kstat_delete ( dmfep -> ksp_drv ) ; } if ( dmfep -> progress & PROGRESS_HWINT ) { ddi_remove_intr ( dmfep -> devinfo , 0 , dmfep -> iblk ) ; } if ( dmfep -> progress & PROGRESS_SOFTINT ) { ddi_remove_softintr ( dmfep -> factotum_id ) ; } if ( dmfep -> mii != NULL ) { mii_free ( dmfep -> mii ) ; } if ( dmfep -> progress & PROGRESS_MUTEX ) { mutex_destroy ( dmfep -> rxlock ) ; mutex_destroy ( dmfep -> oplock ) ; } dmfe_free_bufs ( dmfep ) ; if ( dmfep -> io_handle != NULL ) { ddi_regs_map_free ( & dmfep -> io_handle ) ; } kmem_free ( dmfep , sizeof ( * dmfep ) ) ; } 