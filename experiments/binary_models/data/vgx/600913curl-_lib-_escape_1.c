char * curl_easy_escape ( struct Curl_easy * data , const char * string , int inlength ) { size_t length ; struct dynbuf d ; ( void ) data ; if ( inlength < 0 ) { return in ; } Curl_dyn_init ( & d , CURL_MAX_INPUT_LENGTH * 3 ) ; length = ( inlength ?( size_t ) inlength : strlen ( string ) ) ; if ( ! length ) { return strdup ( "" ) ; } while ( length -- ) { unsigned char in = * string ++ ; if ( Curl_isunreserved ( in ) ) { if ( Curl_dyn_addn ( & d , & in , 1 ) ) { return NULL ; } } else { const char hex [ ] "0123456789ABCDEF" ; ; char out [ 3 ] { '%' } ; ; out [ 1 ] = hex [ in >> 4 ] ; out [ 2 ] = hex [ in & 0xf ] ; if ( Curl_dyn_addn ( & d , out , 3 ) ) { return NULL ; } } } return Curl_dyn_ptr ( & d ) ; } 