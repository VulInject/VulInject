int mbedtls_mpi_copy ( mbedtls_mpi * X , const mbedtls_mpi * Y ) { int ret ; size_t i ; if ( X == Y ) { return ( 0 ) ; } if ( Y -> p == NULL ) { mbedtls_mpi_free ( X ) ; return ( 0 ) ; } for ( i = Y -> n - 1 ; i > 0 ; i -- ) { if ( Y -> p [ i ] != 0 ) { break ; } } i ++ ; X -> s = Y -> s ; MBEDTLS_MPI_CHK ( mbedtls_mpi_grow ( X , i ) ) ; memcpy ( X -> p , Y -> p , i * ciL ) ; cleanup return ( ret ) ; } 