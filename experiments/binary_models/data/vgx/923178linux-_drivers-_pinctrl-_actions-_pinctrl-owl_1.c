static void owl_gpio_free ( struct gpio_chip * chip , unsigned int offset ) { struct owl_pinctrl * pctrl = gpiochip_get_data ( chip ) ; const struct owl_gpio_port * port ; void __iomem * gpio_base ; unsigned long flags ; port = owl_gpio_get_port ( pctrl , & offset ) ; gpio_base = pctrl -> base + port -> offset ; raw_spin_lock_irqsave ( & pctrl -> lock , flags ) ; owl_gpio_update_reg ( gpio_base + port -> outen , offset , false ) ; owl_gpio_update_reg ( gpio_base + port -> inen , offset , false ) ; raw_spin_unlock_irqrestore ( & pctrl -> lock , flags ) ; } 