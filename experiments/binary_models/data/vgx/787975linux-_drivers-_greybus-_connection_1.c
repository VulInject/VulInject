static int gb_connection_hd_cport_quiesce ( struct gb_connection * connection ) { struct gb_host_device * hd = connection -> hd ; size_t peer_space ; int ret ; peer_space = sizeof ( gb_operation_msg_hdr ) + sizeof ( gb_cport_shutdown_request ) ; if ( connection -> mode_switch ) { peer_space += sizeof ( gb_operation_msg_hdr ) ; } ret = hd -> driver -> cport_quiesce ( hd , connection -> hd_cport_id , peer_space , GB_CONNECTION_CPORT_QUIESCE_TIMEOUT ) ; if ( ret ) { dev_err ( & hd -> dev , "%s: failed to quiesce host cport: %d\n" , connection -> name , ret ) ; return ret ; } return 0 ; } 