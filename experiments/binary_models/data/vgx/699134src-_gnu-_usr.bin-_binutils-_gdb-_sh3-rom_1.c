init_sh3_cmds ( ) { sh3_cmds . flags = MO_CLR_BREAK_USES_ADDR | MO_GETMEM_READ_SINGLE ; sh3_cmds . init = sh3_inits ; sh3_cmds . cont = "g\r" ; sh3_cmds . step = "s\r" ; sh3_cmds . stop = "\003" ; sh3_cmds . set_break = "b %x\r" ; sh3_cmds . clr_break = "b -%x\r" ; sh3_cmds . clr_all_break = "b -\r" ; sh3_cmds . fill = "f %x @%x %x\r" ; sh3_cmds . setmem . cmdb = "m %x %x\r" ; sh3_cmds . setmem . cmdw = "m %x %x;w\r" ; sh3_cmds . setmem . cmdl = "m %x %x;l\r" ; sh3_cmds . setmem . cmdll = NULL ; sh3_cmds . setmem . resp_delim = NULL ; sh3_cmds . setmem . term = NULL ; sh3_cmds . setmem . term_cmd = NULL ; sh3_cmds . getmem . cmdb = "m %x\r" ; sh3_cmds . getmem . cmdw = "m %x;w\r" ; sh3_cmds . getmem . cmdl = "m %x;l\r" ; sh3_cmds . getmem . cmdll = NULL ; sh3_cmds . getmem . resp_delim = "^ [0-9A-F]+ " ; sh3_cmds . getmem . term = "? " ; sh3_cmds . getmem . term_cmd = ".\r" ; sh3_cmds . setreg . cmd = ".%s %x\r" ; sh3_cmds . setreg . resp_delim = NULL ; sh3_cmds . setreg . term = NULL ; sh3_cmds . setreg . term_cmd = NULL ; sh3_cmds . getreg . cmd = ".%s\r" ; sh3_cmds . getreg . resp_delim = "=" ; sh3_cmds . getreg . term = "? " ; sh3_cmds . getreg . term_cmd = ".\r" ; sh3_cmds . dump_registers = "r\r" ; sh3_cmds . register_pattern = "\\(\\w+\\)=\\([0-9a-fA-F]+\\( +[0-9a-fA-F]+\\b\\)*\\)" ; sh3_cmds . supply_register = sh3_supply_register ; sh3_cmds . load_routine = sh3_load ; sh3_cmds . loadresp = NULL ; sh3_cmds . prompt = "\n:" ; sh3_cmds . line_term = "\r" ; sh3_cmds . cmd_end = ".\r" ; sh3_cmds . target = & sh3_ops ; sh3_cmds . stopbits = SERIAL_1_STOPBITS ; sh3_cmds . regnames = sh3_regnames ; sh3_cmds . magic = MONITOR_OPS_MAGIC ; } static struct monitor_ops sh3e_cmds ; static void sh3_open ( char * args , int from_tty ) { char * serial_port_name = args ; char * parallel_port_name = 0 ; if ( args ) { char * cursor = serial_port_name = xstrdup ( args ) ; while ( * cursor && * cursor != ' ' ) { cursor ++ ; } if ( * cursor ) { * cursor ++ = 0 ; } while ( * cursor == ' ' ) { cursor ++ ; } if ( * cursor ) { parallel_port_name = cursor ; } } monitor_open ( serial_port_name , & sh3_cmds , from_tty ) ; if ( parallel_port_name ) { parallel = serial_open ( parallel_port_name ) ; if ( ! parallel ) { perror_with_name ( "Unable to open parallel port." ) ; } parallel_in_use = 1 ; } { struct gdbarch_info info ; gdbarch_info_init ( & info ) ; info . bfd_arch_info = bfd_lookup_arch ( bfd_arch_sh , bfd_mach_sh3 ) ; if ( ! gdbarch_update_p ( info ) ) { error ( "Target is not an SH3" ) ; } } } 