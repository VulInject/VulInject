void pack_grammar ( void ) { int i , j ; int assoc , pprec ; ritem = reallocarray ( NULL , nitems , sizeof ( short ) ) ; if ( ritem == NULL ) { no_space ( ) ; } rlhs = reallocarray ( NULL , nrules , sizeof ( short ) ) ; if ( rlhs == NULL ) { no_space ( ) ; } rrhs = reallocarray ( NULL , nrules + 1 , sizeof ( short ) ) ; if ( rrhs == NULL ) { no_space ( ) ; } rprec = reallocarray ( rprec , nrules , sizeof ( short ) ) ; if ( rprec == NULL ) { no_space ( ) ; } rassoc = realloc ( rassoc , nrules ) ; if ( rassoc == NULL ) { no_space ( ) ; } ritem [ 0 ] = - 1 ; ritem [ 1 ] = goal -> index ; ritem [ 2 ] = 0 ; ritem [ 3 ] = - 2 ; rlhs [ 0 ] = 0 ; rlhs [ 1 ] = 0 ; rlhs [ 2 ] = start_symbol ; rrhs [ 0 ] = 0 ; rrhs [ 1 ] = 0 ; rrhs [ 2 ] = 1 ; j = 4 ; for ( i = 3 ; i < nrules ; ++ i ) { rlhs [ i ] = plhs [ i ] -> index ; rrhs [ i ] = j ; assoc = TOKEN ; pprec = 0 ; while ( pitem [ j ] ) { ritem [ j ] = pitem [ j ] -> index ; if ( pitem [ j ] -> class == TERM ) { pprec = pitem [ j ] -> prec ; assoc = pitem [ j ] -> assoc ; } ++ j ; } ritem [ j ] = - i ; ++ j ; if ( rprec [ i ] == UNDEFINED ) { rprec [ i ] = pprec ; rassoc [ i ] = assoc ; } } rrhs [ i ] = j ; free ( plhs ) ; } 