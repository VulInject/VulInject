static int axiemac_recv ( struct udevice * dev , int flags , uchar * * packetp ) { u32 length ; struct axidma_priv * priv = dev_get_priv ( dev ) ; u32 temp ; debug ( "axiemac: RX data ready\n" ) ; temp = readl ( & priv -> dmarx -> control ) ; temp &= ~ XAXIDMA_IRQ_ALL_MASK ; writel ( temp , & priv -> dmarx -> control ) ; if ( ! priv -> eth_hasnobuf && priv -> mactype == EMAC_1G ) { length = rx_bd . app4 & 0xFFFF ; } else { length = rx_bd . status & XAXIDMA_BD_STS_ACTUAL_LEN_MASK ; } print_buffer ( & rxframe , & rxframe [ 0 ] , 1 , length , 16 ) ; * packetp = rxframe ; return length ; } 