gimp_view_renderer_draw ( , , , , ) { g_return_if_fail ( GIMP_IS_VIEW_RENDERER ( renderer ) ) ; g_return_if_fail ( GTK_IS_WIDGET ( widget ) ) ; g_return_if_fail ( cr != NULL ) ; if ( G_UNLIKELY ( renderer -> context == NULL ) ) { g_warning ( "%s: renderer->context is NULL" , G_STRFUNC ) ; } if ( ! gtk_widget_is_drawable ( widget ) ) { return ; } if ( renderer -> viewable ) { cairo_save ( cr ) ; GIMP_VIEW_RENDERER_GET_CLASS ( renderer ) -> draw ( renderer , widget , cr , available_width , available_height ) ; cairo_restore ( cr ) ; } else { GimpViewableClass * viewable_class ; viewable_class = g_type_class_ref ( renderer -> viewable_type , NULL ) ; gimp_view_renderer_render_icon ( renderer , widget , viewable_class -> default_icon_name ) ; renderer -> priv -> needs_render = FALSE ; g_type_class_unref ( viewable_class ) ; gimp_view_renderer_real_draw ( renderer , widget , cr , available_width , available_height ) ; } if ( renderer -> border_width > 0 ) { gint width = renderer -> width + renderer -> border_width ; gint height = renderer -> height + renderer -> border_width ; gdouble x , y ; cairo_set_line_width ( cr , renderer -> border_width ) ; cairo_set_line_join ( cr , CAIRO_LINE_JOIN_ROUND ) ; gimp_cairo_set_source_rgb ( cr , & renderer -> border_color ) ; x = ( available_width - width ) / 2.0 ; y = ( available_height - height ) / 2.0 ; cairo_rectangle ( cr , x , y , width , height ) ; cairo_stroke ( cr ) ; } } 