static int rtsx_base_card_power_on ( struct rtsx_pcr * pcr , int card ) { int err ; rtsx_pci_init_cmd ( pcr , NULL ) ; rtsx_pci_add_cmd ( pcr , WRITE_REG_CMD , CARD_PWR_CTL , SD_POWER_MASK , SD_VCC_PARTIAL_POWER_ON ) ; rtsx_pci_add_cmd ( pcr , WRITE_REG_CMD , PWR_GATE_CTRL , LDO3318_PWR_MASK , 0x02 ) ; err = rtsx_pci_send_cmd ( pcr , 100 ) ; if ( err < 0 ) { return err ; } msleep ( 5 ) ; rtsx_pci_init_cmd ( pcr ) ; rtsx_pci_add_cmd ( pcr , WRITE_REG_CMD , CARD_PWR_CTL , SD_POWER_MASK , SD_VCC_POWER_ON ) ; rtsx_pci_add_cmd ( pcr , WRITE_REG_CMD , PWR_GATE_CTRL , LDO3318_PWR_MASK , 0x06 ) ; return rtsx_pci_send_cmd ( pcr , 100 ) ; } 