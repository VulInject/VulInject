static unsigned iasecc_sdo_encode_asn1_tag ( unsigned in_tag ) { int short_tag ; unsigned out_tag ; for ( short_tag = in_tag ; short_tag > 0xFF ; short_tag >>= 8 ) { } out_tag = in_tag ; switch ( short_tag & SC_ASN1_TAG_CLASS ) { case SC_ASN1_TAG_APPLICATION : out_tag |= SC_ASN1_APP ; break ; case SC_ASN1_TAG_CONTEXT : out_tag |= SC_ASN1_CTX ; break ; case SC_ASN1_TAG_PRIVATE : out_tag |= SC_ASN1_PRV ; break ; } return out_tag ; } 