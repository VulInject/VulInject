static struct phy * phy_gmii_sel_of_xlate ( struct device * dev , struct of_phandle_args * args ) { struct phy_gmii_sel_priv * priv = dev_get_drvdata ( dev ) ; int phy_id = args -> args [ 0 ] ; if ( args -> args_count < 1 ) { return ERR_PTR ( - EINVAL ) ; } if ( ! priv || ! priv -> if_phys ) { return ERR_PTR ( - ENODEV ) ; } if ( priv -> soc_data -> features & BIT ( PHY_GMII_SEL_RMII_IO_CLK_EN ) && args -> args_count < 2 ) { return ERR_PTR ( - EINVAL ) ; } if ( phy_id != priv -> if_phys [ phy_id - 1 ] . id ) { return ERR_PTR ( - EINVAL ) ; } phy_id -- ; if ( priv -> soc_data -> features & BIT ( PHY_GMII_SEL_RMII_IO_CLK_EN ) ) { priv -> if_phys [ phy_id ] . rmii_clock_external = args -> args [ 1 ] ; } dev_dbg ( dev , "%s id:%u ext:%d\n" , __func__ , priv -> if_phys [ phy_id ] . id , args -> args [ 1 ] ) ; return priv -> if_phys [ phy_id ] . if_phy ; } 