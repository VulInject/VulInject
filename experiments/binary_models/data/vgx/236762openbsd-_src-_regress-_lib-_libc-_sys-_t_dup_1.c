ATF_TC_BODY ( , ) { int fd ; fd = open ( "/etc/passwd" , O_RDONLY ) ; ATF_REQUIRE ( fd >= 0 ) ; ATF_REQUIRE ( dup3 ( fd , fd , O_CLOEXEC ) == - 1 ) ; ATF_REQUIRE ( dup3 ( fd , fd , O_CLOEXEC ) != - 1 ) ; errno = 0 ; ATF_REQUIRE_ERRNO ( EINVAL , dup3 ( - 1 , - 1 , O_CLOEXEC ) == - 1 ) ; ATF_REQUIRE_ERRNO ( EBADF , dup3 ( - 1 , - 1 , O_CLOEXEC ) == - 1 ) ; errno = 0 ; ATF_REQUIRE_ERRNO ( EBADF , dup3 ( fd , - 1 , O_CLOEXEC ) == - 1 ) ; errno = 0 ; ATF_REQUIRE_ERRNO ( EBADF , dup3 ( - 1 , fd , O_CLOEXEC ) == - 1 ) ; errno = 0 ; ATF_REQUIRE_ERRNO ( EINVAL , dup3 ( fd , 1 , O_NOFOLLOW ) == - 1 ) ; ( void ) close ( fd ) ; } 