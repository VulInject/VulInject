static void ShowX509 ( WOLFSSL_X509 * x509 , const char * hdr ) { char * altName ; char * issuer ; char * subject ; byte serial [ 32 ] ; int ret ; int sz = sizeof ( serial ) ; const char * * words = client_showx509_msg ; if ( x509 == NULL ) { printf ( "%s No Cert\n" , hdr ) ; return ; } issuer = wolfSSL_X509_NAME_oneline ( wolfSSL_X509_get_issuer_name ( x509 ) , 0 , 0 ) ; subject = wolfSSL_X509_NAME_oneline ( wolfSSL_X509_get_subject_name ( x509 ) , 0 , 0 ) ; printf ( "%s\n %s : %s\n %s: %s\n" , hdr , words [ 0 ] , issuer , words [ 1 ] , subject ) ; while ( ( altName = wolfSSL_X509_get_next_altname ( x509 ) ) != NULL ) { printf ( " %s = %s\n" , words [ 2 ] , altName ) ; } ret = wolfSSL_X509_get_serial_number ( x509 , serial , & sz ) ; if ( ret == WOLFSSL_SUCCESS ) { int i ; int strLen ; char serialMsg [ 80 ] ; strLen = sprintf ( serialMsg , " %s" , words [ 3 ] ) ; for ( i = 0 ; i < sz ; i ++ ) { sprintf ( serialMsg + strLen + ( i * 3 ) , ":%02x " , serial [ i ] ) ; } printf ( "%s\n" , serialMsg ) ; } XFREE ( subject , 0 , DYNAMIC_TYPE_OPENSSL ) ; XFREE ( issuer , 0 , DYNAMIC_TYPE_OPENSSL ) ; { WOLFSSL_BIO * bio ; char buf [ 256 ] ; int textSz ; textSz = wolfSSL_X509_NAME_get_text_by_NID ( wolfSSL_X509_get_subject_name ( x509 ) , NID_domainComponent , buf , sizeof ( buf ) ) ; if ( textSz > 0 ) { printf ( "Domain Component = %s\n" , buf ) ; } bio = wolfSSL_BIO_new ( wolfSSL_BIO_s_file ( ) ) ; if ( bio != NULL ) { wolfSSL_BIO_set_fp ( bio , stdout , BIO_NOCLOSE ) ; wolfSSL_X509_print ( bio , x509 ) ; } } } 