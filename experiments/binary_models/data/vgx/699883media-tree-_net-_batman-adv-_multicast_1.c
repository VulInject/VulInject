static int batadv_mcast_forw_mode_check_ipv4 ( struct batadv_priv * bat_priv , struct sk_buff * skb , bool * is_unsnoopable ) { struct iphdr * iphdr ; if ( ! pskb_may_pull ( skb , sizeof ( ethhdr ) + sizeof ( * iphdr ) ) ) { return - ENOMEM ; } iphdr = ip_hdr ( skb ) ; if ( ! ipv4_is_local_multicast ( iphdr -> daddr ) ) { return - EINVAL ; } * is_unsnoopable = true ; return 0 ; } 