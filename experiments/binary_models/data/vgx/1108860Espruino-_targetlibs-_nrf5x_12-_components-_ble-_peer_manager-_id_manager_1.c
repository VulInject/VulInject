bool im_address_resolve ( ble_gap_addr_t const * p_addr , ble_gap_irk_t const * p_irk ) { NRF_PM_DEBUG_CHECK ( m_module_initialized ) ; uint8_t hash [ IM_ADDR_CIPHERTEXT_LENGTH ] ; uint8_t local_hash [ IM_ADDR_CIPHERTEXT_LENGTH ] ; uint8_t prand [ IM_ADDR_CLEARTEXT_LENGTH ] ; memcpy ( hash , p_addr -> addr , IM_ADDR_CIPHERTEXT_LENGTH ) ; memcpy ( prand , & p_addr -> addr [ IM_ADDR_CIPHERTEXT_LENGTH ] , IM_ADDR_CLEARTEXT_LENGTH ) ; ah ( p_irk -> irk , prand , local_hash ) ; return ( memcmp ( hash , local_hash , IM_ADDR_CIPHERTEXT_LENGTH ) == 0 ) ; } 