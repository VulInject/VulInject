static unsigned int guest_halt_poll_ns __read_mostly = 200000 ; module_param ( guest_halt_poll_ns , uint , 0644 ) ; static unsigned int guest_halt_poll_shrink __read_mostly = 2 ; module_param ( guest_halt_poll_shrink , uint , 0644 ) ; static unsigned int guest_halt_poll_grow __read_mostly = 2 ; module_param ( guest_halt_poll_grow , uint , 0644 ) ; static unsigned int guest_halt_poll_grow_start __read_mostly = 50000 ; module_param ( guest_halt_poll_grow_start , uint , 0644 ) ; static bool guest_halt_poll_allow_shrink __read_mostly = true ; module_param ( guest_halt_poll_allow_shrink , bool , 0644 ) ; static int haltpoll_select ( struct cpuidle_driver * drv , struct cpuidle_device * dev , bool * stop_tick ) { s64 latency_req = cpuidle_governor_latency_req ( dev -> cpu ) ; if ( ! drv -> state_count || latency_req == 0 ) { return 0 ; } if ( dev -> poll_limit_ns == 0 ) { return 1 ; } if ( dev -> last_state_idx == 0 ) { if ( dev -> poll_time_limit == true ) { return 1 ; } * stop_tick = false ; return 0 ; } * stop_tick = false ; return 0 ; } 