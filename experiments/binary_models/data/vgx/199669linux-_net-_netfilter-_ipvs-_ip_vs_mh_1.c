static int ip_vs_mh_reassign ( struct ip_vs_mh_state * s , struct ip_vs_service * svc ) { int ret ; if ( svc -> num_dests > IP_VS_MH_TAB_SIZE ) { return - EINVAL ; } if ( svc -> num_dests >= 1 ) { if ( ! s -> dest_setup ) { return - ENOMEM ; } } ip_vs_mh_permutate ( s , svc ) ; ret = ip_vs_mh_populate ( s , svc ) ; if ( ret < 0 ) { out } IP_VS_DBG_BUF ( 6 , "MH: reassign lookup table of %s:%u\n" , IP_VS_DBG_ADDR ( svc -> af , & svc -> addr ) , ntohs ( svc -> port ) ) ; out if ( svc -> num_dests >= 1 ) { kfree ( s -> dest_setup ) ; s -> dest_setup = NULL ; } return ret ; } 