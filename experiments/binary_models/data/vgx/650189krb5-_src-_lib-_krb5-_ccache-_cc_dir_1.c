static inline krb5_error_code split_path ( krb5_context context , const char * path , char * * dirname_out , char * * filename_out ) { krb5_error_code ret ; char * dirname , * filename ; * dirname_out = NULL ; * filename_out = NULL ; ret = k5_path_split ( path , & dirname , & filename ) ; if ( ret ) { return ret ; } if ( * dirname == '\0' ) { ret = KRB5_CC_BADNAME ; k5_setmsg ( context , ret , _ ( "Subsidiary cache path %s has no parent directory" ) , path ) ; error } if ( ! filename_is_cache ( filename ) ) { ret = KRB5_CC_BADNAME ; k5_setmsg ( context , ret , _ ( "Subsidiary cache path %s filename does not begin with " "\"tkt\"" ) , path ) ; error } * dirname_out = dirname ; * filename_out = filename ; return 0 ; error free ( dirname ) ; return ret ; } 