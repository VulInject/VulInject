static int acpi_pcc_retrieve_biosdata ( struct pcc_acpi * pcc ) { acpi_status status ; struct acpi_buffer buffer = { ACPI_ALLOCATE_BUFFER NULL } ; union acpi_object * hkey = NULL ; int i ; status = acpi_evaluate_object ( pcc -> handle , METHOD_HKEY_SINF , NULL , & buffer ) ; if ( ACPI_FAILURE ( status ) ) { ACPI_DEBUG_PRINT ( ( ACPI_DB_ERROR , "evaluation error HKEY.SINF\n" ) ) ; return 0 ; } hkey = buffer . pointer ; if ( ! hkey || ( hkey -> type != ACPI_TYPE_PACKAGE ) ) { ACPI_DEBUG_PRINT ( ( ACPI_DB_ERROR , "Invalid HKEY.SINF\n" ) ) ; status = AE_ERROR ; end } if ( pcc -> num_sifr < hkey -> package . count ) { ACPI_DEBUG_PRINT ( ( ACPI_DB_ERROR , "SQTY reports bad SINF length\n" ) ) ; status = AE_ERROR ; end } for ( i = 0 ; i < hkey -> package . count ; i ++ ) { union acpi_object * element = & ( hkey -> package . elements [ i ] ) ; if ( likely ( element -> type == ACPI_TYPE_INTEGER ) ) { pcc -> sinf [ i ] = element -> integer . value ; } else { ACPI_DEBUG_PRINT ( ( ACPI_DB_ERROR , "Invalid HKEY.SINF data\n" ) ) ; } } pcc -> sinf [ hkey -> package . count ] = - 1 ; end return status == AE_OK ; } 