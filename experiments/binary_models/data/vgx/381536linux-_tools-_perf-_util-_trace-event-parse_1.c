static int get_common_field ( struct scripting_context * context , int * offset , int * size , const char * type ) { struct tep_handle * pevent = context -> pevent ; struct tep_event * event ; struct tep_format_field * field ; if ( ! * size ) { event = tep_get_first_event ( pevent , NULL ) ; if ( ! event ) { return 0 ; } field = tep_find_common_field ( event , type ) ; if ( ! field ) { return 0 ; } * offset = field -> offset ; * size = field -> size ; } return tep_read_number ( pevent , context -> event_data + * offset , * size ) ; } 