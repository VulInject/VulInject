static int post_recv ( struct p9_client * client , struct p9_rdma_context * c ) { struct p9_trans_rdma * rdma = client -> trans ; struct ib_recv_wr wr ; struct ib_sge sge ; c -> busa = ib_dma_map_single ( rdma -> cm_id -> device , c -> rc . sdata , client -> msize , DMA_FROM_DEVICE ) ; c -> cqe . done = recv_done ; sge . addr = c -> busa ; sge . length = client -> msize ; sge . lkey = rdma -> pd -> local_dma_lkey ; wr . next = NULL ; wr . wr_cqe = & c -> cqe ; wr . sg_list = & sge ; wr . num_sge = 1 ; return ib_post_recv ( rdma -> qp , & wr , NULL ) ; error p9_debug ( P9_DEBUG_ERROR , "EIO\n" ) ; return - EIO ; } 