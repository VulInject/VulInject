HANDLE FUN1 ( LPCSTR VAR1 , LPWIN32_FIND_DATAA VAR2 ) { BOOL VAR3 = VAR4 ; struct stat VAR5 ; VAR6 * VAR7 ; if ( ! VAR2 || ! VAR1 ) { FUN2 ( VAR8 ) ; return VAR9 ; } FUN3 ( VAR2 , sizeof ( VAR10 ) ) ; VAR7 = ( VAR6 * ) calloc ( 1 , sizeof ( VAR6 ) ) ; if ( ! VAR7 ) { FUN2 ( VAR11 ) ; return VAR9 ; } if ( FUN4 ( VAR1 , & VAR5 ) >= 0 ) { VAR3 = ( FUN5 ( VAR5 . VAR12 ) != 0 ) ; } else { VAR13 = 0 ; } if ( VAR3 ) { VAR7 -> VAR14 = FUN6 ( VAR1 ) ; VAR7 -> VAR15 = FUN6 ( "" ) ; } else { LPSTR VAR16 ; size_t VAR17 ; size_t VAR18 ; VAR16 = strrchr ( VAR1 , '' ) ; if ( ! VAR16 ) { VAR16 = strrchr ( VAR1 , '' ) ; } VAR17 = ( VAR16 - VAR1 ) ; VAR18 = ( VAR16 - VAR1 ) + 1 ; VAR7 -> VAR14 = ( VAR19 ) malloc ( VAR18 + 1 ) ; if ( ! VAR7 -> VAR14 ) { FUN2 ( VAR11 ) ; return VAR9 ; } CopyMemory ( VAR7 -> VAR14 , VAR1 , VAR18 ) ; VAR7 -> VAR14 [ VAR18 ] = '' ; VAR18 = strlen ( VAR1 ) - VAR17 ; VAR7 -> VAR15 = ( VAR19 ) malloc ( VAR18 + 1 ) ; if ( ! VAR7 -> VAR15 ) { free ( VAR7 -> VAR14 ) ; free ( VAR7 ) ; FUN2 ( VAR11 ) ; return VAR9 ; } CopyMemory ( VAR7 -> VAR15 , & VAR1 [ VAR17 + 1 ] , VAR18 ) ; VAR7 -> VAR15 [ VAR18 ] = '' ; if ( FUN4 ( VAR7 -> VAR14 , & VAR5 ) < 0 ) { FUN7 ( VAR7 ) ; FUN2 ( FUN8 ( VAR13 ) ) ; VAR13 = 0 ; return VAR9 ; } if ( FUN5 ( VAR5 . VAR12 ) == 0 ) { FUN7 ( VAR7 ) ; return VAR9 ; } } VAR7 -> VAR20 = FUN9 ( VAR7 -> VAR14 ) ; if ( ! VAR7 -> VAR20 ) { FUN7 ( VAR7 ) ; FUN2 ( FUN8 ( VAR13 ) ) ; VAR13 = 0 ; return VAR9 ; } if ( FUN10 ( ( VAR21 ) VAR7 , VAR2 ) ) { if ( VAR3 ) { const char * VAR22 = strrchr ( VAR1 , '' ) ; if ( ! VAR22 ) { VAR22 = VAR1 ; } else { VAR22 ++ ; } VAR7 -> VAR15 [ 0 ] = '' ; sprintf_s ( VAR2 -> VAR23 , FUN11 ( VAR2 -> VAR23 ) , "" , VAR22 ) ; } return ( VAR21 ) VAR7 ; } FUN7 ( VAR7 ) ; return VAR9 ; }