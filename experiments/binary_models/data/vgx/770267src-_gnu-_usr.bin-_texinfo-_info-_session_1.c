info_search_internal ( , , , ) { register int i ; FILE_BUFFER * file_buffer ; char * initial_nodename ; long ret , start = 0 ; file_buffer = file_buffer_of_window ( window ) ; initial_nodename = window -> node -> nodename ; ret = info_search_in_node ( string , window -> node , window -> point + dir , window , dir , case_sensitive ) ; if ( ret != - 1 ) { if ( ! echo_area_is_active && ! isearch_is_active ) { window_clear_echo_area ( ) ; } return ( 0 ) ; } if ( ! file_buffer || ( strcmp ( initial_nodename , "*" ) == 0 ) ) { return ( - 1 ) ; } if ( file_buffer -> tags ) { register int current_tag = 0 , number_of_tags ; char * last_subfile ; TAG * tag ; last_subfile = ( char * ) NULL ; for ( i = 0 ; file_buffer -> tags [ i ] ; i ++ ) { if ( strcmp ( initial_nodename , file_buffer -> tags [ i ] -> nodename ) == 0 ) { current_tag = i ; last_subfile = file_buffer -> tags [ i ] -> filename ; } } number_of_tags = i ; if ( ! last_subfile ) { return ( - 1 ) ; } while ( 1 ) { NODE * node ; return_if_control_g ( - 1 ) ; for ( i = current_tag + dir ; i != current_tag ; i += dir ) { if ( i < 0 ) { i = number_of_tags - 1 ; } if ( i == number_of_tags ) { i = 0 ; } tag = file_buffer -> tags [ i ] ; if ( tag -> nodelen != 0 ) { break ; } } if ( i == current_tag ) { return ( - 1 ) ; } current_tag = i ; if ( ! echo_area_is_active && ( last_subfile != tag -> filename ) ) { window_message_in_echo_area ( ( char * ) _ ( "Searching subfile %s ..." ) , filename_non_directory ( tag -> filename ) , NULL ) ; last_subfile = tag -> filename ; } node = info_get_node ( file_buffer -> filename , tag -> nodename ) ; if ( ! node ) { if ( ! echo_area_is_active ) { if ( info_recent_file_error ) { info_error ( info_recent_file_error , NULL , NULL ) ; } else { info_error ( ( char * ) msg_cant_file_node , filename_non_directory ( file_buffer -> filename ) , tag -> nodename ) ; } } return ( - 1 ) ; } if ( dir < 0 ) { start = tag -> nodelen ; } ret = info_search_in_node ( string , node , start , window , dir , case_sensitive ) ; if ( ret != - 1 ) { remember_window_and_node ( window , node ) ; if ( ! echo_area_is_active ) { window_clear_echo_area ( ) ; } return ( 0 ) ; } if ( strcmp ( initial_nodename , tag -> nodename ) == 0 ) { return ( - 1 ) ; } } } return ( - 1 ) ; } 