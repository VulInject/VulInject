static ssize_t ns2_led_sata_store ( struct device * dev , struct device_attribute * attr , const char * buff , size_t count ) { struct led_classdev * led_cdev = dev_get_drvdata ( dev ) ; struct ns2_led_data * led_dat = container_of ( led_cdev , ns2_led_data , cdev ) ; int ret ; unsigned long enable ; ret = kstrtoul ( buff , 10 , & enable ) ; if ( ret < 0 ) { return ret ; } enable = ! ! enable ; if ( led_dat -> sata == enable ) { exit } led_dat -> sata = enable ; if ( enable ) { ns2_led_set_mode ( led_dat , NS_V2_LED_SATA ) ; } else { ns2_led_set_mode ( led_dat , NS_V2_LED_ON ) ; } exit return count ; } 