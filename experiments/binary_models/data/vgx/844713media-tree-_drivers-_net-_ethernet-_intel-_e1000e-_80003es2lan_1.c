static s32 e1000_cfg_kmrn_10_100_80003es2lan ( struct e1000_hw * hw , u16 duplex ) { s32 ret_val ; u32 tipg ; u32 i = 0 ; u16 reg_data , reg_data2 ; reg_data = E1000_KMRNCTRLSTA_HD_CTRL_10_100_DEFAULT ; ret_val = e1000_write_kmrn_reg_80003es2lan ( hw , E1000_KMRNCTRLSTA_OFFSET_HD_CTRL , reg_data ) ; tipg = er32 ( TIPG ) ; tipg &= ~ E1000_TIPG_IPGT_MASK ; tipg |= DEFAULT_TIPG_IPGT_10_100_80003ES2LAN ; ew32 ( TIPG , tipg ) ; { ret_val = e1e_rphy ( hw , GG82563_PHY_KMRN_MODE_CTRL , & reg_data ) ; if ( ret_val ) { return ret_val ; } ret_val = e1e_rphy ( hw , GG82563_PHY_KMRN_MODE_CTRL , & reg_data2 ) ; if ( ret_val ) { return ret_val ; } i ++ ; } ( reg_data != reg_data2 ) && ( i < GG82563_MAX_KMRN_RETRY ) ; if ( duplex == HALF_DUPLEX ) { reg_data |= GG82563_KMCR_PASS_FALSE_CARRIER ; } else { reg_data &= ~ GG82563_KMCR_PASS_FALSE_CARRIER ; } return e1e_wphy ( hw , GG82563_PHY_KMRN_MODE_CTRL , reg_data ) ; } 