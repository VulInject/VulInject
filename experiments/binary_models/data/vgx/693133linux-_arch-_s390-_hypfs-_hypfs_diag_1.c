__init int hypfs_diag_init ( void ) { int rc ; if ( diag204_probe ( ) ) { pr_info ( "The hardware system does not support hypfs\n" ) ; return - ENODATA ; } if ( diag204_info_type == DIAG204_INFO_EXT ) { hypfs_dbfs_create_file ( & dbfs_file_d204 ) ; } if ( MACHINE_IS_LPAR ) { rc = diag224_get_name_table ( ) ; if ( rc ) { pr_err ( "The hardware system does not provide all " "functions required by hypfs\n" ) ; debugfs_remove ( dbfs_d204_file , NULL ) ; return rc ; } } return 0 ; } 