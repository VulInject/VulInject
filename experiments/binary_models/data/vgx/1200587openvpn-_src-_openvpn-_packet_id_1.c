bool packet_id_read ( struct packet_id_net * pin , struct buffer * buf , bool long_form ) { packet_id_type net_id ; net_time_t net_time ; pin -> id = 0 ; pin -> time = 0 ; if ( ! buf_read ( buf , & net_id , sizeof ( net_id ) ) ) { return false ; } pin -> id = ntohpid ( net_id ) ; if ( long_form ) { if ( ! buf_read ( buf , & net_time , sizeof ( net_time ) ) ) { return false ; } pin -> time = ntohtime ( net_time , NULL ) ; } return true ; } 