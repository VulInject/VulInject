static int mlxsw_sp1_mr_tcam_region_init ( struct mlxsw_sp * mlxsw_sp , struct mlxsw_sp1_mr_tcam_region * mr_tcam_region , enum mlxsw_reg_rtar_key_type rtar_key_type ) { struct parman_prio * parman_prios ; struct parman * parman ; int err ; int i ; mr_tcam_region -> rtar_key_type = rtar_key_type ; mr_tcam_region -> mlxsw_sp = mlxsw_sp ; err = mlxsw_sp1_mr_tcam_region_alloc ( mr_tcam_region ) ; parman = parman_create ( & mlxsw_sp1_mr_tcam_region_parman_ops , mr_tcam_region ) ; if ( ! parman ) { err = - ENOMEM ; err_parman_create } mr_tcam_region -> parman = parman ; parman_prios = kmalloc_array ( MLXSW_SP_MR_ROUTE_PRIO_MAX + 1 , sizeof ( * parman_prios ) , GFP_KERNEL ) ; if ( ! parman_prios ) { err = - ENOMEM ; err_parman_prios_alloc } mr_tcam_region -> parman_prios = parman_prios ; for ( i = 0 ; i < MLXSW_SP_MR_ROUTE_PRIO_MAX + 1 ; i ++ ) { parman_prio_init ( mr_tcam_region -> parman , & mr_tcam_region -> parman_prios [ i ] , i ) ; } return 0 ; err_parman_prios_alloc parman_destroy ( parman ) ; err_parman_create mlxsw_sp1_mr_tcam_region_free ( mr_tcam_region ) ; return err ; } 