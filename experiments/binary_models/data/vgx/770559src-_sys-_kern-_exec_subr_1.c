int vmcmd_map_zero ( struct proc * p , struct exec_vmcmd * cmd ) { int error ; KASSERT ( ( cmd -> ev_addr & PAGE_MASK ) == 0 ) ; error = uvm_map ( & p -> p_vmspace -> vm_map , & cmd -> ev_addr , round_page ( cmd -> ev_len ) , NULL , UVM_UNKNOWN_OFFSET , 0 , UVM_MAPFLAG ( cmd -> ev_prot , PROT_MASK , MAP_INHERIT_COPY , MADV_NORMAL , UVM_FLAG_FIXED | UVM_FLAG_COPYONW | ( cmd -> ev_flags & VMCMD_STACK ?UVM_FLAG_STACK : 0 ) ) ) ; if ( cmd -> ev_flags & VMCMD_IMMUTABLE ) { uvm_map_immutable ( & p -> p_vmspace -> vm_map , cmd -> ev_addr , round_page ( cmd -> ev_addr + cmd -> ev_len ) , 1 ) ; } return error ; } 