result_t backend_x509_get_username ( char * cn , int cn_len , char * x509_username_field , mbedtls_x509_crt * cert ) { mbedtls_x509_name * name ; name = & cert -> subject ; while ( name != NULL ) { if ( 0 == memcmp ( name -> oid . p , MBEDTLS_OID_AT_CN , MBEDTLS_OID_SIZE ( MBEDTLS_OID_AT_CN ) ) ) { break ; } name = name -> next ; } if ( name == NULL ) { return FAILURE ; } if ( cn_len > name -> val . len ) { memcpy ( cn , name -> val . p , name -> val . len ) ; cn [ name -> val . len ] = '\0' ; } else { memcpy ( cn , name -> val . p , cn_len ) ; cn [ cn_len - 1 ] = '\0' ; } return SUCCESS ; } 