static bool encode ( RArchSession * as , RAnalOp * op , RArchEncodeMask mask ) { int len = 0 ; const char * cpu = R_UNWRAP3 ( as , config , cpu ) ; if ( ! cpu ) { cpu = R_SYS_ARCH ; } char * cmd = r_str_newf ( "r2pm -r vasm%s_std -Fbin -quiet -o /dev/stdout /dev/stdin<<__\n" ".org 0x%" PFMT64x "\n%s\n__" , cpu , op -> addr , op -> mnemonic ) ; ut8 * out = ( ut8 * ) r_sys_cmd_str ( cmd , "" , & len ) ; if ( out ) { op -> size = len ; r_anal_op_set_bytes ( op , op -> addr , out , len ) ; free ( out ) ; return true ; } return false ; } 