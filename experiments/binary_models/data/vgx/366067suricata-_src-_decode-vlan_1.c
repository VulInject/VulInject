static int DecodeVLANtest03 ( void ) { uint8_t raw_vlan [ ] { 0x00 0x20 0x08 0x00 0x45 0x00 0x00 0x34 0x3b 0x36 0x40 0x00 0x40 0x06 0xb7 0xc9 0x83 0x97 0x20 0x81 0x83 0x97 0x20 0x15 0x04 0x8a 0x17 0x70 0x4e 0x14 0xdf 0x55 0x4d 0x3d 0x5a 0x61 0x80 0x10 0x6b 0x50 0x3c 0x4c 0x00 0x00 0x01 0x01 0x08 0x0a 0x00 0x04 0xf0 0xc8 0x01 0x99 0xa3 0xf3 } ; ; Packet * p = PacketGetFromAlloc ( ) ; ThreadVars tv ; DecodeThreadVars dtv ; memset ( & tv , 0 , sizeof ( ThreadVars ) ) ; memset ( & dtv , 0 , sizeof ( DecodeThreadVars ) ) ; FlowInitConfig ( FLOW_QUIET ) ; DecodeVLAN ( & tv , & dtv , p , raw_vlan , sizeof ( raw_vlan ) ) ; if ( p -> vlan_id [ 0 ] == 0 ) { error } if ( ENGINE_ISSET_EVENT ( p , VLAN_HEADER_TOO_SMALL ) ) { error } if ( ENGINE_ISSET_EVENT ( p , VLAN_UNKNOWN_TYPE ) ) { error } PacketRecycle ( p ) ; FlowShutdown ( ) ; SCFree ( p ) ; return 1 ; error PacketRecycle ( p ) ; FlowShutdown ( ) ; SCFree ( p ) ; return 0 ; } 