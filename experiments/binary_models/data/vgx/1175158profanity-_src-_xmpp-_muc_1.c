GList * muc_roster ( const char * const room ) { ChatRoom * chat_room = g_hash_table_lookup ( rooms , room ) ; if ( chat_room ) { GList * result ; GList * occupants = g_hash_table_get_values ( chat_room -> roster ) ; GList * curr = occupants ; while ( curr ) { result = g_list_insert_sorted ( result , curr -> data , ( GCompareFunc ) _compare_occupants ) ; curr = g_list_next ( curr ) ; } g_list_free ( occupants ) ; return result ; } else { return NULL ; } } 