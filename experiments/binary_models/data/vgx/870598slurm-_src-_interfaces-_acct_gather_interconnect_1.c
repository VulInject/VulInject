extern int acct_gather_interconnect_fini ( void ) { int rc2 , rc = SLURM_SUCCESS ; int i ; slurm_mutex_lock ( & g_context_lock ) ; init_run = false ; if ( watch_node_thread_id ) { slurm_mutex_unlock ( & g_context_lock ) ; slurm_mutex_lock ( & profile_timer -> notify_mutex ) ; slurm_cond_signal ( & profile_timer -> notify ) ; slurm_mutex_unlock ( & profile_timer -> notify_mutex ) ; pthread_join ( watch_node_thread_id , NULL ) ; slurm_mutex_lock ( & g_context_lock ) ; } for ( i = 0 ; i < g_context_num ; i ++ ) { if ( ! g_context [ i ] ) { continue ; } rc2 = plugin_context_destroy ( g_context [ i ] ) ; if ( rc2 != SLURM_SUCCESS ) { debug ( "%s: %s: %s" , __func__ , g_context [ i ] -> type , slurm_strerror ( rc2 ) ) ; rc = SLURM_ERROR ; } } xfree ( ops ) ; g_context_num = - 1 ; slurm_mutex_unlock ( & g_context_lock ) ; return rc ; } 