static int pi_register_parport ( PIA * pi , int verbose , int unit ) { struct parport * port ; struct pardev_cb par_cb ; port = parport_find_base ( pi -> port ) ; if ( ! port ) { return 0 ; } par_cb . wakeup = pi_wake_up ; par_cb . private = ( void * ) pi ; pi -> pardev = parport_register_dev_model ( port , pi -> device , & par_cb , unit ) ; parport_put_port ( port ) ; if ( ! pi -> pardev ) { return 0 ; } init_waitqueue_head ( & pi -> parq ) ; if ( verbose ) { printk ( "%s: 0x%x is %s\n" , pi -> device , pi -> port , port -> name ) ; } pi -> parname = ( char * ) port -> name ; return 1 ; } 