void interpret_nisbind ( int flags , int type , int xid , int vers , int proc , char * data , int len ) { char * line ; char buff [ YPMAXDOMAIN + 1 ] ; unsigned int status ; if ( proc ( 0 || proc ) MAXPROC_BIND ) { return ; } if ( flags & F_SUM ) { line = get_sum_line ( ) ; if ( type == CALL ) { ( void ) sprintf ( line , "NISBIND C %s" , procnames_bind_short [ proc ] ) ; line += strlen ( line ) ; switch ( proc ) { case YPBINDPROC_NULL : break ; case YPBINDPROC_DOMAIN : ( void ) sprintf ( line , " %s" , getxdr_string ( buff , YPMAXDOMAIN ) ) ; break ; case YPBINDPROC_SETDOM : ( void ) sprintf ( line , " %s" , getxdr_string ( buff , YPMAXDOMAIN ) ) ; break ; default : break ; } check_retransmit ( line , xid ) ; } else { ( void ) sprintf ( line , "NISBIND R %s " , procnames_bind_short [ proc ] ) ; line += strlen ( line ) ; switch ( proc ) { case YPBINDPROC_NULL : break ; case YPBINDPROC_DOMAIN : status = getxdr_long ( ) ; if ( status == 1 ) { ( void ) strcat ( line , "OK" ) ; } else { status = getxdr_long ( ) ; ( void ) sprintf ( line , "ERROR=%s" , ypbind_error ( status ) ) ; } break ; case YPBINDPROC_SETDOM : break ; default : break ; } } } if ( flags & F_DTAIL ) { show_header ( "NISBIND:" , "Network Information Service Bind" , len ) ; show_space ( ) ; if ( setjmp ( xdr_err ) ) { return ; } ( void ) sprintf ( get_line ( 0 , 0 ) , "Proc = %d (%s)" , proc , procnames_bind_long [ proc ] ) ; if ( type == CALL ) { switch ( proc ) { case YPBINDPROC_NULL : break ; case YPBINDPROC_DOMAIN : ( void ) showxdr_string ( YPMAXDOMAIN , "Domain = %s" ) ; break ; case YPBINDPROC_SETDOM : ( void ) showxdr_string ( YPMAXDOMAIN , "Domain = %s" ) ; ( void ) showxdr_hex ( 4 , "Address=%s" ) ; ( void ) showxdr_hex ( 2 , "Port=%s" ) ; ( void ) showxdr_u_long ( "Version=%lu" ) ; break ; default : break ; } } else { switch ( proc ) { case YPBINDPROC_NULL : break ; case YPBINDPROC_DOMAIN : status = getxdr_u_long ( ) ; ( void ) sprintf ( get_line ( 0 , 0 ) , "Status = %lu (%s)" , status , status == 1 ?"OK" : "Fail" ) ; if ( status == 1 ) { ( void ) showxdr_hex ( 4 , "Address=%s" ) ; ( void ) showxdr_hex ( 2 , "Port=%s" ) ; } else { status = getxdr_u_long ( ) ; ( void ) sprintf ( get_line ( 0 , 0 ) , "Error = %lu (%s)" , status , ypbind_error ( status ) ) ; } break ; case YPBINDPROC_SETDOM : break ; default : break ; } } show_trailer ( ) ; } } 