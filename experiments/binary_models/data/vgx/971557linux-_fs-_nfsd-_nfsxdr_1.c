static bool svcxdr_decode_sattr ( struct svc_rqst * rqstp , struct xdr_stream * xdr , struct iattr * iap ) { u32 tmp1 , tmp2 ; __be32 * p ; p = xdr_inline_decode ( xdr , XDR_UNIT * 8 ) ; iap -> ia_valid = 0 ; tmp1 = be32_to_cpup ( p ++ ) ; if ( tmp1 != ( u32 ) - 1 && tmp1 != 0xffff ) { iap -> ia_valid |= ATTR_MODE ; iap -> ia_mode = tmp1 ; } tmp1 = be32_to_cpup ( p ++ ) ; if ( tmp1 != ( u32 ) - 1 ) { iap -> ia_uid = make_kuid ( nfsd_user_namespace ( rqstp ) , tmp1 ) ; if ( uid_valid ( iap -> ia_uid ) ) { iap -> ia_valid |= ATTR_UID ; } } tmp1 = be32_to_cpup ( p ++ ) ; if ( tmp1 != ( u32 ) - 1 ) { iap -> ia_gid = make_kgid ( nfsd_user_namespace ( rqstp ) , tmp1 ) ; if ( gid_valid ( iap -> ia_gid ) ) { iap -> ia_valid |= ATTR_GID ; } } tmp1 = be32_to_cpup ( p ++ ) ; if ( tmp1 != ( u32 ) - 1 ) { iap -> ia_valid |= ATTR_SIZE ; iap -> ia_size = tmp1 ; } tmp1 = be32_to_cpup ( p ++ ) ; tmp2 = be32_to_cpup ( p ++ ) ; if ( tmp1 != ( u32 ) - 1 && tmp2 != ( u32 ) - 1 ) { iap -> ia_valid |= ATTR_ATIME | ATTR_ATIME_SET ; iap -> ia_atime . tv_sec = tmp1 ; iap -> ia_atime . tv_nsec = tmp2 * NSEC_PER_USEC ; } tmp1 = be32_to_cpup ( p ++ ) ; tmp2 = be32_to_cpup ( p ++ ) ; if ( tmp1 != ( u32 ) - 1 && tmp2 != ( u32 ) - 1 ) { iap -> ia_valid |= ATTR_MTIME | ATTR_MTIME_SET ; iap -> ia_mtime . tv_sec = tmp1 ; iap -> ia_mtime . tv_nsec = tmp2 * NSEC_PER_USEC ; if ( tmp2 == 1000000 ) { iap -> ia_valid &= ~ ( ATTR_ATIME_SET | ATTR_MTIME_SET ) ; } } return true ; } 