CK_RV FUN1 ( CK_SLOT_ID VAR1 , CK_TOKEN_INFO_PTR VAR2 ) { struct VAR3 * VAR4 ; struct VAR5 * VAR6 = NULL ; struct VAR7 * VAR8 ; const char * VAR9 ; CK_RV VAR10 ; FUN2 ( VAR11 , "" , VAR1 ) ; if ( VAR2 == VAR12 ) { return VAR13 ; } VAR10 = FUN3 ( ) ; VAR10 = FUN4 ( VAR1 , & VAR4 ) ; if ( VAR10 != VAR14 ) { FUN2 ( VAR11 , "" , VAR10 ) ; VAR15 } if ( VAR4 -> VAR16 == NULL ) { if ( VAR4 -> VAR17 . VAR18 & VAR19 ) { VAR10 = VAR20 ; } else { VAR10 = VAR21 ; } VAR15 } VAR6 = ( VAR5 * ) VAR4 -> VAR16 -> VAR22 [ VAR4 -> VAR23 ] ; if ( ! VAR6 ) { VAR10 = FUN5 ( VAR24 , "" ) ; VAR15 } VAR4 -> VAR25 . VAR18 &= ~ ( VAR26 | VAR27 | VAR28 ) ; VAR8 = FUN6 ( VAR4 -> VAR6 ) ; FUN2 ( VAR11 , "" , VAR8 , VAR4 -> VAR25 . VAR18 ) ; if ( VAR8 ) { struct VAR29 * VAR30 = NULL ; struct VAR31 * VAR32 = NULL ; VAR32 = ( VAR31 * ) VAR8 -> VAR33 ; VAR30 = VAR6 -> VAR34 ; if ( ! VAR30 ) { VAR10 = FUN5 ( VAR35 , "" ) ; VAR15 } FUN7 ( VAR30 , VAR8 ) ; if ( VAR32 -> VAR36 >= 0 ) { if ( VAR32 -> VAR36 == 1 || VAR32 -> VAR37 == 1 ) { VAR4 -> VAR25 . VAR18 |= VAR27 ; } if ( VAR32 -> VAR36 == 0 ) { VAR4 -> VAR25 . VAR18 |= VAR28 ; } if ( VAR32 -> VAR37 > 1 && VAR32 -> VAR36 < VAR32 -> VAR37 ) { VAR4 -> VAR25 . VAR18 |= VAR26 ; } } } memcpy ( VAR2 , & VAR4 -> VAR25 , sizeof ( VAR38 ) ) ; out FUN8 ( ) ; VAR9 = FUN9 ( VAR39 , VAR10 ) ; if ( VAR9 ) { FUN2 ( VAR11 , "" , VAR1 , VAR9 ) ; } else { FUN2 ( VAR11 , "" , VAR1 , VAR10 ) ; } return VAR10 ; }