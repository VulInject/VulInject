gimp_gradient_tool_initialize ( , , ) { GimpImage * image = gimp_display_get_image ( display ) ; GimpGradientOptions * options = GIMP_GRADIENT_TOOL_GET_OPTIONS ( tool ) ; GimpGuiConfig * config = GIMP_GUI_CONFIG ( display -> gimp -> config ) ; GimpItem * locked_item ; GList * drawables ; GimpDrawable * drawable ; if ( ! GIMP_TOOL_CLASS ( parent_class ) -> initialize ( tool , display , error ) ) { return FALSE ; } drawables = gimp_image_get_selected_drawables ( image ) ; if ( g_list_length ( drawables ) != 1 ) { if ( g_list_length ( drawables ) > 1 ) { gimp_tool_message_literal ( tool , display , _ ( "Cannot paint on multiple drawables. Select only one." ) ) ; } else { gimp_tool_message_literal ( tool , display , _ ( "No active drawables." ) ) ; } g_list_free ( drawables ) ; return FALSE ; } drawable = drawables -> data ; g_list_free ( drawables ) ; if ( gimp_viewable_get_children ( GIMP_VIEWABLE ( drawable ) ) ) { g_set_error_literal ( error , GIMP_ERROR , GIMP_FAILED , _ ( "Cannot modify the pixels of layer groups." ) ) ; return FALSE ; } if ( gimp_item_is_content_locked ( GIMP_ITEM ( drawable ) , & locked_item ) ) { g_set_error_literal ( error , GIMP_ERROR , GIMP_FAILED , _ ( "The selected layer's pixels are locked." ) ) ; if ( error ) { gimp_tools_blink_lock_box ( display -> gimp , locked_item ) ; } return FALSE ; } if ( ! gimp_item_is_visible ( GIMP_ITEM ( drawable ) ) && ! config -> edit_non_visible ) { g_set_error_literal ( error , GIMP_ERROR , GIMP_FAILED , _ ( "The selected item is not visible." ) ) ; return FALSE ; } if ( ! gimp_context_get_gradient ( GIMP_CONTEXT ( options ) ) ) { g_set_error_literal ( error , GIMP_ERROR , GIMP_FAILED , _ ( "No gradient available for use with this tool." ) ) ; return FALSE ; } return TRUE ; } 