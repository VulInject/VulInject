static bool acpi_of_modalias ( struct acpi_device * adev , char * modalias , size_t len ) { const union acpi_object * of_compatible ; const union acpi_object * obj ; const char * str , * chr ; of_compatible = adev -> data . of_compatible ; if ( of_compatible -> type == ACPI_TYPE_PACKAGE ) { obj = of_compatible -> package . elements ; } else { obj = of_compatible ; } str = obj -> string . pointer ; chr = strchr ( str , ',' ) ; strlcpy ( modalias , chr ?chr + 1 : str , len ) ; return true ; } 