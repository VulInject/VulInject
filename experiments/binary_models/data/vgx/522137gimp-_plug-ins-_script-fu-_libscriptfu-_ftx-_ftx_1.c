pointer foreign_dirreadentry ( scheme * sc , pointer args ) { pointer first_arg ; GDir * dir ; gchar * entry ; if ( args == sc -> NIL ) { return sc -> F ; } first_arg = sc -> vptr -> pair_car ( args ) ; if ( ! sc -> vptr -> is_integer ( first_arg ) ) { return sc -> F ; } dir = ( GDir * ) sc -> vptr -> ivalue ( first_arg ) ; entry = ( gchar * ) g_dir_read_name ( dir ) ; if ( entry == NULL ) { return sc -> EOF_OBJ ; } entry = g_filename_to_utf8 ( entry , - 1 , NULL , NULL , NULL ) ; return ( sc -> vptr -> mk_string ( sc , entry ) ) ; } 