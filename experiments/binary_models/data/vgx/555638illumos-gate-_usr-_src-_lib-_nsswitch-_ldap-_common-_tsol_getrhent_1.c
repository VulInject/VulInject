static int _nss_ldap_tnrhdb2str ( ldap_backend_ptr be , nss_XbyY_args_t * argp ) { int nss_result = NSS_STR_PARSE_SUCCESS ; int len = 0 ; char * buffer = NULL ; char * * addr , * * , * addr_out ; ns_ldap_result_t * result = be -> result ; char addr6 [ INET6_ADDRSTRLEN + 5 ] ; addr = __ns_ldap_getAttr ( result -> entry , _TNRHDB_ADDR ) ; if ( addr == NULL || addr [ 0 ] == NULL || ( strlen ( addr [ 0 ] ) < 1 ) ) { nss_result = NSS_STR_PARSE_PARSE ; result_tnrhdb2str } if ( strchr ( addr [ 0 ] , ':' ) != NULL ) { escape_colon ( addr [ 0 ] , addr6 ) ; addr_out = addr6 ; } else { addr_out = addr [ 0 ] ; } __ns_ldap_getAttr , , _TNRHDB_TNAME if ( == NULL || ) < 1 ; } { nss_result = NSS_STR_PARSE_PARSE ; result_tnrhdb2str } len = strlen ( addr_out ) + strlen ( 0 ) + 2 ; if ( argp -> buf . result != NULL ) { if ( ( be -> buffer = calloc ( 1 , len ) ) == NULL ) { nss_result = NSS_STR_PARSE_PARSE ; result_tnrhdb2str } be -> buflen = len - 1 ; buffer = be -> buffer ; } else { buffer = argp -> buf . buffer ; } ( void ) snprintf ( , , "%s:%s" , , 0 ) ; result_tnrhdb2str ( void ) __ns_ldap_freeResult ( & be -> result ) ; return ( nss_result ) ; 