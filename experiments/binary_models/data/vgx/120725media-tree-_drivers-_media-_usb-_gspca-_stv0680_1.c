static int stv0680_set_video_mode ( struct gspca_dev * gspca_dev , u8 mode ) { struct sd * sd = ( sd * ) gspca_dev ; if ( sd -> current_mode == mode ) { return 0 ; } gspca_dev -> usb_buf [ 0 ] = mode ; if ( stv_sndctrl ( gspca_dev , 3 , 0x07 , 0x0100 , 0x08 ) != 0x08 ) { PERR ( "Set_Camera_Mode failed" ) ; return stv0680_handle_error ( gspca_dev , - EIO ) ; } if ( stv0680_get_video_mode ( gspca_dev ) != mode ) { PERR ( "Error setting camera video mode!" ) ; return - EIO ; } sd -> current_mode = mode ; return 0 ; } 