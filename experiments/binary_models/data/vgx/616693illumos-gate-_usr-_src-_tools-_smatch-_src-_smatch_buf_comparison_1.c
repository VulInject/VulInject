int buf_comparison_index_ok ( struct expression * expr ) { struct expression * array ; struct expression * size ; struct expression * offset ; int limit_type ; int comparison ; array = get_array_base ( expr ) ; size = get_size_variable ( array , & limit_type ) ; offset = get_array_offset ( expr ) ; comparison = get_comparison ( offset , size ) ; if ( ! comparison ) { return 0 ; } if ( ( limit_type == ELEM_COUNT || limit_type == ELEM_LAST ) && ( comparison == '<' || comparison == SPECIAL_UNSIGNED_LT ) ) { return 1 ; } if ( limit_type == ELEM_LAST && ( comparison == SPECIAL_LTE || comparison == SPECIAL_UNSIGNED_LTE || comparison == SPECIAL_EQUAL ) ) { return 1 ; } return 0 ; } 