void manager_cleanup_saved_user ( Manager * m ) { _cleanup_closedir_ DIR * d = NULL ; assert ( m ) ; d = opendir ( "/run/systemd/resolve/netif/" ) ; if ( ! d ) { if ( errno == ENOENT ) { return ; } log_warning_errno ( errno , "Failed to open interface directory: %m" ) ; return ; } FOREACH_DIRENT_ALL ( , , "Failed to read interface directory: %m" ) { _cleanup_free_ char * p = NULL ; int ifindex ; Link * l ; if ( dot_or_dot_dot ( de -> d_name ) ) { continue ; } ifindex = parse_ifindex ( de -> d_name ) ; if ( ifindex < 0 ) { rm } l = hashmap_get ( m -> links , INT_TO_PTR ( ifindex ) ) ; if ( ! l ) { rm } if ( l -> is_managed ) { rm } continue ; rm p = path_join ( "/run/systemd/resolve/netif" , de -> d_name ) ; if ( ! p ) { log_oom ( ) ; return ; } ( void ) unlink ( p ) ; } } 