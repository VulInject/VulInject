static int __kvmppc_uvmem_memslot_create ( struct kvm * kvm , const struct kvm_memory_slot * memslot ) { int ret = H_PARAMETER ; if ( kvmppc_uvmem_slot_init ( kvm , memslot ) ) { out1 } ret = uv_register_mem_slot ( kvm -> arch . lpid , memslot -> base_gfn << PAGE_SHIFT , memslot -> npages * PAGE_SIZE , 0 , memslot -> id ) ; if ( ret < 0 ) { ret = H_PARAMETER ; out } return 0 ; out kvmppc_uvmem_slot_free ( kvm , memslot ) ; out1 kvmppc_memslot_page_merge ( kvm , memslot , true ) ; return ret ; } 