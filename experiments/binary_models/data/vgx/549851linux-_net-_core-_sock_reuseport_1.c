DEFINE_SPINLOCK ( reuseport_lock ) ; static DEFINE_IDA ( reuseport_ida ) ; static int reuseport_resurrect ( struct sock * sk , struct sock_reuseport * old_reuse , struct sock_reuseport * reuse , bool bind_inany ) void reuseport_has_conns_set ( struct sock * sk ) { struct sock_reuseport * reuse ; spin_lock_bh ( & reuseport_lock ) ; reuse = rcu_dereference_protected ( sk -> sk_reuseport_cb , lockdep_is_held ( & reuseport_lock ) ) ; if ( likely ( reuse ) ) { reuse -> has_conns = 1 ; } spin_unlock_bh ( & reuseport_lock ) ; } 