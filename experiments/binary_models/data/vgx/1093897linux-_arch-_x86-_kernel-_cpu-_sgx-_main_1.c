struct sgx_epc_page * __sgx_alloc_epc_page ( void ) { struct sgx_epc_page * page ; int nid_of_current = numa_node_id ( ) ; int nid = nid_of_current ; if ( node_isset ( nid_of_current , sgx_numa_mask ) ) { page = __sgx_alloc_epc_page_from_node ( nid_of_current ) ; } while ( true ) { nid = next_node_in ( nid , sgx_numa_mask ) ; if ( nid == nid_of_current ) { break ; } page = __sgx_alloc_epc_page_from_node ( nid ) ; if ( page ) { return page ; } } return ERR_PTR ( - ENOMEM ) ; } 