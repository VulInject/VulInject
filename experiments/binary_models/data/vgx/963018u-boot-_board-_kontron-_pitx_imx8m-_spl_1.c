int power_init_board ( void ) { struct pmic * p ; int ret ; unsigned int reg ; ret = power_pfuze100_init ( I2C_PMIC ) ; p = pmic_get ( "PFUZE100" ) ; ret = pmic_probe ( p ) ; if ( ret ) { return - ENODEV ; } pmic_reg_read ( p , PFUZE100_SW3AVOL , & reg ) ; if ( ( reg & 0x3f ) != 0x18 ) { reg &= ~ 0x3f ; reg |= 0x18 ; pmic_reg_write ( p , PFUZE100_SW3AVOL , reg ) ; } ret = pfuze_mode_init ( p , APS_PFM ) ; if ( ret < 0 ) { return ret ; } pmic_reg_read ( p , PFUZE100_SW3AMODE , & reg ) ; reg &= ~ 0xf ; reg |= APS_OFF ; pmic_reg_write ( p , PFUZE100_SW3AMODE , reg ) ; return 0 ; } 