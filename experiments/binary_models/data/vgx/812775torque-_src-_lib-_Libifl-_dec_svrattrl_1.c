int decode_DIS_svrattrl ( struct tcp_chan * chan , tlist_head * phead ) { unsigned int i ; unsigned int hasresc ; size_t ls ; int data_len ; unsigned int numattr ; svrattrl * psvrat = NULL ; int rc ; size_t tsize ; numattr = disrui ( chan , & rc ) ; if ( rc ) { return rc ; } for ( i = 0 ; i < numattr ; ++ i ) { data_len = disrui ( chan , & rc ) ; if ( data_len == 0 ) { data_len = sizeof ( char ) ; } if ( rc ) { return ( rc ) ; } tsize = sizeof ( svrattrl ) + data_len + 2 ; if ( ( psvrat = ( svrattrl * ) calloc ( 1 , tsize ) ) == 0 ) { return DIS_NOMALLOC ; } CLEAR_LINK ( psvrat -> al_link ) ; psvrat -> al_atopl . next = 0 ; psvrat -> al_tsize = tsize ; psvrat -> al_name = ( char * ) psvrat + sizeof ( svrattrl ) ; psvrat -> al_resc = 0 ; psvrat -> al_value = 0 ; psvrat -> al_nameln = 0 ; psvrat -> al_rescln = 0 ; psvrat -> al_valln = 0 ; psvrat -> al_flags = 0 ; if ( ( rc = disrfcs ( chan , & ls , data_len , psvrat -> al_name ) ) ) { break ; } * ( psvrat -> al_name + ls ++ ) = '\0' ; psvrat -> al_nameln = ( int ) ls ; data_len -= ls ; hasresc = disrui ( chan , & rc ) ; if ( rc ) { break ; } if ( hasresc ) { psvrat -> al_resc = psvrat -> al_name + ls ; if ( ( rc = disrfcs ( chan , & ls , data_len , psvrat -> al_resc ) ) ) { } } } } 