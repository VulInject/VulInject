static int get_filter ( pool * p , const char * pattern , pr_regex_t * * pre ) { int res ; * pre = pr_regexp_alloc ( & geoip_module ) ; res = pr_regexp_compile ( * pre , pattern , REG_EXTENDED | REG_NOSUB | REG_ICASE ) ; if ( res != 0 ) { char errstr [ 256 ] ; pr_regexp_error ( res , * pre , errstr , sizeof ( errstr ) - 1 ) ; pr_regexp_free ( & geoip_module , * pre ) ; * pre = NULL ; pr_log_pri ( PR_LOG_DEBUG , MOD_GEOIP_VERSION ": pattern '%s' failed regex compilation: %s" , pattern , errstr ) ; errno = EINVAL ; return - 1 ; } return res ; } 