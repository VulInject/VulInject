void smb_data_print ( netdissect_options * ndo , const u_char * buf , u_int len ) { u_int i = 0 ; ND_PRINT ( "[%03X] " , i ) ; for ( i = 0 ; i < len ; ) { ND_PRINT ( "%02X " , GET_U_1 ( buf + i ) & 0xff ) ; i ++ ; if ( i % 8 == 0 ) { ND_PRINT ( " " ) ; } if ( i % 16 == 0 ) { print_asc ( ndo , buf + i - 16 , 8 ) ; ND_PRINT ( " " ) ; print_asc ( ndo , buf + i - 8 , 8 ) ; ND_PRINT ( "\n" ) ; if ( i < len ) { ND_PRINT ( "[%03X] " , i ) ; } } } if ( i % 16 ) { int n ; n = 16 - ( i % 16 ) ; ND_PRINT ( " " ) ; if ( n > 8 ) { ND_PRINT ( " " ) ; } while ( n -- ) { ND_PRINT ( "   " ) ; } n = ND_MIN ( 8 , i % 16 ) ; print_asc ( ndo , buf + i - ( i % 16 ) , n ) ; ND_PRINT ( " " ) ; n = ( i % 16 ) - n ; if ( n > 0 ) { print_asc ( ndo , buf + i - n , n ) ; } ND_PRINT ( "\n" ) ; } } 