static int lookup_and_lock_propnode ( int rw , picl_prophdl_t proph , picl_obj_t * * nodep , picl_obj_t * * propp ) { picl_obj_t * pobj ; picl_obj_t * nobj ; pobj = hash_lookup_obj ( & ptreetbl , proph ) ; nobj = NULL ; if ( pobj -> obj_type == PICL_OBJ_PROP ) { nobj = pobj -> prop_node ; } if ( pobj -> obj_type == ( PICL_OBJ_PROP | PICL_OBJ_TABLEENTRY ) ) { nobj = pobj -> prop_table -> prop_node ; } else { * propp = pobj ; return ( PICL_NOTPROP ) ; } if ( nobj && ( lock_obj ( rw , nobj ) < 0 ) ) { return ( PICL_FAILURE ) ; } * nodep = nobj ; * propp = pobj ; return ( PICL_SUCCESS ) ; } 