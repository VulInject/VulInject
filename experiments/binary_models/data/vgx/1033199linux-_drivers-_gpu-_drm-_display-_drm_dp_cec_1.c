static int drm_dp_cec_received ( struct drm_dp_aux * aux ) { struct cec_adapter * adap = aux -> cec . adap ; struct cec_msg msg ; u8 rx_msg_info ; ssize_t err ; err = drm_dp_dpcd_readb ( aux , DP_CEC_RX_MESSAGE_INFO , & rx_msg_info ) ; if ( err < 0 ) { return err ; } msg . len = ( rx_msg_info & DP_CEC_RX_MESSAGE_LEN_MASK ) + 1 ; err = drm_dp_dpcd_read ( aux , DP_CEC_RX_MESSAGE_BUFFER , msg . msg , msg . len ) ; if ( err < 0 ) { return err ; } cec_received_msg ( adap , & msg ) ; return 0 ; } 