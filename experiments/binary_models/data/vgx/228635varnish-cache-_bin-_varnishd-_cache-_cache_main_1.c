static void child_sigmagic ( size_t altstksz ) { struct sigaction sa ; size_t sz = vmax_t ( size_t , SIGSTKSZ + 4096 , altstksz ) ; altstack . ss_sp = mmap ( NULL , sz , PROT_READ | PROT_WRITE , MAP_PRIVATE | MAP_ANONYMOUS , - 1 , 0 ) ; AN ( altstack . ss_sp != MAP_FAILED ) ; AN ( altstack . ss_sp ) ; altstack . ss_size = sz ; altstack . ss_flags = 0 ; sa . sa_flags |= SA_ONSTACK ; ( void ) altstksz ; THR_Init ( ) ; sa . sa_sigaction = child_signal_handler ; sa . sa_flags |= SA_SIGINFO ; ( void ) sigaction ( SIGBUS , & sa , NULL ) ; ( void ) sigaction ( SIGABRT , & sa , NULL ) ; ( void ) sigaction ( SIGSEGV , & sa , NULL ) ; } 