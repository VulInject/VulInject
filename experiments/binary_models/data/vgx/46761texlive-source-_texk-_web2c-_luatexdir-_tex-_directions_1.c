scaled_whd pack_width_height_depth ( int curdir , int pdir , halfword p , boolean isglyph ) { scaled_whd whd = { 0 0 0 } ; whd . wd = pack_width ( curdir , pdir , p , isglyph ) ; if ( isglyph ) { if ( is_rotated ( curdir ) ) { if ( textdir_parallel ( curdir , pdir ) ) { whd . ht = whd . dp = ( glyph_height ( p ) + glyph_depth ( p ) ) / 2 ; } else { whd . ht = whd . dp = glyph_width ( p ) / 2 ; } } if ( is_rotated ( pdir ) ) { if ( textdir_parallel ( curdir , pdir ) ) { whd . ht = whd . dp = ( glyph_height ( p ) + glyph_depth ( p ) ) / 2 ; } else { whd . ht = glyph_width ( p ) ; } } else { if ( glyphdir_eq ( curdir , pdir ) ) { whd . ht = glyph_height ( p ) ; whd . dp = glyph_depth ( p ) ; } if ( glyphdir_opposite ( curdir , pdir ) ) { whd . ht = glyph_depth ( p ) ; whd . dp = glyph_height ( p ) ; } else { whd . ht = glyph_width ( p ) ; } } } else { if ( is_rotated ( curdir ) ) { if ( textdir_parallel ( curdir , pdir ) ) { whd . ht = whd . dp = ( height ( p ) + depth ( p ) ) / 2 ; } else { whd . ht = whd . dp = width ( p ) / 2 ; } } if ( pardir_eq ( curdir , pdir ) ) { whd . ht = height ( p ) ; whd . dp = depth ( p ) ; } if ( pardir_opposite ( curdir , pdir ) ) { whd . ht = depth ( p , NULL ) ; whd . dp = height ( p ) ; } else { whd . ht = width ( p ) ; } } return whd ; } 