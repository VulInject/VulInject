void x509_print ( const X509 * x ) { const ASN1_INTEGER * xserial ; const X509_NAME * xissuer ; char * issuer = NULL ; char * serial ; if ( ( xissuer = X509_get_issuer_name ( x ) ) == NULL ) { warnx ( "X509_get_issuer_name failed" ) ; out } if ( ( issuer = X509_NAME_oneline ( xissuer , NULL , 0 ) ) == NULL ) { warnx ( "X509_NAME_oneline failed" ) ; out } if ( ( xserial = X509_get0_serialNumber ( x ) ) == NULL ) { warnx ( "X509_get0_serialNumber failed" ) ; out } if ( ( serial = x509_convert_seqnum ( __func__ , xserial ) ) == NULL ) { out } if ( outformats & FORMAT_JSON ) { printf ( "\t\"cert_issuer\": \"%s\",\n" , issuer ) ; printf ( "\t\"cert_serial\": \"%s\",\n" , serial ) ; } else { printf ( "Certificate issuer:       %s\n" , issuer ) ; printf ( "Certificate serial:       %s\n" , serial ) ; } out free ( issuer ) ; free ( serial ) ; } 