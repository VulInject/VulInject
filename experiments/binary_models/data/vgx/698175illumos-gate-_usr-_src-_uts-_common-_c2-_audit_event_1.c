static void aus_fchown ( struct t_audit_data * tad ) { klwp_t * clwp = ttolwp ( curthread ) ; uint32_t uid , gid , fd ; struct file * fp ; struct vnode * vp ; struct f_audit_data * fad ; a { long fd ; long uid ; long gid ; } , * uap = ( a * ) clwp -> lwp_ap fd = ( uint32_t ) uap -> fd ; uid = ( uint32_t ) uap -> uid ; gid = ( uint32_t ) uap -> gid ; au_uwrite ( au_to_arg32 ( 2 , "new file uid" , uid ) ) ; au_uwrite ( au_to_arg32 ( 3 , "new file gid" , gid ) ) ; if ( ( fp = getf ( fd ) ) == NULL ) { return ; } fad = F2A ( fp ) ; if ( fad -> fad_aupath != NULL ) { au_uwrite ( au_to_path ( fad -> fad_aupath ) ) ; } else { au_uwrite ( au_to_arg32 ( 1 , "no path: fd" , fd ) ) ; } vp = fp -> f_vnode ; audit_attributes ( vp ) ; } 