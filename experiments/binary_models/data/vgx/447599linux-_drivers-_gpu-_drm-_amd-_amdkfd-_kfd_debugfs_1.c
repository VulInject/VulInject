static ssize_t kfd_debugfs_hang_hws_write ( struct file * file , const char __user * user_buf , size_t size , loff_t * ppos ) { struct kfd_dev * dev ; char tmp [ 16 ] ; uint32_t gpu_id ; int ret = - EINVAL ; if ( size >= 16 ) { pr_err ( "Invalid input for gpu id.\n" ) ; out } if ( copy_from_user ( tmp , user_buf , size ) ) { ret = - EFAULT ; out } if ( kstrtoint ( tmp , 10 , & gpu_id ) ) { pr_err ( "Invalid input for gpu id.\n" ) ; out } dev = kfd_device_by_id ( gpu_id ) ; if ( dev ) { kfd_debugfs_hang_hws ( dev ) ; ret = size ; } else { pr_err ( "Cannot find device %d.\n" , gpu_id ) ; } out return ret ; } 