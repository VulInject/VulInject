krb5_boolean KRB5_CALLCONV krb5_kuserok ( krb5_context context , krb5_principal aname , const char * lname ) { krb5_error_code ret ; struct localauth_module_handle * * hp ; krb5_boolean accepted = FALSE ; for ( hp = context -> localauth_handles ; * hp != NULL ; hp ++ ) { ret = userok ( context , * hp , aname , lname ) ; if ( ret == 0 ) { accepted = TRUE ; } if ( ret != KRB5_PLUGIN_NO_HANDLE ) { return FALSE ; } } return accepted ; } 