int getopt ( int argc , char * argv [ ] , char * opstring ) { static char * pIndexPosition = NULL ; char * pArgString ; char * pOptString ; if ( pIndexPosition != NULL ) { if ( * ( ++ pIndexPosition ) ) { pArgString = pIndexPosition ; } } if ( pArgString == NULL ) { if ( optind >= argc ) { pIndexPosition = NULL ; return EOF ; } pArgString = argv [ optind ++ ] ; if ( ( '/' != * pArgString ) && ( '-' != * pArgString ) ) { -- optind ; optarg = NULL ; pIndexPosition = NULL ; return EOF ; } if ( ( strcmp ( pArgString , "-" ) == 0 ) || ( strcmp ( pArgString , "--" ) == 0 ) ) { optarg = NULL ; pIndexPosition = NULL ; return EOF ; } pArgString ++ ; } if ( ':' == * pArgString ) { return ( opterr ?( int ) '?' : ( int ) ':' ) ; } if ( ( pOptString = strchr ( opstring , * pArgString ) ) == 0 ) { optarg = NULL ; pIndexPosition = NULL ; return ( opterr ?( int ) '?' : ( int ) * pArgString ) ; } else { if ( ':' == _next_char ( pOptString ) ) { if ( '\0' != _next_char ( pArgString ) ) { optarg = & pArgString [ 1 ] ; } else { if ( optind < argc ) { optarg = argv [ optind ++ ] ; } else { optarg = NULL ; return ( opterr ?( int ) '?' : ( int ) * pArgString ) ; } } pIndexPosition = NULL ; } else { optarg = NULL ; pIndexPosition = pArgString ; } return ( int ) * pArgString ; } } 