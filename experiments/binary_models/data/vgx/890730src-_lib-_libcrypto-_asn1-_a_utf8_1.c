int FUN1 ( const unsigned char * VAR1 , int VAR2 , unsigned long * VAR3 ) { const unsigned char * VAR4 ; unsigned long VAR5 ; int VAR6 ; if ( VAR2 <= 0 ) { return 0 ; } VAR4 = VAR1 ; if ( ( * VAR4 & 0x80 ) == 0 ) { VAR5 = * VAR4 ++ & 0x7f ; VAR6 = 1 ; } if ( ( * VAR4 & 0xe0 ) == 0xc0 ) { if ( * VAR4 < 0xc2 ) { return - 2 ; } if ( VAR2 < 2 ) { return - 1 ; } if ( ( VAR4 [ 1 ] & 0xc0 ) != 0x80 ) { return - 3 ; } VAR5 = ( * VAR4 ++ & 0x1f ) << 6 ; VAR5 |= * VAR4 ++ & 0x3f ; if ( VAR5 < 0x80 ) { return - 4 ; } VAR6 = 2 ; } if ( ( * VAR4 & 0xf0 ) == 0xe0 ) { if ( VAR2 < 3 ) { return - 1 ; } if ( ( ( VAR4 [ 1 ] & 0xc0 ) != 0x80 ) || ( ( VAR4 [ 2 ] & 0xc0 ) != 0x80 ) ) { return - 3 ; } VAR5 = ( * VAR4 ++ & 0xf ) << 12 ; VAR5 |= ( * VAR4 ++ & 0x3f ) << 6 ; VAR5 |= * VAR4 ++ & 0x3f ; if ( VAR5 < 0x800 ) { return - 4 ; } if ( VAR5 >= 0xd800 && VAR5 < 0xe000 ) { return - 2 ; } VAR6 = 3 ; } if ( ( * VAR4 & 0xf8 ) == 0xf0 && ( * VAR4 < 0xf5 ) ) { if ( VAR2 < 4 ) { return - 1 ; } if ( ( ( VAR4 [ 1 ] & 0xc0 ) != 0x80 ) || ( ( VAR4 [ 2 ] & 0xc0 ) != 0x80 ) || ( ( VAR4 [ 3 ] & 0xc0 ) != 0x80 ) ) { return - 3 ; } VAR5 = ( ( unsigned long ) ( * VAR4 ++ & 0x7 ) ) << 18 ; VAR5 |= ( * VAR4 ++ & 0x3f ) << 12 ; VAR5 |= ( * VAR4 ++ & 0x3f ) << 6 ; VAR5 |= * VAR4 ++ & 0x3f ; if ( VAR5 > VAR7 ) { return - 2 ; } VAR6 = 4 ; } else { return - 2 ; } * VAR3 = VAR5 ; return VAR6 ; }