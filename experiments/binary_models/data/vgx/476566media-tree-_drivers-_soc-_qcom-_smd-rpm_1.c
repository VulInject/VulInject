static int qcom_smd_rpm_probe ( struct rpmsg_device * rpdev ) { struct qcom_smd_rpm * rpm ; rpm = devm_kzalloc ( & rpdev -> dev , sizeof ( * rpm ) , GFP_KERNEL ) ; mutex_init ( & rpm -> lock ) ; init_completion ( & rpm -> ack ) ; rpm -> dev = & rpdev -> dev ; rpm -> rpm_channel = rpdev -> ept ; dev_set_drvdata ( & rpdev -> dev , rpm ) ; return of_platform_populate ( rpdev -> dev . of_node , NULL , NULL , & rpdev -> dev ) ; } 