void addr2sa ( int af , const union ldpd_addr * addr , uint16_t port , union sockunion * su ) { struct sockaddr_in * sa_in = & su -> sin ; struct sockaddr_in6 * sa_in6 = & su -> sin6 ; switch ( af ) { case AF_INET : sa_in -> sin_family = AF_INET ; sa_in -> sin_len = sizeof ( sockaddr_in ) ; sa_in -> sin_addr = addr -> v4 ; sa_in -> sin_port = htons ( port ) ; break ; case AF_INET6 : sa_in6 -> sin6_family = AF_INET6 ; sa_in6 -> sin6_len = sizeof ( sockaddr_in6 ) ; sa_in6 -> sin6_addr = addr -> v6 ; sa_in6 -> sin6_port = htons ( port ) ; break ; default : fatalx ( "addr2sa: unknown af" ) ; } } 