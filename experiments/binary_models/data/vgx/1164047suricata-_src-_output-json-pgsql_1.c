static OutputInitResult OutputPgsqlLogInitSub ( ConfNode * conf , OutputCtx * parent_ctx ) { OutputInitResult result = { NULL false } ; OutputJsonCtx * ojc = parent_ctx -> data ; OutputPgsqlCtx * pgsql_ctx = SCMalloc ( sizeof ( OutputPgsqlCtx ) ) ; OutputCtx * output_ctx = SCCalloc ( 1 , sizeof ( OutputCtx ) ) ; if ( unlikely ( output_ctx == NULL ) ) { SCFree ( pgsql_ctx ) ; return result ; } pgsql_ctx -> eve_ctx = ojc ; output_ctx -> data = pgsql_ctx ; output_ctx -> DeInit = OutputPgsqlLogDeInitCtxSub ; JsonPgsqlLogParseConfig ( conf , pgsql_ctx ) ; AppLayerParserRegisterLogger ( IPPROTO_TCP , ALPROTO_PGSQL ) ; SCLogDebug ( "PostgreSQL log sub-module initialized." ) ; result . ctx = output_ctx ; result . ok = true ; return result ; } 