static int ars_status_process_records ( struct acpi_nfit_desc * acpi_desc , struct nd_cmd_ars_status * ars_status ) { struct nvdimm_bus * nvdimm_bus = acpi_desc -> nvdimm_bus ; int rc ; u32 i ; for ( i = 0 ; i < ars_status -> num_records ; i ++ ) { if ( ars_status -> out_length < 44 + sizeof ( nd_ars_record ) * ( i + 1 ) ) { break ; } rc = nvdimm_bus_add_poison ( nvdimm_bus , ars_status -> records [ i ] . err_address , ars_status -> records [ i ] . length ) ; if ( rc ) { return rc ; } } if ( i < ars_status -> num_records ) { dev_warn ( acpi_desc -> dev , "detected truncated ars results\n" ) ; } return 0 ; } 