size_t pr_regexp_error ( int errcode , const pr_regex_t * pre , char * buf , size_t bufsz ) { size_t res = 0 ; if ( pre == NULL || buf == NULL || bufsz == 0 ) { return 0 ; } if ( pre -> pcre2_errstr != NULL ) { sstrncpy ( buf , ( const char * ) pre -> pcre2_errstr , bufsz ) ; return strlen ( ( const char * ) pre -> pcre2_errstr ) + 1 ; } if ( pre -> pcre_errstr != NULL ) { sstrncpy ( buf , pre -> pcre_errstr , bufsz ) ; return strlen ( pre -> pcre_errstr ) + 1 ; } if ( pre -> re != NULL ) { res = pcre2_regerror ( errcode , pre -> re , buf , bufsz - 1 ) ; res = regerror ( errcode , pre -> re , buf , bufsz - 1 ) ; } return res ; } 