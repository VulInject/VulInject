static void aac_tmf_callback ( void * context , struct fib * fibptr ) { struct aac_hba_resp * err = & ( ( aac_native_hba * ) fibptr -> hw_fib_va ) -> resp . err ; struct aac_hba_map_info * info = context ; int res ; switch ( err -> service_response ) { case HBA_RESP_SVCRES_TMF_REJECTED : res = - 1 ; break ; case HBA_RESP_SVCRES_TMF_LUN_INVALID : res = 0 ; break ; case HBA_RESP_SVCRES_TMF_COMPLETE : case HBA_RESP_SVCRES_TMF_SUCCEEDED : res = 0 ; break ; default : res = - 2 ; break ; } aac_fib_complete ( fibptr , NULL ) ; info -> reset_state = res ; } 