static void audit_log_uring ( struct audit_context * ctx ) { struct audit_buffer * ab ; const struct cred * cred ; ab = audit_log_start ( ctx , GFP_ATOMIC , AUDIT_URINGOP ) ; cred = current_cred ( ) ; audit_log_format ( ab , "uring_op=%d" , ctx -> uring_op ) ; if ( ctx -> return_valid != AUDITSC_INVALID ) { audit_log_format ( ab , " success=%s exit=%ld" , ( ctx -> return_valid == AUDITSC_SUCCESS ?"yes" : "no" ) , ctx -> return_code ) ; } audit_log_format ( ab , " items=%d" " ppid=%d pid=%d uid=%u gid=%u euid=%u suid=%u" " fsuid=%u egid=%u sgid=%u fsgid=%u" , ctx -> name_count , task_ppid_nr ( current ) , task_tgid_nr ( current ) , from_kuid ( & init_user_ns , cred -> uid ) , from_kgid ( & init_user_ns , cred -> gid ) , from_kuid ( & init_user_ns , cred -> euid ) , from_kuid ( & init_user_ns , cred -> suid ) , from_kuid ( & init_user_ns , cred -> fsuid ) , from_kgid ( & init_user_ns , cred -> egid ) , from_kgid ( & init_user_ns , cred -> sgid ) , from_kgid ( & init_user_ns , cred -> fsgid ) ) ; audit_log_task_context ( ab ) ; audit_log_key ( ab , ctx -> filterkey ) ; audit_log_end ( ab ) ; } 