static void no_matching_pwent ( void * * state ) { uid_t uid ; gid_t gid ; pcmk__mock_getpwnam_r = true ; expect_string ( __wrap_getpwnam_r , name , "hacluster" ) ; expect_any ( __wrap_getpwnam_r , pwd ) ; expect_any ( __wrap_getpwnam_r , buf ) ; expect_value ( __wrap_getpwnam_r , buflen , PCMK__PW_BUFFER_LEN ) ; expect_any ( __wrap_getpwnam_r , result ) ; will_return ( __wrap_getpwnam_r , ENOENT ) ; will_return ( __wrap_getpwnam_r ) ; assert_int_equal ( pcmk_daemon_user ( & uid , & gid ) , - ENOENT ) ; pcmk__mock_getpwnam_r = false ; } 