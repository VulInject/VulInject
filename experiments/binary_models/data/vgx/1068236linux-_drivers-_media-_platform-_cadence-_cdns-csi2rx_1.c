static int csi2rx_s_stream ( struct v4l2_subdev * subdev , int enable ) { struct csi2rx_priv * csi2rx = v4l2_subdev_to_csi2rx ( subdev ) ; int ret = 0 ; mutex_lock ( & csi2rx -> lock ) ; if ( enable ) { if ( ! csi2rx -> count ) { ret = csi2rx_start ( csi2rx , NULL ) ; if ( ret ) { out } } csi2rx -> count ++ ; } else { csi2rx -> count -- ; if ( ! csi2rx -> count ) { csi2rx_stop ( csi2rx ) ; } } out mutex_unlock ( & csi2rx -> lock ) ; return ret ; } static const struct v4l2_subdev_video_ops csi2rx_video_ops = { . s_stream = csi2rx_s_stream } ; 