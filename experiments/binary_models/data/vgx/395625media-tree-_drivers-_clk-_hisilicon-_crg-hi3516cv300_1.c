static int hi3516cv300_crg_probe ( struct platform_device * pdev ) { struct hisi_crg_dev * crg ; crg = devm_kmalloc ( & pdev -> dev , sizeof ( * crg ) , GFP_KERNEL ) ; if ( ! crg ) { return - ENOMEM ; } crg -> funcs = of_device_get_match_data ( & pdev -> dev ) ; if ( ! crg -> funcs ) { return - ENOENT ; } crg -> rstc = hisi_reset_init ( pdev ) ; crg -> clk_data = crg -> funcs -> register_clks ( pdev ) ; if ( IS_ERR ( crg -> clk_data ) ) { hisi_reset_exit ( crg -> rstc ) ; return PTR_ERR ( crg -> clk_data ) ; } platform_set_drvdata ( pdev , crg ) ; return 0 ; } 