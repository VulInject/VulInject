struct kfd_dev * kgd2kfd_probe ( struct kgd_dev * kgd , struct pci_dev * pdev , const struct kfd2kgd_calls * f2g ) { struct kfd_dev * kfd ; const struct kfd_device_info * device_info = lookup_device_info ( pdev -> device ) ; if ( ! device_info ) { return NULL ; } kfd = kmalloc ( sizeof ( * kfd ) , GFP_KERNEL ) ; if ( ! kfd ) { return NULL ; } kfd -> kgd = kgd ; kfd -> device_info = device_info ; kfd -> pdev = pdev ; kfd -> init_complete = false ; kfd -> kfd2kgd = f2g ; mutex_init ( & kfd -> doorbell_mutex ) ; memset ( & kfd -> doorbell_available_index , 0 , sizeof ( kfd -> doorbell_available_index ) ) ; return kfd ; } 