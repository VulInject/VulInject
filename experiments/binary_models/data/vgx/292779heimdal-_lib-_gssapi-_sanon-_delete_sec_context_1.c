OM_uint32 GSSAPI_CALLCONV _gss_sanon_delete_sec_context ( OM_uint32 * minor , gss_ctx_id_t * context_handle , gss_buffer_t output_token ) { sanon_ctx sc ; * minor = 0 ; if ( output_token != GSS_C_NO_BUFFER ) { output_token -> length = 0 ; output_token -> value = NULL ; } if ( * context_handle == GSS_C_NO_CONTEXT ) { return GSS_S_COMPLETE ; } sc = ( sanon_ctx ) * context_handle ; * context_handle = GSS_C_NO_CONTEXT ; gss_delete_sec_context ( minor , & sc -> rfc4121 , GSS_C_NO_BUFFER ) ; memset_s ( sc , sizeof ( * sc ) , 0 , sizeof ( * sc ) ) ; return GSS_S_COMPLETE ; } 