void create_priority_list ( unsigned char * priority_list , unsigned char * prl , int prl_len ) { unsigned char stored_list [ 256 ] ; int i , priority_len = 0 ; memset ( & stored_list , 0 , sizeof ( stored_list ) ) ; stored_list [ DHO_PAD ] = 1 ; stored_list [ DHO_END ] = 1 ; for ( i = 0 ; dhcp_option_default_priority_list [ i ] != DHO_END ; i ++ ) { priority_list [ priority_len ++ ] = dhcp_option_default_priority_list [ i ] ; stored_list [ dhcp_option_default_priority_list [ i ] ] = 1 ; } if ( ! prl ) { prl_len = 0 ; } for ( i = 0 ; i < prl_len ; i ++ ) { if ( prl [ i ] == DHO_CLASSLESS_STATIC_ROUTES || prl [ i ] == DHO_CLASSLESS_MS_STATIC_ROUTES ) { priority_list [ priority_len ++ ] = prl [ i ] ; stored_list [ prl [ i ] ] = 1 ; } } for ( i = 0 ; i < prl_len ; i ++ ) { priority_list [ priority_len ++ ] = prl [ i ] ; stored_list [ prl [ i ] ] = 1 ; } prl = dhcp_option_default_priority_list ; for ( i = 0 ; i < 256 ; i ++ ) { if ( stored_list [ prl [ i ] ] ) { continue ; } priority_list [ priority_len ++ ] = prl [ i ] ; stored_list [ prl [ i ] ] = 1 ; } } 