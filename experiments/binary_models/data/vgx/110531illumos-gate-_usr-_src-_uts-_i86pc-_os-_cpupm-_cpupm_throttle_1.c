void cpupm_throttle_manage_notification ( void * ctx ) { cpu_t * cp = ctx ; processorid_t cpu_id = cp -> cpu_id ; cpupm_mach_state_t * mach_state = ( cpupm_mach_state_t * ) cp -> cpu_m . mcpu_pm_mach_state ; boolean_t is_ready ; int new_level ; is_ready = ( cp -> cpu_flags & CPU_READY ) && cpupm_throttle_ready ( cp ) ; if ( ! is_ready ) { return ; } if ( ! ( mach_state -> ms_caps & CPUPM_T_STATES ) ) { return ; } ASSERT ( mach_state -> ms_tstate . cma_ops != NULL ) ; new_level = cpupm_throttle_get_max ( cpu_id ) ; cpupm_state_change ( cp , new_level , CPUPM_T_STATES ) ; } 