void send_pce_path_request_message ( pcep_session * session ) void send_pce_report_message ( pcep_session * session ) void print_queue_event ( struct pcep_event * event ) void pcep_event_callback ( void * cb_data , pcep_event * e ) struct cmd_line_args * get_cmdline_args ( int argc , char * argv [ ] ) { struct cmd_line_args * cmd_line_args = malloc ( sizeof ( cmd_line_args ) ) ; memset ( cmd_line_args , 0 , sizeof ( cmd_line_args ) ) ; strlcpy ( cmd_line_args -> dest_ip_str , DEFAULT_DEST_HOSTNAME , MAX_DST_IP_STR ) ; cmd_line_args -> src_tcp_port = DEFAULT_SRC_TCP_PORT ; cmd_line_args -> is_ipv6 = false ; int i = 1 ; for ( ; i < argc ; ++ i ) { if ( strcmp ( argv [ i ] , "-help" ) == 0 || strcmp ( argv [ i ] , "--help" ) == 0 || strcmp ( argv [ i ] , "-h" ) == 0 ) { pcep_log ( LOG_INFO , "%s: pcep_pcc [-ipv6] [-srcip localhost][-destip 192.168.0.1] [-srcport 4999][-dstport 4189] [-tcpmd5 authstr][-eventpoll]" , __func__ ) ; return NULL ; } if ( strcmp ( argv [ i ] , "-ipv6" ) == 0 ) { cmd_line_args -> is_ipv6 = true ; if ( argc == 2 ) { strlcpy ( cmd_line_args -> dest_ip_str , DEFAULT_DEST_HOSTNAME_IPV6 , MAX_DST_IP_STR ) ; } } if ( strcmp ( argv [ i ] , "-eventpoll" ) == 0 ) { cmd_line_args -> eventpoll = true ; } if ( strcmp ( argv [ i ] , "-srcip" ) == 0 ) { if ( argc >= i + 2 ) { strlcpy ( cmd_line_args -> src_ip_str , argv [ ++ i ] , MAX_SRC_IP_STR ) ; } else { pcep_log ( LOG_ERR , "%s: Invalid number of cmd_line_args for \"-srcip\"" , __func__ ) ; free ( cmd_line_args ) ; return NULL ; } } if ( strcmp ( argv [ i ] , "-destip" ) == 0 ) { if ( argc >= i + 2 ) { strlcpy ( cmd_line_args -> dest_ip_str , argv [ ++ i ] , MAX_DST_IP_STR ) ; } else { pcep_log ( LOG_ERR , "%s: Invalid number of cmd_line_args for \"-destip\"" , __func__ ) ; free ( cmd_line_args ) ; return NULL ; } } if ( strcmp ( argv [ i ] , "-srcport" ) == 0 ) { if ( argc >= i + 2 ) { cmd_line_args -> src_tcp_port = atoi ( argv [ ++ i ] ) ; } else { pcep_log ( LOG_ERR , "%s: Invalid number of cmd_line_args for \"-srcport\"" , __func__ ) ; free ( cmd_line_args ) ; return NULL ; } } if ( strcmp ( argv [ i ] , "-destport" ) == 0 ) { if ( argc >= i + 2 ) { cmd_line_args -> dest_tcp_port = atoi ( argv [ ++ i ] ) ; } else { pcep_log ( LOG_ERR , "%s: Invalid number of cmd_line_args for \"-destport\"" , __func__ ) ; free ( cmd_line_args ) ; return NULL ; } } if ( strcmp ( argv [ i ] , "-tcpmd5" ) == 0 ) { if ( argc >= i + 2 ) { strlcpy ( cmd_line_args -> tcp_md5_str , argv [ ++ i ] , sizeof ( cmd_line_args -> tcp_md5_str ) ) ; } else { pcep_log ( LOG_ERR , "%s: Invalid number of cmd_line_args for \"-tcpmd5\"" , __func__ ) ; free ( cmd_line_args ) ; return NULL ; } } else { pcep_log ( LOG_ERR , "%s: Invalid cmd_line_arg[%d] = %s" , __func__ , i , argv [ i ] ) ; free ( cmd_line_args ) ; return NULL ; } } return cmd_line_args ; } 