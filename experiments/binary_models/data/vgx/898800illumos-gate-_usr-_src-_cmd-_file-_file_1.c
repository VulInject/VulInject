static int english ( char * bp , int n ) { register int j , vow , freq , rare , len ; register int badpun = 0 , punct = 0 ; int ct [ NASC ] ; if ( n < 50 ) { return ( 0 ) ; } for ( j = 0 ; j < NASC ; j ++ ) { ct [ j ] = 0 ; } for ( j = 0 ; j < n ; j += len ) { if ( ( unsigned char ) bp [ j ] < NASC ) { ct [ bp [ j ] | 040 ] ++ ; } switch ( bp [ j ] ) { case '.' : case ',' : case ')' : case '%' : case ';' : case ':' : case '?' : punct ++ ; if ( j < n - 1 && bp [ j + 1 ] != ' ' && bp [ j + 1 ] != '\n' ) { badpun ++ ; } } if ( ( len = mblen ( & bp [ j ] , MB_CUR_MAX ) ) <= 0 ) { len = 1 ; } } vow = ct [ 'a' ] + ct [ 'e' ] + ct [ 'i' ] + ct [ 'o' ] + ct [ 'u' ] ; freq = ct [ 'e' ] + ct [ 't' ] + ct [ 'a' ] + ct [ 'i' ] + ct [ 'o' ] + ct [ 'n' ] ; rare = ct [ 'v' ] + ct [ 'j' ] + ct [ 'k' ] + ct [ 'q' ] + ct [ 'x' ] + ct [ 'z' ] ; if ( 2 * ct [ ';' ] > ct [ 'e' ] ) { return ( 0 ) ; } if ( ( ct [ '>' ] + ct [ '<' ] + ct [ '/' ] ) > ct [ 'e' ] ) { return ( 0 ) ; } return ( vow * 5 >= n - ct [ ' ' ] && freq >= 10 * rare ) ; } 