static int prepare_uptodate_page ( struct inode * inode , struct page * page , u64 pos , bool force_uptodate ) { struct folio * folio = page_folio ( page ) ; int ret = 0 ; if ( ( ( pos & ( PAGE_SIZE - 1 ) ) || force_uptodate ) && ! PageUptodate ( page ) ) { ret = btrfs_read_folio ( NULL , folio ) ; if ( ret ) { return ret ; } lock_page ( page , NULL ) ; if ( ! PageUptodate ( page ) ) { unlock_page ( page ) ; return - EIO ; } if ( page -> mapping != inode -> i_mapping || ! PagePrivate ( page ) ) { unlock_page ( page ) ; return - EAGAIN ; } } return 0 ; } 