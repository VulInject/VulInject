static int ums_write_sector ( struct ums * ums_dev , ulong start , lbaint_t blkcnt , const void * buf ) { struct blk_desc * block_dev = & ums_dev -> block_dev ; lbaint_t blkstart = start + ums_dev -> start_sector ; return blk_dwrite ( block_dev , blkstart , blkcnt , buf ) ; } static struct ums * ums ; static int ums_count ; static void ums_fini ( void ) { int i ; for ( i = 0 ; i < ums_count ; i ++ ) { free ( ( void * ) ums [ i ] . name ) ; } ums = NULL ; ums_count = 0 ; } 