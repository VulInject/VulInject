ret_code_t nfc_t4t_cc_file_parse ( nfc_t4t_capability_container_t * p_t4t_cc_file , uint8_t * p_raw_data , uint16_t len ) { ret_code_t err_code = nfc_t4t_cc_args_validate ( p_t4t_cc_file , p_raw_data , len ) ; VERIFY_SUCCESS ( err_code , NULL ) ; uint8_t * p_offset = p_raw_data ; nfc_t4t_cc_file_clear ( p_t4t_cc_file ) ; p_t4t_cc_file -> len = uint16_big_decode ( p_offset ) ; p_offset += CC_LEN_FIELD_SIZE ; p_t4t_cc_file -> major_version = MSN_GET ( * p_offset ) ; p_t4t_cc_file -> minor_version = LSN_GET ( * p_offset ) ; p_offset += MAP_VER_FIELD_SIZE ; p_t4t_cc_file -> max_rapdu_size = uint16_big_decode ( p_offset ) ; p_offset += MLE_FIELD_SIZE ; p_t4t_cc_file -> max_capdu_size = uint16_big_decode ( p_offset ) ; p_offset += MLC_FIELD_SIZE ; nfc_t4t_tlv_block_t new_block ; len -= ( p_offset - p_raw_data ) ; while ( len > 0 ) { uint16_t tlv_len = len ; err_code = nfc_t4t_file_control_tlv_parse ( & new_block , p_offset , & tlv_len ) ; VERIFY_SUCCESS ( err_code ) ; p_offset += tlv_len ; len -= tlv_len ; err_code = nfc_t4t_tlv_block_insert ( p_t4t_cc_file , & new_block ) ; VERIFY_SUCCESS ( err_code ) ; } return nfc_t4t_cc_file_validate ( p_t4t_cc_file ) ; } 