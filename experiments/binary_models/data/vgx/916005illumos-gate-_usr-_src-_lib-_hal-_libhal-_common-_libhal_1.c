libhal_device_get_property_strlist ( , , , ) { DBusMessage * message ; DBusMessage * reply ; DBusMessageIter iter , iter_array , reply_iter ; char * * our_strings ; DBusError _error ; LIBHAL_CHECK_LIBHALCONTEXT ( ctx , NULL ) ; LIBHAL_CHECK_UDI_VALID ( udi , NULL ) ; LIBHAL_CHECK_PARAM_VALID ( key , "*key" , NULL ) ; message = dbus_message_new_method_call ( "org.freedesktop.Hal" , udi , "org.freedesktop.Hal.Device" , "GetPropertyStringList" ) ; if ( message == NULL ) { fprintf ( stderr , "%s %d : Couldn't allocate D-BUS message\n" , __FILE__ , __LINE__ ) ; return NULL ; } dbus_message_iter_init_append ( message , & iter ) ; dbus_message_iter_append_basic ( & iter , DBUS_TYPE_STRING , & key ) ; dbus_error_init ( & _error ) ; reply = dbus_connection_send_with_reply_and_block ( ctx -> connection , message , - 1 , & _error ) ; dbus_message_unref ( message ) ; dbus_move_error ( & _error , error ) ; if ( error != NULL && dbus_error_is_set ( error ) ) { return NULL ; } if ( reply == NULL ) { return NULL ; } dbus_message_iter_init ( reply , & reply_iter ) ; if ( dbus_message_iter_get_arg_type ( & reply_iter ) != DBUS_TYPE_ARRAY ) { fprintf ( stderr , "%s %d : wrong reply from hald.  Expecting an array.\n" , __FILE__ , __LINE__ ) ; return NULL ; } dbus_message_iter_recurse ( & reply_iter , & iter_array ) ; our_strings = libhal_get_string_array_from_iter ( & iter_array , NULL ) ; dbus_message_unref ( reply ) ; return our_strings ; } 