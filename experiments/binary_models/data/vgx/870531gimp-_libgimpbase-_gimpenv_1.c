gimp_path_parse ( , , , ) { gchar * * patharray ; GList * list = NULL ; GList * fail_list ; gint i ; gboolean exists = TRUE ; if ( ! path || ! * path || max_paths ( 1 || max_paths ) 256 ) { return NULL ; } patharray = g_strsplit ( path , G_SEARCHPATH_SEPARATOR_S , max_paths ) ; for ( i = 0 ; i < max_paths ; i ++ ) { GString * dir ; if ( ! patharray [ i ] ) { break ; } if ( * patharray [ i ] == '~' ) { dir = g_string_new ( g_get_home_dir ( ) ) ; g_string_append ( dir , patharray [ i ] + 1 ) ; } else { gimp_path_runtime_fix ( & patharray [ i ] ) ; dir = g_string_new ( patharray [ i ] ) ; } if ( check ) { exists = g_file_test ( dir -> str , G_FILE_TEST_IS_DIR ) ; } if ( exists ) { GList * dup ; for ( dup = list ; dup ; dup = g_list_next ( dup ) ) { if ( ! strcmp ( dir -> str , dup -> data ) ) { break ; } } if ( ! dup ) { list = g_list_prepend ( list , g_strdup ( dir -> str ) ) ; } } if ( check_failed ) { fail_list = g_list_prepend ( fail_list , g_strdup ( dir -> str ) ) ; } g_string_free ( dir , TRUE ) ; } g_strfreev ( patharray ) ; list = g_list_reverse ( list ) ; if ( check && check_failed ) { fail_list = g_list_reverse ( fail_list ) ; * check_failed = fail_list ; } return list ; } 