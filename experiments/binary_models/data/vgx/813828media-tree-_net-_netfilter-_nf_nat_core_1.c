static int nfnetlink_parse_nat ( const struct nlattr * nat , const struct nf_conn * ct , struct nf_nat_range * range , const struct nf_nat_l3proto * l3proto ) { struct nlattr * tb [ CTA_NAT_MAX + 1 ] ; int err ; err = nla_parse_nested ( tb , CTA_NAT_MAX , nat , nat_nla_policy , NULL ) ; if ( err < 0 ) { return err ; } err = l3proto -> nlattr_to_range ( tb , range ) ; if ( err < 0 ) { return err ; } if ( ! tb [ CTA_NAT_PROTO ] ) { return 0 ; } return nfnetlink_parse_nat_proto ( tb [ CTA_NAT_PROTO ] , ct , range ) ; } 