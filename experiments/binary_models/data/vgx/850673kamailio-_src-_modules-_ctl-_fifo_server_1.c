struct text_chunk * new_chunk_escape ( str * src , int escape_all ) { struct text_chunk * l ; l = ctl_malloc ( sizeof ( text_chunk ) ) ; if ( ! l ) { ERR ( "No Memory Left\n" ) ; return 0 ; } l -> s . s = ctl_malloc ( src -> len * 2 + 1 ) ; if ( ! l -> s . s ) { ERR ( "No Memory Left\n" ) ; ctl_free ( l ) ; return 0 ; } l -> next = 0 ; l -> flags = 0 ; escape ( & l -> s , src -> s , src -> len , escape_all ) ; l -> s . s [ l -> s . len ] = '\0' ; return l ; } 