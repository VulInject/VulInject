static void dump_tx_ring ( struct net_device * dev ) { if ( vortex_debug > 0 ) { struct vortex_private * vp = netdev_priv ( dev ) ; void __iomem * ioaddr = vp -> ioaddr ; if ( vp -> full_bus_master_tx ) { int i ; int stalled = ioread32 ( ioaddr + PktStatus ) & 0x04 ; pr_err ( "  Flags; bus-master %d, dirty %d(%d) current %d(%d)\n" , vp -> full_bus_master_tx , vp -> dirty_tx , vp -> dirty_tx % TX_RING_SIZE , vp -> cur_tx , vp -> cur_tx % TX_RING_SIZE ) ; pr_err ( "  Transmit list %8.8x vs. %p.\n" , ioread32 ( ioaddr + DownListPtr ) , & vp -> tx_ring [ vp -> dirty_tx % TX_RING_SIZE ] ) ; issue_and_wait ( dev , DownStall ) ; for ( i = 0 ; i < TX_RING_SIZE ; i ++ ) { unsigned int length ; length = le32_to_cpu ( vp -> tx_ring [ i ] . frag [ 0 ] . length ) ; length = le32_to_cpu ( vp -> tx_ring [ i ] . length ) ; pr_err ( "  %d: @%p  length %8.8x status %8.8x\n" , i , & vp -> tx_ring [ i ] , length , le32_to_cpu ( vp -> tx_ring [ i ] . status ) ) ; } if ( ! stalled ) { iowrite16 ( DownUnstall , ioaddr + EL3_CMD ) ; } } } } 