void EC_FreeCurveParams ( ECCurveParams * params ) { if ( params -> text != NULL ) { kmem_free ( params -> text , strlen ( params -> text ) + 1 ) ; } free ( params -> text ) ; if ( params -> irr != NULL ) { kmem_free ( params -> irr , strlen ( params -> irr ) + 1 ) ; } free ( params -> irr ) ; if ( params -> curvea != NULL ) { kmem_free ( params -> curvea , strlen ( params -> curvea ) + 1 ) ; } free ( params -> curvea ) ; if ( params -> curveb != NULL ) { kmem_free ( params -> curveb , strlen ( params -> curveb ) + 1 ) ; } free ( params -> curveb ) ; if ( params -> genx != NULL ) { kmem_free ( params -> genx , strlen ( params -> genx ) + 1 ) ; } free ( params -> genx ) ; if ( params -> geny != NULL ) { kmem_free ( params -> geny , strlen ( params -> geny ) + 1 ) ; } free ( params -> geny ) ; if ( params -> order != NULL ) { kmem_free ( params -> order , strlen ( params -> order ) + 1 ) ; } free ( params -> order ) ; kmem_free ( params , sizeof ( ECCurveParams ) ) ; free ( params ) ; } 