void efi_try_purge_kaslr_seed ( void * fdt ) { const efi_guid_t efi_guid_rng_protocol = EFI_RNG_PROTOCOL_GUID ; struct efi_handler * handler ; efi_status_t ret ; int nodeoff = 0 ; int err = 0 ; ret = efi_search_protocol ( efi_root , & efi_guid_rng_protocol , & handler ) ; if ( ret != EFI_SUCCESS ) { return ; } nodeoff = fdt_path_offset ( fdt , "/chosen" ) ; err = fdt_delprop ( fdt , nodeoff , "kaslr-seed" ) ; if ( err < 0 && err != - FDT_ERR_NOTFOUND ) { log_err ( "Error deleting kaslr-seed\n" ) ; } } 