if ( ! spf_server && ! spf_init ( ) ) { return FALSE ; } if ( SPF_server_set_rec_dom ( , ) ) { DEBUG ( ) debug_printf ( "spf: SPF_server_set_rec_dom(\"%s\") failed.\n" , primary_hostname ) ; spf_server = NULL ; return FALSE ; } spf_request = SPF_request_new ( spf_server ) ; if ( SPF_request_set_ipv4_str ( , ) && SPF_request_set_ipv6_str ( , ) ) { DEBUG ( ) debug_printf ( "spf: SPF_request_set_ipv4_str() and " "SPF_request_set_ipv6_str() failed [%s]\n" , spf_remote_addr ) ; spf_server = NULL ; return FALSE ; } if ( SPF_request_set_helo_dom ( , ) ) { DEBUG ( ) debug_printf ( "spf: SPF_set_helo_dom(\"%s\") failed.\n" , spf_helo_domain ) ; spf_server = NULL ; spf_request = NULL ; return FALSE ; } return TRUE ; 