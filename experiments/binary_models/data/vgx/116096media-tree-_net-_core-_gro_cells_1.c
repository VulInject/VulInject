int gro_cells_init ( struct gro_cells * gcells , struct net_device * dev ) { int i ; gcells -> cells = alloc_percpu ( gro_cell ) ; for_each_possible_cpu ( ) { struct gro_cell * cell = per_cpu_ptr ( gcells -> cells , i ) ; __skb_queue_head_init ( & cell -> napi_skbs ) ; set_bit ( NAPI_STATE_NO_BUSY_POLL , & cell -> napi . state ) ; netif_napi_add ( dev , & cell -> napi , gro_cell_poll , NAPI_POLL_WEIGHT ) ; napi_enable ( & cell -> napi ) ; } return 0 ; } 