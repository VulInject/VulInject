struct mlx5e_macsec_fs * mlx5e_macsec_fs_init ( struct mlx5_core_dev * mdev , struct net_device * netdev ) { struct mlx5e_macsec_fs * macsec_fs ; int err ; macsec_fs = kzalloc ( sizeof ( * macsec_fs ) , GFP_KERNEL ) ; if ( ! macsec_fs ) { return NULL ; } macsec_fs -> mdev = mdev ; macsec_fs -> netdev = netdev ; err = macsec_fs_tx_init ( macsec_fs ) ; if ( err ) { netdev_err ( netdev , "MACsec offload: Failed to init tx_fs, err=%d\n" , err ) ; err } err = macsec_fs_rx_init ( macsec_fs ) ; if ( err ) { netdev_err ( netdev , "MACsec offload: Failed to init tx_fs, err=%d\n" , err ) ; tx_cleanup } return macsec_fs ; tx_cleanup macsec_fs_tx_cleanup ( macsec_fs ) ; err return NULL ; } 