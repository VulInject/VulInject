static int s5h1420_tuner_set_params ( struct dvb_frontend * fe ) { struct dtv_frontend_properties * c = & fe -> dtv_property_cache ; struct budget * budget = ( budget * ) fe -> dvb -> priv ; u32 div ; u8 data [ 4 ] ; struct i2c_msg msg = { . addr = 0x61 . flags = 0 . buf = data . len = ( data ) } ; div = c -> frequency / 1000 ; data [ 0 ] = ( div >> 8 ) & 0x7f ; data [ 1 ] = div & 0xff ; data [ 2 ] = 0xc2 ; if ( div < 1450 ) { data [ 3 ] = 0x00 ; } if ( div < 1850 ) { data [ 3 ] = 0x40 ; } if ( div < 2000 ) { data [ 3 ] = 0x80 ; } else { data [ 3 ] = 0xc0 ; } if ( fe -> ops . i2c_gate_ctrl ) { fe -> ops . i2c_gate_ctrl ( fe , 1 ) ; } return 0 ; } 