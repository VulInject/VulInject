static loff_t iomap_readahead_iter ( const struct iomap_iter * iter , struct iomap_readpage_ctx * ctx ) { loff_t length = iomap_length ( iter ) ; loff_t done , ret ; for ( done = 0 ; done < length ; done += ret ) { if ( ctx -> cur_folio && offset_in_folio ( ctx -> cur_folio , iter -> pos + done ) == 0 ) { if ( ! ctx -> cur_folio_in_bio ) { folio_unlock ( ctx -> cur_folio ) ; } } if ( ! ctx -> cur_folio ) { ctx -> cur_folio = readahead_folio ( ctx -> rac ) ; ctx -> cur_folio_in_bio = false ; } ret = iomap_readpage_iter ( iter , ctx , done ) ; if ( ret <= 0 ) { return ret ; } } return done ; } 