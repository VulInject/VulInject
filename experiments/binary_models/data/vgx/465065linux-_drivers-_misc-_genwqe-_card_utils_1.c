int FUN1 ( struct VAR1 * VAR2 , struct VAR3 * VAR4 , void * VAR5 , unsigned long VAR6 ) { int VAR7 = - VAR8 ; unsigned long VAR9 , VAR10 ; struct VAR11 * VAR11 = VAR2 -> VAR11 ; if ( ( VAR5 == NULL ) || ( VAR6 == 0 ) ) { VAR4 -> VAR6 = 0 ; return - VAR8 ; } VAR4 -> VAR12 = VAR5 ; VAR4 -> VAR6 = VAR6 ; VAR9 = ( unsigned long ) VAR5 ; VAR10 = FUN2 ( VAR9 ) ; if ( VAR6 > VAR13 - VAR14 - VAR10 ) { VAR4 -> VAR6 = 0 ; return - VAR8 ; } VAR4 -> VAR15 = FUN3 ( VAR10 + VAR6 , VAR14 ) ; VAR4 -> VAR16 = FUN4 ( VAR4 -> VAR15 , sizeof ( VAR17 * ) + sizeof ( VAR18 ) , VAR19 ) ; if ( ! VAR4 -> VAR16 ) { FUN5 ( & VAR11 -> VAR20 , "" ) ; VAR4 -> VAR15 = 0 ; VAR4 -> VAR12 = NULL ; VAR4 -> VAR6 = 0 ; return - VAR21 ; } VAR4 -> VAR22 = ( VAR18 * ) ( VAR4 -> VAR16 + VAR4 -> VAR15 ) ; VAR7 = FUN6 ( VAR9 & VAR23 , VAR4 -> VAR15 , VAR4 -> write ?VAR24 : 0 , VAR4 -> VAR16 ) ; if ( VAR7 < 0 ) { VAR25 } if ( VAR7 < VAR4 -> VAR15 ) { FUN7 ( VAR4 -> VAR16 , VAR7 , VAR4 -> write ) ; VAR7 = - VAR26 ; VAR25 } VAR7 = FUN8 ( VAR2 , VAR4 -> VAR16 , VAR4 -> VAR15 , VAR4 -> VAR22 ) ; if ( VAR7 != 0 ) { VAR27 } return 0 ; fail_free_user_pages FUN7 ( VAR4 -> VAR16 , VAR4 -> VAR15 , VAR4 -> write ) ; fail_pin_user_pages VAR4 -> VAR16 = NULL ; VAR4 -> VAR22 = NULL ; VAR4 -> VAR15 = 0 ; VAR4 -> VAR12 = NULL ; VAR4 -> VAR6 = 0 ; return VAR7 ; }