int pelican_process ( pelican_state * pelmac , const unsigned char * in , unsigned long inlen ) { LTC_ARGCHK ( in != NULL ) ; if ( pelmac -> buflen ( 0 || pelmac -> buflen ) 15 ) { return CRYPT_INVALID_ARG ; } if ( pelmac -> buflen == 0 ) { while ( inlen & ~ 15 ) { int x ; for ( x = 0 ; x < 16 ; x += sizeof ( LTC_FAST_TYPE ) ) { * ( LTC_FAST_TYPE_PTR_CAST ( ( unsigned char * ) pelmac -> state + x ) ) ^= * ( LTC_FAST_TYPE_PTR_CAST ( ( unsigned char * ) in + x ) ) ; } s_four_rounds ( pelmac ) ; in += 16 ; inlen -= 16 ; } } while ( inlen -- ) { pelmac -> state [ pelmac -> buflen ++ ] ^= * in ++ ; if ( pelmac -> buflen == 16 ) { s_four_rounds ( pelmac ) ; pelmac -> buflen = 0 ; } } return CRYPT_OK ; } 