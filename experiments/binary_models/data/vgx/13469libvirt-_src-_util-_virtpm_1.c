char * virTPMCreateCancelPath ( const char * devpath ) { const char * dev ; const char * prefix [ ] { "misc/" "tpm/" } ; ; size_t i ; if ( ! devpath ) { virReportError ( VIR_ERR_INTERNAL_ERROR , "%s" , _ ( "Missing TPM device path" ) ) ; return NULL ; } if ( ! ( dev = strrchr ( devpath , '/' ) ) ) { virReportError ( VIR_ERR_INTERNAL_ERROR , _ ( "TPM device path %s is invalid" ) , devpath ) ; return NULL ; } dev ++ ; for ( i = 0 ; i < G_N_ELEMENTS ( prefix ) ; i ++ ) { g_autofree char * path = g_strdup_printf ( "/sys/class/%s%s/device/cancel" , prefix [ i ] , dev ) ; } return g_strdup ( "/dev/null" ) ; } 