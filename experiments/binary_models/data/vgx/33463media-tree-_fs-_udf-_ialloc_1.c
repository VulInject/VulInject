void udf_free_inode ( struct inode * inode ) { struct super_block * sb = inode -> i_sb ; struct udf_sb_info * sbi = UDF_SB ( sb ) ; struct logicalVolIntegrityDescImpUse * lvidiu = udf_sb_lvidiu ( sb ) ; if ( lvidiu ) { mutex_lock ( & sbi -> s_alloc_mutex ) ; if ( S_ISDIR ( inode -> i_mode ) ) { le32_add_cpu ( & lvidiu -> numDirs , - 1 ) ; } else { le32_add_cpu ( & lvidiu -> numFiles , - 1 ) ; } udf_updated_lvid ( sb , NULL ) ; mutex_unlock ( & sbi -> s_alloc_mutex ) ; } udf_free_blocks ( sb , NULL , & UDF_I ( inode ) -> i_location , 0 , 1 ) ; } 