db_recno_t __bam_total ( h ) PAGE * h ; { db_recno_t nrecs ; db_indx_t indx , top ; nrecs = 0 ; top = NUM_ENT ( h ) ; switch ( TYPE ( h ) ) { case P_LBTREE : for ( indx = 0 ; indx < top ; indx += P_INDX ) { if ( ! B_DISSET ( GET_BKEYDATA ( h , indx + O_INDX ) -> type ) ) { ++ nrecs ; } } break ; case P_IBTREE : for ( indx = 0 ; indx < top ; indx += O_INDX ) { nrecs += GET_BINTERNAL ( h , indx ) -> nrecs ; } break ; case P_LRECNO : nrecs = NUM_ENT ( h , NULL ) ; break ; case P_IRECNO : for ( indx = 0 ; indx < top ; indx += O_INDX ) { nrecs += GET_RINTERNAL ( h , indx ) -> nrecs ; } break ; } return ( nrecs ) ; } 