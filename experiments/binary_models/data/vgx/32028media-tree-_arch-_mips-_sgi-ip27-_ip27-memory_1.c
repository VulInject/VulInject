static void __init node_mem_init ( cnodeid_t node ) { unsigned long slot_firstpfn = slot_getbasepfn ( node , 0 ) ; unsigned long slot_freepfn = node_getfirstfree ( node ) ; unsigned long bootmap_size ; unsigned long start_pfn , end_pfn ; get_pfn_range_for_nid ( node , & start_pfn , & end_pfn ) ; __node_data [ node ] = __va ( slot_freepfn << PAGE_SHIFT ) ; NODE_DATA ( node ) -> bdata = & bootmem_node_data [ node ] ; NODE_DATA ( node ) -> node_start_pfn = start_pfn ; NODE_DATA ( node ) -> node_spanned_pages = end_pfn - start_pfn ; cpumask_clear ( & hub_data ( node ) -> h_cpus ) ; slot_freepfn += PFN_UP ( sizeof ( pglist_data ) + sizeof ( hub_data ) ) ; bootmap_size = init_bootmem_node ( NODE_DATA ( node ) , slot_freepfn , start_pfn , end_pfn ) ; free_bootmem_with_active_regions ( node , end_pfn ) ; reserve_bootmem_node ( NODE_DATA ( node ) , slot_firstpfn << PAGE_SHIFT , ( ( slot_freepfn - slot_firstpfn ) << PAGE_SHIFT ) + bootmap_size , BOOTMEM_DEFAULT ) ; sparse_memory_present_with_active_regions ( node ) ; } static struct node_data null_node = { . hub = { . h_cpus = CPU_MASK_NONE } } ; 