static s32 e1000_validate_nvm_checksum_ich8lan ( struct e1000_hw * hw ) { s32 ret_val ; u16 data ; u16 word ; u16 valid_csum_mask ; DEBUGFUNC ( "e1000_validate_nvm_checksum_ich8lan" ) ; switch ( hw -> mac . type ) { case e1000_pch_lpt : case e1000_pch_spt : case e1000_pch_cnp : case e1000_pch_tgp : case e1000_pch_adp : case e1000_pch_mtp : case e1000_pch_lnp : case e1000_pch_rpl : word = NVM_COMPAT ; valid_csum_mask = NVM_COMPAT_VALID_CSUM ; break ; default : word = NVM_FUTURE_INIT_WORD1 ; valid_csum_mask = NVM_FUTURE_INIT_WORD1_VALID_CSUM ; break ; } ret_val = hw -> nvm . ops . read ( hw , word , 1 , & data ) ; if ( ! ( data & valid_csum_mask ) ) { data |= valid_csum_mask ; ret_val = hw -> nvm . ops . write ( hw , word , 1 , & data ) ; if ( ret_val ) { return ret_val ; } ret_val = hw -> nvm . ops . update ( hw ) ; if ( ret_val ) { return ret_val ; } } return e1000_validate_nvm_checksum_generic ( hw ) ; } 