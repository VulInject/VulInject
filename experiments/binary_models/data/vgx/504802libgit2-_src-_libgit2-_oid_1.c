int git_oid__fromstrn ( git_oid * out , const char * str , size_t length , git_oid_t type ) { size_t size , p ; int v ; GIT_ASSERT_ARG ( out ) ; GIT_ASSERT_ARG ( str ) ; if ( ! ( size = git_oid_size ( type ) ) ) { return oid_error_invalid ( "unknown type" ) ; } if ( ! length ) { return oid_error_invalid ( "too short" ) ; } if ( length > git_oid_hexsize ( type ) ) { return oid_error_invalid ( "too long" ) ; } out -> type = type ; for ( p = 0 ; p < length ; p ++ ) { v = git__fromhex ( str [ p ] ) ; if ( v < 0 ) { return oid_error_invalid ( "contains invalid characters" ) ; } out -> id [ p / 2 ] |= ( unsigned char ) ( v << ( p % 2 ?0 : 4 ) ) ; } return 0 ; } 