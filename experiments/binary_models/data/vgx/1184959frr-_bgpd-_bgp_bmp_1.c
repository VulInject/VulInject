static struct bmp_mirrorq * bmp_pull_mirror ( struct bmp * bmp ) { struct bmp_mirrorq * bmq ; bmq = bmp -> mirrorpos ; if ( ! bmq ) { return in ; } bmp -> mirrorpos = bmp_mirrorq_next ( & bmp -> targets -> bmpbgp -> mirrorq , bmq ) ; bmq -> refcount -- ; if ( ! bmq -> refcount ) { bmp -> targets -> bmpbgp -> mirror_qsize -= sizeof ( * bmq ) + bmq -> len ; bmp_mirrorq_del ( & bmp -> targets -> bmpbgp -> mirrorq , bmq ) ; } return bmq ; } 