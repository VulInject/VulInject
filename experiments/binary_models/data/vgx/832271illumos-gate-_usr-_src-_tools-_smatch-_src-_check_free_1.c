static void match_free ( const char * fn , struct expression * expr , void * param ) { struct expression * arg ; arg = get_argument_from_call_expr ( expr -> args , PTR_INT ( param ) ) ; if ( ! arg ) { return ; } if ( is_freed ( arg ) ) { char * name = expr_to_var ( arg ) ; sm_error ( "double free of '%s'" , name ) ; free_string ( name ) ; } set_state_expr ( my_id , arg , & freed ) ; } 