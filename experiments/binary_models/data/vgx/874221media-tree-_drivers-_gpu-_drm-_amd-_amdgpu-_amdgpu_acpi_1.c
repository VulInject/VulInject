static union acpi_object * amdgpu_atcs_call ( acpi_handle handle , int function , struct acpi_buffer * params ) { acpi_status status ; union acpi_object atcs_arg_elements [ 2 ] ; struct acpi_object_list atcs_arg ; struct acpi_buffer buffer = { ACPI_ALLOCATE_BUFFER NULL } ; atcs_arg . count = 2 ; atcs_arg . pointer = & atcs_arg_elements [ 0 ] ; atcs_arg_elements [ 0 ] . type = ACPI_TYPE_INTEGER ; atcs_arg_elements [ 0 ] . integer . value = function ; if ( params ) { atcs_arg_elements [ 1 ] . type = ACPI_TYPE_BUFFER ; atcs_arg_elements [ 1 ] . buffer . length = params -> length ; atcs_arg_elements [ 1 ] . buffer . pointer = params -> pointer ; } else { atcs_arg_elements [ 1 ] . type = ACPI_TYPE_INTEGER ; atcs_arg_elements [ 1 ] . integer . value = 0 ; } status = acpi_evaluate_object ( handle , "ATCS" , & atcs_arg , & buffer ) ; if ( ACPI_FAILURE ( status ) && status != AE_NOT_FOUND ) { DRM_DEBUG_DRIVER ( "failed to evaluate ATCS got %s\n" , acpi_format_exception ( status ) ) ; return NULL ; } return buffer . pointer ; } 