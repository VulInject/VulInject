int posix_spawn_file_actions_addopen ( posix_spawn_file_actions_t * file_actions , int filedes , const char * path , int oflag , mode_t mode ) { file_attr_t * fap ; if ( ( fap = lmalloc ( sizeof ( * fap ) ) ) == NULL ) { return ( ENOMEM ) ; } fap -> fa_pathsize = strlen ( path ) + 1 ; if ( ( fap -> fa_path = lmalloc ( fap -> fa_pathsize ) ) == NULL ) { lfree ( fap , sizeof ( * fap ) ) ; return ( ENOMEM ) ; } ( void ) strcpy ( fap -> fa_path , path ) ; fap -> fa_type = FA_OPEN ; fap -> fa_oflag = oflag ; fap -> fa_mode = mode ; fap -> fa_filedes = filedes ; add_file_attr ( file_actions , fap ) ; return ( 0 ) ; } 