cs_err X86_option ( cs_struct * handle , cs_opt_type type , size_t value ) { switch ( type ) { default : break ; case CS_OPT_MODE : if ( value == CS_MODE_64 ) { handle -> regsize_map = regsize_map_64 ; } else { handle -> regsize_map = regsize_map_32 ; } handle -> mode = ( cs_mode ) value ; break ; case CS_OPT_SYNTAX : switch ( value ) { default : return CS_ERR_OPTION ; case CS_OPT_SYNTAX_DEFAULT : case CS_OPT_SYNTAX_INTEL : handle -> syntax = CS_OPT_SYNTAX_INTEL ; handle -> printer = X86_Intel_printInst ; break ; case CS_OPT_SYNTAX_MASM : handle -> printer = X86_Intel_printInst ; handle -> syntax = ( int ) value ; break ; case CS_OPT_SYNTAX_ATT : handle -> printer = X86_ATT_printInst ; handle -> syntax = CS_OPT_SYNTAX_ATT ; break ; handle -> errnum = CS_ERR_X86_ATT ; return CS_ERR_X86_ATT ; handle -> errnum = CS_ERR_DIET ; return CS_ERR_DIET ; } break ; } return CS_ERR_OK ; } 