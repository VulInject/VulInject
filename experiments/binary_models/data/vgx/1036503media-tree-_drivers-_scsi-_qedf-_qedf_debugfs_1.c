void qedf_dbg_host_init ( struct qedf_dbg_ctx * qedf , struct qedf_debugfs_ops * dops , struct file_operations * fops ) { char host_dirname [ 32 ] ; struct dentry * file_dentry = NULL ; QEDF_INFO ( qedf , QEDF_LOG_DEBUGFS , "Creating debugfs host node\n" ) ; sprintf ( host_dirname , "host%u" , qedf -> host_no ) ; qedf -> bdf_dentry = debugfs_create_dir ( host_dirname , qedf_dbg_root ) ; if ( ! qedf -> bdf_dentry ) { return ; } while ( dops ) { if ( ! ( dops -> name ) ) { break ; } file_dentry = debugfs_create_file ( dops -> name , 0600 , qedf -> bdf_dentry , qedf , fops ) ; if ( ! file_dentry ) { QEDF_INFO ( qedf , QEDF_LOG_DEBUGFS , "Debugfs entry %s creation failed\n" , dops -> name ) ; debugfs_remove_recursive ( qedf -> bdf_dentry , NULL ) ; return ; } dops ++ ; fops ++ ; } } 