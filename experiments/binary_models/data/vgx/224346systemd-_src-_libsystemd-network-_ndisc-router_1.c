static int get_prefix_info ( sd_ndisc_router * rt , struct nd_opt_prefix_info * * ret ) { struct nd_opt_prefix_info * ri ; size_t length ; int r ; assert ( rt ) ; assert ( ret ) ; r = sd_ndisc_router_option_is_type ( rt , SD_NDISC_OPTION_PREFIX_INFORMATION ) ; if ( r < 0 ) { return r ; } length = NDISC_ROUTER_OPTION_LENGTH ( rt ) ; if ( length != sizeof ( nd_opt_prefix_info ) ) { return - EBADMSG ; } ri = ( nd_opt_prefix_info * ) ( ( uint8_t * ) NDISC_ROUTER_RAW ( rt ) + rt -> rindex ) ; if ( ri -> nd_opt_pi_prefix_len > 128 ) { return - EBADMSG ; } * ret = ri ; return 0 ; } 