static int ip6_tnl_create2 ( struct net_device * dev ) { struct ip6_tnl * t = netdev_priv ( dev ) ; struct net * net = dev_net ( dev ) ; struct ip6_tnl_net * ip6n = net_generic ( net , ip6_tnl_net_id ) ; int err ; t = netdev_priv ( dev ) ; dev -> rtnl_link_ops = & ip6_link_ops ; err = register_netdevice ( dev ) ; if ( err < 0 ) { out } strcpy ( t -> parms . name , dev -> name ) ; dev_hold ( dev , NULL ) ; ip6_tnl_link ( ip6n , t ) ; return 0 ; out return err ; } 