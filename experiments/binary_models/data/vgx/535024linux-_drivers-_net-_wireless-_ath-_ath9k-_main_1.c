static int ath9k_set_antenna ( struct ieee80211_hw * hw , u32 tx_ant , u32 rx_ant ) { struct ath_softc * sc = hw -> priv ; struct ath_hw * ah = sc -> sc_ah ; if ( ah -> caps . rx_chainmask != 1 ) { rx_ant |= tx_ant ; } if ( ! validate_antenna_mask ( ah , rx_ant ) || ! tx_ant ) { return - EINVAL ; } sc -> ant_rx = rx_ant ; sc -> ant_tx = tx_ant ; if ( ah -> caps . rx_chainmask == 1 ) { return 0 ; } if ( AR_SREV_9100 ( ah ) ) { ah -> rxchainmask = 0x7 ; } else { ah -> rxchainmask = fill_chainmask ( ah -> caps . rx_chainmask , rx_ant ) ; } ah -> txchainmask = fill_chainmask ( ah -> caps . tx_chainmask , tx_ant ) ; ath9k_cmn_reload_chainmask ( ah , NULL ) ; return 0 ; } 