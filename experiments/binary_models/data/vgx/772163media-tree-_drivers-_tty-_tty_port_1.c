static void tty_port_destructor ( struct kref * kref ) { struct tty_port * port = container_of ( kref , tty_port , kref ) ; if ( WARN_ON ( port -> itty ) ) { return ; } serdev_tty_port_unregister ( port ) ; if ( port -> xmit_buf ) { free_page ( ( unsigned long ) port -> xmit_buf ) ; } if ( port -> ops && port -> ops -> destruct ) { port -> ops -> destruct ( port ) ; } else { kfree ( port ) ; } } 