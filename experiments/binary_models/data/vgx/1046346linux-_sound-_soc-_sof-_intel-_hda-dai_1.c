static int hda_dai_suspend ( struct hdac_bus * bus ) { struct snd_soc_pcm_runtime * rtd ; struct hdac_ext_stream * hext_stream ; struct hdac_stream * s ; int ret ; list_for_each_entry ( , , ) { hext_stream = stream_to_hdac_ext_stream ( s ) ; if ( hext_stream -> link_substream ) { struct snd_soc_dai * cpu_dai ; struct snd_soc_dai * codec_dai ; rtd = asoc_substream_to_rtd ( hext_stream -> link_substream ) ; cpu_dai = asoc_rtd_to_cpu ( rtd , 0 ) ; codec_dai = asoc_rtd_to_codec ( rtd , 0 ) ; ret = hda_link_dma_cleanup ( hext_stream -> link_substream , hext_stream , cpu_dai , codec_dai , false ) ; ret = hda_dai_hw_free_ipc ( hdac_stream ( hext_stream ) -> direction , cpu_dai ) ; if ( ret < 0 ) { return ret ; } } } return 0 ; } 