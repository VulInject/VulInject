static int tegra_powergate_power_up ( struct tegra_powergate * pg , bool disable_clocks ) { int err ; err = tegra_powergate_reset_assert ( pg ) ; usleep_range ( 10 , 20 ) ; err = tegra_powergate_set ( pg -> id , true ) ; if ( err < 0 ) { return err ; } usleep_range ( 10 , 20 ) ; err = tegra_powergate_enable_clocks ( pg ) ; if ( err ) { disable_clks } usleep_range ( 10 , 20 ) ; err = __tegra_powergate_remove_clamping ( pg -> id ) ; if ( err ) { disable_clks } usleep_range ( 10 , 20 ) ; err = tegra_powergate_reset_deassert ( pg ) ; if ( err ) { powergate_off } usleep_range ( 10 , 20 ) ; if ( disable_clocks ) { tegra_powergate_disable_clocks ( pg ) ; } return 0 ; disable_clks tegra_powergate_disable_clocks ( pg ) ; usleep_range ( 10 , 20 ) ; powergate_off tegra_powergate_set ( pg -> id , false ) ; return err ; } 