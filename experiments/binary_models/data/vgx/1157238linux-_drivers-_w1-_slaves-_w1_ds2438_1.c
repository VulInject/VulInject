static ssize_t temperature_read ( struct file * filp , struct kobject * kobj , struct bin_attribute * bin_attr , char * buf , loff_t off , size_t count ) { struct w1_slave * sl = kobj_to_w1_slave ( kobj ) ; int ret ; int16_t temp ; if ( off != 0 ) { return 0 ; } if ( w1_ds2438_get_temperature ( sl , & temp ) == 0 ) { ret = snprintf ( buf , count , "%i\n" , temp ) ; } else { ret = - EIO ; } return ret ; } 