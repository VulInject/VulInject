static RRPD * find_latest_rrpd_dcerpc ( RRPD * in_rrpd ) { RRPD * rrpd ; wmem_list_frame_t * i ; for ( i = wmem_list_tail ( rrpd_list ) ; i != NULL ; i = wmem_list_frame_prev ( i ) ) { rrpd = ( RRPD * ) wmem_list_frame_data ( i ) ; if ( rrpd -> ip_proto == in_rrpd -> ip_proto && rrpd -> stream_no == in_rrpd -> stream_no ) { if ( rrpd -> session_id == in_rrpd -> session_id && rrpd -> msg_id == in_rrpd -> msg_id ) { return rrpd ; } if ( in_rrpd -> is_retrans ) { return rrpd ; } if ( preferences . reassembly ) { if ( in_rrpd -> c2s ) { if ( rrpd -> rsp_first_frame ) { return NULL ; } if ( ! rrpd -> msg_id ) { return rrpd ; } } else { } } else { if ( in_rrpd -> c2s ) { if ( in_rrpd -> msg_id ) { return NULL ; } else { return rrpd ; } } else { if ( ! in_rrpd -> msg_id && rrpd -> rsp_first_frame ) { return rrpd ; } } } } if ( in_rrpd -> c2s ) { in_rrpd -> req_search_total ++ ; } else { in_rrpd -> rsp_search_total ++ ; } } return NULL ; } 