void add_ipv4_name ( const guint addr , const gchar * name , gboolean static_entry ) { hashipv4_t * tp ; tp = ( hashipv4_t * ) wmem_map_lookup ( ipv4_hash_table , GUINT_TO_POINTER ( addr ) ) ; if ( ! tp ) { tp = new_ipv4 ( addr ) ; wmem_map_insert ( ipv4_hash_table , GUINT_TO_POINTER ( addr ) , tp ) ; } if ( g_ascii_strcasecmp ( tp -> name , name ) && ( static_entry || ! ( tp -> flags & STATIC_HOSTNAME ) ) ) { ( void ) g_strlcpy ( tp -> name , name , MAXNAMELEN ) ; new_resolved_objects = TRUE ; if ( static_entry ) { tp -> flags |= STATIC_HOSTNAME ; } } tp -> flags |= TRIED_RESOLVE_ADDRESS | NAME_RESOLVED ; } 