static int admin_addr_status ( pr_ctrls_t * ctrl , const pr_netaddr_t * addr , unsigned int port ) { pr_ipbind_t * ipbind ; pr_ctrls_log ( MOD_CTRLS_ADMIN_VERSION , "status: checking %s#%u" , pr_netaddr_get_ipstr ( addr ) , port ) ; ipbind = pr_ipbind_find ( addr , port , FALSE ) ; if ( ipbind == NULL ) { pr_ctrls_add_response ( ctrl , "status: no server associated with %s#%u" , pr_netaddr_get_ipstr ( addr ) , port ) ; return PR_CTRLS_STATUS_SUBJECT_NOT_FOUND ; } pr_ctrls_add_response ( ctrl , "status: %s#%u %s" , pr_netaddr_get_ipstr ( addr ) , port , ipbind -> ib_isactive ?"UP" : "DOWN" ) ; return PR_CTRLS_STATUS_OK ; } 