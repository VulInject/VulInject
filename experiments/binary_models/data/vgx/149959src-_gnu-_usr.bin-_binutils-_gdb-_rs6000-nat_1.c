set_host_arch ( ) { enum bfd_architecture arch ; unsigned long mach ; bfd abfd ; struct gdbarch_info info ; if ( __power_rs ( ) ) { arch = bfd_arch_rs6000 ; mach = bfd_mach_rs6k ; } else { arch = bfd_arch_powerpc ; mach = bfd_mach_ppc ; } if ( exec_bfd ) { const struct bfd_arch_info * exec_bfd_arch_info ; exec_bfd_arch_info = bfd_get_arch_info ( exec_bfd ) ; } bfd_default_set_arch_mach ( & abfd , arch , mach ) ; gdbarch_info_init ( & info ) ; info . bfd_arch_info = bfd_get_arch_info ( & abfd ) ; info . abfd = exec_bfd ; if ( ! gdbarch_update_p ( info ) ) { internal_error ( __FILE__ , __LINE__ , "set_host_arch: failed to select architecture" ) ; } } 