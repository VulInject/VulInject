int wc_Poly1305_Pad ( Poly1305 * ctx , word32 lenToPad ) { int ret = 0 ; word32 paddingLen ; byte padding [ WC_POLY1305_PAD_SZ - 1 ] ; if ( lenToPad == 0 ) { return 0 ; } XMEMSET ( padding , 0 , sizeof ( padding ) ) ; paddingLen = ( - ( int ) lenToPad ) & ( WC_POLY1305_PAD_SZ - 1 ) ; if ( ( paddingLen > 0 ) && ( paddingLen < WC_POLY1305_PAD_SZ ) ) { ret = wc_Poly1305Update ( ctx , padding , paddingLen ) ; } return ret ; } 