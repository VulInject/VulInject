static int __init nf_log_syslog_init ( void ) { int ret ; ret = register_pernet_subsys ( & nf_log_syslog_net_ops ) ; ret = nf_log_register ( NFPROTO_IPV4 , & nf_ip_logger ) ; if ( ret < 0 ) { err1 } ret = nf_log_register ( NFPROTO_ARP , & nf_arp_logger ) ; if ( ret < 0 ) { err2 } ret = nf_log_register ( NFPROTO_IPV6 , & nf_ip6_logger ) ; if ( ret < 0 ) { err3 } ret = nf_log_register ( NFPROTO_NETDEV , & nf_netdev_logger ) ; if ( ret < 0 ) { err4 } ret = nf_log_register ( NFPROTO_BRIDGE , & nf_bridge_logger ) ; if ( ret < 0 ) { err5 } return 0 ; err5 nf_log_unregister ( & nf_netdev_logger ) ; err4 nf_log_unregister ( & nf_ip6_logger ) ; err3 nf_log_unregister ( & nf_arp_logger ) ; err2 nf_log_unregister ( & nf_ip_logger ) ; err1 pr_err ( "failed to register logger\n" ) ; unregister_pernet_subsys ( & nf_log_syslog_net_ops ) ; return ret ; } 