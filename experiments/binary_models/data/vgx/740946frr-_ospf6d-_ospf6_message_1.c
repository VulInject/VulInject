DEFUN ( , , "debug ospf6 message<unknown|hello|dbdesc|lsreq|lsupdate|lsack|all>[<send|recv|send-hdr|recv-hdr>]" , "Debug OSPFv3 message\n" "Debug Unknown message\n" "Debug Hello message\n" "Debug Database Description message\n" "Debug Link State Request message\n" "Debug Link State Update message\n" "Debug Link State Acknowledgement message\n" "Debug All message\n" "Debug only sending message, entire packet\n" "Debug only receiving message, entire packet\n" "Debug only sending message, header only\n" "Debug only receiving message, header only\n" ) { int idx_packet = 3 ; int idx_send_recv = 4 ; int level = 0 ; int type = 0 ; int i ; if ( ! strncmp ( argv [ idx_packet ] -> arg , "u" , 1 ) ) { type = OSPF6_MESSAGE_TYPE_UNKNOWN ; } if ( ! strncmp ( argv [ idx_packet ] -> arg , "h" , 1 ) ) { type = OSPF6_MESSAGE_TYPE_HELLO ; } if ( ! strncmp ( argv [ idx_packet ] -> arg , "d" , 1 ) ) { type = OSPF6_MESSAGE_TYPE_DBDESC ; } if ( ! strncmp ( argv [ idx_packet ] -> arg , "lsr" , 3 ) ) { type = OSPF6_MESSAGE_TYPE_LSREQ ; } if ( ! strncmp ( argv [ idx_packet ] -> arg , "lsu" , 3 ) ) { type = OSPF6_MESSAGE_TYPE_LSUPDATE ; } if ( ! strncmp ( argv [ idx_packet ] -> arg , "lsa" , 3 ) ) { type = OSPF6_MESSAGE_TYPE_LSACK ; } if ( ! strncmp ( argv [ idx_packet ] -> arg , "a" , 1 ) ) { type = OSPF6_MESSAGE_TYPE_ALL ; } if ( argc == 4 ) { level = OSPF6_DEBUG_MESSAGE_SEND | OSPF6_DEBUG_MESSAGE_RECV ; } if ( ! strncmp ( argv [ idx_send_recv ] -> arg , "send-h" , 6 ) ) { level = OSPF6_DEBUG_MESSAGE_SEND_HDR ; } if ( ! strncmp ( argv [ idx_send_recv ] -> arg , "s" , 1 ) ) { level = OSPF6_DEBUG_MESSAGE_SEND ; } if ( ! strncmp ( argv [ idx_send_recv ] -> arg , "recv-h" , 6 ) ) { level = OSPF6_DEBUG_MESSAGE_RECV_HDR ; } if ( ! strncmp ( argv [ idx_send_recv ] -> arg , "r" , 1 ) ) { level = OSPF6_DEBUG_MESSAGE_RECV ; } if ( type == OSPF6_MESSAGE_TYPE_ALL ) { for ( i = 0 ; i < 6 ; i ++ ) { OSPF6_DEBUG_MESSAGE_ON ( i , level ) ; } } else { OSPF6_DEBUG_MESSAGE_ON ( type , level ) ; } return CMD_SUCCESS ; } 