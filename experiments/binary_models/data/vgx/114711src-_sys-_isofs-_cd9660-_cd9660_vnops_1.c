int filt_cd9660read ( struct knote * kn , long hint ) { struct vnode * vp = ( vnode * ) kn -> kn_hook ; struct iso_node * node = VTOI ( vp ) ; if ( hint == NOTE_REVOKE ) { kn -> kn_flags |= ( EV_EOF | EV_ONESHOT ) ; return ( 1 ) ; } kn -> kn_data = node -> i_size - foffset ( kn -> kn_fp ) ; if ( kn -> kn_data == 0 && kn -> kn_sfflags & NOTE_EOF ) { kn -> kn_fflags |= NOTE_EOF ; return ( 1 ) ; } return ( kn -> kn_data != 0 ) ; } 