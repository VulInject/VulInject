pango_fc_font_real_get_glyph ( , ) { PangoFcFontPrivate * priv = font -> priv ; FT_Face face ; FT_UInt index ; guint idx ; PangoFcCmapCacheEntry * entry ; if ( G_UNLIKELY ( priv -> cmap_cache == NULL ) ) { priv -> cmap_cache = _pango_fc_font_map_get_cmap_cache ( ( PangoFcFontMap * ) font -> fontmap , font ) ; } idx = wc & CMAP_CACHE_MASK ; entry = priv -> cmap_cache -> entries + idx ; if ( entry -> ch != wc ) { face = PANGO_FC_FONT_LOCK_FACE ( font ) ; if ( G_LIKELY ( face ) ) { index = FcFreeTypeCharIndex ( face , wc ) ; if ( index > ( FT_UInt ) face -> num_glyphs ) { index = 0 ; } PANGO_FC_FONT_UNLOCK_FACE ( font ) ; } else { index = 0 ; } entry -> ch = wc ; entry -> glyph = index ; } return entry -> glyph ; } 