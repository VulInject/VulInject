static int ltc4306_gpio_set_config ( struct gpio_chip * chip , unsigned int offset , unsigned long config ) { struct ltc4306 * data = gpiochip_get_data ( chip ) ; int val ; switch ( pinconf_to_config_param ( config ) ) { case PIN_CONFIG_DRIVE_OPEN_DRAIN : val = 0 ; break ; case PIN_CONFIG_DRIVE_PUSH_PULL : val = BIT ( 4 - offset ) ; break ; default : return - ENOTSUPP ; } return regmap_update_bits ( data -> regmap , LTC_REG_MODE , BIT ( 4 - offset ) , val ) ; } 