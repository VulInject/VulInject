static int omap3xxx_cm_wait_module_ready ( u8 part , s16 prcm_mod , u16 idlest_id , u8 idlest_shift ) { int ena = 0 , i = 0 ; u8 cm_idlest_reg ; u32 mask ; cm_idlest_reg = omap3xxx_cm_idlest_offs [ idlest_id - 1 ] ; mask = 1 << idlest_shift ; ena = 0 ; omap_test_timeout ( ( ( omap2_cm_read_mod_reg ( prcm_mod , cm_idlest_reg ) & mask ) == ena ) , MAX_MODULE_READY_TIME , i ) ; return ( i < MAX_MODULE_READY_TIME ) ?0 : - EBUSY ; } 