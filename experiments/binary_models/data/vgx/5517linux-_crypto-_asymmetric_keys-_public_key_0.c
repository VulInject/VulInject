int FUN1(const struct VAR1 *VAR2,
const struct VAR3 *VAR4)
{
struct crypto_wait VAR5;
struct VAR6 *VAR7;
struct VAR8 *VAR9;
struct scatterlist VAR10[2];
char VAR11[VAR12];
char *VAR13, *VAR14;
int VAR15;

FUN2("", VAR16);

FUN3(!VAR2);
FUN3(!VAR4);
FUN3(!VAR4->VAR17);


if (VAR4->VAR18) {
if (strcmp(VAR2->VAR18, VAR4->VAR18) != 0 &&
(FUN4(VAR2->VAR18, "", 6) != 0 ||
strcmp(VAR4->VAR18, "") != 0))
return -VAR19;
}

VAR15 = FUN5(VAR2, VAR4->VAR20,
VAR4->VAR21, VAR11);
if (VAR15 < 0)
return VAR15;

VAR7 = FUN6(VAR11, 0, 0);
if (FUN7(VAR7))
return FUN8(VAR7);

VAR15 = -VAR22;
VAR9 = FUN9(VAR7, VAR23);
if (!VAR9)
goto VAR24;

VAR13 = FUN10(VAR2->VAR25 + sizeof(VAR26) * 2 + VAR2->VAR27,
VAR23);
if (!VAR13)
goto VAR28;

memcpy(VAR13, VAR2->VAR13, VAR2->VAR25);
VAR14 = VAR13 + VAR2->VAR25;
VAR14 = FUN11(VAR14, VAR2->VAR29);
VAR14 = FUN11(VAR14, VAR2->VAR27);
memcpy(VAR14, VAR2->VAR30, VAR2->VAR27);

if (VAR2->VAR31)
VAR15 = FUN12(VAR7, VAR13, VAR2->VAR25);
else
VAR15 = FUN13(VAR7, VAR13, VAR2->VAR25);
if (VAR15)
goto VAR32;

if (strcmp(VAR2->VAR18, "") == 0 && VAR4->VAR33) {
VAR15 = FUN14(VAR4, VAR7);
if (VAR15)
goto VAR32;
}

FUN15(VAR10, 2);
FUN16(&VAR10[0], VAR4->VAR17, VAR4->VAR34);
FUN16(&VAR10[1], VAR4->VAR35, VAR4->VAR36);
FUN17(VAR9, VAR10, NULL, VAR4->VAR34,
VAR4->VAR36);
FUN18(&VAR5);
FUN19(VAR9, VAR37 |
VAR38,
VAR39, &VAR5);
VAR15 = FUN20(FUN21(VAR9), &VAR5);

VAR32:
FUN22(VAR13);
VAR28:
FUN23(VAR9);
VAR24:
FUN24(VAR7);
FUN2("", VAR16, VAR15);
if (FUN25(VAR15 > 0))
VAR15 = -VAR40;
return VAR15;
}