int soc_clk_dump ( void ) { struct udevice * dev ; int i , ret ; ret = uclass_get_device_by_driver ( UCLASS_CLK , DM_DRIVER_GET ( zynqmp_clk ) , & dev ) ; printf ( "clk\t\tfrequency\n" ) ; for ( i = 0 ; i < clk_max ; i ++ ) { const char * name = clk_names [ i ] ; if ( name ) { struct clk clk ; unsigned long rate ; clk . id = i ; ret = clk_request ( dev , & clk ) ; if ( ret < 0 ) { return ret ; } rate = clk_get_rate ( & clk ) ; clk_free ( & clk ) ; if ( ( rate == ( unsigned long ) - ENOSYS ) || ( rate == ( unsigned long ) - ENXIO ) || ( rate == ( unsigned long ) - EIO ) ) { printf ( "%10s%20s\n" , name , "unknown" ) ; } else { printf ( "%10s%20lu\n" , name , rate ) ; } } } return 0 ; } 