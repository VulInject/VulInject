int fido_cred_exclude ( fido_cred_t * cred , const unsigned char * id_ptr , size_t id_len ) { fido_blob_t id_blob ; fido_blob_t * list_ptr ; if ( fido_blob_set ( & id_blob , id_ptr , id_len ) < 0 ) { return ( FIDO_ERR_INVALID_ARGUMENT ) ; } if ( cred -> excl . len == SIZE_MAX ) { free ( id_blob . ptr ) ; return ( FIDO_ERR_INVALID_ARGUMENT ) ; } if ( ( list_ptr = recallocarray ( cred -> excl . ptr , cred -> excl . len , cred -> excl . len + 1 , sizeof ( fido_blob_t ) ) ) == NULL ) { free ( id_blob . ptr ) ; return ( FIDO_ERR_INTERNAL ) ; } list_ptr [ cred -> excl . len ++ ] = id_blob ; cred -> excl . ptr = list_ptr ; return ( FIDO_OK ) ; } 