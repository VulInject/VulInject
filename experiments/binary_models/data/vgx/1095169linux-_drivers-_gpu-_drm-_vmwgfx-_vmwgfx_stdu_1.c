static void vmw_stdu_crtc_atomic_disable ( struct drm_crtc * crtc , struct drm_atomic_state * state ) { struct vmw_private * dev_priv ; struct vmw_screen_target_display_unit * stdu ; int ret ; if ( ! crtc ) { DRM_ERROR ( "CRTC is NULL\n" ) ; return ; } stdu = vmw_crtc_to_stdu ( crtc , NULL ) ; dev_priv = vmw_priv ( crtc -> dev ) ; if ( stdu -> defined ) { ret = vmw_stdu_bind_st ( dev_priv , stdu , NULL ) ; if ( ret ) { DRM_ERROR ( "Failed to blank CRTC\n" ) ; } ( void ) vmw_stdu_update_st ( dev_priv , stdu ) ; ret = vmw_stdu_destroy_st ( dev_priv , stdu ) ; if ( ret ) { DRM_ERROR ( "Failed to destroy Screen Target\n" ) ; } stdu -> content_fb_type = SAME_AS_DISPLAY ; } } 