static int lowland_wm5100_init ( struct snd_soc_pcm_runtime * rtd ) { struct snd_soc_component * component = asoc_rtd_to_codec ( rtd , 0 ) -> component ; int ret ; ret = snd_soc_component_set_sysclk ( component , WM5100_CLK_SYSCLK , WM5100_CLKSRC_MCLK1 , MCLK1_RATE , SND_SOC_CLOCK_IN ) ; if ( ret < 0 ) { pr_err ( "Failed to set SYSCLK clock source: %d\n" , ret ) ; return ret ; } ret = snd_soc_component_set_sysclk ( component , WM5100_CLK_OPCLK , 0 , CLKOUT_RATE , 0 ) ; if ( ret < 0 ) { pr_err ( "Failed to set OPCLK rate: %d\n" , ret ) ; return ret ; } ret = snd_soc_card_jack_new_pins ( rtd -> card , "Headset" , SND_JACK_LINEOUT | SND_JACK_HEADSET | SND_JACK_BTN_0 , & lowland_headset , lowland_headset_pins , ARRAY_SIZE ( lowland_headset_pins ) ) ; wm5100_detect ( component , & lowland_headset ) ; return 0 ; } 