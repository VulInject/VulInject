static void ibm_unconfigure_device ( struct pci_func * func ) { struct pci_dev * temp ; u8 j ; debug ( "inside %s\n" , __func__ ) ; debug ( "func->device = %x, func->function = %x\n" , func -> device , func -> function ) ; debug ( "func->device<<3 | 0x0  = %x\n" , func -> device << 3 | 0x0 ) ; pci_lock_rescan_remove ( ) ; for ( j = 0 ; j < 0x08 ; j ++ ) { temp = pci_get_domain_bus_and_slot ( 0 , func -> busno , ( func -> device << 3 ) | j ) ; if ( temp ) { pci_stop_and_remove_bus_device ( temp ) ; pci_dev_put ( temp ) ; } } pci_dev_put ( func -> dev , NULL ) ; pci_unlock_rescan_remove ( ) ; } 