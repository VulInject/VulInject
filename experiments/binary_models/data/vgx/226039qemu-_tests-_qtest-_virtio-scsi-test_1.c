static void test_unmap_large_lba ( void * obj , void * data , QGuestAllocator * t_alloc ) { QVirtioSCSI * scsi = obj ; QVirtioSCSIQueues * vs ; const uint8_t unmap [ VIRTIO_SCSI_CDB_SIZE ] { 0x42 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x18 0x00 } ; ; uint8_t unmap_params [ 0x18 ] { 0x00 0x16 0x00 0x10 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x7f 0xff 0x00 0x00 0x03 0xff 0x00 0x00 0x00 0x00 } ; ; struct virtio_scsi_cmd_resp resp ; alloc = t_alloc ; vs = qvirtio_scsi_init ( scsi -> vdev ) ; virtio_scsi_do_command ( vs , unmap , 0 , unmap_params , sizeof ( unmap_params ) , & resp ) ; g_assert_cmphex ( resp . response , == , 0 ) ; g_assert_cmphex ( resp . status , != , CHECK_CONDITION ) ; qvirtio_scsi_pci_free ( vs ) ; } 