usr_store_inferior_registers ( ) { CORE_ADDR regaddr ; int i ; char * buf ; if ( regno >= 0 ) { if ( * the_low_target . cannot_store_register ( regno ) == 1 ) { return ; } regaddr = register_addr ( regno ) ; if ( regaddr == - 1 ) { return ; } errno = 0 ; buf = alloca ( register_size ( regno ) ) ; collect_register ( regno , buf ) ; for ( i = 0 ; i < register_size ( regno ) ; i += sizeof ( PTRACE_XFER_TYPE ) ) { errno = 0 ; ptrace ( PTRACE_POKEUSER , inferior_pid , ( PTRACE_ARG3_TYPE ) regaddr , * ( PTRACE_XFER_TYPE * ) ( buf + i ) ) ; if ( errno != 0 ) { if ( * the_low_target . cannot_store_register ( regno ) == 0 ) { char * err = strerror ( errno ) ; char * msg = alloca ( strlen ( err ) + 128 ) ; sprintf ( msg , "writing register %d: %s" , regno , err ) ; error ( msg ) ; return ; } } regaddr += sizeof ( PTRACE_XFER_TYPE ) ; } } else { for ( regno = 0 ; regno < the_low_target . num_regs ; regno ++ ) { usr_store_inferior_registers ( regno ) ; } } } 