static int nv84_fence_emit32 ( struct nouveau_channel * chan , u64 virtual , u32 sequence ) { struct nvif_push * push = chan -> chan . push ; int ret = PUSH_WAIT ( push , 8 ) ; if ( ret == 0 ) { PUSH_MTHD ( push , NV826F , SET_CONTEXT_DMA_SEMAPHORE , chan -> vram . handle ) ; PUSH_MTHD ( push , NV826F , SEMAPHOREA , NVVAL ( NV826F , SEMAPHOREA , OFFSET_UPPER , upper_32_bits ( virtual ) ) , SEMAPHOREB , lower_32_bits ( virtual ) , SEMAPHOREC , sequence , SEMAPHORED , NVDEF ( NV826F , SEMAPHORED , OPERATION , RELEASE ) , NON_STALLED_INTERRUPT , 0 ) ; PUSH_KICK ( push , NULL ) ; } return ret ; } 