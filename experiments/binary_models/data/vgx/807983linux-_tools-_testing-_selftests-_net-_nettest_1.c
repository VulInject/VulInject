static int switch_ns ( const char * ns ) { char path [ PATH_MAX ] ; int fd , ret ; if ( geteuid ( ) ) { log_error ( "warning: likely need root to set netns %s!\n" , ns ) ; } sprintf ( path , "%s%s" , NS_PREFIX , ns ) ; fd = open ( path , 0 ) ; if ( fd < 0 ) { log_err_errno ( "Failed to open netns path; can not switch netns" ) ; return 1 ; } ret = setns ( fd , CLONE_NEWNET ) ; close ( fd ) ; return ret ; } 