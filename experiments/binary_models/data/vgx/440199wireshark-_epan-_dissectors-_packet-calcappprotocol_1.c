static void calcappprotocol_stat_init ( stat_tap_table_ui * new_stat ) { const char * table_name = "CalcAppProtocol Statistics" ; int num_fields = sizeof ( calcappprotocol_stat_fields ) / sizeof ( stat_tap_table_item ) ; stat_tap_table * table ; int i = 0 ; stat_tap_table_item_type items [ sizeof ( calcappprotocol_stat_fields ) / sizeof ( stat_tap_table_item ) ] ; table = stat_tap_find_table ( new_stat , table_name ) ; if ( table ) { if ( new_stat -> stat_tap_reset_table_cb ) { new_stat -> stat_tap_reset_table_cb ( table ) ; } return ; } table = stat_tap_init_table ( table_name , num_fields , 0 , NULL ) ; stat_tap_add_table ( new_stat , table ) ; while ( message_type_values [ i ] . strptr ) { items [ MESSAGE_TYPE_COLUMN ] . type = TABLE_ITEM_STRING ; items [ MESSAGE_TYPE_COLUMN ] . value . string_value = message_type_values [ i ] . strptr ; items [ MESSAGES_COLUMN ] . type = TABLE_ITEM_UINT ; items [ MESSAGES_COLUMN ] . value . uint_value = 0 ; items [ MESSAGES_SHARE_COLUMN ] . type = TABLE_ITEM_NONE ; items [ MESSAGES_SHARE_COLUMN ] . value . float_value = - 1.0 ; items [ BYTES_COLUMN ] . type = TABLE_ITEM_UINT ; items [ BYTES_COLUMN ] . value . uint_value = 0 ; items [ BYTES_SHARE_COLUMN ] . type = TABLE_ITEM_NONE ; items [ BYTES_SHARE_COLUMN ] . value . float_value = - 1.0 ; items [ FIRST_SEEN_COLUMN ] . type = TABLE_ITEM_NONE ; items [ FIRST_SEEN_COLUMN ] . value . float_value = DBL_MAX ; items [ LAST_SEEN_COLUMN ] . type = TABLE_ITEM_NONE ; items [ LAST_SEEN_COLUMN ] . value . float_value = DBL_MIN ; items [ INTERVAL_COLUMN ] . type = TABLE_ITEM_NONE ; items [ INTERVAL_COLUMN ] . value . float_value = - 1.0 ; items [ MESSAGE_RATE_COLUMN ] . type = TABLE_ITEM_NONE ; items [ MESSAGE_RATE_COLUMN ] . value . float_value = - 1.0 ; items [ BYTE_RATE_COLUMN ] . type = TABLE_ITEM_NONE ; items [ BYTE_RATE_COLUMN ] . value . float_value = - 1.0 ; stat_tap_init_table_row ( table , i , num_fields , items ) ; i ++ ; } } 