static void test_config_include_empty_file_folder ( void * data ) { ( void ) data ; config_line_t * result = NULL ; char * folder_path = NULL ; char * file_path = NULL ; char * dir = tor_strdup ( get_fname ( "test_include_empty_file_folder" ) ) ; tt_ptr_op ( dir , OP_NE , NULL ) ; tt_int_op ( mkdir ( dir ) , OP_EQ , 0 ) ; tt_int_op ( mkdir ( dir , 0700 ) , OP_EQ , 0 ) ; tor_asprintf ( & folder_path , "%s" PATH_SEPARATOR "empty_dir" , dir ) ; tt_int_op ( mkdir ( folder_path ) , OP_EQ , 0 ) ; tt_int_op ( mkdir ( folder_path , 0700 ) , OP_EQ , 0 ) ; tor_asprintf ( & file_path , "%s" PATH_SEPARATOR "empty_file" , dir ) ; tt_int_op ( write_str_to_file ( file_path , "" , 0 ) , OP_EQ , 0 ) ; char torrc_contents [ 1000 ] ; tor_snprintf ( torrc_contents , sizeof ( torrc_contents ) , "%%include %s\n" "%%include %s\n" , folder_path , file_path ) ; int include_used ; tt_int_op ( config_get_lines_include ( torrc_contents , & result , 0 , & include_used , NULL ) , OP_EQ , 0 ) ; tt_ptr_op ( result , OP_EQ , NULL ) ; tt_int_op ( include_used , OP_EQ , 1 ) ; done config_free_lines ( result ) ; tor_free ( file_path ) ; tor_free ( dir ) ; } 