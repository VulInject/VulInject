cvmx_helper_interface_mode_t cvmx_helper_bgx_get_mode ( int xiface , int index ) { struct cvmx_xiface xi = cvmx_helper_xiface_to_node_interface ( xiface ) ; cvmx_bgxx_cmrx_config_t cmr_config ; cvmx_bgxx_spux_br_pmd_control_t pmd_control ; cmr_config . u64 = csr_rd_node ( xi . node , CVMX_BGXX_CMRX_CONFIG ( index , xi . interface ) ) ; switch ( cmr_config . s . lmac_type ) { case 0 : return CVMX_HELPER_INTERFACE_MODE_SGMII ; case 1 : return CVMX_HELPER_INTERFACE_MODE_XAUI ; case 2 : return CVMX_HELPER_INTERFACE_MODE_RXAUI ; case 3 : pmd_control . u64 = csr_rd_node ( xi . node , CVMX_BGXX_SPUX_BR_PMD_CONTROL ( index , xi . interface ) ) ; if ( pmd_control . s . train_en ) { return CVMX_HELPER_INTERFACE_MODE_10G_KR ; } else { return CVMX_HELPER_INTERFACE_MODE_XFI ; } break ; case 4 : if ( OCTEON_IS_MODEL ( OCTEON_CN78XX_PASS1_X ) ) { return cvmx_helper_interface_get_mode ( xiface ) ; } pmd_control . u64 = csr_rd_node ( xi . node , CVMX_BGXX_SPUX_BR_PMD_CONTROL ( index , xi . interface ) ) ; if ( pmd_control . s . train_en ) { return CVMX_HELPER_INTERFACE_MODE_40G_KR4 ; } else { return CVMX_HELPER_INTERFACE_MODE_XLAUI ; } break ; case 5 : return CVMX_HELPER_INTERFACE_MODE_RGMII ; default : return CVMX_HELPER_INTERFACE_MODE_DISABLED ; } } 