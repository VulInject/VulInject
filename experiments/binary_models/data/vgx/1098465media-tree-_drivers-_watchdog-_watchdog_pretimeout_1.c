( watchdog_notify_pretimeout ) ; int watchdog_register_governor ( struct watchdog_governor * gov ) { struct watchdog_pretimeout * p ; struct governor_priv * priv ; priv = kzalloc ( sizeof ( * priv ) , GFP_KERNEL ) ; if ( ! priv ) { return - ENOMEM ; } mutex_lock ( & governor_lock ) ; if ( find_governor_by_name ( gov -> name ) ) { mutex_unlock ( & governor_lock ) ; return - EBUSY ; } priv -> gov = gov ; list_add ( & priv -> entry , & governor_list ) ; if ( ! strncmp ( gov -> name , WATCHDOG_PRETIMEOUT_DEFAULT_GOV , WATCHDOG_GOV_NAME_MAXLEN ) ) { spin_lock_irq ( & pretimeout_lock ) ; default_gov = gov ; list_for_each_entry ( , , ) if ( ! p -> wdd -> gov ) { p -> wdd -> gov = default_gov ; } spin_unlock_irq ( & pretimeout_lock ) ; } mutex_unlock ( & governor_lock ) ; return 0 ; } 