int CONF_modules_load ( const CONF * cnf , const char * appname , unsigned long flags ) { STACK_OF ( CONF_VALUE ) * values ; CONF_VALUE * vl ; char * vsection = NULL ; int ret , i ; if ( appname ) { vsection = NCONF_get_string ( cnf , NULL , appname ) ; } if ( ! appname || ( ! vsection && ( flags & CONF_MFLAGS_DEFAULT_SECTION ) ) ) { vsection = NCONF_get_string ( cnf , NULL , "openssl_conf" ) ; } if ( ! vsection ) { ERR_clear_error ( ) ; return 1 ; } values = NCONF_get_section ( cnf , vsection ) ; if ( ! values ) { return 0 ; } for ( i = 0 ; i < sk_CONF_VALUE_num ( values ) ; i ++ ) { vl = sk_CONF_VALUE_value ( values , i ) ; ret = module_run ( cnf , vl -> name , vl -> value , flags ) ; if ( ret <= 0 ) { if ( ! ( flags & CONF_MFLAGS_IGNORE_ERRORS ) ) { return ret ; } } } return 1 ; } 