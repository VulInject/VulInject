int snd_dice_detect_extension_formats ( struct snd_dice * dice ) { __be32 * pointers ; unsigned int i ; u64 section_addr ; int err ; pointers = kmalloc_array ( 9 , sizeof ( __be32 ) * 2 , GFP_KERNEL ) ; err = snd_fw_transaction ( dice -> unit , TCODE_READ_BLOCK_REQUEST , DICE_EXT_APP_SPACE , pointers , 9 * sizeof ( __be32 ) * 2 , 0 ) ; if ( err < 0 ) { end } for ( i = 0 ; i < 9 ; ++ i ) { int j ; for ( j = i + 1 ; j < 9 ; ++ j ) { if ( pointers [ i * 2 ] == pointers [ j * 2 ] ) { err = - ENXIO ; end } } } section_addr = DICE_EXT_APP_SPACE + be32_to_cpu ( pointers [ 12 ] ) * 4 ; err = detect_stream_formats ( dice , section_addr ) ; end kfree ( pointers ) ; return err ; } 