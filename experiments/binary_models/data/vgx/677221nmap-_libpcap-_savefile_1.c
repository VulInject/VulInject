pcap_t * pcap_hopen_offline_with_tstamp_precision ( intptr_t osfd , u_int precision , char * errbuf ) { int fd ; FILE * file ; fd = _open_osfhandle ( osfd , _O_RDONLY ) ; if ( fd < 0 ) { pcap_fmt_errmsg_for_errno ( errbuf , PCAP_ERRBUF_SIZE , errno , "_open_osfhandle" ) ; return NULL ; } file = _fdopen ( fd , "rb" ) ; if ( file == NULL ) { pcap_fmt_errmsg_for_errno ( errbuf , PCAP_ERRBUF_SIZE , errno , "_fdopen" ) ; _close ( fd , NULL ) ; return NULL ; } return pcap_fopen_offline_with_tstamp_precision ( file , precision , errbuf ) ; } 