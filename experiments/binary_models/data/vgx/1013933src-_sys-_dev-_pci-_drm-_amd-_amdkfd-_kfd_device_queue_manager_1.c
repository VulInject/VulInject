static int unregister_process ( struct device_queue_manager * dqm , struct qcm_process_device * qpd ) { int retval ; struct device_process_node * cur , * next ; pr_debug ( "qpd->queues_list is %s\n" , list_empty ( & qpd -> queues_list ) ?"empty" : "not empty" ) ; retval = 0 ; dqm_lock ( dqm ) ; list_for_each_entry_safe ( , , , ) { if ( qpd == cur -> qpd ) { list_del ( & cur -> list ) ; dqm -> processes_count -- ; out } } retval = 1 ; out dqm_unlock ( dqm ) ; if ( ! retval ) { kfd_dec_compute_active ( dqm -> dev ) ; } return retval ; } 