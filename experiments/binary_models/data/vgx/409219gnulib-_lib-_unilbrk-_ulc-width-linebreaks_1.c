main ( int argc , char * argv [ ] ) { setlocale ( LC_CTYPE , "" ) ; if ( argc == 2 ) { int width = atoi ( argv [ 1 ] ) ; char * input = read_file ( stdin ) ; int length = strlen ( input ) ; char * breaks = malloc ( length ) ; int i ; ulc_width_linebreaks_v2 ( input , length , width , 0 , 0 , NULL , locale_charset ( ) , breaks ) ; for ( i = 0 ; i < length ; i ++ ) { switch ( breaks [ i ] ) { case UC_BREAK_POSSIBLE : putc ( '\n' , stdout ) ; break ; case UC_BREAK_MANDATORY : break ; case UC_BREAK_CR_BEFORE_LF : break ; case UC_BREAK_PROHIBITED : break ; default : abort ( ) ; } putc ( input [ i ] , stdout ) ; } return 0 ; } else { return 1 ; } } 