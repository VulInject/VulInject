static void k2_sata_tf_read ( struct ata_port * ap , struct ata_taskfile * tf ) { struct ata_ioports * ioaddr = & ap -> ioaddr ; u16 nsect , lbal , lbam , lbah , error ; tf -> status = k2_stat_check_status ( ap ) ; tf -> device = readw ( ioaddr -> device_addr ) ; error = readw ( ioaddr -> error_addr ) ; nsect = readw ( ioaddr -> nsect_addr , NULL ) ; lbal = readw ( ioaddr -> lbal_addr ) ; lbam = readw ( ioaddr -> lbam_addr ) ; lbah = readw ( ioaddr -> lbah_addr ) ; tf -> error = error ; tf -> nsect = nsect ; tf -> lbal = lbal ; tf -> lbam = lbam ; tf -> lbah = lbah ; if ( tf -> flags & ATA_TFLAG_LBA48 ) { tf -> hob_feature = error >> 8 ; tf -> hob_nsect = nsect >> 8 ; tf -> hob_lbal = lbal >> 8 ; tf -> hob_lbam = lbam >> 8 ; tf -> hob_lbah = lbah >> 8 ; } } 