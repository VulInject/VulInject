static int br_cc_ccm_tx_parse ( struct net_bridge * br , struct nlattr * attr , struct netlink_ext_ack * extack ) { struct nlattr * tb [ IFLA_BRIDGE_CFM_CC_CCM_TX_MAX + 1 ] ; struct br_cfm_cc_ccm_tx_info tx_info ; u32 instance ; int err ; err = nla_parse_nested ( tb , IFLA_BRIDGE_CFM_CC_CCM_TX_MAX , attr , br_cfm_cc_ccm_tx_policy , extack ) ; if ( err ) { return err ; } if ( ! tb [ IFLA_BRIDGE_CFM_CC_CCM_TX_INSTANCE ] ) { NL_SET_ERR_MSG_MOD ( extack , "Missing INSTANCE attribute" ) ; return - EINVAL ; } if ( ! tb [ IFLA_BRIDGE_CFM_CC_CCM_TX_DMAC ] ) { NL_SET_ERR_MSG_MOD ( extack , "Missing DMAC attribute" ) ; return - EINVAL ; } if ( ! tb [ IFLA_BRIDGE_CFM_CC_CCM_TX_SEQ_NO_UPDATE ] ) { NL_SET_ERR_MSG_MOD ( extack , "Missing SEQ_NO_UPDATE attribute" ) ; return - EINVAL ; } if ( ! tb [ IFLA_BRIDGE_CFM_CC_CCM_TX_PERIOD ] ) { NL_SET_ERR_MSG_MOD ( extack , "Missing PERIOD attribute" ) ; return - EINVAL ; } if ( ! tb [ IFLA_BRIDGE_CFM_CC_CCM_TX_IF_TLV ] ) { NL_SET_ERR_MSG_MOD ( extack , "Missing IF_TLV attribute" ) ; return - EINVAL ; } if ( ! tb [ IFLA_BRIDGE_CFM_CC_CCM_TX_IF_TLV_VALUE ] ) { NL_SET_ERR_MSG_MOD ( extack , "Missing IF_TLV_VALUE attribute" ) ; return - EINVAL ; } if ( ! tb [ IFLA_BRIDGE_CFM_CC_CCM_TX_PORT_TLV ] ) { NL_SET_ERR_MSG_MOD ( extack , "Missing PORT_TLV attribute" ) ; return - EINVAL ; } if ( ! tb [ IFLA_BRIDGE_CFM_CC_CCM_TX_PORT_TLV_VALUE ] ) { NL_SET_ERR_MSG_MOD ( extack , "Missing PORT_TLV_VALUE attribute" ) ; return - EINVAL ; } instance = nla_get_u32 ( tb [ IFLA_BRIDGE_CFM_CC_RDI_INSTANCE ] ) ; nla_memcpy ( & tx_info . dmac . addr , tb [ IFLA_BRIDGE_CFM_CC_CCM_TX_DMAC ] , sizeof ( tx_info . dmac . addr ) ) ; tx_info . seq_no_update = nla_get_u32 ( tb [ IFLA_BRIDGE_CFM_CC_CCM_TX_SEQ_NO_UPDATE ] ) ; tx_info . period = nla_get_u32 ( tb [ IFLA_BRIDGE_CFM_CC_CCM_TX_PERIOD ] ) ; tx_info . if_tlv = nla_get_u32 ( tb [ IFLA_BRIDGE_CFM_CC_CCM_TX_IF_TLV ] ) ; tx_info . if_tlv_value = nla_get_u8 ( tb [ IFLA_BRIDGE_CFM_CC_CCM_TX_IF_TLV_VALUE ] ) ; tx_info . port_tlv = nla_get_u32 ( tb [ IFLA_BRIDGE_CFM_CC_CCM_TX_PORT_TLV ] ) ; tx_info . port_tlv_value = nla_get_u8 ( tb [ IFLA_BRIDGE_CFM_CC_CCM_TX_PORT_TLV_VALUE ] ) ; return br_cfm_cc_ccm_tx ( br , instance , & tx_info , extack ) ; } 