static int bio_chain_create ( const BIO_METHOD * meth , BIO * chain [ ] , size_t len ) { BIO * prev ; size_t i ; prev = NULL ; for ( i = 0 ; i < len ; i ++ ) { if ( ( chain [ i ] = BIO_new ( meth ) ) == NULL ) { fprintf ( stderr , "BIO_new failed\n" ) ; err } if ( ( prev = BIO_push ( prev , chain [ i ] ) ) == NULL ) { fprintf ( stderr , "BIO_push failed\n" ) ; err } } return 1 ; err bio_chain_destroy ( chain , len ) ; return 0 ; } 