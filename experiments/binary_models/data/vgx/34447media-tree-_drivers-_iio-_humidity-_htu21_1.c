static int htu21_read_raw ( struct iio_dev * indio_dev , struct iio_chan_spec const * channel , int * val , int * val2 , long mask ) { int ret , temperature ; unsigned int humidity ; struct ms_ht_dev * dev_data = iio_priv ( indio_dev ) ; switch ( mask ) { case IIO_CHAN_INFO_PROCESSED : switch ( channel -> type ) { case IIO_TEMP : ret = ms_sensors_ht_read_temperature ( dev_data , & temperature ) ; * val = temperature ; return IIO_VAL_INT ; case IIO_HUMIDITYRELATIVE : ret = ms_sensors_ht_read_humidity ( dev_data , & humidity ) ; if ( ret ) { return ret ; } * val = humidity ; return IIO_VAL_INT ; default : return - EINVAL ; } case IIO_CHAN_INFO_SAMP_FREQ : * val = htu21_samp_freq [ dev_data -> res_index ] ; return IIO_VAL_INT ; default : return - EINVAL ; } } 