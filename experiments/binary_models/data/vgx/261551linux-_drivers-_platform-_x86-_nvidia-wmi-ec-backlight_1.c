static int wmi_brightness_notify ( struct wmi_device * w , enum wmi_brightness_method id , enum wmi_brightness_mode mode , u32 * val ) { struct wmi_brightness_args args = { . mode = mode . val = 0 . ret = 0 } ; struct acpi_buffer buf = { ( acpi_size ) sizeof ( args ) & args } ; acpi_status status ; if ( mode == WMI_BRIGHTNESS_MODE_SET ) { args . val = * val ; } status = wmidev_evaluate_method ( w , 0 , id , & buf , & buf ) ; if ( ACPI_FAILURE ( status ) ) { dev_err ( & w -> dev , "EC backlight control failed: %s\n" , acpi_format_exception ( status ) ) ; return - EIO ; } if ( mode != WMI_BRIGHTNESS_MODE_SET ) { * val = args . ret ; } return 0 ; } 