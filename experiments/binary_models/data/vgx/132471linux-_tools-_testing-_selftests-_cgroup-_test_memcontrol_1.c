static int alloc_anon_50M_check ( const char * cgroup , void * arg ) { size_t size = MB ( 50 ) ; char * buf , * ptr ; long anon , current ; int ret = - 1 ; buf = malloc ( size , NULL ) ; for ( ptr = buf ; ptr < buf + size ; ptr += PAGE_SIZE ) { * ptr = 0 ; } current = cg_read_long ( cgroup , "memory.current" ) ; if ( current < size ) { cleanup } if ( ! values_close ( size , current , 3 ) ) { cleanup } anon = cg_read_key_long ( cgroup , "memory.stat" , "anon " ) ; if ( anon < 0 ) { cleanup } if ( ! values_close ( anon , current , 3 ) ) { cleanup } ret = 0 ; cleanup free ( buf ) ; return ret ; } 