struct kernfs_node * kernfs_create_link ( struct kernfs_node * parent , const char * name , struct kernfs_node * target ) { struct kernfs_node * kn ; int error ; kn = kernfs_new_node ( parent , name , S_IFLNK | S_IRWXUGO , KERNFS_LINK ) ; if ( ! kn ) { return ERR_PTR ( - ENOMEM ) ; } if ( kernfs_ns_enabled ( parent ) ) { kn -> ns = target -> ns ; } kn -> symlink . target_kn = target ; kernfs_get ( target ) ; error = kernfs_add_one ( kn , NULL ) ; if ( ! error ) { return kn ; } kernfs_put ( kn ) ; return ERR_PTR ( error ) ; } 