static int setup_serial ( struct pcmcia_device * handle , struct serial_info * info , unsigned int iobase , int irq ) { struct uart_8250_port uart ; int line ; uart . port . iobase = iobase ; uart . port . irq = irq ; uart . port . flags = UPF_BOOT_AUTOCONF | UPF_SKIP_TEST | UPF_SHARE_IRQ ; uart . port . uartclk = 1843200 ; uart . port . dev = & handle -> dev ; if ( buggy_uart ) { uart . port . flags |= UPF_BUGGY_UART ; } if ( info -> quirk && info -> quirk -> setup ) { info -> quirk -> setup ( handle , & uart ) ; } line = serial8250_register_8250_port ( & uart ) ; if ( line < 0 ) { pr_err ( "serial_cs: serial8250_register_8250_port() at 0x%04lx, irq %d failed\n" , ( unsigned long ) iobase , irq ) ; return - EINVAL ; } info -> line [ info -> ndev ] = line ; info -> ndev ++ ; return 0 ; } 