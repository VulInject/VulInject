Datum koi8r_to_win866 ( PG_FUNCTION_ARGS ) { unsigned char * src = ( unsigned char * ) PG_GETARG_CSTRING ( 2 ) ; unsigned char * dest = ( unsigned char * ) PG_GETARG_CSTRING ( 3 ) ; int len = PG_GETARG_INT32 ( 4 ) ; bool noError = PG_GETARG_BOOL ( 5 ) ; int converted ; CHECK_ENCODING_CONVERSION_ARGS ( PG_KOI8R , PG_WIN866 ) ; converted = local2local ( src , dest , len , PG_KOI8R , PG_WIN866 , koi2win866 , noError ) ; PG_RETURN_INT32 ( converted , NULL ) ; } 