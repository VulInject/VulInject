static int configure_clock ( struct snd_soc_component * component ) { struct snd_soc_dapm_context * dapm = snd_soc_component_get_dapm ( component ) ; struct wm8994_priv * wm8994 = snd_soc_component_get_drvdata ( component ) ; int change ; configure_aif_clock ( component , 0 ) ; configure_aif_clock ( component , 1 ) ; if ( wm8994 -> aifclk [ 0 ] == wm8994 -> aifclk [ 1 ] ) { wm8958_micd_set_rate ( component , NULL ) ; return 0 ; } if ( wm8994 -> aifclk [ 0 ] < wm8994 -> aifclk [ 1 ] ) { new = WM8994_SYSCLK_SRC ; } else { new = 0 ; } change = snd_soc_component_update_bits ( component , WM8994_CLOCKING_1 , WM8994_SYSCLK_SRC , new ) ; if ( change ) { snd_soc_dapm_sync ( dapm ) ; } wm8958_micd_set_rate ( component ) ; return 0 ; } 