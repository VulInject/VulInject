static int BnxeKstatRxRingUpdate ( kstat_t * kstats , int rw ) { BnxeKstatRxq * pStats = ( BnxeKstatRxq * ) kstats -> ks_data ; KstatRingMap * pMap = ( KstatRingMap * ) kstats -> ks_private ; um_device_t * pUM = ( um_device_t * ) pMap -> pUM ; int idx = pMap -> idx ; lm_device_t * pLM = ( lm_device_t * ) pUM ; lm_tx_chain_t * pTxq = & LM_TXQ ( pLM , idx ) ; lm_rx_chain_t * pRxq = & LM_RXQ ( pLM , idx ) ; lm_rcq_chain_t * pRcq = & LM_RCQ ( pLM , idx ) ; BNXE_LOCK_ENTER_STATS ( pUM ) ; pStats -> rxqBdTotal . value . ui64 = pRxq -> chain_arr [ LM_RXQ_CHAIN_IDX_BD ] . capacity ; pStats -> rxqBdLeft . value . ui64 = pRxq -> chain_arr [ LM_RXQ_CHAIN_IDX_BD ] . bd_left ; pStats -> rxqBdPageCnt . value . ui64 = pRxq -> chain_arr [ LM_RXQ_CHAIN_IDX_BD ] . page_cnt ; pStats -> rxqBdsPerPage . value . ui64 = pRxq -> chain_arr [ LM_RXQ_CHAIN_IDX_BD ] . bds_per_page ; pStats -> rxqBdSize . value . ui64 = pRxq -> chain_arr [ LM_RXQ_CHAIN_IDX_BD ] . bd_size ; pStats -> rxqBdsSkipEop . value . ui64 = pRxq -> chain_arr [ LM_RXQ_CHAIN_IDX_BD ] . bds_skip_eop ; pStats -> rxqBdProdIdx . value . ui64 = pRxq -> chain_arr [ LM_RXQ_CHAIN_IDX_BD ] . prod_idx ; pStats -> rxqBdConsIdx . value . ui64 = pRxq -> chain_arr [ LM_RXQ_CHAIN_IDX_BD ] . cons_idx ; pStats -> hwRxqConIdx . value . ui64 = ( pRxq -> hw_con_idx_ptr != NULL ) ?mm_le16_to_cpu ( * pRxq -> hw_con_idx_ptr ) : 0 ; pStats -> sgeBdTotal . value . ui64 = pRxq -> chain_arr [ LM_RXQ_CHAIN_IDX_SGE ] . capacity ; pStats -> sgeBdLeft . value . ui64 = pRxq -> chain_arr [ LM_RXQ_CHAIN_IDX_SGE ] . bd_left ; pStats -> sgeBdPageCnt . value . ui64 = pRxq -> chain_arr [ LM_RXQ_CHAIN_IDX_SGE ] . page_cnt ; pStats -> sgeBdsPerPage . value . ui64 = pRxq -> chain_arr [ LM_RXQ_CHAIN_IDX_SGE ] . bds_per_page ; pStats -> sgeBdSize . value . ui64 = pRxq -> chain_arr [ LM_RXQ_CHAIN_IDX_SGE ] . bd_size ; pStats -> sgeBdsSkipEop . value . ui64 = pRxq -> chain_arr [ LM_RXQ_CHAIN_IDX_SGE ] . bds_skip_eop ; pStats -> sgeBdProdIdx . value . ui64 = pRxq -> chain_arr [ LM_RXQ_CHAIN_IDX_SGE ] . prod_idx ; pStats -> sgeBdConsIdx . value . ui64 = pRxq -> chain_arr [ LM_RXQ_CHAIN_IDX_SGE ] . cons_idx ; pStats -> rcqBdTotal . value . ui64 = pRcq -> bd_chain . capacity ; pStats -> rcqBdLeft . value . ui64 = pRcq -> bd_chain . bd_left ; pStats -> rcqBdPageCnt . value . ui64 = pRcq -> bd_chain . page_cnt ; pStats -> rcqBdsPerPage . value . ui64 = pRcq -> bd_chain . bds_per_page ; pStats -> rcqBdSize . value . ui64 = pRcq -> bd_chain . bd_size ; pStats -> rcqBdsSkipEop . value . ui64 = pRcq -> bd_chain . bds_skip_eop ; pStats -> rcqBdProdIdx . value . ui64 = pRcq -> bd_chain . prod_idx ; pStats -> rcqBdConsIdx . value . ui64 = pRcq -> bd_chain . cons_idx ; pStats -> hwRcqConIdx . value . ui64 = ( pRcq -> hw_con_idx_ptr != NULL ) ?mm_le16_to_cpu ( * pRcq -> hw_con_idx_ptr ) : 0 ; pStats -> rxFreeDescs . value . ui64 = s_list_entry_cnt ( & LM_RXQ ( pLM , idx ) . common . free_descq ) ; pStats -> rxActiveDescs . value . ui64 = s_list_entry_cnt ( & LM_RXQ ( pLM , idx ) . active_descq ) ; pStats -> rxDoneDescs . value . ui64 = s_list_entry_cnt ( & pUM -> rxq [ idx ] . doneRxQ ) ; pStats -> rxWaitingDescs . value . ui64 = s_list_entry_cnt ( & pUM -> rxq [ idx ] . waitRxQ ) ; pStats -> rxCopied . value . ui64 = pUM -> rxq [ idx ] . rxCopied ; pStats -> rxDiscards . value . ui64 = pUM -> rxq [ idx ] . rxDiscards ; pStats -> rxBufUpInStack . value . ui64 = pUM -> rxq [ idx ] . rxBufUpInStack ; pStats -> rxLowWater . value . ui64 = pUM -> rxq [ idx ] . rxLowWater ; pStats -> inPollMode . value . ui64 = pUM -> rxq [ idx ] . inPollMode ; pStats -> pollCnt . value . ui64 = pUM -> rxq [ idx ] . pollCnt ; pStats -> intrDisableCnt . value . ui64 = pUM -> rxq [ idx ] . intrDisableCnt ; pStats -> intrEnableCnt . value . ui64 = pUM -> rxq [ idx ] . intrEnableCnt ; pStats -> genNumber . value . ui64 = pUM -> rxq [ idx ] . genNumber ; BNXE_LOCK_EXIT_STATS ( pUM ) ; return 0 ; } 