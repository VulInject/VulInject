static void test_libbpf_bpf_link_type_str ( void ) { struct btf * btf ; const struct btf_type * t ; const struct btf_enum * e ; int i , n , id ; btf = btf__parse ( "/sys/kernel/btf/vmlinux" , NULL ) ; if ( ! ASSERT_OK_PTR ( btf , "btf_parse" ) ) { return ; } id = btf__find_by_name_kind ( btf , "bpf_link_type" , BTF_KIND_ENUM ) ; if ( ! ASSERT_GT ( id , 0 , "bpf_link_type_id" ) ) { cleanup } t = btf__type_by_id ( btf , id ) ; e = btf_enum ( t ) ; n = btf_vlen ( t ) ; for ( i = 0 ; i < n ; e ++ , i ++ ) { enum bpf_link_type link_type = ( bpf_link_type ) e -> val ; const char * link_type_name ; const char * link_type_str ; char buf [ 256 ] ; if ( link_type == MAX_BPF_LINK_TYPE ) { continue ; } link_type_name = btf__str_by_offset ( btf , e -> name_off ) ; link_type_str = libbpf_bpf_link_type_str ( link_type ) ; ASSERT_OK_PTR ( link_type_str , link_type_name ) ; sprintf ( buf , "BPF_LINK_TYPE_%s" , link_type_str ) ; uppercase ( buf ) ; ASSERT_STREQ ( buf , link_type_name , "exp_str_value" ) ; } cleanup btf__free ( btf ) ; } 