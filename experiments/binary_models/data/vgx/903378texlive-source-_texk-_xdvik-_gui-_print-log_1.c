void printlog_create ( struct save_or_print_info * info , const char * title , const char * close_label ) { Widget printlog_text , printlog_close , printlog_keep , printlog_cancel ; Widget form , paned , box ; char * window_translation_str ; XmString str ; XtTranslations window_override_translations ; char * text_translation_str = NULL ; XtTranslations wm_translations ; XtTranslations window_translations ; window_translation_str = get_string_va ( PRINTLOG_WINDOW_OVERRIDE_TRANSLATIONS , info ) ; window_override_translations = XtParseTranslationTable ( window_translation_str ) ; window_translation_str = get_string_va ( PRINTLOG_WINDOW_TRANSLATIONS , info ) ; window_translations = XtParseTranslationTable ( window_translation_str ) ; free ( window_translation_str ) ; XtAddActions ( printlog_actions , XtNumber ( printlog_actions ) ) ; wm_translations = XtParseTranslationTable ( "<Message>WM_PROTOCOLS: WM_cancel_or_destroy()" ) ; info -> printlog = XtVaCreatePopupShell ( "printlog" , transientShellWidgetClass , globals . widgets . top_level , XtNtitle , title , XtNtransientFor , globals . widgets . top_level , XtNmappedWhenManaged , False , XtNtranslations , wm_translations , XtNtransientFor , globals . widgets . top_level , NULL ) ; WM_DELETE_WINDOW = XInternAtom ( XtDisplay ( info -> printlog ) , "WM_DELETE_WINDOW" , False ) ; XtOverrideTranslations ( info -> printlog , window_translations ) ; paned = XtVaCreateManagedWidget ( "paned" , panedWidgetClass , info -> printlog , NULL ) ; form = XtVaCreateManagedWidget ( "form" , formWidgetClass , paned , XtNdefaultDistance , 6 , NULL ) ; printlog_text = XtVaCreateManagedWidget ( Xdvi_PRINTLOG_TEXT_NAME , asciiTextWidgetClass , form , XtNstring , "" , XtNdataCompression , False , XtNeditType , XawtextAppend , XtNscrollHorizontal , XawtextScrollAlways , XtNscrollVertical , XawtextScrollAlways , XtNwidth , 600 , XtNheight , 400 , XtNleft , XawChainLeft , XtNright , XawChainRight , XtNtop , XawChainTop , XtNbottom , XawChainBottom , NULL ) ; text_translation_str = get_string_va ( PRINTLOG_TEXT_TRANSLATIONS , info , info , info , info , info , info ) ; XtOverrideTranslations ( printlog_text , XtParseTranslationTable ( text_translation_str ) ) ; free ( text_translation_str ) ; printlog_keep = XtVaCreateManagedWidget ( Xdvi_PRINTLOG_KEEP_NAME , radioWidgetClass , toggleWidgetClass , form , XtNlabel , close_label , XtNborderWidth , 0 , XtNisRadio , False , XtNhighlightThickness , 1 , XtNfromVert , printlog_text , XtNleft , XawChainLeft , XtNright , XawChainLeft , XtNtop , XawChainBottom , XtNbottom , XawChainBottom , NULL ) ; XtVaSetValues ( printlog_keep , XtNstate , resource . dvips_hang > 0 && resource . dvips_fail_hang > 0 , NULL ) ; XtAddCallback ( printlog_keep , XtNcallback , info -> callbacks -> cb_keep , ( XtPointer ) info ) ; box = XtVaCreateManagedWidget ( "box" , formWidgetClass , paned , XtNshowGrip , False , XtNdefaultDistance , 6 , XtNskipAdjust , True , XtNaccelerators , G_accels_cr , NULL ) ; printlog_close = XtVaCreateManagedWidget ( Xdvi_PRINTLOG_CLOSE_NAME , commandWidgetClass , box , XtNlabel , "Close" , XtNsensitive , False , XtNleft , XawChainLeft , XtNright , XawChainLeft , XtNtop , XawChainBottom , XtNbottom , XawChainBottom , NULL ) ; XtAddCallback ( printlog_close , XtNcallback , info -> callbacks -> cb_close , ( XtPointer ) info ) ; printlog_cancel = XtVaCreateManagedWidget ( Xdvi_PRINTLOG_CANCEL_NAME , commandWidgetClass , box , XtNlabel , "Cancel" , XtNfromHoriz , printlog_keep , XtNleft , XawChainRight , XtNright , XawChainRight , XtNtop , XawChainBottom , XtNbottom , XawChainBottom , NULL ) ; XtAddCallback ( printlog_cancel , XtNcallback , info -> callbacks -> cb_cancel , ( XtPointer ) info ) ; XtManageChild ( info -> printlog ) ; printlog_enable_cancelbutton ( info ) ; info -> printlog = XtVaCreatePopupShell ( "printlog" , xmDialogShellWidgetClass , globals . widgets . top_level , XmNdeleteResponse , XmDO_NOTHING , XmNtitle , title , XtNmappedWhenManaged , False , XmNtranslations , window_override_translations , NULL ) ; WM_DELETE_WINDOW = XmInternAtom ( XtDisplay ( info -> printlog ) , "WM_DELETE_WINDOW" , False ) ; XmAddWMProtocolCallback ( info -> printlog , WM_DELETE_WINDOW , cb_printlog_act_cancel_or_destroy , ( XtPointer ) info ) ; paned = XtVaCreateWidget ( "printlog_pane" , xmPanedWindowWidgetClass , info -> printlog , XmNsashWidth , 1 , XmNsashHeight , 1 , XmNtranslations , window_override_translations , NULL ) ; form = XtVaCreateWidget ( "form" , xmFormWidgetClass , paned , XmNhorizontalSpacing , DDIST , XmNverticalSpacing , DDIST , XmNautoUnmanage , False , XmNtranslations , window_override_translations , NULL ) ; { Arg args [ 10 ] ; int n = 0 ; XtSetArg ( args [ n ] , XmNeditMode , XmMULTI_LINE_EDIT ) ; n ++ ; XtSetArg ( args [ n ] , XmNeditable , False ) ; n ++ ; XtSetArg ( args [ n ] , XmNrows , 24 ) ; n ++ ; XtSetArg ( args [ n ] , XmNcolumns , 80 ) ; n ++ ; printlog_text = XmCreateScrolledText ( form , Xdvi_PRINTLOG_TEXT_NAME , args , n ) ; } XtVaSetValues ( XtParent ( printlog_text ) , XmNtopAttachment , XmATTACH_FORM , XmNleftAttachment , XmATTACH_FORM , XmNrightAttachment , XmATTACH_FORM , XmNtranslations , window_override_translations , NULL ) ; XtManageChild ( printlog_text ) ; str = XmStringCreateLocalized ( ( char * ) close_label ) ; printlog_keep = XtVaCreateManagedWidget ( Xdvi_PRINTLOG_KEEP_NAME , xmToggleButtonGadgetClass , form , XmNlabelString , str , XmNindicatorType , XmN_OF_MANY , XmNnavigationType , XmTAB_GROUP , XmNtopAttachment , XmATTACH_WIDGET , XmNtopWidget , XtParent ( printlog_text ) , XmNleftAttachment , XmATTACH_FORM , XmNtranslations , window_override_translations , NULL ) ; XmStringFree ( str ) ; XtAddCallback ( printlog_keep , XmNvalueChangedCallback , info -> callbacks -> cb_keep , ( XtPointer ) info ) ; XmToggleButtonGadgetSetState ( printlog_keep , resource . dvips_hang > 0 && resource . dvips_fail_hang > 0 , False ) ; box = XtVaCreateManagedWidget ( "box" , xmFormWidgetClass , paned , NULL ) ; str = XmStringCreateLocalized ( "Close" ) ; printlog_close = XtVaCreateManagedWidget ( Xdvi_PRINTLOG_CLOSE_NAME , xmPushButtonWidgetClass , box , XmNlabelString , str , XmNshowAsDefault , True , XmNsensitive , False , XmNdefaultButtonShadowThickness , 1 , XmNtopAttachment , XmATTACH_FORM , XmNbottomAttachment , XmATTACH_FORM , XmNleftAttachment , XmATTACH_FORM , XmNmarginWidth , 6 , XmNmarginHeight , 4 , XmNtopOffset , 10 , XmNbottomOffset , 10 , XmNleftOffset , 10 , XmNtranslations , window_override_translations , NULL ) ; XmStringFree ( str ) ; XtAddCallback ( printlog_close , XmNactivateCallback , info -> callbacks -> cb_close , ( XtPointer ) info ) ; XtOverrideTranslations ( printlog_close , XtParseTranslationTable ( "<Key>Return:ArmAndActivate()\n" ) ) ; str = XmStringCreateLocalized ( "Cancel" ) ; printlog_cancel = XtVaCreateManagedWidget ( Xdvi_PRINTLOG_CANCEL_NAME , xmPushButtonWidgetClass , box , XmNlabelString , str , XmNdefaultButtonShadowThickness , 1 , XmNtopAttachment , XmATTACH_FORM , XmNbottomAttachment , XmATTACH_FORM , XmNrightAttachment , XmATTACH_FORM , XmNmarginWidth , 6 , XmNmarginHeight , 4 , XmNtopOffset , 10 , XmNbottomOffset , 10 , XmNrightOffset , 10 , XmNtranslations , window_override_translations , NULL ) ; XmStringFree ( str ) ; XtAddCallback ( printlog_cancel , XmNactivateCallback , info -> callbacks -> cb_cancel , ( XtPointer ) info ) ; XtOverrideTranslations ( printlog_close , XtParseTranslationTable ( "<Key>Return:ArmAndActivate()\n" ) ) ; XtManageChild ( box ) ; XtManageChild ( form ) ; XtManageChild ( paned ) ; printlog_enable_cancelbutton ( info ) ; adjust_width ( printlog_close , printlog_cancel ) ; } 