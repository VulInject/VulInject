int do_mac ( struct cmd_tbl * cmdtp , int flag , int argc , char * const argv [ ] ) { char * cmd ; if ( argc == 1 ) { show_eeprom ( ) ; return 0 ; } if ( argc > 3 ) { return cmd_usage ( cmdtp ) ; } cmd = argv [ 1 ] ; if ( ! strcmp ( cmd , "read_eeprom" ) ) { read_eeprom ( ) ; return 0 ; } if ( ! strcmp ( cmd , "initialize" ) ) { init_local_copy ( ) ; return 0 ; } if ( ! strcmp ( cmd , "write_eeprom" ) ) { prog_eeprom ( ) ; return 0 ; } if ( argc != 3 ) { return cmd_usage ( cmdtp ) ; } if ( ! is_match_magic ( ) ) { printf ( "Please read the EEPROM ('read_eeprom') and/or initialize the EEPROM ('initialize') first.\n" ) ; return 0 ; } if ( ! strcmp ( cmd , "manuf_test_status" ) ) { set_manuf_test_status ( argv [ 2 ] ) ; return 0 ; } if ( ! strcmp ( cmd , "mac_address" ) ) { set_mac_address ( argv [ 2 ] ) ; return 0 ; } if ( ! strcmp ( cmd , "pcb_revision" ) ) { set_pcb_revision ( argv [ 2 ] ) ; return 0 ; } if ( ! strcmp ( cmd , "bom_variant" ) ) { set_bom_variant ( argv [ 2 ] ) ; return 0 ; } if ( ! strcmp ( cmd , "bom_revision" ) ) { set_bom_revision ( argv [ 2 ] ) ; return 0 ; } if ( ! strcmp ( cmd , "product_id" ) ) { set_product_id ( argv [ 2 ] , NULL ) ; return 0 ; } return cmd_usage ( cmdtp ) ; } 