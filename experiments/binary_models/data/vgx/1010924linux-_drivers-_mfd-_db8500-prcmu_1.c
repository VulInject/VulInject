static void set_dsiclk_rate ( u8 n , unsigned long rate ) { u32 val ; u32 div ; div = clock_divider ( pll_rate ( PRCM_PLLDSI_FREQ , clock_rate ( PRCMU_HDMICLK ) , PLL_RAW ) , rate ) ; dsiclk [ n ] . divsel = ( div == 1 ) ?PRCM_DSI_PLLOUT_SEL_PHI : ( div == 2 ) ?PRCM_DSI_PLLOUT_SEL_PHI_2 : PRCM_DSI_PLLOUT_SEL_PHI_4 ; val = readl ( PRCM_DSI_PLLOUT_SEL , NULL ) ; val &= ~ dsiclk [ n ] . divsel_mask ; val |= ( dsiclk [ n ] . divsel << dsiclk [ n ] . divsel_shift ) ; writel ( val , PRCM_DSI_PLLOUT_SEL ) ; } 