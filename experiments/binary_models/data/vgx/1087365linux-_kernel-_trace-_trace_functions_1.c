static int function_trace_init ( struct trace_array * tr ) { ftrace_func_t func ; if ( ! tr -> ops ) { return - ENOMEM ; } func = select_trace_function ( func_flags . val ) ; if ( ! handle_func_repeats ( tr , func_flags . val ) ) { return - ENOMEM ; } ftrace_init_array_ops ( tr , func ) ; tr -> array_buffer . cpu = raw_smp_processor_id ( ) ; tracing_start_cmdline_record ( ) ; tracing_start_function_trace ( tr ) ; return 0 ; } 