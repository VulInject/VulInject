static int _set_cond ( int * start , int argc , char * * argv , slurmdb_reservation_cond_t * reservation_cond , List format_list ) { int i ; int set = 0 ; int end = 0 ; int command_len = 0 ; if ( ! reservation_cond ) { exit_code = 1 ; fprintf ( stderr , "No reservation_cond given" ) ; return - 1 ; } for ( i = ( * start ) ; i < argc ; i ++ ) { end = parse_option_end ( argv [ i ] ) ; if ( ! end ) { command_len = strlen ( argv [ i ] ) ; } else { command_len = end - 1 ; if ( argv [ i ] [ end ] == '=' ) { end ++ ; } } if ( ! xstrncasecmp ( argv [ i ] , "Set" , MAX ( command_len , 3 ) ) ) { i -- ; break ; } if ( ! end && ! xstrncasecmp ( argv [ i ] , "where" , MAX ( command_len , 5 ) ) ) { continue ; } if ( ! xstrncasecmp ( argv [ i ] , "Clusters" , MAX ( command_len , 1 ) ) ) { if ( ! reservation_cond -> cluster_list ) { reservation_cond -> cluster_list = list_create ( xfree_ptr ) ; } if ( slurm_addto_char_list ( reservation_cond -> cluster_list , argv [ i ] + end ) ) { set = 1 ; } } if ( ! xstrncasecmp ( argv [ i ] , "End" , MAX ( command_len , 1 ) ) ) { reservation_cond -> time_end = parse_time ( argv [ i ] + end , 1 ) ; if ( errno == ESLURM_INVALID_TIME_VALUE ) { exit_code = 1 ; } else { set = 1 ; } } if ( ! xstrncasecmp ( argv [ i ] , "Format" , MAX ( command_len , 1 ) ) ) { if ( format_list ) { slurm_addto_char_list ( format_list , argv [ i ] + end ) ; } } if ( ! xstrncasecmp ( argv [ i ] , "Ids" , MAX ( command_len , 1 ) ) ) { if ( ! reservation_cond -> id_list ) { reservation_cond -> id_list = list_create ( xfree_ptr ) ; } if ( slurm_addto_char_list ( reservation_cond -> id_list , argv [ i ] + end ) ) { set = 1 ; } } if ( ! xstrncasecmp ( argv [ i ] , "Names" , MAX ( command_len , 2 ) ) ) { if ( ! reservation_cond -> name_list ) { reservation_cond -> name_list = list_create ( xfree_ptr ) ; } if ( slurm_addto_char_list ( reservation_cond -> name_list , argv [ i ] + end ) ) { set = 1 ; } } if ( ! xstrncasecmp ( argv [ i ] , "Nodes" , MAX ( command_len , 2 ) ) ) { reservation_cond -> nodes = strip_quotes ( argv [ i ] + end , NULL , 1 ) ; set = 1 ; } if ( ! xstrncasecmp ( argv [ i ] , "Start" , MAX ( command_len , 5 ) ) ) { reservation_cond -> time_start = parse_time ( argv [ i ] + end , 1 ) ; if ( errno == ESLURM_INVALID_TIME_VALUE ) { exit_code = 1 ; } else { set = 1 ; } } else { exit_code = 1 ; fprintf ( stderr , " Unknown condition: %s\n" " Use keyword 'set' to modify value\n" , argv [ i ] ) ; } } ( * start ) = i ; if ( set ) { return 1 ; } return 0 ; } 