static void quirk_uli5288 ( struct pci_dev * dev ) { unsigned char c ; unsigned int d ; pci_read_config_byte ( dev , 0x83 , & c ) ; pci_write_config_byte ( dev , 0x83 , c | 0x80 ) ; pci_read_config_dword ( dev , PCI_CLASS_REVISION , & d ) ; d = ( d & 0xff ) | ( PCI_CLASS_STORAGE_SATA_AHCI << 8 ) ; pci_write_config_dword ( dev , PCI_CLASS_REVISION , d ) ; pci_write_config_byte ( dev , 0x83 , c ) ; pci_read_config_byte ( dev , 0x84 , & c ) ; pci_write_config_byte ( dev , 0x84 , c & ~ 0x01 ) ; } 