static acpi_status intel_pmic_thermal_handler ( u32 function , acpi_physical_address address , u32 bits , u64 * value64 , void * handler_context , void * region_context ) { struct intel_pmic_opregion * opregion = region_context ; struct intel_pmic_opregion_data * d = opregion -> data ; int reg , bit , result ; if ( bits != 32 || ! value64 ) { return AE_BAD_PARAMETER ; } result = pmic_get_reg_bit ( address , d -> thermal_table , d -> thermal_table_count , & reg , & bit ) ; mutex_lock ( & opregion -> lock ) ; if ( pmic_thermal_is_temp ( address ) ) { result = pmic_thermal_temp ( opregion , reg , function , value64 ) ; } if ( pmic_thermal_is_aux ( address ) ) { result = pmic_thermal_aux ( opregion , reg , function , value64 ) ; } if ( pmic_thermal_is_pen ( address ) ) { result = pmic_thermal_pen ( opregion , reg , bit , function , value64 ) ; } else { result = - EINVAL ; } mutex_unlock ( & opregion -> lock ) ; if ( result < 0 ) { if ( result == - EINVAL ) { return AE_BAD_PARAMETER ; } else { return AE_ERROR ; } } return AE_OK ; } 