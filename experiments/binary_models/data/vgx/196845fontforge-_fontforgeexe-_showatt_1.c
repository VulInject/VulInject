static void BuildGSUBscript ( struct node * node , struct att_dlg * att ) { SplineFont * sf = att -> sf ; int lang_max ; int i , j ; struct node * langnodes ; uint32_t * langlist ; extern GTextInfo languages [ ] ; char buf [ 100 ] ; int isgpos = node -> parent -> tag == CHR ( 'G' , 'P' , 'O' , 'S' ) ; langlist = SFLangsInScript ( sf , isgpos , node -> tag ) ; for ( j = 0 ; langlist [ j ] != 0 ; ++ j ) { } lang_max = j ; langnodes = calloc ( lang_max + 1 , sizeof ( node ) ) ; for ( i = 0 ; langlist [ i ] != 0 ; ++ i ) { langnodes [ i ] . tag = langlist [ i ] ; } for ( i = 0 ; i < lang_max ; ++ i ) { for ( j = 0 ; languages [ j ] . text != NULL && langnodes [ i ] . tag != ( uint32_t ) ( intptr_t ) languages [ j ] . userdata ; ++ j ) { } buf [ 0 ] = '\'' ; buf [ 1 ] = langnodes [ i ] . tag >> 24 ; buf [ 2 ] = ( langnodes [ i ] . tag >> 16 ) & 0xff ; buf [ 3 ] = ( langnodes [ i ] . tag >> 8 ) & 0xff ; buf [ 4 ] = langnodes [ i ] . tag & 0xff ; buf [ 5 ] = '\'' ; buf [ 6 ] = ' ' ; if ( languages [ j ] . text != NULL ) { strcpy ( buf + 7 , S_ ( ( char * ) languages [ j ] . text ) ) ; strcat ( buf , " " ) ; } else { buf [ 7 ] = '\0' ; } strcat ( buf , _ ( "Language" ) ) ; langnodes [ i ] . label = copy ( buf ) ; langnodes [ i ] . build = BuildGSUBlang ; langnodes [ i ] . parent = node ; } node -> children = langnodes ; node -> cnt = i ; } 