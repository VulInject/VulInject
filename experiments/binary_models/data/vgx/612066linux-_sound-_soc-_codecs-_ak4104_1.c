static int ak4104_set_dai_fmt ( struct snd_soc_dai * codec_dai , unsigned int format ) { struct snd_soc_component * component = codec_dai -> component ; struct ak4104_private * ak4104 = snd_soc_component_get_drvdata ( component ) ; int val = 0 ; int ret ; switch ( format & SND_SOC_DAIFMT_FORMAT_MASK ) { case SND_SOC_DAIFMT_RIGHT_J : break ; case SND_SOC_DAIFMT_LEFT_J : val |= AK4104_CONTROL1_DIF0 ; break ; case SND_SOC_DAIFMT_I2S : val |= AK4104_CONTROL1_DIF0 | AK4104_CONTROL1_DIF1 ; break ; default : dev_err ( component -> dev , "invalid dai format\n" ) ; return - EINVAL ; } if ( ( format & SND_SOC_DAIFMT_CLOCK_PROVIDER_MASK ) != SND_SOC_DAIFMT_CBC_CFC ) { return - EINVAL ; } ret = regmap_update_bits ( ak4104 -> regmap , AK4104_REG_CONTROL1 , AK4104_CONTROL1_DIF0 | AK4104_CONTROL1_DIF1 , val ) ; return 0 ; } 