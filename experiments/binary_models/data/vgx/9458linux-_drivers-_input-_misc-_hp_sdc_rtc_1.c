static int64_t hp_sdc_rtc_read_i8042timer ( uint8_t loadcmd , int numreg ) { hp_sdc_transaction t ; uint8_t tseq [ 26 ] { HP_SDC_ACT_PRECMD | HP_SDC_ACT_POSTCMD | HP_SDC_ACT_DATAIN 0 HP_SDC_CMD_READ_T1 2 0 0 HP_SDC_ACT_POSTCMD | HP_SDC_ACT_DATAIN HP_SDC_CMD_READ_T2 2 0 0 HP_SDC_ACT_POSTCMD | HP_SDC_ACT_DATAIN HP_SDC_CMD_READ_T3 2 0 0 HP_SDC_ACT_POSTCMD | HP_SDC_ACT_DATAIN HP_SDC_CMD_READ_T4 2 0 0 HP_SDC_ACT_POSTCMD | HP_SDC_ACT_DATAIN HP_SDC_CMD_READ_T5 2 0 0 } ; ; t . endidx = numreg * 5 ; tseq [ 1 ] = loadcmd ; tseq [ t . endidx - 4 ] |= HP_SDC_ACT_SEMAPHORE ; t . seq = tseq ; t . act . semaphore = & i8042tregs ; if ( hp_sdc_enqueue_transaction ( & t ) ) { up ( & i8042tregs ) ; return - 1 ; } if ( WARN_ON ( down_interruptible ( & i8042tregs ) ) ) { return - 1 ; } up ( & i8042tregs ) ; return ( tseq [ 5 ] | ( ( uint64_t ) ( tseq [ 10 ] ) << 8 ) | ( ( uint64_t ) ( tseq [ 15 ] ) << 16 ) | ( ( uint64_t ) ( tseq [ 20 ] ) << 24 ) | ( ( uint64_t ) ( tseq [ 25 ] ) << 32 ) ) ; } 