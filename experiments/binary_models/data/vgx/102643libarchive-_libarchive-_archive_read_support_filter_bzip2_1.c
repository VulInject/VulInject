static int bzip2_reader_bid ( struct archive_read_filter_bidder * self , struct archive_read_filter * filter ) { const unsigned char * buffer ; ssize_t avail ; int bits_checked ; ( void ) self ; buffer = __archive_read_filter_ahead ( filter , 14 , & avail ) ; bits_checked = 0 ; if ( memcmp ( buffer , "BZh" , 3 ) != 0 ) { return ( 0 ) ; } bits_checked += 24 ; if ( buffer [ 3 ] < '1' || buffer [ 3 ] > '9' ) { return ( 0 ) ; } bits_checked += 5 ; if ( memcmp ( buffer + 4 , "\x31\x41\x59\x26\x53\x59" , 6 ) == 0 ) { bits_checked += 48 ; } if ( memcmp ( buffer + 4 , "\x17\x72\x45\x38\x50\x90" , 6 ) == 0 ) { bits_checked += 48 ; } else { return ( 0 ) ; } return ( bits_checked ) ; } 