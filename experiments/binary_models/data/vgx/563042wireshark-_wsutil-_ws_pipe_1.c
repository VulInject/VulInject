static gchar * convert_to_command_line ( gchar * * argv ) { GString * command_line = g_string_sized_new ( 200 ) ; gchar * quoted_arg = protect_arg ( argv [ 0 ] ) ; if ( quoted_arg [ 0 ] != '"' ) { g_string_append_c ( command_line , '"' ) ; g_string_append ( command_line , quoted_arg ) ; g_string_append_c ( command_line , '"' ) ; } else { g_string_append ( command_line , quoted_arg ) ; } for ( int i = 1 ; argv [ i ] ; i ++ ) { quoted_arg = protect_arg ( argv [ i ] ) ; g_string_append_c ( command_line , ' ' ) ; g_string_append ( command_line , quoted_arg ) ; g_free ( quoted_arg ) ; } for ( int i = 0 ; argv [ i ] ; i ++ ) { gchar * quoted_arg = g_shell_quote ( argv [ i ] ) ; if ( i != 0 ) { g_string_append_c ( command_line , ' ' ) ; } g_string_append ( command_line , quoted_arg ) ; g_free ( quoted_arg ) ; } return g_string_free ( command_line , FALSE ) ; } 