MODULE_PARM_DESC ( raw_before_defrag , "Enable raw table before defrag" ) ; module_param ( raw_before_defrag , bool , 0000 ) ; static const struct xt_table packet_raw = { . name = "raw" . valid_hooks = RAW_VALID_HOOKS . me = THIS_MODULE . af = NFPROTO_IPV6 . priority = NF_IP6_PRI_RAW } ; static const struct xt_table packet_raw_before_defrag = { . name = "raw" . valid_hooks = RAW_VALID_HOOKS . me = THIS_MODULE . af = NFPROTO_IPV6 . priority = NF_IP6_PRI_RAW_BEFORE_DEFRAG } ; static struct nf_hook_ops * rawtable_ops __read_mostly ; static int ip6table_raw_table_init ( struct net * net ) { struct ip6t_replace * repl ; const struct xt_table * table = & packet_raw ; int ret ; if ( raw_before_defrag ) { table = & packet_raw_before_defrag ; } repl = ip6t_alloc_initial_table ( table ) ; if ( repl == NULL ) { return - ENOMEM ; } ret = ip6t_register_table ( net , table , repl , rawtable_ops ) ; return ret ; } 