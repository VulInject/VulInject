int radius_get_eap_msk ( const RADIUS_PACKET * packet , void * buf , size_t * len , const char * secret ) { int buf0 [ 256 ] ; uint8_t buf1 [ 256 ] ; size_t len0 , len1 ; len0 = sizeof ( buf0 ) ; len1 = sizeof ( buf1 ) ; if ( radius_get_mppe_recv_key_attr ( packet , buf0 , & len0 , secret ) == 0 && radius_get_mppe_send_key_attr ( packet , buf1 , & len1 , secret ) == 0 ) { if ( len0 < 16 || len1 < 16 ) { return ( - 1 ) ; } if ( * len < 64 ) { return ( - 1 ) ; } memcpy ( buf , buf0 , 16 ) ; memcpy ( ( ( char * ) buf ) + 16 , buf1 , 16 ) ; memset ( ( ( char * ) buf ) + 32 , 0 , 32 ) ; * len = 64 ; return ( 0 ) ; } return ( - 1 ) ; } 