static int ionic_qcqs_alloc ( struct ionic_lif * lif ) { struct device * dev = lif -> ionic -> dev ; unsigned int flags ; int err ; flags = IONIC_QCQ_F_INTR ; err = ionic_qcq_alloc ( lif , IONIC_QTYPE_ADMINQ , 0 , "admin" , flags , IONIC_ADMINQ_LENGTH , sizeof ( ionic_admin_cmd ) , sizeof ( ionic_admin_comp ) , 0 , lif -> kern_pid , & lif -> adminqcq ) ; ionic_debugfs_add_qcq ( lif , lif -> adminqcq ) ; if ( lif -> ionic -> nnqs_per_lif ) { flags = IONIC_QCQ_F_NOTIFYQ ; err = ionic_qcq_alloc ( lif , IONIC_QTYPE_NOTIFYQ , 0 , "notifyq" , flags , IONIC_NOTIFYQ_LENGTH , sizeof ( ionic_notifyq_cmd ) , sizeof ( ionic_notifyq_comp ) , 0 , lif -> kern_pid , & lif -> notifyqcq ) ; if ( err ) { err_out } ionic_debugfs_add_qcq ( lif , lif -> notifyqcq ) ; ionic_link_qcq_interrupts ( lif -> adminqcq , lif -> notifyqcq ) ; } err = - ENOMEM ; lif -> txqcqs = devm_kcalloc ( dev , lif -> ionic -> ntxqs_per_lif , sizeof ( * lif -> txqcqs ) , GFP_KERNEL ) ; if ( ! lif -> txqcqs ) { err_out } lif -> rxqcqs = devm_kcalloc ( dev , lif -> ionic -> nrxqs_per_lif , sizeof ( * lif -> rxqcqs ) , GFP_KERNEL ) ; if ( ! lif -> rxqcqs ) { err_out } lif -> txqstats = devm_kcalloc ( dev , lif -> ionic -> ntxqs_per_lif + 1 , sizeof ( * lif -> txqstats ) , GFP_KERNEL ) ; if ( ! lif -> txqstats ) { err_out } lif -> rxqstats = devm_kcalloc ( dev , lif -> ionic -> nrxqs_per_lif + 1 , sizeof ( * lif -> rxqstats ) , GFP_KERNEL ) ; if ( ! lif -> rxqstats ) { err_out } return 0 ; err_out ionic_qcqs_free ( lif ) ; return err ; } 