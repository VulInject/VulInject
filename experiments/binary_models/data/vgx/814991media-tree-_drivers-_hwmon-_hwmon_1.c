static struct attribute * * __hwmon_create_attrs ( struct device * dev , const void * drvdata , const struct hwmon_chip_info * chip ) { int ret , i , aindex = 0 , nattrs = 0 ; struct attribute * * attrs ; for ( i = 0 ; chip -> info [ i ] ; i ++ ) { nattrs += hwmon_num_channel_attrs ( chip -> info [ i ] ) ; } attrs = devm_kcalloc ( dev , nattrs + 1 , sizeof ( * attrs ) , GFP_KERNEL ) ; if ( ! attrs ) { return ERR_PTR ( - ENOMEM ) ; } for ( i = 0 ; chip -> info [ i ] ; i ++ ) { ret = hwmon_genattrs ( dev , drvdata , & attrs [ aindex ] , chip -> ops , chip -> info [ i ] ) ; if ( ret < 0 ) { return ERR_PTR ( ret ) ; } aindex += ret ; } return attrs ; } 