PHP_FUNCTION ( ) { struct passwd * pw ; char * name ; size_t name_len ; struct passwd pwbuf ; long buflen ; char * buf ; ZEND_PARSE_PARAMETERS_START ( 1 , 1 ) Z_PARAM_STRING ( , ) ZEND_PARSE_PARAMETERS_END ( ) ; buflen = sysconf ( _SC_GETPW_R_SIZE_MAX ) ; if ( buflen < 1 ) { RETURN_FALSE ; } buf = emalloc ( buflen ) ; pw = & pwbuf ; try_again if ( getpwnam_r ( name , pw , buf , buflen , & pw ) || pw == NULL ) { if ( errno == ERANGE ) { buflen *= 2 ; buf = erealloc ( buf , buflen ) ; try_again } POSIX_G ( last_error ) = errno ; RETURN_FALSE ; } if ( NULL == ( pw = getpwnam ( name ) ) ) { POSIX_G ( last_error ) = errno ; RETURN_FALSE ; } array_init ( return_value ) ; if ( ! php_posix_passwd_to_array ( pw , return_value ) ) { zend_array_destroy ( Z_ARR_P ( return_value ) ) ; php_error_docref ( NULL , E_WARNING , "Unable to convert posix passwd struct to array" ) ; RETVAL_FALSE ; } efree ( buf ) ; } 