static struct filter_type * add_filter_type ( struct event_filter * filter , int id ) { struct filter_type * filter_type ; int i ; filter_type = find_filter_type ( filter , id ) ; if ( filter_type ) { return filter_type ; } filter_type = realloc ( filter -> event_filters , sizeof ( * filter -> event_filters ) * ( filter -> filters + 1 ) ) ; if ( ! filter_type ) { return in ; } filter -> event_filters = filter_type ; for ( i = 0 ; i < filter -> filters ; i ++ ) { if ( filter -> event_filters [ i ] . event_id > id ) { break ; } } if ( i < filter -> filters ) { memmove ( & filter -> event_filters [ i + 1 ] , & filter -> event_filters [ i ] , sizeof ( * filter -> event_filters ) * ( filter -> filters - i ) ) ; } filter_type = & filter -> event_filters [ i ] ; filter_type -> event_id = id ; filter_type -> event = pevent_find_event ( filter -> pevent , id ) ; filter_type -> filter = NULL ; filter -> filters ++ ; return filter_type ; } 