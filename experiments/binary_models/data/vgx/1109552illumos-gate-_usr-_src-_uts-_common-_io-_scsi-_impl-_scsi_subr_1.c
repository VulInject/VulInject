char * scsi_get_device_type_string ( char * prop_name , dev_info_t * dip , struct scsi_device * devp ) { struct scsi_inquiry * inq = devp -> sd_inq ; char * * tuples ; uint_t ntuples ; int i ; char * tvp ; char * trs ; int tvp_len ; { if ( ddi_prop_lookup_string_array ( DDI_DEV_T_ANY , dip , ( ddi_get_parent ( dip ) ?DDI_PROP_DONTPASS : 0 ) | DDI_PROP_NOTPROM , prop_name , & tuples , & ntuples ) == DDI_PROP_SUCCESS ) { for ( i = 0 ; i < ( ntuples / 2 ) ; i ++ ) { tvp = tuples [ i * 2 ] ; trs = tuples [ ( i * 2 ) + 1 ] ; tvp_len = strlen ( tvp ) ; if ( ( tvp_len == 0 ) || bcmp ( tvp , inq -> inq_vid , tvp_len ) ) { continue ; } trs = i_ddi_strdup ( trs , KM_SLEEP ) ; ddi_prop_free ( tuples ) ; return ( trs ) ; } ddi_prop_free ( tuples ) ; } dip = ddi_get_parent ( dip ) ; } dip ; return ( NULL ) ; } 