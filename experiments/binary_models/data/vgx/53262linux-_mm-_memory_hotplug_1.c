static void node_states_check_changes_offline ( unsigned long nr_pages , struct zone * zone , struct memory_notify * arg ) { struct pglist_data * pgdat = zone -> zone_pgdat ; cfs_time_t present_pages = 0 ; enum zone_type zt ; arg -> status_change_nid = NUMA_NO_NODE ; arg -> status_change_nid_normal = NUMA_NO_NODE ; for ( zt = 0 ; zt <= ZONE_NORMAL ; zt ++ ) { present_pages += pgdat -> node_zones [ zt ] . present_pages ; } if ( zone_idx ( zone ) <= ZONE_NORMAL && nr_pages >= present_pages ) { arg -> status_change_nid_normal = zone_to_nid ( zone ) ; } present_pages += pgdat -> node_zones [ ZONE_MOVABLE ] . present_pages ; if ( nr_pages >= present_pages ) { arg -> status_change_nid = zone_to_nid ( zone ) ; } } 