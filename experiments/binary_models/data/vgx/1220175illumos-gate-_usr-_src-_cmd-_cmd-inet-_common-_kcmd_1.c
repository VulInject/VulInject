static int VAR1 = ( VAR2 + 8 ) ; static char * VAR3 = VAR4 ; static krb5_data VAR5 , VAR6 ; static boolean_t VAR7 = VAR8 ; static krb5_context VAR9 ; static boolean_t VAR10 = VAR8 ; static krb5_data VAR11 [ 2 ] , VAR12 [ 2 ] ; static krb5_keyusage VAR13 [ 2 ] , VAR14 [ 2 ] ; static krb5_enctype VAR15 ; static VAR16 * VAR17 ; int FUN1 ( int * VAR18 , char * * VAR19 , ushort_t VAR20 , char * VAR21 , char * VAR22 , char * VAR23 , int * VAR24 , char * VAR25 , char * VAR26 , krb5_context VAR27 , VAR28 * VAR29 , VAR30 * * VAR31 , VAR32 * VAR33 , VAR32 * VAR34 , krb5_flags VAR35 , int VAR36 , enum VAR37 * VAR38 ) { int VAR39 = - 1 ; sigset_t VAR40 , VAR41 ; struct sockaddr_in VAR42 ; struct sockaddr_storage VAR43 ; VAR30 * VAR44 = NULL ; VAR30 * VAR45 = NULL ; char VAR46 ; struct VAR47 * VAR48 ; int VAR49 ; char * VAR50 = NULL ; krb5_error_code VAR51 ; VAR52 * VAR53 ; VAR54 * VAR55 = 0 ; krb5_ccache VAR56 ; krb5_data VAR57 ; krb5_flags VAR58 = VAR35 ; krb5_auth_context VAR59 = NULL ; char * VAR60 ; krb5_data VAR61 ; int VAR62 = 0 ; char * VAR63 ; enum kcmd_proto VAR64 = * VAR38 ; VAR62 = strlen ( VAR23 ) + strlen ( VAR22 ) + 64 ; if ( ( VAR60 = malloc ( VAR62 ) ) == 0 ) { ( void ) fprintf ( VAR65 , FUN2 ( "" "" ) ) ; return ( - 1 ) ; } ( void ) snprintf ( VAR60 , VAR62 , "" , FUN3 ( VAR20 ) ) ; if ( FUN4 ( VAR60 , VAR23 , VAR62 ) >= VAR62 ) { ( void ) fprintf ( VAR65 , FUN2 ( "" ) ) ; return ( - 1 ) ; } if ( FUN4 ( VAR60 , VAR22 , VAR62 ) >= VAR62 ) { ( void ) fprintf ( VAR65 , FUN2 ( "" ) ) ; free ( VAR60 ) ; return ( - 1 ) ; } VAR61 . VAR66 = VAR60 ; VAR61 . VAR67 = strlen ( VAR60 ) ; VAR48 = FUN5 ( * VAR19 ) ; if ( VAR48 == 0 ) { ( void ) fprintf ( VAR65 , FUN2 ( "" ) , * VAR19 ) ; return ( - 1 ) ; } if ( ( VAR50 = ( char * ) strdup ( VAR48 -> VAR68 ) ) == NULL ) { ( void ) fprintf ( VAR65 , FUN2 ( "" ) ) ; return ( - 1 ) ; } if ( ! VAR25 ) { VAR25 = VAR69 ; } if ( ! ( VAR44 = ( VAR30 * ) calloc ( 1 , sizeof ( VAR30 ) ) ) ) { ( void ) fprintf ( VAR65 , FUN2 ( "" ) ) ; return ( - 1 ) ; } ( void ) FUN6 ( & VAR41 ) ; ( void ) FUN7 ( & VAR41 , VAR70 ) ; ( void ) FUN8 ( VAR71 , & VAR41 , & VAR40 ) ; VAR51 = FUN9 ( VAR27 , VAR50 , VAR25 , VAR72 , & VAR44 -> VAR73 ) ; if ( VAR51 ) { ( void ) fprintf ( VAR65 , FUN2 ( "" "" ) , FUN10 ( VAR51 ) ) ; VAR51 = - 1 ; VAR74 } if ( VAR26 && * VAR26 ) { ( void ) FUN11 ( FUN12 ( VAR27 , VAR44 -> VAR73 ) -> VAR66 ) ; FUN13 ( VAR27 , VAR44 -> VAR73 , strlen ( VAR26 ) ) ; FUN14 ( VAR27 , VAR44 -> VAR73 , strdup ( VAR26 ) ) ; } VAR39 = socket ( VAR75 , VAR76 , 0 ) ; if ( VAR39 < 0 ) { FUN15 ( FUN2 ( "" ) ) ; VAR51 = - 1 ; VAR74 } if ( VAR48 -> VAR77 == VAR75 ) { VAR42 . VAR78 = VAR48 -> VAR77 ; ( void ) memcpy ( ( void * ) & VAR42 . VAR79 , VAR48 -> VAR80 , VAR48 -> VAR81 ) ; VAR42 . VAR82 = VAR20 ; } else { syslog ( VAR83 , "" "" , VAR48 -> VAR77 ) ; VAR51 = - 1 ; VAR74 } if ( connect ( VAR39 , ( VAR84 * ) & VAR42 , sizeof ( VAR42 ) ) < 0 ) { FUN15 ( VAR50 ) ; VAR51 = - 1 ; VAR74 } if ( VAR24 == 0 ) { ( void ) write ( VAR39 , "" , 1 ) ; } else { char VAR85 [ 16 ] ; int VAR86 ; int VAR87 ; struct sockaddr_storage VAR88 ; struct VAR89 * VAR90 ; int VAR91 = sizeof ( VAR92 ) ; VAR86 = socket ( VAR75 , VAR76 , 0 ) ; if ( VAR86 < 0 ) { VAR51 = - 1 ; VAR74 } ( void ) memset ( ( char * ) & VAR42 , 0 , sizeof ( VAR42 ) ) ; VAR42 . VAR78 = VAR75 ; VAR42 . VAR79 . VAR93 = VAR94 ; VAR42 . VAR82 = 0 ; if ( FUN16 ( VAR86 , ( VAR84 * ) & VAR42 , sizeof ( VAR42 ) ) < 0 ) { FUN15 ( FUN2 ( "" ) ) ; ( void ) close ( VAR86 ) ; VAR51 = - 1 ; VAR74 } if ( FUN17 ( VAR86 , ( VAR84 * ) & VAR88 , & VAR91 ) < 0 ) { FUN15 ( FUN2 ( "" ) ) ; ( void ) close ( VAR86 ) ; VAR51 = - 1 ; VAR74 } VAR90 = ( VAR89 * ) & VAR88 ; ( void ) FUN18 ( VAR86 , 1 ) ; ( void ) snprintf ( VAR85 , sizeof ( VAR85 ) , "" , FUN19 ( ( VAR95 ) VAR90 -> VAR82 ) ) ; if ( write ( VAR39 , VAR85 , strlen ( VAR85 ) + 1 ) != strlen ( VAR85 ) + 1 ) { FUN15 ( FUN2 ( "" ) ) ; ( void ) close ( VAR86 ) ; VAR51 = - 1 ; VAR74 } VAR87 = FUN20 ( VAR86 , ( VAR84 * ) & VAR43 , & VAR91 ) ; ( void ) close ( VAR86 ) ; if ( VAR87 < 0 ) { FUN15 ( FUN2 ( "" ) ) ; VAR51 = - 1 ; VAR74 } * VAR24 = VAR87 ; if ( FUN21 ( VAR43 ) == VAR75 ) { if ( ! VAR36 && FUN22 ( VAR43 ) >= VAR96 ) { ( void ) fprintf ( VAR65 , FUN2 ( "" "" ) ) ; VAR51 = - 1 ; VAR97 } } else { ( void ) fprintf ( VAR65 , FUN2 ( "" "" ) , FUN21 ( VAR43 ) ) ; VAR51 = - 1 ; VAR97 } } if ( VAR51 = FUN23 ( VAR27 , & VAR56 ) ) { VAR97 } VAR51 = FUN24 ( VAR27 , VAR56 , & VAR44 -> VAR98 ) ; if ( VAR51 ) { ( void ) FUN25 ( VAR27 , VAR56 ) ; VAR97 } VAR51 = FUN26 ( VAR27 , 0 , VAR56 , VAR44 , & VAR45 ) ; ( void ) FUN25 ( VAR27 , VAR56 ) ; if ( VAR51 ) { VAR97 } VAR35 &= ( ~ VAR99 ) ; VAR35 &= ( ~ VAR100 ) ; if ( ( VAR51 = FUN27 ( VAR27 , & VAR59 ) ) ) { VAR97 } if ( ( VAR51 = FUN28 ( VAR27 , VAR59 , VAR101 ) ) ) { VAR97 } if ( ( VAR51 = FUN29 ( VAR27 , VAR59 , VAR39 , VAR102 ) ) ) { VAR97 } if ( VAR64 == VAR103 ) { krb5_boolean VAR104 ; VAR51 = FUN30 ( VAR27 , VAR105 , VAR45 -> VAR106 . VAR107 , & VAR104 ) ; if ( VAR51 ) { VAR97 } VAR64 = VAR104 ?VAR108 : VAR109 ; } switch ( VAR64 ) { case VAR109 : VAR35 |= VAR110 ; VAR63 = "" ; break ; case VAR108 : VAR63 = "" ; break ; default : VAR51 = - 1 ; VAR97 } VAR51 = FUN31 ( VAR27 , & VAR59 , ( VAR111 ) & VAR39 , VAR63 , VAR45 -> VAR98 , VAR45 -> VAR73 , VAR35 , & VAR61 , VAR45 , 0 , & VAR55 , & VAR53 , NULL ) ; FUN11 ( VAR61 . VAR66 ) ; if ( VAR51 ) { ( void ) fprintf ( VAR65 , FUN2 ( "" "" ) , FUN10 ( VAR51 ) ) ; if ( VAR55 ) { ( void ) fprintf ( VAR65 , FUN2 ( "" "" ) , VAR55 -> VAR55 , FUN10 ( VAR112 + VAR55 -> VAR55 ) ) ; if ( VAR55 -> VAR113 . VAR67 ) { ( void ) fprintf ( VAR65 , FUN2 ( "" "" ) , VAR55 -> VAR113 . VAR66 ) ; } } if ( VAR55 ) { FUN32 ( VAR27 , VAR55 ) ; VAR55 = 0 ; } VAR97 } if ( VAR53 && VAR34 ) { * VAR34 = VAR53 -> VAR114 ; FUN33 ( VAR27 , VAR53 ) ; } ( void ) write ( VAR39 , VAR22 , strlen ( VAR22 ) + 1 ) ; ( void ) write ( VAR39 , VAR23 , strlen ( VAR23 ) + 1 ) ; if ( VAR21 ) { ( void ) write ( VAR39 , VAR21 , strlen ( VAR21 ) + 1 ) ; } else { ( void ) write ( VAR39 , "" , 1 ) ; } if ( VAR58 & VAR99 ) { if ( VAR51 = FUN34 ( VAR27 , VAR59 , VAR50 , VAR45 -> VAR98 , VAR45 -> VAR73 , 0 , VAR58 & VAR100 , & VAR57 ) ) { ( void ) fprintf ( VAR65 , FUN2 ( "" "" ) ) ; VAR97 } if ( VAR51 = FUN35 ( VAR27 , ( VAR111 ) & VAR39 , & VAR57 ) ) { VAR97 } } else { VAR57 . VAR67 = 0 ; if ( VAR51 = FUN35 ( VAR27 , ( VAR111 ) & VAR39 , & VAR57 ) ) { VAR97 } } if ( ( VAR49 = read ( VAR39 , & VAR46 , 1 ) ) != 1 ) { if ( VAR49 == - 1 ) { FUN15 ( * VAR19 ) ; } else { ( void ) fprintf ( VAR65 , FUN2 ( "" "" ) ) ; } VAR51 = - 1 ; VAR97 } if ( VAR46 != 0 ) { while ( read ( VAR39 , & VAR46 , 1 ) == 1 ) { ( void ) write ( 2 , & VAR46 , 1 ) ; if ( VAR46 == '' ) { break ; } } VAR51 = - 1 ; VAR97 } ( void ) FUN8 ( VAR115 , & VAR40 , ( VAR116 * ) 0 ) ; * VAR18 = VAR39 ; if ( VAR31 ) { ( void ) FUN36 ( VAR27 , VAR45 , VAR31 ) ; } FUN37 ( VAR27 , VAR45 ) ; * VAR29 = VAR59 ; return ( 0 ) ; bad2 if ( VAR24 != NULL ) { ( void ) close ( * VAR24 ) ; } bad if ( VAR39 > 0 ) { ( void ) close ( VAR39 ) ; } if ( VAR44 ) { FUN37 ( VAR27 , VAR44 ) ; } if ( VAR45 ) { FUN37 ( VAR27 , VAR45 ) ; } if ( VAR50 ) { free ( VAR50 ) ; } ( void ) FUN8 ( VAR115 , & VAR40 , ( VAR116 * ) 0 ) ; return ( VAR51 ) ; }