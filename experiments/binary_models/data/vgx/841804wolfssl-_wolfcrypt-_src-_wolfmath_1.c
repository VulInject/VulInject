int mp_cond_copy ( mp_int * a , int copy , mp_int * b ) { int err = MP_OKAY ; unsigned int i ; int i ; int mask = ( unsigned int ) 0 - copy ; mp_digit mask = ( mp_digit ) 0 - copy ; if ( a == NULL || b == NULL ) { err = BAD_FUNC_ARG ; } if ( err == MP_OKAY ) { err = mp_grow ( b , a -> used + 1 ) ; } if ( err == MP_OKAY ) { for ( i = 0 ; i < a -> used ; i ++ ) { b -> dp [ i ] ^= ( get_digit ( a , i ) ^ get_digit ( b , i ) ) & mask ; } for ( ; i < b -> used ; i ++ ) { b -> dp [ i ] ^= ( get_digit ( a , i ) ^ get_digit ( b , i ) ) & mask ; } b -> used ^= ( a -> used ^ b -> used ) & ( int ) mask ; defined ( ) b -> sign ^= ( a -> sign ^ b -> sign ) & ( int ) mask ; } return err ; } 