static void vivid_dev_release ( struct v4l2_device * v4l2_dev ) { struct vivid_dev * dev = container_of ( v4l2_dev , vivid_dev , v4l2_dev ) ; vivid_free_controls ( dev ) ; v4l2_device_unregister ( & dev -> v4l2_dev ) ; vfree ( dev -> scaled_line ) ; vfree ( dev -> blended_line ) ; vfree ( dev -> edid ) ; vfree ( dev -> bitmap_cap ) ; vfree ( dev -> bitmap_out ) ; tpg_free ( & dev -> tpg ) ; kfree ( dev ) ; } 