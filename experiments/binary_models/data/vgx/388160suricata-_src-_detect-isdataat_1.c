static int DetectIsdataatTestParse05 ( void ) { DetectEngineCtx * de_ctx = NULL ; int result = 1 ; Signature * s = NULL ; DetectIsdataatData * data = NULL ; de_ctx = DetectEngineCtxInit ( ) ; if ( de_ctx == NULL ) { end } de_ctx -> flags |= DE_QUIET ; de_ctx -> sig_list = SigInit ( de_ctx , "alert tcp any any ->any any " "(msg:\"Testing bytejump_body\"; " "dce_iface:3919286a-b10c-11d0-9ba8-00c04fd92ef5; " "dce_stub_data; " "content:\"one\"; distance:0; " "isdataat:4,relative; sid:1;)" ) ; if ( de_ctx -> sig_list == NULL ) { end } s = de_ctx -> sig_list ; if ( s -> sm_lists_tail [ g_dce_stub_data_buffer_id ] == NULL ) { result = 0 ; end } result &= ( s -> sm_lists_tail [ g_dce_stub_data_buffer_id ] -> type == DETECT_ISDATAAT ) ; data = ( DetectIsdataatData * ) s -> sm_lists_tail [ g_dce_stub_data_buffer_id ] -> ctx ; if ( ! ( data -> flags & ISDATAAT_RELATIVE ) || ( data -> flags & ISDATAAT_RAWBYTES ) ) { result = 0 ; end } s -> next = SigInit ( de_ctx , "alert tcp any any ->any any " "(msg:\"Testing bytejump_body\"; " "dce_iface:3919286a-b10c-11d0-9ba8-00c04fd92ef5; " "dce_stub_data; " "content:\"one\"; distance:0; " "isdataat:4,relative; sid:1;)" ) ; if ( s -> next == NULL ) { result = 0 ; end } s = s -> next ; if ( s -> sm_lists_tail [ g_dce_stub_data_buffer_id ] == NULL ) { result = 0 ; end } result &= ( s -> sm_lists_tail [ g_dce_stub_data_buffer_id ] -> type == DETECT_ISDATAAT ) ; data = ( DetectIsdataatData * ) s -> sm_lists_tail [ g_dce_stub_data_buffer_id ] -> ctx ; if ( ! ( data -> flags & ISDATAAT_RELATIVE ) || ( data -> flags & ISDATAAT_RAWBYTES ) ) { result = 0 ; end } s -> next = SigInit ( de_ctx , "alert tcp any any ->any any " "(msg:\"Testing bytejump_body\"; " "dce_iface:3919286a-b10c-11d0-9ba8-00c04fd92ef5; " "dce_stub_data; " "content:\"one\"; distance:0; " "isdataat:4,relative,rawbytes; sid:1;)" ) ; if ( s -> next == NULL ) { result = 0 ; end } s = s -> next ; if ( s -> sm_lists_tail [ g_dce_stub_data_buffer_id ] == NULL ) { result = 0 ; end } result &= ( s -> sm_lists_tail [ g_dce_stub_data_buffer_id ] -> type == DETECT_ISDATAAT ) ; data = ( DetectIsdataatData * ) s -> sm_lists_tail [ g_dce_stub_data_buffer_id ] -> ctx ; if ( ! ( data -> flags & ISDATAAT_RELATIVE ) || ! ( data -> flags & ISDATAAT_RAWBYTES ) ) { result = 0 ; end } s -> next = SigInit ( de_ctx , "alert tcp any any ->any any " "(msg:\"Testing bytejump_body\"; " "content:\"one\"; isdataat:4,relative,rawbytes; sid:1;)" ) ; if ( s -> next == NULL ) { result = 0 ; end } s = s -> next ; if ( s -> sm_lists_tail [ g_dce_stub_data_buffer_id ] != NULL ) { result = 0 ; end } end SigGroupCleanup ( de_ctx ) ; SigCleanSignatures ( de_ctx ) ; DetectEngineCtxFree ( de_ctx ) ; return result ; } 