void gfs2_ail_flush ( struct gfs2_glock * gl , bool fsync ) { struct gfs2_sbd * sdp = gl -> gl_name . ln_sbd ; unsigned int revokes = atomic_read ( & gl -> gl_ail_count ) ; int ret ; ret = gfs2_trans_begin ( sdp , 0 , revokes ) ; if ( ret ) { return ; } __gfs2_ail_flush ( gl , fsync , revokes ) ; gfs2_trans_end ( sdp ) ; gfs2_log_flush ( sdp , NULL , GFS2_LOG_HEAD_FLUSH_NORMAL | GFS2_LFC_AIL_FLUSH ) ; } 