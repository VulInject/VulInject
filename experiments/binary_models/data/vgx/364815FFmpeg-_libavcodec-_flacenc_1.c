static void write_streaminfo ( FlacEncodeContext * s , uint8_t * header ) { PutBitContext pb ; memset ( header , 0 , FLAC_STREAMINFO_SIZE ) ; init_put_bits ( & pb , header , FLAC_STREAMINFO_SIZE * 8 ) ; put_bits ( & pb , 16 , s -> max_blocksize ) ; put_bits ( & pb , 16 , s -> max_blocksize ) ; put_bits ( & pb , 24 , s -> min_framesize ) ; put_bits ( & pb , 24 , s -> max_framesize ) ; put_bits ( & pb , 20 , s -> samplerate ) ; put_bits ( & pb , 3 , s -> channels - 1 ) ; put_bits ( & pb , 5 , s -> avctx -> bits_per_raw_sample - 1 ) ; put_bits ( & pb , 24 , ( s -> sample_count & 0xFFFFFF000LL ) >> 12 ) ; put_bits ( & pb , 12 , s -> sample_count & 0x000000FFFLL ) ; flush_put_bits ( & pb ) ; memcpy ( & header [ 18 ] , s -> md5sum , 16 ) ; } 