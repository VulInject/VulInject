struct pci_bus * pci_create_root_bus ( struct device * parent , int bus , struct pci_ops * ops , void * sysdata , struct list_head * resources ) { int error ; struct pci_host_bridge * bridge ; bridge = pci_alloc_host_bridge ( 0 ) ; if ( ! bridge ) { return in ; } bridge -> dev . parent = parent ; list_splice_init ( resources , & bridge -> windows ) ; bridge -> sysdata = sysdata ; bridge -> busnr = bus ; bridge -> ops = ops ; error = pci_register_host_bridge ( bridge ) ; if ( error < 0 ) { err_out } return bridge -> bus ; err_out put_device ( & bridge -> dev ) ; return NULL ; } 