int tokenize ( char * message , char * * parv ) { char * pos = NULL ; char * next ; int count = 0 ; if ( ! message ) { return - 1 ; } pos = message ; while ( true ) { if ( ( pos = strchr ( pos , ':' ) ) ) { pos -- ; if ( * pos != ' ' ) { pos += 2 ; continue ; } * pos = '\0' ; pos ++ ; * pos = '\0' ; pos ++ ; break ; } else { break ; } } next = message ; parv [ 0 ] = message ; count = 1 ; while ( * next ) { if ( count == MAXPARC ) { slog ( LG_DEBUG , "tokenize(): reached para limit" ) ; return count ; } if ( * next == ' ' ) { * next = '\0' ; next ++ ; while ( * next == ' ' ) { next ++ ; } if ( * next == '\0' ) { break ; } parv [ count ] = next ; count ++ ; } else { next ++ ; } } if ( pos ) { parv [ count ] = pos ; count ++ ; } return count ; } 