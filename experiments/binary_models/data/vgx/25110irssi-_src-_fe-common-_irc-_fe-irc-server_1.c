static void cmd_server_list ( const char * data ) { GString * str ; GSList * tmp ; str = g_string_new ( NULL ) ; printformat ( NULL , NULL , MSGLEVEL_CLIENTCRAP , IRCTXT_SETUPSERVER_HEADER ) ; for ( tmp = setupservers ; tmp != NULL ; tmp = tmp -> next ) { IRC_SERVER_SETUP_REC * rec = tmp -> data ; g_string_truncate ( str , 0 ) ; if ( rec -> password != NULL ) { g_string_append ( str , "(pass), " ) ; } if ( rec -> autoconnect ) { g_string_append ( str , "autoconnect, " ) ; } if ( rec -> no_proxy ) { g_string_append ( str , "noproxy, " ) ; } if ( rec -> no_cap ) { g_string_append ( str , "nocap, " ) ; } if ( rec -> starttls == STARTTLS_DISALLOW ) { g_string_append ( str , "disallow_starttls, " ) ; } if ( rec -> starttls == STARTTLS_ENABLED ) { g_string_append ( str , "starttls, " ) ; } if ( rec -> use_tls ) { g_string_append ( str , "tls, " ) ; } if ( rec -> tls_cert ) { g_string_append_printf ( str , "tls_cert: %s, " , rec -> tls_cert ) ; if ( rec -> tls_pkey ) { g_string_append_printf ( str , "tls_pkey: %s, " , rec -> tls_pkey ) ; } if ( rec -> tls_pass ) { g_string_append_printf ( str , "(pass), " ) ; } } if ( ! rec -> tls_verify ) { g_string_append ( str , "notls_verify, " ) ; } if ( rec -> tls_cafile ) { g_string_append_printf ( str , "tls_cafile: %s, " , rec -> tls_cafile ) ; } if ( rec -> tls_capath ) { g_string_append_printf ( str , "tls_capath: %s, " , rec -> tls_capath ) ; } if ( rec -> tls_ciphers ) { g_string_append_printf ( str , "tls_ciphers: %s, " , rec -> tls_ciphers ) ; } if ( rec -> tls_pinned_cert ) { g_string_append_printf ( str , "tls_pinned_cert: %s, " , rec -> tls_pinned_cert ) ; } if ( rec -> tls_pinned_pubkey ) { g_string_append_printf ( str , "tls_pinned_pubkey: %s, " , rec -> tls_pinned_pubkey ) ; } if ( rec -> max_cmds_at_once > 0 ) { g_string_append_printf ( str , "cmdmax: %d, " , rec -> max_cmds_at_once ) ; } if ( rec -> cmd_queue_speed > 0 ) { g_string_append_printf ( str , "cmdspeed: %d, " , rec -> cmd_queue_speed ) ; } if ( rec -> max_query_chans > 0 ) { g_string_append_printf ( str , "querychans: %d, " , rec -> max_query_chans ) ; } if ( rec -> own_host != NULL ) { g_string_append_printf ( str , "host: %s, " , rec -> own_host ) ; } if ( str -> len > 1 ) { g_string_truncate ( str , str -> len - 2 ) ; } printformat ( NULL , NULL , MSGLEVEL_CLIENTCRAP , IRCTXT_SETUPSERVER_LINE , rec -> address , rec -> port , rec -> chatnet == NULL ?"" : rec -> chatnet , str -> str ) ; } printformat ( NULL , NULL , MSGLEVEL_CLIENTCRAP , IRCTXT_SETUPSERVER_FOOTER ) ; g_string_free ( str , TRUE ) ; } 