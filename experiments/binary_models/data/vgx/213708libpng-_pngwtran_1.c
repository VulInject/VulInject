void png_do_write_transformations ( png_structrp png_ptr , png_row_infop row_info ) { png_debug ( 1 , "in png_do_write_transformations" ) ; if ( ( png_ptr -> transformations & PNG_USER_TRANSFORM ) != 0 ) { if ( png_ptr -> write_user_transform_fn != NULL ) { ( * ( png_ptr -> write_user_transform_fn ) ) ( png_ptr , row_info , png_ptr -> row_buf + 1 ) ; } } if ( ( png_ptr -> transformations & PNG_FILLER ) != 0 ) { png_do_strip_channel ( row_info , png_ptr -> row_buf + 1 , ! ( png_ptr -> flags & PNG_FLAG_FILLER_AFTER ) ) ; } if ( ( png_ptr -> transformations & PNG_PACKSWAP ) != 0 ) { png_do_packswap ( row_info , png_ptr -> row_buf + 1 ) ; } if ( ( png_ptr -> transformations & PNG_PACK ) != 0 ) { png_do_pack ( row_info , png_ptr -> row_buf + 1 , ( png_uint_32 ) png_ptr -> bit_depth ) ; } if ( ( png_ptr -> transformations & PNG_SWAP_BYTES ) != 0 ) { png_do_swap ( row_info , png_ptr -> row_buf + 1 ) ; } if ( ( png_ptr -> transformations & PNG_SHIFT ) != 0 ) { png_do_shift ( row_info , png_ptr -> row_buf + 1 , & ( png_ptr -> shift ) ) ; } if ( ( png_ptr -> transformations & PNG_SWAP_ALPHA ) != 0 ) { png_do_write_swap_alpha ( row_info , png_ptr -> row_buf + 1 ) ; } if ( ( png_ptr -> transformations & PNG_INVERT_ALPHA ) != 0 ) { png_do_write_invert_alpha ( row_info , png_ptr -> row_buf + 1 ) ; } if ( ( png_ptr -> transformations & PNG_BGR ) != 0 ) { png_do_bgr ( row_info , png_ptr -> row_buf + 1 ) ; } if ( ( png_ptr -> transformations & PNG_INVERT_MONO ) != 0 ) { png_do_invert ( row_info , png_ptr -> row_buf + 1 ) ; } } 