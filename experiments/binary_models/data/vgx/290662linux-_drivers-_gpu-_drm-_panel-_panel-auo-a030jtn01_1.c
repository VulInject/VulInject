static int a030jtn01_get_modes ( struct drm_panel * panel , struct drm_connector * connector ) { struct a030jtn01 * priv = to_a030jtn01 ( panel ) ; const struct a030jtn01_info * panel_info = priv -> panel_info ; struct drm_display_mode * mode ; int i ; for ( i = 0 ; i < panel_info -> num_modes ; i ++ ) { mode = drm_mode_duplicate ( connector -> dev , & panel_info -> display_modes [ i ] ) ; if ( ! mode ) { return - ENOMEM ; } drm_mode_set_name ( mode ) ; mode -> type = DRM_MODE_TYPE_DRIVER ; if ( panel_info -> num_modes == 1 ) { mode -> type |= DRM_MODE_TYPE_PREFERRED ; } drm_mode_probed_add ( connector , mode ) ; } connector -> display_info . bpc = 8 ; connector -> display_info . width_mm = panel_info -> width_mm ; connector -> display_info . height_mm = panel_info -> height_mm ; drm_display_info_set_bus_formats ( & connector -> display_info , & panel_info -> bus_format , 1 ) ; connector -> display_info . bus_flags = panel_info -> bus_flags ; return panel_info -> num_modes ; } 