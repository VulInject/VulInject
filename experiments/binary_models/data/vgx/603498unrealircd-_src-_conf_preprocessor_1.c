int preprocessor_resolve_if ( ConditionalConfig * cc , PreprocessorPhase phase ) { int result ; if ( ! cc ) { return 1 ; } if ( cc -> condition == IF_MODULE ) { if ( phase == PREPROCESSOR_PHASE_INITIAL ) { return 1 ; } if ( is_module_loaded ( cc -> name ) ) { result = 1 ; } } if ( cc -> condition == IF_DEFINED ) { NameValueList * d = find_config_define ( cc -> name ) ; if ( d ) { result = 1 ; } } if ( cc -> condition == IF_VALUE ) { NameValueList * d = find_config_define ( cc -> name ) ; if ( d && ! strcasecmp ( d -> value , cc -> opt ) ) { result = 1 ; } } else { config_status ( "[BUG] unhandled @if type!!" ) ; } if ( cc -> negative ) { result = result ?0 : 1 ; } return result ; } 