cmsPipeline * _cmsReadFloatInputTag ( cmsHPROFILE hProfile , cmsTagSignature tagFloat ) { cmsContext ContextID = cmsGetProfileContextID ( hProfile ) ; cmsPipeline * Lut = cmsPipelineDup ( ( cmsPipeline * ) cmsReadTag ( hProfile , tagFloat ) ) ; cmsColorSpaceSignature spc = cmsGetColorSpace ( hProfile ) ; cmsColorSpaceSignature PCS = cmsGetPCS ( hProfile ) ; if ( spc == cmsSigLabData ) { if ( ! cmsPipelineInsertStage ( Lut , cmsAT_BEGIN , _cmsStageNormalizeToLabFloat ( ContextID ) ) ) { Error } } if ( spc == cmsSigXYZData ) { if ( ! cmsPipelineInsertStage ( Lut , cmsAT_BEGIN , _cmsStageNormalizeToXyzFloat ( ContextID ) ) ) { Error } } if ( PCS == cmsSigLabData ) { if ( ! cmsPipelineInsertStage ( Lut , cmsAT_END , _cmsStageNormalizeFromLabFloat ( ContextID ) ) ) { Error } } if ( PCS == cmsSigXYZData ) { if ( ! cmsPipelineInsertStage ( Lut , cmsAT_END , _cmsStageNormalizeFromXyzFloat ( ContextID ) ) ) { Error } } return Lut ; Error cmsPipelineFree ( Lut ) ; return NULL ; } 