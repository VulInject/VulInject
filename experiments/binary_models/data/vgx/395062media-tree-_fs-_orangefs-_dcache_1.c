static int orangefs_d_revalidate ( struct dentry * dentry , unsigned int flags ) { int ret ; cfs_time_t time = ( unsigned long ) dentry -> d_fsdata ; if ( time_before ( jiffies , time ) ) { return 1 ; } if ( flags & LOOKUP_RCU ) { return - ECHILD ; } gossip_debug ( GOSSIP_DCACHE_DEBUG , "%s: called on dentry %p.\n" , __func__ , dentry ) ; if ( dentry -> d_inode && is_root_handle ( dentry -> d_inode ) ) { return 1 ; } if ( ! orangefs_revalidate_lookup ( dentry ) ) { return 0 ; } if ( ! dentry -> d_inode ) { out } ret = orangefs_inode_check_changed ( dentry -> d_inode ) ; if ( ret < 0 ) { gossip_debug ( GOSSIP_DCACHE_DEBUG , "%s:%s:%d getattr failure.\n" , __FILE__ , __func__ , __LINE__ ) ; return 0 ; } if ( ret == 0 ) { return 0 ; } out gossip_debug ( GOSSIP_DCACHE_DEBUG , "%s: negative dentry or positive dentry and inode valid.\n" , __func__ ) ; return 1 ; } 