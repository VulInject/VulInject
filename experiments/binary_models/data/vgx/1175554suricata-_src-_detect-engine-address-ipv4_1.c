static int DetectAddressIPv4CutNot06 ( void ) { DetectAddress * a = NULL ; DetectAddress * b = NULL ; struct in_addr in ; int result = 1 ; if ( ( a = DetectAddressInit ( ) ) == NULL ) { return 0 ; } if ( inet_pton ( AF_INET , "0.0.0.0" , & in ) < 0 ) { error } a -> ip . addr_data32 [ 0 ] = in . s_addr ; if ( inet_pton ( AF_INET , "1.2.3.4" , & in ) < 0 ) { error } a -> ip2 . addr_data32 [ 0 ] = in . s_addr ; result &= ( DetectAddressCutNotIPv4 ( a , & b ) == 0 ) ; if ( inet_pton ( AF_INET , "1.2.3.5" , & in ) < 0 ) { error } result = ( a -> ip . addr_data32 [ 0 ] == in . s_addr ) ; if ( inet_pton ( AF_INET , "255.255.255.255" , & in ) < 0 ) { error } result &= ( a -> ip2 . addr_data32 [ 0 ] = in . s_addr ) ; if ( b != NULL ) { DetectAddressFree ( b ) ; } return result ; error DetectAddressFree ( a ) ; if ( b != NULL ) { DetectAddressFree ( b ) ; } return 0 ; } 