static bool virMediatedDeviceAttrsCopy ( virNodeDevCapMdev * dst , virNodeDevCapMdev * src ) { bool ret = false ; size_t i ; if ( src -> nattributes != dst -> nattributes ) { ret = true ; for ( i = 0 ; i < dst -> nattributes ; i ++ ) { virMediatedDeviceAttrFree ( dst -> attributes [ i ] ) ; } dst -> nattributes = src -> nattributes ; dst -> attributes = g_new0 ( virMediatedDeviceAttr * , src -> nattributes ) ; for ( i = 0 ; i < dst -> nattributes ; i ++ ) { dst -> attributes [ i ] = virMediatedDeviceAttrNew ( ) ; } } for ( i = 0 ; i < src -> nattributes ; i ++ ) { if ( STRNEQ_NULLABLE ( src -> attributes [ i ] -> name , dst -> attributes [ i ] -> name ) ) { ret = true ; g_free ( dst -> attributes [ i ] -> name ) ; dst -> attributes [ i ] -> name = g_strdup ( src -> attributes [ i ] -> name ) ; } if ( STRNEQ_NULLABLE ( src -> attributes [ i ] -> value , dst -> attributes [ i ] -> value ) ) { ret = true ; g_free ( dst -> attributes [ i ] -> value ) ; dst -> attributes [ i ] -> value = g_strdup ( src -> attributes [ i ] -> value ) ; } } return ret ; } 