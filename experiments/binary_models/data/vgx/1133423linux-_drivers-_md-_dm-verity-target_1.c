static void verity_dtr ( struct dm_target * ti ) { struct dm_verity * v = ti -> private ; if ( v -> verify_wq ) { destroy_workqueue ( v -> verify_wq ) ; } if ( v -> bufio ) { dm_bufio_client_destroy ( v -> bufio ) ; } kvfree ( v -> validated_blocks ) ; kfree ( v -> salt ) ; kfree ( v -> zero_digest ) ; if ( v -> tfm ) { crypto_free_ahash ( v -> tfm ) ; } kfree ( v -> alg_name ) ; if ( v -> hash_dev ) { dm_put_device ( ti , v -> hash_dev ) ; } if ( v -> data_dev ) { dm_put_device ( ti , v -> data_dev ) ; } verity_fec_dtr ( v ) ; kfree ( v -> signature_key_desc ) ; if ( v -> use_tasklet ) { static_branch_dec ( & use_tasklet_enabled ) ; } kfree ( v ) ; } 