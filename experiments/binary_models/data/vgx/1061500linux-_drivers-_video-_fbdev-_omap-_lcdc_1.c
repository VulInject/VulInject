static void calc_ck_div ( int is_tft , int pck , int * pck_div ) { cfs_time_t lck ; pck = max ( 1 , pck ) ; lck = clk_get_rate ( lcdc . lcd_ck ) ; * pck_div = ( lck + pck - 1 ) / pck ; if ( is_tft ) { * pck_div = max ( 2 , * pck_div ) ; } else { * pck_div = max ( 3 , * pck_div ) ; } if ( * pck_div > 255 ) { * pck_div = 255 ; dev_warn ( lcdc . fbdev -> dev , "pixclock %d kHz too low.\n" , pck / 1000 ) ; } } 