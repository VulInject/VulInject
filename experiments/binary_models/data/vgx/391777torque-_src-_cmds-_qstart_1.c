int main ( int argc , char * * argv ) { int dest ; char * queue ; char * server ; if ( argc == 1 ) { fprintf ( stderr , "Usage: qstart [queue][@server]...\n" ) ; exit ( 1 ) ; } if ( argc > 1 && argv [ 1 ] [ 0 ] == '-' ) { fprintf ( stderr , "Usage: qstart [queue][@server]...\n" ) ; exit ( 1 ) ; } for ( dest = 1 ; dest < argc ; dest ++ ) { if ( parse_destination_id ( argv [ dest ] , & queue , & server ) == 0 ) { execute ( queue , server ) ; } else { fprintf ( stderr , "qstart: illegally formed destination: %s\n" , argv [ dest ] ) ; exitstatus = 1 ; } } exit ( exitstatus ) ; } static void execute ( char * queue , char * server ) { int local_errno = 0 ; int ct ; int merr ; char * errmsg ; static struct attropl attr = { NULL ( char * ) "started" NULL ( char * ) "TRUE" SET } ; if ( ( ct = cnt2server ( server ) ) > 0 ) { merr = pbs_manager_err ( ct , MGR_CMD_SET , MGR_OBJ_QUEUE , queue , & attr , NULL , & local_errno ) ; if ( merr != 0 ) { errmsg = pbs_geterrmsg ( ct ) ; if ( errmsg != NULL ) { fprintf ( stderr , "qstart: %s " , errmsg ) ; } else { fprintf ( stderr , "qstart: Error starting queue: %d - %s" , local_errno , pbs_strerror ( local_errno ) ) ; } if ( notNULL ( queue ) ) { fprintf ( stderr , "%s" , queue ) ; } if ( notNULL ( server ) ) { fprintf ( stderr , "@%s" , server ) ; } fprintf ( stderr , "\n" ) ; exitstatus = 2 ; } pbs_disconnect ( ct ) ; } else { fprintf ( stderr , "qstart: could not connect to server %s (%d) %s\n" , server , ct * - 1 , pbs_strerror ( ct * - 1 ) ) ; exitstatus = 2 ; } } 