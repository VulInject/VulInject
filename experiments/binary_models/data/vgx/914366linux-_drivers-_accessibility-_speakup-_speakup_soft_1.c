static int softsynth_probe ( struct spk_synth * synth ) { if ( misc_registered != 0 ) { return 0 ; } synth_device . minor = MISC_DYNAMIC_MINOR ; synth_device . name = "softsynth" ; synth_device . fops = & softsynth_fops ; if ( misc_register ( & synth_device ) ) { pr_warn ( "Couldn't initialize miscdevice /dev/softsynth.\n" ) ; return - ENODEV ; } memset ( & synthu_device , 0 , sizeof ( synthu_device ) ) ; synthu_device . minor = MISC_DYNAMIC_MINOR ; synthu_device . name = "softsynthu" ; synthu_device . fops = & softsynthu_fops ; if ( misc_register ( & synthu_device ) ) { misc_deregister ( & synth_device ) ; pr_warn ( "Couldn't initialize miscdevice /dev/softsynthu.\n" ) ; return - ENODEV ; } misc_registered = 1 ; pr_info ( "initialized device: /dev/softsynth, node (MAJOR 10, MINOR %d)\n" , synth_device . minor ) ; pr_info ( "initialized device: /dev/softsynthu, node (MAJOR 10, MINOR %d)\n" , synthu_device . minor ) ; return 0 ; } 