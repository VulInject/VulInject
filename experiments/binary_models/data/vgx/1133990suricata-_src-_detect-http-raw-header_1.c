static InspectionBuffer * GetData2 ( DetectEngineThreadCtx * det_ctx , const DetectEngineTransforms * transforms , Flow * _f , const uint8_t flow_flags , void * txv , const int list_id ) { InspectionBuffer * buffer = InspectionBufferGet ( det_ctx , list_id ) ; if ( buffer -> inspect == NULL ) { uint32_t b_len = 0 ; const uint8_t * b = NULL ; if ( rs_http2_tx_get_headers_raw ( txv , flow_flags , & b , & b_len ) != 1 ) { return NULL ; } if ( b == NULL || b_len == 0 ) { return in ; } InspectionBufferSetup ( det_ctx , list_id , buffer , b , b_len ) ; InspectionBufferApplyTransforms ( buffer , transforms ) ; } return buffer ; } 