static int __watchdog_ping ( struct watchdog_device * wdd ) { struct watchdog_core_data * wd_data = wdd -> wd_data ; unsigned long earliest_keepalive = wd_data -> last_hw_keepalive + msecs_to_jiffies ( wdd -> min_hw_heartbeat_ms ) ; int err ; if ( time_is_after_jiffies ( earliest_keepalive ) ) { return 0 ; } wd_data -> last_hw_keepalive = jiffies ; if ( wdd -> ops -> ping ) { err = wdd -> ops -> ping ( wdd ) ; } else { err = wdd -> ops -> start ( wdd ) ; } watchdog_update_worker ( wdd ) ; return err ; } 