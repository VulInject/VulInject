c_printstr ( , , , , ) { unsigned int i ; int things_printed = 0 ; int in_quotes = 0 ; int need_comma = 0 ; if ( ! force_ellipses && length > 0 && ( extract_unsigned_integer ( string + ( length - 1 ) * width , width ) == '\0' ) ) { length -- ; } if ( length == 0 ) { fputs_filtered ( "\"\"" , stream ) ; return ; } for ( i = 0 ; i < length && things_printed < print_max ; ++ i ) { unsigned int rep1 ; unsigned int reps ; unsigned long current_char ; QUIT ; if ( need_comma ) { fputs_filtered ( ", " , stream ) ; need_comma = 0 ; } current_char = extract_unsigned_integer ( string + i * width , width ) ; rep1 = i + 1 ; reps = 1 ; while ( rep1 < length && extract_unsigned_integer ( string + rep1 * width , width ) == current_char ) { ++ rep1 ; ++ reps ; } if ( reps > repeat_count_threshold ) { if ( in_quotes ) { if ( inspect_it ) { fputs_filtered ( "\\\", " , stream ) ; } else { fputs_filtered ( "\", " , stream ) ; } in_quotes = 0 ; } LA_PRINT_CHAR ( current_char , stream ) ; fprintf_filtered ( stream , "<repeats %u times>" , reps ) ; i = rep1 - 1 ; things_printed += repeat_count_threshold ; need_comma = 1 ; } else { if ( ! in_quotes ) { if ( inspect_it ) { fputs_filtered ( "\\\"" , stream ) ; } else { fputs_filtered ( "\"" , stream ) ; } in_quotes = 1 ; } LA_EMIT_CHAR ( current_char , stream , '"' ) ; ++ things_printed ; } } if ( in_quotes ) { if ( inspect_it ) { fputs_filtered ( "\\\"" , stream ) ; } else { fputs_filtered ( "\"" , stream ) ; } } if ( force_ellipses || i < length ) { fputs_filtered ( "..." , stream ) ; } } 