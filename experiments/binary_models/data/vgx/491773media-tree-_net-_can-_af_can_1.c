static int can_rcv ( struct sk_buff * skb , struct net_device * dev , struct packet_type * pt , struct net_device * orig_dev ) { struct canfd_frame * cfd = ( canfd_frame * ) skb -> data ; if ( WARN_ONCE ( dev -> type != ARPHRD_CAN || skb -> len != CAN_MTU || cfd -> len > CAN_MAX_DLEN , "PF_CAN: dropped non conform CAN skbuf: " "dev type %d, len %d, datalen %d\n" , dev -> type , skb -> len , cfd -> len ) ) { drop } can_receive ( skb , dev ) ; return NET_RX_SUCCESS ; drop return NET_RX_DROP ; } 