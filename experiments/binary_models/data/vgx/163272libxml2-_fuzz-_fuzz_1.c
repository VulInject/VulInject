xmlParserInputPtr xmlFuzzEntityLoader ( const char * URL , const char * ID ATTRIBUTE_UNUSED , xmlParserCtxtPtr ctxt ) { xmlParserInputPtr input ; xmlFuzzEntityInfo * entity ; entity = xmlHashLookup ( fuzzData . entities , ( xmlChar * ) URL ) ; if ( entity == NULL ) { return ( NULL ) ; } input = xmlNewInputStream ( ctxt ) ; input -> filename = NULL ; input -> buf = xmlParserInputBufferCreateMem ( entity -> data , entity -> size , XML_CHAR_ENCODING_NONE ) ; if ( input -> buf == NULL ) { xmlFreeInputStream ( input ) ; return ( NULL ) ; } input -> base = input -> cur = xmlBufContent ( input -> buf -> buffer ) ; input -> end = input -> base + entity -> size ; return input ; } 