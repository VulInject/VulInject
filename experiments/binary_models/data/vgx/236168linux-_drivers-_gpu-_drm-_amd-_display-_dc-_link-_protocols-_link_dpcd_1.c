enum dc_status core_link_read_dpcd ( struct dc_link * link , uint32_t address , uint8_t * data , uint32_t size ) { int extended_address ; uint32_t partitioned_address ; uint8_t * extended_data ; uint32_t extended_size ; uint32_t size_left_to_read ; enum dc_status status ; uint32_t partition_size ; uint32_t data_index = 0 ; dpcd_extend_address_range ( address , data , size , & extended_address , & extended_data , & extended_size ) ; partitioned_address = extended_address ; size_left_to_read = extended_size ; while ( size_left_to_read ) { partition_size = dpcd_get_next_partition_size ( partitioned_address , size_left_to_read ) ; status = internal_link_read_dpcd ( link , partitioned_address , & extended_data [ data_index ] , partition_size ) ; if ( status != DC_OK ) { break ; } partitioned_address += partition_size ; data_index += partition_size ; size_left_to_read -= partition_size ; } dpcd_reduce_address_range ( extended_address , extended_data , extended_size , address , data , size ) ; return status ; } 