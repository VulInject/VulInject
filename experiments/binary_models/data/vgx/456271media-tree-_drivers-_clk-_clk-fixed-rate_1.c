static struct clk * _of_fixed_clk_setup ( struct device_node * node ) { struct clk * clk ; const char * clk_name = node -> name ; u32 rate ; int accuracy = 0 ; int ret ; if ( of_property_read_u32 ( node , "clock-frequency" , & rate ) ) { return ERR_PTR ( - EIO ) ; } of_property_read_u32 ( node , "clock-accuracy" , & accuracy ) ; of_property_read_string ( node , "clock-output-names" , & clk_name ) ; clk = clk_register_fixed_rate_with_accuracy ( NULL , clk_name , NULL , 0 , rate , accuracy ) ; if ( IS_ERR ( clk ) ) { return clk ; } ret = of_clk_add_provider ( node , of_clk_src_simple_get , clk ) ; if ( ret ) { clk_unregister ( clk ) ; return ERR_PTR ( ret ) ; } return clk ; } 