static ssize_t sdram_show ( struct file * file , struct kobject * kobj , struct bin_attribute * a , char * buf , loff_t off , size_t count ) { struct device * dev = container_of ( kobj , device , kobj ) ; struct solo_dev * solo_dev = container_of ( dev , solo_dev , dev ) ; const int size = solo_dev -> sdram_size ; if ( off + count > size ) { count = size - off ; } if ( solo_p2m_dma ( solo_dev , 0 , buf , off , count , 0 , 0 ) ) { return - EIO ; } return count ; } 