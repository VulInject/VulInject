NCURSES_EXPORT ( ) setcchar ( , , , , ) { int i ; int len ; int code = OK ; TR ( TRACE_CCALLS , ( T_CALLED ( "setcchar(%p,%s,%lu,%d,%p)" ) , wcval , _nc_viswbuf ( wch ) , ( unsigned long ) attrs , color_pair , opts ) ) ; len = wcslen ( wch ) ; if ( opts != NULL || ( len > 1 && wcwidth ( wch [ 0 ] ) < 0 ) ) { code = ERR ; } else { if ( len > CCHARW_MAX ) { len = CCHARW_MAX ; } for ( i = 1 ; i < len ; ++ i ) { if ( wcwidth ( wch [ i ] ) != 0 ) { len = i ; break ; } } if ( len != 0 ) { SetAttr ( * wcval , attrs | COLOR_PAIR ( color_pair ) ) ; SetPair ( CHDEREF ( wcval ) , color_pair ) ; memcpy ( & wcval -> chars , wch , len * sizeof ( wchar_t ) ) ; TR ( TRACE_CCALLS , ( "copy %d wchars, first is %s" , len , _tracecchar_t ( wcval ) ) ) ; } } TR ( TRACE_CCALLS , ( T_RETURN ( "%d" ) , code ) ) ; return ( code ) ; } 