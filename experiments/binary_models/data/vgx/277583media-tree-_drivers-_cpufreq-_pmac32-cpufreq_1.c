static int pmac_cpufreq_init_750FX ( struct device_node * cpunode ) { struct device_node * volt_gpio_np ; u32 pvr ; const u32 * value ; if ( of_get_property ( cpunode , "dynamic-power-step" , NULL ) == NULL ) { return 1 ; } hi_freq = cur_freq ; value = of_get_property ( cpunode , "reduced-clock-frequency" , NULL ) ; low_freq = ( * value ) / 1000 ; volt_gpio_np = of_find_node_by_name ( NULL , "cpu-vcore-select" ) ; if ( volt_gpio_np ) { voltage_gpio = read_gpio ( volt_gpio_np ) ; } pvr = mfspr ( SPRN_PVR ) ; has_cpu_l2lve = ! ( ( pvr & 0xf00 ) == 0x100 ) ; set_speed_proc = cpu_750fx_cpu_speed ; get_speed_proc = cpu_750fx_get_cpu_speed ; cur_freq = cpu_750fx_get_cpu_speed ( ) ; return 0 ; } 