int avp_enum ( struct l2tp_avp * avp , const u_char * pkt , int pktlen , int filldata ) { uint16_t flags ; L2TP_SUBR_ASSERT ( pktlen >= 6 ) ; if ( pktlen < 6 ) { return - 1 ; } GETSHORT ( flags , pkt ) ; avp -> is_mandatory = ( ( flags & 0x8000 ) != 0 ) ?1 : 0 ; avp -> is_hidden = ( ( flags & 0x4000 ) != 0 ) ?1 : 0 ; avp -> length = flags & 0x03ff ; GETSHORT ( avp -> vendor_id , pkt ) ; avp -> attr_type = * pkt << 8 ; avp -> attr_type |= * ( pkt + 1 ) ; pkt += 2 ; if ( filldata != 0 ) { memcpy ( avp -> attr_value , pkt , avp -> length - 6 ) ; } return avp -> length ; } 