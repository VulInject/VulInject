sss_status_t se050_configure_host ( sss_user_impl_session_t * host_session , sss_key_store_t * host_ks , SE_Connect_Ctx_t * open_ctx , struct se050_auth_ctx * auth , SE_AuthType_t auth_type , struct se050_scp_key * keys ) { sss_status_t status = kStatus_SSS_Fail ; uint32_t host_oid = 0 ; if ( host_session -> subsystem != kType_SSS_SubSystem_NONE ) { prepare } status = sss_host_session_open ( host_session , kType_SSS_Software , 0 , kSSS_ConnectionType_Plain , NULL ) ; if ( status != kStatus_SSS_Success ) { return status ; } status = sss_host_key_store_context_init ( host_ks , host_session ) ; if ( status != kStatus_SSS_Success ) { error } status = sss_host_key_store_allocate ( host_ks , host_oid ++ ) ; if ( status != kStatus_SSS_Success ) { error } prepare status = prepare_host_scp ( & open_ctx -> auth . ctx . scp03 , auth , host_ks , keys , host_oid ) ; if ( status != kStatus_SSS_Success ) { error } open_ctx -> auth . authType = auth_type ; return status ; error sss_host_session_close ( host_session ) ; return status ; } 