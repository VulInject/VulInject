static struct mnttab * create_mnttab_filter ( char * resource , char * mountp , char * fstype , char * mntopts , char * time ) { struct mnttab * search_entry ; search_entry = ( mnttab * ) calloc ( ( size_t ) 1 , ( size_t ) sizeof ( mnttab ) ) ; if ( search_entry == NULL ) { return ( NULL ) ; } if ( resource != NULL ) { search_entry -> mnt_special = strdup ( resource ) ; if ( search_entry -> mnt_special == NULL ) { return ( NULL ) ; } } if ( mountp != NULL ) { search_entry -> mnt_mountp = strdup ( mountp ) ; if ( search_entry -> mnt_mountp == NULL ) { free_mnttab_entry ( search_entry ) ; return ( NULL ) ; } } if ( fstype != NULL ) { search_entry -> mnt_fstype = strdup ( fstype ) ; if ( search_entry -> mnt_fstype == NULL ) { free_mnttab_entry ( search_entry ) ; return ( NULL ) ; } } if ( mntopts != NULL ) { search_entry -> mnt_mntopts = strdup ( mntopts ) ; if ( search_entry -> mnt_mntopts == NULL ) { free_mnttab_entry ( search_entry ) ; return ( NULL ) ; } } if ( time != NULL ) { search_entry -> mnt_time = strdup ( time ) ; if ( search_entry -> mnt_time == NULL ) { free_mnttab_entry ( search_entry ) ; return ( NULL ) ; } } return ( search_entry ) ; } 