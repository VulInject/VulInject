static void mode_add_sorted ( IRC_SERVER_REC * server , GString * str , char mode , const char * arg , int user ) { char * p ; int updating , argpos = 0 ; updating = FALSE ; for ( p = str -> str ; * p != '\0' && * p != ' ' ; p ++ ) { if ( mode < * p ) { break ; } if ( mode == * p ) { updating = TRUE ; break ; } if ( ! user && HAS_MODE_ARG_SET ( server , * p ) ) { argpos ++ ; } } if ( ! updating ) { if ( * p == '\0' ) { g_string_append_c ( str , mode ) ; } else { g_string_insert_c ( str , ( int ) ( p - str -> str ) , mode ) ; } } if ( arg != NULL ) { mode_add_arg ( str , argpos , updating , arg ) ; } } 