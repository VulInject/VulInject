static int f7188x_gpio_get_direction ( struct gpio_chip * chip , unsigned offset ) { int err ; struct f7188x_gpio_bank * bank = gpiochip_get_data ( chip ) ; struct f7188x_sio * sio = bank -> data -> sio ; u8 dir ; err = superio_enter ( sio -> addr ) ; superio_select ( sio -> addr , sio -> device ) ; dir = superio_inb ( sio -> addr , f7188x_gpio_dir ( bank -> regbase ) ) ; superio_exit ( sio -> addr ) ; if ( f7188x_gpio_dir_invert ( sio -> type ) ) { dir = ~ dir ; } if ( dir & BIT ( offset ) ) { return GPIO_LINE_DIRECTION_OUT ; } return GPIO_LINE_DIRECTION_IN ; } 