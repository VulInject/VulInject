static int macsec_rx_sa_active_update ( struct macsec_context * ctx , struct mlx5e_macsec_sa * rx_sa , bool active ) { struct mlx5e_priv * priv = netdev_priv ( ctx -> netdev ) ; struct mlx5e_macsec * macsec = priv -> macsec ; int err = 0 ; rx_sa -> active = active ; if ( ! active ) { mlx5e_macsec_cleanup_sa ( macsec , rx_sa , false ) ; return 0 ; } err = mlx5e_macsec_init_sa ( ctx , rx_sa , true , false ) ; if ( err ) { rx_sa -> active = false ; } return err ; } 