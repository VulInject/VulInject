struct ref * guess_remote_head ( const struct ref * head , const struct ref * refs , int all ) { const struct ref * r ; struct ref * list = NULL ; struct ref * * tail = & list ; if ( ! head ) { return NULL ; } if ( head -> symref ) { return copy_ref ( find_ref_by_name ( refs , head -> symref ) ) ; } if ( ! all ) { char * ref = xstrfmt ( "refs/heads/%s" , git_default_branch_name ( 0 ) ) ; r = find_ref_by_name ( refs , ref ) ; if ( r && oideq ( & r -> old_oid , & head -> old_oid ) ) { return copy_ref ( r ) ; } r = find_ref_by_name ( refs , "refs/heads/master" ) ; if ( r && oideq ( & r -> old_oid , & head -> old_oid ) ) { return copy_ref ( r ) ; } } for ( r = refs ; r ; r = r -> next ) { if ( r != head && starts_with ( r -> name , "refs/heads/" ) && oideq ( & r -> old_oid , & head -> old_oid ) ) { * tail = copy_ref ( r ) ; tail = & ( ( * tail ) -> next ) ; if ( ! all ) { break ; } } } return list ; } 