static int atmel_conf_pin_config_group_get ( struct pinctrl_dev * pctldev , unsigned group , unsigned long * config ) { struct atmel_pioctrl * atmel_pioctrl = pinctrl_dev_get_drvdata ( pctldev ) ; unsigned param = pinconf_to_config_param ( * config ) , arg = 0 ; struct atmel_group * grp = atmel_pioctrl -> groups + group ; unsigned pin_id = grp -> pin ; u32 res ; res = atmel_pin_config_read ( pctldev , pin_id ) ; switch ( param ) { case PIN_CONFIG_BIAS_PULL_UP : if ( ! ( res & ATMEL_PIO_PUEN_MASK ) ) { return - EINVAL ; } arg = 1 ; break ; case PIN_CONFIG_BIAS_PULL_DOWN : if ( ( res & ATMEL_PIO_PUEN_MASK ) || ( ! ( res & ATMEL_PIO_PDEN_MASK ) ) ) { return - EINVAL ; } arg = 1 ; break ; case PIN_CONFIG_BIAS_DISABLE : if ( ( res & ATMEL_PIO_PUEN_MASK ) || ( ( res & ATMEL_PIO_PDEN_MASK ) ) ) { return - EINVAL ; } arg = 1 ; break ; case PIN_CONFIG_DRIVE_OPEN_DRAIN : arg = 1 ; break ; case PIN_CONFIG_INPUT_SCHMITT_ENABLE : if ( ! ( res & ATMEL_PIO_SCHMITT_MASK ) ) { return - EINVAL ; } arg = 1 ; break ; default : return - ENOTSUPP ; } * config = pinconf_to_config_packed ( param , arg ) ; return 0 ; } 