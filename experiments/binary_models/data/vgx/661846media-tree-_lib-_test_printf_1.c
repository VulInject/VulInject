static int __init test_printf_init ( void ) { alloced_buffer = kmalloc ( BUF_SIZE + 2 * PAD_SIZE , GFP_KERNEL ) ; if ( ! alloced_buffer ) { return - ENOMEM ; } test_buffer = alloced_buffer + PAD_SIZE ; test_basic ( ) ; test_number ( ) ; test_string ( ) ; test_pointer ( ) ; if ( failed_tests == 0 ) { pr_info ( "all %u tests passed\n" , total_tests ) ; } else { pr_warn ( "failed %u out of %u tests\n" , failed_tests , total_tests ) ; } return failed_tests ?- EINVAL : 0 ; } 