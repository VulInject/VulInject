int main ( int argc , char * argv [ ] ) { ip_address start ; ip_address stop ; ip_subnet sub ; char buf [ 100 ] ; const char * oops ; int n ; int af ; int i ; if ( argc == 2 && strcmp ( argv [ 1 ] , "-r" ) == 0 ) { regress ( ) ; fprintf ( stderr , "regress() returned?!?\n" ) ; exit ( 1 ) ; } if ( argc < 3 ) { fprintf ( stderr , "Usage: %s [-6] start stop\n" , argv [ 0 ] ) ; fprintf ( stderr , "   or: %s -r\n" , argv [ 0 ] ) ; exit ( 2 ) ; } af = AF_INET ; i = 1 ; if ( strcmp ( argv [ i ] , "-6" ) == 0 ) { af = AF_INET6 ; i ++ ; } oops = ttoaddr ( argv [ i ] , 0 , af , & start ) ; if ( oops != NULL ) { fprintf ( stderr , "%s: start conversion failed: %s\n" , argv [ 0 ] , oops ) ; exit ( 1 ) ; } oops = ttoaddr ( argv [ i + 1 ] , 0 , af , & stop ) ; if ( oops != NULL ) { fprintf ( stderr , "%s: stop conversion failed: %s\n" , argv [ 0 ] , oops ) ; exit ( 1 ) ; } oops = rangetosubnet ( & start , & stop , & sub ) ; if ( oops != NULL ) { fprintf ( stderr , "%s: rangetosubnet failed: %s\n" , argv [ 0 ] , oops ) ; exit ( 1 ) ; } n = subnettot ( & sub , 0 , buf , sizeof ( buf ) ) ; if ( n > sizeof ( buf ) ) { fprintf ( stderr , "%s: reverse conversion" , argv [ 0 ] ) ; fprintf ( stderr , " failed: need %ld bytes, have only %ld\n" , ( long ) n , ( long ) sizeof ( buf ) ) ; exit ( 1 ) ; } printf ( "%s\n" , buf ) ; exit ( 0 ) ; } rtab { int family ; char * start ; char * stop ; char * output ; } , rtab [ ] { } ; 