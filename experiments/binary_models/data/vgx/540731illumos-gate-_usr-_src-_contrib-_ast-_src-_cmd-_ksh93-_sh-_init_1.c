static void put_ed ( register Namval_t * np , const char * val , int flags , Namfun_t * fp ) { register const char * cp , * name = nv_name ( np ) ; register int newopt = 0 ; Shell_t * shp = nv_shell ( np ) ; if ( * name == 'E' && nv_getval ( sh_scoped ( shp , VISINOD ) ) ) { done } if ( ! ( cp = val ) && ( * name == 'E' || ! ( cp = nv_getval ( sh_scoped ( shp , EDITNOD ) ) ) ) ) { done } cp = path_basename ( cp ) ; if ( strmatch ( cp , "*[Vv][Ii]*" ) ) { newopt = SH_VI ; } if ( strmatch ( cp , "*gmacs*" ) ) { newopt = SH_GMACS ; } if ( strmatch ( cp , "*macs*" ) ) { newopt = SH_EMACS ; } if ( newopt ) { sh_offoption ( SH_VI ) ; sh_offoption ( SH_EMACS , NULL ) ; sh_offoption ( SH_GMACS ) ; sh_onoption ( newopt ) ; } done nv_putv ( np , val , flags , fp ) ; } 