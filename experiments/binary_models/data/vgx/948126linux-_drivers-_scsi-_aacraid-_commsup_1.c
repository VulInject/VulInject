void aac_fib_map_free ( struct aac_dev * dev ) { size_t alloc_size ; size_t fib_size ; int num_fibs ; num_fibs = dev -> scsi_host_ptr -> can_queue + AAC_NUM_MGT_FIB ; fib_size = dev -> max_fib_size + sizeof ( aac_fib_xporthdr ) ; alloc_size = fib_size * num_fibs + ALIGN32 - 1 ; dma_free_coherent ( & dev -> pdev -> dev , alloc_size , dev -> hw_fib_va , dev -> hw_fib_pa ) ; dev -> hw_fib_va = NULL ; dev -> hw_fib_pa = 0 ; } 