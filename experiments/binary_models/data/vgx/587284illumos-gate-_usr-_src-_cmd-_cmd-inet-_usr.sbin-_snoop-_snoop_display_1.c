void process_pkt ( struct sb_hdr * hdrp , char * pktp , int num , int flags ) { int drops , pktlen ; struct timeval * tvp ; struct tm * tm ; extern int x_offset ; extern int x_length ; int offset , length ; static struct timeval ptv ; tvp = & hdrp -> sbh_timestamp ; if ( ptv . tv_sec == 0 ) { ptv = * tvp ; } drops = hdrp -> sbh_drops ; pktlen = hdrp -> sbh_msglen ; if ( pktlen <= 0 ) { return ; } dlc_header = pktp ; pi_frame = num ; tm = localtime ( & tvp -> tv_sec ) ; pi_time_hour = tm -> tm_hour ; pi_time_min = tm -> tm_min ; pi_time_sec = tm -> tm_sec ; pi_time_usec = tvp -> tv_usec ; src_name = "?" ; dst_name = "*" ; click ( hdrp -> sbh_origlen ) ; * interface -> interpreter ( flags , dlc_header , hdrp -> sbh_msglen , hdrp -> sbh_origlen ) ; show_pktinfo ( flags , num , src_name , dst_name , & ptv , tvp , drops , hdrp -> sbh_origlen ) ; if ( x_offset >= 0 ) { offset = MIN ( x_offset , hdrp -> sbh_msglen ) ; offset -= ( offset % 2 ) ; length = MIN ( hdrp -> sbh_msglen - offset , x_length ) ; hexdump ( dlc_header + offset , length ) ; } ptv = * tvp ; } 