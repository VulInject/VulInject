uint32_t bgp_attr_mac_mobility_seqnum ( struct attr * attr , uint8_t * sticky ) { struct ecommunity * ecom ; uint32_t i ; uint8_t flags = 0 ; ecom = bgp_attr_get_ecommunity ( attr ) ; for ( i = 0 ; i < ecom -> size ; i ++ ) { const uint8_t * pnt ; uint8_t type , sub_type ; uint32_t seq_num ; pnt = ( ecom -> val + ( i * ECOMMUNITY_SIZE ) ) ; type = * pnt ++ ; sub_type = * pnt ++ ; if ( ! ( type == ECOMMUNITY_ENCODE_EVPN && sub_type == ECOMMUNITY_EVPN_SUBTYPE_MACMOBILITY ) ) { continue ; } flags = * pnt ++ ; if ( flags & ECOMMUNITY_EVPN_SUBTYPE_MACMOBILITY_FLAG_STICKY ) { * sticky = 1 ; } else { * sticky = 0 ; } pnt ++ ; pnt = ptr_get_be32 ( pnt , & seq_num ) ; ( void ) pnt ; return seq_num ; } return 0 ; } 