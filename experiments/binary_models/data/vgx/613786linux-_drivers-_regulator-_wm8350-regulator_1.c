static int wm8350_dcdc_set_suspend_voltage ( struct regulator_dev * rdev , int uV ) { struct wm8350 * wm8350 = rdev_get_drvdata ( rdev ) ; int sel , volt_reg , dcdc = rdev_get_id ( rdev ) ; u16 val ; dev_dbg ( wm8350 -> dev , "%s %d mV %d\n" , __func__ , dcdc , uV / 1000 ) ; switch ( dcdc ) { case WM8350_DCDC_1 : volt_reg = WM8350_DCDC1_LOW_POWER ; break ; case WM8350_DCDC_3 : volt_reg = WM8350_DCDC3_LOW_POWER ; break ; case WM8350_DCDC_4 : volt_reg = WM8350_DCDC4_LOW_POWER ; break ; case WM8350_DCDC_6 : volt_reg = WM8350_DCDC6_LOW_POWER ; break ; case WM8350_DCDC_2 : case WM8350_DCDC_5 : default : return - EINVAL ; } sel = regulator_map_voltage_linear ( rdev , uV , uV ) ; val = wm8350_reg_read ( wm8350 , volt_reg ) & ~ WM8350_DC1_VSEL_MASK ; wm8350_reg_write ( wm8350 , volt_reg , val | sel ) ; return 0 ; } 