void xfs_free_perag ( struct xfs_mount * mp ) { struct xfs_perag * pag ; xfs_agnumber_t agno ; for ( agno = 0 ; agno < mp -> m_sb . sb_agcount ; agno ++ ) { spin_lock ( & mp -> m_perag_lock ) ; pag = radix_tree_delete ( & mp -> m_perag_tree , agno ) ; spin_unlock ( & mp -> m_perag_lock ) ; ASSERT ( pag ) ; XFS_IS_CORRUPT ( pag -> pag_mount , atomic_read ( & pag -> pag_ref ) != 0 ) ; cancel_delayed_work_sync ( & pag -> pag_blockgc_work ) ; call_rcu ( & pag -> rcu_head , __xfs_free_perag ) ; } } 