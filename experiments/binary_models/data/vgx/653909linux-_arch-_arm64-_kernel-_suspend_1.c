void notrace __cpu_suspend_exit ( void ) { unsigned int cpu = smp_processor_id ( ) ; mte_suspend_exit ( ) ; cpu_uninstall_idmap ( ) ; if ( system_supports_cnp ( ) ) { cpu_replace_ttbr1 ( lm_alias ( swapper_pg_dir ) , idmap_pg_dir ) ; } if ( cpus_have_const_cap ( ARM64_HAS_DIT ) ) { set_pstate_dit ( 1 ) ; } __uaccess_enable_hw_pan ( ) ; if ( hw_breakpoint_restore ) { hw_breakpoint_restore ( cpu ) ; } spectre_v4_enable_mitigation ( NULL , NULL ) ; ptrauth_suspend_exit ( ) ; } 