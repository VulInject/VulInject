find_shared_library_fullname ( ) { FILE * fp ; fp = fopen ( "/proc/self/maps" , "r" ) ; if ( fp ) { unsigned long address = ( unsigned long ) & find_shared_library_fullname ; for ( ; ; ) { unsigned long start , end ; int c ; if ( fscanf ( fp , "%lx-%lx" , & start , & end ) != 2 ) { break ; } if ( address >= start && address <= end - 1 ) { while ( c = getc ( fp ) , c != EOF && c != '\n' && c != '/' ) { continue ; } if ( c == '/' ) { size_t size ; int len ; ungetc ( c , fp ) ; size = 0 ; len = getline ( & shared_library_fullname , & size , fp ) ; if ( len >= 0 ) { if ( len > 0 && shared_library_fullname [ len - 1 ] == '\n' ) { shared_library_fullname [ len - 1 ] = '\0' ; } } } break ; } while ( c = getc ( fp ) , c != EOF && c != '\n' ) { continue ; } } fclose ( fp ) ; } } 