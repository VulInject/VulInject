static int ts4800_parse_dt ( struct platform_device * pdev , struct ts4800_ts * ts ) { struct device * dev = & pdev -> dev ; struct device_node * np = dev -> of_node ; struct device_node * syscon_np ; u32 reg , bit ; int error ; syscon_np = of_parse_phandle ( np , "syscon" , 0 ) ; if ( ! syscon_np ) { dev_err ( dev , "no syscon property\n" ) ; return - ENODEV ; } ts -> regmap = syscon_node_to_regmap ( syscon_np , NULL ) ; of_node_put ( syscon_np ) ; if ( IS_ERR ( ts -> regmap ) ) { dev_err ( dev , "cannot get parent's regmap\n" ) ; return PTR_ERR ( ts -> regmap ) ; } error = of_property_read_u32_index ( np , "syscon" , 1 , & reg ) ; if ( error < 0 ) { dev_err ( dev , "no offset in syscon\n" ) ; return error ; } ts -> reg = reg ; error = of_property_read_u32_index ( np , "syscon" , 2 , & bit ) ; if ( error < 0 ) { dev_err ( dev , "no bit in syscon\n" ) ; return error ; } ts -> bit = BIT ( bit ) ; return 0 ; } 