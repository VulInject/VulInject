som_solib_sizeof_symbol_table ( ) { bfd * abfd ; int desc ; char * absolute_name ; LONGEST st_size = ( LONGEST ) 0 ; asection * sect ; desc = openp ( getenv ( "PATH" ) , OPF_TRY_CWD_FIRST , filename , O_RDONLY | O_BINARY , 0 , & absolute_name ) ; if ( desc < 0 ) { perror_with_name ( filename ) ; } filename = absolute_name ; abfd = bfd_fdopenr ( filename , gnutarget , desc ) ; if ( ! abfd ) { close ( desc ) ; make_cleanup ( xfree , filename ) ; error ( "\"%s\": can't open to read symbols: %s." , filename , bfd_errmsg ( bfd_get_error ( ) ) ) ; } if ( ! bfd_check_format ( abfd , bfd_object ) ) { bfd_close ( abfd ) ; make_cleanup ( xfree , filename ) ; error ( "\"%s\": can't read symbols: %s." , filename , bfd_errmsg ( bfd_get_error ( ) ) ) ; } sect = bfd_get_section_by_name ( abfd , "$DEBUG$" ) ; if ( sect ) { st_size += ( LONGEST ) bfd_section_size ( abfd , sect ) ; } sect = bfd_get_section_by_name ( abfd , "$PINFO$" ) ; if ( sect ) { st_size += ( LONGEST ) bfd_section_size ( abfd , sect ) ; } bfd_close ( abfd ) ; return st_size * ( LONGEST ) 10 ; } 