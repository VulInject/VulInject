synthhid_msg_hdr { enum synthhid_msg_type type ; u32 size ; } synthhid_version { { u16 minor_version ; u16 major_version ; } u32 version ; } synthhid_protocol_request { struct synthhid_msg_hdr header ; union synthhid_version version_requested ; } synthhid_protocol_response { struct synthhid_msg_hdr header ; union synthhid_version version_requested ; unsigned char approved ; } synthhid_device_info { struct synthhid_msg_hdr header ; struct hv_input_dev_info hid_dev_info ; struct hid_descriptor hid_descriptor ; } synthhid_device_info_ack { struct synthhid_msg_hdr header ; int reserved ; } synthhid_input_report { struct synthhid_msg_hdr header ; char buffer [ ] ; } pipe_prot_msg_type { PIPE_MESSAGE_INVALID , PIPE_MESSAGE_DATA , PIPE_MESSAGE_MAXIMUM } pipe_prt_msg { enum pipe_prot_msg_type type ; u32 size ; char data [ ] ; } mousevsc_prt_msg { enum pipe_prot_msg_type type ; u32 size ; { struct synthhid_protocol_request request ; struct synthhid_protocol_response response ; struct synthhid_device_info_ack ack ; } } mousevsc_dev { struct hv_device * device ; bool init_complete ; bool connected ; struct mousevsc_prt_msg protocol_req ; struct mousevsc_prt_msg protocol_resp ; struct completion wait_event ; int dev_info_status ; struct hid_descriptor * hid_desc ; unsigned char * report_desc ; u32 report_desc_size ; struct hv_input_dev_info hid_dev_info ; struct hid_device * hid_device ; u8 input_buf [ HID_MAX_BUFFER_SIZE ] ; } 