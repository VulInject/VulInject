int ipu_smfc_map_channel ( struct ipu_smfc * smfc , int csi_id , int mipi_id ) { struct ipu_smfc_priv * priv = smfc -> priv ; cfs_time_t flags ; u32 val , shift ; spin_lock_irqsave ( & priv -> lock , flags ) ; shift = smfc -> chno * 3 ; val = readl ( priv -> base + SMFC_MAP ) ; val &= ~ ( 0x7 << shift ) ; val |= ( ( csi_id << 2 ) | mipi_id ) << shift ; writel ( val , priv -> base + SMFC_MAP ) ; spin_unlock_irqrestore ( & priv -> lock , flags ) ; return 0 ; } 