static int intel_ddi_compute_config ( struct intel_encoder * encoder , struct intel_crtc_state * pipe_config , struct drm_connector_state * conn_state ) { struct intel_crtc * crtc = to_intel_crtc ( pipe_config -> uapi . crtc ) ; struct drm_i915_private * dev_priv = to_i915 ( encoder -> base . dev ) ; enum port port = encoder -> port ; int ret ; if ( HAS_TRANSCODER ( dev_priv , TRANSCODER_EDP ) && port == PORT_A ) { pipe_config -> cpu_transcoder = TRANSCODER_EDP ; } if ( intel_crtc_has_type ( pipe_config , INTEL_OUTPUT_HDMI ) ) { ret = intel_hdmi_compute_config ( encoder , pipe_config , conn_state ) ; } else { ret = intel_dp_compute_config ( encoder , pipe_config , conn_state ) ; } if ( IS_HASWELL ( dev_priv ) && crtc -> pipe == PIPE_A && pipe_config -> cpu_transcoder == TRANSCODER_EDP ) { pipe_config -> pch_pfit . force_thru = pipe_config -> pch_pfit . enabled || pipe_config -> crc_enabled ; } if ( IS_GEMINILAKE ( dev_priv ) || IS_BROXTON ( dev_priv ) ) { pipe_config -> lane_lat_optim_mask = bxt_ddi_phy_calc_lane_lat_optim_mask ( pipe_config -> lane_count ) ; } intel_ddi_compute_min_voltage_level ( dev_priv , pipe_config ) ; return 0 ; } 