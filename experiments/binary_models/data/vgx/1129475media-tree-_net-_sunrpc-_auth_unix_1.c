static int unx_match ( struct auth_cred * acred , struct rpc_cred * rcred , int flags ) { struct unx_cred * cred = container_of ( rcred , unx_cred , uc_base ) ; int groups = 0 ; unsigned int i ; if ( ! uid_eq ( cred -> uc_uid , acred -> uid ) || ! gid_eq ( cred -> uc_gid , acred -> gid ) ) { return 0 ; } if ( acred -> group_info != NULL ) { groups = acred -> group_info -> ngroups ; } if ( groups > UNX_NGROUPS ) { groups = UNX_NGROUPS ; } for ( i = 0 ; i < groups ; i ++ ) { if ( ! gid_eq ( cred -> uc_gids [ i ] , acred -> group_info -> gid [ i ] ) ) { return 0 ; } } if ( groups < UNX_NGROUPS && gid_valid ( cred -> uc_gids [ groups ] ) ) { return 0 ; } return 1 ; } 