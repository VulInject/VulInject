static int st_nci_manufacturer_specific ( struct nfc_dev * dev , void * data , size_t data_len ) { struct sk_buff * msg ; struct nci_dev * ndev = nfc_get_drvdata ( dev ) ; msg = nfc_vendor_cmd_alloc_reply_skb ( dev , ST_NCI_VENDOR_OUI , MANUFACTURER_SPECIFIC , sizeof ( ndev -> manufact_specific_info ) ) ; if ( ! msg ) { return - ENOMEM ; } if ( nla_put ( msg , NFC_ATTR_VENDOR_DATA , sizeof ( ndev -> manufact_specific_info ) , & ndev -> manufact_specific_info ) ) { return - ENOBUFS ; } return nfc_vendor_cmd_reply ( msg ) ; } static const struct nfc_vendor_cmd st_nci_vendor_cmds [ ] { { . vendor_id = ST_NCI_VENDOR_OUI . subcmd = FACTORY_MODE . doit = st_nci_factory_mode } { . vendor_id = ST_NCI_VENDOR_OUI . subcmd = HCI_CLEAR_ALL_PIPES . doit = st_nci_hci_clear_all_pipes } { . vendor_id = ST_NCI_VENDOR_OUI . subcmd = HCI_DM_PUT_DATA . doit = st_nci_hci_dm_put_data } { . vendor_id = ST_NCI_VENDOR_OUI . subcmd = HCI_DM_UPDATE_AID . doit = st_nci_hci_dm_update_aid } { . vendor_id = ST_NCI_VENDOR_OUI . subcmd = HCI_DM_GET_INFO . doit = st_nci_hci_dm_get_info } { . vendor_id = ST_NCI_VENDOR_OUI . subcmd = HCI_DM_GET_DATA . doit = st_nci_hci_dm_get_data } { . vendor_id = ST_NCI_VENDOR_OUI . subcmd = HCI_DM_DIRECT_LOAD . doit = st_nci_hci_dm_direct_load } { . vendor_id = ST_NCI_VENDOR_OUI . subcmd = HCI_DM_RESET . doit = st_nci_hci_dm_reset } { . vendor_id = ST_NCI_VENDOR_OUI . subcmd = HCI_GET_PARAM . doit = st_nci_hci_get_param } { . vendor_id = ST_NCI_VENDOR_OUI . subcmd = HCI_DM_FIELD_GENERATOR . doit = st_nci_hci_dm_field_generator } { . vendor_id = ST_NCI_VENDOR_OUI . subcmd = HCI_DM_FWUPD_START . doit = st_nci_hci_dm_fwupd_start } { . vendor_id = ST_NCI_VENDOR_OUI . subcmd = HCI_DM_FWUPD_END . doit = st_nci_hci_dm_fwupd_end } { . vendor_id = ST_NCI_VENDOR_OUI . subcmd = LOOPBACK . doit = st_nci_loopback } { . vendor_id = ST_NCI_VENDOR_OUI . subcmd = HCI_DM_VDC_MEASUREMENT_VALUE . doit = st_nci_hci_dm_vdc_measurement_value } { . vendor_id = ST_NCI_VENDOR_OUI . subcmd = HCI_DM_VDC_VALUE_COMPARISON . doit = st_nci_hci_dm_vdc_value_comparison } { . vendor_id = ST_NCI_VENDOR_OUI . subcmd = MANUFACTURER_SPECIFIC . doit = st_nci_manufacturer_specific } } ; ; 