void sec_clnt_freeh ( AUTH * auth ) { struct desauthent * da ; switch ( auth -> ah_cred . oa_flavor ) { case AUTH_NONE : case AUTH_UNIX : case AUTH_LOOPBACK : auth_destroy ( auth ) ; break ; case AUTH_DES : mutex_enter ( & desauthtab_lock ) ; if ( desauthtab != NULL ) { for ( da = desauthtab ; da < & desauthtab [ clnt_authdes_cachesz ] ; da ++ ) { if ( da -> da_auth == auth ) { mutex_exit ( & desauthtab_lock ) ; return ; } } } mutex_exit ( & desauthtab_lock ) ; auth_destroy ( auth ) ; break ; case RPCSEC_GSS : ( void ) rpc_gss_secfree ( auth ) ; break ; default : cmn_err ( CE_NOTE , "sec_clnt_freeh: unknown authflavor %d" , auth -> ah_cred . oa_flavor ) ; break ; } } 