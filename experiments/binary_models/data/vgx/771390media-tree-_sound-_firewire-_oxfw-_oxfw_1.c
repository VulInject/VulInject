static int detect_quirks ( struct snd_oxfw * oxfw ) { struct fw_device * fw_dev = fw_parent_device ( oxfw -> unit ) ; struct fw_csr_iterator it ; int key , val ; int vendor , model ; if ( oxfw -> entry -> vendor_id == VENDOR_LACIE ) { return snd_oxfw_add_spkr ( oxfw , true ) ; } if ( oxfw -> entry -> vendor_id == OUI_STANTON ) { oxfw -> midi_input_ports = 0 ; oxfw -> midi_output_ports = 0 ; oxfw -> has_output = false ; return snd_oxfw_scs1x_add ( oxfw ) ; } if ( oxfw -> entry -> vendor_id == VENDOR_TASCAM ) { oxfw -> midi_input_ports ++ ; oxfw -> midi_output_ports ++ ; return 0 ; } vendor = model = 0 ; fw_csr_iterator_init ( & it , fw_dev -> config_rom + 5 ) ; while ( fw_csr_iterator_next ( & it , & key , & val ) ) { if ( key == CSR_VENDOR ) { vendor = val ; } if ( key == CSR_MODEL ) { model = val ; } } if ( vendor == VENDOR_LOUD && model == MODEL_SATELLITE ) { oxfw -> wrong_dbs = true ; } return 0 ; } 