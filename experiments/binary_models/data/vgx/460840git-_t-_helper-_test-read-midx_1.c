static int read_midx_preferred_pack ( const char * object_dir ) { struct multi_pack_index * midx = NULL ; struct bitmap_index * bitmap = NULL ; setup_git_directory ( ) ; midx = load_multi_pack_index ( object_dir , 1 ) ; if ( ! midx ) { return 1 ; } bitmap = prepare_bitmap_git ( the_repository , NULL ) ; if ( ! bitmap ) { return 1 ; } if ( ! bitmap_is_midx ( bitmap ) ) { free_bitmap_index ( bitmap ) ; return 1 ; } printf ( "%s\n" , midx -> pack_names [ midx_preferred_pack ( bitmap ) ] ) ; free_bitmap_index ( bitmap ) ; return 0 ; } 