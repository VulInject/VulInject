struct prestera_acl_rule * prestera_acl_rule_create ( struct prestera_acl_ruleset * ruleset , unsigned long cookie , u32 chain_index ) { struct prestera_acl_rule * rule ; rule = kmalloc ( sizeof ( * rule ) , GFP_KERNEL ) ; if ( ! rule ) { return ERR_PTR ( - ENOMEM ) ; } rule -> ruleset = ruleset ; rule -> cookie = cookie ; rule -> chain_index = chain_index ; refcount_inc ( & ruleset -> refcount ) ; return rule ; } 