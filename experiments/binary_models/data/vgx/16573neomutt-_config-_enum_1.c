static int enum_string_set ( const struct ConfigSet * cs , void * var , struct ConfigDef * cdef , const char * value , struct Buffer * err ) { if ( ! cs || ! cdef || ! value ) { return CSR_ERR_CODE ; } struct EnumDef * ed = ( EnumDef * ) cdef -> data ; if ( ! ed || ! ed -> lookup ) { return CSR_ERR_CODE ; } int num = mutt_map_get_value ( value , ed -> lookup ) ; if ( num < 0 ) { mutt_buffer_printf ( err , _ ( "Invalid enum value: %s" ) , value ) ; return ( CSR_ERR_INVALID | CSR_INV_TYPE ) ; } if ( var ) { if ( cdef -> validator ) { int rc = cdef -> validator ( cs , cdef , ( intptr_t ) num , err ) ; if ( CSR_RESULT ( rc ) != CSR_SUCCESS ) { return ( rc | CSR_INV_VALIDATOR ) ; } } * ( unsigned char * ) var = num ; } else { cdef -> initial = num ; } return CSR_SUCCESS ; } 