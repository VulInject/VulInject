static int check_oem ( smbios_hdl_t * shp ) { int i ; int cnt ; int rv ; id_t oem_id ; smbios_struct_t s ; const char * * oem_str ; rv = smbios_lookup_type ( shp , SMB_TYPE_OEMSTR , & s ) ; oem_id = s . smbstr_id ; cnt = smbios_info_strtab ( shp , oem_id , 0 , NULL ) ; if ( cnt > 0 ) { oem_str = alloca ( sizeof ( char * ) * cnt ) ; ( void ) smbios_info_strtab ( shp , oem_id , cnt , oem_str ) ; for ( i = 0 ; i < cnt ; i ++ ) { if ( strncmp ( oem_str [ i ] , SMB_PRMS1 , strlen ( SMB_PRMS1 ) + 1 ) == 0 ) { return ( 0 ) ; } } } return ( - 1 ) ; } 