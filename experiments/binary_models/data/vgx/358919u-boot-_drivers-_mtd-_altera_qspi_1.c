int flash_erase ( flash_info_t * info , int s_first , int s_last ) { struct mtd_info * mtd = info -> mtd ; struct erase_info instr ; int ret ; instr . mtd = mtd ; instr . addr = mtd -> erasesize * s_first ; instr . len = mtd -> erasesize * ( s_last + 1 - s_first ) ; flash_set_verbose ( 1 ) ; ret = mtd_erase ( mtd , & instr ) ; flash_set_verbose ( 0 ) ; if ( ret ) { return ERR_PROTECTED ; } puts ( " done\n" ) ; return 0 ; } 