static void esas2r_initmem_free ( struct esas2r_adapter * a , struct esas2r_mem_desc * mem_desc ) { if ( mem_desc -> phys_addr ) { int unalign = ( ( u8 * ) mem_desc -> virt_addr ) - ( ( u8 * ) mem_desc -> esas2r_data ) ; dma_free_coherent ( & a -> pcid -> dev , ( size_t ) mem_desc -> esas2r_param , mem_desc -> esas2r_data , ( dma_addr_t ) ( mem_desc -> phys_addr - unalign ) ) ; } else { kfree ( mem_desc -> esas2r_data ) ; } mem_desc -> virt_addr = NULL ; } 