static ulong meson_clk_set_rate_by_id ( struct clk * clk , unsigned long id , ulong rate , ulong current_rate ) { if ( current_rate == rate ) { return 0 ; } switch ( id ) { case CLKID_FIXED_PLL : case CLKID_SYS_PLL : case CLKID_FCLK_DIV2 : case CLKID_FCLK_DIV3 : case CLKID_FCLK_DIV4 : case CLKID_FCLK_DIV5 : case CLKID_FCLK_DIV7 : case CLKID_MPLL0 : case CLKID_MPLL1 : case CLKID_MPLL2 : case CLKID_CLK81 : case CLKID_PCIE_PLL : return meson_pcie_pll_set_rate ( clk , rate ) ; return 0 ; case CLKID_VPU : return meson_clk_set_rate_by_id ( clk , meson_mux_get_parent ( clk , CLKID_VPU ) , rate , current_rate ) ; case CLKID_VAPB : case CLKID_VAPB_SEL : return meson_clk_set_rate_by_id ( clk , meson_mux_get_parent ( clk , CLKID_VAPB_SEL ) , rate , current_rate ) ; case CLKID_VPU_0 : return meson_div_set_rate ( clk , CLKID_VPU_0_DIV , rate , current_rate ) ; case CLKID_VPU_1 : return meson_div_set_rate ( clk , CLKID_VPU_1_DIV , rate , current_rate ) ; case CLKID_VAPB_0 : return meson_div_set_rate ( clk , CLKID_VAPB_0_DIV , rate , current_rate ) ; case CLKID_VAPB_1 : return meson_div_set_rate ( clk , CLKID_VAPB_1_DIV , rate , current_rate ) ; case CLKID_VPU_0_DIV : case CLKID_VPU_1_DIV : case CLKID_VAPB_0_DIV : case CLKID_VAPB_1_DIV : case CLKID_HDMI_DIV : return meson_div_set_rate ( clk , id , rate , current_rate ) ; case CLKID_HDMI : return meson_clk_set_rate_by_id ( clk , CLKID_HDMI_DIV , rate , current_rate ) ; default : return - ENOENT ; } return - EINVAL ; } 