int uoaklux_get_sensor_setting ( struct uoaklux_softc * sc , enum uoak_target target ) { struct uoak_softc * scc = & sc -> sc_uoak_softc ; uint8_t result ; scc -> sc_rcmd . target = target ; scc -> sc_rcmd . datasize = 0x1 ; USETW ( & scc -> sc_rcmd . cmd , OAK_CMD_SENSORSETTING ) ; if ( uoak_get_cmd ( scc ) < 0 ) { return EIO ; } result = scc -> sc_buf [ 1 ] ; sc -> sc_sensor . gain = ( ( result & OAK_LUX_SENSOR_GAIN_MASK ) >> 3 ) ; sc -> sc_sensor . inttime = ( result & OAK_LUX_SENSOR_INTTIME_MASK ) ; return 0 ; } 