extern int onigenc_unicode_property_name_to_ctype ( OnigEncoding enc , UChar * name , UChar * end ) { int len ; UChar * p ; OnigCodePoint code ; const struct PoolPropertyNameCtype * pc ; char buf [ PROPERTY_NAME_MAX_SIZE ] ; p = name ; len = 0 ; while ( p < end ) { code = ONIGENC_MBC_TO_CODE ( enc , p , end ) ; if ( code >= 0x80 ) { return ONIGERR_INVALID_CHAR_PROPERTY_NAME ; } if ( code != ' ' && code != '-' && code != '_' ) { buf [ len ++ ] = ( char ) code ; } p += enclen ( enc , p ) ; } buf [ len ] = 0 ; if ( UserDefinedPropertyTable != 0 ) { UserDefinedPropertyValue * e ; e = ( UserDefinedPropertyValue * ) NULL ; onig_st_lookup_strend ( UserDefinedPropertyTable , ( const UChar * ) buf , ( const UChar * ) buf + len , ( hash_data_type * ) ( ( void * ) ( & e ) ) ) ; if ( e != 0 ) { return e -> ctype ; } } pc = unicode_lookup_property_name ( buf , len ) ; if ( pc != 0 ) { if ( pc -> ctype > ONIGENC_MAX_STD_CTYPE ) { return ONIGERR_INVALID_CHAR_PROPERTY_NAME ; } return ( int ) pc -> ctype ; } return ONIGERR_INVALID_CHAR_PROPERTY_NAME ; } 