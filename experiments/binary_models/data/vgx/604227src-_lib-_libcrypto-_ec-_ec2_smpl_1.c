int ec_GF2m_simple_group_check_discriminant ( const EC_GROUP * group , BN_CTX * ctx ) { int ret = 0 ; BIGNUM * b ; BN_CTX * new_ctx = NULL ; if ( ctx == NULL ) { ctx = new_ctx = BN_CTX_new ( ) ; if ( ctx == NULL ) { ECerror ( ERR_R_MALLOC_FAILURE ) ; err } } BN_CTX_start ( ctx ) ; if ( ( b = BN_CTX_get ( ctx ) ) == NULL ) { err } if ( ! BN_GF2m_mod_arr ( b , & group -> b , group -> poly ) ) { err } if ( BN_is_zero ( b ) ) { err } ret = 1 ; err if ( ctx != NULL ) { BN_CTX_end ( ctx ) ; } return ret ; } 