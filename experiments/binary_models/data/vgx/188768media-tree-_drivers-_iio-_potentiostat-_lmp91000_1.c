static irqreturn_t lmp91000_buffer_handler ( int irq , void * private ) { struct iio_poll_func * pf = private ; struct iio_dev * indio_dev = pf -> indio_dev ; struct lmp91000_data * data = iio_priv ( indio_dev ) ; int ret , val ; ret = lmp91000_read ( data , LMP91000_REG_MODECN_3LEAD , & val ) ; if ( ! ret ) { data -> buffer [ 0 ] = val ; iio_push_to_buffers_with_timestamp ( indio_dev , data -> buffer , iio_get_time_ns ( indio_dev ) ) ; } iio_trigger_notify_done ( indio_dev -> trig ) ; return IRQ_HANDLED ; } 