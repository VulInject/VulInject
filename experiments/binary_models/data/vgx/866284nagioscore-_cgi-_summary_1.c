void document_header ( int use_stylesheet ) { char date_time [ MAX_DATETIME_LENGTH ] ; time_t current_time ; time_t expire_time ; printf ( "Cache-Control: no-store\r\n" ) ; printf ( "Pragma: no-cache\r\n" ) ; time ( & current_time ) ; get_time_string ( & current_time , date_time , sizeof ( date_time ) , HTTP_DATE_TIME ) ; printf ( "Last-Modified: %s\r\n" , date_time ) ; expire_time = ( time_t ) 0 ; get_time_string ( & expire_time , date_time , sizeof ( date_time ) , HTTP_DATE_TIME ) ; printf ( "Expires: %s\r\n" , date_time ) ; if ( output_format == HTML_OUTPUT ) { printf ( "Content-type: text/html; charset=utf-8\r\n\r\n" ) ; } else { printf ( "Content-type: text/plain\r\n\r\n" ) ; return ; } if ( embedded == TRUE || output_format == CSV_OUTPUT ) { return ; } printf ( "<html>\n" ) ; printf ( "<head>\n" ) ; printf ( "<link rel=\"shortcut icon\" href=\"%sfavicon.ico\" type=\"image/ico\">\n" , url_images_path ) ; printf ( "<title>\n" ) ; printf ( "Nagios Event Summary\n" ) ; printf ( "</title>\n" ) ; if ( use_stylesheet == TRUE ) { printf ( "<LINK REL='stylesheet' TYPE='text/css' HREF='%s%s'>\n" , url_stylesheets_path , COMMON_CSS ) ; printf ( "<LINK REL='stylesheet' TYPE='text/css' HREF='%s%s'>\n" , url_stylesheets_path , SUMMARY_CSS ) ; } printf ( "</head>\n" ) ; printf ( "<BODY CLASS='summary'>\n" ) ; include_ssi_files ( SUMMARY_CGI , SSI_HEADER ) ; return ; } void document_footer ( void ) { if ( output_format != HTML_OUTPUT ) { return ; } include_ssi_files ( SUMMARY_CGI , SSI_FOOTER ) ; printf ( "</body>\n" ) ; printf ( "</html>\n" ) ; return ; } int process_cgivars ( void ) { } 