return ( false ) ; bc = SFGrowTo ( sf , b , enc , map ) ; gid = map -> map [ enc ] ; if ( charname [ 0 ] != '\0' && sf -> onlybitmaps && ( sf -> bitmaps == NULL || ( sf -> bitmaps == b && b -> next == NULL ) ) ) { free ( sf -> glyphs [ gid ] -> name ) ; sf -> glyphs [ gid ] -> name = cleancopy ( charname ) ; sf -> glyphs [ gid ] -> unicodeenc = - 1 ; } bc -> xmin = min_c ; bc -> xmax = max_c > min_c ?max_c : min_c ; bc -> ymin = min_r ; bc -> ymax = max_r > min_r ?max_r : min_r ; bc -> width = dx ; bc -> vwidth = b -> pixelsize ; bc -> bytes_per_line = ( ( bc -> xmax - bc -> xmin + 8 ) >> 3 ) ; bc -> bitmap = calloc ( bc -> bytes_per_line * ( bc -> ymax - bc -> ymin + 1 ) , 1 ) ; if ( sf -> glyphs [ gid ] -> layers [ ly_fore ] . splines == NULL && sf -> glyphs [ gid ] -> layers [ ly_fore ] . refs == NULL && ! sf -> glyphs [ gid ] -> widthset ) { sf -> glyphs [ gid ] -> width = aw ; sf -> glyphs [ gid ] -> widthset = true ; } for ( r = min_r , c = min_c , col = 0 ; r <= max_r ; ) { gf_skip_noops ( gf ) ; ch = getc ( gf ) ; if ( ch == gf_eoc ) { break ; } if ( ch >= gf_paint_0 && ch <= gf_paint3b ) { if ( ch >= gf_paint_0 && ch <= gf_paint_63 ) { cnt = ch - gf_paint_0 ; } if ( ch == gf_paint1b ) { cnt = getc ( gf ) ; } if ( ch == gf_paint2b ) { cnt = getushort ( gf ) ; } else { cnt = get3byte ( gf ) ; } if ( col ) { for ( i = 0 ; i < cnt && c <= max_c ; ++ i ) { bc -> bitmap [ ( r - min_r ) * bc -> bytes_per_line + ( ( c - min_c ) >> 3 ) ] |= ( 0x80 >> ( ( c - min_c ) & 7 ) ) ; ++ c ; } } else { c += cnt ; } col = ! col ; } if ( ch >= gf_newrow_0 && ch <= gf_newrow_164 ) { ++ r ; c = min_c + ch - gf_newrow_0 ; col = 1 ; } if ( ch >= gf_skip0 && ch <= gf_skip3 ) { col = 0 ; c = min_c ; if ( ch == gf_skip0 ) { ++ r ; } if ( ch == gf_skip1 ) { r += getc ( gf ) + 1 ; } if ( ch == gf_skip2 ) { r += getushort ( gf ) + 1 ; } else { r += get3byte ( gf ) + 1 ; } } if ( ch == EOF ) { LogError ( _ ( "Unexpected EOF in gf\n" ) ) ; break ; } else { LogError ( _ ( "Uninterpreted code in gf: %d\n" ) , ch ) ; } } fseek ( gf , pos , SEEK_SET ) ; return ( true ) ; 