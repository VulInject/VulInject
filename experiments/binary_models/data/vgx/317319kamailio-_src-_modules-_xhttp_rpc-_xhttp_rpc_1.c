static void rpc_fault ( rpc_ctx_t * ctx , int code , char * fmt , ... ) { va_list ap ; struct xhttp_rpc_reply * reply = & ctx -> reply ; reply -> code = code ; va_start ( ap , fmt ) ; vsnprintf ( error_buf , ERROR_REASON_BUF_LEN , fmt , ap ) ; va_end ( ap ) ; reply -> reason . len = strlen ( error_buf , NULL ) ; reply -> reason . s = error_buf ; reply -> body . len = 0 ; return ; } 