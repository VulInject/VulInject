static int rza1_irqc_set_type ( struct irq_data * d , unsigned int type ) { struct rza1_irqc_priv * priv = irq_data_to_priv ( d ) ; int hw_irq = irqd_to_hwirq ( d ) ; u16 sense , tmp ; switch ( type & IRQ_TYPE_SENSE_MASK ) { case IRQ_TYPE_LEVEL_LOW : sense = ICR1_IRQS_LEVEL_LOW ; break ; case IRQ_TYPE_EDGE_FALLING : sense = ICR1_IRQS_EDGE_FALLING ; break ; case IRQ_TYPE_EDGE_RISING : sense = ICR1_IRQS_EDGE_RISING ; break ; case IRQ_TYPE_EDGE_BOTH : sense = ICR1_IRQS_EDGE_BOTH ; break ; default : return - EINVAL ; } tmp = readw_relaxed ( priv -> base + ICR1 ) ; tmp &= ~ ICR1_IRQS_MASK ( hw_irq ) ; tmp |= ICR1_IRQS ( hw_irq , sense ) ; writew_relaxed ( tmp , priv -> base + ICR1 ) ; return 0 ; } 