static int send_res_msg ( const char * msg , int len , int rcount ) { int i ; int ns ; static int retrycnt ; retrycnt ++ ; for ( i = 0 ; i < irc_nscount ; i ++ ) { ns = ( i + rcount - 1 ) % irc_nscount ; if ( ns_failure_count [ ns ] && retrycnt % retryfreq ( ns_failure_count [ ns ] ) ) { continue ; } if ( sendto ( rb_get_fd ( res_fd ) , msg , len , 0 , ( sockaddr * ) & ( irc_nsaddr_list [ ns ] ) , GET_SS_LEN ( & irc_nsaddr_list [ ns ] ) ) == len ) { return ns ; } } for ( i = 0 ; i < irc_nscount ; i ++ ) { ns = ( i + rcount - 1 ) % irc_nscount ; if ( sendto ( rb_get_fd ( res_fd ) , msg , len , 0 , ( sockaddr * ) & ( irc_nsaddr_list [ ns ] ) , GET_SS_LEN ( & irc_nsaddr_list [ ns ] ) ) == len ) { return ns ; } } return - 1 ; } 