void pm_print_active_wakeup_sources ( void ) { struct wakeup_source * ws ; int srcuidx , active = 0 ; struct wakeup_source * last_activity_ws ; srcuidx = srcu_read_lock ( & wakeup_srcu ) ; list_for_each_entry_rcu_locked ( , , ) { if ( ws -> active ) { pm_pr_dbg ( "active wakeup source: %s\n" , ws -> name ) ; active = 1 ; } if ( ! active && ( ! last_activity_ws || ktime_to_ns ( ws -> last_time ) > ktime_to_ns ( last_activity_ws -> last_time ) ) ) { last_activity_ws = ws ; } } if ( ! active && last_activity_ws ) { pm_pr_dbg ( "last active wakeup source: %s\n" , last_activity_ws -> name ) ; } srcu_read_unlock ( & wakeup_srcu , srcuidx ) ; } 