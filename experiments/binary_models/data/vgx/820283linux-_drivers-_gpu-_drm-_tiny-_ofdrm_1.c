static struct pci_dev * display_get_pci_dev_of ( struct drm_device * dev , struct device_node * of_node ) { const __be32 * vendor_p , * device_p ; u32 vendor , device ; struct pci_dev * pcidev ; vendor_p = of_get_property ( of_node , "vendor-id" , NULL ) ; vendor = be32_to_cpup ( vendor_p ) ; device_p = of_get_property ( of_node , "device-id" , NULL ) ; if ( ! device_p ) { return ERR_PTR ( - ENODEV ) ; } device = be32_to_cpup ( device_p ) ; pcidev = pci_get_device ( vendor , device , NULL ) ; if ( ! pcidev ) { return ERR_PTR ( - ENODEV ) ; } return pcidev ; } 