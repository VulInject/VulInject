BOOL gcc_read_client_network_data ( wStream * s , rdpMcs * mcs , UINT16 blockLength ) { UINT32 i ; WINPR_ASSERT ( s , NULL ) ; WINPR_ASSERT ( mcs ) ; if ( blockLength < 4 ) { return FALSE ; } Stream_Read_UINT32 ( s , mcs -> channelCount ) ; if ( blockLength < 4 + mcs -> channelCount * 12 ) { return FALSE ; } if ( mcs -> channelCount > CHANNEL_MAX_COUNT ) { return FALSE ; } for ( i = 0 ; i < mcs -> channelCount ; i ++ ) { rdpMcsChannel * channel = & mcs -> channels [ i ] ; Stream_Read ( s , channel -> Name , CHANNEL_NAME_LEN + 1 ) ; if ( ! memchr ( channel -> Name , 0 , CHANNEL_NAME_LEN + 1 ) ) { WLog_ERR ( TAG , "protocol violation: received a static channel name with missing null-termination" ) ; return FALSE ; } Stream_Read_UINT32 ( s , channel -> options ) ; channel -> ChannelId = mcs -> baseChannelId ++ ; } return TRUE ; } 