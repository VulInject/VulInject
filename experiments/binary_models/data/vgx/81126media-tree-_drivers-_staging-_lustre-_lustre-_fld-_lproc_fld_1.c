static ssize_t fld_debugfs_hash_seq_write ( struct file * file , const char __user * buffer , size_t count , loff_t * off ) { struct lu_client_fld * fld ; struct lu_fld_hash * hash = NULL ; char fh_name [ 8 ] ; int i ; if ( count > sizeof ( fh_name ) ) { return - ENAMETOOLONG ; } if ( copy_from_user ( fh_name , buffer , count ) != 0 ) { return - EFAULT ; } fld = ( ( seq_file * ) file -> private_data ) -> private ; for ( i = 0 ; fld_hash [ i ] . fh_name ; i ++ ) { if ( ! strncmp ( fld_hash [ i ] . fh_name , fh_name , count ) ) { hash = & fld_hash [ i ] ; break ; } } if ( hash ) { spin_lock ( & fld -> lcf_lock ) ; fld -> lcf_hash = hash ; spin_unlock ( & fld -> lcf_lock ) ; CDEBUG ( D_INFO , "%s: Changed hash to \"%s\"\n" , fld -> lcf_name , hash -> fh_name ) ; } return count ; } 