static int pkey_hmac_ctrl_str ( EVP_PKEY_CTX * ctx , const char * type , const char * value ) { if ( ! value ) { return 0 ; } if ( ! strcmp ( type , "key" ) ) { void * p = ( void * ) value ; return pkey_hmac_ctrl ( ctx , EVP_PKEY_CTRL_SET_MAC_KEY , - 1 , p ) ; } if ( ! strcmp ( type , "hexkey" ) ) { unsigned char * key ; int r ; long keylen ; key = string_to_hex ( value , & keylen ) ; if ( ! key ) { return 0 ; } r = pkey_hmac_ctrl ( ctx , EVP_PKEY_CTRL_SET_MAC_KEY , keylen , key ) ; return r ; } return - 2 ; } 