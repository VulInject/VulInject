static int copy_from_registers ( char * buf , struct arm_smccc_res * res , size_t bytes ) { unsigned int chunk , copied ; chunk = min ( bytes , sizeof ( long ) ) ; memcpy ( buf , & res -> a3 , chunk ) ; copied = chunk ; if ( copied >= bytes ) { return copied ; } chunk = min ( ( bytes - copied ) , sizeof ( long ) ) ; memcpy ( & buf [ copied ] , & res -> a2 , chunk ) ; copied += chunk ; if ( copied >= bytes ) { return copied ; } chunk = min ( ( bytes - copied ) , sizeof ( long ) ) ; memcpy ( & buf [ copied ] , & res -> a1 , chunk ) ; return copied + chunk ; } 