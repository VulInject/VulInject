static int FUN1 ( struct VAR1 * VAR2 , int write , void VAR3 * VAR4 , VAR5 * VAR6 , VAR7 * VAR8 ) { struct VAR9 * VAR10 = NULL , * VAR11 ; unsigned int VAR12 ; int VAR13 , VAR14 ; char VAR15 [ 2 ] ; struct VAR16 * VAR17 ; VAR14 = 0 ; FUN2 ( & VAR18 ) ; FUN3 ( , ) { VAR11 = FUN4 ( VAR17 , VAR9 , VAR19 ) ; if ( & VAR11 -> VAR1 [ 2 ] == VAR2 ) { VAR14 = 1 ; } } if ( ! VAR14 ) { FUN5 ( & VAR18 ) ; return - VAR20 ; } VAR10 = VAR2 -> VAR21 ; if ( ! FUN6 ( VAR10 -> VAR22 ) ) { FUN5 ( & VAR18 ) ; return - VAR20 ; } FUN5 ( & VAR18 ) ; if ( ! * VAR6 || * VAR8 ) { * VAR6 = 0 ; FUN7 ( VAR10 -> VAR22 , NULL ) ; return 0 ; } if ( ! write ) { strncpy ( VAR15 , VAR10 -> VAR23 ?"" : "" , FUN8 ( VAR15 ) ) ; VAR12 = FUN9 ( VAR15 , FUN8 ( VAR15 ) ) ; if ( VAR12 > * VAR6 ) { VAR12 = * VAR6 ; } if ( FUN10 ( VAR4 , VAR15 , VAR12 ) ) { FUN7 ( VAR10 -> VAR22 ) ; return - VAR24 ; } VAR25 } VAR12 = * VAR6 ; if ( FUN11 ( VAR15 , VAR4 , VAR12 > sizeof ( VAR15 ) ?sizeof ( VAR15 ) : VAR12 ) ) { FUN7 ( VAR10 -> VAR22 ) ; return - VAR24 ; } FUN2 ( & VAR18 ) ; if ( ( VAR15 [ 0 ] == '' ) && ( VAR10 -> VAR23 == 0 ) ) { if ( ! FUN6 ( VAR10 -> VAR22 ) ) { FUN5 ( & VAR18 ) ; FUN7 ( VAR10 -> VAR22 ) ; return - VAR20 ; } VAR10 -> FUN12 ( VAR10 -> VAR21 ) ; VAR13 = FUN13 ( VAR10 -> VAR26 , VAR27 , ( unsigned long ) VAR10 -> VAR21 , VAR10 -> VAR28 , VAR10 -> VAR29 ) ; if ( VAR13 != 0 ) { FUN14 ( "" "" , VAR10 -> VAR30 , VAR13 ) ; FUN7 ( VAR10 -> VAR22 ) ; } else { VAR10 -> VAR23 = 1 ; } } if ( ( VAR15 [ 0 ] == '' ) && ( VAR10 -> VAR23 == 1 ) ) { VAR10 -> VAR23 = 0 ; VAR13 = FUN13 ( VAR10 -> VAR26 , VAR31 , ( unsigned long ) VAR10 -> VAR21 , VAR10 -> VAR28 , VAR10 -> VAR29 ) ; if ( VAR13 != 0 ) { FUN14 ( "" "" , VAR10 -> VAR30 , VAR13 ) ; } FUN7 ( VAR10 -> VAR22 ) ; } FUN5 ( & VAR18 ) ; VAR25 * VAR6 = VAR12 ; * VAR8 += VAR12 ; FUN7 ( VAR10 -> VAR22 ) ; return 0 ; }