static int qed_sp_iscsi_conn_update ( struct qed_hwfn * p_hwfn , struct qed_iscsi_conn * p_conn , enum spq_mode comp_mode , struct qed_spq_comp_cb * p_comp_addr ) { struct iscsi_conn_update_ramrod_params * p_ramrod = NULL ; struct qed_spq_entry * p_ent = NULL ; struct qed_sp_init_data init_data ; int rc = - EINVAL ; u32 dval ; init_data . cid = p_conn -> icid ; init_data . opaque_fid = p_hwfn -> hw_info . opaque_fid ; init_data . comp_mode = comp_mode ; init_data . p_comp_data = p_comp_addr ; rc = qed_sp_init_request ( p_hwfn , & p_ent , ISCSI_RAMROD_CMD_ID_UPDATE_CONN , PROTOCOLID_ISCSI , & init_data ) ; if ( rc ) { return rc ; } p_ramrod = & p_ent -> ramrod . iscsi_conn_update ; p_ramrod -> hdr . op_code = ISCSI_RAMROD_CMD_ID_UPDATE_CONN ; SET_FIELD ( p_ramrod -> hdr . flags , ISCSI_SLOW_PATH_HDR_LAYER_CODE , p_conn -> layer_code ) ; p_ramrod -> conn_id = cpu_to_le16 ( p_conn -> conn_id ) ; p_ramrod -> fw_cid = cpu_to_le32 ( p_conn -> icid ) ; p_ramrod -> flags = p_conn -> update_flag ; p_ramrod -> max_seq_size = cpu_to_le32 ( p_conn -> max_seq_size ) ; dval = p_conn -> max_recv_pdu_length ; p_ramrod -> max_recv_pdu_length = cpu_to_le32 ( dval ) ; dval = p_conn -> max_send_pdu_length ; p_ramrod -> max_send_pdu_length = cpu_to_le32 ( dval ) ; dval = p_conn -> first_seq_length ; p_ramrod -> first_seq_length = cpu_to_le32 ( dval ) ; p_ramrod -> exp_stat_sn = cpu_to_le32 ( p_conn -> exp_stat_sn ) ; return qed_spq_post ( p_hwfn , p_ent , NULL ) ; } 