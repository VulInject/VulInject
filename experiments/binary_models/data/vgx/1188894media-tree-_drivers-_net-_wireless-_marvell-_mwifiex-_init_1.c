static void mwifiex_adapter_cleanup ( struct mwifiex_adapter * adapter ) { if ( ! adapter ) { pr_err ( "%s: adapter is NULL\n" , __func__ ) ; return ; } del_timer ( & adapter -> wakeup_timer ) ; mwifiex_cancel_all_pending_cmd ( adapter ) ; wake_up_interruptible ( & adapter -> cmd_wait_q . wait ) ; wake_up_interruptible ( & adapter -> hs_activate_wait_q ) ; mwifiex_free_lock_list ( adapter ) ; mwifiex_dbg ( adapter , INFO , "info: free cmd buffer\n" ) ; if ( adapter -> sleep_cfm ) { dev_kfree_skb_any ( adapter -> sleep_cfm ) ; } } 