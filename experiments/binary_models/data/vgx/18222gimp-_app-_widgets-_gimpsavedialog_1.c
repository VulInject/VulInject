gimp_save_dialog_add_extra_widgets ( ) { GtkWidget * label ; GtkWidget * reasons ; GtkWidget * compression_toggle ; compression_toggle = gtk_check_button_new_with_mnemonic ( _ ( "Save this _XCF file with better but slower compression" ) ) ; gtk_widget_set_tooltip_text ( compression_toggle , _ ( "On edge cases, better compression algorithms might still " "end up on bigger file size; manual check recommended" ) ) ; dialog -> compression_frame = gimp_frame_new ( NULL ) ; gtk_frame_set_label_widget ( GTK_FRAME ( dialog -> compression_frame ) , compression_toggle ) ; gtk_widget_show ( compression_toggle ) ; gimp_file_dialog_add_extra_widget ( GIMP_FILE_DIALOG ( dialog ) , dialog -> compression_frame , FALSE , FALSE , 0 ) ; gtk_widget_show ( dialog -> compression_frame ) ; dialog -> compat_info = gtk_expander_new ( NULL , NULL ) ; label = gtk_label_new ( "" ) ; gtk_expander_set_label_widget ( GTK_EXPANDER ( dialog -> compat_info ) , label ) ; gtk_widget_show ( label ) ; gtk_label_set_xalign ( GTK_LABEL ( label ) , 0.0 ) ; reasons = gtk_text_view_new ( ) ; gtk_text_view_set_editable ( GTK_TEXT_VIEW ( reasons ) , FALSE ) ; gtk_text_view_set_cursor_visible ( GTK_TEXT_VIEW ( reasons ) , FALSE ) ; gtk_container_add ( GTK_CONTAINER ( dialog -> compat_info ) , reasons ) ; gtk_widget_show ( reasons ) ; gimp_file_dialog_add_extra_widget ( GIMP_FILE_DIALOG ( dialog ) , dialog -> compat_info , FALSE , FALSE , 0 ) ; gtk_widget_show ( dialog -> compat_info ) ; g_signal_connect ( compression_toggle , "toggled" , G_CALLBACK ( gimp_save_dialog_compression_toggled ) , dialog ) ; } 