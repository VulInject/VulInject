XKB_EXPORT struct rxkb_context * rxkb_context_new ( enum rxkb_context_flags flags ) { struct rxkb_context * ctx = rxkb_context_create ( NULL ) ; const char * env ; if ( ! ctx ) { return in ; } ctx -> context_state = CONTEXT_NEW ; ctx -> load_extra_rules_files = flags & RXKB_CONTEXT_LOAD_EXOTIC_RULES ; ctx -> use_secure_getenv = ! ( flags & RXKB_CONTEXT_NO_SECURE_GETENV ) ; ctx -> log_fn = default_log_fn ; ctx -> log_level = RXKB_LOG_LEVEL_ERROR ; env = rxkb_context_getenv ( ctx , "RXKB_LOG_LEVEL" ) ; if ( env ) { rxkb_context_set_log_level ( ctx , log_level ( env ) ) ; } list_init ( & ctx -> models ) ; list_init ( & ctx -> layouts ) ; list_init ( & ctx -> option_groups ) ; if ( ! ( flags & RXKB_CONTEXT_NO_DEFAULT_INCLUDES ) && ! rxkb_context_include_path_append_default ( ctx ) ) { rxkb_context_unref ( ctx ) ; return NULL ; } return ctx ; } 