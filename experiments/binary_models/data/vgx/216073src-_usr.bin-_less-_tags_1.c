static off_t ctagsearch ( void ) { off_t pos , linepos ; off_t linenum ; int len ; char * line ; pos = ch_zero ( ) ; linenum = find_linenum ( pos ) ; for ( ; ; ) { if ( abort_sigs ( ) ) { return ( - 1 ) ; } linepos = pos ; pos = forw_raw_line ( pos , & line , ( int * ) NULL ) ; if ( linenum != 0 ) { linenum ++ ; } if ( pos == - 1 ) { error ( "Tag not found" , NULL ) ; return ( - 1 ) ; } if ( linenums ) { add_lnum ( linenum , pos ) ; } len = strlen ( curtag -> tag_pattern ) ; if ( strncmp ( curtag -> tag_pattern , line , len ) == 0 && ( ! curtag -> tag_endline || line [ len ] == '\0' || line [ len ] == '\r' ) ) { curtag -> tag_linenum = find_linenum ( linepos ) ; break ; } } return ( linepos ) ; } static int circular = 0 ; static char * nextctag ( void ) { struct tag * tp ; if ( curtag == NULL ) { return ( NULL ) ; } tp = curtag -> next ; if ( tp == TAG_END ) { curtag = taglist . tl_first ; curseq = 1 ; } else { curtag = tp ; curseq ++ ; } return ( curtag -> tag_file ) ; } 