bool arch_uprobe_skip_sstep ( struct arch_uprobe * auprobe , struct pt_regs * regs ) { if ( ( psw_bits ( regs -> psw ) . eaba == PSW_AMODE_24BIT ) || ( ( psw_bits ( regs -> psw ) . eaba == PSW_AMODE_31BIT ) && ! is_compat_task ( ) ) ) { regs -> psw . addr = __rewind_psw ( regs -> psw , UPROBE_SWBP_INSN_SIZE ) ; do_report_trap ( regs , SIGILL , ILL_ILLADR ) ; return true ; } if ( probe_is_insn_relative_long ( auprobe -> insn ) ) { handle_insn_ril ( auprobe , regs ) ; return true ; } return false ; } 