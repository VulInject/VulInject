static void slot_modify_data ( TupleTableSlot * slot , TupleTableSlot * srcslot , LogicalRepRelMapEntry * rel , LogicalRepTupleData * tupleData ) { int natts = slot -> tts_tupleDescriptor -> natts ; int i ; ExecClearTuple ( slot ) ; Assert ( natts == srcslot -> tts_tupleDescriptor -> natts ) ; slot_getallattrs ( srcslot , NULL ) ; memcpy ( slot -> tts_values , srcslot -> tts_values , natts * sizeof ( Datum ) ) ; memcpy ( slot -> tts_isnull , srcslot -> tts_isnull , natts * sizeof ( bool ) ) ; Assert ( natts == rel -> attrmap -> maplen ) ; for ( i = 0 ; i < natts ; i ++ ) { Form_pg_attribute att = TupleDescAttr ( slot -> tts_tupleDescriptor , i ) ; int remoteattnum = rel -> attrmap -> attnums [ i ] ; if ( remoteattnum < 0 ) { continue ; } Assert ( remoteattnum < tupleData -> ncols ) ; if ( tupleData -> colstatus [ remoteattnum ] != LOGICALREP_COLUMN_UNCHANGED ) { StringInfo colvalue = & tupleData -> colvalues [ remoteattnum ] ; apply_error_callback_arg . remote_attnum = remoteattnum ; if ( tupleData -> colstatus [ remoteattnum ] == LOGICALREP_COLUMN_TEXT ) { Oid typinput ; Oid typioparam ; getTypeInputInfo ( att -> atttypid , & typinput , & typioparam ) ; slot -> tts_values [ i ] = OidInputFunctionCall ( typinput , colvalue -> data , typioparam , att -> atttypmod ) ; slot -> tts_isnull [ i ] = false ; } if ( tupleData -> colstatus [ remoteattnum ] == LOGICALREP_COLUMN_BINARY ) { Oid typreceive ; Oid typioparam ; colvalue -> cursor = 0 ; getTypeBinaryInputInfo ( att -> atttypid , & typreceive , & typioparam ) ; slot -> tts_values [ i ] = OidReceiveFunctionCall ( typreceive , colvalue , typioparam , att -> atttypmod ) ; if ( colvalue -> cursor != colvalue -> len ) { ereport ( ERROR , ( errcode ( ERRCODE_INVALID_BINARY_REPRESENTATION ) , errmsg ( "incorrect binary data format in logical replication column %d" , remoteattnum + 1 ) ) ) ; } slot -> tts_isnull [ i ] = false ; } else { slot -> tts_values [ i ] = ( Datum ) 0 ; slot -> tts_isnull [ i ] = true ; } apply_error_callback_arg . remote_attnum = - 1 ; } } ExecStoreVirtualTuple ( slot ) ; } 