mechanism_t * * getmechwrap ( ) { mechanism_t * * mechs = __nis_get_mechanisms ( FALSE ) ; mechanism_t * * mechsbak = NULL ; mechanism_t * desmech = NULL ; int i = 0 ; if ( mechs ) { for ( i = 0 ; mechs [ i ] ; i ++ ) { if ( AUTH_DES_COMPAT_CHK ( mechs [ i ] ) ) { return ( mechs ) ; } } } if ( ( desmech = malloc ( sizeof ( mechanism_t ) ) ) == NULL ) { if ( mechs ) { __nis_release_mechanisms ( mechs ) ; } return ( NULL ) ; } desmech -> mechname = NULL ; desmech -> alias = NIS_SEC_CF_DES_ALIAS ; desmech -> keylen = AUTH_DES_KEYLEN ; desmech -> algtype = AUTH_DES_ALGTYPE ; desmech -> qop = NULL ; desmech -> secserv = rpc_gss_svc_default ; mechsbak = mechs ; if ( ( mechs = ( mechanism_t * * ) realloc ( mechs , sizeof ( mechanism_t * ) * ( i + 2 ) ) ) == NULL ) { if ( mechsbak ) { __nis_release_mechanisms ( mechsbak ) ; } return ( NULL ) ; } mechs [ i ] = desmech ; mechs [ i + 1 ] = NULL ; return ( mechs ) ; } 