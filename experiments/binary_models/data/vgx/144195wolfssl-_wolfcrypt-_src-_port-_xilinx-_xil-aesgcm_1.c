static WC_INLINE int aligned_xmalloc ( byte * * buf , byte * * aligned , void * heap , word32 size , word32 align ) { byte * tmp = ( byte * ) XMALLOC ( size + align , heap , DYNAMIC_TYPE_TMP_BUFFER ) ; if ( tmp == NULL ) { return MEMORY_E ; } * buf = tmp ; * aligned = tmp + ( align - ( ( wc_ptr_t ) tmp % align ) ) ; return 0 ; WOLFSSL_MSG ( "AES-ECB encrypt with bad alignment" ) ; WOLFSSL_ERROR_VERBOSE ( BAD_ALIGN_E , NULL ) ; return BAD_ALIGN_E ; } 