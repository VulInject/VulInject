static int omap_dm_timer_free ( struct omap_dm_timer * cookie ) { struct dmtimer * timer ; struct device * dev ; int rc ; timer = to_dmtimer ( cookie ) ; WARN_ON ( ! timer -> reserved ) ; timer -> reserved = 0 ; dev = & timer -> pdev -> dev ; rc = pm_runtime_resume_and_get ( dev ) ; if ( rc ) { return rc ; } dmtimer_write ( timer , OMAP_TIMER_CTRL_REG , 0 ) ; pm_runtime_put_sync ( dev ) ; return 0 ; } 