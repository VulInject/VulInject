void proto_reg_handoff_mcpe ( void ) { static guint last_server_port ; static gboolean init_done = FALSE ; if ( init_done ) { raknet_delete_udp_dissector ( last_server_port , mcpe_handle ) ; } else { int i ; for ( i = 0 ; i < array_length ( mcpe_packet_handlers ) ; i ++ ) { dissector_add_uint ( "mcpe.packet.id" , mcpe_packet_handlers [ i ] . vs . value , create_dissector_handle ( mcpe_packet_handlers [ i ] . dissector_fp , proto_mcpe ) ) ; } heur_dissector_add ( "raknet" , dissect_mcpe_heur , "MCPE over RakNet" , "mcpe_raknet" , proto_mcpe , HEURISTIC_ENABLE ) ; } last_server_port = mcpe_udp_port_requested ; init_done = TRUE ; raknet_add_udp_dissector ( mcpe_udp_port_requested , mcpe_handle ) ; } 