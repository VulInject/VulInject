CG_InitLocalEntities ( ) ; CG_InitMarkPolys ( ) ; CG_ClearParticles ( ) ; for ( i = 1 ; i < MAX_PARTICLES_AREAS ; i ++ ) { { int rval ; rval = CG_NewParticleArea ( CS_PARTICLES + i ) ; if ( ! rval ) { break ; } } } CG_ClearTrails ( ) ; CG_ClearFlameChunks ( ) ; CG_SoundInit ( ) ; trap_RB_ZombieFXAddNewHit ( - 1 , NULL , NULL ) ; cg . fraglimitWarnings = 0 ; cg . timelimitWarnings = 0 ; cg . rewardTime = 0 ; cg . intermissionStarted = qfalse ; cg . levelShot = qfalse ; cgs . voteTime = 0 ; cg . lightstylesInited = qfalse ; cg . mapRestart = qtrue ; CG_StartMusic ( ) ; trap_S_ClearLoopingSounds ( qtrue ) ; cg . v_dmg_time = 0 ; cg . v_noFireTime = 0 ; cg . v_fireTime = 0 ; memset ( cgs . animScriptData . modelInfo , 0 , sizeof ( cgs . animScriptData . modelInfo ) ) ; for ( i = 0 ; i < MAX_CLIENTS ; i ++ ) { if ( cgs . clientinfo [ i ] . infoValid ) { CG_LoadClientInfo ( i , & cgs . clientinfo [ i ] ) ; } } cg . weaponSelect = WP_NONE ; memset ( & cg_entities [ 0 ] . pe . weap , 0 , sizeof ( cg_entities [ 0 ] . pe . weap ) ) ; if ( ! cg . weaponSelect ) { if ( cg_loadWeaponSelect . integer > 0 ) { cg . weaponSelect = cg_loadWeaponSelect . integer ; cg . weaponSelectTime = cg . time ; trap_Cvar_Set ( "cg_loadWeaponSelect" , "0" ) ; } } memset ( cg . cameraShakeAngles , 0 , sizeof ( cg . cameraShakeAngles ) ) ; cg . rumbleScale = 0 ; if ( cg_singlePlayerActive . integer ) { trap_Cvar_Set ( "ui_matchStartTime" , va ( "%i" , cg . time ) ) ; if ( cg_recordSPDemo . integer && * cg_recordSPDemoName . string ) { trap_SendConsoleCommand ( va ( "set g_synchronousclients 1 ; record %s \n" , cg_recordSPDemoName . string ) ) ; } } trap_Cvar_Set ( "cg_thirdPerson" , "0" ) ; 