int mbedtls_md ( const mbedtls_md_info_t * md_info , const unsigned char * input , size_t ilen , unsigned char * output ) { switch ( md_info -> type ) { case MBEDTLS_MD_MD5 : return mbedtls_md5 ( input , ilen , output ) ; case MBEDTLS_MD_RIPEMD160 : return mbedtls_ripemd160 ( input , ilen , output ) ; case MBEDTLS_MD_SHA1 : return mbedtls_sha1 ( input , ilen , output ) ; case MBEDTLS_MD_SHA224 : return mbedtls_sha256 ( input , ilen , output , 1 ) ; case MBEDTLS_MD_SHA256 : return mbedtls_sha256 ( input , ilen , output , 0 ) ; case MBEDTLS_MD_SHA384 : return mbedtls_sha512 ( input , ilen , output , 1 ) ; case MBEDTLS_MD_SHA512 : return mbedtls_sha512 ( input , ilen , output , 0 ) ; default : return MBEDTLS_ERR_MD_BAD_INPUT_DATA ; } } 