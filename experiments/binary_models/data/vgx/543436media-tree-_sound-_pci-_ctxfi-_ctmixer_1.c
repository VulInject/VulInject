static int ct_mixer_topology_build ( struct ct_mixer * mixer ) { struct sum * sum ; struct amixer * amix_d , * amix_s ; enum CT_AMIXER_CTL i , j ; for ( i = AMIXER_MASTER_F , j = SUM_IN_F ; i <= AMIXER_MASTER_S ; i ++ , j ++ ) { amix_d = mixer -> amixers [ i * CHN_NUM ] ; sum = mixer -> sums [ j * CHN_NUM ] ; amix_d -> ops -> setup ( amix_d , & sum -> rsc , INIT_VOL ) ; amix_d = mixer -> amixers [ i * CHN_NUM + 1 ] ; sum = mixer -> sums [ j * CHN_NUM + 1 ] ; amix_d -> ops -> setup ( amix_d , & sum -> rsc , INIT_VOL , NULL ) ; } for ( i = AMIXER_WAVE_F , j = AMIXER_MASTER_F ; i <= AMIXER_WAVE_S ; i ++ , j ++ ) { amix_d = mixer -> amixers [ i * CHN_NUM ] ; amix_s = mixer -> amixers [ j * CHN_NUM ] ; amix_d -> ops -> setup ( amix_d , & amix_s -> rsc , INIT_VOL , NULL ) ; amix_d = mixer -> amixers [ i * CHN_NUM + 1 ] ; amix_s = mixer -> amixers [ j * CHN_NUM + 1 ] ; amix_d -> ops -> setup ( amix_d , & amix_s -> rsc , INIT_VOL , NULL ) ; } amix_d = mixer -> amixers [ AMIXER_SPDIFO * CHN_NUM ] ; amix_s = mixer -> amixers [ AMIXER_MASTER_F * CHN_NUM ] ; amix_d -> ops -> setup ( amix_d , & amix_s -> rsc , INIT_VOL , NULL ) ; amix_d = mixer -> amixers [ AMIXER_SPDIFO * CHN_NUM + 1 ] ; amix_s = mixer -> amixers [ AMIXER_MASTER_F * CHN_NUM + 1 ] ; amix_d -> ops -> setup ( amix_d , & amix_s -> rsc , INIT_VOL , NULL ) ; for ( i = AMIXER_PCM_F , j = SUM_IN_F ; i <= AMIXER_PCM_S ; i ++ , j ++ ) { amix_d = mixer -> amixers [ i * CHN_NUM ] ; sum = mixer -> sums [ j * CHN_NUM ] ; amix_d -> ops -> setup ( amix_d , NULL , INIT_VOL , sum ) ; amix_d = mixer -> amixers [ i * CHN_NUM + 1 ] ; sum = mixer -> sums [ j * CHN_NUM + 1 ] ; amix_d -> ops -> setup ( amix_d , NULL , INIT_VOL , sum ) ; } amix_d = mixer -> amixers [ AMIXER_LINEIN * CHN_NUM ] ; sum = mixer -> sums [ SUM_IN_F * CHN_NUM ] ; amix_d -> ops -> setup ( amix_d , NULL , INIT_VOL , sum ) ; amix_d = mixer -> amixers [ AMIXER_LINEIN * CHN_NUM + 1 ] ; sum = mixer -> sums [ SUM_IN_F * CHN_NUM + 1 ] ; amix_d -> ops -> setup ( amix_d , NULL , INIT_VOL , sum ) ; amix_d = mixer -> amixers [ AMIXER_MIC * CHN_NUM ] ; sum = mixer -> sums [ SUM_IN_F * CHN_NUM ] ; amix_d -> ops -> setup ( amix_d , NULL , INIT_VOL , sum ) ; amix_d = mixer -> amixers [ AMIXER_MIC * CHN_NUM + 1 ] ; sum = mixer -> sums [ SUM_IN_F * CHN_NUM + 1 ] ; amix_d -> ops -> setup ( amix_d , NULL , INIT_VOL , sum ) ; amix_d = mixer -> amixers [ AMIXER_SPDIFI * CHN_NUM ] ; sum = mixer -> sums [ SUM_IN_F * CHN_NUM ] ; amix_d -> ops -> setup ( amix_d , NULL , INIT_VOL , sum ) ; amix_d = mixer -> amixers [ AMIXER_SPDIFI * CHN_NUM + 1 ] ; sum = mixer -> sums [ SUM_IN_F * CHN_NUM + 1 ] ; amix_d -> ops -> setup ( amix_d , NULL , INIT_VOL , sum ) ; amix_d = mixer -> amixers [ AMIXER_MASTER_F_C * CHN_NUM ] ; sum = mixer -> sums [ SUM_IN_F_C * CHN_NUM ] ; amix_d -> ops -> setup ( amix_d , & sum -> rsc , INIT_VOL , NULL ) ; amix_d = mixer -> amixers [ AMIXER_MASTER_F_C * CHN_NUM + 1 ] ; sum = mixer -> sums [ SUM_IN_F_C * CHN_NUM + 1 ] ; amix_d -> ops -> setup ( amix_d , & sum -> rsc , INIT_VOL , NULL ) ; amix_d = mixer -> amixers [ AMIXER_PCM_F_C * CHN_NUM ] ; sum = mixer -> sums [ SUM_IN_F_C * CHN_NUM ] ; amix_d -> ops -> setup ( amix_d , NULL , INIT_VOL , sum ) ; amix_d = mixer -> amixers [ AMIXER_PCM_F_C * CHN_NUM + 1 ] ; sum = mixer -> sums [ SUM_IN_F_C * CHN_NUM + 1 ] ; amix_d -> ops -> setup ( amix_d , NULL , INIT_VOL , sum ) ; amix_d = mixer -> amixers [ AMIXER_LINEIN_C * CHN_NUM ] ; sum = mixer -> sums [ SUM_IN_F_C * CHN_NUM ] ; amix_d -> ops -> setup ( amix_d , NULL , INIT_VOL , sum ) ; amix_d = mixer -> amixers [ AMIXER_LINEIN_C * CHN_NUM + 1 ] ; sum = mixer -> sums [ SUM_IN_F_C * CHN_NUM + 1 ] ; amix_d -> ops -> setup ( amix_d , NULL , INIT_VOL , sum ) ; amix_d = mixer -> amixers [ AMIXER_MIC_C * CHN_NUM ] ; sum = mixer -> sums [ SUM_IN_F_C * CHN_NUM ] ; amix_d -> ops -> setup ( amix_d , NULL , INIT_VOL , sum ) ; amix_d = mixer -> amixers [ AMIXER_MIC_C * CHN_NUM + 1 ] ; sum = mixer -> sums [ SUM_IN_F_C * CHN_NUM + 1 ] ; amix_d -> ops -> setup ( amix_d , NULL , INIT_VOL , sum ) ; amix_d = mixer -> amixers [ AMIXER_SPDIFI_C * CHN_NUM ] ; sum = mixer -> sums [ SUM_IN_F_C * CHN_NUM ] ; amix_d -> ops -> setup ( amix_d , NULL , INIT_VOL , sum ) ; amix_d = mixer -> amixers [ AMIXER_SPDIFI_C * CHN_NUM + 1 ] ; sum = mixer -> sums [ SUM_IN_F_C * CHN_NUM + 1 ] ; amix_d -> ops -> setup ( amix_d , NULL , INIT_VOL , sum ) ; return 0 ; } 