static __inline void vmx_dr_leave_guest ( struct vmxctx * vmxctx ) { vmxctx -> guest_dr0 = rdr0 ( ) ; vmxctx -> guest_dr1 = rdr1 ( ) ; vmxctx -> guest_dr2 = rdr2 ( ) ; vmxctx -> guest_dr3 = rdr3 ( ) ; vmxctx -> guest_dr6 = rdr6 ( ) ; load_dr0 ( vmxctx -> host_dr0 , NULL ) ; load_dr1 ( vmxctx -> host_dr1 ) ; load_dr2 ( vmxctx -> host_dr2 ) ; load_dr3 ( vmxctx -> host_dr3 ) ; load_dr6 ( vmxctx -> host_dr6 ) ; wrmsr ( MSR_DEBUGCTLMSR , vmxctx -> host_debugctl ) ; load_dr7 ( vmxctx -> host_dr7 ) ; write_rflags ( read_rflags ( ) | vmxctx -> host_tf ) ; } 