char * read_capability ( isieve_t * obj ) { lexstate_t state ; char * cap = NULL ; obj -> version = NEW_VERSION ; while ( yylex ( & state , obj -> pin ) == STRING ) { char * attr = state . str ; char * val ; val = NULL ; if ( yylex ( & state , obj -> pin ) == ' ' ) { if ( yylex ( & state , obj -> pin ) != STRING ) { parseerror ( "STRING" ) ; } val = state . str ; if ( yylex ( & state , obj -> pin ) != EOL ) { parseerror ( "EOL1" ) ; } } if ( strcasecmp ( attr , "SASL" ) == 0 ) { cap = xstrdupnull ( val ) ; } if ( strcasecmp ( attr , "SIEVE" ) == 0 ) { } if ( strcasecmp ( attr , "IMPLEMENTATION" ) == 0 ) { } if ( strcasecmp ( attr , "STARTTLS" ) == 0 ) { } if ( val && strncmp ( val , "SASL=" , 5 ) == 0 ) { obj -> version = OLD_VERSION ; free ( cap ) ; cap = xstrdup ( val + 5 ) ; free ( val ) ; return cap ; } else { } free ( val ) ; } if ( yylex ( & state , obj -> pin ) != EOL ) { parseerror ( "EOL2" ) ; } return cap ; } 