static int amdgpu_atpx_verify_interface ( struct amdgpu_atpx * atpx ) { union acpi_object * info ; struct atpx_verify_interface output ; size_t size ; int err = 0 ; info = amdgpu_atpx_call ( atpx -> handle , ATPX_FUNCTION_VERIFY_INTERFACE , NULL ) ; if ( ! info ) { return - EIO ; } size = * ( u16 * ) info -> buffer . pointer ; if ( size < 8 ) { printk ( "ATPX buffer is too small: %zu\n" , size ) ; err = - EINVAL ; out } size = min ( sizeof ( output ) , size ) ; memcpy ( & output , info -> buffer . pointer , size ) ; printk ( "ATPX version %u, functions 0x%08x\n" , output . version , output . function_bits ) ; amdgpu_atpx_parse_functions ( & atpx -> functions , output . function_bits ) ; out kfree ( info ) ; return err ; } 