static int ebt_arpreply_tg_check ( const struct xt_tgchk_param * par ) { const struct ebt_arpreply_info * info = par -> targinfo ; const struct ebt_entry * e = par -> entryinfo ; if ( e -> ethproto != htons ( ETH_P_ARP ) || e -> invflags & EBT_IPROTO ) { return - EINVAL ; } return 0 ; } static struct xt_target ebt_arpreply_tg_reg __read_mostly = { . name = "arpreply" . revision = 0 . family = NFPROTO_BRIDGE . table = "nat" . hooks = ( 1 << NF_BR_NUMHOOKS ) | ( 1 << NF_BR_PRE_ROUTING ) . target = ebt_arpreply_tg . checkentry = ebt_arpreply_tg_check . targetsize = sizeof ( ebt_arpreply_info ) . me = THIS_MODULE } ; 