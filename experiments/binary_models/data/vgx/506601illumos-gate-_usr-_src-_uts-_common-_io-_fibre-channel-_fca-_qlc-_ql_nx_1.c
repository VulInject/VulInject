int ql_8021_rom_fast_read ( ql_adapter_state_t * ha , uint32_t addr , uint32_t * valp ) { int ret , loops ; while ( ( ql_8021_rom_lock ( ha ) != 0 ) && ( loops < 50000 ) ) { drv_usecwait ( 100 ) ; loops ++ ; } if ( loops >= 50000 ) { EL ( ha , "rom_lock failed\n" ) ; return ( - 1 ) ; } ret = ql_8021_do_rom_fast_read ( ha , addr , valp ) ; ql_8021_rom_unlock ( ha ) ; return ( ret ) ; } 