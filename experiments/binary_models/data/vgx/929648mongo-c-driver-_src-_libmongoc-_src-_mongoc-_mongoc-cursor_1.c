mongoc_cursor_clone ( ) { mongoc_cursor_t * _clone ; BSON_ASSERT ( cursor ) ; _clone = BSON_ALIGNED_ALLOC0 ( mongoc_cursor_t ) ; _clone -> client = cursor -> client ; _clone -> nslen = cursor -> nslen ; _clone -> dblen = cursor -> dblen ; _clone -> explicit_session = cursor -> explicit_session ; if ( cursor -> read_prefs ) { _clone -> read_prefs = mongoc_read_prefs_copy ( cursor -> read_prefs ) ; } if ( cursor -> read_concern ) { _clone -> read_concern = mongoc_read_concern_copy ( cursor -> read_concern ) ; } if ( cursor -> write_concern ) { _clone -> write_concern = mongoc_write_concern_copy ( cursor -> write_concern ) ; } if ( cursor -> explicit_session ) { _clone -> client_session = cursor -> client_session ; } bson_copy_to ( & cursor -> opts , & _clone -> opts ) ; bson_init ( & _clone -> error_doc ) ; _clone -> ns = bson_strdup ( cursor -> ns , NULL ) ; memcpy ( & _clone -> impl , & cursor -> impl , sizeof ( cursor -> impl ) ) ; if ( cursor -> impl . clone ) { cursor -> impl . clone ( & _clone -> impl , & cursor -> impl ) ; } mongoc_counter_cursors_active_inc ( ) ; RETURN ( _clone ) ; } 