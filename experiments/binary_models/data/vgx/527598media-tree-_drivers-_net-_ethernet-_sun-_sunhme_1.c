static void happy_meal_pci_exit ( void ) { pci_unregister_driver ( & hme_pci_driver ) ; while ( qfe_pci_list ) { struct quattro * qfe = qfe_pci_list ; struct quattro * next = qfe -> next ; qfe_pci_list = next ; } } static const struct of_device_id hme_sbus_match [ ] ; static int hme_sbus_probe ( struct platform_device * op ) { const struct of_device_id * match ; struct device_node * dp = op -> dev . of_node ; const char * model = of_get_property ( dp , "model" , NULL ) ; int is_qfe ; match = of_match_device ( hme_sbus_match , & op -> dev ) ; if ( ! match ) { return - EINVAL ; } is_qfe = ( match -> data != NULL ) ; if ( ! is_qfe && model && ! strcmp ( model , "SUNW,sbus-qfe" ) ) { is_qfe = 1 ; } return happy_meal_sbus_probe_one ( op , is_qfe ) ; } 