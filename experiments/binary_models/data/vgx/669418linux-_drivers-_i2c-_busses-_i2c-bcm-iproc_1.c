static irqreturn_t bcm_iproc_i2c_isr ( int irq , void * data ) { struct bcm_iproc_i2c_dev * iproc_i2c = data ; u32 slave_status ; u32 status ; bool ret ; status = iproc_i2c_rd_reg ( iproc_i2c , IS_OFFSET ) ; slave_status = status & iproc_i2c_rd_reg ( iproc_i2c , IE_OFFSET ) & ISR_MASK_SLAVE ; if ( slave_status ) { ret = bcm_iproc_i2c_slave_isr ( iproc_i2c , slave_status ) ; if ( ret ) { return IRQ_HANDLED ; } else { return IRQ_NONE ; } } status &= ISR_MASK ; bcm_iproc_i2c_process_m_event ( iproc_i2c , status ) ; iproc_i2c_wr_reg ( iproc_i2c , IS_OFFSET , status ) ; return IRQ_HANDLED ; } 