static bool sm_ldap_has_objectclass ( lmap , entry , ocvalue ) SM_LDAP_STRUCT * lmap ; LDAPMessage * entry ; char * ocvalue ; { char * * vals = NULL ; int i ; if ( ocvalue == NULL ) { return false ; } vals = ldap_get_values ( lmap -> ldap_ld , entry , "objectClass" ) ; if ( vals == NULL ) { return false ; } for ( i = 0 ; vals [ i ] != NULL ; i ++ ) { char * p ; char * q ; p = q = ocvalue ; while ( * p != '\0' ) { while ( * p != '\0' && * p != '|' ) { p ++ ; } if ( ( p - q ) == strlen ( vals [ i ] ) && sm_strncasecmp ( vals [ i ] , q , p - q ) == 0 ) { return true ; } while ( * p == '|' ) { p ++ ; } q = p ; } } ldap_value_free ( vals ) ; return false ; } 