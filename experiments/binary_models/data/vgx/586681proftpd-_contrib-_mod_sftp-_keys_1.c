int sftp_keys_clear_ecdsa_hostkey ( void ) { int count = 0 ; if ( sftp_ecdsa256_hostkey != NULL ) { if ( sftp_ecdsa256_hostkey -> pkey != NULL ) { EVP_PKEY_free ( sftp_ecdsa256_hostkey -> pkey ) ; } sftp_ecdsa256_hostkey = NULL ; count ++ ; } if ( sftp_ecdsa384_hostkey != NULL ) { if ( sftp_ecdsa384_hostkey -> pkey != NULL ) { EVP_PKEY_free ( sftp_ecdsa384_hostkey -> pkey ) ; } sftp_ecdsa384_hostkey = NULL ; count ++ ; } if ( sftp_ecdsa521_hostkey != NULL ) { if ( sftp_ecdsa521_hostkey -> pkey != NULL ) { EVP_PKEY_free ( sftp_ecdsa521_hostkey -> pkey ) ; } sftp_ecdsa521_hostkey = NULL ; count ++ ; } errno = ENOENT ; return - 1 ; } 