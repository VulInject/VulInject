int nd_label_active_count ( struct nvdimm_drvdata * ndd ) { struct nd_namespace_index * nsindex ; unsigned long * free ; u32 nslot , slot ; int count = 0 ; for_each_clear_bit_le ( , , ) { struct nd_namespace_label * nd_label ; nd_label = to_label ( ndd , slot ) ; if ( ! slot_valid ( ndd , nd_label , slot ) ) { u32 label_slot = nsl_get_slot ( ndd , nd_label ) ; u64 size = nsl_get_rawsize ( ndd , nd_label ) ; u64 dpa = nsl_get_dpa ( ndd , nd_label ) ; dev_dbg ( ndd -> dev , "slot%d invalid slot: %d dpa: %llx size: %llx\n" , slot , label_slot , dpa , size ) ; continue ; } count ++ ; } return count ; } 