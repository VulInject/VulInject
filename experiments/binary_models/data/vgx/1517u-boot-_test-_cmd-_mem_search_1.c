static int mem_test_ms_l ( struct unit_test_state * uts ) { u32 * buf ; buf = map_sysmem ( 0 , BUF_SIZE + 4 ) ; buf [ 0x38 / 4 ] = 0x12345678 ; buf [ BUF_SIZE / 4 ] = 0x12345678 ; ut_assertok ( console_record_reset_enable ( ) ) ; run_command ( "ms 0 40 12345678" , 0 ) ; ut_assert_nextline ( "00000030: 00000000 00000000 12345678 00000000  ........xV4....." ) ; ut_assert_nextline ( "1 match" ) ; ut_assert_console_end ( ) ; ut_asserteq ( 1 , env_get_hex ( "memmatches" , 0 ) ) ; ut_asserteq ( 0x38 , env_get_hex ( "memaddr" , 0 ) ) ; ut_asserteq ( 0x38 / 4 , env_get_hex ( "mempos" , 0 ) ) ; ut_assertok ( console_record_reset_enable ( ) ) ; run_command ( "ms 0 80 12345679" , 0 ) ; ut_assert_nextline ( "0 matches" ) ; ut_assert_console_end ( ) ; ut_asserteq ( 0 , env_get_hex ( "memmatches" , 0 ) ) ; ut_asserteq ( 0 , env_get_hex ( "memaddr" , 0 ) ) ; ut_asserteq ( 0 / 4 , env_get_hex ( "mempos" , 0 ) ) ; unmap_sysmem ( buf ) ; return 0 ; } 