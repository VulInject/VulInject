void prune_worklog ( ) { struct proxy_client * client , * tmp ; struct work * work , * tmp2 ; struct timeval tv_now ; timer_set_now ( & tv_now ) ; mutex_lock ( & proxy_clients_mutex ) ; HASH_ITER ( , , , ) { HASH_ITER ( , , , ) { if ( timer_elapsed ( & work -> tv_work_start , & tv_now ) <= opt_expiry ) { break ; } HASH_DEL ( client -> work , work ) ; } } mutex_unlock ( & proxy_clients_mutex ) ; } 