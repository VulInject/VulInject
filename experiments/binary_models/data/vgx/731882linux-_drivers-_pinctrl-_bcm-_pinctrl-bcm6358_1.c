static int bcm6358_pinctrl_probe ( struct platform_device * pdev ) { struct reg_field overlays = REG_FIELD ( BCM6358_MODE_REG , 0 , 15 ) ; struct device * dev = & pdev -> dev ; struct bcm63xx_pinctrl * pc ; struct bcm6358_priv * priv ; int err ; priv = devm_kzalloc ( dev , sizeof ( * priv ) , GFP_KERNEL ) ; if ( ! priv ) { return - ENOMEM ; } err = bcm63xx_pinctrl_probe ( pdev , & bcm6358_soc , ( void * ) priv ) ; if ( err ) { return err ; } pc = platform_get_drvdata ( pdev , NULL ) ; priv -> overlays = devm_regmap_field_alloc ( dev , pc -> regs , overlays ) ; if ( IS_ERR ( priv -> overlays ) ) { return PTR_ERR ( priv -> overlays ) ; } return 0 ; } 