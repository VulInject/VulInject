static int gc2235_write_reg_array ( struct i2c_client * client , const struct gc2235_reg * reglist ) { const struct gc2235_reg * next = reglist ; struct gc2235_write_ctrl ctrl ; int err ; for ( ; next -> type != GC2235_TOK_TERM ; next ++ ) { switch ( next -> type & GC2235_TOK_MASK ) { case GC2235_TOK_DELAY : err = __gc2235_flush_reg_array ( client , & ctrl ) ; if ( err ) { return err ; } msleep ( next -> val ) ; break ; default : if ( ! __gc2235_write_reg_is_consecutive ( client , & ctrl , next ) ) { err = __gc2235_flush_reg_array ( client , & ctrl ) ; if ( err ) { return err ; } } err = __gc2235_buf_reg_array ( client , & ctrl , next ) ; if ( err ) { dev_err ( & client -> dev , "%s: write error, aborted\n" , __func__ ) ; return err ; } break ; } } return __gc2235_flush_reg_array ( client , & ctrl ) ; } 