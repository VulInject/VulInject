static int tw686x_pcm_open ( struct snd_pcm_substream * ss ) { struct tw686x_dev * dev = snd_pcm_substream_chip ( ss ) ; struct tw686x_audio_channel * ac = & dev -> audio_channels [ ss -> number ] ; struct snd_pcm_runtime * rt = ss -> runtime ; int err ; ac -> ss = ss ; rt -> hw = tw686x_capture_hw ; err = snd_pcm_hw_constraint_integer ( rt , SNDRV_PCM_HW_PARAM_PERIODS ) ; return 0 ; } 