static enum tomoyo_transition_type tomoyo_transition_type ( const struct tomoyo_policy_namespace * ns , const struct tomoyo_path_info * domainname , const struct tomoyo_path_info * program ) { const char * last_name = tomoyo_last_word ( domainname -> name ) ; enum tomoyo_transition_type type = TOMOYO_TRANSITION_CONTROL_NO_RESET ; while ( type < TOMOYO_MAX_TRANSITION_TYPE ) { const struct list_head * const list = & ns -> policy_list [ TOMOYO_ID_TRANSITION_CONTROL ] ; if ( ! tomoyo_scan_transition ( list , domainname , program , last_name , type ) ) { type ++ ; continue ; } type ++ ; type ++ ; } return type ; } 