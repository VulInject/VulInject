static int crvml_set_clock ( struct vml_sys * sys , int clock ) { void __iomem * clock_reg = mch_regs_base + CRVML_REG_CLOCK ; int index ; u32 clock_val ; index = crvml_nearest_index ( sys , clock ) ; clock_val = ioread32 ( clock_reg ) & ~ CRVML_CLOCK_MASK ; clock_val = crvml_clock_bits [ index ] << CRVML_CLOCK_SHIFT ; iowrite32 ( clock_val , clock_reg ) ; ioread32 ( clock_reg ) ; return 0 ; } 