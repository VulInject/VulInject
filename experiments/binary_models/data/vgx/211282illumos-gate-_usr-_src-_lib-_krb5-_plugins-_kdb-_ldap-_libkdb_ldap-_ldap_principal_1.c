void krb5_dbe_free_contents ( context , entry ) krb5_context context ; krb5_db_entry * entry ; { krb5_tl_data * tl_data_next = NULL ; krb5_tl_data * tl_data = NULL ; int i , j ; if ( entry -> e_data ) { free ( entry -> e_data ) ; } if ( entry -> princ ) { krb5_free_principal ( context , entry -> princ ) ; } for ( tl_data = entry -> tl_data ; tl_data ; tl_data = tl_data_next ) { tl_data_next = tl_data -> tl_data_next ; if ( tl_data -> tl_data_contents ) { free ( tl_data -> tl_data_contents ) ; } free ( tl_data ) ; } if ( entry -> key_data ) { for ( i = 0 ; i < entry -> n_key_data ; i ++ ) { for ( j = 0 ; j < entry -> key_data [ i ] . key_data_ver ; j ++ ) { if ( entry -> key_data [ i ] . key_data_length [ j ] ) { if ( entry -> key_data [ i ] . key_data_contents [ j ] ) { memset ( entry -> key_data [ i ] . key_data_contents [ j ] , 0 , ( unsigned ) entry -> key_data [ i ] . key_data_length [ j ] ) ; free ( entry -> key_data [ i ] . key_data_contents [ j ] ) ; } } entry -> key_data [ i ] . key_data_contents [ j ] = NULL ; entry -> key_data [ i ] . key_data_length [ j ] = 0 ; entry -> key_data [ i ] . key_data_type [ j ] = 0 ; } } free ( entry -> key_data ) ; } return ; } 