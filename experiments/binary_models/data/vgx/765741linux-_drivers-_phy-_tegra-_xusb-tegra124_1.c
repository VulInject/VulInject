static struct tegra_xusb_pad * tegra124_pcie_pad_probe ( struct tegra_xusb_padctl * padctl , const struct tegra_xusb_pad_soc * soc , struct device_node * np ) { struct tegra_xusb_pcie_pad * pcie ; struct tegra_xusb_pad * pad ; int err ; pcie = kmalloc ( sizeof ( * pcie ) , GFP_KERNEL ) ; if ( ! pcie ) { return ERR_PTR ( - ENOMEM ) ; } pad = & pcie -> base ; pad -> ops = & tegra124_pcie_lane_ops ; pad -> soc = soc ; err = tegra_xusb_pad_init ( pad , padctl , np ) ; if ( err < 0 ) { kfree ( pcie ) ; out } err = tegra_xusb_pad_register ( pad , & tegra124_pcie_phy_ops ) ; if ( err < 0 ) { unregister } dev_set_drvdata ( & pad -> dev , pad ) ; return pad ; unregister device_unregister ( & pad -> dev ) ; out return ERR_PTR ( err ) ; } 