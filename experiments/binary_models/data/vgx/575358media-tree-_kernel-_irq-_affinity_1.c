static void irq_spread_init_one ( struct cpumask * irqmsk , struct cpumask * nmsk , int cpus_per_vec ) { const struct cpumask * siblmsk ; int cpu , sibl ; for ( ; cpus_per_vec > 0 ; ) { cpu = cpumask_first ( nmsk ) ; cpumask_clear_cpu ( cpu , nmsk ) ; cpumask_set_cpu ( cpu , irqmsk ) ; cpus_per_vec -- ; siblmsk = topology_sibling_cpumask ( cpu ) ; for ( sibl = - 1 ; cpus_per_vec > 0 ; ) { sibl = cpumask_next ( sibl , siblmsk ) ; if ( sibl >= nr_cpu_ids ) { break ; } if ( ! cpumask_test_and_clear_cpu ( sibl , nmsk ) ) { continue ; } cpumask_set_cpu ( sibl , irqmsk ) ; cpus_per_vec -- ; } } } 