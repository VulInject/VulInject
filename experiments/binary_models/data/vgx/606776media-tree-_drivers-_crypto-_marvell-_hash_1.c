static int mv_cesa_ahash_dma_add_cache ( struct mv_cesa_tdma_chain * chain , struct mv_cesa_ahash_req * creq , gfp_t flags ) { struct mv_cesa_ahash_dma_req * ahashdreq = & creq -> req . dma ; int ret ; ret = mv_cesa_ahash_dma_alloc_cache ( ahashdreq , flags ) ; if ( ret ) { return ret ; } memcpy ( ahashdreq -> cache , creq -> cache , creq -> cache_ptr ) ; return mv_cesa_dma_add_data_transfer ( chain , CESA_SA_DATA_SRAM_OFFSET , ahashdreq -> cache_dma , creq -> cache_ptr , CESA_TDMA_DST_IN_SRAM , flags ) ; } 