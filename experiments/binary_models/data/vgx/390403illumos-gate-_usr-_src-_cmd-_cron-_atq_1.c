static void printjobname ( char * file ) { char * ptr ; char jobname [ 28 ] ; FILE * filename ; printf ( "     " ) ; if ( ( filename = fopen ( file , "r" ) ) == NULL ) { printf ( "%.27s\n" , "???" ) ; ( void ) fprintf ( stderr , "atq: Can't open job file %s: %s\n" , file , errmsg ( errno ) ) ; return ; } fscanf ( filename , "%*[^\n]\n" ) ; if ( fscanf ( filename , ": jobname: %27s%*[^\n]\n" , jobname ) != 1 ) { printf ( "%.27s\n" , "???" ) ; fclose ( filename , NULL ) ; return ; } fclose ( filename ) ; ptr = jobname ; if ( ( ptr = ( char * ) strrchr ( jobname , '/' ) ) != 0 ) { ++ ptr ; } else { ptr = jobname ; } if ( strlen ( ptr ) > 23 ) { printf ( "%.23s ...\n" , ptr ) ; } else { printf ( "%.27s\n" , ptr ) ; } } 