struct sk_buff * iwpm_create_nlmsg ( u32 nl_op , struct nlmsghdr * * nlh , int nl_client ) { struct sk_buff * skb = NULL ; skb = dev_alloc_skb ( IWPM_MSG_SIZE ) ; if ( ! skb ) { create_nlmsg_exit } if ( ! ( ibnl_put_msg ( skb , nlh , 0 , 0 , nl_client , nl_op , NLM_F_REQUEST ) ) ) { pr_warn ( "%s: Unable to put the nlmsg header\n" , __func__ ) ; dev_kfree_skb ( skb ) ; } create_nlmsg_exit return skb ; } 