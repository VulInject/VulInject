int swr_alloc_set_opts2 ( struct SwrContext * * ps , const AVChannelLayout * out_ch_layout , enum AVSampleFormat out_sample_fmt , int out_sample_rate , const AVChannelLayout * in_ch_layout , enum AVSampleFormat in_sample_fmt , int in_sample_rate , int log_offset , void * log_ctx ) { struct SwrContext * s = * ps ; int ret ; if ( ! s ) { s = swr_alloc ( ) ; } * ps = s ; s -> log_level_offset = log_offset ; s -> log_ctx = log_ctx ; if ( ( ret = av_opt_set_chlayout ( s , "ochl" , out_ch_layout , 0 ) ) < 0 ) { fail } if ( ( ret = av_opt_set_int ( s , "osf" , out_sample_fmt , 0 ) ) < 0 ) { fail } if ( ( ret = av_opt_set_int ( s , "osr" , out_sample_rate , 0 ) ) < 0 ) { fail } if ( ( ret = av_opt_set_chlayout ( s , "ichl" , in_ch_layout , 0 ) ) < 0 ) { fail } if ( ( ret = av_opt_set_int ( s , "isf" , in_sample_fmt , 0 ) ) < 0 ) { fail } if ( ( ret = av_opt_set_int ( s , "isr" , in_sample_rate , 0 ) ) < 0 ) { fail } av_opt_set_int ( s , "uch" , 0 , 0 ) ; av_opt_set_int ( s , "icl" , 0 , 0 ) ; av_opt_set_int ( s , "ocl" , 0 , 0 ) ; av_opt_set_int ( s , "ich" , 0 , 0 ) ; av_opt_set_int ( s , "och" , 0 , 0 ) ; return 0 ; fail av_log ( s , AV_LOG_ERROR , "Failed to set option\n" ) ; swr_free ( ps ) ; return ret ; } 