NOKPROBE_SYMBOL ( arch_rethook_trampoline ) ; __used __visible void arch_rethook_trampoline_callback ( struct pt_regs * regs ) { unsigned long * frame_pointer ; regs -> cs = __KERNEL_CS ; regs -> ip = ( unsigned long ) & arch_rethook_trampoline ; regs -> orig_ax = ~ 0UL ; regs -> sp += 2 * sizeof ( long ) ; frame_pointer = ( long * ) ( regs + 1 ) ; rethook_trampoline_handler ( regs , ( unsigned long ) frame_pointer ) ; * ( unsigned long * ) & regs -> ss = regs -> flags ; } 