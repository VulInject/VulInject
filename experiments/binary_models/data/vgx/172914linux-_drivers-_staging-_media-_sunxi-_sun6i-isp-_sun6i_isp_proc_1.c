static void sun6i_isp_proc_configure ( struct sun6i_isp_device * isp_dev ) { struct v4l2_mbus_framefmt * mbus_format = & isp_dev -> proc . mbus_format ; const struct sun6i_isp_proc_format * format ; u32 value ; value = sun6i_isp_load_read ( isp_dev , SUN6I_ISP_MODULE_EN_REG ) ; value |= SUN6I_ISP_MODULE_EN_SRC0 ; sun6i_isp_load_write ( isp_dev , SUN6I_ISP_MODULE_EN_REG , value ) ; format = sun6i_isp_proc_format_find ( mbus_format -> code ) ; sun6i_isp_load_write ( isp_dev , SUN6I_ISP_MODE_REG , SUN6I_ISP_MODE_INPUT_FMT ( format -> input_format ) | SUN6I_ISP_MODE_INPUT_YUV_SEQ ( format -> input_yuv_seq ) | SUN6I_ISP_MODE_SHARP ( 1 ) | SUN6I_ISP_MODE_HIST ( 2 ) ) ; } 