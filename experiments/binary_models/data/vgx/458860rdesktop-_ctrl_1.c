static RD_BOOL _ctrl_verify_unix_socket ( ) { int s , len ; struct sockaddr_un saun ; if ( ( s = socket ( AF_UNIX , SOCK_STREAM , 0 ) ) < 0 ) { logger ( Core , Error , "_ctrl_verify_unix_socket(), socket() failed: %s" , strerror ( errno ) ) ; exit ( 1 ) ; } saun . sun_family = AF_UNIX ; strcpy ( saun . sun_path , ctrlsock_name ) ; len = sizeof ( saun . sun_family ) + strlen ( saun . sun_path ) ; if ( connect ( s , ( sockaddr * ) & saun , len ) != 0 ) { return False ; } shutdown ( s , SHUT_RDWR ) ; close ( s ) ; return True ; } 