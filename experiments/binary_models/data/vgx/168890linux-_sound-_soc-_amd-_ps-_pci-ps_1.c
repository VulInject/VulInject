static int acp63_power_on ( void __iomem * acp_base ) { u32 val ; int timeout ; val = acp63_readl ( acp_base + ACP_PGFSM_STATUS ) ; if ( ( val & ACP_PGFSM_STATUS_MASK ) != ACP_POWER_ON_IN_PROGRESS ) { acp63_writel ( ACP_PGFSM_CNTL_POWER_ON_MASK , acp_base + ACP_PGFSM_CONTROL ) ; } timeout = 0 ; while ( ++ timeout < 500 ) { val = acp63_readl ( acp_base + ACP_PGFSM_STATUS ) ; if ( ! val ) { return 0 ; } udelay ( 1 ) ; } return - ETIMEDOUT ; } 