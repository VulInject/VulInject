smoothing_ok ( ) { my_coef_ptr coef = ( my_coef_ptr ) cinfo -> coef ; boolean smoothing_useful = FALSE ; int ci , coefi ; jpeg_component_info * compptr ; JQUANT_TBL * qtable ; int * coef_bits ; int * coef_bits_latch ; if ( coef -> coef_bits_latch == NULL ) { coef -> coef_bits_latch = ( int * ) * cinfo -> mem -> alloc_small ( ( j_common_ptr ) cinfo , JPOOL_IMAGE , cinfo -> num_components * ( SAVED_COEFS * SIZEOF ( int ) ) ) ; } coef_bits_latch = coef -> coef_bits_latch ; for ( ci = 0 , compptr = cinfo -> comp_info ; ci < cinfo -> num_components ; ci ++ , compptr ++ ) { if ( ( qtable = compptr -> quant_table ) == NULL ) { return FALSE ; } if ( qtable -> quantval [ 0 ] == 0 || qtable -> quantval [ Q01_POS ] == 0 || qtable -> quantval [ Q10_POS ] == 0 || qtable -> quantval [ Q20_POS ] == 0 || qtable -> quantval [ Q11_POS ] == 0 || qtable -> quantval [ Q02_POS ] == 0 ) { return FALSE ; } coef_bits = cinfo -> coef_bits [ ci ] ; if ( coef_bits [ 0 ] < 0 ) { return FALSE ; } for ( coefi = 1 ; coefi <= 5 ; coefi ++ ) { coef_bits_latch [ coefi ] = coef_bits [ coefi ] ; if ( coef_bits [ coefi ] != 0 ) { smoothing_useful = TRUE ; } } coef_bits_latch += SAVED_COEFS ; } return smoothing_useful ; } 