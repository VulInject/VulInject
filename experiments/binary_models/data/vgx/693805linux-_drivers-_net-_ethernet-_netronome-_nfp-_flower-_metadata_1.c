static bool nfp_check_mask_remove ( struct nfp_app * app , char * mask_data , u32 mask_len , u8 * meta_flags , u8 * mask_id ) { struct nfp_mask_id_table * mask_entry ; mask_entry = nfp_search_mask_table ( app , mask_data , mask_len ) ; * mask_id = mask_entry -> mask_id ; mask_entry -> ref_cnt -- ; if ( ! mask_entry -> ref_cnt ) { hash_del ( & mask_entry -> link ) ; nfp_release_mask_id ( app , * mask_id ) ; kfree ( mask_entry ) ; if ( meta_flags ) { * meta_flags |= NFP_FL_META_FLAG_MANAGE_MASK ; } } return true ; } 