static int ebt_dnat_tg_check ( const struct xt_tgchk_param * par ) { const struct ebt_nat_info * info = par -> targinfo ; int hook_mask ; if ( BASE_CHAIN && info -> target == EBT_RETURN ) { return - EINVAL ; } hook_mask = par -> hook_mask & ~ ( 1 << NF_BR_NUMHOOKS ) ; if ( ( strcmp ( par -> table , "nat" ) != 0 || ( hook_mask & ~ ( ( 1 << NF_BR_PRE_ROUTING ) | ( 1 << NF_BR_LOCAL_OUT ) ) ) ) && ( strcmp ( par -> table , "broute" ) != 0 || hook_mask & ~ ( 1 << NF_BR_BROUTING ) ) ) { return - EINVAL ; } if ( ebt_invalid_target ( info -> target ) ) { return - EINVAL ; } return 0 ; } 