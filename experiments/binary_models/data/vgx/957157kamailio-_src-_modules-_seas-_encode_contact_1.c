int print_encoded_contact ( FILE * fd , char * hdr , int hdrlen , unsigned char * payload , int paylen , char * prefix ) { int i = 2 ; int flags = 0 ; flags = payload [ 0 ] ; fprintf ( fd , "%s" , prefix ) ; for ( i = 0 ; i < paylen ; i ++ ) { fprintf ( fd , "%s%d%s" , i == 0 ?"ENCODED CONTACT=[" : ":" , payload [ i ] , i == paylen - 1 ?"]\n" : "" ) ; } i = 2 ; if ( flags & HAS_NAME_F ) { fprintf ( fd , "%sCONTACT NAME=[%.*s]\n" , prefix , payload [ i + 1 ] , & hdr [ payload [ i ] ] ) ; i += 2 ; } if ( flags & HAS_Q_F ) { fprintf ( fd , "%sCONTACT Q=[%.*s]\n" , prefix , payload [ i + 1 ] , & hdr [ payload [ i ] ] ) ; i += 2 ; } if ( flags & HAS_EXPIRES_F ) { fprintf ( fd , "%sCONTACT EXPIRES=[%.*s]\n" , prefix , payload [ i + 1 ] , & hdr [ payload [ i ] ] ) ; i += 2 ; } if ( flags & HAS_RECEIVED_F ) { fprintf ( fd , "%sCONTACT RECEIVED=[%.*s]\n" , prefix , payload [ i + 1 ] , & hdr [ payload [ i ] ] ) ; i += 2 ; } if ( flags & HAS_METHOD_F ) { fprintf ( fd , "%sCONTACT METHOD=[%.*s]\n" , prefix , payload [ i + 1 ] , & hdr [ payload [ i ] ] ) ; i += 2 ; } if ( print_encoded_uri ( fd , & payload [ i ] , payload [ 1 ] , hdr , hdrlen , strcat ( prefix , "  " ) ) < 0 ) { prefix [ strlen ( prefix ) - 2 ] = 0 ; fprintf ( fd , "Error parsing URI\n" ) ; return - 1 ; } prefix [ strlen ( prefix ) - 2 ] = 0 ; print_encoded_parameters ( fd , ( unsigned char * ) & payload [ i + payload [ 1 ] ] , hdr , paylen - i - payload [ 1 ] , prefix ) ; return 0 ; } 