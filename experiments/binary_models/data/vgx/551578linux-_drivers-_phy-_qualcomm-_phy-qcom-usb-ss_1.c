static int qcom_ssphy_do_reset ( struct ssphy_priv * priv ) { int ret ; if ( ! priv -> reset_com ) { qcom_ssphy_updatel ( priv -> base + PHY_CTRL1 , PHY_RESET , PHY_RESET ) ; usleep_range ( 10 , 20 ) ; qcom_ssphy_updatel ( priv -> base + PHY_CTRL1 , PHY_RESET , 0 ) ; } else { if ( ret ) { dev_err ( priv -> dev , "Failed to assert reset com\n" ) ; return ret ; } ret = reset_control_assert ( priv -> reset_phy ) ; if ( ret ) { dev_err ( priv -> dev , "Failed to assert reset phy\n" ) ; return ret ; } usleep_range ( 10 , 20 ) ; ret = reset_control_deassert ( priv -> reset_com ) ; if ( ret ) { dev_err ( priv -> dev , "Failed to deassert reset com\n" ) ; return ret ; } ret = reset_control_deassert ( priv -> reset_phy ) ; if ( ret ) { dev_err ( priv -> dev , "Failed to deassert reset phy\n" ) ; return ret ; } } return 0 ; } 