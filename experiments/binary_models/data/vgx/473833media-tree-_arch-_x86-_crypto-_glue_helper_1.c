int glue_xts_crypt_128bit ( const struct common_glue_ctx * gctx , struct blkcipher_desc * desc , struct scatterlist * dst , struct scatterlist * src , unsigned int nbytes , void * tweak_fn ( void * ctx , u8 * dst , const u8 * src ) , void * tweak_ctx , void * crypt_ctx ) { const unsigned int bsize = 128 / 8 ; bool fpu_enabled = false ; struct blkcipher_walk walk ; int err ; blkcipher_walk_init ( & walk , dst , src , nbytes ) ; err = blkcipher_walk_virt ( desc , & walk ) ; nbytes = walk . nbytes ; fpu_enabled = glue_fpu_begin ( bsize , gctx -> fpu_blocks_limit , desc , fpu_enabled , nbytes < bsize ?bsize : nbytes ) ; tweak_fn ( tweak_ctx , walk . iv , walk . iv ) ; while ( nbytes ) { nbytes = __glue_xts_crypt_128bit ( gctx , crypt_ctx , desc , & walk ) ; err = blkcipher_walk_done ( desc , & walk , nbytes ) ; nbytes = walk . nbytes ; } glue_fpu_end ( fpu_enabled ) ; return err ; } 