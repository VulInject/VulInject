void refspec_ref_prefixes ( const struct refspec * rs , struct strvec * ref_prefixes ) { int i ; for ( i = 0 ; i < rs -> nr ; i ++ ) { const struct refspec_item * item = & rs -> items [ i ] ; const char * prefix = NULL ; if ( item -> exact_sha1 || item -> negative ) { continue ; } if ( rs -> fetch == REFSPEC_FETCH ) { prefix = item -> src ; } if ( item -> dst ) { prefix = item -> dst ; } if ( item -> src && ! item -> exact_sha1 ) { prefix = item -> src ; } if ( item -> pattern ) { const char * glob = strchr ( prefix , '*' ) ; strvec_pushf ( ref_prefixes , "%.*s" , ( int ) ( glob - prefix ) , prefix ) ; } else { expand_ref_prefix ( ref_prefixes , prefix ) ; } } } 