static int __init bman_portal_driver_register ( struct platform_driver * drv ) { int ret ; ret = platform_driver_register ( drv ) ; ret = cpuhp_setup_state_nocalls ( CPUHP_AP_ONLINE_DYN , "soc/qbman_portal:online" , bman_online_cpu , bman_offline_cpu ) ; if ( ret < 0 ) { pr_err ( "bman: failed to register hotplug callbacks.\n" ) ; platform_driver_unregister ( drv ) ; return ret ; } return 0 ; } 