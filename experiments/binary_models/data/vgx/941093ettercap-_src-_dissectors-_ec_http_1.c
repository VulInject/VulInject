static int Parse_Passport_Auth ( char * from_here , struct packet_object * po ) { char * token , * to_decode , * tok ; DEBUG_MSG ( "HTTP -->dissector http (Passport Auth)" ) ; if ( ! ( to_decode = strdup ( from_here ) ) ) { return 1 ; } if ( ( token = strstr ( to_decode , "OrgURL=" ) ) == NULL ) { SAFE_FREE ( to_decode , NULL ) ; return 1 ; } ec_strtok ( token , "," , & tok ) ; po -> DISSECTOR . info = strdup ( token + strlen ( "OrgURL=" ) ) ; Decode_Url ( po -> DISSECTOR . info ) ; while ( ( token = ec_strtok ( NULL , "," , & tok ) ) != NULL ) { if ( ! strncmp ( token , "sign-in=" , strlen ( "sign-in=" ) ) ) { po -> DISSECTOR . user = strdup ( token + strlen ( "sign-in=" ) ) ; Decode_Url ( po -> DISSECTOR . user ) ; } if ( ! strncmp ( token , "pwd=" , strlen ( "pwd=" ) ) ) { po -> DISSECTOR . pass = strdup ( token + strlen ( "pwd=" ) ) ; Decode_Url ( po -> DISSECTOR . pass ) ; break ; } } Print_Pass ( po ) ; SAFE_FREE ( to_decode ) ; return 1 ; } 