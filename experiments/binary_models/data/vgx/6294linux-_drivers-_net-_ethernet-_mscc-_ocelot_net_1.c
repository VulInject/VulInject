int ocelot_port_devlink_init ( struct ocelot * ocelot , int port , enum devlink_port_flavour flavour ) { struct devlink_port * dlp = & ocelot -> devlink_ports [ port ] ; int id_len = sizeof ( ocelot -> base_mac ) ; struct devlink * dl = ocelot -> devlink ; struct devlink_port_attrs attrs = { } ; memcpy ( attrs . switch_id . id , & ocelot -> base_mac , id_len ) ; attrs . switch_id . id_len = id_len ; attrs . phys . port_number = port ; attrs . flavour = flavour ; devlink_port_attrs_set ( dlp , & attrs ) ; return devlink_port_register ( dl , dlp , port ) ; } 