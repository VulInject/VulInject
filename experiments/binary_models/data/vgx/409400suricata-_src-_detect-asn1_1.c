static int DetectAsn1Setup ( DetectEngineCtx * de_ctx , Signature * s , const char * asn1str ) { DetectAsn1Data * ad = DetectAsn1Parse ( asn1str ) ; SigMatch * sm = SigMatchAlloc ( ) ; if ( sm == NULL ) { DetectAsn1Free ( de_ctx , ad ) ; return - 1 ; } sm -> type = DETECT_ASN1 ; sm -> ctx = ( SigMatchCtx * ) ad ; SigMatchAppendSMToList ( s , sm , DETECT_SM_LIST_MATCH ) ; return 0 ; } 