int FUN1 ( const unsigned char * VAR1 , unsigned long VAR2 , unsigned long * VAR3 , unsigned long * VAR4 ) { unsigned long VAR5 , VAR6 , VAR7 , VAR8 ; int VAR9 ; FUN2 ( VAR1 != NULL ) ; FUN2 ( VAR3 != NULL ) ; FUN2 ( VAR4 != NULL ) ; if ( * VAR4 < 2 ) { * VAR4 = 2 ; return VAR10 ; } VAR5 = 0 ; if ( ( VAR1 [ VAR5 ++ ] & 0x1F ) != 0x06 ) { return VAR11 ; } VAR6 = VAR2 - VAR5 ; if ( ( VAR9 = FUN3 ( VAR1 + VAR5 , & VAR6 , & VAR8 ) ) != VAR12 ) { return VAR9 ; } VAR5 += VAR6 ; if ( ( VAR8 == 0 ) || ( VAR8 > ( VAR2 - VAR5 ) ) ) { return VAR11 ; } VAR6 = 0 ; VAR7 = 0 ; while ( VAR8 -- ) { VAR7 = ( VAR7 << 7 ) | ( VAR1 [ VAR5 ] & 0x7F ) ; if ( ! ( VAR1 [ VAR5 ++ ] & 0x80 ) ) { if ( VAR6 >= * VAR4 ) { VAR6 ++ ; } else { if ( VAR6 == 0 ) { if ( VAR7 <= 79 ) { VAR3 [ 0 ] = VAR7 / 40 ; VAR3 [ 1 ] = VAR7 % 40 ; } else { VAR3 [ 0 ] = 2 ; VAR3 [ 1 ] = VAR7 - 80 ; } VAR6 = 2 ; } else { VAR3 [ VAR6 ++ ] = VAR7 ; } } VAR7 = 0 ; } } if ( VAR6 > * VAR4 ) { VAR9 = VAR10 ; } else { VAR9 = VAR12 ; } * VAR4 = VAR6 ; return VAR9 ; }