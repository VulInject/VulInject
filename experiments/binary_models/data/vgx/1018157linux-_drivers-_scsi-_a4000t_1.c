static int __exit amiga_a4000t_scsi_remove ( struct platform_device * pdev ) { struct Scsi_Host * host = platform_get_drvdata ( pdev ) ; struct NCR_700_Host_Parameters * hostdata = shost_priv ( host ) ; struct resource * res = platform_get_resource ( pdev , IORESOURCE_MEM , 0 ) ; scsi_remove_host ( host ) ; NCR_700_release ( host ) ; free_irq ( host -> irq , host ) ; release_mem_region ( res -> start , resource_size ( res ) ) ; return 0 ; } static struct platform_driver amiga_a4000t_scsi_driver = { . remove = __exit_p ( amiga_a4000t_scsi_remove ) . driver = { . name = "amiga-a4000t-scsi" } } ; 