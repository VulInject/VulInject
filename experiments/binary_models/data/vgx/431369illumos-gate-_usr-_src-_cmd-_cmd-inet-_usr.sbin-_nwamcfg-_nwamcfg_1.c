static int export_ncu_callback ( nwam_ncu_handle_t ncu , void * arg ) { char * name ; const char * * props ; nwam_ncu_type_t type ; nwam_ncu_class_t class nwam_value_t vals ; nwam_error_t ret ; uint_t num ; int i ; FILE * of = arg ; assert ( of != NULL ) ; if ( ( ret = nwam_ncu_get_ncu_class ( ncu , & class ) ) != NWAM_SUCCESS ) { return ( ret ) ; } if ( ( ret = nwam_ncu_get_name ( ncu , & name ) ) != NWAM_SUCCESS ) { return ( ret ) ; } ( void ) fprintf ( of , "create ncu %s \"%s\"\n" , propval_to_str ( NWAM_NCU_PROP_CLASS , class ) , name ) ; free ( name ) ; if ( ( ret = nwam_ncu_get_default_proplist ( type , class , & props , & num ) ) != NWAM_SUCCESS ) { return ( ret ) ; } for ( i = 0 ; i < num ; i ++ ) { ret = nwam_ncu_get_prop_value ( ncu , props [ i ] , & vals ) ; if ( ret == NWAM_SUCCESS ) { write_export_command ( NWAM_OBJECT_TYPE_NCU , props [ i ] , vals , of ) ; nwam_value_free ( vals ) ; } } ( void ) fprintf ( of , "end\n" ) ; free ( props ) ; return ( 0 ) ; } 