static int parse_ta_bin_descriptor ( struct psp_context * psp , const struct psp_fw_bin_desc * desc , const struct ta_firmware_header_v2_0 * ta_hdr ) { uint8_t * ucode_start_addr = NULL ; ucode_start_addr = ( uint8_t * ) ta_hdr + le32_to_cpu ( desc -> offset_bytes ) + le32_to_cpu ( ta_hdr -> header . ucode_array_offset_bytes ) ; switch ( desc -> fw_type ) { case TA_FW_TYPE_PSP_ASD : psp -> asd_context . bin_desc . fw_version = le32_to_cpu ( desc -> fw_version ) ; psp -> asd_context . bin_desc . feature_version = le32_to_cpu ( desc -> fw_version ) ; psp -> asd_context . bin_desc . size_bytes = le32_to_cpu ( desc -> size_bytes ) ; psp -> asd_context . bin_desc . start_addr = ucode_start_addr ; break ; case TA_FW_TYPE_PSP_XGMI : psp -> xgmi_context . context . bin_desc . fw_version = le32_to_cpu ( desc -> fw_version ) ; psp -> xgmi_context . context . bin_desc . size_bytes = le32_to_cpu ( desc -> size_bytes ) ; psp -> xgmi_context . context . bin_desc . start_addr = ucode_start_addr ; break ; case TA_FW_TYPE_PSP_RAS : psp -> ras_context . context . bin_desc . fw_version = le32_to_cpu ( desc -> fw_version ) ; psp -> ras_context . context . bin_desc . size_bytes = le32_to_cpu ( desc -> size_bytes ) ; psp -> ras_context . context . bin_desc . start_addr = ucode_start_addr ; break ; case TA_FW_TYPE_PSP_HDCP : psp -> hdcp_context . context . bin_desc . fw_version = le32_to_cpu ( desc -> fw_version ) ; psp -> hdcp_context . context . bin_desc . size_bytes = le32_to_cpu ( desc -> size_bytes ) ; psp -> hdcp_context . context . bin_desc . start_addr = ucode_start_addr ; break ; case TA_FW_TYPE_PSP_DTM : psp -> dtm_context . context . bin_desc . fw_version = le32_to_cpu ( desc -> fw_version ) ; psp -> dtm_context . context . bin_desc . size_bytes = le32_to_cpu ( desc -> size_bytes ) ; psp -> dtm_context . context . bin_desc . start_addr = ucode_start_addr ; break ; case TA_FW_TYPE_PSP_RAP : psp -> rap_context . context . bin_desc . fw_version = le32_to_cpu ( desc -> fw_version ) ; psp -> rap_context . context . bin_desc . size_bytes = le32_to_cpu ( desc -> size_bytes ) ; psp -> rap_context . context . bin_desc . start_addr = ucode_start_addr ; break ; case TA_FW_TYPE_PSP_SECUREDISPLAY : psp -> securedisplay_context . context . bin_desc . fw_version = le32_to_cpu ( desc -> fw_version ) ; psp -> securedisplay_context . context . bin_desc . size_bytes = le32_to_cpu ( desc -> size_bytes ) ; psp -> securedisplay_context . context . bin_desc . start_addr = ucode_start_addr ; break ; default : dev_warn ( psp -> adev -> dev , "Unsupported TA type: %d\n" , desc -> fw_type ) ; break ; } return 0 ; } 