static int load_timings_from_dt ( struct tegra_clk_emc * tegra , struct device_node * node , u32 ram_code ) { struct emc_timing * timings_ptr ; struct device_node * child ; int child_count = of_get_child_count ( node ) ; int i = 0 , err ; size_t size ; size = ( tegra -> num_timings + child_count ) * sizeof ( emc_timing ) ; tegra -> timings = krealloc ( tegra -> timings , size , GFP_KERNEL ) ; timings_ptr = tegra -> timings + tegra -> num_timings ; tegra -> num_timings += child_count ; for_each_child_of_node ( , ) { struct emc_timing * timing = timings_ptr + ( i ++ ) ; err = load_one_timing_from_dt ( tegra , timing , child ) ; if ( err ) { of_node_put ( child ) ; return err ; } timing -> ram_code = ram_code ; } sort ( timings_ptr , child_count , sizeof ( emc_timing ) , cmp_timings , NULL ) ; return 0 ; } 