usbd_status uvideo_vs_alloc_bulk ( struct uvideo_softc * sc ) { int size ; sc -> sc_vs_cur -> bxfer . sc = sc ; sc -> sc_vs_cur -> bxfer . xfer = usbd_alloc_xfer ( sc -> sc_udev ) ; if ( sc -> sc_vs_cur -> bxfer . xfer == NULL ) { printf ( "%s: could not allocate bulk VS xfer!\n" , DEVNAME ( sc ) ) ; return ( USBD_NOMEM ) ; } size = UGETDW ( sc -> sc_desc_probe . dwMaxPayloadTransferSize , NULL ) ; sc -> sc_vs_cur -> bxfer . buf = usbd_alloc_buffer ( sc -> sc_vs_cur -> bxfer . xfer , size ) ; if ( sc -> sc_vs_cur -> bxfer . buf == NULL ) { printf ( "%s: could not allocate bulk VS buffer!\n" , DEVNAME ( sc ) ) ; return ( USBD_NOMEM ) ; } DPRINTF ( 1 , "%s: allocated %d bytes bulk VS xfer buffer\n" , DEVNAME ( sc ) , size ) ; return ( USBD_NORMAL_COMPLETION ) ; } 