static enum ud_type decode_gpr ( register struct ud * u , unsigned int s , unsigned char rm ) { switch ( s ) { case 64 : return UD_R_RAX + rm ; case 32 : return UD_R_EAX + rm ; case 16 : return UD_R_AX + rm ; case 8 : if ( u -> dis_mode == 64 && u -> pfx_rex ) { return UD_R_AL + rm ; } else { return UD_R_AL + rm ; } case 0 : UD_ASSERT ( u -> error ) ; return UD_NONE ; default : UD_ASSERT ( ! "invalid operand size" ) ; return UD_NONE ; } } 