HRESULT PATH_CCH_ADD_SEPARATOR ( PWSTR pszPath , size_t cchPath ) { size_t pszPathLength ; pszPathLength = lstrlenW ( pszPath ) ; if ( pszPath [ pszPathLength - 1 ] == CUR_PATH_SEPARATOR_CHR ) { return S_FALSE ; } if ( cchPath > ( pszPathLength + 1 ) ) { pszPath [ pszPathLength ] = CUR_PATH_SEPARATOR_CHR ; pszPath [ pszPathLength + 1 ] = '\0' ; return S_OK ; } return HRESULT_FROM_WIN32 ( ERROR_INSUFFICIENT_BUFFER ) ; } 