normalize_codeset ( ) char * codeset ; { size_t namelen , i ; int len , all_digits ; char * wp , * retval ; codeset = find_codeset ( codeset , & namelen ) ; all_digits = 1 ; for ( len = 0 , i = 0 ; i < namelen ; i ++ ) { if ( ISALNUM ( ( unsigned char ) codeset [ i ] ) ) { len ++ ; all_digits &= _rl_digit_p ( codeset [ i ] ) ; } } retval = ( char * ) malloc ( ( all_digits ?3 : 0 ) + len + 1 ) ; if ( retval == 0 ) { return ( ( char * ) 0 ) ; } wp = retval ; if ( all_digits ) { * wp ++ = 'i' ; * wp ++ = 's' ; * wp ++ = 'o' ; } for ( i = 0 ; i < namelen ; i ++ ) { if ( ISALPHA ( ( unsigned char ) codeset [ i ] ) ) { * wp ++ = _rl_to_lower ( codeset [ i ] ) ; } if ( _rl_digit_p ( codeset [ i ] ) ) { * wp ++ = codeset [ i ] ; } } * wp = '\0' ; return retval ; } 