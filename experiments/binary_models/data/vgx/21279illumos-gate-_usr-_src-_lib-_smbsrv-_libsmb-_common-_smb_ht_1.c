HT_ITEM * ht_findnext ( HT_ITERATOR * iterator ) { HT_HANDLE * handle ; HT_ITEM * item ; size_t total ; size_t index ; if ( iterator == 0 || iterator -> hti_handle == 0 || iterator -> hti_sequence == 0 ) { return ( NULL ) ; } handle = iterator -> hti_handle ; if ( iterator -> hti_item == 0 || iterator -> hti_sequence != handle -> ht_sequence ) { return ( NULL ) ; } item = ht_bucket_search ( iterator -> hti_item -> hi_next ) ; if ( item != 0 ) { iterator -> hti_item = item ; return ( item ) ; } total = handle -> ht_table_size ; for ( index = iterator -> hti_index + 1 ; index < total ; ++ index ) { item = ht_bucket_search ( handle -> ht_table [ index ] . he_head ) ; if ( item != 0 ) { iterator -> hti_index = index ; iterator -> hti_item = item ; return ( item ) ; } } iterator -> hti_index = 0 ; iterator -> hti_item = 0 ; return ( NULL ) ; } 