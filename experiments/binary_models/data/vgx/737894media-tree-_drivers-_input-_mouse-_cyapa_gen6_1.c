static int cyapa_gen6_set_interval_setting ( struct cyapa * cyapa , struct gen6_interval_setting * interval_setting ) { gen6_set_interval_cmd { __le16 addr ; __le16 length ; u8 report_id ; u8 rsvd ; u8 cmd_code ; __le16 active_interval ; __le16 lp1_interval ; __le16 lp2_interval ; } , __packed set_interval_cmd u8 resp_data [ 11 ] ; int resp_len ; int error ; put_unaligned_le16 ( PIP_OUTPUT_REPORT_ADDR , & set_interval_cmd . addr ) ; put_unaligned_le16 ( sizeof ( set_interval_cmd ) - 2 , & set_interval_cmd . length ) ; set_interval_cmd . report_id = PIP_APP_CMD_REPORT_ID ; set_interval_cmd . cmd_code = GEN6_SET_POWER_MODE_INTERVAL ; put_unaligned_le16 ( interval_setting -> active_interval , & set_interval_cmd . active_interval ) ; put_unaligned_le16 ( interval_setting -> lp1_interval , & set_interval_cmd . lp1_interval ) ; put_unaligned_le16 ( interval_setting -> lp2_interval , & set_interval_cmd . lp2_interval ) ; resp_len = sizeof ( resp_data ) ; error = cyapa_i2c_pip_cmd_irq_sync ( cyapa , ( u8 * ) & set_interval_cmd , sizeof ( set_interval_cmd ) , resp_data , & resp_len , 500 , cyapa_sort_tsg_pip_app_resp_data , false ) ; if ( error || ! VALID_CMD_RESP_HEADER ( resp_data , GEN6_SET_POWER_MODE_INTERVAL ) ) { return error < 0 ?error : - EINVAL ; } interval_setting -> active_interval = get_unaligned_le16 ( & resp_data [ 5 ] ) ; interval_setting -> lp1_interval = get_unaligned_le16 ( & resp_data [ 7 ] ) ; interval_setting -> lp2_interval = get_unaligned_le16 ( & resp_data [ 9 ] ) ; return 0 ; } 