static int dao_set_right_input ( struct dao * dao , struct rsc * input ) { struct imapper * entry ; struct daio * daio = & dao -> daio ; int i ; entry = kzalloc ( ( sizeof ( * entry ) * daio -> rscr . msr ) , GFP_KERNEL ) ; dao -> ops -> clear_right_input ( dao ) ; input -> ops -> master ( input ) ; daio -> rscr . ops -> master ( & daio -> rscr ) ; for ( i = 0 ; i < daio -> rscr . msr ; i ++ , entry ++ ) { entry -> slot = input -> ops -> output_slot ( input ) ; entry -> user = entry -> addr = daio -> rscr . ops -> index ( & daio -> rscr ) ; dao -> mgr -> imap_add ( dao -> mgr , entry ) ; dao -> imappers [ daio -> rscl . msr + i ] = entry ; input -> ops -> next_conj ( input ) ; daio -> rscr . ops -> next_conj ( & daio -> rscr ) ; } input -> ops -> master ( input ) ; daio -> rscr . ops -> master ( & daio -> rscr ) ; return 0 ; } 