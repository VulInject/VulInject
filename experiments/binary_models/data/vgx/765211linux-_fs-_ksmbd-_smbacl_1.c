static void FUN1 ( struct VAR1 * VAR2 , struct VAR3 * VAR4 , char * VAR5 , struct VAR6 * VAR7 , struct VAR6 * VAR8 , struct VAR9 * VAR10 ) { int VAR11 , VAR12 ; int VAR13 = 0 ; unsigned int VAR14 ; char * VAR15 ; struct VAR16 * * VAR17 ; struct VAR18 * VAR19 , * VAR20 ; struct posix_acl_state VAR21 , VAR22 ; umode_t VAR23 = 0 , VAR24 ; bool VAR25 = false , VAR26 = false , VAR27 = false ; if ( VAR5 < ( char * ) VAR4 + sizeof ( VAR3 ) || VAR5 < ( char * ) VAR4 + FUN2 ( VAR4 -> VAR28 ) ) { FUN3 ( "" ) ; return ; } FUN4 ( VAR29 , "" , FUN2 ( VAR4 -> VAR30 ) , FUN2 ( VAR4 -> VAR28 ) , FUN5 ( VAR4 -> VAR13 ) ) ; VAR15 = ( char * ) VAR4 ; VAR14 = sizeof ( VAR3 ) ; VAR13 = FUN5 ( VAR4 -> VAR13 ) ; if ( VAR13 <= 0 ) { return ; } if ( VAR13 > VAR31 / sizeof ( VAR16 * ) ) { return ; } VAR17 = FUN6 ( VAR13 , sizeof ( VAR16 * ) , VAR32 ) ; if ( ! VAR17 ) { return ; } VAR12 = FUN7 ( & VAR21 , VAR13 ) ; if ( VAR12 ) { return ; } VAR12 = FUN7 ( & VAR22 , VAR13 ) ; if ( VAR12 ) { FUN8 ( & VAR21 ) ; return ; } for ( VAR11 = 0 ; VAR11 < VAR13 ; ++ VAR11 ) { if ( VAR5 - VAR15 < VAR14 ) { break ; } VAR17 [ VAR11 ] = ( VAR16 * ) ( VAR15 + VAR14 ) ; VAR15 = ( char * ) VAR17 [ VAR11 ] ; VAR14 = FUN9 ( VAR16 , VAR33 ) + FUN9 ( VAR6 , VAR34 ) ; if ( VAR5 - FUN10 ( VAR14 || VAR17 [ VAR11 ] -> VAR33 . VAR35 ) VAR36 || ( VAR5 - VAR15 < VAR14 + sizeof ( VAR37 ) * VAR17 [ VAR11 ] -> VAR33 . VAR35 ) || ( FUN2 ( VAR17 [ VAR11 ] -> VAR28 ) < VAR14 + sizeof ( VAR37 ) * VAR17 [ VAR11 ] -> VAR33 . VAR35 ) ) { break ; } VAR14 = FUN2 ( VAR17 [ VAR11 ] -> VAR28 ) ; VAR17 [ VAR11 ] -> VAR38 = FUN11 ( VAR17 [ VAR11 ] -> VAR38 ) ; if ( ! ( FUN12 ( & VAR17 [ VAR11 ] -> VAR33 , & VAR39 ) ) ) { VAR10 -> VAR40 = FUN5 ( VAR17 [ VAR11 ] -> VAR33 . VAR34 [ 2 ] ) ; break ; } if ( ! FUN12 ( & VAR17 [ VAR11 ] -> VAR33 , VAR7 ) ) { VAR24 = FUN13 ( VAR10 , VAR17 [ VAR11 ] -> VAR38 , VAR17 [ VAR11 ] -> VAR41 ) ; VAR24 &= 0700 ; if ( ! VAR25 ) { VAR23 &= ~ ( 0700 ) ; VAR23 |= VAR24 ; } VAR25 = true ; } if ( ! FUN12 ( & VAR17 [ VAR11 ] -> VAR33 , VAR8 ) || VAR17 [ VAR11 ] -> VAR33 . VAR34 [ VAR17 [ VAR11 ] -> VAR33 . VAR35 - 1 ] == VAR42 ) { VAR24 = FUN13 ( VAR10 , VAR17 [ VAR11 ] -> VAR38 , VAR17 [ VAR11 ] -> VAR41 ) ; VAR24 &= 0070 ; if ( ! VAR26 ) { VAR23 &= ~ ( 0070 ) ; VAR23 |= VAR24 ; } VAR26 = true ; } if ( ! FUN12 ( & VAR17 [ VAR11 ] -> VAR33 , & VAR43 ) ) { VAR24 = FUN13 ( VAR10 , VAR17 [ VAR11 ] -> VAR38 , VAR17 [ VAR11 ] -> VAR41 ) ; VAR24 &= 0007 ; if ( ! VAR27 ) { VAR23 &= ~ ( 0007 ) ; VAR23 |= VAR24 ; } VAR27 = true ; } if ( ! FUN12 ( & VAR17 [ VAR11 ] -> VAR33 , & VAR44 ) ) { continue ; } if ( ! FUN12 ( & VAR17 [ VAR11 ] -> VAR33 , & VAR45 ) ) { continue ; } if ( ! FUN12 ( & VAR17 [ VAR11 ] -> VAR33 , & VAR46 ) ) { continue ; } else { struct smb_fattr VAR47 ; VAR24 = FUN13 ( VAR10 , VAR17 [ VAR11 ] -> VAR38 , VAR17 [ VAR11 ] -> VAR41 ) ; VAR47 . VAR48 = VAR49 ; VAR12 = FUN14 ( VAR2 , & VAR17 [ VAR11 ] -> VAR33 , VAR50 , & VAR47 ) ; if ( VAR12 || FUN15 ( VAR47 . VAR48 , VAR49 ) ) { FUN3 ( "" , VAR51 , VAR12 ) ; continue ; } VAR21 . VAR52 . VAR53 = ( ( VAR24 & 0700 ) >> 6 ) | 0004 ; VAR21 . VAR54 -> VAR55 [ VAR21 . VAR54 -> VAR56 ] . VAR57 = VAR47 . VAR48 ; VAR21 . VAR54 -> VAR55 [ VAR21 . VAR54 -> VAR56 ++ ] . VAR58 . VAR53 = ( ( VAR24 & 0700 ) >> 6 ) | 0004 ; VAR22 . VAR52 . VAR53 = ( ( VAR24 & 0700 ) >> 6 ) | 0004 ; VAR22 . VAR54 -> VAR55 [ VAR22 . VAR54 -> VAR56 ] . VAR57 = VAR47 . VAR48 ; VAR22 . VAR54 -> VAR55 [ VAR22 . VAR54 -> VAR56 ++ ] . VAR58 . VAR53 = ( ( VAR24 & 0700 ) >> 6 ) | 0004 ; } } FUN16 ( VAR17 ) ; if ( VAR25 ) { VAR21 . VAR52 . VAR53 = ( ( VAR23 & 0700 ) >> 6 ) | 0004 ; VAR21 . VAR54 -> VAR55 [ VAR21 . VAR54 -> VAR56 ] . VAR57 = VAR10 -> VAR48 ; VAR21 . VAR54 -> VAR55 [ VAR21 . VAR54 -> VAR56 ++ ] . VAR58 . VAR53 = ( ( VAR23 & 0700 ) >> 6 ) | 0004 ; VAR22 . VAR52 . VAR53 = ( ( VAR23 & 0700 ) >> 6 ) | 0004 ; VAR22 . VAR54 -> VAR55 [ VAR22 . VAR54 -> VAR56 ] . VAR57 = VAR10 -> VAR48 ; VAR22 . VAR54 -> VAR55 [ VAR22 . VAR54 -> VAR56 ++ ] . VAR58 . VAR53 = ( ( VAR23 & 0700 ) >> 6 ) | 0004 ; } if ( VAR26 ) { VAR21 . VAR59 . VAR53 = ( VAR23 & 0070 ) >> 3 ; VAR21 . VAR60 -> VAR55 [ VAR21 . VAR60 -> VAR56 ] . VAR61 = VAR10 -> VAR62 ; VAR21 . VAR60 -> VAR55 [ VAR21 . VAR60 -> VAR56 ++ ] . VAR58 . VAR53 = ( VAR23 & 0070 ) >> 3 ; VAR22 . VAR59 . VAR53 = ( VAR23 & 0070 ) >> 3 ; VAR22 . VAR60 -> VAR55 [ VAR22 . VAR60 -> VAR56 ] . VAR61 = VAR10 -> VAR62 ; VAR22 . VAR60 -> VAR55 [ VAR22 . VAR60 -> VAR56 ++ ] . VAR58 . VAR53 = ( VAR23 & 0070 ) >> 3 ; } if ( VAR27 ) { VAR10 -> VAR40 &= ~ ( 0007 ) ; VAR10 -> VAR40 |= VAR23 & 0007 ; VAR21 . VAR63 . VAR53 = VAR23 & 0007 ; VAR22 . VAR63 . VAR53 = VAR23 & 0007 ; } if ( VAR21 . VAR54 -> VAR56 || VAR21 . VAR60 -> VAR56 ) { VAR21 . VAR64 . VAR53 = 0x07 ; if ( FUN17 ( VAR65 ) ) { VAR10 -> VAR66 = FUN18 ( VAR21 . VAR54 -> VAR56 + VAR21 . VAR60 -> VAR56 + 4 , VAR32 ) ; if ( VAR10 -> VAR66 ) { VAR19 = VAR10 -> VAR66 -> VAR67 ; FUN19 ( & VAR21 , VAR19 ) ; } } } if ( VAR22 . VAR54 -> VAR56 || VAR22 . VAR60 -> VAR56 ) { VAR22 . VAR64 . VAR53 = 0x07 ; if ( FUN17 ( VAR65 ) ) { VAR10 -> VAR68 = FUN18 ( VAR22 . VAR54 -> VAR56 + VAR22 . VAR60 -> VAR56 + 4 , VAR32 ) ; if ( VAR10 -> VAR68 ) { VAR20 = VAR10 -> VAR68 -> VAR67 ; FUN19 ( & VAR22 , VAR20 ) ; } } } FUN8 ( & VAR21 ) ; FUN8 ( & VAR22 ) ; }