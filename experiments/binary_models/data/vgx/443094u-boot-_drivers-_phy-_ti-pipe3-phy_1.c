static int pipe3_phy_probe ( struct udevice * dev ) { fdt_addr_t addr ; fdt_size_t sz ; struct omap_pipe3 * pipe3 = dev_get_priv ( dev ) ; struct pipe3_data * data ; addr = devfdt_get_addr_size_index ( dev , 0 , & sz ) ; if ( addr == FDT_ADDR_T_NONE ) { pr_err ( "missing phy_rx address\n" ) ; return - EINVAL ; } pipe3 -> phy_rx = map_physmem ( addr , sz , MAP_NOCACHE ) ; if ( ! pipe3 -> phy_rx ) { pr_err ( "unable to remap phy_rx\n" ) ; return - EINVAL ; } addr = devfdt_get_addr_size_index ( dev , 2 , & sz ) ; if ( addr == FDT_ADDR_T_NONE ) { pr_err ( "missing pll ctrl address\n" ) ; return - EINVAL ; } pipe3 -> pll_ctrl_base = map_physmem ( addr , sz , MAP_NOCACHE ) ; if ( ! pipe3 -> pll_ctrl_base ) { pr_err ( "unable to remap pll ctrl\n" ) ; return - EINVAL ; } pipe3 -> power_reg = get_reg ( dev , "syscon-phy-power" ) ; data = ( pipe3_data * ) dev_get_driver_data ( dev ) ; pipe3 -> mode = data -> mode ; pipe3 -> dpll_map = data -> dpll_map ; pipe3 -> settings = data -> settings ; if ( pipe3 -> mode == PIPE3_MODE_SATA ) { pipe3 -> pll_reset_reg = get_reg ( dev , "syscon-pllreset" ) ; if ( ! pipe3 -> pll_reset_reg ) { return - EINVAL ; } } return 0 ; } 