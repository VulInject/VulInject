xcap_node_sel_t * xcapInitNodeSel ( void ) { xcap_node_sel_t * nsel = NULL ; nsel = ( xcap_node_sel_t * ) pkg_malloc ( sizeof ( xcap_node_sel_t ) ) ; if ( nsel == NULL ) { ERR_MEM ( PKG_MEM_STR ) ; } nsel -> steps = ( step_t * ) pkg_malloc ( sizeof ( step_t ) ) ; if ( nsel -> steps == NULL ) { ERR_MEM ( PKG_MEM_STR ) ; } memset ( nsel -> steps , 0 , sizeof ( step_t ) ) ; nsel -> last_step = nsel -> steps ; nsel -> ns_list = ( ns_list_t * ) pkg_malloc ( sizeof ( ns_list_t ) ) ; if ( nsel -> ns_list == NULL ) { ERR_MEM ( PKG_MEM_STR ) ; } memset ( nsel -> ns_list , 0 , sizeof ( ns_list_t ) ) ; nsel -> last_ns = nsel -> ns_list ; return nsel ; error if ( nsel ) { if ( nsel -> steps ) { pkg_free ( nsel -> steps ) ; } if ( nsel -> ns_list ) { pkg_free ( nsel -> ns_list ) ; } pkg_free ( nsel ) ; } return NULL ; } 