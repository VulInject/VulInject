int xsk_umem__delete ( struct xsk_umem * umem ) { struct xdp_mmap_offsets off ; int err ; if ( ! umem ) { return 0 ; } if ( umem -> refcount ) { return - EBUSY ; } err = xsk_get_mmap_offsets ( umem -> fd , & off ) ; if ( ! err && umem -> fill_save && umem -> comp_save ) { munmap ( umem -> fill_save -> ring - off . fr . desc , off . fr . desc + umem -> config . fill_size * sizeof ( __u64 ) ) ; munmap ( umem -> comp_save -> ring - off . cr . desc , off . cr . desc + umem -> config . comp_size * sizeof ( __u64 ) ) ; } close ( umem -> fd ) ; return 0 ; } 