int drawline ( dx , dy , s ) int dx , dy ; char * s ; { int xd , yd ; float val , slope ; int i , numdots ; int dirmot , perp ; int motincr , perpincr ; int ohpos , ovpos , osize , ofont ; float incrway ; int itemp ; osize = size ; setsize ( t_size ( pstab [ osize - 1 ] / drawsize ) ) ; ohpos = hpos ; ovpos = vpos ; xd = dx / DX ; yd = dy / DX ; if ( xd == 0 ) { numdots = abs ( yd ) ; numdots = min ( numdots , maxdots ) ; motincr = DX * sgn ( yd ) ; for ( i = 0 ; i < numdots ; i ++ ) { vmot ( motincr ) ; put1 ( drawdot ) ; } vgoto ( ovpos + dy ) ; setsize ( osize , NULL ) ; return ( 0 ) ; } if ( yd == 0 ) { numdots = abs ( xd ) ; motincr = DX * sgn ( xd ) ; for ( i = 0 ; i < numdots ; i ++ ) { hmot ( motincr ) ; put1 ( drawdot ) ; } hgoto ( ohpos + dx ) ; setsize ( osize ) ; return ( 0 ) ; } if ( abs ( xd ) > abs ( yd ) ) { val = slope = ( float ) xd / yd ; numdots = abs ( xd ) ; numdots = min ( numdots , maxdots ) ; dirmot = 'h' ; perp = 'v' ; motincr = DX * sgn ( xd ) ; perpincr = DX * sgn ( yd ) ; } else { val = slope = ( float ) yd / xd ; numdots = abs ( yd ) ; numdots = min ( numdots , maxdots ) ; dirmot = 'v' ; perp = 'h' ; motincr = DX * sgn ( yd ) ; perpincr = DX * sgn ( xd ) ; } incrway = itemp = sgn ( ( int ) slope ) ; for ( i = 0 ; i < numdots ; i ++ ) { val -= incrway ; if ( dirmot == 'h' ) { hmot ( motincr ) ; } else { vmot ( motincr ) ; } if ( val * slope < 0 ) { if ( perp == 'h' ) { hmot ( perpincr ) ; } else { vmot ( perpincr ) ; } val += slope ; } put1 ( drawdot ) ; } hgoto ( ohpos + dx ) ; vgoto ( ovpos + dy ) ; setsize ( osize ) ; return ( 0 ) ; } 