static void conskbd_streams_setled ( struct kbtrans_hardware * hw , int led_state ) { conskbd_state_t * conskbdp = ( conskbd_state_t * ) hw ; conskbd_lower_queue_t * lqs ; mblk_t * req ; ASSERT ( & conskbd == conskbdp ) ; if ( led_state == - 1 ) { return ; } conskbdp -> conskbd_led_state = led_state ; for ( lqs = conskbdp -> conskbd_lqueue_list ; lqs ; lqs = lqs -> lqs_next ) { req = mkiocb ( KIOCSLED ) ; req -> b_cont = allocb ( sizeof ( uchar_t ) , BPRI_MED ) ; if ( ! req -> b_cont ) { freemsg ( req ) ; continue ; } * ( uchar_t * ) req -> b_cont -> b_wptr = led_state ; req -> b_cont -> b_wptr += sizeof ( uchar_t ) ; if ( putq ( lqs -> lqs_queue , req ) != 1 ) { freemsg ( req ) ; } } } 