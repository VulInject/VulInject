void rt2x00crypto_tx_remove_iv ( struct sk_buff * skb , struct txentry_desc * txdesc ) { struct skb_frame_desc * skbdesc = get_skb_frame_desc ( skb ) ; memcpy ( skbdesc -> iv , skb -> data + txdesc -> iv_offset , txdesc -> iv_len ) ; memmove ( skb -> data + txdesc -> iv_len , skb -> data , txdesc -> iv_offset ) ; skb_pull ( skb , txdesc -> iv_len ) ; txdesc -> length -= txdesc -> iv_len ; skbdesc -> flags |= SKBDESC_IV_STRIPPED ; } 