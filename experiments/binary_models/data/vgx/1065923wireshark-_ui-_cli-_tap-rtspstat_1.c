static void rtspstat_init ( const char * opt_arg , void * userdata _U_ ) { rtspstat_t * sp ; const char * filter = NULL ; GString * error_string ; if ( ! strncmp ( opt_arg , "rtsp,stat," , 10 ) ) { filter = opt_arg + 10 ; } else { filter = NULL ; } sp = g_new ( rtspstat_t , 1 ) ; sp -> filter = g_strdup ( filter ) ; error_string = register_tap_listener ( "rtsp" , sp , filter , 0 , rtspstat_reset , rtspstat_packet , rtspstat_draw , NULL ) ; if ( error_string ) { g_free ( sp ) ; cmdarg_err ( "Couldn't register rtsp,stat tap: %s" , error_string -> str ) ; g_string_free ( error_string , TRUE ) ; exit ( 1 ) ; } rtsp_init_hash ( sp ) ; } static stat_tap_ui rtspstat_ui = { REGISTER_STAT_GROUP_GENERIC NULL "rtsp,stat" rtspstat_init 0 NULL } ; 