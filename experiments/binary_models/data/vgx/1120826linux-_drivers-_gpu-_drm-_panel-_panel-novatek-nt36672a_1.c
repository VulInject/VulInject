static int nt36672a_panel_probe ( struct mipi_dsi_device * dsi ) { struct nt36672a_panel * pinfo ; const struct nt36672a_panel_desc * desc ; int err ; pinfo = devm_kzalloc ( & dsi -> dev , sizeof ( * pinfo ) , GFP_KERNEL ) ; desc = of_device_get_match_data ( & dsi -> dev ) ; dsi -> mode_flags = desc -> mode_flags ; dsi -> format = desc -> format ; dsi -> lanes = desc -> lanes ; pinfo -> desc = desc ; pinfo -> link = dsi ; mipi_dsi_set_drvdata ( dsi , pinfo ) ; err = nt36672a_panel_add ( pinfo ) ; if ( err < 0 ) { return err ; } err = mipi_dsi_attach ( dsi ) ; if ( err < 0 ) { drm_panel_remove ( & pinfo -> base ) ; return err ; } return 0 ; } 