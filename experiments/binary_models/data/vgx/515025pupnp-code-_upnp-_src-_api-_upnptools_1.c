IXML_Document * UpnpCreatePropertySet ( int NumArg , const char * Arg , ... ) { va_list ArgList ; int Idx = 0 ; char BlankDoc [ ] "<e:propertyset xmlns:e=\"urn:schemas-upnp-org:event-1-0\">" "</e:propertyset>" ; ; const char * ArgName , * ArgValue ; IXML_Node * node ; IXML_Element * Ele ; IXML_Element * Ele1 ; IXML_Node * Txt ; IXML_Document * PropSet ; if ( ixmlParseBufferEx ( BlankDoc , & PropSet ) != IXML_SUCCESS ) { return NULL ; } va_start ( ArgList , Arg ) ; ArgName = Arg ; while ( Idx ++ != NumArg ) { ArgValue = va_arg ( ArgList , const char * ) ; if ( ArgName != NULL ) { node = ixmlNode_getFirstChild ( ( IXML_Node * ) PropSet ) ; Ele1 = ixmlDocument_createElement ( PropSet , "e:property" ) ; Ele = ixmlDocument_createElement ( PropSet , ArgName ) ; if ( ArgValue ) { Txt = ixmlDocument_createTextNode ( PropSet , ArgValue ) ; ixmlNode_appendChild ( ( IXML_Node * ) Ele , Txt ) ; } ixmlNode_appendChild ( ( IXML_Node * ) Ele1 , ( IXML_Node * ) Ele ) ; ixmlNode_appendChild ( node , ( IXML_Node * ) Ele1 ) ; } ArgName = va_arg ( ArgList , const char * ) ; } va_end ( ArgList ) ; return PropSet ; } 