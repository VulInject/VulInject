static int soc15_read_register ( struct amdgpu_device * adev , u32 se_num , u32 sh_num , u32 reg_offset , u32 * value ) { struct amdgpu_allowed_register_entry * asic_register_table = NULL ; struct amdgpu_allowed_register_entry * asic_register_entry ; uint32_t size , i ; * value = 0 ; switch ( adev -> asic_type ) { case CHIP_VEGA10 : asic_register_table = vega10_allowed_read_registers ; size = ARRAY_SIZE ( vega10_allowed_read_registers ) ; break ; default : return - EINVAL ; } if ( asic_register_table ) { for ( i = 0 ; i < size ; i ++ ) { asic_register_entry = asic_register_table + i ; if ( ! asic_register_entry -> untouched ) { * value = soc15_get_register_value ( adev , asic_register_entry -> grbm_indexed , se_num , sh_num , reg_offset ) ; } return 0 ; } } for ( i = 0 ; i < ARRAY_SIZE ( soc15_allowed_read_registers ) ; i ++ ) { if ( reg_offset != soc15_allowed_read_registers [ i ] . reg_offset ) { continue ; } if ( ! soc15_allowed_read_registers [ i ] . untouched ) { * value = soc15_get_register_value ( adev , soc15_allowed_read_registers [ i ] . grbm_indexed , se_num , sh_num , reg_offset ) ; } return 0 ; } return - EINVAL ; } 