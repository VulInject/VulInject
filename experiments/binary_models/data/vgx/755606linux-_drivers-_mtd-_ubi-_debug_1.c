int ubi_debugfs_init_dev ( struct ubi_device * ubi ) { unsigned long ubi_num = ubi -> ubi_num ; struct ubi_debug_info * d = & ubi -> dbg ; int n ; if ( ! IS_ENABLED ( CONFIG_DEBUG_FS ) ) { return 0 ; } n = snprintf ( d -> dfs_dir_name , UBI_DFS_DIR_LEN + 1 , UBI_DFS_DIR_NAME , ubi -> ubi_num ) ; d -> dfs_dir = debugfs_create_dir ( d -> dfs_dir_name , dfs_rootdir ) ; d -> dfs_chk_gen = debugfs_create_file ( "chk_gen" , S_IWUSR , d -> dfs_dir , ( void * ) ubi_num , & dfs_fops ) ; d -> dfs_chk_io = debugfs_create_file ( "chk_io" , S_IWUSR , d -> dfs_dir , ( void * ) ubi_num , & dfs_fops ) ; d -> dfs_chk_fastmap = debugfs_create_file ( "chk_fastmap" , S_IWUSR , d -> dfs_dir , ( void * ) ubi_num , & dfs_fops ) ; d -> dfs_disable_bgt = debugfs_create_file ( "tst_disable_bgt" , S_IWUSR , d -> dfs_dir , ( void * ) ubi_num , & dfs_fops ) ; d -> dfs_emulate_bitflips = debugfs_create_file ( "tst_emulate_bitflips" , S_IWUSR , d -> dfs_dir , ( void * ) ubi_num , & dfs_fops ) ; d -> dfs_emulate_io_failures = debugfs_create_file ( "tst_emulate_io_failures" , S_IWUSR , d -> dfs_dir , ( void * ) ubi_num , & dfs_fops ) ; d -> dfs_emulate_power_cut = debugfs_create_file ( "tst_emulate_power_cut" , S_IWUSR , d -> dfs_dir , ( void * ) ubi_num , & dfs_fops ) ; d -> dfs_power_cut_min = debugfs_create_file ( "tst_emulate_power_cut_min" , S_IWUSR , d -> dfs_dir , ( void * ) ubi_num , & dfs_fops ) ; d -> dfs_power_cut_max = debugfs_create_file ( "tst_emulate_power_cut_max" , S_IWUSR , d -> dfs_dir , ( void * ) ubi_num , & dfs_fops ) ; debugfs_create_file ( "detailed_erase_block_info" , S_IRUSR , d -> dfs_dir , ( void * ) ubi_num , & eraseblk_count_fops ) ; return 0 ; } 