pevent_edited ( , , , ) { GtkTreeModel * model = gtk_tree_view_get_model ( GTK_TREE_VIEW ( pevent_dialog_list ) ) ; GtkTreePath * path ; GtkTreeIter iter ; GtkXText * xtext = GTK_XTEXT ( pevent_dialog_twid ) ; int len , m ; const char * text ; char * out ; int sig ; if ( ! gtkutil_treeview_get_selected ( GTK_TREE_VIEW ( pevent_dialog_list ) , & iter , ROW_COLUMN , & sig , - 1 ) ) { return ; } text = new_text ; len = strlen ( new_text ) ; if ( pevt_build_string ( text , & out , & m ) != 0 ) { fe_message ( _ ( "There was an error parsing the string" ) , FE_MSG_ERROR ) ; return ; } if ( m > ( te [ sig ] . num_args & 0x7f ) ) { g_free ( out ) ; out = g_strdup_printf ( _ ( "This signal is only passed %d args, $%d is invalid" ) , te [ sig ] . num_args & 0x7f , m ) ; fe_message ( out , FE_MSG_WARN ) ; g_free ( out ) ; return ; } path = gtk_tree_path_new_from_string ( pathstr ) ; gtk_tree_model_get_iter ( model , & iter , path ) ; gtk_list_store_set ( GTK_LIST_STORE ( model ) , & iter , TEXT_COLUMN , new_text , - 1 ) ; gtk_tree_path_free ( path ) ; g_free ( pntevts [ sig ] ) ; pntevts_text [ sig ] = g_strdup ( text ) ; pntevts [ sig ] = out ; out = g_malloc ( len + 2 ) ; memcpy ( out , text , len + 1 ) ; out [ len ] = '\n' ; out [ len + 1 ] = 0 ; check_special_chars ( out , TRUE ) ; PrintTextRaw ( xtext -> buffer , out , 0 , 0 ) ; g_free ( out ) ; gtk_adjustment_set_value ( xtext -> adj , gtk_adjustment_get_upper ( xtext -> adj ) ) ; prefs . save_pevents = 1 ; } 