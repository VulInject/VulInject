static gboolean dissect_cpin_parameter ( tvbuff_t * tvb , packet_info * pinfo _U_ , proto_tree * tree , gint offset , gint role , guint16 type , guint8 * parameter_stream , guint parameter_number , gint parameter_length , at_packet_info_t * at_info _U_ , void * * data _U_ ) { proto_item * pitem ; gboolean is_ready ; gchar * pin_type ; if ( type == TYPE_ACTION ) { switch ( parameter_number ) { case 0 : proto_tree_add_item ( tree , hf_cpin_pin , tvb , offset , parameter_length , ENC_NA | ENC_ASCII ) ; break ; case 1 : proto_tree_add_item ( tree , hf_cpin_newpin , tvb , offset , parameter_length , ENC_NA | ENC_ASCII ) ; break ; default : return FALSE ; } return TRUE ; } if ( parameter_number == 0 ) { pitem = proto_tree_add_item ( tree , hf_cpin_code , tvb , offset , parameter_length , ENC_NA | ENC_ASCII ) ; is_ready = g_ascii_strncasecmp ( "READY" , ( gchar * ) parameter_stream , parameter_length ) == 0 ; if ( is_ready ) { proto_item_append_text ( pitem , " (MT is not pending for any password)" ) ; } else { pin_type = wmem_strndup ( pinfo -> pool , parameter_stream , parameter_length ) ; proto_item_append_text ( pitem , " (MT is waiting %s to be given)" , pin_type ) ; } return TRUE ; } return FALSE ; } 