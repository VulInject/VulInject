static void StatsLogSummary ( void ) { if ( ! stats_enabled ) { return ; } int alerts = 0 ; SCMutexLock ( & stats_table_mutex ) ; if ( stats_table . start_time != 0 ) { const StatsTable * st = & stats_table ; for ( uint32_t u = 0 ; u < st -> nstats ; u ++ ) { const char * name = st -> stats [ u ] . name ; if ( name == NULL || strcmp ( name , "detect.alert" ) != 0 ) { continue ; } alerts = st -> stats [ u ] . value ; break ; } } SCMutexUnlock ( & stats_table_mutex ) ; SCLogInfo ( "Alerts: %" PRIu64 , alerts ) ; } 