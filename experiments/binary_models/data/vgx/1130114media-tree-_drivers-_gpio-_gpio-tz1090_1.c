static void tz1090_gpio_register_banks ( struct tz1090_gpio * priv ) { struct device_node * np = priv -> dev -> of_node ; struct device_node * node ; for_each_available_child_of_node ( , ) { struct tz1090_gpio_bank_info info ; u32 addr ; int ret ; ret = of_property_read_u32 ( node , "reg" , & addr ) ; if ( ret ) { dev_err ( priv -> dev , "invalid reg on %s\n" , node -> full_name ) ; continue ; } if ( addr >= 3 ) { dev_err ( priv -> dev , "index %u in %s out of range\n" , addr , node -> full_name ) ; continue ; } info . index = addr ; info . node = of_node_get ( node , NULL ) ; info . priv = priv ; ret = tz1090_gpio_bank_probe ( & info ) ; if ( ret ) { dev_err ( priv -> dev , "failure registering %s\n" , node -> full_name ) ; of_node_put ( node ) ; continue ; } } } 