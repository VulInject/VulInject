_gcry_cipher_poly1305_authenticate ( , , ) { if ( c -> u_mode . poly1305 . aad_finalized ) { return GPG_ERR_INV_STATE ; } if ( c -> marks . tag ) { return GPG_ERR_INV_STATE ; } if ( ! c -> marks . iv ) { poly1305_set_zeroiv ( c ) ; } if ( poly1305_bytecounter_add ( c -> u_mode . poly1305 . aadcount , aadbuflen ) ) { c -> u_mode . poly1305 . bytecount_over_limits = 1 ; return GPG_ERR_INV_LENGTH ; } _gcry_poly1305_update ( & c -> u_mode . poly1305 . ctx , aadbuf , aadbuflen ) ; return 0 ; } 