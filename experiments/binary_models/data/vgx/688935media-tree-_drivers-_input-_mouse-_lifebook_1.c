static int lifebook_create_relative_device ( struct psmouse * psmouse ) { struct input_dev * dev2 ; struct lifebook_data * priv ; int error = - ENOMEM ; priv = kzalloc ( sizeof ( lifebook_data ) , GFP_KERNEL ) ; dev2 = input_allocate_device ( ) ; if ( ! priv || ! dev2 ) { err_out } priv -> dev2 = dev2 ; sprintf ( priv -> phys , "%s/input1" , psmouse -> ps2dev . serio -> phys ) ; dev2 -> phys = priv -> phys ; dev2 -> name = "LBPS/2 Fujitsu Lifebook Touchpad" ; dev2 -> id . bustype = BUS_I8042 ; dev2 -> id . vendor = 0x0002 ; dev2 -> id . product = PSMOUSE_LIFEBOOK ; dev2 -> id . version = 0x0000 ; dev2 -> dev . parent = & psmouse -> ps2dev . serio -> dev ; dev2 -> evbit [ 0 ] = BIT_MASK ( EV_KEY ) | BIT_MASK ( EV_REL ) ; dev2 -> relbit [ BIT_WORD ( REL_X ) ] = BIT_MASK ( REL_X ) | BIT_MASK ( REL_Y ) ; dev2 -> keybit [ BIT_WORD ( BTN_LEFT ) ] = BIT_MASK ( BTN_LEFT ) | BIT_MASK ( BTN_RIGHT ) ; error = input_register_device ( priv -> dev2 ) ; if ( error ) { err_out } psmouse -> private = priv ; return 0 ; err_out input_free_device ( dev2 ) ; kfree ( priv ) ; return error ; } 