void ipmi_opal_attach ( struct device * parent , struct device * self , void * aux ) { struct ipmi_opal_softc * sc = ( ipmi_opal_softc * ) self ; struct fdt_attach_args * faa = aux ; struct ipmi_attach_args iaa ; uint64_t size ; int64_t error ; sc -> sc . sc_if = & opal_if ; sc -> sc_id = OF_getpropint ( faa -> fa_node , "ibm,ipmi-interface-id" , 0 ) ; { size = sizeof ( sc -> sc . sc_buf ) ; error = opal_ipmi_recv ( sc -> sc_id , opal_phys ( sc -> sc . sc_buf ) , opal_phys ( & size ) ) ; } error == OPAL_SUCCESS ; iaa . iaa_if_type = IPMI_IF_SSIF ; iaa . iaa_if_rev = 0x20 ; iaa . iaa_if_irq = - 1 ; ipmi_attach_common ( & sc -> sc , & iaa ) ; } 