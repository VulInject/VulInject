static int fm_printf ( int depth , int c , int cols , const char * format , ... ) { va_list ap ; int width ; int c1 ; va_start ( ap , format ) ; width = vsnprintf ( & c1 , sizeof ( c1 ) , format , ap ) ; va_end ( ap ) ; if ( c + width >= cols ) { console_printf ( "\n" ) ; c = 0 ; if ( format [ 0 ] != ' ' && depth > 0 ) { console_printf ( " " ) ; c ++ ; } } va_start ( ap , format ) ; console_vprintf ( format , ap ) ; va_end ( ap ) ; return ( ( c + width ) % cols ) ; } 