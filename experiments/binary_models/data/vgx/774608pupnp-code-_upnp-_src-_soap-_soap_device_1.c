static int check_soap_request ( soap_devserv_t * soap_info , IN IXML_Document * xml_doc , IXML_Node * * req_node ) { IXML_Node * envp_node = NULL ; IXML_Node * body_node ; IXML_Node * action_node = NULL ; const DOMString local_name = NULL ; const DOMString ns_uri = NULL ; int ret_val = - 1 ; envp_node = ixmlNode_getFirstChild ( ( IXML_Node * ) xml_doc ) ; if ( NULL == envp_node ) { error_handler } ns_uri = ixmlNode_getNamespaceURI ( envp_node ) ; if ( NULL == ns_uri || strcmp ( ns_uri , SOAP_URN ) != 0 ) { error_handler } body_node = ixmlNode_getFirstChild ( envp_node ) ; if ( NULL == body_node ) { error_handler } local_name = ixmlNode_getLocalName ( body_node ) ; if ( NULL == local_name || strcmp ( local_name , SOAP_BODY ) != 0 ) { error_handler } action_node = ixmlNode_getFirstChild ( body_node ) ; if ( NULL == action_node ) { error_handler } ns_uri = ixmlNode_getNamespaceURI ( action_node ) ; if ( NULL == ns_uri ) { error_handler } local_name = ixmlNode_getLocalName ( action_node ) ; if ( NULL == local_name ) { error_handler } if ( NULL == soap_info -> action_name . buf ) { IXML_Node * varname_node = NULL ; IXML_Node * nametxt_node = NULL ; if ( strcmp ( ns_uri , QUERY_STATE_VAR_URN ) != 0 || strcmp ( local_name , "QueryStateVariable" ) != 0 ) { error_handler } varname_node = ixmlNode_getFirstChild ( action_node ) ; if ( NULL == varname_node ) { error_handler } local_name = ixmlNode_getLocalName ( varname_node ) ; if ( strcmp ( local_name , "varName" ) != 0 ) { error_handler } nametxt_node = ixmlNode_getFirstChild ( varname_node ) ; if ( NULL == nametxt_node || ixmlNode_getNodeType ( nametxt_node ) != eTEXT_NODE ) { error_handler } * req_node = nametxt_node ; } else { if ( strcmp ( soap_info -> service_type , ns_uri ) != 0 || memptr_cmp ( & soap_info -> action_name , local_name ) != 0 ) { error_handler } * req_node = action_node ; } ret_val = 0 ; error_handler return ret_val ; } 