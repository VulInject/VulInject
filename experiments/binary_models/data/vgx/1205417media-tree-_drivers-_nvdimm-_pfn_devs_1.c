struct device * nd_pfn_devinit ( struct nd_pfn * nd_pfn , struct nd_namespace_common * ndns ) { struct device * dev = & nd_pfn -> dev ; if ( ! nd_pfn ) { return NULL ; } nd_pfn -> mode = PFN_MODE_NONE ; nd_pfn -> align = HPAGE_SIZE ; dev = & nd_pfn -> dev ; device_initialize ( & nd_pfn -> dev ) ; if ( ndns && ! __nd_attach_ndns ( & nd_pfn -> dev , ndns , & nd_pfn -> ndns ) ) { dev_dbg ( & ndns -> dev , "%s failed, already claimed by %s\n" , __func__ , dev_name ( ndns -> claim ) ) ; put_device ( dev , NULL ) ; return NULL ; } return dev ; } 