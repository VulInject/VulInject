static void DevicePresent ( struct net_device * dev , u_long aprom_addr ) { int i , j = 0 ; struct de4x5_private * lp = netdev_priv ( dev ) ; if ( lp -> chipset == DC21040 ) { if ( lp -> bus == EISA ) { enet_addr_rst ( aprom_addr ) ; } else { outl ( 0 , aprom_addr ) ; } } else { int tmp ; __le16 * p = ( __le16 * ) ( ( char * ) & lp -> srom + SROM_HWADD ) ; for ( i = 0 ; i < ( ETH_ALEN >> 1 ) ; i ++ ) { tmp = srom_rd ( aprom_addr , ( SROM_HWADD >> 1 ) + i ) ; j += tmp ; * p = cpu_to_le16 ( tmp ) ; } if ( j == 0 || j == 3 * 0xffff ) { return ; } p = ( __le16 * ) & lp -> srom ; for ( i = 0 ; i < ( sizeof ( de4x5_srom ) >> 1 ) ; i ++ ) { tmp = srom_rd ( aprom_addr , i ) ; * p ++ = cpu_to_le16 ( tmp ) ; } de4x5_dbg_srom ( & lp -> srom ) ; } } 