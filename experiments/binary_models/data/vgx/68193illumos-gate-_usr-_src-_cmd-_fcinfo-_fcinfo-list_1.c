static void processRemotePort ( HBA_HANDLE handle , HBA_WWN portWWN , HBA_FCPTARGETMAPPINGV2 * map , int wwnCount , char * * wwn_argv , int flags ) { int remote_wwn_counter ; uint64_t remotePortWWN ; HBA_WWN myremotePortWWN ; HBA_PORTATTRIBUTES discPort ; HBA_STATUS status ; for ( remote_wwn_counter = 0 ; remote_wwn_counter < wwnCount ; remote_wwn_counter ++ ) { int times = 0 ; sscanf ( wwn_argv [ remote_wwn_counter ] , "%016llx" , & remotePortWWN ) ; remotePortWWN = htonll ( remotePortWWN ) ; memcpy ( myremotePortWWN . wwn , & remotePortWWN , sizeof ( remotePortWWN ) ) ; status = HBA_GetPortAttributesByWWN ( handle , myremotePortWWN , & discPort ) ; while ( status == HBA_STATUS_ERROR_TRY_AGAIN || status == HBA_STATUS_ERROR_BUSY ) { ( void ) sleep ( 1 ) ; status = HBA_GetPortAttributesByWWN ( handle , myremotePortWWN , & discPort ) ; if ( times ++ > HBA_MAX_RETRIES ) { break ; } } if ( status != HBA_STATUS_OK ) { fprintf ( stderr , gettext ( "HBA_GetPortAttributesByWWN " "failed: reason: " ) ) ; printStatus ( status ) ; fprintf ( stderr , "\n" ) ; continue ; } handleRemotePort ( handle , portWWN , myremotePortWWN , & discPort ) ; if ( ( flags & PRINT_LINKSTAT ) == PRINT_LINKSTAT ) { printLinkStat ( handle , portWWN , myremotePortWWN ) ; } if ( ( flags & PRINT_SCSI_TARGET ) == PRINT_SCSI_TARGET ) { handleScsiTarget ( handle , portWWN , myremotePortWWN , map ) ; } } } 