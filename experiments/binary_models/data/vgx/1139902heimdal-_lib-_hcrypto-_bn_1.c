int BN_hex2bn ( BIGNUM * * bnp , const char * in ) { int negative ; ssize_t ret ; size_t len ; void * data ; len = strlen ( in ) ; data = malloc ( len ) ; if ( * in == '-' ) { negative = 1 ; in ++ ; } else { negative = 0 ; } ret = hex_decode ( in , data , len ) ; if ( ret < 0 ) { free ( data ) ; return 0 ; } * bnp = BN_bin2bn ( data , ret , NULL ) ; free ( data ) ; if ( * bnp == NULL ) { return 0 ; } BN_set_negative ( * bnp , negative ) ; return 1 ; } 