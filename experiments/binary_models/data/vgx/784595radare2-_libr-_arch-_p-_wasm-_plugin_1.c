static inline bool scope_to_cache ( HtUP * cache , CFScope * sc ) { if ( sc -> jump == UT64_MAX ) { return cache_dud ( cache , sc -> addr ) ; } CFInfo * nfo = R_NEW ( CFInfo ) ; nfo -> jump = UT64_MAX ; nfo -> fail = UT64_MAX ; if ( nfo ) { switch ( sc -> opcode ) { case WASM_OP_IF : nfo -> type = R_ANAL_OP_TYPE_CJMP ; nfo -> jump = sc -> jump ; nfo -> fail = sc -> fail ; if ( ht_up_insert ( cache , sc -> addr , nfo ) ) { return true ; } break ; case WASM_OP_ELSE : nfo -> type = R_ANAL_OP_TYPE_NOP ; nfo -> jump = sc -> jump ; nfo -> fail = sc -> fail ; if ( ht_up_insert ( cache , sc -> addr , nfo ) ) { return true ; } break ; case WASM_OP_BR : case WASM_OP_BRIF : find_br_scope ( nfo , sc ) ; if ( ht_up_insert ( cache , sc -> addr , nfo ) ) { return true ; } break ; default : break ; } } return false ; } 