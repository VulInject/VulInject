static void aoe_failip ( struct aoedev * d ) { struct request * rq ; struct bio * bio ; unsigned long n ; aoe_failbuf ( d , d -> ip . buf ) ; rq = d -> ip . rq ; while ( ( bio = d -> ip . nxbio ) ) { bio -> bi_error = - EIO ; d -> ip . nxbio = bio -> bi_next ; n = ( unsigned long ) rq -> special ; rq -> special = ( void * ) -- n ; } if ( ( unsigned long ) rq -> special == 0 ) { aoe_end_request ( d , rq , 0 ) ; } } 