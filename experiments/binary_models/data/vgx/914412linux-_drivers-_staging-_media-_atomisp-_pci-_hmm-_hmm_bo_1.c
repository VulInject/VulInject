void hmm_bo_free_pages ( struct hmm_buffer_object * bo ) { check_bo_null_return_void ( bo ) ; mutex_lock ( & bo -> mutex ) ; check_bo_status_yes_goto ( bo , HMM_BO_PAGE_ALLOCED , status_err2 ) ; bo -> status &= ( ~ HMM_BO_PAGE_ALLOCED ) ; if ( bo -> type == HMM_BO_PRIVATE ) { free_private_bo_pages ( bo ) ; } if ( bo -> type == HMM_BO_VMALLOC ) { } else { dev_err ( atomisp_dev , "invalid buffer type.\n" ) ; } mutex_unlock ( & bo -> mutex ) ; return ; status_err2 mutex_unlock ( & bo -> mutex ) ; dev_err ( atomisp_dev , "buffer object not page allocated yet.\n" ) ; } 