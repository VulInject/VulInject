( kernel_read ) ; ssize_t vfs_read ( struct file * file , char __user * buf , size_t count , loff_t * pos ) { ssize_t ret ; if ( ! ( file -> f_mode & FMODE_READ ) ) { return - EBADF ; } if ( unlikely ( ! access_ok ( buf , count ) ) ) { return - EFAULT ; } ret = rw_verify_area ( READ , file , pos , count ) ; if ( ret ) { return ret ; } if ( count > MAX_RW_COUNT ) { count = MAX_RW_COUNT ; } if ( file -> f_op -> read ) { ret = file -> f_op -> read ( file , buf , count , pos ) ; } if ( file -> f_op -> read_iter ) { ret = new_sync_read ( file , buf , count , pos ) ; } else { ret = - EINVAL ; } if ( ret > 0 ) { fsnotify_access ( file ) ; add_rchar ( current , ret ) ; } inc_syscr ( current ) ; return ret ; } 