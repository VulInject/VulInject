der_get_oid ( , , , ) { size_t n ; size_t oldlen = len ; assert ( p != NULL ) ; if ( size ) { * size = 0 ; } if ( len < 1 ) { return ASN1_OVERRUN ; } if ( len + 1 > UINT_MAX / sizeof ( data -> components [ 0 ] ) ) { return ERANGE ; } data -> components = malloc ( ( len + 1 ) * sizeof ( data -> components [ 0 ] ) ) ; if ( data -> components == NULL ) { data -> length = 0 ; return ENOMEM ; } data -> components [ 0 ] = ( * p ) / 40 ; data -> components [ 1 ] = ( * p ) % 40 ; -- len ; ++ p ; for ( n = 2 ; len > 0 ; ++ n ) { unsigned u = 0 , u1 ; { -- len ; u1 = u * 128 + ( * p ++ % 128 ) ; if ( u1 < u ) { der_free_oid ( data ) ; return ASN1_OVERRUN ; } u = u1 ; } len > 0 && p [ - 1 ] & 0x80 ; data -> components [ n ] = u ; } if ( n > 2 && p [ - 1 ] & 0x80 ) { der_free_oid ( data ) ; return ASN1_OVERRUN ; } data -> length = n ; if ( size ) { * size = oldlen ; } return 0 ; } 