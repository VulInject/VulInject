void Fill_Clip ( playerState_t * ps , int weapon ) { int inclip , maxclip , ammomove ; int ammoweap = BG_FindAmmoForWeapon ( weapon ) ; if ( g_dmflags . integer & DF_NO_WEAPRELOAD ) { return ; } inclip = ps -> ammoclip [ BG_FindClipForWeapon ( weapon ) ] ; maxclip = ammoTable [ weapon ] . maxclip ; ammomove = maxclip - inclip ; if ( ammomove > ps -> ammo [ ammoweap ] ) { ammomove = ps -> ammo [ ammoweap ] ; } if ( ammomove ) { if ( ! ps -> aiChar || ps -> ammo [ ammoweap ] < 999 ) { ps -> ammo [ ammoweap ] -= ammomove ; } ps -> ammoclip [ BG_FindClipForWeapon ( weapon ) ] += ammomove ; } } 