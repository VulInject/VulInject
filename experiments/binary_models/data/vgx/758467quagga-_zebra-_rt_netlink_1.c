netlink_interface ( , , ) { int len ; struct ifinfomsg * ifi ; struct rtattr * tb [ IFLA_MAX + 1 ] ; struct interface * ifp ; char * name ; ifi = NLMSG_DATA ( h ) ; if ( h -> nlmsg_type != RTM_NEWLINK ) { return 0 ; } len = h -> nlmsg_len - NLMSG_LENGTH ( sizeof ( ifinfomsg ) ) ; memset ( tb , 0 , sizeof tb ) ; netlink_parse_rtattr ( tb , IFLA_MAX , IFLA_RTA ( ifi ) , len ) ; if ( ( tb [ IFLA_WIRELESS ] != NULL ) && ( ifi -> ifi_change == 0 ) ) { if ( IS_ZEBRA_DEBUG_KERNEL ) { zlog_debug ( "%s: ignoring IFLA_WIRELESS message" , __func__ ) ; } return 0 ; } if ( tb [ IFLA_IFNAME ] == NULL ) { return - 1 ; } name = ( char * ) RTA_DATA ( tb [ IFLA_IFNAME ] ) ; ifp = if_get_by_name_vrf ( name , vrf_id ) ; set_ifindex ( ifp , ifi -> ifi_index ) ; ifp -> flags = ifi -> ifi_flags & 0x0000fffff ; ifp -> mtu6 = ifp -> mtu = * ( uint32_t * ) RTA_DATA ( tb [ IFLA_MTU ] ) ; ifp -> metric = 0 ; ifp -> ll_type = netlink_to_zebra_link_type ( ifi -> ifi_type ) ; netlink_interface_update_hw_addr ( tb , ifp ) ; if_add_update ( ifp ) ; return 0 ; } 