static int constructRSASigningKey ( struct pgpDigKeyRSA_s * key ) { if ( key -> evp_pkey ) { return 1 ; } if ( key -> immutable ) { return 0 ; } key -> immutable = 1 ; RSA * rsa = RSA_new ( ) ; if ( ! rsa ) { return 0 ; } if ( RSA_set0_key ( rsa , key -> n , key -> e , NULL ) <= 0 ) { exit } key -> n = key -> e = NULL ; if ( ! ( key -> evp_pkey = EVP_PKEY_new ( ) ) ) { exit } if ( ! EVP_PKEY_assign_RSA ( key -> evp_pkey , rsa ) ) { EVP_PKEY_free ( key -> evp_pkey ) ; exit } return 1 ; exit RSA_free ( rsa ) ; return 0 ; } 