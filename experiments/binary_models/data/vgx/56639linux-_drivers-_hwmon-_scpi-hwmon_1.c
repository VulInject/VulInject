static int scpi_read_temp ( struct thermal_zone_device * tz , int * temp ) { struct scpi_thermal_zone * zone = tz -> devdata ; struct scpi_sensors * scpi_sensors = zone -> scpi_sensors ; struct scpi_ops * scpi_ops = scpi_sensors -> scpi_ops ; struct sensor_data * sensor = & scpi_sensors -> data [ zone -> sensor_id ] ; u64 value ; int ret ; ret = scpi_ops -> sensor_get_value ( sensor -> info . sensor_id , & value ) ; scpi_scale_reading ( & value , sensor ) ; * temp = value ; return 0 ; } 