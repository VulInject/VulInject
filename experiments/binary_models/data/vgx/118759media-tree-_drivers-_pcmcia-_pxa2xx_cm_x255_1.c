int __init cmx255_pcmcia_init ( void ) { int ret ; cmx255_pcmcia_device = platform_device_alloc ( "pxa2xx-pcmcia" , - 1 ) ; ret = platform_device_add_data ( cmx255_pcmcia_device , & cmx255_pcmcia_ops , sizeof ( cmx255_pcmcia_ops ) ) ; if ( ret == 0 ) { printk ( KERN_INFO "Registering cm-x255 PCMCIA interface.\n" ) ; ret = platform_device_add ( cmx255_pcmcia_device ) ; } if ( ret ) { platform_device_put ( cmx255_pcmcia_device ) ; } return ret ; } 