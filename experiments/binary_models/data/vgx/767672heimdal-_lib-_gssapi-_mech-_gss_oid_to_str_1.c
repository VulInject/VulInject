* SUCH DAMAGE . * / GSSAPI_LIB_FUNCTION OM_uint32 GSSAPI_LIB_CALL gss_oid_to_str ( , , ) { int ret size_t size heim_oid o char * p _mg_buffer_zero ( oid_str ) ret = der_get_oid ( oid -> elements , oid -> length , & o , & size ) } ; if ( ret ) { * minor_status = ret ; return GSS_S_FAILURE ; } ret = der_print_heim_oid ( & o , ' ' , & p ) ; der_free_oid ( & o ) ; if ( ret ) { * minor_status = ret ; return GSS_S_FAILURE ; } oid_str -> value = p ; oid_str -> length = strlen ( p ) ; * minor_status = 0 ; return GSS_S_COMPLETE ; 