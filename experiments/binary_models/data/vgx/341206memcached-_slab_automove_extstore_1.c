void * slab_automove_extstore_init ( struct settings * settings ) { uint32_t window_size = settings -> slab_automove_window ; double max_age_ratio = settings -> slab_automove_ratio ; slab_automove * a = calloc ( 1 , sizeof ( slab_automove ) ) ; if ( a == NULL ) { return NULL ; } a -> window_data = calloc ( window_size * MAX_NUMBER_OF_SLAB_CLASSES , sizeof ( window_data ) ) ; a -> window_size = window_size ; a -> max_age_ratio = max_age_ratio ; a -> free_ratio = settings -> slab_automove_freeratio ; a -> item_size = settings -> ext_item_size ; a -> settings = settings ; a -> pool_filled_once = false ; if ( a -> window_data == NULL ) { if ( a -> window_data ) { free ( a -> window_data ) ; } return NULL ; } fill_item_stats_automove ( a -> iam_before ) ; fill_slab_stats_automove ( a -> sam_before ) ; return ( void * ) a ; } 