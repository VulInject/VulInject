static int copy_out_args ( struct fuse_copy_state * cs , struct fuse_args * args , unsigned nbytes ) { unsigned reqsize = sizeof ( fuse_out_header ) ; reqsize += fuse_len_args ( args -> out_numargs , args -> out_args ) ; if ( reqsize < nbytes || ( reqsize > nbytes && ! args -> out_argvar ) ) { return - EINVAL ; } if ( reqsize > nbytes ) { struct fuse_arg * lastarg = & args -> out_args [ args -> out_numargs - 1 ] ; unsigned diffsize = reqsize - nbytes ; lastarg -> size -= diffsize ; } return fuse_copy_args ( cs , args -> out_numargs , args -> out_pages , args -> out_args , args -> page_zeroing ) ; } 