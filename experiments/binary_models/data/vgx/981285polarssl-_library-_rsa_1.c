int mbedtls_rsa_rsaes_pkcs1_v15_decrypt ( mbedtls_rsa_context * ctx , int * f_rng ( void * , unsigned char * , size_t ) , void * p_rng , size_t * olen , const unsigned char * input , unsigned char * output , size_t output_max_len ) { int ret = MBEDTLS_ERR_ERROR_CORRUPTION_DETECTED ; size_t ilen ; unsigned char buf [ MBEDTLS_MPI_MAX_SIZE ] ; ilen = ctx -> len ; if ( ilen ( 16 || ilen ) sizeof ( buf ) ) { return MBEDTLS_ERR_RSA_BAD_INPUT_DATA ; } ret = mbedtls_rsa_private ( ctx , f_rng , p_rng , input , buf ) ; if ( ret != 0 ) { cleanup } ret = mbedtls_ct_rsaes_pkcs1_v15_unpadding ( buf , ilen , output , output_max_len , olen ) ; cleanup mbedtls_platform_zeroize ( buf , sizeof ( buf ) ) ; return ret ; } 