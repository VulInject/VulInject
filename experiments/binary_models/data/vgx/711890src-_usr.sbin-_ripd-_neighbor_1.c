LIST_HEAD ( nbr_head , nbr ) ; nbr_table { struct nbr_head * hashtbl ; u_int32_t hashmask ; } , nbrtable & nbrtable . hashtbl [ ( x ) & nbrtable . hashmask ] u_int32_t peercnt = NBR_CNTSTART ; { int state ; int event ; enum nbr_action action ; int new_state ; } , nbr_fsm_tbl [ ] { { NBR_STA_DOWN NBR_EVT_REQUEST_RCVD NBR_ACT_NOTHING NBR_STA_REQ_RCVD } { NBR_STA_DOWN NBR_EVT_RESPONSE_RCVD NBR_ACT_STRT_TIMER NBR_STA_ACTIVE } { NBR_STA_ACTIVE NBR_EVT_RESPONSE_RCVD NBR_ACT_RST_TIMER NBR_STA_ACTIVE } { NBR_STA_ACTIVE NBR_EVT_REQUEST_RCVD NBR_ACT_NOTHING NBR_STA_ACTIVE } { NBR_STA_ACTIVE NBR_EVT_TIMEOUT NBR_ACT_DEL NBR_STA_DOWN } { NBR_STA_REQ_RCVD NBR_EVT_RESPONSE_SENT NBR_ACT_DEL NBR_STA_DOWN } { NBR_STA_ACTIVE NBR_EVT_RESPONSE_SENT NBR_ACT_NOTHING NBR_STA_ACTIVE } { NBR_STA_ANY NBR_EVT_KILL_NBR NBR_ACT_DEL NBR_STA_DOWN } { - 1 NBR_EVT_NOTHING NBR_ACT_NOTHING 0 } } ; 