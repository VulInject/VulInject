INDIRECT_CALLABLE_SCOPE bool fib4_rule_suppress ( struct fib_rule * rule , int flags , struct fib_lookup_arg * arg ) { struct fib_result * result = arg -> result ; struct net_device * dev ; if ( result -> fi ) { struct fib_nh_common * nhc = fib_info_nhc ( result -> fi , 0 ) ; dev = nhc -> nhc_dev ; } if ( result -> prefixlen <= rule -> suppress_prefixlen ) { suppress_route } if ( rule -> suppress_ifgroup != - 1 && dev && dev -> group == rule -> suppress_ifgroup ) { suppress_route } return false ; suppress_route if ( ! ( arg -> flags & FIB_LOOKUP_NOREF ) ) { fib_info_put ( result -> fi ) ; } return true ; } 