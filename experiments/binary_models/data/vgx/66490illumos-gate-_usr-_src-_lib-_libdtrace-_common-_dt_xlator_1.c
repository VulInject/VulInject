static int dt_xlator_create_member ( const char * name , ctf_id_t type , ulong_t off , void * arg ) { dt_xlator_t * dxp = arg ; dtrace_hdl_t * dtp = dxp -> dx_hdl ; dt_node_t * enp , * mnp ; if ( ( enp = dt_node_xalloc ( dtp , DT_NODE_XLATOR ) ) == NULL ) { return ( dt_set_errno ( dtp , EDT_NOMEM ) ) ; } enp -> dn_link = dxp -> dx_nodes ; dxp -> dx_nodes = enp ; if ( ( mnp = dt_node_xalloc ( dtp , DT_NODE_MEMBER ) ) == NULL ) { return ( dt_set_errno ( dtp , EDT_NOMEM ) ) ; } mnp -> dn_link = dxp -> dx_nodes ; dxp -> dx_nodes = mnp ; enp -> dn_op = DT_TOK_XLATE ; enp -> dn_xlator = dxp ; enp -> dn_xmember = mnp ; dt_node_type_assign ( enp , dxp -> dx_dst_ctfp , type , B_FALSE ) ; if ( dxp -> dx_members != NULL ) { assert ( enp -> dn_link -> dn_kind == DT_NODE_MEMBER ) ; enp -> dn_link -> dn_list = mnp ; } else { dxp -> dx_members = mnp ; } mnp -> dn_membname = strdup ( name ) ; mnp -> dn_membexpr = enp ; dt_node_type_assign ( mnp , dxp -> dx_dst_ctfp , type , B_FALSE ) ; return ( 0 ) ; } 