static BOOL tsg_packet_capabilities_to_string ( char * * buffer , size_t * length , const TSG_PACKET_CAPABILITIES * caps , UINT32 numCaps ) { int x ; WINPR_ASSERT ( buffer ) ; WINPR_ASSERT ( length ) ; WINPR_ASSERT ( caps ) ; if ( ! tsg_print ( buffer , length , "capabilities { " ) ) { return FALSE ; } for ( x = 0 ; x < numCaps ; x ++ ) { const TSG_PACKET_CAPABILITIES * cur = & caps [ x ] ; switch ( cur -> capabilityType ) { case TSG_CAPABILITY_TYPE_NAP : if ( ! tsg_type_capability_nap_to_string ( buffer , length , & cur -> tsgPacket . tsgCapNap ) ) { return FALSE ; } break ; default : if ( ! tsg_print ( buffer , length , "TSG_UNKNOWN_CAPABILITY" ) ) { return FALSE ; } break ; } } return tsg_print ( buffer , length , " }" ) ; } 