int lancer_cmd_get_pport_stats ( struct be_adapter * adapter , struct be_dma_mem * nonemb_cmd ) { struct be_mcc_wrb * wrb ; struct lancer_cmd_req_pport_stats * req ; int status = 0 ; mutex_lock ( & adapter -> mcc_lock ) ; wrb = wrb_from_mccq ( adapter ) ; if ( ! wrb ) { status = - EBUSY ; err } req = nonemb_cmd -> va ; be_wrb_cmd_hdr_prepare ( & req -> hdr , CMD_SUBSYSTEM_ETH , OPCODE_ETH_GET_PPORT_STATS , nonemb_cmd -> size , wrb , nonemb_cmd ) ; req -> cmd_params . params . pport_num = cpu_to_le16 ( adapter -> hba_port_num ) ; req -> cmd_params . params . reset_stats = 0 ; status = be_mcc_notify ( adapter ) ; if ( status ) { err } adapter -> stats_cmd_sent = true ; err mutex_unlock ( & adapter -> mcc_lock ) ; return status ; } 