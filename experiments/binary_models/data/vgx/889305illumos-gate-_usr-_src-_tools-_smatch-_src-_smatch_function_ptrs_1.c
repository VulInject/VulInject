char * get_returned_ptr ( struct expression * expr ) { struct symbol * type ; char * name ; char buf [ 256 ] ; if ( expr -> type != EXPR_CALL ) { return in ; } if ( ! expr -> fn || expr -> fn -> type != EXPR_SYMBOL ) { return NULL ; } type = get_type ( expr ) ; if ( type && type -> type == SYM_PTR ) { type = get_real_base_type ( type ) ; } if ( ! type || type -> type != SYM_FN ) { return NULL ; } name = expr_to_var ( expr -> fn ) ; if ( ! name ) { return NULL ; } snprintf ( buf , sizeof ( buf ) , "r %s()" , name ) ; free_string ( name ) ; return alloc_string ( buf ) ; } 