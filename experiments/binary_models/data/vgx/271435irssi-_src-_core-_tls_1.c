void tls_rec_free ( TLS_REC * tls_rec ) { if ( tls_rec == NULL ) { return ; } g_free_and_null ( tls_rec -> protocol_version ) ; g_free_and_null ( tls_rec -> public_key_algorithm ) ; g_free_and_null ( tls_rec -> public_key_fingerprint ) ; g_free_and_null ( tls_rec -> public_key_fingerprint_algorithm ) ; g_free_and_null ( tls_rec -> certificate_fingerprint ) ; g_free_and_null ( tls_rec -> certificate_fingerprint_algorithm ) ; g_free_and_null ( tls_rec -> not_after ) ; g_free_and_null ( tls_rec -> not_before ) ; g_free_and_null ( tls_rec -> ephemeral_key_algorithm ) ; if ( tls_rec -> certs != NULL ) { g_slist_foreach ( tls_rec -> certs , ( GFunc ) tls_cert_rec_free , NULL ) ; g_slist_free ( tls_rec -> certs ) ; tls_rec -> certs = NULL ; } g_free ( tls_rec ) ; } 