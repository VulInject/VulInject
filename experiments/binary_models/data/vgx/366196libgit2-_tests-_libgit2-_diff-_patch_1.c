static int check_removal_cb ( const git_diff_delta * delta , const git_diff_hunk * hunk , const git_diff_line * line , void * payload ) { switch ( line -> origin ) { case GIT_DIFF_LINE_FILE_HDR : cl_assert_equal_s ( EXPECTED_HEADER , line -> content ) ; cl_assert ( hunk == NULL ) ; check_delta case GIT_DIFF_LINE_HUNK_HDR : cl_assert_equal_s ( EXPECTED_HUNK , line -> content ) ; check_hunk case GIT_DIFF_LINE_CONTEXT : case GIT_DIFF_LINE_DELETION : check_hunk default : return - 1 ; } check_hunk cl_assert ( hunk != NULL ) ; cl_assert_equal_i ( 1 , hunk -> old_start ) ; cl_assert_equal_i ( 2 , hunk -> old_lines ) ; cl_assert_equal_i ( 0 , hunk -> new_start ) ; cl_assert_equal_i ( 0 , hunk -> new_lines ) ; check_delta cl_assert_equal_s ( "subdir.txt" , delta -> old_file . path ) ; cl_assert_equal_s ( "subdir.txt" , delta -> new_file . path ) ; cl_assert_equal_i ( GIT_DELTA_DELETED , delta -> status ) ; return 0 ; } 