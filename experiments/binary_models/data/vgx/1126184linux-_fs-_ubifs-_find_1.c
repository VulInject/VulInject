static int find_dirtiest_idx_leb ( struct ubifs_info * c ) { const struct ubifs_lprops * lp ; int lnum ; while ( 1 ) { lnum = ( size_t ) c -> dirty_idx . arr [ -- c -> dirty_idx . cnt ] ; lp = ubifs_lpt_lookup ( c , lnum ) ; if ( IS_ERR ( lp ) ) { return PTR_ERR ( lp ) ; } if ( ( lp -> flags & LPROPS_TAKEN ) || ! ( lp -> flags & LPROPS_INDEX ) ) { continue ; } lp = ubifs_change_lp ( c , lp , LPROPS_NC , LPROPS_NC , lp -> flags | LPROPS_TAKEN , 0 ) ; if ( IS_ERR ( lp ) ) { return PTR_ERR ( lp ) ; } break ; } dbg_find ( "LEB %d, dirty %d and free %d flags %#x" , lp -> lnum , lp -> dirty , lp -> free , lp -> flags ) ; ubifs_assert ( c , lp -> flags & LPROPS_TAKEN ) ; ubifs_assert ( c , lp -> flags & LPROPS_INDEX ) ; return lnum ; } 