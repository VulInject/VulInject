void add_module_mozilla ( const struct location * locations , size_t locations_len , const char * module_path , const char * module_name , const char * exclude_module_path ) { size_t i ; for ( i = 0 ; i < locations_len ; i ++ ) { char * profiles_ini = NULL ; const char * home = getenv ( locations [ i ] . var ) ; if ( ! home ) { continue ; } if ( get_profiles_ini ( home , locations [ i ] . dir , & profiles_ini ) ) { const char * p = profiles_ini ; while ( 1 ) { const char * profile_path = get_next_profile_path ( & p , home , locations [ i ] . dir ) ; if ( ! profile_path ) { break ; } add_module_pkcs11_txt ( profile_path , module_path , module_name , exclude_module_path ) ; } } } } 