static void uwsgi_rados_read_async_cb ( rados_completion_t comp , void * data ) { struct uwsgi_rados_cb * urcb = ( uwsgi_rados_cb * ) data ; struct uwsgi_rados_io * urio = urcb -> urio ; if ( urcb -> rid != urio -> rid ) { uwsgi_log_verbose ( "[uwsgi-rados] callback %llu woke up too late\n" , ( unsigned long long ) urcb -> rid ) ; } else { if ( write ( urio -> fds [ 1 ] , "\1" , 1 ) <= 0 ) { uwsgi_error ( "uwsgi_rados_read_async_cb()/write()" ) ; } } pthread_mutex_unlock ( & urio -> mutex ) ; free ( urcb ) ; } 