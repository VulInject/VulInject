static void _oneapi_print_freqs ( ze_device_handle_t device , log_level_t l ) { zes_freq_handle_t freq_handles [ MAX_NUM_FREQUENCIES ] ; uint32_t freq_handle_size = MAX_NUM_FREQUENCIES ; zes_freq_properties_t freq_prop ; ze_result_t oneapi_rc ; oneapi_rc = zesDeviceEnumFrequencyDomains ( ( zes_device_handle_t ) device , & freq_handle_size , freq_handles ) ; if ( oneapi_rc != ZE_RESULT_SUCCESS ) { error ( "Failed to enumerate frequency domains: 0x%x" , oneapi_rc ) ; return ; } for ( int i = 0 ; i < freq_handle_size ; i ++ ) { unsigned int freqs [ MAX_NUM_FREQUENCIES ] { 0 } ; ; unsigned int freqs_size = MAX_NUM_FREQUENCIES ; qsort ( freqs , freqs_size , ( unsigned int ) , gpu_common_sort_freq_descending ) ; oneapi_rc = zesFrequencyGetProperties ( freq_handles [ i ] , & freq_prop ) ; if ( oneapi_rc != ZE_RESULT_SUCCESS ) { error ( "Failed to get freq properties: 0x%x" , oneapi_rc ) ; continue ; } _oneapi_print_freq_info ( & freq_prop , l ) ; if ( freq_prop . type == ZES_FREQ_DOMAIN_GPU ) { gpu_common_print_freqs ( freqs , freqs_size , l , "GPU Graphics" , 8 ) ; } if ( freq_prop . type == ZES_FREQ_DOMAIN_MEMORY ) { gpu_common_print_freqs ( freqs , freqs_size , l , "GPU Memory" , 8 ) ; } else { log_var ( l , "Unsupported frequency domain: %u" , freq_prop . type ) ; } } } 