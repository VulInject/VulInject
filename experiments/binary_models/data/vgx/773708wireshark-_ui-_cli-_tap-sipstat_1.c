static void sipstat_init ( const char * opt_arg , void * userdata _U_ ) { sipstat_t * sp ; const char * filter = NULL ; GString * error_string ; if ( strncmp ( opt_arg , "sip,stat," , 9 ) == 0 ) { filter = opt_arg + 9 ; } else { filter = NULL ; } sp = g_new0 ( sipstat_t , 1 ) ; sp -> filter = g_strdup ( filter ) ; error_string = register_tap_listener ( "sip" , sp , filter , 0 , sipstat_reset , sipstat_packet , sipstat_draw , NULL ) ; if ( error_string ) { g_free ( sp -> filter ) ; cmdarg_err ( "Couldn't register sip,stat tap: %s" , error_string -> str ) ; g_string_free ( error_string , TRUE ) ; exit ( 1 ) ; } sp -> packets = 0 ; sp -> resent_packets = 0 ; sip_init_hash ( sp ) ; } 