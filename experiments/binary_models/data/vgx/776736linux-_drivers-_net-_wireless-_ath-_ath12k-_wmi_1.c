static int ath12k_pull_vdev_install_key_compl_ev ( struct ath12k_base * ab , struct sk_buff * skb , struct wmi_vdev_install_key_complete_arg * arg ) { const void * * tb ; const struct wmi_vdev_install_key_compl_event * ev ; int ret ; tb = ath12k_wmi_tlv_parse_alloc ( ab , skb -> data , skb -> len , GFP_ATOMIC ) ; if ( IS_ERR ( tb ) ) { ret = PTR_ERR ( tb ) ; ath12k_warn ( ab , "failed to parse tlv: %d\n" , ret ) ; return ret ; } ev = tb [ WMI_TAG_VDEV_INSTALL_KEY_COMPLETE_EVENT ] ; if ( ! ev ) { ath12k_warn ( ab , "failed to fetch vdev install key compl ev" ) ; return - EPROTO ; } arg -> vdev_id = le32_to_cpu ( ev -> vdev_id ) ; arg -> macaddr = ev -> peer_macaddr . addr ; arg -> key_idx = le32_to_cpu ( ev -> key_idx ) ; arg -> key_flags = le32_to_cpu ( ev -> key_flags ) ; arg -> status = le32_to_cpu ( ev -> status ) ; kfree ( tb ) ; return 0 ; } 