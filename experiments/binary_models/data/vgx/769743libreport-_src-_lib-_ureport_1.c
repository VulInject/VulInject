static GList * parse_reported_to_from_json_list ( struct json_object * list ) { int i ; json_object * list_elem , * struct_elem ; const char * reporter , * value , * type ; char * reported_to_line = NULL ; g_autofree char * prefix = NULL ; GList * result = NULL ; for ( i = 0 ; i < json_object_array_length ( list ) ; ++ i ) { prefix = NULL ; list_elem = json_object_array_get_idx ( list , i ) ; if ( ! list_elem ) { continue ; } if ( ! json_object_object_get_ex ( list_elem , "reporter" , & struct_elem ) ) { continue ; } reporter = json_object_get_string ( struct_elem ) ; if ( ! json_object_object_get_ex ( list_elem , "value" , & struct_elem ) ) { continue ; } value = json_object_get_string ( struct_elem ) ; if ( ! value ) { continue ; } if ( ! json_object_object_get_ex ( list_elem , "type" , & struct_elem ) ) { continue ; } type = json_object_get_string ( struct_elem ) ; if ( type ) { if ( strcasecmp ( "url" , type ) == 0 ) { prefix = g_strdup ( "URL=" ) ; } if ( strcasecmp ( "bthash" , type ) == 0 ) { prefix = g_strdup ( "BTHASH=" ) ; } } if ( ! prefix ) { prefix = g_strdup ( "" ) ; } reported_to_line = g_strdup_printf ( "%s: %s%s" , reporter , prefix , value ) ; result = g_list_append ( result , reported_to_line ) ; } return result ; } 