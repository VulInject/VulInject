M_log_error_t M_log_module_syslog_set_tag_priority ( M_log_t * log , M_log_module_t * module , M_uint64 tags , M_syslog_priority_t priority ) { module_thunk_t * mdata ; if ( log == NULL || module == NULL || module -> module_thunk == NULL || tags == 0 ) { return M_LOG_INVALID_PARAMS ; } if ( module -> type != M_LOG_MODULE_SYSLOG ) { return M_LOG_WRONG_MODULE ; } M_thread_rwlock_lock ( log -> rwlock , M_THREAD_RWLOCK_TYPE_WRITE ) ; if ( ! module_present_locked ( log , module ) ) { return M_LOG_MODULE_NOT_FOUND ; } mdata = module -> module_thunk ; while ( tags != 0 ) { M_uint8 tag_idx ; tag_idx = M_uint64_log2 ( tags ) ; mdata -> tag_to_priority [ tag_idx ] = priority ; tags = tags & ~ ( ( M_uint64 ) 1 << tag_idx ) ; } M_thread_rwlock_unlock ( log -> rwlock ) ; return M_LOG_SUCCESS ; } 