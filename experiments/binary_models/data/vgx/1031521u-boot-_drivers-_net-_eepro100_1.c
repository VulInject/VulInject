static void eepro100_get_hwaddr ( struct eepro100_priv * priv ) { u16 sum = 0 ; int i , j ; int addr_len = read_eeprom ( priv , 0 , 6 ) == 0xffff ?8 : 6 ; for ( j = 0 , i = 0 ; i < 0x40 ; i ++ ) { u16 value = read_eeprom ( priv , i , addr_len ) ; sum += value ; if ( i < 3 ) { priv -> enetaddr [ j ++ ] = value ; priv -> enetaddr [ j ++ ] = value >> 8 ; } } if ( sum != 0xBABA ) { debug ( "%s: Invalid EEPROM checksum %#4.4x, check settings before activating this device!\n" , priv -> name , sum ) ; } } 