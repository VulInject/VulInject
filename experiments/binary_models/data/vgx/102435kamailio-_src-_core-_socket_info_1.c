static int FUN1 ( void ) { { struct nlmsghdr VAR1 ; struct rtgenmsg VAR2 ; } , req int VAR3 = 0 ; struct VAR4 * VAR5 ; struct VAR6 * VAR7 ; int VAR8 ; char VAR9 [ VAR10 ] ; char * VAR11 = VAR9 ; int VAR12 = 0 ; struct VAR13 * VAR14 ; int VAR15 , VAR16 ; struct VAR17 * VAR18 ; struct VAR17 * VAR19 ; int VAR20 = - 1 ; int VAR21 [ ] { AF_INET VAR22 } ; ; char VAR23 [ VAR24 ] ; int VAR25 = 0 ; if ( VAR26 == NULL ) { if ( ( VAR26 = ( VAR27 * ) FUN2 ( VAR28 * sizeof ( VAR27 ) ) ) == NULL ) { VAR29 ; return - 1 ; } memset ( VAR26 , 0 , sizeof ( VAR27 ) * VAR28 ) ; } if ( ( VAR20 = FUN3 ( ) ) < 0 ) { return - 1 ; } for ( VAR16 = 0 ; VAR16 < sizeof ( VAR21 ) / sizeof ( int ) ; VAR16 ++ ) { FUN4 ( VAR30 , VAR31 , VAR21 [ VAR16 ] ) ; if ( send ( VAR20 , ( void * ) & VAR30 , sizeof ( VAR30 ) , 0 ) < 0 ) { FUN5 ( "" ) ; VAR32 } VAR12 = 0 ; VAR11 = VAR9 ; while ( 1 ) { if ( ( sizeof ( VAR9 ) - VAR12 ) == 0 ) { FUN5 ( "" ) ; VAR32 } VAR3 = recv ( VAR20 , VAR11 , sizeof ( VAR9 ) - VAR12 , 0 ) ; FUN6 ( "" , VAR3 ) ; VAR5 = ( VAR4 * ) VAR11 ; if ( VAR5 -> VAR33 == VAR34 ) { FUN6 ( "" ) ; break ; } if ( VAR5 -> VAR33 == VAR35 ) { FUN5 ( "" ) ; break ; } VAR11 += VAR3 ; VAR12 += VAR3 ; } VAR5 = ( VAR4 * ) VAR9 ; for ( ; FUN7 ( VAR5 , VAR12 ) ; VAR5 = FUN8 ( VAR5 , VAR12 ) ) { VAR7 = FUN9 ( VAR5 ) ; if ( VAR5 -> VAR36 < FUN10 ( sizeof ( VAR7 ) ) ) { continue ; } VAR14 = ( VAR13 * ) FUN11 ( VAR7 ) ; VAR8 = FUN12 ( VAR5 ) ; VAR15 = VAR7 -> VAR37 ; if ( VAR15 >= VAR28 ) { FUN5 ( "" , VAR15 ) ; VAR32 } VAR18 = ( VAR17 * ) FUN2 ( sizeof ( VAR17 ) ) ; if ( VAR18 == 0 ) { VAR29 ; VAR32 } VAR18 -> VAR38 = 0 ; VAR18 -> VAR39 = VAR21 [ VAR16 ] ; VAR18 -> VAR40 = VAR7 -> VAR40 ; VAR25 = 0 ; VAR23 [ 0 ] = '' ; for ( ; FUN13 ( VAR14 , VAR8 ) ; VAR14 = FUN14 ( VAR14 , VAR8 ) ) { switch ( VAR14 -> VAR41 ) { case VAR42 : if ( ( * ( int * ) FUN15 ( VAR14 ) ) == FUN16 ( 0xfe80 ) ) { FUN6 ( "" ) ; VAR25 = 1 ; break ; } FUN17 ( VAR21 [ VAR16 ] , FUN15 ( VAR14 ) , VAR18 -> VAR43 , VAR24 ) ; FUN6 ( "" , VAR18 -> VAR43 ) ; break ; case VAR44 : if ( ( * ( int * ) FUN15 ( VAR14 ) ) == FUN16 ( 0xfe80 ) ) { FUN6 ( "" ) ; VAR25 = 1 ; } FUN17 ( VAR21 [ VAR16 ] , FUN15 ( VAR14 ) , VAR18 -> VAR43 , VAR24 ) ; FUN6 ( "" , VAR18 -> VAR43 ) ; break ; case VAR45 : FUN6 ( "" , ( char * ) FUN15 ( VAR14 ) ) ; strncpy ( VAR23 , ( char * ) FUN15 ( VAR14 ) , VAR24 - 1 ) ; VAR23 [ VAR24 - 1 ] = '' ; break ; case VAR46 : case VAR47 : case VAR48 : case VAR49 : default : break ; } } if ( VAR25 ) { if ( VAR50 == 0 ) { FUN18 ( VAR18 ) ; continue ; } } if ( strlen ( VAR26 [ VAR15 ] . VAR23 ) == 0 && strlen ( VAR23 ) > 0 ) { memcpy ( VAR26 [ VAR15 ] . VAR23 , VAR23 , VAR24 - 1 ) ; VAR26 [ VAR15 ] . VAR23 [ VAR24 - 1 ] = '' ; } VAR26 [ VAR15 ] . VAR15 = VAR15 ; if ( VAR26 [ VAR15 ] . VAR51 == 0 ) { VAR26 [ VAR15 ] . VAR51 = VAR18 ; } else { for ( VAR19 = VAR26 [ VAR15 ] . VAR51 ; VAR19 -> VAR38 ; VAR19 = VAR19 -> VAR38 ) { } VAR19 -> VAR38 = VAR18 ; } } } if ( VAR20 > 0 ) { close ( VAR20 ) ; } for ( VAR16 = 0 ; VAR16 < sizeof ( VAR21 ) / sizeof ( int ) ; VAR16 ++ ) { FUN19 ( VAR21 [ VAR16 ] ) ; } return 0 ; error if ( VAR20 >= 0 ) { close ( VAR20 ) ; } return - 1 ; }