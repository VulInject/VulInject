int set_effective_priv ( priv_op_t op , int num_priv , ... ) { priv_set_t * priv_set ; priv_t priv_id ; va_list ap ; int status ; priv_set = priv_allocset ( ) ; PRIV_EMPTY ( priv_set , NULL ) ; va_start ( ap , num_priv ) ; while ( num_priv -- ) { char * priv_name ; priv_id = va_arg ( ap , priv_t ) ; priv_name = ( char * ) priv_getbynum ( ( int ) ( uintptr_t ) priv_id ) ; if ( priv_name == NULL ) { errno = EINVAL ; priv_freeset ( priv_set ) ; return ( - 1 ) ; } ( void ) priv_addset ( priv_set , priv_name ) ; } va_end ( ap ) ; status = setppriv ( op , PRIV_EFFECTIVE , priv_set ) ; priv_freeset ( priv_set ) ; return ( status ) ; } 