static void wg_dissect_decrypted_timestamp ( tvbuff_t * tvb , packet_info * pinfo , proto_tree * tree , wg_handshake_state_t * hs ) { guint64 tai64_label ; guint32 nanoseconds ; nstime_t nstime ; proto_item * ti ; tvbuff_t * new_tvb ; new_tvb = tvb_new_child_real_data ( tvb , hs -> timestamp , sizeof ( hs -> timestamp ) , sizeof ( hs -> timestamp ) ) ; add_new_data_source ( pinfo , new_tvb , "Decrypted Timestamp" ) ; tai64_label = tvb_get_guint64 ( new_tvb , 0 , ENC_BIG_ENDIAN ) ; nanoseconds = tvb_get_guint32 ( new_tvb , 8 , ENC_BIG_ENDIAN ) ; if ( tai64n_to_unix ( tai64_label , nanoseconds , & nstime ) ) { ti = proto_tree_add_time ( tree , hf_wg_timestamp_value , new_tvb , 0 , 12 , & nstime ) ; tree = proto_item_add_subtree ( ti , ett_timestamp ) ; } proto_tree_add_item ( tree , hf_wg_timestamp_tai64_label , new_tvb , 0 , 8 , ENC_BIG_ENDIAN ) ; proto_tree_add_item ( tree , hf_wg_timestamp_nanoseconds , new_tvb , 8 , 4 , ENC_BIG_ENDIAN ) ; } 