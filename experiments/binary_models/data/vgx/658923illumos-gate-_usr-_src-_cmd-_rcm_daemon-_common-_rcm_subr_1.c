int rsrc_node_find ( char * rsrcname , int flag , rsrc_node_t * * nodep ) { char * pathname , * nodename , * lasts ; rsrc_node_t * node ; int type ; rcm_log_message ( RCM_TRACE4 , "rn_node_find(%s, 0x%x)\n" , rsrcname , flag ) ; pathname = resolve_name ( rsrcname ) ; if ( pathname == NULL ) { return ( EINVAL ) ; } type = rsrc_get_type ( pathname ) ; switch ( type ) { case RSRC_TYPE_DEVICE : case RSRC_TYPE_NORMAL : node = rn_find_child ( rsrc_root , "SYSTEM" , RSRC_NODE_CREATE , RSRC_TYPE_NORMAL ) ; break ; case RSRC_TYPE_ABSTRACT : node = rn_find_child ( rsrc_root , "ABSTRACT" , RSRC_NODE_CREATE , RSRC_TYPE_NORMAL ) ; break ; default : return ( EINVAL ) ; } pn_preprocess ( pathname , type ) ; lasts = pathname ; while ( ( nodename = pn_getnextcomp ( lasts , & lasts ) ) != NULL ) { rsrc_node_t * parent = node ; node = rn_find_child ( parent , nodename , flag , type ) ; if ( node == NULL ) { assert ( ( flag & RSRC_NODE_CREATE ) == 0 ) ; free ( pathname ) ; * nodep = NULL ; return ( RCM_SUCCESS ) ; } } free ( pathname ) ; * nodep = node ; return ( RCM_SUCCESS ) ; } 