struct fwnode_handle * __irq_domain_alloc_fwnode ( unsigned int type , int id , const char * name , phys_addr_t * pa ) { struct irqchip_fwid * fwid ; char * n ; fwid = kzalloc ( sizeof ( * fwid ) , GFP_KERNEL ) ; switch ( type ) { case IRQCHIP_FWNODE_NAMED : n = kasprintf ( GFP_KERNEL , "%s" , name ) ; break ; case IRQCHIP_FWNODE_NAMED_ID : n = kasprintf ( GFP_KERNEL , "%s-%d" , name , id ) ; break ; default : n = kasprintf ( GFP_KERNEL , "irqchip@%pa" , pa ) ; break ; } if ( ! fwid || ! n ) { kfree ( n ) ; return NULL ; } fwid -> type = type ; fwid -> name = n ; fwid -> pa = pa ; fwnode_init ( & fwid -> fwnode , & irqchip_fwnode_ops ) ; return & fwid -> fwnode ; } 