void md5_append ( md5_state_t * pms , const md5_byte_t * data , int nbytes ) { const md5_byte_t * p = data ; int left = nbytes ; int offset = ( pms -> count [ 0 ] >> 3 ) & 63 ; md5_word_t nbits = ( md5_word_t ) ( nbytes << 3 ) ; pms -> count [ 1 ] += nbytes >> 29 ; pms -> count [ 0 ] += nbits ; if ( pms -> count [ 0 ] < nbits ) { pms -> count [ 1 ] ++ ; } if ( offset ) { int copy = ( offset + nbytes > 64 ?64 - offset : nbytes ) ; memcpy ( pms -> buf + offset , p , copy ) ; if ( offset + copy < 64 ) { return ; } p += copy ; left -= copy ; md5_process ( pms , pms -> buf ) ; } for ( ; left >= 64 ; p += 64 , left -= 64 ) { md5_process ( pms , p ) ; } if ( left ) { memcpy ( pms -> buf , p , left ) ; } } 