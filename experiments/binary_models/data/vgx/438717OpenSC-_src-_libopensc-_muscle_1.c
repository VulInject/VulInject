int FUN1 ( VAR1 * VAR2 , int VAR3 , VAR4 * VAR5 ) { unsigned short VAR6 = 0xFFFF , VAR7 = 0x0002 , VAR8 = 0x0002 , VAR9 = VAR5 -> VAR9 ; int VAR10 = 0 ; VAR11 * VAR12 , * VAR13 ; u8 VAR14 [ 6 ] ; sc_apdu_t VAR15 ; int VAR16 ; if ( VAR5 -> VAR17 != 0x02 && VAR5 -> VAR17 != 0x03 ) { FUN2 ( VAR2 -> VAR18 , VAR19 ) ; } if ( VAR5 -> VAR17 == 0x02 ) { if ( ( VAR5 -> VAR20 == 0 || ! VAR5 -> VAR21 ) || ( VAR5 -> VAR22 == 0 || ! VAR5 -> VAR23 ) ) { FUN3 ( VAR2 -> VAR18 , VAR24 , VAR19 ) ; } } if ( VAR5 -> VAR17 == 0x03 ) { if ( ( VAR5 -> VAR20 == 0 || ! VAR5 -> VAR21 ) || ( VAR5 -> VAR25 == 0 || ! VAR5 -> VAR26 ) || ( VAR5 -> VAR27 == 0 || ! VAR5 -> VAR28 ) || ( VAR5 -> VAR29 == 0 || ! VAR5 -> VAR30 ) || ( VAR5 -> VAR31 == 0 || ! VAR5 -> VAR32 ) ) { FUN3 ( VAR2 -> VAR18 , VAR24 , VAR19 ) ; } } else { FUN3 ( VAR2 -> VAR18 , VAR24 , VAR19 ) ; } if ( VAR5 -> VAR17 == 0x02 ) { VAR10 = 4 + 4 + VAR5 -> VAR20 + VAR5 -> VAR22 ; } if ( VAR5 -> VAR17 == 0x03 ) { VAR10 = 4 + 10 + VAR5 -> VAR20 + VAR5 -> VAR25 + VAR5 -> VAR27 + VAR5 -> VAR29 + VAR5 -> VAR31 ; } VAR12 = malloc ( VAR10 ) ; if ( ! VAR12 ) { FUN2 ( VAR2 -> VAR18 , VAR33 ) ; } VAR13 = VAR12 ; * VAR13 = 0x00 ; VAR13 ++ ; * VAR13 = VAR5 -> VAR17 ; VAR13 ++ ; FUN4 ( VAR13 , VAR9 ) ; VAR13 += 2 ; if ( VAR5 -> VAR17 == 0x02 ) { FUN5 ( VAR34 ) ; FUN5 ( VAR13 ) ; } if ( VAR5 -> VAR17 == 0x03 ) { FUN5 ( VAR13 ) ; FUN5 ( VAR35 ) ; FUN5 ( VAR36 ) ; FUN5 ( VAR37 ) ; FUN5 ( VAR38 ) ; } VAR16 = FUN6 ( VAR2 , VAR39 , VAR10 , 0x02 , 0x02 , 0x02 ) ; if ( VAR16 < 0 ) { if ( VAR16 == VAR40 ) { VAR16 = FUN7 ( VAR2 , VAR39 , 0 ) ; if ( VAR16 < 0 ) { FUN3 ( VAR2 -> VAR18 , VAR24 , VAR16 ) ; } VAR16 = FUN6 ( VAR2 , VAR39 , VAR10 , 0x02 , 0x02 , 0x02 ) ; if ( VAR16 < 0 ) { free ( VAR12 ) ; FUN3 ( VAR2 -> VAR18 , VAR24 , VAR16 ) ; } } } VAR16 = FUN8 ( VAR2 , VAR39 , 0 , VAR12 , VAR10 ) ; free ( VAR12 ) ; if ( VAR16 < 0 ) { return VAR16 ; } FUN9 ( VAR2 , & VAR15 , VAR41 , 0x32 , VAR3 , 0x00 ) ; VAR15 . VAR42 = 6 ; VAR15 . VAR5 = VAR14 ; VAR15 . VAR43 = 6 ; VAR13 = VAR14 ; FUN4 ( VAR13 , VAR6 ) ; VAR13 += 2 ; FUN4 ( VAR13 , VAR7 ) ; VAR13 += 2 ; FUN4 ( VAR13 , VAR8 ) ; VAR16 = FUN10 ( VAR2 , & VAR15 ) ; FUN11 ( VAR2 -> VAR18 , VAR16 , "" ) ; if ( VAR15 . VAR44 == 0x90 && VAR15 . VAR45 == 0x00 ) { FUN7 ( VAR2 , VAR39 , 0 ) ; return 0 ; } VAR16 = FUN12 ( VAR2 , VAR15 . VAR44 , VAR15 . VAR45 ) ; if ( VAR16 ) { if ( VAR2 -> VAR18 -> VAR46 >= 2 ) { FUN13 ( VAR2 -> VAR18 , "" , VAR15 . VAR44 , VAR15 . VAR45 ) ; } FUN7 ( VAR2 , VAR39 , 0 ) ; FUN2 ( VAR2 -> VAR18 , VAR16 ) ; } FUN7 ( VAR2 , VAR39 , 0 ) ; FUN2 ( VAR2 -> VAR18 , VAR47 ) ; }