static GF_Err dvblin_process ( GF_Filter * filter ) { GF_FilterPacket * dst_pck ; u8 * out_data ; GF_DVBLinuxCtx * ctx = ( GF_DVBLinuxCtx * ) gf_filter_get_udta ( filter ) ; u32 nb_read = read ( ctx -> demux_fd , ctx -> block , ctx -> block_size ) ; if ( ! nb_read ) { return GF_OK ; } dst_pck = gf_filter_pck_new_alloc ( ctx -> pid , nb_read , & out_data ) ; if ( ! dst_pck ) { return GF_OUT_OF_MEM ; } memcpy ( out_data , ctx -> block , nb_read ) ; gf_filter_pck_set_framing ( dst_pck , GF_TRUE , GF_TRUE ) ; gf_filter_pck_send ( dst_pck ) ; return GF_OK ; } 