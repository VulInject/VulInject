VAR1 FUN1(VAR2 *VAR3, ESYS_TR VAR4, const char *VAR5, size_t VAR6, VAR7 *VAR8) {

VAR9 *VAR10 = NULL;
VAR11 *public = NULL;
VAR12 *VAR13 = NULL;
VAR7 *VAR14 = NULL;

if (!VAR5 || !VAR8) {
return VAR15;
}


if (strlen(VAR5) != VAR6) {
FUN2("");
return VAR15;
}

if (VAR6 > VAR16 || VAR6 <= 0) {
FUN2("");
return VAR15;
}

tool_rc VAR17 = FUN3(VAR3, VAR18, &VAR10,
NULL, VAR19);
if (VAR17 != VAR20) {
FUN2("");
goto VAR21;
}

VAR17 = FUN4(VAR3, VAR4, &public, NULL, NULL);
if (VAR17 != VAR20) {
FUN2("");
goto VAR21;
}

UINT16 VAR22 = VAR10->VAR23/8;
if (public->VAR24.VAR25 != VAR26 ||
public->VAR24.VAR10.VAR27.VAR28 != VAR18 ||
public->VAR24.VAR29.VAR30.VAR31.VAR32 != VAR22 ||
public->VAR24.VAR29.VAR30.VAR33.VAR32 != VAR22) {
FUN2("");
VAR17 = VAR15;
goto VAR21;
}

BYTE VAR34[2];
VAR34[0] = ((VAR6 * 8) >> 8) % 256;
VAR34[1] = (VAR6 * 8) % 256;

UINT16 VAR35 = sizeof(VAR34) + VAR6 + 6 * VAR22;

VAR13 = (VAR12 *) calloc(1, sizeof(VAR12) + VAR35);
if (VAR13 == NULL) {
FUN2("");
VAR17 = VAR15;
goto VAR21;
}

VAR13->VAR32 = VAR35;

UINT16 VAR36 = 0;
memcpy(VAR13->VAR37 + VAR36, VAR34, sizeof(VAR34));
VAR36 += sizeof(VAR34);
memcpy(VAR13->VAR37 + VAR36, VAR5, VAR6);
VAR36 += VAR6;
memcpy(VAR13->VAR37 + VAR36, VAR10->VAR38.VAR37, VAR22);
VAR36 += VAR22;
memcpy(VAR13->VAR37 + VAR36, VAR10->VAR39.VAR37, VAR22);
VAR36 += VAR22;
memcpy(VAR13->VAR37 + VAR36, VAR10->VAR40.VAR37, VAR22);
VAR36 += VAR22;
memcpy(VAR13->VAR37 + VAR36, VAR10->VAR41.VAR37, VAR22);
VAR36 += VAR22;
memcpy(VAR13->VAR37 + VAR36, public->VAR24.VAR29.VAR30.VAR31.VAR37, VAR22);
VAR36 += VAR22;
memcpy(VAR13->VAR37 + VAR36, public->VAR24.VAR29.VAR30.VAR33.VAR37, VAR22);

VAR17 = FUN5(VAR3, VAR42, VAR43,
VAR13->VAR37, VAR13->VAR32, &VAR14, NULL);
if (VAR17 != VAR20) {
goto VAR21;
}

*VAR8 = *VAR14;

VAR21:
free(VAR13);
FUN6(public);
FUN6(VAR14);
FUN6(VAR10);
return VAR17;
}