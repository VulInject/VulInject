static void SV_SendClientGameState ( client_t * client ) { int start ; entityState_t * base , nullstate ; msg_t msg ; byte msgBuffer [ MAX_MSGLEN ] ; Com_DPrintf ( "SV_SendClientGameState() for %s\n" , client -> name ) ; Com_DPrintf ( "Going from CS_CONNECTED to CS_PRIMED for %s\n" , client -> name ) ; client -> state = CS_PRIMED ; client -> pureAuthentic = 0 ; client -> gamestateMessageNum = client -> netchan . outgoingSequence ; MSG_Init ( & msg , msgBuffer , sizeof ( msgBuffer ) ) ; MSG_WriteLong ( & msg , client -> lastClientCommand ) ; SV_UpdateServerCommandsToClient ( client , & msg ) ; MSG_WriteByte ( & msg , svc_gamestate ) ; MSG_WriteLong ( & msg , client -> reliableSequence ) ; for ( start = 0 ; start < MAX_CONFIGSTRINGS ; start ++ ) { if ( sv . configstrings [ start ] [ 0 ] ) { MSG_WriteByte ( & msg , svc_configstring ) ; MSG_WriteShort ( & msg , start ) ; MSG_WriteBigString ( & msg , sv . configstrings [ start ] ) ; } } Com_Memset ( & nullstate , 0 , sizeof ( nullstate ) ) ; for ( start = 0 ; start < MAX_GENTITIES ; start ++ ) { base = & sv . svEntities [ start ] . baseline ; MSG_WriteByte ( & msg , svc_baseline ) ; MSG_WriteDeltaEntity ( & msg , & nullstate , base , qtrue ) ; } MSG_WriteByte ( & msg , svc_EOF ) ; MSG_WriteLong ( & msg , client - svs . clients ) ; MSG_WriteLong ( & msg , sv . checksumFeed ) ; SV_SendMessageToClient ( & msg , client ) ; } 