static int asn1_d2i_primitive ( ASN1_VALUE * * pval , CBS * cbs , const ASN1_ITEM * it , int tag_number , int tag_class , int optional ) { CBS cbs_object ; int constructed , indefinite ; int utype = it -> utype ; size_t length ; int ret ; CBS_init ( & cbs_object , CBS_data ( cbs ) , CBS_len ( cbs ) ) ; if ( it -> itype == ASN1_ITYPE_MSTRING ) { return 0 ; } if ( it -> utype == V_ASN1_ANY ) { return asn1_d2i_any ( pval , cbs , it , tag_number , tag_class , optional ) ; } if ( tag_number == - 1 ) { tag_number = it -> utype ; tag_class = V_ASN1_UNIVERSAL ; } ret = asn1_check_tag ( & cbs_object , & length , NULL , NULL , & indefinite , & constructed , tag_number , tag_class , optional ) ; if ( ret == - 1 ) { return - 1 ; } if ( ret != 1 ) { ASN1error ( ERR_R_NESTED_ASN1_ERROR , NULL ) ; return 0 ; } return asn1_d2i_primitive_content ( pval , cbs , & cbs_object , utype , constructed , indefinite , length , it ) ; } 