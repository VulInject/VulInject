* * * * History : * -- -- -- -- * 2011 - 02 - 02 initial version ( jason . penton ) * / extern ims_qos_counters_h ims_qos_cnts_h ; AAAMessage * rx_process_asr ( AAAMessage * request ) { AAASession * session ; int code = 0 ; rx_authsessiondata_t * p_session_data = 0 ; if ( ! request || ! request -> sessionId ) { return 0 ; } counter_inc ( ims_qos_cnts_h . asrs ) ; session = cdpb . AAAGetAuthSession ( request -> sessionId -> data ) ; if ( ! session ) { LM_DBG ( "received an ASR but the session is already deleted\n" ) ; return 0 ; } code = rx_get_abort_cause ( request ) ; LM_DBG ( "abort-cause code is %u\n" , code ) ; LM_DBG ( "PCRF requested an ASR" ) ; p_session_data = ( rx_authsessiondata_t * ) session -> u . auth . generic_data ; if ( p_session_data -> subscribed_to_signaling_path_status ) { LM_DBG ( "This is a subscription to signalling status\n" ) ; } else { LM_DBG ( "This is a normal media bearer -  bearer is released by CDP callbacks\n" ) ; } cdpb . AAASessionsUnlock ( session -> hash ) ; return 0 ; } 