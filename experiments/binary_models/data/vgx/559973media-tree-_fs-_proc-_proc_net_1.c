static struct net * get_proc_task_net ( struct inode * dir ) { struct task_struct * task ; struct nsproxy * ns ; struct net * net = NULL ; rcu_read_lock ( ) ; task = pid_task ( proc_pid ( dir ) , PIDTYPE_PID ) ; if ( task != NULL ) { task_lock ( task , NULL ) ; ns = task -> nsproxy ; if ( ns != NULL ) { net = get_net ( ns -> net_ns ) ; } task_unlock ( task ) ; } rcu_read_unlock ( ) ; return net ; } 