static int __init dell_wmi_init ( void ) { int err ; acpi_status status ; if ( ! wmi_has_guid ( DELL_EVENT_GUID ) || ! wmi_has_guid ( DELL_DESCRIPTOR_GUID ) ) { pr_warn ( "Dell WMI GUID were not found\n" ) ; return - ENODEV ; } err = dell_wmi_check_descriptor_buffer ( ) ; err = dell_wmi_input_setup ( ) ; if ( err ) { return err ; } status = wmi_install_notify_handler ( DELL_EVENT_GUID , dell_wmi_notify , NULL ) ; if ( ACPI_FAILURE ( status ) ) { input_unregister_device ( dell_wmi_input_dev ) ; pr_err ( "Unable to register notify handler - %d\n" , status ) ; return - ENODEV ; } dmi_check_system ( dell_wmi_smbios_list ) ; if ( wmi_requires_smbios_request ) { err = dell_wmi_events_set_enabled ( true ) ; if ( err ) { pr_err ( "Failed to enable WMI events\n" ) ; wmi_remove_notify_handler ( DELL_EVENT_GUID ) ; input_unregister_device ( dell_wmi_input_dev ) ; return err ; } } return 0 ; } 