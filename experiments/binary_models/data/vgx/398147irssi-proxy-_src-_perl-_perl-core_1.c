char * perl_script_get_path ( const char * name ) { struct stat statbuf ; char * file , * path ; if ( g_path_is_absolute ( name ) || ( name [ 0 ] == '~' && name [ 1 ] == '/' ) ) { return convert_home ( name ) ; } file = IS_PERL_SCRIPT ( name ) ?g_strdup ( name ) : g_strdup_printf ( "%s.pl" , name ) ; path = g_strdup_printf ( "%s/scripts/%s" , get_irssi_dir ( ) , file ) ; if ( stat ( path , & statbuf ) != 0 ) { path = g_strdup_printf ( SCRIPTDIR "/%s" , file ) ; if ( stat ( path , & statbuf ) != 0 ) { g_free ( path ) ; path = NULL ; } } g_free ( file ) ; return path ; } 