static int run_executable ( ArgData * args , gchar * * argv ) { int retcode = 0 ; gboolean ret ; GError * error = NULL ; gchar * binary , * tmp ; binary = g_find_program_in_path ( argv [ 0 ] ) ; make_absolute ( & binary ) ; if ( ! binary ) { fprintf ( stderr , "failed to find %s\n" , argv [ 0 ] ) ; return 1 ; } tmp = argv [ 0 ] ; argv [ 0 ] = binary ; binary = tmp ; tmp = g_strjoinv ( " " , argv ) ; fprintf ( stderr , "Running: %s\n" , tmp ) ; fflush ( stderr ) ; ret = g_spawn_sync ( args -> workdir , argv , NULL , G_SPAWN_DEFAULT , NULL , NULL , NULL , NULL , & retcode , & error ) ; g_free ( argv [ 0 ] ) ; argv [ 0 ] = binary ; if ( ! ret ) { fprintf ( stderr , "execution failed: %d: %s\n" , retcode , error ?error -> message : "unknown error" ) ; g_error_free ( error ) ; retcode = 1 ; } else { if ( WIFEXITED ( retcode ) ) { retcode = WEXITSTATUS ( retcode ) ; } else { fprintf ( stderr , "unknown waitpid status %d\n" , retcode ) ; retcode = 1 ; } } return retcode ; } 