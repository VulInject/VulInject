DEFINE_HASH_OPS ( in_addr_prefix_hash_ops , in_addr_prefix , in_addr_prefix_hash_func , in_addr_prefix_compare_func ) ; DEFINE_HASH_OPS_WITH_KEY_DESTRUCTOR ( in_addr_prefix_hash_ops_free , in_addr_prefix , in_addr_prefix_hash_func , in_addr_prefix_compare_func , free ) ; int in_addr_prefix_add ( Set * * prefixes , const struct in_addr_prefix * prefix ) { struct in_addr_prefix * copy ; assert ( prefixes ) ; assert ( prefix ) ; assert ( IN_SET ( prefix -> family , AF_INET , AF_INET6 ) ) ; copy = newdup ( in_addr_prefix , prefix , 1 ) ; ( void ) in_addr_mask ( copy -> family , & copy -> address , copy -> prefixlen ) ; return set_ensure_consume ( prefixes , & in_addr_prefix_hash_ops_free , copy ) ; } 