static struct sock * inet_lhash2_lookup ( struct net * net , struct inet_listen_hashbucket * ilb2 , struct sk_buff * skb , int doff , const __be32 saddr , __be16 sport , const __be32 daddr , const unsigned short hnum , const int dif , const int sdif ) { struct sock * sk , * result = NULL ; struct hlist_nulls_node * node ; int score , hiscore ; sk_nulls_for_each_rcu ( , , ) { score = compute_score ( sk , net , hnum , daddr , dif , sdif ) ; if ( score > hiscore ) { result = lookup_reuseport ( net , sk , skb , doff , saddr , sport , daddr , hnum ) ; if ( result ) { return result ; } result = sk ; hiscore = score ; } } return result ; } 