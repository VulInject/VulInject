static int qcom_cpufreq_kryo_name_version ( struct device * cpu_dev , struct nvmem_cell * speedbin_nvmem , char * * pvs_name , struct qcom_cpufreq_drv * drv ) { size_t len ; u8 * speedbin ; enum _msm8996_version msm8996_version ; * pvs_name = NULL ; msm8996_version = qcom_cpufreq_get_msm_id ( ) ; if ( NUM_OF_MSM8996_VERSIONS == msm8996_version ) { dev_err ( cpu_dev , "Not Snapdragon 820/821!" ) ; return - ENODEV ; } speedbin = nvmem_cell_read ( speedbin_nvmem , & len ) ; switch ( msm8996_version ) { case MSM8996_V3 : drv -> versions = 1 << ( unsigned int ) ( * speedbin ) ; break ; case MSM8996_SG : drv -> versions = 1 << ( ( unsigned int ) ( * speedbin ) + 4 ) ; break ; default : BUG ( ) ; break ; } kfree ( speedbin ) ; return 0 ; } 