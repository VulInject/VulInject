static int hostname_validator ( int index , char * value ) { char sbytes [ INET6_ADDRSTRLEN ] ; boolean_t new_label = B_TRUE ; char * p ; char label_terminator ; int len ; if ( value == NULL ) { return ( SA_OK ) ; } if ( ( len = strlen ( value ) ) == 0 ) { return ( SA_OK ) ; } if ( inet_pton ( AF_INET , value , ( void * ) sbytes ) == 1 ) { return ( SA_OK ) ; } if ( inet_pton ( AF_INET6 , value , ( void * ) sbytes ) == 1 ) { return ( SA_OK ) ; } if ( strspn ( value , "0123456789." ) == len ) { return ( SA_BAD_VALUE ) ; } label_terminator = * value ; for ( p = value ; * p != '\0' ; ++ p ) { if ( new_label ) { if ( ! isalnum ( * p ) ) { return ( SA_BAD_VALUE ) ; } new_label = B_FALSE ; label_terminator = * p ; continue ; } if ( * p == '.' ) { if ( ! isalnum ( label_terminator ) ) { return ( SA_BAD_VALUE ) ; } new_label = B_TRUE ; label_terminator = * p ; continue ; } label_terminator = * p ; if ( isalnum ( * p ) || * p == '-' || * p == '_' ) { continue ; } return ( SA_BAD_VALUE ) ; } if ( ! isalnum ( label_terminator ) ) { return ( SA_BAD_VALUE ) ; } return ( SA_OK ) ; } 