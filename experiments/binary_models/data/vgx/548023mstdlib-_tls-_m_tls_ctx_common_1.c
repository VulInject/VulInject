M_bool M_tls_ctx_set_protocols ( SSL_CTX * ctx , int protocols ) { unsigned long options = 0 ; cfs_time_t disabled = 0 ; M_tls_protocols_t proto_min = 0 ; M_tls_protocols_t proto_max = 0 ; if ( ctx == NULL ) { return M_FALSE ; } if ( protocols == M_TLS_PROTOCOL_INVALID ) { return M_FALSE ; } if ( protocols == 0 ) { protocols = M_TLS_PROTOCOL_DEFAULT ; } ( void ) options ; ( void ) disabled ; if ( ! M_tls_protocols_to_openssl ( protocols , & proto_min , & proto_max ) ) { return M_FALSE ; } SSL_CTX_set_min_proto_version ( ctx , proto_min ) ; SSL_CTX_set_max_proto_version ( ctx , proto_max ) ; ( void ) proto_min ; ( void ) proto_max ; if ( ! M_tls_protocols_to_openssl ( protocols , & disabled ) ) { return M_FALSE ; } options |= disabled ; SSL_CTX_set_options ( ctx , ( long ) options ) ; SSL_CTX_set_options ( ctx , options ) ; return M_TRUE ; } 