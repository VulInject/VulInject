static int gl520_probe ( struct i2c_client * client , const struct i2c_device_id * id ) { struct device * dev = & client -> dev ; struct device * hwmon_dev ; struct gl520_data * data ; data = devm_kzalloc ( dev , sizeof ( gl520_data ) , GFP_KERNEL ) ; i2c_set_clientdata ( client , data ) ; mutex_init ( & data -> update_lock ) ; data -> client = client ; gl520_init_client ( client ) ; data -> groups [ 0 ] = & gl520_group ; if ( data -> two_temps ) { data -> groups [ 1 ] = & gl520_group_temp2 ; } else { data -> groups [ 1 ] = & gl520_group_in4 ; } hwmon_dev = devm_hwmon_device_register_with_groups ( dev , client -> name , data , data -> groups ) ; return PTR_ERR_OR_ZERO ( hwmon_dev ) ; } 