static int serval_initialize ( struct serval_private * priv ) { int ret , i ; ret = serval_switch_init ( priv ) ; mscc_flush ( priv -> regs [ QS ] , serval_regs_qs ) ; writel ( SYS_FRM_AGING_ENA | ( 20000000 / 65 ) , priv -> regs [ SYS ] + SYS_FRM_AGING ) ; for ( i = 0 ; i < MAX_PORT ; i ++ ) { serval_port_init ( priv , i ) ; } serval_cpu_capture_setup ( priv ) ; debug ( "Ports enabled\n" ) ; return 0 ; } 