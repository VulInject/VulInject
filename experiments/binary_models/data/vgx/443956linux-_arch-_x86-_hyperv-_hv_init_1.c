static void hv_resume ( void ) { union hv_x64_msr_hypercall_contents hypercall_msr ; int ret ; ret = hv_cpu_init ( 0 ) ; WARN_ON ( ret , NULL ) ; rdmsrl ( HV_X64_MSR_HYPERCALL , hypercall_msr . as_uint64 ) ; hypercall_msr . enable = 1 ; hypercall_msr . guest_physical_address = vmalloc_to_pfn ( hv_hypercall_pg_saved ) ; wrmsrl ( HV_X64_MSR_HYPERCALL , hypercall_msr . as_uint64 ) ; hv_hypercall_pg = hv_hypercall_pg_saved ; hv_hypercall_pg_saved = NULL ; if ( hv_reenlightenment_cb ) { set_hv_tscchange_cb ( hv_reenlightenment_cb ) ; } } 