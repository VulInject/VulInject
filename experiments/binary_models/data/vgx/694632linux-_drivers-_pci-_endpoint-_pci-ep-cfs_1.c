struct config_group * pci_ep_cfs_add_epc_group ( const char * name ) { int ret ; struct pci_epc * epc ; struct config_group * group ; struct pci_epc_group * epc_group ; epc_group = kzalloc ( sizeof ( * epc_group ) , GFP_KERNEL ) ; if ( ! epc_group ) { ret = - ENOMEM ; err } group = & epc_group -> group ; config_group_init_type_name ( group , name , & pci_epc_type ) ; ret = configfs_register_group ( controllers_group , group ) ; if ( ret ) { pr_err ( "failed to register configfs group for %s\n" , name ) ; err_register_group } epc = pci_epc_get ( name ) ; if ( IS_ERR ( epc ) ) { ret = PTR_ERR ( epc ) ; err_epc_get } epc_group -> epc = epc ; return group ; err_epc_get configfs_unregister_group ( group ) ; err_register_group err return ERR_PTR ( ret ) ; } 