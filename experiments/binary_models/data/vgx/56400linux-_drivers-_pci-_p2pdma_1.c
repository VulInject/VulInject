static bool __host_bridge_whitelist ( struct pci_host_bridge * host , bool same_host_bridge , bool warn ) { struct pci_dev * root = pci_host_bridge_dev ( host ) ; const struct pci_p2pdma_whitelist_entry * entry ; unsigned short vendor , device ; vendor = root -> vendor ; device = root -> device ; for ( entry = pci_p2pdma_whitelist ; entry -> vendor ; entry ++ ) { if ( vendor != entry -> vendor || device != entry -> device ) { continue ; } if ( entry -> flags & REQ_SAME_HOST_BRIDGE && ! same_host_bridge ) { return false ; } return true ; } if ( warn ) { pci_warn ( root , "Host bridge not in P2PDMA whitelist: %04x:%04x\n" , vendor , device ) ; } return false ; } 