void read_persistent_clock ( struct timespec * ts ) { unsigned int year , mon , day , hour , min , sec ; extern void arch_gettod ( int * year , int * mon , int * day , int * hour , int * min , int * sec ) ; year = 1980 ; mon = day = 1 ; hour = min = sec = 0 ; arch_gettod ( & year , & mon , & day , & hour , & min , & sec ) ; if ( ( year += 1900 ) < 1970 ) { year += 100 ; } ts -> tv_sec = mktime ( year , mon , day , hour , min , sec ) ; } 