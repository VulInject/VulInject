static struct msm_dsi * dsi_init ( struct platform_device * pdev ) { struct msm_dsi * msm_dsi ; int ret ; if ( ! pdev ) { return ERR_PTR ( - ENXIO ) ; } msm_dsi = devm_kzalloc ( & pdev -> dev , sizeof ( * msm_dsi ) , GFP_KERNEL ) ; DBG ( "dsi probed=%p" , msm_dsi ) ; msm_dsi -> id = - 1 ; msm_dsi -> pdev = pdev ; platform_set_drvdata ( pdev , msm_dsi ) ; ret = msm_dsi_host_init ( msm_dsi ) ; if ( ret ) { destroy_dsi } ret = dsi_get_phy ( msm_dsi ) ; if ( ret ) { destroy_dsi } ret = msm_dsi_manager_register ( msm_dsi ) ; if ( ret ) { destroy_dsi } return msm_dsi ; destroy_dsi dsi_destroy ( msm_dsi ) ; return ERR_PTR ( ret ) ; } 