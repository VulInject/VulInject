* * Copyright ( c ) 2001 , 2002 Hitoshi Yamamoto * * Some code taken from sh version . * Copyright ( C ) 1999 Niibe Yutaka * Based on linux / arch / i386 / mm / init . c : * Copyright ( C ) 1995 Linus Torvalds * / pgd_t swapper_pg_dir [ 1024 ] ; cfs_time_t mmu_context_cache_dat ; unsigned long mmu_context_cache_dat [ NR_CPUS ] ; void __init paging_init ( void ) void __init mem_init ( void ) void free_initmem ( void ) void free_initrd_mem ( unsigned long , unsigned long ) void __init zone_sizes_init ( void ) { unsigned long zones_size [ MAX_NR_ZONES ] { 0 } ; ; unsigned long start_pfn ; { unsigned long low ; unsigned long max_dma ; start_pfn = START_PFN ( 0 ) ; max_dma = virt_to_phys ( ( char * ) MAX_DMA_ADDRESS ) >> PAGE_SHIFT ; low = MAX_LOW_PFN ( 0 ) ; if ( low < max_dma ) { zones_size [ ZONE_DMA ] = low - start_pfn ; zones_size [ ZONE_NORMAL ] = 0 ; } else { zones_size [ ZONE_DMA ] = low - start_pfn ; zones_size [ ZONE_NORMAL ] = low - max_dma ; } } zones_size [ ZONE_DMA ] = 0 >> PAGE_SHIFT ; zones_size [ ZONE_NORMAL ] = __MEMORY_SIZE >> PAGE_SHIFT ; start_pfn = __MEMORY_START >> PAGE_SHIFT ; free_area_init_node ( 0 , zones_size , start_pfn , 0 ) ; } 