void mobile_print ( netdissect_options * ndo , const u_char * bp , u_int length ) { const struct mobile_ip * mob ; int vec [ 1 ] ; u_short proto , crc ; u_char osp = 0 ; ndo -> ndo_protocol = "mobile" ; mob = ( const mobile_ip * ) bp ; if ( length < MOBILE_SIZE || ! ND_TTEST_SIZE ( mob ) ) { nd_print_trunc ( ndo ) ; return ; } ND_PRINT ( "mobile: " ) ; proto = GET_BE_U_2 ( mob -> proto ) ; crc = GET_BE_U_2 ( mob -> hcheck ) ; if ( proto & OSRC_PRES ) { osp = 1 ; } if ( osp ) { ND_PRINT ( "[S] " ) ; if ( ndo -> ndo_vflag ) { ND_PRINT ( "%s " , GET_IPADDR_STRING ( mob -> osrc ) ) ; } } else { ND_PRINT ( "[] " ) ; } if ( ndo -> ndo_vflag ) { ND_PRINT ( ">%s " , GET_IPADDR_STRING ( mob -> odst ) ) ; ND_PRINT ( "(oproto=%u)" , proto >> 8 ) ; } vec [ 0 ] . ptr = ( const uint8_t * ) ( const void * ) mob ; vec [ 0 ] . len = osp ?12 : 8 ; if ( in_cksum ( vec , 1 ) != 0 ) { ND_PRINT ( " (bad checksum %u)" , crc ) ; } } 