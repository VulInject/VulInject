void flush_neighbour ( struct neighbour * neigh ) { debugf ( BABEL_DEBUG_COMMON , "Flushing neighbour %s (reach 0x%04x)" , format_address ( neigh -> address ) , neigh -> reach ) ; flush_neighbour_routes ( neigh , NULL ) ; if ( unicast_neighbour == neigh ) { flush_unicast ( 1 ) ; } flush_resends ( neigh ) ; if ( neighs == neigh ) { neighs = neigh -> next ; } else { struct neighbour * previous = neighs ; while ( previous -> next != neigh ) { previous = previous -> next ; } previous -> next = neigh -> next ; } free ( neigh ) ; } 