static int pr_read_secflags ( prnode_t * pnp , uio_t * uiop , cred_t * cr ) { prsecflags_t ret ; int error ; proc_t * p ; ASSERT ( pnp -> pr_type == PR_SECFLAGS ) ; if ( ( error = prlock ( pnp , ZNO ) ) != 0 ) { return ( error ) ; } p = pnp -> pr_common -> prc_proc ; prgetsecflags ( p , & ret ) ; prunlock ( pnp , NULL ) ; return ( pr_uioread ( & ret , sizeof ( ret ) , uiop ) ) ; } 