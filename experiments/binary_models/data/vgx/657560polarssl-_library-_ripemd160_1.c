int mbedtls_ripemd160_update ( mbedtls_ripemd160_context * ctx , const unsigned char * input , size_t ilen ) { int ret = MBEDTLS_ERR_ERROR_CORRUPTION_DETECTED ; size_t fill ; uint32_t left ; if ( ilen == 0 ) { return 0 ; } left = ctx -> total [ 0 ] & 0x3F ; fill = 64 - left ; ctx -> total [ 0 ] += ( uint32_t ) ilen ; ctx -> total [ 0 ] &= 0xFFFFFFFF ; if ( ctx -> total [ 0 ] < ( uint32_t ) ilen ) { ctx -> total [ 1 ] ++ ; } if ( left && ilen >= fill ) { memcpy ( ( void * ) ( ctx -> buffer + left ) , input , fill ) ; input += fill ; ilen -= fill ; left = 0 ; } while ( ilen >= 64 ) { if ( ( ret = mbedtls_internal_ripemd160_process ( ctx , input ) ) != 0 ) { return ret ; } input += 64 ; ilen -= 64 ; } if ( ilen > 0 ) { memcpy ( ( void * ) ( ctx -> buffer + left ) , input , ilen ) ; } return 0 ; } static const unsigned char ripemd160_padding [ 64 ] { 0x80 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 } ; ; 