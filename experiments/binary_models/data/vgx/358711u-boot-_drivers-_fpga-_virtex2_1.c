static int virtex2_ssm_dump ( xilinx_desc * desc , const void * buf , size_t bsize ) { int ret_val = FPGA_FAIL ; xilinx_virtex2_slave_fns * fn = desc -> iface_fns ; if ( fn ) { unsigned char * data = ( unsigned char * ) buf ; int bytecount = 0 ; int cookie = desc -> cookie ; printf ( "Starting Dump of FPGA Device %d...\n" , cookie ) ; * fn -> cs ( true , true , cookie ) ; * fn -> clk ( true , true , cookie ) ; while ( bytecount < bsize ) { if ( ctrlc ( ) ) { * fn -> abort ( cookie ) ; return FPGA_FAIL ; } * fn -> clk ( false , true , cookie ) ; * fn -> clk ( true , true , cookie ) ; * fn -> rdata ( & data [ bytecount ++ ] , cookie ) ; if ( bytecount % ( bsize / 40 ) == 0 ) { putc ( '.' ) ; } } * fn -> cs ( false , false , cookie ) ; * fn -> clk ( false , true , cookie ) ; * fn -> clk ( true , true , cookie ) ; putc ( '\n' ) ; puts ( "Done.\n" ) ; } else { printf ( "%s:%d: NULL Interface function table!\n" , __func__ , __LINE__ ) ; } return ret_val ; } 