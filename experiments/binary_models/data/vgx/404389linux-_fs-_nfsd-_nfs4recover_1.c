int nfsd4_client_tracking_init ( struct net * net ) { int status ; struct path path ; struct nfsd_net * nn = net_generic ( net , nfsd_net_id ) ; if ( nn -> client_tracking_ops ) { do_init } nn -> client_tracking_ops = & nfsd4_cld_tracking_ops ; status = nn -> client_tracking_ops -> init ( net ) ; if ( status != - ETIMEDOUT ) { nn -> client_tracking_ops = & nfsd4_cld_tracking_ops_v0 ; status = nn -> client_tracking_ops -> init ( net ) ; if ( ! status ) { return status ; } } nn -> client_tracking_ops = & nfsd4_umh_tracking_ops ; status = nn -> client_tracking_ops -> init ( net ) ; if ( ! status ) { return status ; } nn -> client_tracking_ops = & nfsd4_legacy_tracking_ops ; status = kern_path ( nfs4_recoverydir ( ) , LOOKUP_FOLLOW , & path ) ; if ( ! status ) { status = d_is_dir ( path . dentry ) ; path_put ( & path ) ; if ( ! status ) { status = - EINVAL ; out } } do_init status = nn -> client_tracking_ops -> init ( net ) ; out if ( status ) { printk ( KERN_WARNING "NFSD: Unable to initialize client " "recovery tracking! (%d)\n" , status ) ; nn -> client_tracking_ops = NULL ; } return status ; } 