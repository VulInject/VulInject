int lock_cntr_init ( ) { int rc = PBSE_NONE ; pthread_mutexattr_t cntr_attr ; pthread_mutexattr_init ( & cntr_attr ) ; pthread_mutexattr_settype ( & cntr_attr , PTHREAD_MUTEX_NORMAL ) ; if ( ( cntr = ( lock_cntr * ) calloc ( 1 , sizeof ( lock_cntr ) ) ) == NULL ) { rc = PBSE_MEM_MALLOC ; } if ( ( cntr -> the_lock = ( pthread_mutex_t * ) calloc ( 1 , sizeof ( pthread_mutex_t ) ) ) == NULL ) { rc = PBSE_MEM_MALLOC ; } else { pthread_mutex_init ( cntr -> the_lock , & cntr_attr ) ; } return rc ; } int lock_cntr_incr ( ) { int rc = PBSE_NONE ; char err_msg [ MSG_LEN_SHORT ] ; if ( pthread_mutex_lock ( cntr -> the_lock ) != 0 ) { snprintf ( err_msg , MSG_LEN_SHORT , "ALERT: cannot lock mutex for lock_cntr_incr" ) ; log_record ( PBSEVENT_DEBUG , PBS_EVENTCLASS_NODE , "lock_cntr_incr" , err_msg ) ; } } 