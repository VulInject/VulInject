static int uw2453_set_channel ( struct zd_rf * rf , u8 channel ) { int r ; u16 vco_cfg ; int config = UW2453_PRIV ( rf ) -> config ; bool autocal = ( config == - 1 ) ; struct zd_chip * chip = zd_rf_to_chip ( rf ) ; static const struct zd_ioreq16 ioreqs [ ] { { ZD_CR80 0x30 } { ZD_CR81 0x30 } { ZD_CR79 0x58 } { ZD_CR12 0xf0 } { ZD_CR77 0x1b } { ZD_CR78 0x58 } } ; ; r = uw2453_synth_set_channel ( chip , channel , autocal ) ; if ( autocal ) { vco_cfg = UW2453_AUTOCAL_VCO_CFG ; } else { vco_cfg = uw2453_std_vco_cfg [ config ] [ CHAN_TO_PAIRIDX ( channel ) ] ; } r = uw2453_write_vco_cfg ( chip , vco_cfg ) ; if ( r ) { return r ; } r = uw2453_init_mode ( chip ) ; if ( r ) { return r ; } r = zd_iowrite16a_locked ( chip , ioreqs , ARRAY_SIZE ( ioreqs ) ) ; if ( r ) { return r ; } r = uw2453_set_tx_gain_level ( chip , channel ) ; if ( r ) { return r ; } return zd_iowrite16_locked ( chip , 0x06 , ZD_CR203 ) ; } 