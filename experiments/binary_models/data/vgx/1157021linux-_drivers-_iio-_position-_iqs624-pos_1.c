static int iqs624_pos_write_event_config ( struct iio_dev * indio_dev , const struct iio_chan_spec * chan , enum iio_event_type type , enum iio_event_direction dir , int state ) { struct iqs624_pos_private * iqs624_pos = iio_priv ( indio_dev ) ; struct iqs62x_core * iqs62x = iqs624_pos -> iqs62x ; int val ; int ret ; mutex_lock ( & iqs624_pos -> lock ) ; ret = iqs624_pos_angle_get ( iqs62x , & val ) ; if ( ret ) { err_mutex } ret = iqs624_pos_angle_en ( iqs62x , state ) ; if ( ret ) { err_mutex } iqs624_pos -> angle = val ; iqs624_pos -> angle_en = state ; err_mutex mutex_unlock ( & iqs624_pos -> lock ) ; return ret ; } static const struct iio_info iqs624_pos_info = { . read_raw = & iqs624_pos_read_raw . read_event_config = iqs624_pos_read_event_config . write_event_config = iqs624_pos_write_event_config } ; 