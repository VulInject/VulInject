static size_t seg6_lwt_headroom ( struct seg6_iptunnel_encap * tuninfo ) { int head ; switch ( tuninfo -> mode ) { case SEG6_IPTUN_MODE_INLINE : break ; case SEG6_IPTUN_MODE_ENCAP : case SEG6_IPTUN_MODE_ENCAP_RED : head = sizeof ( ipv6hdr ) ; break ; case SEG6_IPTUN_MODE_L2ENCAP : case SEG6_IPTUN_MODE_L2ENCAP_RED : return 0 ; } return ( ( tuninfo -> srh -> hdrlen + 1 ) << 3 ) + head ; } 