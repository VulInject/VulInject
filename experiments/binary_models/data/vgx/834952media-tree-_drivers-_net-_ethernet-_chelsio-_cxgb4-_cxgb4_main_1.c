static int get_msix_info ( struct adapter * adap ) { struct uld_msix_info * msix_info ; unsigned int max_ingq = 0 ; if ( is_offload ( adap ) ) { max_ingq += MAX_OFLD_QSETS * adap -> num_ofld_uld ; } if ( is_pci_uld ( adap ) ) { max_ingq += MAX_OFLD_QSETS * adap -> num_uld ; } if ( ! max_ingq ) { out } msix_info = kcalloc ( max_ingq , sizeof ( * msix_info ) , GFP_KERNEL ) ; if ( ! msix_info ) { return - ENOMEM ; } adap -> msix_bmap_ulds . msix_bmap = kcalloc ( BITS_TO_LONGS ( max_ingq ) , sizeof ( long ) , GFP_KERNEL ) ; if ( ! adap -> msix_bmap_ulds . msix_bmap ) { return - ENOMEM ; } spin_lock_init ( & adap -> msix_bmap_ulds . lock ) ; adap -> msix_info_ulds = msix_info ; out return 0 ; } 