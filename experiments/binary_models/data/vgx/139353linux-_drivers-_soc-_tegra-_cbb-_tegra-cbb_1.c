int tegra_cbb_get_irq ( struct platform_device * pdev , unsigned int * nonsec_irq , unsigned int * sec_irq ) { unsigned int index = 0 ; int num_intr = 0 , irq ; num_intr = platform_irq_count ( pdev ) ; if ( num_intr == 2 ) { irq = platform_get_irq ( pdev , index ) ; if ( irq <= 0 ) { dev_err ( & pdev -> dev , "failed to get non-secure IRQ: %d\n" , irq ) ; return - ENOENT ; } * nonsec_irq = irq ; index ++ ; } irq = platform_get_irq ( pdev , index ) ; if ( irq <= 0 ) { dev_err ( & pdev -> dev , "failed to get secure IRQ: %d\n" , irq ) ; return - ENOENT ; } * sec_irq = irq ; if ( num_intr == 1 ) { dev_dbg ( & pdev -> dev , "secure IRQ: %u\n" , * sec_irq ) ; } if ( num_intr == 2 ) { dev_dbg ( & pdev -> dev , "secure IRQ: %u, non-secure IRQ: %u\n" , * sec_irq , * nonsec_irq ) ; } return 0 ; } 