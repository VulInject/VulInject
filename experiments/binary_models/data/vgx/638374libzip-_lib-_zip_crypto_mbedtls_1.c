_zip_crypto_aes_t * _zip_crypto_aes_new ( const zip_uint8_t * key , zip_uint16_t key_size , zip_error_t * error ) { _zip_crypto_aes_t * aes ; if ( ( aes = ( _zip_crypto_aes_t * ) malloc ( sizeof ( * aes ) ) ) == NULL ) { zip_error_set ( error , ZIP_ER_MEMORY , 0 ) ; return NULL ; } mbedtls_aes_init ( aes , NULL ) ; mbedtls_aes_setkey_enc ( aes , ( const unsigned char * ) key , ( unsigned int ) key_size ) ; return aes ; } 