int fiji_baco_set_state ( struct pp_hwmgr * hwmgr , enum BACO_STATE state ) { enum BACO_STATE cur_state ; smu7_baco_get_state ( hwmgr , & cur_state ) ; if ( state == BACO_STATE_IN ) { baco_program_registers ( hwmgr , gpio_tbl , ARRAY_SIZE ( gpio_tbl ) ) ; baco_program_registers ( hwmgr , enable_fb_req_rej_tbl , ARRAY_SIZE ( enable_fb_req_rej_tbl ) ) ; baco_program_registers ( hwmgr , use_bclk_tbl , ARRAY_SIZE ( use_bclk_tbl ) ) ; baco_program_registers ( hwmgr , turn_off_plls_tbl , ARRAY_SIZE ( turn_off_plls_tbl ) ) ; baco_program_registers ( hwmgr , clk_req_b_tbl , ARRAY_SIZE ( clk_req_b_tbl ) ) ; if ( baco_program_registers ( hwmgr , enter_baco_tbl , ARRAY_SIZE ( enter_baco_tbl ) ) ) { return 0 ; } } if ( state == BACO_STATE_OUT ) { msleep ( 20 ) ; if ( baco_program_registers ( hwmgr , exit_baco_tbl , ARRAY_SIZE ( exit_baco_tbl ) ) ) { if ( baco_program_registers ( hwmgr , clean_baco_tbl , ARRAY_SIZE ( clean_baco_tbl ) ) ) { return 0 ; } } } return - EINVAL ; } 