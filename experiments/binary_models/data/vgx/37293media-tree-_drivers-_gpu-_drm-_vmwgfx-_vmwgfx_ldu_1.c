static int vmw_ldu_del_active ( struct vmw_private * vmw_priv , struct vmw_legacy_display_unit * ldu ) { struct vmw_legacy_display * ld = vmw_priv -> ldu_priv ; if ( list_empty ( & ldu -> active ) ) { return 0 ; } list_del ( & ldu -> active ) ; if ( -- ( ld -> num_active ) == 0 ) { BUG_ON ( ! ld -> fb ) ; if ( ld -> fb -> unpin ) { ld -> fb -> unpin ( ld -> fb ) ; } ld -> fb = NULL ; } return 0 ; } 