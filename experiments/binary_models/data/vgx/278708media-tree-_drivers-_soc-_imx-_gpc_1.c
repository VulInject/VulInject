static int imx6_pm_domain_power_off ( struct generic_pm_domain * genpd ) { struct imx_pm_domain * pd = to_imx_pm_domain ( genpd ) ; int iso , iso2sw ; u32 val ; regmap_read ( pd -> regmap , pd -> reg_offs + GPC_PGC_PUPSCR_OFFS , & val ) ; iso = val & 0x3f ; iso2sw = ( val >> 8 ) & 0x3f ; regmap_update_bits ( pd -> regmap , pd -> reg_offs + GPC_PGC_CTRL_OFFS , 0x1 , 0x1 ) ; val = BIT ( pd -> cntr_pdn_bit ) ; regmap_update_bits ( pd -> regmap , GPC_CNTR , val , val ) ; udelay ( DIV_ROUND_UP ( iso + iso2sw , pd -> ipg_rate_mhz ) ) ; if ( pd -> supply ) { regulator_disable ( pd -> supply ) ; } return 0 ; } 