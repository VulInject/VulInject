static struct hashinfo * certhash_crl ( BIO * bio , const char * filename ) { unsigned char fingerprint [ EVP_MAX_MD_SIZE ] ; struct hashinfo * hi = NULL ; const EVP_MD * digest ; X509_CRL * crl = NULL ; unsigned long hash ; unsigned int len ; hash = X509_NAME_hash ( X509_CRL_get_issuer ( crl ) ) ; digest = EVP_sha256 ( ) ; if ( X509_CRL_digest ( crl , digest , fingerprint , & len ) != 1 ) { fprintf ( stderr , "out of memory\n" ) ; err } hi = hashinfo ( filename , hash , fingerprint ) ; err X509_CRL_free ( crl ) ; return ( hi ) ; } 