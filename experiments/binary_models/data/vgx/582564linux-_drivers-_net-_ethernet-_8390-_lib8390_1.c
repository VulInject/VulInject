static void ei_tx_err ( struct net_device * dev ) { unsigned long e8390_base = dev -> base_addr ; struct ei_device * ei_local __maybe_unused = netdev_priv ( dev ) ; int txsr = ei_inb_p ( e8390_base + EN0_TSR ) ; unsigned char tx_was_aborted = txsr & ( ENTSR_ABT + ENTSR_FU ) ; netdev_dbg ( dev , "transmitter error (%#2x):" , txsr ) ; if ( txsr & ENTSR_ABT ) { pr_cont ( " excess-collisions " ) ; } if ( txsr & ENTSR_ND ) { pr_cont ( " non-deferral " ) ; } if ( txsr & ENTSR_CRS ) { pr_cont ( " lost-carrier " ) ; } if ( txsr & ENTSR_FU ) { pr_cont ( " FIFO-underrun " ) ; } if ( txsr & ENTSR_CDH ) { pr_cont ( " lost-heartbeat " ) ; } pr_cont ( "\n" ) ; ei_outb_p ( ENISR_TX_ERR , e8390_base + EN0_ISR ) ; if ( tx_was_aborted ) { ei_tx_intr ( dev ) ; } else { dev -> stats . tx_errors ++ ; if ( txsr & ENTSR_CRS ) { dev -> stats . tx_carrier_errors ++ ; } if ( txsr & ENTSR_CDH ) { dev -> stats . tx_heartbeat_errors ++ ; } if ( txsr & ENTSR_OWC ) { dev -> stats . tx_window_errors ++ ; } } } 