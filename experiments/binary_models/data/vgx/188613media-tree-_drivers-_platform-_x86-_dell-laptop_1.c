static int __init kbd_led_init ( struct device * dev ) { int ret ; kbd_init ( ) ; if ( ! kbd_als_supported ) { kbd_led_groups [ 1 ] = NULL ; } kbd_led . max_brightness = kbd_get_max_level ( ) ; if ( ! kbd_led . max_brightness ) { kbd_led . max_brightness = kbd_get_valid_token_counts ( ) ; if ( kbd_led . max_brightness ) { kbd_led . max_brightness -- ; } } ret = led_classdev_register ( dev , & kbd_led ) ; if ( ret ) { kbd_led_present = false ; } return ret ; } 