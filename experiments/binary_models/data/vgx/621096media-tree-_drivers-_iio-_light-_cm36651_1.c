static int cm36651_write_prox_thresh ( struct iio_dev * indio_dev , const struct iio_chan_spec * chan , enum iio_event_type type , enum iio_event_direction dir , enum iio_event_info info , int val , int val2 ) { struct cm36651_data * cm36651 = iio_priv ( indio_dev ) ; struct i2c_client * client = cm36651 -> client ; int ret ; cm36651 -> ps_ctrl_regs [ CM36651_PS_THD ] = val ; ret = i2c_smbus_write_byte_data ( cm36651 -> ps_client , CM36651_PS_THD , cm36651 -> ps_ctrl_regs [ CM36651_PS_THD ] ) ; if ( ret < 0 ) { dev_err ( & client -> dev , "PS threshold write failed: %d\n" , ret ) ; return ret ; } return 0 ; } 