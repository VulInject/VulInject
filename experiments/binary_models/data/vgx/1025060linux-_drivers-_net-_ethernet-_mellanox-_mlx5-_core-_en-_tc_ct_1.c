static struct mlx5_ct_counter * mlx5_tc_ct_counter_create ( struct mlx5_tc_ct_priv * ct_priv ) { struct mlx5_ct_counter * counter ; int ret ; counter = kzalloc ( sizeof ( * counter ) , GFP_KERNEL ) ; counter -> is_shared = false ; counter -> counter = mlx5_fc_create_ex ( ct_priv -> dev , true ) ; if ( IS_ERR ( counter -> counter ) ) { ct_dbg ( "Failed to create counter for ct entry" ) ; ret = PTR_ERR ( counter -> counter ) ; kfree ( counter ) ; return ERR_PTR ( ret ) ; } return counter ; } 