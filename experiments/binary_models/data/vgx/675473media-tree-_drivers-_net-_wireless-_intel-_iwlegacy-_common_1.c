void il_tx_queue_free ( struct il_priv * il , int txq_id ) { struct il_tx_queue * txq = & il -> txq [ txq_id ] ; struct device * dev = & il -> pci_dev -> dev ; int i ; il_tx_queue_unmap ( il , txq_id ) ; if ( txq -> cmd ) { for ( i = 0 ; i < TFD_TX_CMD_SLOTS ; i ++ ) { kfree ( txq -> cmd [ i ] ) ; } } if ( txq -> q . n_bd ) { dma_free_coherent ( dev , il -> hw_params . tfd_size * txq -> q . n_bd , txq -> tfds , txq -> q . dma_addr ) ; } kfree ( txq -> skbs ) ; kfree ( txq -> cmd ) ; kfree ( txq -> meta ) ; txq -> cmd = NULL ; txq -> meta = NULL ; memset ( txq , 0 , sizeof ( * txq ) ) ; } 