static int ep93xx_div_set_rate ( struct clk_hw * hw , unsigned long rate , unsigned long parent_rate ) { struct clk_psc * psc = to_clk_psc ( hw ) ; u32 val = __raw_readl ( psc -> reg ) & ~ psc -> mask ; int i ; for ( i = 0 ; i < psc -> num_div ; i ++ ) { if ( rate == parent_rate / psc -> div [ i ] ) { val |= i << psc -> shift ; break ; } } ep93xx_syscon_swlocked_write ( val , psc -> reg ) ; return 0 ; } 