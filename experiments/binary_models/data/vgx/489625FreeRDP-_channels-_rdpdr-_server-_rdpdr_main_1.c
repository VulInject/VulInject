static UINT rdpdr_server_drive_create_directory_callback1 ( RdpdrServerContext * context , wStream * s , RDPDR_IRP * irp , UINT32 deviceId , UINT32 completionId , UINT32 ioStatus ) { UINT32 fileId ; UINT8 information ; WINPR_ASSERT ( context ) ; WINPR_ASSERT ( context -> priv ) ; WINPR_ASSERT ( s ) ; WINPR_ASSERT ( irp ) ; WLog_Print ( context -> priv -> log , WLOG_DEBUG , "RdpdrServerDriveCreateDirectoryCallback1: deviceId=%" PRIu32 ", completionId=%" PRIu32 ", ioStatus=0x%" PRIx32 "" , deviceId , completionId , ioStatus ) ; if ( ioStatus != STATUS_SUCCESS ) { context -> OnDriveCreateDirectoryComplete ( context , irp -> CallbackData , ioStatus ) ; return CHANNEL_RC_OK ; } if ( ! Stream_CheckAndLogRequiredLengthWLog ( context -> priv -> log , s , 5 ) ) { return ERROR_INVALID_DATA ; } Stream_Read_UINT32 ( s , fileId ) ; Stream_Read_UINT8 ( s , information ) ; irp -> CompletionId = context -> priv -> NextCompletionId ++ ; irp -> Callback = rdpdr_server_drive_create_directory_callback2 ; irp -> DeviceId = deviceId ; irp -> FileId = fileId ; if ( ! rdpdr_server_enqueue_irp ( context , irp ) ) { WLog_Print ( context -> priv -> log , WLOG_ERROR , "rdpdr_server_enqueue_irp failed!" ) ; rdpdr_server_irp_free ( irp ) ; return ERROR_INTERNAL_ERROR ; } return rdpdr_server_send_device_close_request ( context , deviceId , fileId , irp -> CompletionId ) ; } 