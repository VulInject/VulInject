struct isis_dynhn * dynhn_snmp_next ( struct isis * isis , const uint8_t * id , int level ) { struct listnode * node = NULL ; struct isis_dynhn * dyn = NULL ; struct isis_dynhn * found_dyn = NULL ; int res ; for ( ALL_LIST_ELEMENTS_RO ( isis -> dyn_cache , node , dyn ) ; ) { res = memcmp ( dyn -> id , id , ISIS_SYS_ID_LEN ) ; if ( res == 0 && dyn -> level <= level ) { continue ; } if ( res == 0 ) { found_dyn = dyn ; break ; } if ( found_dyn == NULL || memcmp ( dyn -> id , found_dyn -> id , ISIS_SYS_ID_LEN ) < 0 ) { found_dyn = dyn ; } } return found_dyn ; } 