void networkstatus_note_certs_arrived ( const char * source_dir ) { int i ; for ( i = 0 ; i < N_CONSENSUS_FLAVORS ; ++ i ) { const char * flavor_name = networkstatus_get_flavor_name ( i ) ; consensus_waiting_for_certs_t * waiting = & consensus_waiting_for_certs [ i ] ; if ( networkstatus_check_consensus_signature ( waiting -> consensus , 0 ) >= 0 ) { char * fname = networkstatus_get_cache_fname ( i , flavor_name , 1 ) ; reload_consensus_from_file ( fname , flavor_name , NSSET_WAS_WAITING_FOR_CERTS , source_dir ) ; tor_free ( fname ) ; } } } 