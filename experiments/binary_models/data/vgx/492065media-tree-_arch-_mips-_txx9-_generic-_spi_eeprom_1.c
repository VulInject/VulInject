int __init spi_eeprom_register ( int busid , int chipid , int size ) { struct spi_board_info info = { . modalias = "at25" . max_speed_hz = 1500000 . bus_num = busid . chip_select = chipid } ; struct spi_eeprom * eeprom ; eeprom = kmalloc ( sizeof ( * eeprom ) , GFP_KERNEL ) ; if ( ! eeprom ) { return - ENOMEM ; } strcpy ( eeprom -> name , "at250x0" ) ; eeprom -> byte_len = size ; eeprom -> page_size = AT250X0_PAGE_SIZE ; eeprom -> flags = EE_ADDR1 ; info . platform_data = eeprom ; return spi_register_board_info ( & info , 1 ) ; } static read_param { int busid ; int chipid ; int address ; unsigned char * buf ; int len ; } , * read_param 