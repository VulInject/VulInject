static int Octeon_AesGcm_Encrypt ( Aes * aes , byte * in , byte * out , word32 inSz , byte * iv , word32 ivSz , byte * aad , word32 aadSz , byte * tag ) { int ret ; if ( aes == NULL ) { ret = BAD_FUNC_ARG ; } if ( ret == 0 ) { ret = Octeon_AesGcm_SetKey ( aes ) ; } if ( ret == 0 ) { ret = Octeon_AesGcm_SetIV ( aes , iv , ivSz ) ; } if ( ret == 0 ) { ret = Octeon_AesGcm_SetAAD ( aes , aad , aadSz ) ; } if ( ret == 0 ) { ret = Octeon_AesGcm_SetEncrypt ( aes , in , out , inSz , 1 ) ; } if ( ret == 0 ) { ret = Octeon_AesGcm_Finalize ( aes , inSz , aadSz , tag ) ; } return ret ; } 