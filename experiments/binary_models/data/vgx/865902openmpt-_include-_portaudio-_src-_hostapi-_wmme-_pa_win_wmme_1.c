static int QueryWaveInKSFilterMaxChannels ( UINT waveInDeviceId , int * maxChannels ) { void * devicePath ; DWORD devicePathSize ; int result = 0 ; HWAVEIN hDeviceId = ( HWAVEIN ) ( ( UINT_PTR ) waveInDeviceId ) ; if ( waveInMessage ( hDeviceId , DRV_QUERYDEVICEINTERFACESIZE , ( DWORD_PTR ) & devicePathSize , 0 ) != MMSYSERR_NOERROR ) { return 0 ; } devicePath = PaUtil_AllocateMemory ( devicePathSize ) ; if ( ! devicePath ) { return 0 ; } if ( waveInMessage ( hDeviceId , DRV_QUERYDEVICEINTERFACE , ( DWORD_PTR ) devicePath , devicePathSize ) == MMSYSERR_NOERROR ) { int count = PaWin_WDMKS_QueryFilterMaximumChannelCount ( devicePath , 1 ) ; if ( count > 0 ) { * maxChannels = count ; result = 1 ; } } return result ; } 