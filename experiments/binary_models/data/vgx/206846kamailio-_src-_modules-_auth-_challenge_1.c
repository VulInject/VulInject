int calc_new_nonce ( char * nonce , int * nonce_len , int cfg , struct sip_msg * msg ) { unsigned int t ; unsigned int n_id ; unsigned char pool ; unsigned char pool_flags ; t = ( unsigned int ) ( uint64_t ) time ( 0 ) ; if ( nc_enabled || otn_enabled ) { pool = nid_get_pool ( ) ; n_id = nid_inc ( pool ) ; pool_flags = 0 ; if ( nc_enabled ) { nc_new ( n_id , pool ) ; pool_flags |= NF_VALID_NC_ID ; } if ( otn_enabled ) { otn_new ( n_id , pool ) ; pool_flags |= NF_VALID_OT_ID ; } } else { pool = 0 ; pool_flags = 0 ; } return calc_nonce ( nonce , nonce_len , cfg , t , t + nonce_expire , n_id , pool | pool_flags , & secret1 , & secret2 , msg ) ; return calc_nonce ( nonce , nonce_len , cfg , t , t + nonce_expire , & secret1 , & secret2 , msg ) ; } 