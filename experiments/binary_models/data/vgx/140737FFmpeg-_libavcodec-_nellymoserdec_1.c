static av_cold int decode_init ( AVCodecContext * avctx ) { int ret ; float scale = 1.0f ; NellyMoserDecodeContext * s = avctx -> priv_data ; s -> avctx = avctx ; s -> imdct_out = s -> imdct_buf [ 0 ] ; s -> imdct_prev = s -> imdct_buf [ 1 ] ; av_lfg_init ( & s -> random_state , 0 ) ; if ( ( ret = av_tx_init ( & s -> imdct_ctx , & s -> imdct_fn , AV_TX_FLOAT_MDCT , 1 , 128 , & scale , 0 ) ) < 0 ) { return ret ; } s -> fdsp = avpriv_float_dsp_alloc ( avctx -> flags & AV_CODEC_FLAG_BITEXACT ) ; s -> scale_bias = 1.0 / ( 32768 * 8 ) ; avctx -> sample_fmt = AV_SAMPLE_FMT_FLT ; av_channel_layout_uninit ( & avctx -> ch_layout ) ; avctx -> ch_layout = ( AVChannelLayout ) AV_CHANNEL_LAYOUT_MONO ; ff_init_ff_sine_windows ( 7 ) ; return 0 ; } 