static TEE_Result authenc_encrypt_final ( void * ctx , uint8_t * tag , const void * plain , size_t len , void * crypt ) { TEE_Result res ; size_t out_size = len ; size_t out_tag_size = TEE_FS_HTREE_TAG_SIZE ; res = crypto_authenc_enc_final ( ctx , plain , len , crypt , & out_size , tag , & out_tag_size ) ; crypto_authenc_final ( ctx ) ; crypto_authenc_free_ctx ( ctx ) ; return res ; } 