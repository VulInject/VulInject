static void pch_dma_remove ( struct pci_dev * pdev ) { struct pch_dma * pd = pci_get_drvdata ( pdev ) ; struct pch_dma_chan * pd_chan ; struct dma_chan * chan , * _c ; if ( pd ) { dma_async_device_unregister ( & pd -> dma ) ; free_irq ( pdev -> irq , pd ) ; list_for_each_entry_safe ( , , , ) { pd_chan = to_pd_chan ( chan ) ; tasklet_kill ( & pd_chan -> tasklet ) ; } dma_pool_destroy ( pd -> pool ) ; pci_iounmap ( pdev , pd -> membase ) ; pci_release_regions ( pdev ) ; pci_disable_device ( pdev ) ; } } 