static bool vti_state_check ( const struct xfrm_state * x , __be32 dst , __be32 src ) { xfrm_address_t * daddr = ( xfrm_address_t * ) & dst ; xfrm_address_t * saddr = ( xfrm_address_t * ) & src ; if ( ! x || x -> props . mode != XFRM_MODE_TUNNEL || x -> props . family != AF_INET ) { return false ; } if ( ! xfrm_state_addr_check ( x , daddr , saddr , AF_INET ) ) { return false ; } return true ; } 