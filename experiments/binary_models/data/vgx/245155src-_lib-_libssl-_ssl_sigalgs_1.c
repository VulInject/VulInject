int ssl_sigalgs_build ( uint16_t tls_version , CBB * cbb , int security_level ) { const struct ssl_sigalg * sigalg ; const uint16_t * values ; size_t len ; size_t i ; int ret = 0 ; ssl_sigalgs_for_version ( tls_version , & values , & len ) ; for ( i = 0 ; i < len ; i ++ ) { if ( values [ i ] == SIGALG_RSA_PKCS1_MD5_SHA1 ) { return 0 ; } if ( ( sigalg = ssl_sigalg_lookup ( values [ i ] ) ) == NULL ) { return 0 ; } if ( ! CBB_add_u16 ( cbb , values [ i ] ) ) { return 0 ; } ret = 1 ; } return ret ; } 