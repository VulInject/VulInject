static int mv88e6xxx_region_atu_snapshot_fid ( struct mv88e6xxx_chip * chip , int fid , struct mv88e6xxx_devlink_atu_entry * table , int * count ) { u16 atu_op , atu_data , atu_01 , atu_23 , atu_45 ; struct mv88e6xxx_atu_entry addr ; int err ; addr . state = 0 ; eth_broadcast_addr ( addr . mac ) ; { err = mv88e6xxx_g1_atu_getnext ( chip , fid , & addr ) ; if ( ! addr . state ) { break ; } err = mv88e6xxx_g1_read ( chip , MV88E6XXX_G1_ATU_OP , & atu_op ) ; if ( err ) { return err ; } err = mv88e6xxx_g1_read ( chip , MV88E6XXX_G1_ATU_DATA , & atu_data ) ; if ( err ) { return err ; } err = mv88e6xxx_g1_read ( chip , MV88E6XXX_G1_ATU_MAC01 , & atu_01 ) ; if ( err ) { return err ; } err = mv88e6xxx_g1_read ( chip , MV88E6XXX_G1_ATU_MAC23 , & atu_23 ) ; if ( err ) { return err ; } err = mv88e6xxx_g1_read ( chip , MV88E6XXX_G1_ATU_MAC45 , & atu_45 ) ; if ( err ) { return err ; } table [ * count ] . fid = fid ; table [ * count ] . atu_op = atu_op ; table [ * count ] . atu_data = atu_data ; table [ * count ] . atu_01 = atu_01 ; table [ * count ] . atu_23 = atu_23 ; table [ * count ] . atu_45 = atu_45 ; ( * count ) ++ ; } ! is_broadcast_ether_addr ( addr . mac ) ; return 0 ; } 