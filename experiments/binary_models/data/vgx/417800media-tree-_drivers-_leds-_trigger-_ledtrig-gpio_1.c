static ssize_t gpio_trig_inverted_store ( struct device * dev , struct device_attribute * attr , const char * buf , size_t n ) { struct led_classdev * led = dev_get_drvdata ( dev ) ; struct gpio_trig_data * gpio_data = led -> trigger_data ; unsigned long inverted ; int ret ; ret = kstrtoul ( buf , 10 , & inverted ) ; if ( ret < 0 ) { return ret ; } gpio_data -> inverted = inverted ; schedule_work ( & gpio_data -> work ) ; return n ; } 