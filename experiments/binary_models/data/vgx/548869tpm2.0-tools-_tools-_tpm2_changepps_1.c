static tool_rc tpm2_tool_onrun ( ESYS_CONTEXT * ectx , tpm2_option_flags flags ) { UNUSED ( flags ) ; tool_rc rc = check_options ( ) ; rc = process_inputs ( ectx ) ; if ( rc != tool_rc_success ) { return rc ; } rc = tpm2_changepps ( ectx , ctx . auth_session , & ctx . cp_hash , & ctx . rp_hash , ctx . parameter_hash_algorithm , ctx . aux_session_handle [ 0 ] , ctx . aux_session_handle [ 1 ] ) ; if ( rc != tool_rc_success ) { return rc ; } return process_output ( ectx ) ; } 