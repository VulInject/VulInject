int elf_core_write_extra_phdrs ( struct coredump_params * cprm , loff_t offset ) { int i ; struct core_vma_metadata * m ; for_each_mte_vma ( , , ) { struct elf_phdr phdr ; phdr . p_type = PT_AARCH64_MEMTAG_MTE ; phdr . p_offset = offset ; phdr . p_vaddr = m -> start ; phdr . p_paddr = 0 ; phdr . p_filesz = mte_vma_tag_dump_size ( m ) ; phdr . p_memsz = m -> end - m -> start ; offset += phdr . p_filesz ; phdr . p_flags = 0 ; if ( ! dump_emit ( cprm , & phdr , sizeof ( phdr ) ) ) { return 0 ; } } return 1 ; } 