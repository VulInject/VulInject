mpg123_handle attribute_align_arg * mpg123_parnew ( mpg123_pars * mp , const char * decoder , int * error ) { mpg123_handle * fr = NULL ; int err = MPG123_OK ; static char tables_initialized = 0 ; if ( ! tables_initialized ) { init_layer12 ( ) ; init_layer3 ( ) ; init_costabs ( ) ; tables_initialized = 1 ; } if ( ( sizeof ( short ) != 2 ) || ( sizeof ( long ) < 4 ) ) { if ( error != NULL ) { * error = MPG123_BAD_TYPES ; } return NULL ; } if ( 12346 != REAL_TO_SHORT_ACCURATE ( 12345.67f ) ) { if ( error != NULL ) { * error = MPG123_BAD_FLOAT ; } return NULL ; } fr = ( mpg123_handle * ) malloc ( sizeof ( mpg123_handle ) ) ; if ( fr != NULL ) { frame_init_par ( fr , mp ) ; debug ( "cpu opt setting" ) ; if ( frame_cpu_opt ( fr , decoder ) != 1 ) { err = MPG123_BAD_DECODER ; frame_exit ( fr ) ; fr = NULL ; } } if ( fr != NULL ) { fr -> decoder_change = 1 ; } if ( err == MPG123_OK ) { err = MPG123_OUT_OF_MEM ; } if ( error != NULL ) { * error = err ; } return fr ; } 