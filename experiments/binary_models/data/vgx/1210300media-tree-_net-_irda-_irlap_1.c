void irlap_disconnect_request ( struct irlap_cb * self ) { IRDA_ASSERT ( , ) IRDA_ASSERT ( , ) if ( ! skb_queue_empty ( & self -> txq ) ) { self -> disconnect_pending = TRUE ; return ; } switch ( self -> state ) { case LAP_XMIT_P : case LAP_XMIT_S : case LAP_CONN : case LAP_RESET_WAIT : case LAP_RESET_CHECK : irlap_do_event ( self , DISCONNECT_REQUEST , NULL ) ; break ; default : pr_debug ( "%s(), disconnect pending!\n" , __func__ ) ; self -> disconnect_pending = TRUE ; break ; } } 