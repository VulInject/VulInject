void page_endio ( struct page * page , bool is_write , int err ) { if ( ! is_write ) { if ( ! err ) { SetPageUptodate ( page ) ; } else { ClearPageUptodate ( page ) ; SetPageError ( page , NULL ) ; } unlock_page ( page ) ; } else { if ( err ) { struct address_space * mapping ; SetPageError ( page ) ; mapping = page_mapping ( page ) ; if ( mapping ) { mapping_set_error ( mapping , err ) ; } } end_page_writeback ( page ) ; } } 