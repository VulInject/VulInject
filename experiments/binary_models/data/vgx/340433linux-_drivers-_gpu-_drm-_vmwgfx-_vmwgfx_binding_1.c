static int vmw_binding_scrub_shader ( struct vmw_ctx_bindinfo * bi , bool rebind ) { struct vmw_ctx_bindinfo_shader * binding = container_of ( bi , typeof ( * binding ) , bi ) ; struct vmw_private * dev_priv = bi -> ctx -> dev_priv ; { SVGA3dCmdHeader header ; SVGA3dCmdSetShader body ; } , * cmd cmd = VMW_CMD_RESERVE ( dev_priv , sizeof ( * cmd ) ) ; cmd -> header . id = SVGA_3D_CMD_SET_SHADER ; cmd -> header . size = sizeof ( cmd -> body ) ; cmd -> body . cid = bi -> ctx -> id ; cmd -> body . type = binding -> shader_slot + SVGA3D_SHADERTYPE_MIN ; cmd -> body . shid = ( ( rebind ) ?bi -> res -> id : SVGA3D_INVALID_ID ) ; vmw_cmd_commit ( dev_priv , sizeof ( * cmd ) ) ; return 0 ; } 