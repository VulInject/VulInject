void BPF_PROG ( exec , struct linux_binprm * bprm ) { __u32 pid = bpf_get_current_pid_tgid ( ) >> 32 ; struct local_storage * storage ; storage = bpf_task_storage_get ( & task_storage_map , bpf_get_current_task_btf ( ) , 0 , BPF_LOCAL_STORAGE_GET_F_CREATE ) ; if ( storage ) { storage -> exec_inode = bprm -> file -> f_inode ; } storage = bpf_inode_storage_get ( & inode_storage_map , bprm -> file -> f_inode , 0 , BPF_LOCAL_STORAGE_GET_F_CREATE ) ; if ( ! storage ) { return ; } storage -> value = DUMMY_STORAGE_VALUE ; } 