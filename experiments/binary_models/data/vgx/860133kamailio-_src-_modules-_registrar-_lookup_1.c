static void reg_lookup_filter_init ( void ) { str filter_bflags = str_init ( "rlf_bflags" ) ; sr_xavp_t * vavp = NULL ; if ( reg_lookup_filter_mode == 0 ) { return ; } if ( ( reg_lookup_filter_mode & REG_LOOKUP_FILTER_BFLAG ) && ( reg_xavp_cfg . s != NULL && reg_xavp_cfg . len > 0 ) && ( vavp = xavp_get_child_with_ival ( & reg_xavp_cfg , & filter_bflags ) ) != NULL ) { if ( vavp -> val . v . l != 0 ) { _reg_lookup_filter . bflags = ( uint32_t ) vavp -> val . v . l ; _reg_lookup_filter . factive = 1 ; } } if ( reg_lookup_filter_mode & REG_LOOKUP_FILTER_TCPCON ) { _reg_lookup_filter . factive = 1 ; } return ; } 