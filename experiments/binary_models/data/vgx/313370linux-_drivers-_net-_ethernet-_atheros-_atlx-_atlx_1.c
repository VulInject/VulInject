static void atlx_vlan_mode ( struct net_device * netdev , netdev_features_t features ) { struct atlx_adapter * adapter = netdev_priv ( netdev ) ; cfs_time_t flags ; u32 ctrl ; spin_lock_irqsave ( & adapter -> lock , flags ) ; ctrl = ioread32 ( adapter -> hw . hw_addr + REG_MAC_CTRL ) ; __atlx_vlan_mode ( features , & ctrl ) ; iowrite32 ( ctrl , adapter -> hw . hw_addr + REG_MAC_CTRL ) ; spin_unlock_irqrestore ( & adapter -> lock , flags ) ; } 