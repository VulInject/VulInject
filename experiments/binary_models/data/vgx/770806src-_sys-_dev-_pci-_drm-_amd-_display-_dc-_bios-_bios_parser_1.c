static enum bp_result get_ss_info_from_internal_ss_info_tbl_V2_1 ( struct bios_parser * bp , uint32_t id , struct spread_spectrum_info * info ) { enum bp_result result = BP_RESULT_UNSUPPORTED ; ATOM_ASIC_INTERNAL_SS_INFO_V2 * header ; ATOM_ASIC_SS_ASSIGNMENT_V2 * tbl ; uint32_t tbl_size , i ; if ( ! DATA_TABLES ( ASIC_InternalSS_Info ) ) { return result ; } header = GET_IMAGE ( ATOM_ASIC_INTERNAL_SS_INFO_V2 , DATA_TABLES ( ASIC_InternalSS_Info ) ) ; tbl_size = ( le16_to_cpu ( header -> sHeader . usStructureSize ) - sizeof ( ATOM_COMMON_TABLE_HEADER ) ) / sizeof ( ATOM_ASIC_SS_ASSIGNMENT_V2 ) ; tbl = ( ATOM_ASIC_SS_ASSIGNMENT_V2 * ) & ( header -> asSpreadSpectrum [ 0 ] ) ; for ( i = 0 ; i < tbl_size ; i ++ ) { result = BP_RESULT_NORECORD ; if ( tbl [ i ] . ucClockIndication != ( uint8_t ) id ) { continue ; } if ( ATOM_EXTERNAL_SS_MASK & tbl [ i ] . ucSpreadSpectrumMode ) { info -> type . EXTERNAL = true ; } if ( ATOM_SS_CENTRE_SPREAD_MODE_MASK & tbl [ i ] . ucSpreadSpectrumMode ) { info -> type . CENTER_MODE = true ; } info -> type . STEP_AND_DELAY_INFO = false ; info -> target_clock_range = le32_to_cpu ( tbl [ i ] . ulTargetClockRange ) * 10 ; info -> spread_spectrum_percentage = ( uint32_t ) le16_to_cpu ( tbl [ i ] . usSpreadSpectrumPercentage ) ; info -> spread_spectrum_range = ( uint32_t ) ( le16_to_cpu ( tbl [ i ] . usSpreadRateIn10Hz ) * 10 ) ; result = BP_RESULT_OK ; break ; } return result ; } 