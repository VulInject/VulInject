static int set_state ( int * pstate , wchar_t c , char * pc ) { static char * psign ; static char * pnumber ; static char * pcommand ; static int slash ; if ( * pstate == 0 ) { psign = ( char * ) NULL ; pnumber = ( char * ) NULL ; pcommand = ( char * ) NULL ; * pstate = 1 ; return ( 1 ) ; } if ( c == '\\' && ! slash ) { slash ++ ; return ( 1 ) ; } if ( c == erasechar ( ) && ! slash ) { switch ( * pstate ) { case 4 : if ( pc > pcommand ) { return ( 1 ) ; } pcommand = ( char * ) NULL ; case 3 : if ( pnumber && pc > pnumber ) { * pstate = 3 ; return ( 1 ) ; } pnumber = ( char * ) NULL ; case 2 : if ( psign && pc > psign ) { * pstate = 2 ; return ( 1 ) ; } psign = ( char * ) NULL ; case 1 : * pstate = 1 ; return ( 1 ) ; } } slash = 0 ; switch ( * pstate ) { case 1 : if ( c == '\t' || ( ! nflag && c == ' ' ) ) { return ( 1 ) ; } if ( c == '+' || c == '-' ) { psign = pc ; * pstate = 2 ; return ( 1 ) ; } case 2 : if ( iswascii ( c ) && isdigit ( c ) ) { pnumber = pc ; * pstate = 3 ; return ( 1 ) ; } case 3 : if ( iswascii ( c ) && isdigit ( c ) ) { return ( 1 ) ; } if ( iswascii ( c ) && pg_strchr ( "h\014.wz\004dqQfl np$" , c ) ) { pcommand = pc ; if ( nflag ) { * pstate = 10 ; } else { * pstate = 4 ; } return ( 1 ) ; } if ( iswascii ( c ) && pg_strchr ( "s/^?!" , c ) ) { pcommand = pc ; * pstate = 4 ; return ( 1 ) ; } return ( 0 ) ; case 4 : return ( 1 ) ; } return ( 0 ) ; } 