int ctf_func_info_by_id ( ctf_file_t * fp , ctf_id_t type , ctf_funcinfo_t * fip ) { ctf_file_t * ofp = fp ; const ctf_type_t * tp ; const ushort_t * dp ; int nargs ; ssize_t increment ; if ( ( tp = ctf_lookup_by_id ( & fp , type ) ) == NULL ) { return ( CTF_ERR ) ; } if ( LCTF_INFO_KIND ( fp , tp -> ctt_info ) != CTF_K_FUNCTION ) { return ( ctf_set_errno ( ofp , ECTF_NOTFUNC ) ) ; } fip -> ctc_return = tp -> ctt_type ; nargs = LCTF_INFO_VLEN ( fp , tp -> ctt_info ) ; fip -> ctc_argc = nargs ; if ( nargs != 0 ) { ( void ) ctf_get_ctt_size ( fp , tp , NULL , & increment ) ; dp = ( ushort_t * ) ( ( uintptr_t ) fp -> ctf_buf + fp -> ctf_txlate [ CTF_TYPE_TO_INDEX ( type ) ] + increment ) ; if ( dp [ nargs - 1 ] == 0 ) { fip -> ctc_flags |= CTF_FUNC_VARARG ; fip -> ctc_argc -- ; } } return ( 0 ) ; } 