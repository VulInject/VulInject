CK_RV meta_SignRecoverInit ( CK_SESSION_HANDLE hSession , CK_MECHANISM_PTR pMechanism , CK_OBJECT_HANDLE hKey ) { CK_RV rv ; meta_session_t * session ; meta_object_t * key ; if ( pMechanism == NULL ) { return ( CKR_ARGUMENTS_BAD ) ; } rv = meta_handle2session ( hSession , & session ) ; if ( rv != CKR_OK ) { return ( rv ) ; } rv = meta_handle2object ( hKey , & key ) ; if ( rv != CKR_OK ) { REFRELEASE ( session , NULL ) ; return ( rv ) ; } rv = meta_operation_init ( CKF_SIGN_RECOVER , session , pMechanism , key ) ; OBJRELEASE ( key ) ; REFRELEASE ( session ) ; return ( rv ) ; } 