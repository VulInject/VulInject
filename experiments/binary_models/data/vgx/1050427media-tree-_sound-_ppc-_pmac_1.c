static int snd_pmac_hw_rule_rate ( struct snd_pcm_hw_params * params , struct snd_pcm_hw_rule * rule ) { struct snd_pmac * chip = rule -> private ; struct pmac_stream * rec = snd_pmac_get_stream ( chip , rule -> deps [ 0 ] ) ; int i , freq_table [ 8 ] , num_freqs ; num_freqs = 0 ; for ( i = chip -> num_freqs - 1 ; i >= 0 ; i -- ) { if ( rec -> cur_freqs & ( 1 << i ) ) { freq_table [ num_freqs ++ ] = chip -> freq_table [ i ] ; } } return snd_interval_list ( hw_param_interval ( params , rule -> var ) , num_freqs , freq_table , 0 ) ; } 