Status_t sm_routing_addModuleFac ( const char * name , routing_mod_factory fac ) { Status_t s ; cl_map_obj_t * wrp = NULL ; if ( name == NULL || strlen ( name ) == 0 || fac == NULL ) { return VSTATUS_ILLPARM ; } if ( cl_qmap_get ( & moduleFacMap , UGLY_CHAR_U64 ( name ) ) != cl_qmap_end ( & moduleFacMap ) ) { return VSTATUS_BAD ; } if ( ( s = vs_pool_alloc ( & sm_pool , sizeof ( cl_map_obj_t ) , ( void * ) & wrp ) ) != VSTATUS_OK ) { return s ; } wrp -> p_object = fac ; if ( cl_qmap_insert ( & moduleFacMap , UGLY_CHAR_U64 ( name ) , & wrp -> item ) == NULL ) { return VSTATUS_BAD ; } return VSTATUS_OK ; } 