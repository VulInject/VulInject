void gtkui_log_msg ( GSimpleAction * action , GVariant * value , gpointer data ) { GtkWidget * dialog ; gchar * filename ; ( void ) action ; ( void ) value ; ( void ) data ; DEBUG_MSG ( "gtk_log_msg" ) ; SAFE_FREE ( logfile ) ; SAFE_CALLOC ( logfile , FILE_LEN , sizeof ( char ) ) ; dialog = gtk_file_chooser_dialog_new ( "Safe Log Messages in file..." , GTK_WINDOW ( window ) , GTK_FILE_CHOOSER_ACTION_SAVE , "_Cancel" , GTK_RESPONSE_CANCEL , "_Save" , GTK_RESPONSE_OK , NULL ) ; gtk_file_chooser_set_current_folder ( GTK_FILE_CHOOSER ( dialog ) , "." ) ; if ( gtk_dialog_run ( GTK_DIALOG ( dialog ) ) == GTK_RESPONSE_OK ) { gtk_widget_hide ( dialog ) ; filename = gtk_file_chooser_get_filename ( GTK_FILE_CHOOSER ( dialog ) ) ; gtk_widget_destroy ( dialog ) ; memcpy ( logfile , filename , FILE_LEN ) ; log_msg ( ) ; } else { gtk_widget_destroy ( dialog ) ; } } 