static int ovs_flow_cmd_fill_info ( const struct sw_flow * flow , int dp_ifindex , struct sk_buff * skb , u32 portid , u32 seq , u32 flags , u8 cmd , u32 ufid_flags ) { const int skb_orig_len = skb -> len ; struct ovs_header * ovs_header ; int err ; ovs_header = genlmsg_put ( skb , portid , seq , & dp_flow_genl_family , flags , cmd ) ; ovs_header -> dp_ifindex = dp_ifindex ; err = ovs_nla_put_identifier ( flow , skb ) ; if ( err ) { error } if ( should_fill_key ( & flow -> id , ufid_flags ) ) { err = ovs_nla_put_masked_key ( flow , skb ) ; if ( err ) { error } } if ( should_fill_mask ( ufid_flags ) ) { err = ovs_nla_put_mask ( flow , skb ) ; if ( err ) { error } } err = ovs_flow_cmd_fill_stats ( flow , skb ) ; if ( err ) { error } if ( should_fill_actions ( ufid_flags ) ) { err = ovs_flow_cmd_fill_actions ( flow , skb , skb_orig_len ) ; if ( err ) { error } } genlmsg_end ( skb , ovs_header ) ; return 0 ; error genlmsg_cancel ( skb , ovs_header ) ; return err ; } 