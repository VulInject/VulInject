static struct format_field * * get_event_fields ( const char * type , const char * name , int count , struct format_field * list ) { struct format_field * * fields ; struct format_field * field ; int i = 0 ; fields = malloc ( sizeof ( * fields ) * ( count + 1 ) ) ; if ( ! fields ) { return in ; } for ( field = list ; field ; field = field -> next ) { fields [ i ++ ] = field ; if ( i == count + 1 ) { do_warning ( "event %s has more %s fields than specified" , name , type ) ; i -- ; break ; } } if ( i != count ) { do_warning ( "event %s has less %s fields than specified" , name , type ) ; } fields [ i ] = NULL ; return fields ; } 