static int populate_ggtt ( struct drm_i915_private * i915 ) { struct drm_i915_gem_object * obj ; u64 size ; for ( size = 0 ; size + I915_GTT_PAGE_SIZE <= i915 -> ggtt . base . total ; size += I915_GTT_PAGE_SIZE ) { struct i915_vma * vma ; obj = i915_gem_object_create_internal ( i915 , I915_GTT_PAGE_SIZE ) ; if ( IS_ERR ( obj ) ) { return PTR_ERR ( obj ) ; } vma = i915_gem_object_ggtt_pin ( obj , NULL , 0 , 0 , 0 ) ; if ( IS_ERR ( vma ) ) { return PTR_ERR ( vma ) ; } } if ( ! list_empty ( & i915 -> mm . unbound_list ) ) { list_for_each_entry ( , , ) size ++ ; pr_err ( "Found %lld objects unbound!\n" , size ) ; return - EINVAL ; } if ( list_empty ( & i915 -> ggtt . base . inactive_list ) ) { pr_err ( "No objects on the GGTT inactive list!\n" ) ; return - EINVAL ; } return 0 ; } 