static int onyx_snd_mute_put ( struct snd_kcontrol * kcontrol , struct snd_ctl_elem_value * ucontrol ) { struct onyx * onyx = snd_kcontrol_chip ( kcontrol ) ; u8 v = 0 , c = 0 ; int err = - EBUSY ; if ( onyx -> analog_locked ) { out_unlock } onyx_read_register ( onyx , ONYX_REG_DAC_CONTROL , & v ) ; c = v ; c &= ~ ( ONYX_MUTE_RIGHT | ONYX_MUTE_LEFT ) ; if ( ! ucontrol -> value . integer . value [ 0 ] ) { c |= ONYX_MUTE_LEFT ; } if ( ! ucontrol -> value . integer . value [ 1 ] ) { c |= ONYX_MUTE_RIGHT ; } err = onyx_write_register ( onyx , ONYX_REG_DAC_CONTROL , c ) ; out_unlock mutex_unlock ( & onyx -> mutex ) ; return ! err ?( v != c ) : err ; } 