static bool test_wsmt_enabled ( void ) { struct calling_interface_token * wsmt ; wsmt = dell_smbios_find_token ( WSMT_EN_TOKEN ) ; buffer -> cmd_class = CLASS_TOKEN_READ ; buffer -> cmd_select = SELECT_TOKEN_STD ; memset ( buffer , 0 , sizeof ( calling_interface_buffer ) ) ; buffer -> input [ 0 ] = wsmt -> location ; buffer -> output [ 0 ] = 99 ; dell_smbios_smm_call ( buffer ) ; if ( buffer -> output [ 0 ] == 99 ) { return true ; } return false ; } 