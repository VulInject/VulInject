int usbhs_mod_probe ( struct usbhs_priv * priv ) { struct device * dev = usbhs_priv_to_dev ( priv ) ; int ret ; ret = usbhs_mod_host_probe ( priv ) ; ret = usbhs_mod_gadget_probe ( priv ) ; if ( ret < 0 ) { mod_init_host_err } ret = devm_request_irq ( dev , priv -> irq , usbhs_interrupt , priv -> irqflags , dev_name ( dev ) , priv ) ; if ( ret ) { dev_err ( dev , "irq request err\n" ) ; mod_init_gadget_err } return ret ; mod_init_gadget_err usbhs_mod_gadget_remove ( priv ) ; mod_init_host_err usbhs_mod_host_remove ( priv ) ; return ret ; } 