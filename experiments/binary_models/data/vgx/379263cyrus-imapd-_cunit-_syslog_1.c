unsigned int CU_syslogMatchEnd ( unsigned int match , const char * * sp ) { unsigned int i ; unsigned int count = 0 ; const char * s = NULL ; for ( i = 0 ; i < MAX_SLMATCH ; i ++ ) { if ( ! slmatches [ i ] . re ) { continue ; } if ( match && match != i + 1 ) { continue ; } if ( ! s ) { s = slmatches [ i ] . re ; } else { s = "(multiple matches)" ; } count += slmatches [ i ] . count ; regfree ( & slmatches [ i ] . cre ) ; nslmatches -- ; if ( match ) { break ; } } if ( match && ! s ) { s = "invalid match number" ; count = ~ 0U ; } if ( sp ) { * sp = s ; } return count ; } 