static DH * get_dh ( BIGNUM * p , BIGNUM * g ) { DH * dh ; dh = DH_new ( ) ; ( defined ( HAVE_LIBRESSL ) && LIBRESSL_VERSION_NUMBER >= 0x3050000L ) ; if ( DH_set0_pqg ( dh , p , NULL , g ) != 1 ) { pr_trace_msg ( trace_channel , 3 , "error setting DH p/q parameters: %s" , ERR_error_string ( ERR_get_error ( ) , NULL ) ) ; DH_free ( dh ) ; return NULL ; } dh -> p = p ; dh -> g = g ; return dh ; } 