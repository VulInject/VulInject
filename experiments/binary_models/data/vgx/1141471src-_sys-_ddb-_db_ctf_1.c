static const char * db_ctf_off2name ( uint32_t offset ) { const char * name ; if ( ! db_ctf . ctf_found ) { return in ; } if ( CTF_NAME_STID ( offset ) != CTF_STRTAB_0 ) { return "external" ; } if ( CTF_NAME_OFFSET ( offset ) >= db_ctf . cth -> cth_strlen ) { return "exceeds strlab" ; } if ( db_ctf . cth -> cth_stroff + CTF_NAME_OFFSET ( offset ) >= db_ctf . dlen ) { return "invalid" ; } name = db_ctf . data + db_ctf . cth -> cth_stroff + CTF_NAME_OFFSET ( offset ) ; if ( * name == '\0' ) { return NULL ; } return name ; } 