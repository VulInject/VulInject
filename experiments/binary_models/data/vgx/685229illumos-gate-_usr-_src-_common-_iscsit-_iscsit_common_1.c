int it_nv_to_tpgtlist ( nvlist_t * nvl , uint32_t * count , it_tpgt_t * * tpgtlist ) { int ret = 0 ; it_tpgt_t * tpgt ; it_tpgt_t * prev = NULL ; nvpair_t * nvp = NULL ; nvlist_t * nvt ; char * name ; * tpgtlist = NULL ; * count = 0 ; if ( ! nvl ) { return ( 0 ) ; } while ( ( nvp = nvlist_next_nvpair ( nvl , nvp ) ) != NULL ) { name = nvpair_name ( nvp ) ; ret = nvpair_value_nvlist ( nvp , & nvt ) ; if ( ret != 0 ) { continue ; } ret = it_nv_to_tpgt ( nvt , name , & tpgt ) ; if ( ret != 0 ) { break ; } ( * count ) ++ ; if ( * tpgtlist == NULL ) { * tpgtlist = tpgt ; } else { prev -> tpgt_next = tpgt ; } prev = tpgt ; } if ( ret != 0 ) { it_tpgt_free_cmn ( * tpgtlist ) ; * tpgtlist = NULL ; } return ( ret ) ; } 