if ( ctx -> pmeth -> flags & EVP_PKEY_FLAG_AUTOARGLEN ) { size_t pksize = ( size_t ) EVP_PKEY_size ( ctx -> pkey ) ; if ( ! arg ) { * arglen = pksize ; return 1 ; } if ( * arglen < pksize ) { EVPerror ( EVP_R_BUFFER_TOO_SMALL ) ; return 0 ; } } int EVP_PKEY_sign_init ( EVP_PKEY_CTX * ctx ) { int ret ; if ( ! ctx || ! ctx -> pmeth || ! ctx -> pmeth -> sign ) { EVPerror ( EVP_R_OPERATION_NOT_SUPPORTED_FOR_THIS_KEYTYPE ) ; return - 2 ; } ctx -> operation = EVP_PKEY_OP_SIGN ; ret = ctx -> pmeth -> sign_init ( ctx ) ; if ( ret <= 0 ) { ctx -> operation = EVP_PKEY_OP_UNDEFINED ; } return ret ; } 