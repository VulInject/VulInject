int avs_module_info_init ( struct avs_dev * adev , bool purge ) { struct avs_mods_info * info ; int ret ; ret = avs_ipc_get_modules_info ( adev , & info ) ; if ( ret ) { return AVS_IPC_RET ( ret ) ; } mutex_lock ( & adev -> modres_mutex ) ; ret = avs_module_ida_alloc ( adev , info , purge ) ; if ( ret < 0 ) { dev_err ( adev -> dev , "initialize module idas failed: %d\n" , ret ) ; exit } adev -> mods_info = info ; exit mutex_unlock ( & adev -> modres_mutex ) ; return ret ; } 