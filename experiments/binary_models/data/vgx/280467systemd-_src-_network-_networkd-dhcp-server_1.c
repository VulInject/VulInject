void network_adjust_dhcp_server ( Network * network ) { assert ( network ) ; if ( network -> bond ) { log_warning ( "%s: DHCPServer= is enabled for bond slave. Disabling DHCP server." , network -> filename ) ; network -> dhcp_server = false ; return ; } if ( ! in4_addr_is_set ( & network -> dhcp_server_address ) ) { Address * address ; bool have = false ; ORDERED_HASHMAP_FOREACH ( , ) { if ( section_is_invalid ( address -> section ) ) { continue ; } if ( address -> family != AF_INET ) { continue ; } if ( in4_addr_is_localhost ( & address -> in_addr . in ) ) { continue ; } if ( in4_addr_is_link_local ( & address -> in_addr . in ) ) { continue ; } if ( in4_addr_is_set ( & address -> in_addr_peer . in ) ) { continue ; } have = true ; break ; } if ( ! have ) { log_warning ( "%s: DHCPServer= is enabled, but no static address configured. " "Disabling DHCP server." , network -> filename ) ; network -> dhcp_server = false ; return ; } } } 