static int DetectContentParseTest41 ( void ) { int result = 1 ; DetectContentData * cd = NULL ; int patlen = 255 ; char * teststring = SCMalloc ( sizeof ( char ) * ( patlen + 1 ) ) ; int idx = 0 ; for ( int i = 0 ; i < patlen ; idx ++ , i ++ ) { teststring [ idx ] = 'a' ; } teststring [ idx ++ ] = '\0' ; uint16_t spm_matcher = SinglePatternMatchDefaultMatcher ( ) ; SpmGlobalThreadCtx * spm_global_thread_ctx = SpmInitGlobalThreadCtx ( spm_matcher ) ; FAIL_IF ( spm_global_thread_ctx == NULL ) ; cd = DetectContentParse ( spm_global_thread_ctx , teststring ) ; if ( cd == NULL ) { SCLogDebug ( "expected not NULL" ) ; result = 0 ; } SpmDestroyGlobalThreadCtx ( spm_global_thread_ctx ) ; SCFree ( teststring ) ; DetectContentFree ( NULL , cd ) ; return result ; } 