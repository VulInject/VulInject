char * * strv_parse_nulstr ( const char * s , size_t l ) { _cleanup_strv_free_ char * * v = NULL ; size_t c = 0 , i = 0 ; assert ( s || l <= 0 ) ; for ( const char * p = s ; p < s + l ; p ++ ) { if ( * p == 0 ) { c ++ ; } } if ( s [ l - 1 ] != 0 ) { c ++ ; } v = new0 ( char * , c + 1 ) ; if ( ! v ) { return NULL ; } for ( const char * p = s ; p < s + l ; ) { const char * e ; e = memchr ( p , 0 , s + l - p ) ; v [ i ] = memdup_suffix0 ( p , e ?e - p : s + l - p ) ; if ( ! v [ i ] ) { return NULL ; } i ++ ; if ( ! e ) { break ; } p = e + 1 ; } assert ( i == c ) ; return TAKE_PTR ( v ) ; } 