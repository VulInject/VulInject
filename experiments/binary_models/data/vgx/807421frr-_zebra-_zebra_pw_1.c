static int zebra_pw_check_reachability_strict ( const struct zebra_pw * pw , struct route_entry * re ) { const struct nexthop * nexthop ; const struct nexthop_group * nhg ; bool found_p = false ; bool fail_p = false ; nhg = rib_get_fib_nhg ( re ) ; if ( nhg && nhg -> nexthop ) { for ( ALL_NEXTHOPS_PTR ( nhg , nexthop ) ; ) { if ( CHECK_FLAG ( nexthop -> flags , NEXTHOP_FLAG_ACTIVE ) ) { if ( nexthop -> nh_label != NULL ) { found_p = true ; } else { fail_p = true ; break ; } } } } if ( fail_p ) { done } nhg = rib_get_fib_backup_nhg ( re ) ; if ( nhg && nhg -> nexthop ) { for ( ALL_NEXTHOPS_PTR ( nhg , nexthop ) ; ) { if ( CHECK_FLAG ( nexthop -> flags , NEXTHOP_FLAG_RECURSIVE ) ) { continue ; } if ( CHECK_FLAG ( nexthop -> flags , NEXTHOP_FLAG_ACTIVE ) ) { if ( nexthop -> nh_label != NULL ) { found_p = true ; } else { fail_p = true ; break ; } } } } done if ( fail_p || ! found_p ) { if ( IS_ZEBRA_DEBUG_PW ) { zlog_debug ( "%s: unlabeled route for %s" , __func__ , pw -> ifname ) ; } return - 1 ; } return 0 ; } 