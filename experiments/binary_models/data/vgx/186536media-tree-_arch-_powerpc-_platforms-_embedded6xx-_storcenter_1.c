static int __init storcenter_add_bridge ( struct device_node * dev ) { int len ; struct pci_controller * hose ; const int * bus_range ; printk ( "Adding PCI host bridge %s\n" , dev -> full_name ) ; hose = pcibios_alloc_controller ( dev ) ; bus_range = of_get_property ( dev , "bus-range" , & len ) ; hose -> first_busno = bus_range ?bus_range [ 0 ] : 0 ; hose -> last_busno = bus_range ?bus_range [ 1 ] : 0xff ; setup_indirect_pci ( hose , MPC10X_MAPB_CNFG_ADDR , MPC10X_MAPB_CNFG_DATA , 0 ) ; pci_process_bridge_OF_ranges ( hose , dev , 1 ) ; return 0 ; } 