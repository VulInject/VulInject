int RegexMatch ( Regex * re , char * str , int len , int firstp ) { char * p , * ep ; char * lpos ; Regex * r ; if ( len < 0 ) { len = strlen ( str ) ; } re -> position = NULL ; ep = str + len ; for ( p = str ; p <= ep ; p ++ ) { lpos = NULL ; re -> lposition = NULL ; for ( r = re ; r != NULL ; r = r -> alt_regex ) { switch ( regmatch ( r -> re , p , ep , firstp && ( p == str ) , & lpos ) ) { case 1 : re -> position = p ; if ( re -> lposition == NULL || re -> lposition < lpos ) { re -> lposition = lpos ; } break ; case - 1 : re -> position = NULL ; return - 1 ; } } if ( re -> lposition != NULL ) { return 1 ; } p += get_mclen ( p ) - 1 ; } return 0 ; } 