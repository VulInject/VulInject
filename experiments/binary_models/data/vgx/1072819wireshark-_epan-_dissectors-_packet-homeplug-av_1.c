static void dissect_homeplug_av_tone_map_rx_cnf ( ptvcursor_t * cursor , guint8 homeplug_av_mmver ) { proto_item * it ; guint16 num_act_carriers ; it = ptvcursor_add_no_advance ( cursor , hf_homeplug_av_tone_map_rx_cnf , - 1 , ENC_NA ) ; ptvcursor_push_subtree ( cursor , it , ett_homeplug_av_tone_map_rx_cnf ) ; { if ( homeplug_av_mmver == HOMEPLUG_AV_MMVER_1_1 ) { ptvcursor_add ( cursor , hf_homeplug_av_tone_map_rx_cnf_status , 1 , ENC_LITTLE_ENDIAN ) ; ptvcursor_add ( cursor , hf_homeplug_av_reserved , 1 , ENC_NA ) ; ptvcursor_add ( cursor , hf_homeplug_av_tone_map_rx_cnf_len , 2 , ENC_LITTLE_ENDIAN ) ; ptvcursor_add ( cursor , hf_homeplug_av_tone_map_rx_cnf_subver , 1 , ENC_LITTLE_ENDIAN ) ; ptvcursor_add ( cursor , hf_homeplug_av_reserved , 1 , ENC_NA ) ; ptvcursor_add ( cursor , hf_homeplug_av_tone_map_rx_cnf_mac , 6 , ENC_NA ) ; ptvcursor_add ( cursor , hf_homeplug_av_tone_map_rx_cnf_slot , 1 , ENC_LITTLE_ENDIAN ) ; ptvcursor_add ( cursor , hf_homeplug_av_tone_map_rx_cnf_coupling , 1 , ENC_LITTLE_ENDIAN ) ; ptvcursor_add ( cursor , hf_homeplug_av_tone_map_rx_cnf_num_tms , 1 , ENC_LITTLE_ENDIAN ) ; ptvcursor_add ( cursor , hf_homeplug_av_reserved , 1 , ENC_NA ) ; num_act_carriers = tvb_get_letohs ( ptvcursor_tvbuff ( cursor ) , ptvcursor_current_offset ( cursor ) ) ; ptvcursor_add ( cursor , hf_homeplug_av_tone_map_rx_cnf_num_act , 2 , ENC_LITTLE_ENDIAN ) ; if ( num_act_carriers ) { ptvcursor_add ( cursor , hf_homeplug_av_reserved , 4 , ENC_NA ) ; ptvcursor_add ( cursor , hf_homeplug_av_tone_map_rx_cnf_gil , 1 , ENC_LITTLE_ENDIAN ) ; ptvcursor_add ( cursor , hf_homeplug_av_reserved , 1 , ENC_NA ) ; ptvcursor_add ( cursor , hf_homeplug_av_tone_map_rx_cnf_agc , 1 , ENC_LITTLE_ENDIAN ) ; ptvcursor_add ( cursor , hf_homeplug_av_reserved , 1 , ENC_NA ) ; dissect_homeplug_av_tone_map_carrier ( cursor , num_act_carriers ) ; } } else { ptvcursor_add ( cursor , hf_homeplug_av_tone_map_rx_cnf_status , 1 , ENC_LITTLE_ENDIAN ) ; ptvcursor_add ( cursor , hf_homeplug_av_tone_map_rx_cnf_slot , 1 , ENC_LITTLE_ENDIAN ) ; ptvcursor_add ( cursor , hf_homeplug_av_tone_map_rx_cnf_num_tms , 1 , ENC_LITTLE_ENDIAN ) ; num_act_carriers = tvb_get_letohs ( ptvcursor_tvbuff ( cursor ) , ptvcursor_current_offset ( cursor ) ) ; ptvcursor_add ( cursor , hf_homeplug_av_tone_map_rx_cnf_num_act , 2 , ENC_LITTLE_ENDIAN ) ; if ( num_act_carriers ) { dissect_homeplug_av_tone_map_carrier ( cursor , num_act_carriers ) ; if ( num_act_carriers > HOMEPLUG_AV_TONE_MAP_MAX_NUM_CARRIERS_A ) { ptvcursor_add ( cursor , hf_homeplug_av_reserved , ( HOMEPLUG_AV_TONE_MAP_MAX_NUM_CARRIERS_B - num_act_carriers ) >> 1 , ENC_NA ) ; } else { ptvcursor_add ( cursor , hf_homeplug_av_reserved , ( HOMEPLUG_AV_TONE_MAP_MAX_NUM_CARRIERS_A - num_act_carriers ) >> 1 , ENC_NA ) ; } ptvcursor_add ( cursor , hf_homeplug_av_tone_map_rx_cnf_gil , 1 , ENC_LITTLE_ENDIAN ) ; ptvcursor_add ( cursor , hf_homeplug_av_tone_map_rx_cnf_agc , 1 , ENC_LITTLE_ENDIAN ) ; } } } ptvcursor_pop_subtree ( cursor ) ; } 