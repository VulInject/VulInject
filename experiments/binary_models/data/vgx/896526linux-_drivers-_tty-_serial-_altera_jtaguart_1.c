static int altera_jtaguart_startup ( struct uart_port * port ) { cfs_time_t flags ; int ret ; ret = request_irq ( port -> irq , altera_jtaguart_interrupt , 0 , DRV_NAME , port ) ; if ( ret ) { pr_err ( DRV_NAME ": unable to attach Altera JTAG UART %d " "interrupt vector=%d\n" , port -> line , port -> irq ) ; return ret ; } spin_lock_irqsave ( & port -> lock , flags ) ; port -> read_status_mask = ALTERA_JTAGUART_CONTROL_RE_MSK ; writel ( port -> read_status_mask , port -> membase + ALTERA_JTAGUART_CONTROL_REG ) ; spin_unlock_irqrestore ( & port -> lock , flags ) ; return 0 ; } 