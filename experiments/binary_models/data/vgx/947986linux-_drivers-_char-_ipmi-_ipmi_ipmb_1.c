static bool valid_ipmb ( struct ipmi_ipmb_dev * iidev ) { u8 * msg = iidev -> rcvmsg ; u8 netfn ; if ( iidev -> rcvlen < 7 ) { return false ; } netfn = msg [ 1 ] >> 2 ; if ( netfn & 1 ) { if ( iidev -> rcvlen < 8 ) { return false ; } } if ( ipmb_checksum ( msg , 3 ) != 0 ) { return false ; } if ( ipmb_checksum ( msg + 3 , iidev -> rcvlen - 3 ) != 0 ) { return false ; } return true ; } 