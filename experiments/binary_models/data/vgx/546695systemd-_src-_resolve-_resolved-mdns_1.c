static bool mdns_should_reply_using_unicast ( DnsPacket * p ) { DnsQuestionItem * item ; if ( p -> sender_port != MDNS_PORT ) { return true ; } switch ( p -> family ) { case AF_INET : break ; case AF_INET6 : if ( ! in6_addr_equal ( & p -> destination . in6 , & MDNS_MULTICAST_IPV6_ADDRESS ) ) { return true ; } break ; } DNS_QUESTION_FOREACH_ITEM ( , ) if ( ! FLAGS_SET ( item -> flags , DNS_QUESTION_WANTS_UNICAST_REPLY ) ) { return false ; } return true ; } 