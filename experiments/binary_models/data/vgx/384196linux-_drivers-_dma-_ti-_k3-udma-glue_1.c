static int k3_udma_glue_cfg_rx_chn ( struct k3_udma_glue_rx_channel * rx_chn ) { const struct udma_tisci_rm * tisci_rm = rx_chn -> common . tisci_rm ; struct ti_sci_msg_rm_udmap_rx_ch_cfg req ; int ret ; req . valid_params = TI_SCI_MSG_VALUE_RM_UDMAP_CH_FETCH_SIZE_VALID | TI_SCI_MSG_VALUE_RM_UDMAP_CH_CQ_QNUM_VALID | TI_SCI_MSG_VALUE_RM_UDMAP_CH_CHAN_TYPE_VALID | TI_SCI_MSG_VALUE_RM_UDMAP_CH_ATYPE_VALID ; req . nav_id = tisci_rm -> tisci_dev_id ; req . index = rx_chn -> udma_rchan_id ; req . rx_fetch_size = rx_chn -> common . hdesc_size >> 2 ; req . rxcq_qnum = 0xFFFF ; if ( ! xudma_is_pktdma ( rx_chn -> common . udmax ) && rx_chn -> flow_num && rx_chn -> flow_id_base != rx_chn -> udma_rchan_id ) { req . valid_params |= TI_SCI_MSG_VALUE_RM_UDMAP_CH_RX_FLOWID_START_VALID | TI_SCI_MSG_VALUE_RM_UDMAP_CH_RX_FLOWID_CNT_VALID ; req . flowid_start = rx_chn -> flow_id_base ; req . flowid_cnt = rx_chn -> flow_num ; } req . rx_chan_type = TI_SCI_RM_UDMAP_CHAN_TYPE_PKT_PBRR ; req . rx_atype = rx_chn -> common . atype_asel ; ret = tisci_rm -> tisci_udmap_ops -> rx_ch_cfg ( tisci_rm -> tisci , & req ) ; if ( ret ) { dev_err ( rx_chn -> common . dev , "rchan%d cfg failed %d\n" , rx_chn -> udma_rchan_id , ret ) ; } return ret ; } 