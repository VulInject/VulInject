int avcodec_parameters_copy ( AVCodecParameters * dst , const AVCodecParameters * src ) { int ret ; codec_parameters_reset ( dst ) ; memcpy ( dst , src , sizeof ( * dst ) ) ; dst -> ch_layout = ( AVChannelLayout ) { 0 } ; dst -> extradata = NULL ; dst -> extradata_size = 0 ; if ( src -> extradata ) { dst -> extradata = av_mallocz ( src -> extradata_size + AV_INPUT_BUFFER_PADDING_SIZE ) ; memcpy ( dst -> extradata , src -> extradata , src -> extradata_size ) ; dst -> extradata_size = src -> extradata_size ; } ret = av_channel_layout_copy ( & dst -> ch_layout , & src -> ch_layout ) ; if ( ret < 0 ) { return ret ; } return 0 ; } 