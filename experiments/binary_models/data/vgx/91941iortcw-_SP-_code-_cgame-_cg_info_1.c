void CG_DrawInformation ( void ) { static int callCount = 0 ; float percentDone ; int expectedHunk ; char hunkBuf [ MAX_QPATH ] ; vec4_t color ; if ( callCount ) { return ; } callCount ++ ; trap_Cvar_VariableStringBuffer ( "com_expectedhunkusage" , hunkBuf , MAX_QPATH ) ; expectedHunk = atoi ( hunkBuf ) ; trap_R_SetColor ( NULL ) ; VectorSet ( color , 0.8 , 0.8 , 0.8 ) ; color [ 3 ] = 0.8 ; if ( strlen ( cg_missionStats . string ) > 1 && cg_missionStats . string [ 0 ] == 's' ) { vec2_t xy = { 190 470 } ; vec2_t wh = { 260 10 } ; if ( expectedHunk > 0 ) { percentDone = ( float ) ( cg_hunkUsed . integer + cg_soundAdjust . integer ) / ( float ) ( expectedHunk ) ; if ( percentDone > 0.97 ) { percentDone = 0.97 ; } CG_HorizontalPercentBar ( xy [ 0 ] + 10 , xy [ 1 ] + wh [ 1 ] - 10 , wh [ 0 ] - 20 , 10 , percentDone ) ; } else { UI_DrawProportionalString ( 320 , xy [ 1 ] + wh [ 1 ] - 10 , "please wait" , UI_CENTER | UI_EXSMALLFONT | UI_DROPSHADOW , color ) ; } callCount -- ; return ; } if ( cgs . gametype == GT_SINGLE_PLAYER ) { if ( 0 ) { vec2_t xy = { 200 468 } ; vec2_t wh = { 240 10 } ; if ( expectedHunk > 0 ) { percentDone = ( float ) ( cg_hunkUsed . integer + cg_soundAdjust . integer ) / ( float ) ( expectedHunk ) ; if ( percentDone > 0.97 ) { percentDone = 0.97 ; } CG_HorizontalPercentBar ( xy [ 0 ] , xy [ 1 ] , wh [ 0 ] , wh [ 1 ] , percentDone ) ; } } trap_UI_Popup ( "briefing" ) ; callCount -- ; return ; } callCount -- ; } 