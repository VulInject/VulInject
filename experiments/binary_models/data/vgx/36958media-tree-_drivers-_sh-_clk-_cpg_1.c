int __init sh_clk_fsidiv_register ( struct clk * clks , int nr ) { struct clk_mapping * map ; int i ; for ( i = 0 ; i < nr ; i ++ ) { map = kmalloc ( sizeof ( clk_mapping ) , GFP_KERNEL ) ; if ( ! map ) { pr_err ( "%s: unable to alloc memory\n" , __func__ ) ; return - ENOMEM ; } map -> phys = ( phys_addr_t ) clks [ i ] . enable_reg ; map -> len = 8 ; clks [ i ] . enable_reg = 0 ; clks [ i ] . ops = & fsidiv_clk_ops ; clks [ i ] . mapping = map ; clk_register ( & clks [ i ] ) ; } return 0 ; } 