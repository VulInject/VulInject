static VOID FUN1 (PVOID VAR1)
{
VAR2 *VAR3 = (VAR2 *) VAR1;
PLIST_ENTRY VAR4;
VAR5 *VAR6;

LARGE_INTEGER VAR7;
ULONG VAR8;
PUCHAR VAR9 = VAR3->VAR10;
PUCHAR VAR11;
VAR12 *VAR13;
uint64 VAR14;
uint32 VAR15;
ULONGLONG VAR16;
HRESULT VAR17;

if (FUN2())
FUN3 (FUN4(), VAR18);

while (!VAR3->VAR19)
{
if (!FUN5 (FUN6 (&VAR3->VAR20, VAR21, VAR22, VAR23, NULL)))
continue;

while ((VAR4 = FUN7 (&VAR3->VAR24, &VAR3->VAR25)))
{
PIRP VAR26 = FUN8 (VAR4, VAR27, VAR28.VAR29.VAR30);
PIO_STACK_LOCATION VAR31 = FUN9 (VAR26);

if (VAR3->VAR32)
FUN6 (&VAR3->VAR33, VAR21, VAR22, VAR23, NULL);

VAR6 = FUN10 (VAR3, sizeof (VAR5));
if (!VAR6)
{
FUN11 (VAR26, VAR34, 0);
FUN12 (VAR3);
FUN13 (&VAR3->VAR35, VAR26);

continue;
}

VAR6->VAR36 = VAR3;
VAR6->VAR37 = VAR26;
VAR6->VAR38 = VAR39;

FUN14 (VAR26, NULL);
if (VAR26->VAR40)
{
FUN15 (VAR6, VAR41, 0);
continue;
}

switch (VAR31->VAR42)
{
case VAR43:
VAR6->VAR44 = VAR23;
VAR6->VAR45 = VAR31->VAR46.VAR47.VAR48;
VAR6->VAR49 = VAR31->VAR46.VAR47.VAR50;
break;

case VAR51:
VAR6->VAR44 = VAR52;
VAR6->VAR45 = VAR31->VAR46.VAR44.VAR48;
VAR6->VAR49 = VAR31->VAR46.VAR44.VAR50;
break;

default:
FUN15 (VAR6, VAR53, 0);
continue;
}

VAR6->VAR54 = VAR6->VAR45;


if (VAR3->VAR55
&& !VAR6->VAR44
&& VAR6->VAR49 > 0
&& (VAR6->VAR49 & (VAR56 - 1)) == 0
&& (VAR6->VAR45.VAR57 & (VAR56 - 1)) != 0)
{
VAR58 *VAR59;
ULONG VAR60;
LARGE_INTEGER VAR61;
VAR17 = FUN16(VAR6->VAR49, VAR56, &VAR60);
if (VAR17 != VAR62)
{
FUN15 (VAR6, VAR53, 0);
continue;
}

VAR61.VAR57 = VAR6->VAR45.VAR57 & ~((VAR63) VAR56 - 1);

VAR59 = FUN17 (VAR60);
if (!VAR59)
{
FUN15 (VAR6, VAR34, 0);
continue;
}

VAR6->VAR38 = FUN18 (VAR3->VAR64, VAR59, VAR61, VAR60);

if (FUN5 (VAR6->VAR38))
{
UINT64_STRUCT VAR65;

VAR11 = (VAR66) FUN19 (VAR26->VAR67, (VAR68 | VAR69));
if (!VAR11)
{
FUN20 (VAR59);
FUN15 (VAR6, VAR34, 0);
continue;
}

if (VAR3->VAR70 != -1 && VAR3->VAR71 != -1)
{
FUN21 (VAR61.VAR57, VAR60, VAR3->VAR70, VAR3->VAR71, &VAR14, &VAR15);
if (VAR15 > 0)
{
VAR65.VAR72 = VAR14 / VAR56;
FUN22 (VAR59 + (VAR14 - VAR61.VAR57), &VAR65, VAR15 / VAR56, VAR3->VAR73);
}
}

if((VAR3->VAR74 != NULL) && (VAR3->VAR75 > 512)) {
FUN23(VAR59, VAR3->VAR74, VAR61.VAR57, VAR60, VAR52);
}

memcpy (VAR11, VAR59 + (VAR6->VAR45.VAR76 & (VAR56 - 1)), VAR6->VAR49);
}

FUN20 (VAR59);
FUN15 (VAR6, VAR6->VAR38, FUN5 (VAR6->VAR38) ? VAR6->VAR49 : 0);
continue;
}


if (VAR6->VAR49 == 0
|| (VAR6->VAR49 & (VAR56 - 1)) != 0
|| (VAR6->VAR45.VAR57 & (VAR56 - 1)) != 0
|| (	!VAR3->VAR55 &&
(	(VAR62 != FUN24(VAR6->VAR45.VAR57, VAR6->VAR49, &VAR16))
||	(VAR16 > (VAR77) VAR3->VAR78)
)
)
)
{
FUN15 (VAR6, VAR53, 0);
continue;
}

FUN25 ("", VAR6->VAR45.VAR57, FUN26 (&VAR3->VAR79), VAR6->VAR44 ? '' : '', VAR6->VAR49);

if (!VAR3->VAR55)
{

if (VAR3->VAR73->VAR80)
VAR17 = FUN24(VAR6->VAR45.VAR57, VAR3->VAR73->VAR81, &VAR16);
else
VAR17 = FUN24(VAR6->VAR45.VAR57, VAR3->VAR73->VAR82, &VAR16);

if (VAR17 != VAR62)
{
FUN15 (VAR6, VAR53, 0);
continue;
}
else
VAR6->VAR45.VAR57 = VAR16;


if (VAR6->VAR44 && VAR3->VAR73->VAR83)
{


if (VAR3->VAR73->VAR84)
{



FUN15 (VAR6, VAR53, 0);
continue;
}


if (FUN27 ((unsigned __int64) VAR6->VAR45.VAR57,
(unsigned __int64) VAR6->VAR45.VAR57 + VAR6->VAR49 - 1,
VAR3->VAR73->VAR81,
(unsigned __int64) VAR3->VAR73->VAR81 + VAR3->VAR73->VAR85 - 1))
{
FUN25 ("", VAR6->VAR45.VAR57, VAR6->VAR45.VAR57 + VAR6->VAR49 - 1, VAR3->VAR73->VAR81, VAR3->VAR73->VAR81 + VAR3->VAR73->VAR85 - 1);
VAR3->VAR73->VAR84 = VAR52;


FUN15 (VAR6, VAR53, 0);
continue;
}
}
}
else if (VAR6->VAR44
&& FUN27 (VAR6->VAR45.VAR57, VAR6->VAR45.VAR57 + VAR6->VAR49 - 1, VAR86, VAR86 + VAR87 - 1))
{

FUN25 ("");
FUN15 (VAR6, VAR88, 0);
continue;
}
else if (VAR6->VAR44 && FUN28()
&& (FUN27 (VAR6->VAR45.VAR57, VAR6->VAR45.VAR57 + VAR6->VAR49 - 1, VAR89, VAR90 * VAR89 - 1)
|| FUN27 (VAR6->VAR45.VAR57, VAR6->VAR45.VAR57 + VAR6->VAR49 - 1, FUN29(), VAR91)))
{
FUN25 ("");
FUN15 (VAR6, VAR88, 0);
continue;
} 
else if (VAR6->VAR44
&& (VAR3->VAR74 != NULL) && (VAR3->VAR75 > 512)
&& FUN23 (NULL, VAR3->VAR74, VAR6->VAR45.VAR57, (VAR92)(VAR6->VAR45.VAR57 + VAR6->VAR49 - 1), VAR23))
{

FUN25 ("");
FUN15 (VAR6, VAR88, 0);
continue;
}

VAR11 = (VAR66) FUN19 (VAR26->VAR67, (VAR68 | VAR69));

if (VAR11 == NULL)
{
FUN15 (VAR6, VAR34, 0);
continue;
}



VAR8 = VAR6->VAR49;
VAR7 = VAR6->VAR45;

while (VAR8 > 0)
{
ULONG VAR93 = VAR3->VAR94;
BOOL VAR95 = VAR8 <= VAR93;

ULONG VAR96 = VAR95 ? VAR8 : VAR93;
VAR9 = (VAR9 == VAR3->VAR10 ? VAR3->VAR97 : VAR3->VAR10);

FUN30 (&VAR3->VAR98);


VAR13 = FUN10 (VAR3, sizeof (VAR12));
if (!VAR13)
{
FUN15 (VAR6, VAR34, 0);
break;
}
VAR13->VAR99 = VAR6;
VAR13->VAR100 = VAR95;
VAR13->VAR101 = VAR7;
VAR13->VAR102 = VAR9;
VAR13->VAR103 = VAR11;
VAR13->VAR50 = VAR96;

if (VAR3->VAR55)
{
if (VAR3->VAR70 == -1 || VAR3->VAR71 == -1)
{
VAR13->VAR104 = 0;
}
else
{

FUN21 (VAR7.VAR57, VAR96, VAR3->VAR70, VAR3->VAR71, &VAR14, &VAR15);

VAR13->VAR105 = VAR14 - VAR7.VAR57;
VAR13->VAR104 = VAR15;
}
}
else
{
VAR13->VAR105 = 0;
VAR13->VAR104 = VAR96;
}

FUN31 (VAR3, VAR9);

if (VAR6->VAR44)
{

memcpy (VAR9, VAR11, VAR96);

if (VAR13->VAR104 > 0)
{
UINT64_STRUCT VAR65;
FUN32 (VAR13->VAR105 + VAR13->VAR104 <= VAR13->VAR101.VAR57 + VAR13->VAR50);

VAR65.VAR72 = (VAR13->VAR101.VAR57 + VAR13->VAR105) / VAR56;

if (VAR3->VAR73->VAR106)
VAR65.VAR72 += VAR3->VAR73->VAR107.VAR72;
else if (VAR3->VAR108)
VAR65.VAR72 += VAR3->VAR109;

FUN33 (VAR9 + VAR13->VAR105, &VAR65, VAR13->VAR104 / VAR56, VAR3->VAR73);
}
}


FUN34 (&VAR3->VAR110, &VAR13->VAR30, &VAR3->VAR111);
FUN35 (&VAR3->VAR112, VAR113, VAR23);

if (VAR95)
break;

VAR8 -= VAR93;
VAR11 += VAR93;
VAR7.VAR57 += VAR93;
}
}
}

FUN36 (VAR39);
}