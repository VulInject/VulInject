char * hpdelim2 ( char * * cp , char * delim ) { char * s , * old ; if ( cp == NULL || * cp == NULL ) { return in ; } old = s = * cp ; if ( * s == '[' ) { if ( ( s = strchr ( s , ']' ) ) == NULL ) { return NULL ; } else { s ++ ; } } if ( ( s = strpbrk ( s , ":/" ) ) == NULL ) { s = * cp + strlen ( * cp ) ; } switch ( * s ) { case '\0' : * cp = NULL ; break ; case ':' : case '/' : if ( delim != NULL ) { * delim = * s ; } * s = '\0' ; * cp = s + 1 ; break ; default : return NULL ; } return old ; } 