FT_BASE_DEF ( ) FT_Stream_OpenMemory ( , , ) { stream -> base = ( FT_Byte * ) base ; stream -> size = size ; stream -> pos = 0 ; stream -> cursor = NULL ; stream -> close = NULL ; } FT_BASE_DEF ( ) FT_Stream_Close ( ) { if ( stream && stream -> close ) { stream -> close ( stream ) ; } } FT_BASE_DEF ( ) FT_Stream_Seek ( , ) { FT_Error error = FT_Err_Ok ; if ( stream -> read ) { if ( stream -> read ( stream , pos , 0 , 0 ) ) { FT_ERROR ( ( "FT_Stream_Seek:" " invalid i/o; pos = 0x%lx, size = 0x%lx\n" , pos , stream -> size ) ) ; error = FT_THROW ( Invalid_Stream_Operation ) ; } } if ( pos > stream -> size ) { FT_ERROR ( ( "FT_Stream_Seek:" " invalid i/o; pos = 0x%lx, size = 0x%lx\n" , pos , stream -> size ) ) ; error = FT_THROW ( Invalid_Stream_Operation ) ; } if ( ! error ) { stream -> pos = pos ; } return error ; } FT_BASE_DEF ( ) FT_Stream_Skip ( , ) { if ( distance < 0 ) { return FT_THROW ( Invalid_Stream_Operation ) ; } return FT_Stream_Seek ( stream , stream -> pos + ( FT_ULong ) distance ) ; } FT_BASE_DEF ( ) FT_Stream_Pos ( ) { return stream -> pos ; } FT_BASE_DEF ( ) FT_Stream_Read ( , , ) { return FT_Stream_ReadAt ( stream , stream -> pos , buffer , count ) ; } FT_BASE_DEF ( ) FT_Stream_ReadAt ( , , , ) { FT_Error error = FT_Err_Ok ; FT_ULong read_bytes ; if ( pos >= stream -> size ) { FT_ERROR ( "FT_Stream_ReadAt:" " invalid i/o; pos = 0x%lx, size = 0x%lx\n" ) } } 