int ep_pcmcia_activate ( struct device * dev , int act ) { struct ep_pcmcia_softc * sc = ( ep_pcmcia_softc * ) dev ; struct ep_softc * esc = & sc -> sc_ep ; struct ifnet * ifp = & esc -> sc_arpcom . ac_if ; switch ( act ) { case DVACT_SUSPEND : ifp -> if_timer = 0 ; if ( ifp -> if_flags & IFF_RUNNING ) { epstop ( esc ) ; } if ( sc -> sc_ep . sc_ih ) { pcmcia_intr_disestablish ( sc -> sc_pf , sc -> sc_ep . sc_ih ) ; } sc -> sc_ep . sc_ih = NULL ; pcmcia_function_disable ( sc -> sc_pf , NULL ) ; break ; case DVACT_RESUME : pcmcia_function_enable ( sc -> sc_pf ) ; sc -> sc_ep . sc_ih = pcmcia_intr_establish ( sc -> sc_pf , IPL_NET , epintr , sc , esc -> sc_dev . dv_xname ) ; if ( ifp -> if_flags & IFF_UP ) { epinit ( esc ) ; } break ; case DVACT_DEACTIVATE : if ( sc -> sc_ep . sc_ih ) { pcmcia_intr_disestablish ( sc -> sc_pf , sc -> sc_ep . sc_ih ) ; } sc -> sc_ep . sc_ih = NULL ; pcmcia_function_disable ( sc -> sc_pf ) ; break ; } return ( 0 ) ; } 