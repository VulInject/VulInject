MagickExport MagickBooleanType ListPolicyInfo ( FILE * file , ExceptionInfo * exception ) { const char * path , * domain ; const PolicyInfo * * policy_info ; ssize_t i ; size_t number_policies ; if ( file == ( const FILE * ) NULL ) { file = stdout ; } policy_info = GetPolicyInfoList ( "*" , & number_policies , exception ) ; if ( policy_info == ( const PolicyInfo * * ) NULL ) { return ( MagickFalse ) ; } path = ( const char * ) NULL ; for ( i = 0 ; i < ( ssize_t ) number_policies ; i ++ ) { if ( ( ( path == ( const char * ) NULL ) || ( LocaleCompare ( path , policy_info [ i ] -> path ) != 0 ) ) && ( policy_info [ i ] -> path != ( char * ) NULL ) ) { ( void ) FormatLocaleFile ( file , "\nPath: %s\n" , policy_info [ i ] -> path ) ; } path = policy_info [ i ] -> path ; domain = CommandOptionToMnemonic ( MagickPolicyDomainOptions , policy_info [ i ] -> domain ) ; ( void ) FormatLocaleFile ( file , "  Policy: %s\n" , domain ) ; if ( ( policy_info [ i ] -> domain == CachePolicyDomain ) || ( policy_info [ i ] -> domain == ResourcePolicyDomain ) || ( policy_info [ i ] -> domain == SystemPolicyDomain ) ) { if ( policy_info [ i ] -> name != ( char * ) NULL ) { ( void ) FormatLocaleFile ( file , "    name: %s\n" , policy_info [ i ] -> name ) ; } if ( policy_info [ i ] -> value != ( char * ) NULL ) { ( void ) FormatLocaleFile ( file , "    value: %s\n" , policy_info [ i ] -> value ) ; } } else { ( void ) FormatLocaleFile ( file , "    rights: " ) ; if ( policy_info [ i ] -> rights == NoPolicyRights ) { ( void ) FormatLocaleFile ( file , "None " ) ; } if ( ( policy_info [ i ] -> rights & ReadPolicyRights ) != 0 ) { ( void ) FormatLocaleFile ( file , "Read " ) ; } if ( ( policy_info [ i ] -> rights & WritePolicyRights ) != 0 ) { ( void ) FormatLocaleFile ( file , "Write " ) ; } if ( ( policy_info [ i ] -> rights & ExecutePolicyRights ) != 0 ) { ( void ) FormatLocaleFile ( file , "Execute " ) ; } ( void ) FormatLocaleFile ( file , "\n" ) ; if ( policy_info [ i ] -> pattern != ( char * ) NULL ) { ( void ) FormatLocaleFile ( file , "    pattern: %s\n" , policy_info [ i ] -> pattern ) ; } } } policy_info = ( const PolicyInfo * * ) RelinquishMagickMemory ( ( void * ) policy_info ) ; ( void ) fflush ( file ) ; return ( MagickTrue ) ; } 