static void bfin_sir_init_ports ( struct bfin_sir_port * sp , struct platform_device * pdev ) { int i ; struct resource * res ; for ( i = 0 ; i < pdev -> num_resources ; i ++ ) { res = & pdev -> resource [ i ] ; switch ( res -> flags ) { case IORESOURCE_MEM : sp -> membase = ( void __iomem * ) res -> start ; break ; case IORESOURCE_IRQ : sp -> irq = res -> start ; break ; case IORESOURCE_DMA : sp -> rx_dma_channel = res -> start ; sp -> tx_dma_channel = res -> end ; break ; default : break ; } } sp -> clk = get_sclk ( ) ; init_timer ( & ( sp -> rx_dma_timer ) ) ; } 