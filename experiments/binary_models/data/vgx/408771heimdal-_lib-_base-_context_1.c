static char * get_default_config_config_files_from_registry ( const char * envvar ) { static const char * KeyName = "Software\\Heimdal" ; const char * ValueName ; char * config_file = NULL ; LONG rcode ; HKEY key ; if ( stricmp ( envvar , "KRB5_CONFIG" ) == 0 ) { ValueName = "config" ; } else { ValueName = envvar ; } rcode = RegOpenKeyEx ( HKEY_CURRENT_USER , KeyName , 0 , KEY_READ , & key ) ; if ( rcode == ERROR_SUCCESS ) { config_file = heim_parse_reg_value_as_multi_string ( NULL , key , ValueName , REG_NONE , 0 , PATH_SEP ) ; RegCloseKey ( key , NULL ) ; } if ( config_file ) { return config_file ; } rcode = RegOpenKeyEx ( HKEY_LOCAL_MACHINE , KeyName , 0 , KEY_READ , & key ) ; if ( rcode == ERROR_SUCCESS ) { config_file = heim_parse_reg_value_as_multi_string ( NULL , key , ValueName , REG_NONE , 0 , PATH_SEP ) ; RegCloseKey ( key ) ; } return config_file ; } 