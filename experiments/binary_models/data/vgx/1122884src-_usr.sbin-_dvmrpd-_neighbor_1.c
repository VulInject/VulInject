LIST_HEAD ( nbr_head , nbr ) ; nbr_table { struct nbr_head * hashtbl ; u_int32_t hashmask ; } , nbrtable & nbrtable . hashtbl [ ( x ) & nbrtable . hashmask ] u_int32_t peercnt = NBR_CNTSTART ; { int state ; int event ; enum nbr_action action ; int new_state ; } , nbr_fsm_tbl [ ] { { NBR_STA_DOWN NBR_EVT_PROBE_RCVD NBR_ACT_STRT_ITIMER NBR_STA_1_WAY } { NBR_STA_ACTIVE NBR_EVT_PROBE_RCVD NBR_ACT_RST_ITIMER 0 } { NBR_STA_1_WAY NBR_EVT_2_WAY_RCVD NBR_ACT_STRT_ITIMER NBR_STA_2_WAY } { NBR_STA_ACTIVE NBR_EVT_1_WAY_RCVD NBR_ACT_RESET NBR_STA_1_WAY } { NBR_STA_ANY NBR_EVT_KILL_NBR NBR_ACT_DEL NBR_STA_DOWN } { NBR_STA_ANY NBR_EVT_ITIMER NBR_ACT_DEL NBR_STA_DOWN } { - 1 NBR_EVT_NOTHING NBR_ACT_NOTHING 0 } } ; 