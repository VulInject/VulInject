static int mipid02_set_power_on ( struct mipid02_dev * bridge ) { struct i2c_client * client = bridge -> i2c_client ; int ret ; ret = clk_prepare_enable ( bridge -> xclk ) ; if ( ret ) { dev_err ( & client -> dev , "%s: failed to enable clock\n" , __func__ ) ; return ret ; } ret = regulator_bulk_enable ( MIPID02_NUM_SUPPLIES , bridge -> supplies ) ; if ( ret ) { dev_err ( & client -> dev , "%s: failed to enable regulators\n" , __func__ ) ; xclk_off } if ( bridge -> reset_gpio ) { dev_dbg ( & client -> dev , "apply reset" ) ; mipid02_apply_reset ( bridge ) ; } else { dev_dbg ( & client -> dev , "don't apply reset" ) ; usleep_range ( 5000 , 10000 ) ; } return 0 ; xclk_off clk_disable_unprepare ( bridge -> xclk , NULL ) ; return ret ; } 