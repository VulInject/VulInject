static TEE_Result check_install_conflict ( const struct shdr_bootstrap_ta * bs_ta ) { TEE_Result res ; struct tee_tadb_ta_read * ta ; TEE_UUID uuid ; const struct tee_tadb_property * prop ; tee_uuid_from_octets ( & uuid , bs_ta -> uuid ) ; res = tee_tadb_ta_open ( & uuid , & ta ) ; if ( res == TEE_ERROR_ITEM_NOT_FOUND ) { return TEE_SUCCESS ; } if ( res ) { return res ; } prop = tee_tadb_ta_get_property ( ta ) ; if ( prop -> version > bs_ta -> ta_version ) { res = TEE_ERROR_ACCESS_CONFLICT ; } tee_tadb_ta_close ( ta , NULL ) ; return res ; } 