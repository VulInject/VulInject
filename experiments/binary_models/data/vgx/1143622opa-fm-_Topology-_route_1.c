static PortData * LookupRoute ( NodeData * nodep , STL_LID dlid , PortData * inportp , int vl , int sc , int rc ) { uint8 portNum = 0xff ; PortData * portp ; DEBUG_ASSERT ( nodep -> switchp ) ; if ( ! dlid ) { return NULL ; } if ( nodep -> pSwitchInfo -> SwitchInfoData . RoutingMode . Enabled == STL_ROUTE_LINEAR ) { DEBUG_ASSERT ( nodep -> switchp -> LinearFDB ) ; if ( dlid >= nodep -> switchp -> LinearFDBSize ) { return in ; } portNum = STL_LFT_PORT_BLOCK ( nodep -> switchp -> LinearFDB , dlid ) ; } if ( portNum == 0xff ) { return NULL ; } portp = FindNodePort ( nodep , portNum ) ; if ( ! portp || ! IsPortInitialized ( portp -> PortInfo . PortStates ) || ( portNum != 0 && ! portp -> neighbor ) ) { return NULL ; } return portp ; } 