static nss_status_t getbynet ( ldap_backend_ptr be , void * a ) { nss_XbyY_args_t * argp = ( nss_XbyY_args_t * ) a ; char searchfilter [ SEARCHFILTERLEN ] ; char userdata [ SEARCHFILTERLEN ] ; char netnumber [ SEARCHFILTERLEN ] ; int ret ; if ( _ldap_filter_name ( netnumber , argp -> key . name , sizeof ( netnumber ) ) != 0 ) { return ( ( nss_status_t ) NSS_NOTFOUND ) ; } ret = snprintf ( searchfilter , sizeof ( searchfilter ) , _F_GETMASKBYNET , netnumber ) ; ret = snprintf ( userdata , sizeof ( userdata ) , _F_GETMASKBYNET_SSD , netnumber ) ; if ( ret >= sizeof ( userdata ) || ret < 0 ) { return ( ( nss_status_t ) NSS_NOTFOUND ) ; } return ( ( nss_status_t ) _nss_ldap_lookup ( be , argp , _NETMASKS , searchfilter , NULL , _merge_SSD_filter , userdata ) ) ; } 