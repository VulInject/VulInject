struct dst_entry * cxgb_find_route ( cxgb4_lld_info * lldi , net_device * * get_real_dev ( net_device * ) , __be32 local_ip , __be32 peer_ip , __be16 local_port , __be16 peer_port , u8 tos ) ( rtable * rt , flowi4 fl4 , neighbour * n , rt = ip_route_output_ports ( & init_net , & fl4 , NULL , peer_ip , local_ip , peer_port , local_port , IPPROTO_TCP , tos , 0 ) , ( IS_ERR ( rt ) ) return NULL ; ) ; n = dst_neigh_lookup ( & rt -> dst , & peer_ip ) ; if ( ! n ) { return NULL ; } if ( ! cxgb_our_interface ( lldi , get_real_dev , n -> dev ) && ! ( n -> dev -> flags & IFF_LOOPBACK ) ) { dst_release ( & rt -> dst ) ; return NULL ; } neigh_release ( n ) ; return & rt -> dst ; 