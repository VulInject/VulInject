struct device * nd_pfn_devinit ( struct nd_pfn * nd_pfn , struct nd_namespace_common * ndns ) { struct device * dev ; if ( ! nd_pfn ) { return in ; } nd_pfn -> mode = PFN_MODE_NONE ; nd_pfn -> align = nd_pfn_default_alignment ( ) ; dev = & nd_pfn -> dev ; device_initialize ( & nd_pfn -> dev ) ; lockdep_set_class ( & nd_pfn -> dev . mutex , & nvdimm_pfn_key ) ; if ( ndns && ! __nd_attach_ndns ( & nd_pfn -> dev , ndns , & nd_pfn -> ndns ) ) { dev_dbg ( & ndns -> dev , "failed, already claimed by %s\n" , dev_name ( ndns -> claim ) ) ; put_device ( dev ) ; return NULL ; } return dev ; } 