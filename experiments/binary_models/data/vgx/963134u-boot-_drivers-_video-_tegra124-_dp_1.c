static int tegra_dc_dp_explore_link_cfg ( struct tegra_dp_priv * dp , struct tegra_dp_link_config * link_cfg , struct udevice * sor , const struct display_timing * timing ) { struct tegra_dp_link_config temp_cfg ; if ( ! timing -> pixelclock . typ || ! timing -> hactive . typ || ! timing -> vactive . typ ) { debug ( "dp: error mode configuration" ) ; return - EINVAL ; } if ( ! link_cfg -> max_link_bw || ! link_cfg -> max_lane_count ) { debug ( "dp: error link configuration" ) ; return - EINVAL ; } memcpy ( & temp_cfg , link_cfg , sizeof ( temp_cfg ) ) ; temp_cfg . link_bw = temp_cfg . max_link_bw ; temp_cfg . lane_count = temp_cfg . max_lane_count ; if ( ( ! tegra_dc_dp_calc_config ( dp , timing , & temp_cfg ) ) && ( ! tegra_dp_link_config ( dp , & temp_cfg ) ) && ( ! tegra_dp_do_link_training ( dp , & temp_cfg , timing , sor ) ) ) { memcpy ( link_cfg , & temp_cfg , sizeof ( temp_cfg ) ) ; } return link_cfg -> is_valid ?0 : - EFAULT ; } 