int ssl_reinit ( int sig ) { SSL_CTX * temp_ctx ; if ( 1 == sig ) { sendto_opmask_butone ( 0 , SNO_OLDSNO , "Got signal SIGUSR1, reloading SSL certificates" ) ; } temp_ctx = ssl_init_server_ctx ( ) ; if ( ! temp_ctx ) { return - 1 ; } SSL_CTX_free ( temp_ctx ) ; SSL_CTX_free ( ssl_server_ctx ) ; ssl_server_ctx = ssl_init_server_ctx ( ) ; temp_ctx = ssl_init_client_ctx ( ) ; if ( ! temp_ctx ) { return - 1 ; } SSL_CTX_free ( temp_ctx ) ; ssl_client_ctx = ssl_init_client_ctx ( ) ; return 0 ; } 