void pciauto_config_init ( struct pci_controller * hose ) { int i ; hose -> pci_io = NULL ; hose -> pci_mem = NULL ; for ( i = 0 ; i < hose -> region_count ; i ++ ) { switch ( hose -> regions [ i ] . flags ) { case PCI_REGION_IO : if ( ! hose -> pci_io || hose -> pci_io -> size < hose -> regions [ i ] . size ) { hose -> pci_io = hose -> regions + i ; } break ; case PCI_REGION_MEM : if ( ! hose -> pci_mem || hose -> pci_mem -> size < hose -> regions [ i ] . size ) { hose -> pci_mem = hose -> regions + i ; } break ; case ( PCI_REGION_MEM | PCI_REGION_PREFETCH ) : if ( ! hose -> pci_prefetch || hose -> pci_prefetch -> size < hose -> regions [ i ] . size ) { hose -> pci_prefetch = hose -> regions + i ; } break ; } } if ( hose -> pci_mem ) { pciauto_show_region ( "Memory" , hose -> pci_mem ) ; } if ( hose -> pci_prefetch ) { pciauto_show_region ( "Prefetchable Mem" , hose -> pci_prefetch ) ; } if ( hose -> pci_io ) { pciauto_show_region ( "I/O" , hose -> pci_io ) ; } } 