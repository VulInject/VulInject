static krb5_error_code FUN1 ( krb5_context VAR1 , pkinit_plg_crypto_context VAR2 , pkinit_req_crypto_context VAR3 , VAR4 * VAR5 , pkinit_identity_crypto_context VAR6 , krb5_principal VAR7 ) { krb5_error_code VAR8 = VAR9 ; VAR10 * VAR11 = NULL ; struct VAR12 * VAR13 = NULL ; char VAR14 [ 1024 ] ; char VAR15 [ 1024 ] ; int VAR16 = 0 , VAR17 ; char * VAR18 , * VAR19 ; if ( VAR5 -> VAR20 == NULL ) { FUN2 ( VAR1 ) ; return VAR21 ; } VAR18 = VAR5 -> VAR20 ; VAR11 = FUN3 ( VAR18 ) ; if ( VAR11 == NULL ) { return VAR22 ; } while ( ( VAR16 < VAR23 ) && ( VAR13 = FUN4 ( VAR11 ) ) != NULL ) { if ( VAR13 -> VAR24 == VAR25 ) { continue ; } if ( VAR13 -> VAR26 [ 0 ] == '' ) { continue ; } VAR17 = strlen ( VAR13 -> VAR26 ) ; if ( VAR17 < 5 ) { continue ; } VAR19 = VAR13 -> VAR26 + ( VAR17 - 4 ) ; if ( FUN5 ( VAR19 , "" , 4 ) != 0 ) { continue ; } if ( strlen ( VAR18 ) + strlen ( VAR13 -> VAR26 ) + 2 > sizeof ( VAR14 ) ) { FUN6 ( "" , VAR27 , VAR18 , VAR13 -> VAR26 ) ; continue ; } snprintf ( VAR14 , sizeof ( VAR14 ) , "" , VAR18 , VAR13 -> VAR26 ) ; snprintf ( VAR15 , sizeof ( VAR15 ) , "" , VAR18 , VAR13 -> VAR26 ) ; VAR17 = strlen ( VAR15 , NULL ) ; VAR15 [ VAR17 - 3 ] = '' ; VAR15 [ VAR17 - 2 ] = '' ; VAR15 [ VAR17 - 1 ] = '' ; VAR8 = FUN7 ( VAR1 , VAR6 , VAR14 , VAR15 , VAR16 ) ; if ( VAR8 == 0 ) { FUN8 ( VAR1 , VAR13 -> VAR26 ) ; VAR16 ++ ; } else { continue ; } } if ( ! VAR6 -> VAR28 && VAR16 == 0 ) { FUN9 ( VAR1 , VAR5 -> VAR20 ) ; VAR8 = VAR21 ; VAR29 } VAR8 = 0 ; cleanup if ( VAR11 ) { FUN10 ( VAR11 ) ; } return VAR8 ; }