static int FUN1 ( struct VAR1 * VAR2 , struct VAR3 * VAR4 , const unsigned char * VAR5 , unsigned VAR6 ) { u8 VAR7 , VAR8 ; unsigned VAR9 , VAR10 ; char * * VAR11 , * VAR12 ; VAR7 = VAR5 [ 0 ] ; VAR8 = VAR5 [ 1 ] ; VAR5 += 2 ; VAR6 -= 2 ; VAR10 = 0 ; for ( VAR9 = 0 ; VAR9 < VAR6 ; VAR9 ++ ) { if ( VAR5 [ VAR9 ] == 0xff ) { break ; } if ( VAR5 [ VAR9 ] == 0 ) { VAR10 ++ ; } } if ( VAR10 == 0 ) { return 0 ; } VAR6 = VAR9 ; VAR11 = FUN2 ( sizeof ( char * ) * VAR10 + VAR6 , VAR13 ) ; if ( ! VAR11 ) { return - VAR14 ; } VAR12 = ( char * ) ( VAR11 + VAR10 ) ; for ( VAR9 = 0 ; VAR9 < VAR10 ; VAR9 ++ ) { VAR11 [ VAR9 ] = VAR12 ; strcpy ( VAR12 , VAR5 ) ; VAR12 += strlen ( VAR12 ) + 1 ; VAR5 += strlen ( VAR5 ) + 1 ; } if ( VAR4 ) { VAR4 -> VAR7 = VAR7 ; VAR4 -> VAR8 = VAR8 ; VAR4 -> VAR15 = VAR10 ; VAR4 -> VAR16 = ( const char * * ) VAR11 ; } else { VAR2 -> VAR7 = VAR7 ; VAR2 -> VAR8 = VAR8 ; VAR2 -> VAR15 = VAR10 ; VAR2 -> VAR16 = ( const char * * ) VAR11 ; } return 0 ; }