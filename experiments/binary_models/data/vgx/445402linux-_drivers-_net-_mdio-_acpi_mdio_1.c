MODULE_AUTHOR ( "Calvin Johnson<calvin.johnson@oss.nxp.com>" ) ; MODULE_LICENSE ( "GPL" ) ; int acpi_mdiobus_register ( struct mii_bus * mdio , struct fwnode_handle * fwnode ) { struct fwnode_handle * child ; u32 addr ; int ret ; mdio -> phy_mask = GENMASK ( 31 , 0 ) ; ret = mdiobus_register ( mdio ) ; ACPI_COMPANION_SET ( & mdio -> dev , to_acpi_device_node ( fwnode ) ) ; fwnode_for_each_child_node ( , ) { ret = acpi_get_local_address ( ACPI_HANDLE_FWNODE ( child ) , & addr ) ; if ( ret || addr >= PHY_MAX_ADDR ) { continue ; } ret = fwnode_mdiobus_register_phy ( mdio , child , addr ) ; if ( ret == - ENODEV ) { dev_err ( & mdio -> dev , "MDIO device at address %d is missing.\n" , addr ) ; } } return 0 ; } 