R_API void r_run_reset ( RRunProfile * p ) { r_return_if_fail ( p ) ; int i ; for ( i = 0 ; i < R_RUN_PROFILE_NARGS ; i ++ ) { R_FREE ( p -> _args [ i ] ) ; } R_FREE ( p -> _system ) ; R_FREE ( p -> _program ) ; R_FREE ( p -> _runlib ) ; R_FREE ( p -> _runlib_fcn ) ; R_FREE ( p -> _stdio ) ; R_FREE ( p -> _stdin ) ; R_FREE ( p -> _stdout ) ; R_FREE ( p -> _stderr ) ; R_FREE ( p -> _chgdir ) ; R_FREE ( p -> _chroot ) ; R_FREE ( p -> _libpath ) ; R_FREE ( p -> _preload ) ; R_FREE ( p -> _pidfile ) ; R_FREE ( p -> _connect ) ; R_FREE ( p -> _listen ) ; R_FREE ( p -> _input ) ; R_FREE ( p -> _setuid , NULL ) ; R_FREE ( p -> _seteuid ) ; R_FREE ( p -> _setgid ) ; R_FREE ( p -> _setegid ) ; memset ( p , 0 , sizeof ( RRunProfile ) ) ; p -> _aslr = - 1 ; } 