static int mlxsw_linecard_device_fw_component_query ( struct mlxfw_dev * mlxfw_dev , u16 component_index , u32 * p_max_size , u8 * p_align_bits , u16 * p_max_write_size ) { struct mlxsw_linecard_device_fw_info * info = container_of ( mlxfw_dev , mlxsw_linecard_device_fw_info , mlxfw_dev ) ; struct mlxsw_linecard * linecard = info -> linecard ; struct mlxsw_core * mlxsw_core = info -> mlxsw_core ; char mddt_pl [ MLXSW_REG_MDDT_LEN ] ; char * mcqi_pl ; int err ; mlxsw_reg_mddt_pack ( mddt_pl , linecard -> slot_index , linecard -> device . index , MLXSW_REG_MDDT_METHOD_QUERY , MLXSW_REG ( mcqi ) , & mcqi_pl ) ; mlxsw_reg_mcqi_pack ( mcqi_pl , component_index ) ; err = mlxsw_reg_query ( mlxsw_core , MLXSW_REG ( mddt ) , mddt_pl ) ; mlxsw_reg_mcqi_unpack ( mcqi_pl , p_max_size , p_align_bits , p_max_write_size ) ; * p_align_bits = max_t ( u8 , * p_align_bits , 2 ) ; * p_max_write_size = min_t ( u16 , * p_max_write_size , MLXSW_REG_MCDA_MAX_DATA_LEN ) ; return 0 ; } 