static int wkup_m3_finish_low_power ( struct wkup_m3_ipc * m3_ipc ) { struct device * dev = m3_ipc -> dev ; int ret = 0 ; wkup_m3_ctrl_ipc_write ( m3_ipc , IPC_CMD_RESET , 1 ) ; wkup_m3_ctrl_ipc_write ( m3_ipc , DS_IPC_DEFAULT , 2 ) ; m3_ipc -> state = M3_STATE_MSG_FOR_RESET ; ret = wkup_m3_ping ( m3_ipc ) ; if ( ret ) { dev_err ( dev , "Unable to ping CM3\n" ) ; return ret ; } return 0 ; } 