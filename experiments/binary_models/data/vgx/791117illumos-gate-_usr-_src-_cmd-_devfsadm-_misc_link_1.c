DEVFSADM_CREATE_INIT_V0 ( misc_cbt ) ; static devfsadm_remove_t misc_remove_cbt [ ] { { "pseudo" "^profile$" RM_PRE | RM_ALWAYS ILEVEL_0 devfsadm_rm_all } { "pseudo" "^rsm$" RM_PRE | RM_ALWAYS ILEVEL_0 devfsadm_rm_all } { "printer" "^printers/[0-9]+$" RM_PRE | RM_HOT | RM_ALWAYS ILEVEL_0 devfsadm_rm_all } { "av" "^av/[0-9]+/(async|isoch)$" RM_PRE | RM_HOT | RM_ALWAYS ILEVEL_0 devfsadm_rm_all } { "pseudo" "^daplt$" RM_PRE | RM_ALWAYS ILEVEL_0 devfsadm_rm_all } { "pseudo" "^zcons/" ZONENAME_REGEXP "/(" ZCONS_MANAGER_NAME "|" ZCONS_SUBSIDIARY_NAME ")$" RM_PRE | RM_HOT | RM_ALWAYS ILEVEL_0 devfsadm_rm_all } { "pseudo" "^" CPUID_SELF_NAME "$" RM_ALWAYS | RM_PRE | RM_HOT ILEVEL_0 devfsadm_rm_all } { "enclosure" "^es/ses[0-9]+$" RM_POST ILEVEL_0 devfsadm_rm_all } { "pseudo" "^pfil$" RM_PRE | RM_ALWAYS ILEVEL_0 devfsadm_rm_all } { "pseudo" "^tpm$" RM_PRE | RM_ALWAYS ILEVEL_0 devfsadm_rm_all } { "pseudo" "^sctp|sctp6$" RM_PRE | RM_ALWAYS ILEVEL_0 devfsadm_rm_link } { "9p" "^9p/[0-9]+$" RM_PRE | RM_HOT | RM_ALWAYS ILEVEL_0 devfsadm_rm_all } } ; ; static devfsadm_enumerate_t gpio_rules [ 1 ] { "^gpio([0-9]+)$" 1 MATCH_ALL } ; ; DEVFSADM_REMOVE_INIT_V0 ( misc_remove_cbt ) ; static int display ( di_minor_t minor , di_node_t node ) { char l_path [ PATH_MAX + 1 ] , contents [ PATH_MAX + 1 ] , * buf ; devfsadm_enumerate_t rules [ 1 ] { "^fb([0-9]+)$" 1 MATCH_ALL } ; ; char * mn = di_minor_name ( minor ) ; ( void ) strcpy ( l_path , "fbs/" ) ; ( void ) strcat ( l_path , mn ) ; ( void ) devfsadm_mklink ( l_path , node , minor , 0 ) ; if ( devfsadm_enumerate_int ( l_path , 0 , & buf , rules , 1 ) ) { return ( DEVFSADM_CONTINUE ) ; } ( void ) strcpy ( contents , l_path ) ; ( void ) strcpy ( l_path , "fb" ) ; ( void ) strcat ( l_path , buf ) ; ( void ) devfsadm_secondary_link ( l_path , contents , 0 ) ; return ( DEVFSADM_CONTINUE ) ; } 