static inline krb5_error_code collect_pin ( krb5_context context , krb5_prompter_fct prompter , void * prompter_data , const krb5_otp_tokeninfo * ti , krb5_data * out_pin ) { krb5_error_code retval ; char otppin [ 1024 ] ; krb5_flags collect ; krb5_data pin ; collect = ti -> flags & ( KRB5_OTP_FLAG_COLLECT_PIN | KRB5_OTP_FLAG_SEPARATE_PIN ) ; if ( collect == 0 ) { * out_pin = empty_data ( ) ; return 0 ; } retval = doprompt ( context , prompter , prompter_data , NULL , _ ( "OTP Token PIN" ) , otppin , sizeof ( otppin ) ) ; if ( retval != 0 ) { return retval ; } pin = make_data ( strdup ( otppin ) , strlen ( otppin ) ) ; * out_pin = pin ; return 0 ; } 