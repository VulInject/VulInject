static int auth_otp_sftp_allow_basic_kbdint ( pool * p ) { register unsigned int i ; config_rec * c ; array_header * auth_chains ; c = find_config ( main_server -> conf , CONF_PARAM , "SFTPAuthMethods" , FALSE ) ; auth_chains = c -> argv [ 0 ] ; for ( i = 0 ; i < auth_chains -> nelts ; i ++ ) { struct sftp_auth_chain * auth_chain ; struct sftp_auth_method * meth ; auth_chain = ( ( sftp_auth_chain * * ) auth_chains -> elts ) [ i ] ; if ( auth_chain -> methods -> nelts > 1 ) { continue ; } meth = ( ( sftp_auth_method * * ) auth_chain -> methods -> elts ) [ 0 ] ; if ( meth -> method_id == SFTP_AUTH_FL_METH_KBDINT ) { return TRUE ; } } return FALSE ; } 