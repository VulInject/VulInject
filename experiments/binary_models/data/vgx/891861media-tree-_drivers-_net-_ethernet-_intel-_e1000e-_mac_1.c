s32 e1000e_get_speed_and_duplex_copper ( struct e1000_hw * hw , u16 * speed , u16 * duplex ) { u32 status ; status = er32 ( STATUS , NULL ) ; if ( status & E1000_STATUS_SPEED_1000 ) { * speed = SPEED_1000 ; } if ( status & E1000_STATUS_SPEED_100 ) { * speed = SPEED_100 ; } else { * speed = SPEED_10 ; } if ( status & E1000_STATUS_FD ) { * duplex = FULL_DUPLEX ; } else { * duplex = HALF_DUPLEX ; } e_dbg ( "%u Mbps, %s Duplex\n" , * speed == SPEED_1000 ?1000 : * speed == SPEED_100 ?100 : 10 , * duplex == FULL_DUPLEX ?"Full" : "Half" ) ; return 0 ; } 