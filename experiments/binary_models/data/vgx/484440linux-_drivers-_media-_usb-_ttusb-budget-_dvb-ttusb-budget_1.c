static int alps_tdmb7_tuner_set_params ( struct dvb_frontend * fe ) { struct dtv_frontend_properties * p = & fe -> dtv_property_cache ; struct ttusb * ttusb = ( ttusb * ) fe -> dvb -> priv ; u8 data [ 4 ] ; struct i2c_msg msg = { . addr = 0x61 . flags = 0 . buf = data . len = ( data ) } ; u32 div ; div = ( p -> frequency + 36166667 ) / 166667 ; data [ 0 ] = ( div >> 8 ) & 0x7f ; data [ 1 ] = div & 0xff ; data [ 2 ] = ( ( div >> 10 ) & 0x60 ) | 0x85 ; data [ 3 ] = p -> frequency < 592000000 ?0x40 : 0x80 ; if ( fe -> ops . i2c_gate_ctrl ) { fe -> ops . i2c_gate_ctrl ( fe , 1 ) ; } return 0 ; } 