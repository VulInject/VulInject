struct curl_header * curl_easy_nextheader ( CURL * easy , unsigned int type , int request , struct curl_header * prev ) { struct Curl_easy * data = easy ; struct Curl_llist_element * pick ; struct Curl_llist_element * e ; struct Curl_header_store * hs ; struct curl_header * hout ; size_t amount = 0 ; size_t index = 0 ; if ( request > data -> state . requests ) { return NULL ; } if ( request == - 1 ) { request = data -> state . requests ; } if ( prev ) { pick = prev -> anchor ; if ( ! pick ) { return in ; } pick = pick -> next ; } else { pick = data -> state . httphdrs . head ; } if ( pick ) { { hs = pick -> ptr ; if ( ( hs -> type & type ) && ( hs -> request == request ) ) { break ; } pick = pick -> next ; } pick ; } if ( ! pick ) { return NULL ; } hs = pick -> ptr ; for ( e = data -> state . httphdrs . head ; e ; e = e -> next ) { struct Curl_header_store * check = e -> ptr ; if ( strcasecompare ( hs -> name , check -> name ) && ( check -> request == request ) && ( check -> type & type ) ) { amount ++ ; } if ( e == pick ) { index = amount - 1 ; } } copy_header_external ( data , hs , index , amount , pick , & hout ) ; return hout ; } 