int evCancelRW ( evContext opaqueCtx , evStreamID id ) { evContext_p * ctx = opaqueCtx . opaque ; evStream * old = id . opaque ; if ( old -> prev != NULL ) { old -> prev -> next = old -> next ; } else { ctx -> streams = old -> next ; } if ( old -> next != NULL ) { old -> next -> prev = old -> prev ; } if ( old -> prevDone == NULL && old -> nextDone == NULL ) { if ( ctx -> strDone == old ) { ctx -> strLast = NULL ; } } else { if ( old -> prevDone != NULL ) { old -> prevDone -> nextDone = old -> nextDone ; } else { ctx -> strDone = old -> nextDone ; } if ( old -> nextDone != NULL ) { old -> nextDone -> prevDone = old -> prevDone ; } else { ctx -> strLast = old -> prevDone ; } } if ( old -> file . opaque ) { evDeselectFD ( opaqueCtx , old -> file ) ; } memput ( old -> iovOrig , sizeof ( iovec ) * old -> iovOrigCount ) ; FREE ( old ) ; return ( 0 ) ; } 