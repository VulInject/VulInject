static struct baselangextent * SFBaselang ( SplineFont * sf , struct baselangextent * old , int is_vertical , int islang , uint32_t script ) { int i , j , k ; GRect pos ; GWindowAttrs wattrs ; BaseLangDlg b ; GWindow gw ; char buffer [ 200 ] ; GGadgetCreateData gcd [ 13 ] , box [ 4 ] , buttongcd [ 2 ] ; GGadgetCreateData * buttonarray [ 8 ] , * varray [ 12 ] ; GTextInfo label [ 13 ] , buttonlabel [ 1 ] ; struct matrixinit mi ; GGadget * g ; memset ( & b , 0 , sizeof ( b ) ) ; b . sf = sf ; b . old = old ; b . vertical = is_vertical ; b . islang = islang ; b . script = script ; wattrs . mask = wam_events | wam_cursor | wam_utf8_wtitle | wam_undercursor | wam_isdlg | wam_restrict ; wattrs . event_masks = ~ ( 1 << et_charup ) ; wattrs . restrict_input_to_me = true ; wattrs . undercursor = 1 ; wattrs . cursor = ct_pointer ; snprintf ( buffer , sizeof ( buffer ) , is_vertical ?_ ( "Vertical Extents for %c%c%c%c" ) : _ ( "Horizontal Extents for %c%c%c%c" ) , script >> 24 , script >> 16 , script >> 8 , script ) ; wattrs . utf8_window_title = buffer ; wattrs . is_dlg = true ; pos . x = pos . y = 0 ; pos . width = GGadgetScale ( GDrawPointsToPixels ( NULL , 300 ) ) ; pos . height = GDrawPointsToPixels ( NULL , 200 ) ; b . gw = gw = GDrawCreateTopWindow ( NULL , & pos , baselang_e_h , & b , & wattrs ) ; memset ( & gcd , 0 , sizeof ( gcd ) ) ; memset ( & buttongcd , 0 , sizeof ( buttongcd ) ) ; memset ( & box , 0 , sizeof ( box ) ) ; memset ( & label , 0 , sizeof ( label ) ) ; memset ( & buttonlabel , 0 , sizeof ( buttonlabel ) ) ; i = j = k = 0 ; if ( islang ) { label [ i ] . text = ( unichar_t * ) _ ( "Set the minimum and maximum values by which\n" "the glyphs in this script extend below and\n" "above the baseline. This may vary by language" ) ; } else { label [ i ] . text = ( unichar_t * ) _ ( "Set the minimum and maximum values by which\n" "the glyphs in this script extend below and\n" "above the baseline when modified by a feature." ) ; } label [ i ] . text_is_1byte = true ; gcd [ i ] . gd . label = & label [ i ] ; gcd [ i ] . gd . pos . x = 5 ; gcd [ i ] . gd . pos . y = 5 + 4 ; gcd [ i ] . gd . flags = gg_enabled | gg_visible ; gcd [ i ] . creator = GLabelCreate ; varray [ j ++ ] = & gcd [ i ++ ] ; varray [ j ++ ] = NULL ; BaseLangMatrixInit ( & mi , old , islang , is_vertical ) ; gcd [ i ] . gd . pos . width = 300 ; gcd [ i ] . gd . pos . height = 200 ; gcd [ i ] . gd . flags = gg_enabled | gg_visible ; gcd [ i ] . gd . cid = CID_Languages ; gcd [ i ] . gd . u . matrix = & mi ; gcd [ i ++ ] . creator = GMatrixEditCreate ; varray [ j ++ ] = & gcd [ i - 1 ] ; varray [ j ++ ] = NULL ; gcd [ i ] . gd . flags = gg_visible | gg_enabled | gg_but_default ; label [ i ] . text = ( unichar_t * ) _ ( "_OK" ) ; label [ i ] . text_is_1byte = true ; label [ i ] . text_in_resource = true ; gcd [ i ] . gd . label = & label [ i ] ; gcd [ i ] . gd . handle_controlevent = BaseLang_OK ; gcd [ i ++ ] . creator = GButtonCreate ; gcd [ i ] . gd . flags = gg_visible | gg_enabled | gg_but_cancel ; label [ i ] . text = ( unichar_t * ) _ ( "_Cancel" ) ; label [ i ] . text_is_1byte = true ; label [ i ] . text_in_resource = true ; gcd [ i ] . gd . label = & label [ i ] ; gcd [ i ] . gd . handle_controlevent = BaseLang_Cancel ; gcd [ i ++ ] . creator = GButtonCreate ; buttonarray [ 0 ] = GCD_Glue ; buttonarray [ 1 ] = & gcd [ i - 2 ] ; buttonarray [ 2 ] = GCD_Glue ; buttonarray [ 3 ] = GCD_Glue ; buttonarray [ 4 ] = & gcd [ i - 1 ] ; buttonarray [ 5 ] = GCD_Glue ; buttonarray [ 6 ] = NULL ; box [ 3 ] . gd . flags = gg_enabled | gg_visible ; box [ 3 ] . gd . u . boxelements = buttonarray ; box [ 3 ] . creator = GHBoxCreate ; varray [ j ++ ] = & box [ 3 ] ; varray [ j ++ ] = NULL ; varray [ j ++ ] = NULL ; box [ 0 ] . gd . pos . x = box [ 0 ] . gd . pos . y = 2 ; box [ 0 ] . gd . flags = gg_enabled | gg_visible ; box [ 0 ] . gd . u . boxelements = varray ; box [ 0 ] . creator = GHVGroupCreate ; GGadgetsCreate ( gw , box ) ; GHVBoxSetExpandableRow ( box [ 0 ] . ret , 1 ) ; GHVBoxSetExpandableCol ( box [ 3 ] . ret , gb_expandgluesame ) ; buttongcd [ 0 ] . gd . flags = gg_visible ; buttonlabel [ 0 ] . text = ( unichar_t * ) S_ ( "Set Feature Extents" ) ; buttonlabel [ 0 ] . text_is_1byte = true ; buttonlabel [ 0 ] . text_in_resource = true ; buttongcd [ 0 ] . gd . label = & buttonlabel [ 0 ] ; buttongcd [ 0 ] . gd . cid = CID_Extents ; buttongcd [ 0 ] . gd . handle_controlevent = BaseLang_Extents ; buttongcd [ 0 ] . creator = GButtonCreate ; g = GWidgetGetControl ( gw , CID_Languages ) ; if ( islang ) { GMatrixEditAddButtons ( g , buttongcd ) ; GMatrixEditSetOtherButtonEnable ( g , Base_EnableOtherButtons ) ; } GMatrixEditShowColumn ( g , 3 , false ) ; GMatrixEditSetBeforeDelete ( GWidgetGetControl ( gw , CID_Languages ) , Base_DelClean ) ; GHVBoxFitWindow ( box [ 0 ] . ret ) ; GDrawSetVisible ( gw , true ) ; while ( ! b . done ) { GDrawProcessOneEvent ( NULL ) ; } GDrawDestroyWindow ( gw ) ; return ( b . old ) ; } 