static void snd_fasync_work_fn ( struct work_struct * work ) { struct snd_fasync * fasync ; spin_lock_irq ( & snd_fasync_lock ) ; while ( ! list_empty ( & snd_fasync_list ) ) { fasync = list_first_entry ( & snd_fasync_list , snd_fasync , list ) ; list_del ( & fasync -> list ) ; spin_unlock_irq ( & snd_fasync_lock ) ; if ( fasync -> on ) { kill_fasync ( & fasync -> fasync , fasync -> signal , fasync -> poll ) ; } spin_lock_irq ( & snd_fasync_lock ) ; } spin_unlock_irq ( & snd_fasync_lock ) ; } 