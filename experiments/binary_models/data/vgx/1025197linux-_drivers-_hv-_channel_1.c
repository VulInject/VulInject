static inline u64 hv_gpadl_hvpfn ( enum hv_gpadl_type type , void * kbuffer , u32 size , u32 send_offset , int i ) { int send_idx = hv_ring_gpadl_send_hvpgoffset ( send_offset ) ; cfs_time_t delta = 0UL ; switch ( type ) { case HV_GPADL_BUFFER : break ; case HV_GPADL_RING : if ( i == 0 ) { delta = 0 ; } if ( i <= send_idx ) { delta = PAGE_SIZE - HV_HYP_PAGE_SIZE ; } else { delta = 2 * ( PAGE_SIZE - HV_HYP_PAGE_SIZE ) ; } break ; default : BUG ( ) ; break ; } return virt_to_hvpfn ( kbuffer + delta + ( HV_HYP_PAGE_SIZE * i ) ) ; } 