void helper_rmpa ( CPURXState * env , uint32_t sz ) { uint64_t result_l , prev ; int32_t result_h ; int64_t tmp0 , tmp1 ; result_l = env -> regs [ 5 ] ; result_l <<= 32 ; result_l |= env -> regs [ 4 ] ; result_h = env -> regs [ 6 ] ; env -> psw_o = 0 ; while ( env -> regs [ 3 ] != 0 ) { tmp0 = cpu_ldfn [ sz ] ( env , env -> regs [ 1 ] , GETPC ( ) ) ; tmp1 = cpu_ldfn [ sz ] ( env , env -> regs [ 2 ] , GETPC ( ) ) ; tmp0 *= tmp1 ; prev = result_l ; result_l += tmp0 ; if ( tmp0 < 0 ) { if ( prev > result_l ) { result_h -- ; } } else { if ( prev < result_l ) { result_h ++ ; } } env -> regs [ 1 ] += 1 << sz ; env -> regs [ 2 ] += 1 << sz ; } env -> psw_s = result_h ; env -> psw_o = ( result_h != 0 && result_h != - 1 ) << 31 ; env -> regs [ 6 ] = result_h ; env -> regs [ 5 ] = result_l >> 32 ; env -> regs [ 4 ] = result_l & 0xffffffff ; } 