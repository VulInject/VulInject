static inline u16 auth_parse ( struct net_device * dev , struct sk_buff * skb , u8 * * challenge , int * chlen ) { struct rtllib_authentication * a ; u8 * t ; if ( skb -> len < ( sizeof ( rtllib_authentication ) - sizeof ( rtllib_info_element ) ) ) { netdev_dbg ( dev , "invalid len in auth resp: %d\n" , skb -> len ) ; return 0xcafe ; } * challenge = NULL ; a = ( rtllib_authentication * ) skb -> data ; if ( skb -> len > ( sizeof ( rtllib_authentication ) + 3 ) ) { t = skb -> data + sizeof ( rtllib_authentication ) ; if ( * ( t ++ ) == MFIE_TYPE_CHALLENGE ) { * chlen = * ( t ++ ) ; * challenge = kmemdup ( t , * chlen , GFP_ATOMIC ) ; } } return le16_to_cpu ( a -> status ) ; } 