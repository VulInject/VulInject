static struct vim2m_fmt * find_format ( struct v4l2_format * f ) { struct vim2m_fmt * fmt ; unsigned int k ; for ( k = 0 ; k < NUM_FORMATS ; k ++ ) { fmt = & formats [ k ] ; if ( fmt -> fourcc == f -> fmt . pix . pixelformat ) { break ; } } if ( k == NUM_FORMATS ) { return NULL ; } return & formats [ k ] ; } vim2m_dev { struct v4l2_device v4l2_dev ; struct video_device vfd ; atomic_t num_inst ; struct mutex dev_mutex ; spinlock_t irqlock ; struct timer_list timer ; struct v4l2_m2m_dev * m2m_dev ; } vim2m_ctx { struct v4l2_fh fh ; struct vim2m_dev * dev ; struct v4l2_ctrl_handler hdl ; u8 num_processed ; u32 translen ; int transtime ; int aborting ; int mode ; enum v4l2_colorspace colorspace ; enum v4l2_ycbcr_encoding ycbcr_enc ; enum v4l2_xfer_func xfer_func ; enum v4l2_quantization quant ; struct vim2m_q_data q_data [ 2 ] ; } 