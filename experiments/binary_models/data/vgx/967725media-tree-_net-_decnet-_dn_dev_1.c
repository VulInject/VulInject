static void dn_dev_sysctl_register ( struct net_device * dev , struct dn_dev_parms * parms ) { struct dn_dev_sysctl_table * t ; int i ; char path [ sizeof ( "net/decnet/conf/" ) + IFNAMSIZ ] ; t = kmemdup ( & dn_dev_sysctl , sizeof ( * t ) , GFP_KERNEL ) ; for ( i = 0 ; i < ARRAY_SIZE ( t -> dn_dev_vars ) - 1 ; i ++ ) { long offset = ( long ) t -> dn_dev_vars [ i ] . data ; t -> dn_dev_vars [ i ] . data = ( ( char * ) parms ) + offset ; } snprintf ( path , sizeof ( path ) , "net/decnet/conf/%s" , dev ?dev -> name : parms -> name ) ; t -> dn_dev_vars [ 0 ] . extra1 = ( void * ) dev ; t -> sysctl_header = register_net_sysctl ( & init_net , path , t -> dn_dev_vars ) ; if ( t -> sysctl_header == NULL ) { kfree ( t ) ; } else { parms -> sysctl = t ; } } 