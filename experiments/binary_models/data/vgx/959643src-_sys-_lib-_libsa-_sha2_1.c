void SHA256Pad ( SHA2_CTX * context ) { unsigned int usedspace ; usedspace = ( context -> bitcount [ 0 ] >> 3 ) % SHA256_BLOCK_LENGTH ; if ( usedspace > 0 ) { context -> buffer [ usedspace ++ ] = 0x80 ; if ( usedspace <= SHA256_SHORT_BLOCK_LENGTH ) { memset ( & context -> buffer [ usedspace ] , 0 , SHA256_SHORT_BLOCK_LENGTH - usedspace ) ; } else { if ( usedspace < SHA256_BLOCK_LENGTH ) { memset ( & context -> buffer [ usedspace ] , 0 , SHA256_BLOCK_LENGTH - usedspace ) ; } SHA256Transform ( context -> state . st32 , context -> buffer ) ; } } else { memset ( context -> buffer , 0 , SHA256_SHORT_BLOCK_LENGTH ) ; * context -> buffer = 0x80 ; } BE_64_TO_8 ( & context -> buffer [ SHA256_SHORT_BLOCK_LENGTH ] , context -> bitcount [ 0 ] ) ; SHA256Transform ( context -> state . st32 , context -> buffer ) ; usedspace = 0 ; } 