int ipgpc_classes_info ( int * fn ( nvlist_t * , void * ) , void * arg ) { int i ; int rc ; nvlist_t * nvlp ; for ( i = 0 ; i < ipgpc_max_num_classes ; ++ i ) { if ( ( rc = nvlist_alloc ( & nvlp , NV_UNIQUE_NAME , KM_NOSLEEP ) ) != 0 ) { return ( rc ) ; } if ( ( rc = ( build_class_nvlist ( & nvlp , & ipgpc_cid_list [ i ] . aclass , ( ( i == ipgpc_def_class_id ) ?B_TRUE : B_FALSE ) ) ) ) != 0 ) { nvlist_free ( nvlp ) ; return ( rc ) ; } if ( ( rc = fn ( nvlp , arg ) ) != 0 ) { nvlist_free ( nvlp ) ; return ( rc ) ; } nvlist_free ( nvlp ) ; } return ( 0 ) ; } 