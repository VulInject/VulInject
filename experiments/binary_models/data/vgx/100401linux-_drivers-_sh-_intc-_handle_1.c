static unsigned int __init _intc_prio_data ( struct intc_desc * desc , struct intc_desc_int * d , intc_enum enum_id , unsigned int * reg_idx , unsigned int * fld_idx ) { struct intc_prio_reg * pr = desc -> hw . prio_regs ; unsigned int fn , n , mode , bit ; unsigned long reg_e , reg_d ; while ( pr && enum_id && * reg_idx < desc -> hw . nr_prio_regs ) { pr = desc -> hw . prio_regs + * reg_idx ; for ( ; * fld_idx < ARRAY_SIZE ( pr -> enum_ids ) ; ( * fld_idx ) ++ ) { if ( pr -> set_reg && pr -> clr_reg ) { fn = REG_FN_WRITE_BASE ; mode = MODE_PCLR_REG ; reg_e = pr -> set_reg ; reg_d = pr -> clr_reg ; } else { fn = REG_FN_MODIFY_BASE ; mode = MODE_PRIO_REG ; if ( ! pr -> set_reg ) { BUG ( ) ; } reg_e = pr -> set_reg ; reg_d = pr -> set_reg ; } fn += ( pr -> reg_width >> 3 ) - 1 ; n = * fld_idx + 1 ; BUG_ON ( n * pr -> field_width > pr -> reg_width ) ; bit = pr -> reg_width - ( n * pr -> field_width ) ; return _INTC_MK ( fn , mode , intc_get_reg ( d , reg_e ) , intc_get_reg ( d , reg_d ) , pr -> field_width , bit ) ; } * fld_idx = 0 ; ( * reg_idx ) ++ ; } return 0 ; } 