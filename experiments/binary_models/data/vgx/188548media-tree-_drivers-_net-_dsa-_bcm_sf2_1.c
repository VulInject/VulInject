static void bcm_sf2_imp_vlan_setup ( struct dsa_switch * ds , int cpu_port ) { struct bcm_sf2_priv * priv = bcm_sf2_to_priv ( ds ) ; int i ; u32 reg ; for ( i = 0 ; i < priv -> hw_params . num_ports ; i ++ ) { if ( ! ( ( 1 << i ) & ds -> enabled_port_mask ) ) { continue ; } reg = core_readl ( priv , CORE_PORT_VLAN_CTL_PORT ( i ) ) ; reg |= ( 1 << cpu_port ) ; core_writel ( priv , reg , CORE_PORT_VLAN_CTL_PORT ( i ) ) ; } } 