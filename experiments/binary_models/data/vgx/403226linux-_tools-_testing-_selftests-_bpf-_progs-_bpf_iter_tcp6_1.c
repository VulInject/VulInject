int dump_tcp6 ( struct bpf_iter__tcp * ctx ) { struct sock_common * sk_common = ctx -> sk_common ; struct seq_file * seq = ctx -> meta -> seq ; struct tcp_timewait_sock * tw ; struct tcp_request_sock * req ; struct tcp6_sock * tp ; uid_t uid = ctx -> uid ; __u32 seq_num ; if ( sk_common == ( void * ) 0 ) { return 0 ; } seq_num = ctx -> meta -> seq_num ; if ( seq_num == 0 ) { BPF_SEQ_PRINTF ( seq , "  sl  " "local_address                         " "remote_address                        " "st tx_queue rx_queue tr tm->when retrnsmt" "   uid  timeout inode\n" ) ; } tp = bpf_skc_to_tcp6_sock ( sk_common ) ; if ( tp ) { return dump_tcp6_sock ( seq , tp , uid , seq_num ) ; } tw = bpf_skc_to_tcp_timewait_sock ( sk_common ) ; if ( tw ) { return dump_tw_sock ( seq , tw , uid , seq_num ) ; } req = bpf_skc_to_tcp_request_sock ( sk_common ) ; if ( req ) { return dump_req_sock ( seq , req , uid , seq_num ) ; } return 0 ; } 