static int netlbl_unlabel_staticadd ( struct sk_buff * skb , struct genl_info * info ) { int ret_val ; char * dev_name ; void * addr ; void * mask ; int addr_len ; u32 secid ; struct netlbl_audit audit_info ; if ( ! info -> attrs [ NLBL_UNLABEL_A_SECCTX ] || ! info -> attrs [ NLBL_UNLABEL_A_IFACE ] || ! ( ( ! info -> attrs [ NLBL_UNLABEL_A_IPV4ADDR ] || ! info -> attrs [ NLBL_UNLABEL_A_IPV4MASK ] ) ^ ( ! info -> attrs [ NLBL_UNLABEL_A_IPV6ADDR ] || ! info -> attrs [ NLBL_UNLABEL_A_IPV6MASK ] ) ) ) { return - EINVAL ; } netlbl_netlink_auditinfo ( skb , & audit_info ) ; ret_val = netlbl_unlabel_addrinfo_get ( info , & addr , & mask , & addr_len ) ; if ( ret_val != 0 ) { return ret_val ; } dev_name = nla_data ( info -> attrs [ NLBL_UNLABEL_A_IFACE ] ) ; ret_val = security_secctx_to_secid ( nla_data ( info -> attrs [ NLBL_UNLABEL_A_SECCTX ] ) , nla_len ( info -> attrs [ NLBL_UNLABEL_A_SECCTX ] ) , & secid ) ; if ( ret_val != 0 ) { return ret_val ; } return netlbl_unlhsh_add ( & init_net , dev_name , addr , mask , addr_len , secid , & audit_info ) ; } 