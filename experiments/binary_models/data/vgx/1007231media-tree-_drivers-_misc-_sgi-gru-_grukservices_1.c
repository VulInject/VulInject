static int send_message_failure ( void * cb , struct gru_message_queue_desc * mqd , void * mesg , int lines ) { int substatus , ret = 0 ; substatus = gru_get_cb_message_queue_substatus ( cb ) ; switch ( substatus ) { case CBSS_NO_ERROR : STAT ( mesq_send_unexpected_error ) ; ret = MQE_UNEXPECTED_CB_ERR ; break ; case CBSS_LB_OVERFLOWED : STAT ( mesq_send_lb_overflow ) ; ret = MQE_CONGESTION ; break ; case CBSS_QLIMIT_REACHED : STAT ( mesq_send_qlimit_reached ) ; ret = send_message_queue_full ( cb , mqd , mesg , lines ) ; break ; case CBSS_AMO_NACKED : STAT ( mesq_send_amo_nacked , NULL ) ; ret = MQE_CONGESTION ; break ; case CBSS_PUT_NACKED : STAT ( mesq_send_put_nacked ) ; ret = send_message_put_nacked ( cb , mqd , mesg , lines ) ; break ; case CBSS_PAGE_OVERFLOW : STAT ( mesq_page_overflow ) ; default : BUG ( ) ; } return ret ; } 