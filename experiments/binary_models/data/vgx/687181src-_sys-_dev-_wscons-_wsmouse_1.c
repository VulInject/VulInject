int wsmouse_set_params ( struct device * sc , const struct wsmouse_param * params , u_int nparams ) { struct wsmouseinput * input = & ( ( wsmouse_softc * ) sc ) -> sc_input ; int i , val , key , needreset = 0 , error = 0 ; for ( i = 0 ; i < nparams ; i ++ ) { key = params [ i ] . key ; val = params [ i ] . value ; switch ( params [ i ] . key ) { case WSMOUSECFG_PRESSURE_LO : input -> filter . pressure_lo = val ; if ( val > input -> filter . pressure_hi ) { input -> filter . pressure_hi = val ; } input -> touch . min_pressure = input -> filter . pressure_hi ; break ; case WSMOUSECFG_PRESSURE_HI : input -> filter . pressure_hi = val ; if ( val < input -> filter . pressure_lo ) { input -> filter . pressure_lo = val ; } input -> touch . min_pressure = val ; break ; case WSMOUSECFG_X_HYSTERESIS : input -> filter . h . hysteresis = val ; break ; case WSMOUSECFG_Y_HYSTERESIS : input -> filter . v . hysteresis = val ; break ; case WSMOUSECFG_DECELERATION : input -> filter . dclr = val ; wstpad_init_deceleration ( input ) ; break ; case WSMOUSECFG_DX_SCALE : input -> filter . h . scale = val ; break ; case WSMOUSECFG_DY_SCALE : input -> filter . v . scale = val ; break ; case WSMOUSECFG_TRKMAXDIST : input -> filter . tracking_maxdist = val ; break ; case WSMOUSECFG_SWAPXY : input -> filter . swapxy = val ; break ; case WSMOUSECFG_X_INV : input -> filter . h . inv = val ; break ; case WSMOUSECFG_Y_INV : input -> filter . v . inv = val ; break ; case WSMOUSECFG_REVERSE_SCROLLING : if ( val ) { input -> flags |= REVERSE_SCROLLING ; } else { input -> flags &= ~ REVERSE_SCROLLING ; } break ; case WSMOUSECFG_DX_MAX : input -> filter . h . dmax = val ; break ; case WSMOUSECFG_DY_MAX : input -> filter . v . dmax = val ; break ; case WSMOUSECFG_SMOOTHING : input -> filter . mode &= ~ SMOOTHING_MASK ; input -> filter . mode |= ( val & SMOOTHING_MASK ) ; break ; case WSMOUSECFG_LOG_INPUT : if ( val ) { input -> flags |= LOG_INPUT ; } else { input -> flags &= ~ LOG_INPUT ; } break ; case WSMOUSECFG_LOG_EVENTS : if ( val ) { input -> flags |= LOG_EVENTS ; } else { input -> flags &= ~ LOG_EVENTS ; } break ; default : needreset = 1 ; error = wstpad_set_param ( input , key , val ) ; if ( error != 0 ) { return ( error ) ; } break ; } } if ( needreset ) { wstpad_reset ( input , NULL ) ; return ( wstpad_configure ( input ) ) ; } return ( 0 ) ; } 