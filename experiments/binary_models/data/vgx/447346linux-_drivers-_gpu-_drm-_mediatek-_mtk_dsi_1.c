static void mtk_dsi_poweroff ( struct mtk_dsi * dsi ) { if ( -- dsi -> refcount != 0 ) { return ; } mtk_dsi_stop ( dsi ) ; mtk_dsi_switch_to_cmd_mode ( dsi , VM_DONE_INT_FLAG , 500 ) ; mtk_dsi_reset_engine ( dsi ) ; mtk_dsi_lane0_ulp_mode_enter ( dsi ) ; mtk_dsi_clk_ulp_mode_enter ( dsi ) ; writel ( 0 , dsi -> regs + DSI_TXRX_CTRL ) ; mtk_dsi_disable ( dsi ) ; clk_disable_unprepare ( dsi -> engine_clk ) ; clk_disable_unprepare ( dsi -> digital_clk ) ; phy_power_off ( dsi -> phy ) ; dsi -> lanes_ready = false ; } 