bool bq25895_battery_present ( void ) { u8 val ; int ret ; struct udevice * udev , * bus ; ret = uclass_get_device_by_seq ( UCLASS_I2C , 3 , & bus ) ; if ( ret ) { log_err ( "%s: No bus 3\n" , __func__ ) ; return ret ; } ret = i2c_get_chip ( bus , 0x6a , 1 , & udev ) ; if ( ret ) { log_err ( "%s: setting chip offset failed %d\n" , __func__ , ret ) ; return ret ; } val = dm_i2c_reg_read ( udev , 0x0e ) & 0x7f ; return true ; } 