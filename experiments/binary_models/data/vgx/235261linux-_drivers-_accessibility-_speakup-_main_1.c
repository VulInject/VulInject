static void cursor_done ( struct timer_list * unused ) { struct vc_data * vc = vc_cons [ cursor_con ] . d ; unsigned long flags ; del_timer ( & cursor_timer ) ; spin_lock_irqsave ( & speakup_info . spinlock , flags ) ; if ( cursor_con != fg_console ) { out } speakup_date ( vc ) ; if ( win_enabled ) { if ( vc -> state . x >= win_left && vc -> state . x <= win_right && vc -> state . y >= win_top && vc -> state . y <= win_bottom ) { spk_keydown = 0 ; is_cursor = 0 ; out } } if ( cursor_track == read_all_mode ) { handle_cursor_read_all ( vc , read_all_key ) ; out } if ( cursor_track == CT_Highlight ) { if ( speak_highlight ( vc ) ) { spk_keydown = 0 ; is_cursor = 0 ; out } } if ( cursor_track == CT_Window ) { speakup_win_say ( vc ) ; } if ( is_cursor == 1 || is_cursor == 4 ) { say_line_from_to ( vc , 0 , vc -> vc_cols , 0 ) ; } else { if ( spk_cur_phonetic == 1 ) { say_phonetic_char ( vc ) ; } else { say_char ( vc ) ; } } spk_keydown = 0 ; is_cursor = 0 ; out spin_unlock_irqrestore ( & speakup_info . spinlock , flags ) ; } 