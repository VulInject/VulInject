static int __init n411_init ( void ) { int ret ; if ( ! dio_addr || ! cio_addr || ! c2io_addr ) { printk ( KERN_WARNING "no IO addresses supplied\n" ) ; return - EINVAL ; } request_module ( "hecubafb" ) ; n411_device = platform_device_alloc ( "hecubafb" , - 1 ) ; ret = platform_device_add_data ( n411_device , & n411_board , sizeof ( n411_board ) ) ; if ( ret ) { put_plat_device } ret = platform_device_add ( n411_device ) ; if ( ret ) { put_plat_device } return 0 ; put_plat_device platform_device_put ( n411_device ) ; return ret ; } 