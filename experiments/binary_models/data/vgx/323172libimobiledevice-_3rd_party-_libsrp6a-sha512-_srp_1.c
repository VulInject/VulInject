_TYPE ( ) SRP_new ( ) { SRP * srp = ( SRP * ) malloc ( sizeof ( SRP ) ) ; if ( srp == NULL ) { return NULL ; } srp -> flags = 0 ; srp -> username = cstr_new ( ) ; srp -> bctx = BigIntegerCtxNew ( ) ; srp -> modulus = NULL ; srp -> accel = NULL ; srp -> generator = NULL ; srp -> salt = NULL ; srp -> verifier = NULL ; srp -> password = NULL ; srp -> pubkey = NULL ; srp -> secret = NULL ; srp -> u = NULL ; srp -> key = NULL ; srp -> ex_data = cstr_new ( ) ; srp -> param_cb = NULL ; srp -> meth = meth ; srp -> meth_data = NULL ; if ( srp -> meth -> init == NULL || * srp -> meth -> init ( srp ) == SRP_SUCCESS ) { return srp ; } return NULL ; } 