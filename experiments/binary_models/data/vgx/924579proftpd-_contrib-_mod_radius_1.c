static void radius_process_quota_info ( config_rec * c ) { char * param = NULL ; unsigned char have_illegal_value = FALSE ; param = ( char * ) c -> argv [ 0 ] ; if ( RADIUS_IS_VAR ( param ) == TRUE ) { radius_parse_var ( param , & radius_quota_per_sess_attr_id , & radius_quota_per_sess ) ; } else { radius_quota_per_sess = param ; if ( strcasecmp ( param , "false" ) != 0 && strcasecmp ( param , "true" ) != 0 ) { ( void ) pr_log_writefile ( radius_logfd , MOD_RADIUS_VERSION , "illegal RadiusQuotaInfo per-session value: '%s'" , param ) ; have_illegal_value = TRUE ; } else { pr_trace_msg ( trace_channel , 17 , "found RadiusQuotaInfo per-session value: %s" , param ) ; } } param = ( char * ) c -> argv [ 1 ] ; if ( RADIUS_IS_VAR ( param ) == TRUE ) { radius_parse_var ( param , & radius_quota_limit_type_attr_id , & radius_quota_limit_type ) ; } else { radius_quota_limit_type = param ; if ( strcasecmp ( param , "hard" ) != 0 && strcasecmp ( param , "soft" ) != 0 ) { ( void ) pr_log_writefile ( radius_logfd , MOD_RADIUS_VERSION , "illegal RadiusQuotaInfo limit type value: '%s'" , param ) ; have_illegal_value = TRUE ; } else { pr_trace_msg ( trace_channel , 17 , "found RadiusQuotaInfo limit type value: %s" , param ) ; } } param = ( char * ) c -> argv [ 2 ] ; if ( RADIUS_IS_VAR ( param ) == TRUE ) { radius_parse_var ( param , & radius_quota_bytes_in_attr_id , & radius_quota_bytes_in ) ; } else { char * endp ; if ( strtod ( param , & endp ) < 0 ) { ( void ) pr_log_writefile ( radius_logfd , MOD_RADIUS_VERSION , "illegal RadiusQuotaInfo bytes in value: negative number" ) ; have_illegal_value = TRUE ; } if ( endp && * endp ) { ( void ) pr_log_writefile ( radius_logfd , MOD_RADIUS_VERSION , "illegal RadiusQuotaInfo bytes in value: '%s' not a number" , param ) ; have_illegal_value = TRUE ; } else { pr_trace_msg ( trace_channel , 17 , "found RadiusQuotaInfo bytes in value: %s" , param ) ; } radius_quota_bytes_in = param ; } param = ( char * ) c -> argv [ 3 ] ; if ( RADIUS_IS_VAR ( param ) == TRUE ) { radius_parse_var ( param , & radius_quota_bytes_out_attr_id , & radius_quota_bytes_out ) ; } else { char * endp = NULL ; if ( strtod ( param , & endp ) < 0 ) { ( void ) pr_log_writefile ( radius_logfd , MOD_RADIUS_VERSION , "illegal RadiusQuotaInfo bytes out value: negative number" ) ; have_illegal_value = TRUE ; } if ( endp && * endp ) { ( void ) pr_log_writefile ( radius_logfd , MOD_RADIUS_VERSION , "illegal RadiusQuotaInfo bytes out value: '%s' not a number" , param ) ; have_illegal_value = TRUE ; } else { pr_trace_msg ( trace_channel , 17 , "found RadiusQuotaInfo bytes out value: %s" , param ) ; } radius_quota_bytes_out = param ; } param = ( char * ) c -> argv [ 4 ] ; if ( RADIUS_IS_VAR ( param ) == TRUE ) { radius_parse_var ( param , & radius_quota_bytes_xfer_attr_id , & radius_quota_bytes_xfer ) ; } else { char * endp = NULL ; if ( strtod ( param , & endp ) < 0 ) { ( void ) pr_log_writefile ( radius_logfd , MOD_RADIUS_VERSION , "illegal RadiusQuotaInfo bytes xfer value: negative number" ) ; have_illegal_value = TRUE ; } if ( endp && * endp ) { ( void ) pr_log_writefile ( radius_logfd , MOD_RADIUS_VERSION , "illegal RadiusQuotaInfo bytes xfer value: '%s' not a number" , param ) ; have_illegal_value = TRUE ; } else { pr_trace_msg ( trace_channel , 17 , "found RadiusQuotaInfo bytes xfer value: %s" , param ) ; } radius_quota_bytes_xfer = param ; } param = ( char * ) c -> argv [ 5 ] ; if ( RADIUS_IS_VAR ( param ) == TRUE ) { radius_parse_var ( param , & radius_quota_files_in_attr_id , & radius_quota_files_in ) ; } else { char * endp = NULL ; unsigned long res ; res = strtoul ( param , & endp , 10 ) ; if ( endp && * endp ) { ( void ) pr_log_writefile ( radius_logfd , MOD_RADIUS_VERSION , "illegal RadiusQuotaInfo files in value: '%s' not a number" , param ) ; have_illegal_value = TRUE ; } else { pr_trace_msg ( trace_channel , 17 , "found RadiusQuotaInfo files in value: %lu" , res ) ; } radius_quota_files_in = param ; } param = ( char * ) c -> argv [ 6 ] ; if ( RADIUS_IS_VAR ( param ) == TRUE ) { radius_parse_var ( param , & radius_quota_files_out_attr_id , & radius_quota_files_out ) ; } else { char * endp = NULL ; unsigned long res ; res = strtoul ( param , & endp , 10 ) ; if ( endp && * endp ) { ( void ) pr_log_writefile ( radius_logfd , MOD_RADIUS_VERSION , "illegal RadiusQuotaInfo files out value: '%s' not a number" , param ) ; have_illegal_value = TRUE ; } else { pr_trace_msg ( trace_channel , 17 , "found RadiusQuotaInfo files out value: %lu" , res ) ; } radius_quota_files_out = param ; } param = ( char * ) c -> argv [ 7 ] ; if ( RADIUS_IS_VAR ( param ) == TRUE ) { radius_parse_var ( param , & radius_quota_files_xfer_attr_id , & radius_quota_files_xfer ) ; } else { char * endp = NULL ; unsigned long res ; res = strtoul ( param , & endp , 10 ) ; if ( endp && * endp ) { ( void ) pr_log_writefile ( radius_logfd , MOD_RADIUS_VERSION , "illegal RadiusQuotaInfo files xfer value: '%s' not a number" , param ) ; have_illegal_value = TRUE ; } else { pr_trace_msg ( trace_channel , 17 , "found RadiusQuotaInfo files xfer value: %lu" , res ) ; } radius_quota_files_xfer = param ; } if ( ! have_illegal_value ) { radius_have_quota_info = TRUE ; } else { ( void ) pr_log_writefile ( radius_logfd , MOD_RADIUS_VERSION , "error with RadiusQuotaInfo parameters, ignoring them" ) ; } } 