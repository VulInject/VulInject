int pcmk__build_path ( const char * path_c , mode_t mode ) { int offset = 1 , len = 0 ; int rc = pcmk_rc_ok ; char * path = strdup ( path_c ) ; CRM_CHECK ( , ) for ( len = strlen ( path ) ; offset < len ; offset ++ ) { if ( path [ offset ] == '/' ) { path [ offset ] = 0 ; if ( ( mkdir ( path , mode ) < 0 ) && ( errno != EEXIST ) ) { rc = errno ; done } path [ offset ] = '/' ; } } if ( ( mkdir ( path , mode ) < 0 ) && ( errno != EEXIST ) ) { rc = errno ; } done return rc ; } 