int irdma_init_hash_desc ( struct shash_desc * * desc ) { struct crypto_shash * tfm ; struct shash_desc * tdesc ; tfm = crypto_alloc_shash ( "crc32c" , 0 , 0 ) ; if ( IS_ERR ( tfm ) ) { return - EINVAL ; } tdesc = kmalloc ( sizeof ( * tdesc ) + crypto_shash_descsize ( tfm ) , GFP_KERNEL ) ; if ( ! tdesc ) { crypto_free_shash ( tfm ) ; return - EINVAL ; } tdesc -> tfm = tfm ; * desc = tdesc ; return 0 ; } 