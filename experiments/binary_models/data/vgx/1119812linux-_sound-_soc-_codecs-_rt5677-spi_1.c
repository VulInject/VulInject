static int rt5677_spi_copy ( struct rt5677_dsp * rt5677_dsp , u32 amount ) { int ret = 0 ; u32 target ; target = rt5677_dsp -> mic_read_offset + amount ; ret |= rt5677_spi_copy_block ( rt5677_dsp , rt5677_dsp -> mic_read_offset , min ( target , RT5677_MIC_BUF_BYTES ) ) ; if ( target >= RT5677_MIC_BUF_BYTES ) { target -= RT5677_MIC_BUF_BYTES ; ret |= rt5677_spi_copy_block ( rt5677_dsp , 0 , target ) ; } if ( ! ret ) { rt5677_dsp -> mic_read_offset = target ; } return ret ; } 