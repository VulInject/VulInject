int fru_close_container ( container_hdl_t container ) { hash_obj_t * hash_obj ; hash_obj_t * prev_hash ; hash_obj_t * sec_hash_obj ; handle_t obj_hdl ; hash_obj = lookup_handle_object ( container , CONTAINER_TYPE ) ; if ( hash_obj == NULL ) { return ( 0 ) ; } sec_hash_obj = hash_obj -> u . cont_obj -> sec_obj_list ; while ( sec_hash_obj != NULL ) { while ( sec_hash_obj -> u . sec_obj -> seg_obj_list != NULL ) { obj_hdl = sec_hash_obj -> u . sec_obj -> seg_obj_list -> obj_hdl ; free_segment_hash ( obj_hdl , sec_hash_obj ) ; } if ( sec_hash_obj -> prev == NULL ) { hash_table [ ( sec_hash_obj -> obj_hdl % TABLE_SIZE ) ] = sec_hash_obj -> next ; if ( sec_hash_obj -> next != NULL ) { sec_hash_obj -> next -> prev = NULL ; } } else { sec_hash_obj -> prev -> next = sec_hash_obj -> next ; if ( sec_hash_obj -> next != NULL ) { sec_hash_obj -> next -> prev = sec_hash_obj -> prev ; } } prev_hash = sec_hash_obj ; sec_hash_obj = sec_hash_obj -> u . sec_obj -> next ; free ( prev_hash -> u . sec_obj ) ; } if ( hash_obj -> prev == NULL ) { hash_table [ ( hash_obj -> obj_hdl % TABLE_SIZE ) ] = hash_obj -> next ; if ( hash_obj -> next != NULL ) { hash_obj -> next -> prev = NULL ; } } else { hash_obj -> prev -> next = hash_obj -> next ; if ( hash_obj -> next != NULL ) { hash_obj -> next -> prev = hash_obj -> prev ; } } free ( hash_obj -> u . cont_obj ) ; free ( hash_obj ) ; return ( 0 ) ; } 