struct dm_io_client * dm_io_client_create ( void ) { struct dm_io_client * client ; unsigned int min_ios = dm_get_reserved_bio_based_ios ( ) ; int ret ; client = kzalloc ( sizeof ( * client ) , GFP_KERNEL ) ; ret = mempool_init_slab_pool ( & client -> pool , min_ios , _dm_io_cache ) ; if ( ret ) { bad } ret = bioset_init ( & client -> bios , min_ios , 0 , BIOSET_NEED_BVECS ) ; if ( ret ) { bad } return client ; bad mempool_exit ( & client -> pool ) ; kfree ( client ) ; return ERR_PTR ( ret ) ; } 