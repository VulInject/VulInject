static ssize_t tach_store ( struct device * dev , struct device_attribute * attr , const char * buf , size_t count ) { struct sensor_device_attribute_2 * sattr = to_sensor_dev_attr_2 ( attr ) ; struct adt7475_data * data = dev_get_drvdata ( dev ) ; struct i2c_client * client = data -> client ; unsigned long val ; mutex_lock ( & data -> lock ) ; data -> tach [ MIN ] [ sattr -> index ] = rpm2tach ( val ) ; adt7475_write_word ( client , TACH_MIN_REG ( sattr -> index ) , data -> tach [ MIN ] [ sattr -> index ] ) ; mutex_unlock ( & data -> lock ) ; return count ; } 