VAR1 * FUN1 ( ) { extern uid_t VAR2 ; VAR1 * VAR3 ; VAR1 * VAR4 ; VAR5 * VAR6 ; int VAR7 = 0 ; int VAR8 ; int VAR9 ; int VAR10 ; struct VAR11 * VAR12 ; struct strrecvfd VAR13 ; struct strbuf VAR14 ; char VAR15 [ VAR16 ] ; VAR14 . VAR17 = VAR15 ; VAR14 . VAR18 = sizeof ( VAR15 ) ; for ( ; ; ) { if ( VAR19 <= 0 ) { VAR20 += VAR21 ; VAR21 = 0 ; if ( VAR20 <= 0 ) { VAR22 = VAR23 ; return ( NULL ) ; } for ( VAR9 = 0 ; VAR9 < VAR20 ; VAR9 ++ ) { VAR3 = VAR24 [ VAR9 ] ; if ( VAR3 -> VAR25 == - 1 ) { VAR8 = FUN2 ( VAR3 ) ; VAR20 -- ; for ( VAR10 = VAR9 ; VAR10 < ( VAR20 + VAR21 ) ; VAR10 ++ ) { VAR24 [ VAR10 ] = VAR24 [ VAR10 + 1 ] ; VAR26 [ VAR10 ] = VAR26 [ VAR10 + 1 ] ; } if ( VAR8 > 0 ) { VAR22 = VAR23 ; return ( NULL ) ; } else { VAR9 -- ; } } else { VAR26 [ VAR9 ] . VAR27 = VAR28 ; if ( VAR3 -> VAR29 ) { VAR26 [ VAR9 ] . VAR27 |= VAR30 ; } } } if ( ( VAR19 = FUN3 ( VAR26 , VAR20 , - 1 ) ) < 0 ) { VAR22 = VAR31 ; return ( NULL ) ; } } for ( VAR9 = 0 ; VAR9 < VAR20 ; VAR9 ++ ) { VAR3 = VAR24 [ VAR9 ] ; VAR12 = VAR26 + VAR9 ; if ( VAR12 -> VAR32 == 0 ) { continue ; } switch ( VAR3 -> VAR33 ) { case VAR34 : if ( VAR12 -> VAR32 != VAR28 ) { VAR22 = VAR35 ; return ( NULL ) ; } if ( FUN4 ( VAR3 -> VAR25 , VAR36 , & VAR13 ) != 0 ) { if ( VAR22 == VAR23 ) { VAR22 = VAR31 ; return ( NULL ) ; } if ( VAR22 == VAR37 ) { VAR12 -> VAR32 = 0 ; VAR19 -- ; continue ; } if ( VAR22 == VAR38 ) { while ( FUN5 ( VAR3 , & VAR14 , & VAR14 , & VAR7 ) >= 0 ) { } } return ( NULL ) ; } FUN6 ( VAR13 . VAR39 , VAR40 ) ; if ( ( VAR4 = ( VAR1 * ) FUN7 ( VAR41 ) ) == NULL ) { VAR22 = VAR42 ; return ( NULL ) ; } VAR4 -> VAR43 = VAR13 . VAR43 ; VAR4 -> VAR25 = VAR4 -> VAR44 = VAR13 . VAR39 ; VAR4 -> VAR45 = VAR46 ; VAR4 -> VAR33 = VAR47 ; VAR4 -> VAR48 = VAR13 . VAR48 ; VAR4 -> VAR49 = ( VAR4 -> VAR48 == 0 || VAR4 -> VAR48 == VAR2 ) ; if ( VAR4 -> VAR49 == 0 ) { struct VAR50 * VAR51 = NULL ; if ( ( VAR51 = getpwuid ( VAR4 -> VAR48 ) ) != NULL ) { VAR4 -> VAR49 = FUN8 ( "" , VAR51 -> VAR52 ) ; } } FUN9 ( VAR4 -> VAR25 , & VAR4 -> VAR53 ) ; if ( FUN10 ( VAR4 , VAR28 ) != 0 ) { return ( NULL ) ; } FUN11 ( VAR4 -> VAR25 ) ; VAR12 = VAR26 + VAR9 ; VAR12 -> VAR32 = 0 ; VAR19 -- ; break ; case VAR54 : if ( VAR12 -> VAR32 & VAR30 ) { if ( VAR3 -> VAR29 ) { if ( FUN12 ( VAR3 ) < 0 ) { syslog ( VAR55 , "" ) ; } } } if ( VAR12 -> VAR32 & VAR28 ) { VAR3 -> VAR56 = VAR12 -> VAR32 ; VAR19 -- ; VAR12 -> VAR32 = 0 ; return ( VAR3 ) ; } VAR19 -- ; VAR12 -> VAR32 = 0 ; break ; default : if ( VAR12 -> VAR32 & VAR57 ) { if ( VAR3 -> VAR25 >= 0 ) { FUN13 ( VAR3 -> VAR25 ) ; if ( VAR3 -> VAR44 == VAR3 -> VAR25 ) { VAR3 -> VAR44 = - 1 ; } VAR3 -> VAR25 = - 1 ; } VAR12 -> VAR32 = 0 ; VAR19 -- ; continue ; } if ( VAR12 -> VAR32 & VAR58 ) { if ( VAR3 -> VAR25 >= 0 ) { FUN13 ( VAR3 -> VAR25 ) ; if ( VAR3 -> VAR44 == VAR3 -> VAR25 ) { VAR3 -> VAR44 = - 1 ; } VAR3 -> VAR25 = - 1 ; } VAR19 -- ; VAR12 -> VAR32 = 0 ; continue ; } if ( VAR12 -> VAR32 & VAR59 ) { VAR19 -- ; VAR12 -> VAR32 = 0 ; if ( VAR3 -> VAR25 >= 0 ) { FUN13 ( VAR3 -> VAR25 ) ; if ( VAR3 -> VAR44 == VAR3 -> VAR25 ) { VAR3 -> VAR44 = - 1 ; } VAR3 -> VAR25 = - 1 ; } continue ; } if ( VAR12 -> VAR32 & VAR30 ) { if ( VAR3 -> VAR29 == NULL ) { VAR19 -- ; VAR12 -> VAR32 = 0 ; continue ; } while ( VAR3 -> VAR29 ) { if ( FUN14 ( VAR3 , NULL , VAR3 -> VAR29 -> VAR60 , 0 ) ) { break ; } VAR6 = VAR3 -> VAR29 ; VAR3 -> VAR29 = VAR6 -> VAR61 ; FUN15 ( VAR6 -> VAR60 -> VAR17 ) ; FUN15 ( VAR6 -> VAR60 ) ; FUN15 ( VAR6 ) ; } VAR19 -- ; VAR12 -> VAR32 = 0 ; continue ; } if ( VAR12 -> VAR32 & VAR28 ) { VAR19 -- ; VAR3 -> VAR56 = VAR12 -> VAR32 ; VAR12 -> VAR32 = 0 ; if ( VAR3 -> VAR33 == VAR47 ) { VAR3 -> VAR33 = VAR62 ; } return ( VAR3 ) ; } break ; } } } }