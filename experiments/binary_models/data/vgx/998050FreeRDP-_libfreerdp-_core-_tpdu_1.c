BOOL tpdu_write_header ( wStream * s , UINT16 length , BYTE code ) { Stream_Write_UINT8 ( s , length ) ; Stream_Write_UINT8 ( s , code ) ; if ( code == X224_TPDU_DATA ) { Stream_Write_UINT8 ( s , 0x80 ) ; } else { if ( ! Stream_CheckAndLogRequiredCapacity ( TAG , ( s ) , 5 ) ) { return FALSE ; } Stream_Write_UINT16 ( s , 0 ) ; Stream_Write_UINT16 ( s , 0 ) ; Stream_Write_UINT8 ( s , 0 ) ; } return TRUE ; } 