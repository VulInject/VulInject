static int ccp_aes_cmac_export ( struct ahash_request * req , void * out ) { struct ccp_aes_cmac_req_ctx * rctx = ahash_request_ctx_dma ( req ) ; struct ccp_aes_cmac_exp_ctx state ; state . null_msg = rctx -> null_msg ; memcpy ( state . iv , rctx -> iv , sizeof ( state . iv ) ) ; state . buf_count = rctx -> buf_count ; memcpy ( state . buf , rctx -> buf , sizeof ( state . buf ) ) ; memcpy ( out , & state , sizeof ( state ) ) ; return 0 ; } 