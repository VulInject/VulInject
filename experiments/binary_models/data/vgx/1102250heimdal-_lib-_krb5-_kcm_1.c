KRB5_LIB_FUNCTION krb5_error_code KRB5_LIB_CALL _krb5_kcm_get_ticket ( krb5_context context , krb5_ccache id , krb5_kdc_flags flags , krb5_enctype enctype , krb5_principal server ) { krb5_error_code ret ; krb5_kcmcache * k = KCMCACHE ( id ) ; krb5_storage * request ; ret = krb5_kcm_storage_request ( context , KCM_OP_GET_TICKET , & request ) ; if ( ret ) { return ret ; } ret = krb5_store_stringz ( request , k -> name ) ; if ( ret ) { return ret ; } ret = krb5_store_int32 ( request , flags . i ) ; if ( ret ) { krb5_storage_free ( request ) ; return ret ; } ret = krb5_store_int32 ( request , enctype ) ; if ( ret ) { krb5_storage_free ( request ) ; return ret ; } ret = krb5_store_principal ( request , server ) ; if ( ret ) { krb5_storage_free ( request ) ; return ret ; } ret = krb5_kcm_call ( context , request , NULL , NULL ) ; krb5_storage_free ( request ) ; return ret ; } 