static inline unsigned int mlx5e_calc_min_inline ( enum mlx5_inline_modes mode , struct sk_buff * skb ) { int hlen ; switch ( mode ) { case MLX5_INLINE_MODE_NONE : return 0 ; case MLX5_INLINE_MODE_TCP_UDP : hlen = eth_get_headlen ( skb -> data , skb_headlen ( skb ) ) ; if ( hlen == ETH_HLEN && ! skb_vlan_tag_present ( skb ) ) { hlen += VLAN_HLEN ; } return hlen ; case MLX5_INLINE_MODE_IP : case MLX5_INLINE_MODE_L2 : default : return mlx5e_skb_l2_header_offset ( skb ) ; } } 