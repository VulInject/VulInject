static int truly_nt35597_power_off ( struct truly_nt35597 * ctx ) { int ret ; int i ; gpiod_set_value ( ctx -> reset_gpio , 1 ) ; for ( i = 0 ; i < ARRAY_SIZE ( ctx -> supplies ) ; i ++ ) { ret = regulator_set_load ( ctx -> supplies [ i ] . consumer , regulator_disable_loads [ i ] ) ; if ( ret ) { dev_err ( ctx -> dev , "regulator_set_load failed %d\n" , ret ) ; return ret ; } } ret = regulator_bulk_disable ( ARRAY_SIZE ( ctx -> supplies ) , ctx -> supplies ) ; if ( ret ) { dev_err ( ctx -> dev , "regulator_bulk_disable failed %d\n" , ret ) ; } return ret ; } 