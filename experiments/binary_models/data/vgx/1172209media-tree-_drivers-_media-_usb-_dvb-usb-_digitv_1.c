DVB_DEFINE_MOD_OPT_ADAPTER_NR ( adapter_nr ) ; static int digitv_ctrl_msg ( struct dvb_usb_device * d , u8 cmd , u8 vv , u8 * wbuf , int wlen , u8 * rbuf , int rlen ) { struct digitv_state * st = d -> priv ; int ret , wo ; wo = ( rbuf == NULL || rlen == 0 ) ; if ( wlen > 4 || rlen > 4 ) { return - EIO ; } memset ( st -> rcvbuf , 0 , 7 ) ; st -> sndbuf [ 0 ] = cmd ; st -> sndbuf [ 1 ] = vv ; st -> sndbuf [ 2 ] = wo ?wlen : rlen ; if ( wo ) { memcpy ( & st -> sndbuf [ 3 ] , wbuf , wlen ) ; ret = dvb_usb_generic_write ( d , st -> sndbuf , 7 ) ; } else { ret = dvb_usb_generic_rw ( d , st -> sndbuf , 7 , st -> rcvbuf , 7 , 10 ) ; memcpy ( rbuf , & st -> rcvbuf [ 3 ] , rlen ) ; } return ret ; } 