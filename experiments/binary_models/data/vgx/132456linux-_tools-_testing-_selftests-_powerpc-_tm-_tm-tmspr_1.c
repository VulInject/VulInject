int test_tmspr ( ) { pthread_t * thread ; int thread_num ; unsigned long i ; SKIP_IF ( ! have_htm ( ) ) ; SKIP_IF ( htm_is_synthetic ( ) ) ; thread_num = 10 * sysconf ( _SC_NPROCESSORS_ONLN ) ; thread = malloc ( thread_num * sizeof ( pthread_t ) ) ; if ( thread == NULL ) { return EXIT_FAILURE ; } for ( i = 0 ; i < thread_num ; i += 2 ) { if ( pthread_create ( & thread [ i ] , NULL , ( void * ) tfiar_tfhar , ( void * ) i ) ) { return EXIT_FAILURE ; } } for ( i = 1 ; i < thread_num ; i += 2 ) { if ( pthread_create ( & thread [ i ] , NULL , ( void * ) texasr , ( void * ) i ) ) { return EXIT_FAILURE ; } } for ( i = 0 ; i < thread_num ; i ++ ) { if ( pthread_join ( thread [ i ] , NULL ) != 0 ) { return EXIT_FAILURE ; } } if ( passed ) { return 0 ; } else { return 1 ; } } 