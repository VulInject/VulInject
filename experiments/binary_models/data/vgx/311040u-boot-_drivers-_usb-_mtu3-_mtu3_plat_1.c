static int mtu3_glue_bind ( struct udevice * parent ) { struct udevice * dev ; enum usb_dr_mode dr_mode ; const char * driver ; const char * name ; ofnode node ; int ret ; node = ofnode_by_compatible ( dev_ofnode ( parent ) , "mediatek,ssusb" ) ; name = ofnode_get_name ( node ) ; dr_mode = usb_get_dr_mode ( node ) ; switch ( dr_mode ) { case USB_DR_MODE_PERIPHERAL : case USB_DR_MODE_OTG : dev_dbg ( parent , "%s: dr_mode: peripheral\n" , __func__ ) ; driver = "mtu3-peripheral" ; break ; ( ! defined ( CONFIG_SPL_BUILD ) && defined ( CONFIG_USB_HOST ) ) ; case USB_DR_MODE_HOST : dev_dbg ( parent , "%s: dr_mode: host\n" , __func__ ) ; driver = "mtu3-host" ; break ; default : dev_err ( parent , "%s: unsupported dr_mode %d\n" , __func__ , dr_mode ) ; return - ENODEV ; } dev_dbg ( parent , "%s: node name: %s, driver %s, dr_mode %d\n" , __func__ , name , driver , dr_mode ) ; ret = device_bind_driver_to_node ( parent , driver , name , node , & dev ) ; if ( ret ) { dev_err ( parent , "%s: not able to bind usb device mode\n" , __func__ ) ; } return ret ; } 