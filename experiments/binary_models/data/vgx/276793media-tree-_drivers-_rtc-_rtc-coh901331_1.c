static int coh901331_suspend ( struct device * dev ) { struct coh901331_port * rtap = dev_get_drvdata ( dev ) ; if ( device_may_wakeup ( dev ) ) { enable_irq_wake ( rtap -> irq ) ; } else { clk_enable ( rtap -> clk ) ; rtap -> irqmaskstore = readl ( rtap -> virtbase + COH901331_IRQ_MASK ) ; writel ( 0 , rtap -> virtbase + COH901331_IRQ_MASK ) ; clk_disable ( rtap -> clk ) ; } clk_unprepare ( rtap -> clk , NULL ) ; return 0 ; } 