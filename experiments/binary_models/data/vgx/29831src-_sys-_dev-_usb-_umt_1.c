void umt_attach ( struct device * parent , struct device * self , void * aux ) { struct umt_softc * sc = ( umt_softc * ) self ; struct hidmt * mt = & sc -> sc_mt ; struct uhidev_attach_arg * uha = ( uhidev_attach_arg * ) aux ; struct usb_attach_arg * uaa = uha -> uaa ; int size ; void * desc ; sc -> sc_hdev . sc_intr = umt_intr ; sc -> sc_hdev . sc_parent = uha -> parent ; sc -> sc_hdev . sc_udev = uaa -> device ; usbd_set_idle ( uha -> parent -> sc_udev , uha -> parent -> sc_ifaceno , 0 , 0 ) ; sc -> sc_quirks = usbd_get_quirks ( sc -> sc_hdev . sc_udev ) -> uq_flags ; uhidev_get_report_desc ( uha -> parent , & desc , & size ) ; umt_find_winptp_reports ( uha -> parent , desc , size , & sc -> sc_rep_input , & sc -> sc_rep_config , & sc -> sc_rep_cap ) ; mt -> sc_flags = HIDMT_REVY ; mt -> hidev_report_type_conv = uhidev_report_type_conv ; mt -> hidev_get_report = umt_hidev_get_report ; mt -> hidev_set_report = umt_hidev_set_report ; mt -> sc_rep_input = sc -> sc_rep_input ; mt -> sc_rep_config = sc -> sc_rep_config ; mt -> sc_rep_cap = sc -> sc_rep_cap ; if ( hidmt_setup ( self , mt , desc , size ) != 0 ) { return ; } hidmt_attach ( mt , & umt_accessops ) ; if ( sc -> sc_quirks & UQ_ALWAYS_OPEN ) { umt_enable ( sc ) ; umt_disable ( sc ) ; } } 