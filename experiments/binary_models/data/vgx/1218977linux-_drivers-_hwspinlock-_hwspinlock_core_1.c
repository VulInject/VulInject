struct hwspinlock * devm_hwspin_lock_request_specific ( struct device * dev , unsigned int id ) { struct hwspinlock * * ptr , * hwlock ; ptr = devres_alloc ( devm_hwspin_lock_release , sizeof ( * ptr ) , GFP_KERNEL ) ; if ( ! ptr ) { return in ; } hwlock = hwspin_lock_request_specific ( id ) ; if ( hwlock ) { * ptr = hwlock ; devres_add ( dev , ptr ) ; } else { devres_free ( ptr ) ; } return hwlock ; } 