void k5_release_ccapi_cred ( cc_credentials_union * ccapi_cred ) { cc_credentials_v5_t * cv5 ; if ( ccapi_cred == NULL ) { return ; } if ( ccapi_cred -> version != cc_credentials_v5 ) { return ; } if ( ccapi_cred -> credentials . credentials_v5 == NULL ) { return ; } cv5 = ccapi_cred -> credentials . credentials_v5 ; free ( cv5 -> client ) ; free ( cv5 -> server ) ; free ( cv5 -> ticket . data ) ; free ( cv5 -> second_ticket . data ) ; free_cc_data_list ( cv5 -> addresses ) ; free_cc_data_list ( cv5 -> authdata ) ; free ( cv5 ) ; free ( ccapi_cred ) ; } 