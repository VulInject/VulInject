void prepare_ftrace_return ( unsigned long * parent , unsigned long self_addr , unsigned long frame_pointer ) { struct ftrace_graph_ent trace ; cfs_time_t return_hooker = ( unsigned long ) & return_to_handler ; if ( unlikely ( atomic_read ( & current -> tracing_graph_pause ) ) ) { return ; } if ( ftrace_push_return_trace ( * parent , self_addr , & trace . depth , frame_pointer , NULL ) == - EBUSY ) { return ; } trace . func = self_addr ; if ( ! ftrace_graph_entry ( & trace ) ) { current -> curr_ret_stack -- ; return ; } * parent = return_hooker ; } 