static void suspend_system ( struct rtcwake_control * ctl ) { FILE * f = fopen ( SYS_POWER_STATE_PATH , "w" ) ; if ( ! f ) { warn ( _ ( "cannot open %s" ) , SYS_POWER_STATE_PATH ) ; return ; } if ( ! ctl -> dryrun ) { if ( isatty ( STDIN_FILENO ) ) { wait_stdin ( ctl ) ; } fprintf ( f , "%s\n" , ctl -> mode_str ) ; fflush ( f , NULL ) ; } if ( close_stream ( f ) ) { errx ( EXIT_FAILURE , _ ( "write error" ) ) ; } } 