static int stm32f4_i2c_remove ( struct platform_device * pdev ) { struct stm32f4_i2c_dev * i2c_dev = platform_get_drvdata ( pdev ) ; i2c_del_adapter ( & i2c_dev -> adap ) ; clk_unprepare ( i2c_dev -> clk , NULL ) ; return 0 ; } 