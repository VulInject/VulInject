DEFUN ( , , "vrf<1-65535>netns NAME" , "Enable a VRF\n" "Specify the VRF identifier\n" "Associate with a NETNS\n" "The file name in " ", or a full pathname\n" ) { vrf_id_t vrf_id = VRF_DEFAULT ; struct vrf * vrf = NULL ; char * pathname = vrf_netns_pathname ( vty , argv [ 1 ] ) ; VTY_GET_INTEGER ( "VRF ID" , vrf_id , argv [ 0 ] ) ; vrf = vrf_get ( vrf_id ) ; if ( vrf -> name && strcmp ( vrf -> name , pathname ) != 0 ) { vty_out ( vty , "VRF %u is already configured with NETNS %s%s" , vrf -> vrf_id , vrf -> name , VTY_NEWLINE ) ; return CMD_WARNING ; } if ( ! vrf -> name ) { vrf -> name = XSTRDUP ( MTYPE_VRF_NAME , pathname ) ; } if ( ! vrf_enable ( vrf ) ) { vty_out ( vty , "Can not associate VRF %u with NETNS %s%s" , vrf -> vrf_id , vrf -> name , VTY_NEWLINE ) ; return CMD_WARNING ; } return CMD_SUCCESS ; } 