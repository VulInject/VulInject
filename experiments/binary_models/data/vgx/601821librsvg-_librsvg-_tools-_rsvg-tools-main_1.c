static gboolean read_contents ( const gchar * file_name , guint8 * * contents , gsize * length ) { GFile * file ; GFileInputStream * input_stream ; gboolean success = FALSE ; file = g_file_new_for_commandline_arg ( file_name ) ; input_stream = g_file_read ( file , NULL , NULL ) ; if ( input_stream ) { GFileInfo * file_info ; file_info = g_file_input_stream_query_info ( input_stream , G_FILE_ATTRIBUTE_STANDARD_SIZE , NULL , NULL ) ; if ( file_info ) { gsize bytes_read ; * length = g_file_info_get_size ( file_info ) ; * contents = g_new ( guint8 , * length ) ; success = g_input_stream_read_all ( G_INPUT_STREAM ( input_stream ) , * contents , * length , & bytes_read , NULL , NULL ) ; } g_object_unref ( input_stream ) ; } g_object_unref ( file ) ; return success ; } 