int resolver_cmp ( const void * _a , const void * _b ) { const enum uw_resolver_type a = * ( const uw_resolver_type * ) _a ; const enum uw_resolver_type b = * ( const uw_resolver_type * ) _b ; int64_t a_median , b_median ; if ( resolvers [ b ] == NULL ) { return - 1 ; } if ( resolvers [ a ] == NULL ) { return 1 ; } if ( resolvers [ a ] -> state < resolvers [ b ] -> state ) { return 1 ; } if ( resolvers [ a ] -> state > resolvers [ b ] -> state ) { return - 1 ; } else { a_median = resolvers [ a ] -> median ; b_median = resolvers [ b ] -> median ; if ( resolvers [ a ] -> type == resolver_conf -> res_pref . types [ 0 ] ) { a_median -= PREF_RESOLVER_MEDIAN_SKEW ; } if ( resolvers [ b ] -> type == resolver_conf -> res_pref . types [ 0 ] ) { b_median -= PREF_RESOLVER_MEDIAN_SKEW ; } if ( a_median < b_median ) { return - 1 ; } if ( a_median > b_median ) { return 1 ; } else { return 0 ; } } } 