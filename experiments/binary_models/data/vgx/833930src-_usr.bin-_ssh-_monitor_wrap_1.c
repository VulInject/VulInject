int mm_ssh_gssapi_userok ( char * user ) { struct sshbuf * m ; int r , authenticated = 0 ; if ( ( m = sshbuf_new ( ) ) == NULL ) { fatal_f ( "sshbuf_new failed" ) ; } mm_request_send ( pmonitor -> m_recvfd , MONITOR_REQ_GSSUSEROK , m ) ; mm_request_receive_expect ( pmonitor -> m_recvfd , MONITOR_ANS_GSSUSEROK , m ) ; if ( ( r = sshbuf_get_u32 ( m , & authenticated ) ) != 0 ) { fatal_fr ( r , "parse" ) ; } debug3_f ( "user %sauthenticated" , authenticated ?"" : "not " ) ; return ( authenticated ) ; } 