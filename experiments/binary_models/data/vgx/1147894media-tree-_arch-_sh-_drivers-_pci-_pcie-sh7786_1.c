static void __init sh7786_pcie_init_hw ( void * data , async_cookie_t cookie ) { struct sh7786_pcie_port * port = data ; int ret ; port -> endpoint = test_mode_pin ( MODE_PIN11 ) ; ret = pcie_clk_init ( port , NULL ) ; if ( unlikely ( ret < 0 ) ) { pr_err ( "clock initialization failed for port#%d\n" , port -> index ) ; return ; } ret = phy_init ( port ) ; if ( unlikely ( ret < 0 ) ) { pr_err ( "phy initialization failed for port#%d\n" , port -> index ) ; return ; } ret = pcie_init ( port ) ; if ( unlikely ( ret < 0 ) ) { pr_err ( "core initialization failed for port#%d\n" , port -> index ) ; return ; } async_synchronize_cookie ( cookie ) ; register_pci_controller ( port -> hose ) ; } 