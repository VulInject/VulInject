CK_RV C_SignEncryptUpdate ( CK_SESSION_HANDLE hSession , CK_BYTE_PTR pPart , CK_ULONG ulPartLen , CK_BYTE_PTR pEncryptedPart , CK_ULONG_PTR pulEncryptedPartLen ) { CK_RV rv ; pkcs11_session_t * sessp ; if ( purefastpath || policyfastpath ) { return ( fast_funcs -> C_SignEncryptUpdate ( hSession , pPart , ulPartLen , pEncryptedPart , pulEncryptedPartLen ) ) ; } if ( ! pkcs11_initialized ) { return ( CKR_CRYPTOKI_NOT_INITIALIZED ) ; } HANDLE2SESSION ( hSession , sessp , rv ) ; rv = FUNCLIST ( sessp -> se_slotid ) -> C_SignEncryptUpdate ( sessp -> se_handle , pPart , ulPartLen , pEncryptedPart , pulEncryptedPartLen ) ; if ( rv == CKR_FUNCTION_NOT_SUPPORTED ) { return ( CKR_FUNCTION_FAILED ) ; } return ( rv ) ; } 