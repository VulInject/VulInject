static void smack_cred_free ( struct cred * cred ) { struct task_smack * tsp = cred -> security ; struct smack_rule * rp ; struct list_head * l ; struct list_head * n ; if ( tsp == NULL ) { return ; } cred -> security = NULL ; smk_destroy_label_list ( & tsp -> smk_relabel ) ; list_for_each_safe ( , , ) { rp = list_entry ( l , smack_rule , list ) ; list_del ( & rp -> list ) ; } kfree ( tsp ) ; } 