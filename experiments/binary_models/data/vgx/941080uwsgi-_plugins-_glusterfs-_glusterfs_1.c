static int uwsgi_glusterfs_read_sync ( struct wsgi_request * wsgi_req , glfs_fd_t * fd , size_t remains ) { while ( remains > 0 ) { int buf [ 8192 ] ; ssize_t rlen = glfs_read ( fd , buf , UMIN ( remains , 8192 ) , 0 ) ; if ( rlen <= 0 ) { return - 1 ; } if ( uwsgi_response_write_body_do ( wsgi_req , buf , rlen ) ) { return - 1 ; } remains -= rlen ; } return 0 ; } uwsgi_glusterfs_async_io { int fd [ 2 ] ; ssize_t rlen ; } 