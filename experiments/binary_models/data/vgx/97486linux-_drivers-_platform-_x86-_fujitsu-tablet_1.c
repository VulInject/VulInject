static int acpi_fujitsu_add ( struct acpi_device * adev ) { acpi_status status ; int error ; status = acpi_walk_resources ( adev -> handle , METHOD_NAME__CRS , fujitsu_walk_resources , NULL ) ; if ( ACPI_FAILURE ( status ) || ! fujitsu . irq || ! fujitsu . io_base ) { return - ENODEV ; } sprintf ( acpi_device_name ( adev ) , "Fujitsu %s" , acpi_device_hid ( adev ) ) ; sprintf ( acpi_device_class ( adev ) , "%s" , ACPI_FUJITSU_CLASS ) ; snprintf ( fujitsu . phys , sizeof ( fujitsu . phys ) , "%s/input0" , acpi_device_hid ( adev ) ) ; error = input_fujitsu_setup ( & adev -> dev , acpi_device_name ( adev ) , fujitsu . phys ) ; if ( error ) { return error ; } if ( ! request_region ( fujitsu . io_base , fujitsu . io_length , MODULENAME ) ) { input_fujitsu_remove ( ) ; return - EBUSY ; } fujitsu_reset ( ) ; error = request_irq ( fujitsu . irq , fujitsu_interrupt , IRQF_SHARED , MODULENAME , fujitsu_interrupt ) ; if ( error ) { release_region ( fujitsu . io_base , fujitsu . io_length ) ; input_fujitsu_remove ( ) ; return error ; } return 0 ; } 