static void zfcp_erp_strategy_check_fsfreq ( struct zfcp_erp_action * act ) { struct zfcp_adapter * adapter = act -> adapter ; struct zfcp_fsf_req * req ; if ( ! act -> fsf_req_id ) { return ; } spin_lock ( & adapter -> req_list -> lock ) ; req = _zfcp_reqlist_find ( adapter -> req_list , act -> fsf_req_id ) ; if ( req && req -> erp_action == act ) { if ( act -> status & ( ZFCP_STATUS_ERP_DISMISSED | ZFCP_STATUS_ERP_TIMEDOUT ) ) { req -> status |= ZFCP_STATUS_FSFREQ_DISMISSED ; zfcp_dbf_rec_run ( "erscf_1" , act ) ; } if ( act -> status & ZFCP_STATUS_ERP_TIMEDOUT ) { zfcp_dbf_rec_run ( "erscf_2" , act ) ; } if ( req -> status & ZFCP_STATUS_FSFREQ_DISMISSED ) { act -> fsf_req_id = 0 ; } } else { act -> fsf_req_id = 0 ; } spin_unlock ( & adapter -> req_list -> lock ) ; } 