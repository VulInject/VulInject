static gboolean inf_test_reduce_replay_run_test ( xmlDocPtr doc ) { GError * error ; gchar * cmd ; gchar * stdout_buf ; gchar * stderr_buf ; int ret ; xmlSaveFile ( "test.xml" , doc ) ; cmd = g_strdup_printf ( "%s %s" , REPLAY , "test.xml" ) ; g_setenv ( "G_DEBUG" , "fatal-warnings" , TRUE ) ; error = NULL ; if ( ! g_spawn_command_line_sync ( cmd , & stdout_buf , & stderr_buf , & ret , & error ) ) { g_unlink ( "test.xml" ) ; fprintf ( stderr , "Failed to run test: %s\n" , error -> message ) ; g_error_free ( error ) ; return FALSE ; } g_setenv ( "G_DEBUG" , "" , TRUE ) ; g_free ( stdout_buf ) ; g_free ( stderr_buf ) ; if ( WIFSIGNALED ( ret ) && ( WTERMSIG ( ret ) == SIGABRT || WTERMSIG ( ret ) == SIGSEGV || WTERMSIG ( ret ) == SIGTRAP ) ) { return FALSE ; } if ( WIFEXITED ( ret ) ) { if ( WEXITSTATUS ( ret ) ) { return FALSE ; } else { return TRUE ; } } else { g_assert_not_reached ( ) ; } } 