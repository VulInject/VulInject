void FUN1(struct VAR1 *VAR2, VAR3 *VAR4) {
int VAR5;
int VAR6[32];
VAR7 *VAR8;
int VAR9, VAR10, VAR11, VAR12, VAR13;

if ( VAR4->VAR14==NULL || VAR4->VAR14->VAR15==0 ||
VAR4->VAR14->VAR16==NULL )
return;

VAR8 = FUN2(VAR4,&VAR5);

VAR2->VAR12 = FUN3();
FUN4(VAR2->VAR12,0x00010000);	
if ( VAR5 & 0x100 )		
FUN5(VAR2->VAR12,0);		
else
FUN5(VAR2->VAR12,1);		
FUN5(VAR2->VAR12,VAR5&0x1f);





FUN6(VAR4,VAR5&0x1f,VAR6);

for ( VAR9=0; VAR9<32; ++VAR9 )
FUN5(VAR2->VAR12,VAR6[VAR9]);

if ( !(VAR5&0x100) ) {
VAR5 &= 0x1f;

FUN5(VAR2->VAR12,2);	

VAR13 = 0;
for ( VAR9=0; VAR9<VAR2->VAR17.VAR18; ++VAR9 ) if ( (VAR10=VAR2->VAR17.VAR19[VAR9])!=-1 ) {
if ( VAR8[VAR10]!=-1 && VAR8[VAR10]!=VAR5 ) {
VAR12 = VAR8[VAR10];
for ( VAR11=VAR9; VAR11<VAR2->VAR17.VAR18 && VAR8[VAR2->VAR17.VAR19[VAR9]]==VAR12; ++VAR11 );
VAR9 = VAR11-1;
++VAR13;
}
}


FUN5(VAR2->VAR12,6);		
FUN5(VAR2->VAR12,VAR13);		
for ( VAR11=1, VAR9=0; VAR13<=VAR11; VAR11<<=1, ++VAR9 );
FUN5(VAR2->VAR12,6*VAR11/2);	
FUN5(VAR2->VAR12,VAR9-1);
FUN5(VAR2->VAR12,6*(VAR13-(VAR11>>1)) );

for ( VAR9=0; VAR9<VAR2->VAR17.VAR18; ++VAR9 ) if ( (VAR10=VAR2->VAR17.VAR19[VAR9])!=-1 ) {
if ( VAR8[VAR10]!=-1 && VAR8[VAR10]!=VAR5 ) {
VAR12 = VAR8[VAR10];
for ( VAR11=VAR9; VAR11<VAR2->VAR17.VAR18 && VAR8[VAR2->VAR17.VAR19[VAR9]]==VAR12; ++VAR11 );
FUN5(VAR2->VAR12,VAR11-1);
FUN5(VAR2->VAR12,VAR9);
FUN5(VAR2->VAR12,VAR12);
VAR9 = VAR11-1;
}
}

FUN5(VAR2->VAR12,0xffff);		
FUN5(VAR2->VAR12,0xffff);
FUN5(VAR2->VAR12,0x0000);
}

VAR2->VAR20 = FUN7(VAR2->VAR12);

if ( VAR2->VAR20&2 )
FUN5(VAR2->VAR12,0);
free(VAR8);
}