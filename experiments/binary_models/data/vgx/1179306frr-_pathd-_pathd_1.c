void srte_candidate_unset_segment_list ( const char * originator , bool force ) { if ( originator == NULL ) { zlog_warn ( "Cannot unset segment list because originator is NULL" ) ; return ; } PATH_POLICY_DEBUG ( "Unset segment lists for originator %s" , originator ) ; struct srte_policy * policy ; RB_FOREACH ( , , ) { PATH_POLICY_DEBUG ( "Unset segment lists checking policy %s" , policy -> name ) ; struct srte_candidate * candidate ; RB_FOREACH ( , , ) { PATH_POLICY_DEBUG ( "Unset segment lists checking candidate %s" , candidate -> name ) ; if ( candidate -> lsp == NULL ) { continue ; } struct srte_segment_list * segment_list = candidate -> lsp -> segment_list ; if ( segment_list -> protocol_origin == SRTE_ORIGIN_LOCAL ) { zlog_warn ( "Cannot unset segment list %s because it was created locally" , segment_list -> name ) ; continue ; } if ( strncmp ( segment_list -> originator , originator , sizeof ( segment_list -> originator ) ) == 0 || force ) { PATH_POLICY_DEBUG ( "Unset segment list %s" , segment_list -> name ) ; SET_FLAG ( segment_list -> flags , F_SEGMENT_LIST_DELETED ) ; SET_FLAG ( candidate -> flags , F_CANDIDATE_MODIFIED ) ; candidate -> lsp -> segment_list = NULL ; } } } } 