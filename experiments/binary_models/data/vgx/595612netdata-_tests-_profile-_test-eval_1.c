int main ( int argc , char * * argv ) { if ( argc != 2 ) { fprintf ( stderr , "I need an expression (enclose it in single-quotes (') as a single parameter)\n" ) ; exit ( 1 ) ; } const char * failed_at = NULL ; int error ; EVAL_EXPRESSION * exp = expression_parse ( argv [ 1 ] , & failed_at , & error ) ; if ( ! exp ) { printf ( "\nPARSING FAILED\nExpression: '%s'\nParsing stopped at: '%s'\nParsing error code: %d (%s)\n" , argv [ 1 ] , ( failed_at ) ?( ( * failed_at ) ?failed_at : "<END OF EXPRESSION>" ) else "<NONE>" , error , expression_strerror ( error ) ) ; } else { printf ( "\nPARSING OK\nExpression: '%s'\nParsed as : '%s'\nParsing error code: %d (%s)\n" , argv [ 1 ] , exp -> parsed_as , error , expression_strerror ( error ) ) ; if ( expression_evaluate ( exp ) ) { printf ( "\nEvaluates to: %Lf\n\n" , exp -> result ) ; } else { printf ( "\nEvaluation failed with code %d and message: %s\n\n" , exp -> error , buffer_tostring ( exp -> error_msg ) ) ; } } return 0 ; } 