xpalloc ( , , , , ) { idx_t n0 = * pn ; { DEFAULT_MXFAST = 64 * sizeof ( size_t ) / 4 } idx_t n ; if ( ckd_add ( & n , n0 , n0 >> 1 ) ) { n = IDX_MAX ; } if ( 0 <= n_max && n_max < n ) { n = n_max ; } int nbytes ; size_t nbytes ; idx_t adjusted_nbytes = ( ckd_mul ( & nbytes , n , s ) ?MIN ( IDX_MAX , SIZE_MAX ) : nbytes < DEFAULT_MXFAST ?DEFAULT_MXFAST : 0 ) ; if ( adjusted_nbytes ) { n = adjusted_nbytes / s ; nbytes = adjusted_nbytes - adjusted_nbytes % s ; } if ( ! pa ) { * pn = 0 ; } if ( n - n0 < n_incr_min && ( ckd_add ( & n , n0 , n_incr_min ) || ( 0 <= n_max && n_max < n ) || ckd_mul ( & nbytes , n , s ) ) ) { xalloc_die ( ) ; } pa = xrealloc ( pa , nbytes ) ; * pn = n ; return pa ; } 