bytearray_t * bytearray_inflate ( bytearray_t * array , int max_size ) { uint8_t * inflation ; bytearray_t * new_array ; size_t output_size ; console_log ( 3 , "inflating byte array #%u from source byte array #%u" , s_next_array_id , array -> id ) ; inflation = z_inflate ( array -> buffer , array -> size , max_size , & output_size ) ; if ( ! ( new_array = calloc ( 1 , sizeof ( bytearray_t ) ) ) ) { on_error } new_array -> id = s_next_array_id ++ ; new_array -> buffer = inflation ; new_array -> size = ( int ) output_size ; return bytearray_ref ( new_array ) ; on_error free ( inflation ) ; return NULL ; } 