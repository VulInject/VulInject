MLPEncodeContext { AVCodecContext * avctx ; int num_substreams ; int num_channels ; int coded_sample_fmt [ 2 ] ; int coded_sample_rate [ 2 ] ; int coded_peak_bitrate ; int flags ; int substream_info ; int thd_substream_info ; int fs ; int wordlength ; int channel_occupancy ; int summary_info ; int32_t * inout_buffer ; int32_t * major_inout_buffer ; int32_t * write_buffer ; int32_t * sample_buffer ; int32_t * major_scratch_buffer ; int32_t last_frames ; int32_t * lpc_sample_buffer ; unsigned int major_number_of_frames ; unsigned int next_major_number_of_frames ; unsigned int major_frame_size ; unsigned int next_major_frame_size ; int32_t * lossless_check_data ; unsigned int * max_output_bits ; unsigned int frame_index ; unsigned int one_sample_buffer_size ; unsigned int max_restart_interval ; unsigned int min_restart_interval ; unsigned int restart_intervals ; uint16_t output_timing ; uint16_t input_timing ; uint8_t channel_arrangement ; uint8_t ch_modifier_thd0 ; uint8_t ch_modifier_thd1 ; uint8_t ch_modifier_thd2 ; unsigned int seq_size [ MAJOR_HEADER_INTERVAL ] ; unsigned int seq_offset [ MAJOR_HEADER_INTERVAL ] ; unsigned int sequence_size ; ChannelParams * channel_params ; BestOffset best_offset [ MAJOR_HEADER_INTERVAL + 1 ] [ MAX_CHANNELS ] [ NUM_CODEBOOKS ] ; DecodingParams * decoding_params ; RestartHeader restart_header ; ChannelParams major_channel_params [ MAJOR_HEADER_INTERVAL + 1 ] [ MAX_CHANNELS ] ; DecodingParams major_decoding_params [ MAJOR_HEADER_INTERVAL + 1 ] ; int major_params_changed [ MAJOR_HEADER_INTERVAL + 1 ] ; unsigned int major_cur_subblock_index ; unsigned int major_filter_state_subblock ; unsigned int major_number_of_subblocks ; BestOffset ( ) [ NUM_CODEBOOKS ] ; ChannelParams * cur_channel_params ; DecodingParams * cur_decoding_params ; RestartHeader * cur_restart_header ; AudioFrameQueue afq ; unsigned int number_of_frames ; unsigned int number_of_samples ; unsigned int number_of_subblocks ; unsigned int seq_index ; const ChannelParams * prev_channel_params ; const DecodingParams * prev_decoding_params ; ChannelParams * seq_channel_params ; DecodingParams * seq_decoding_params ; int32_t * filter_state_buffer [ NUM_FILTERS ] ; unsigned int max_codebook_search ; int shorten_by ; LPCContext lpc_ctx ; } MLPEncodeContext static ChannelParams restart_channel_params [ MAX_CHANNELS ] ; static DecodingParams restart_decoding_params [ MAX_SUBSTREAMS ] ; static const BestOffset restart_best_offset [ NUM_CODEBOOKS ] { { 0 } } ; ; static int compare_filter_params ( const ChannelParams * prev_cp , const ChannelParams * cp , int filter ) { const FilterParams * prev = & prev_cp -> filter_params [ filter ] ; const FilterParams * fp = & cp -> filter_params [ filter ] ; if ( prev -> order != fp -> order ) { return 1 ; } if ( prev -> shift != fp -> shift ) { return 1 ; } for ( int i = 0 ; i < fp -> order ; i ++ ) { if ( prev_cp -> coeff [ filter ] [ i ] != cp -> coeff [ filter ] [ i ] ) { return 1 ; } } return 0 ; } 