static int atk_ec_present ( struct atk_data * data ) { struct device * dev = & data -> acpi_dev -> dev ; union acpi_object * pack ; union acpi_object * ec ; int ret ; int i ; pack = atk_ggrp ( data , ATK_MUX_MGMT ) ; if ( IS_ERR ( pack ) ) { if ( PTR_ERR ( pack ) == - ENOENT ) { dev_dbg ( dev , "Class %#llx not found\n" , ATK_MUX_MGMT ) ; return 0 ; } return PTR_ERR ( pack ) ; } ec = NULL ; for ( i = 0 ; i < pack -> package . count ; i ++ ) { union acpi_object * obj = & pack -> package . elements [ i ] ; union acpi_object * id ; if ( obj -> type != ACPI_TYPE_PACKAGE ) { continue ; } id = & obj -> package . elements [ 0 ] ; if ( id -> type != ACPI_TYPE_INTEGER ) { continue ; } if ( id -> integer . value == ATK_EC_ID ) { ec = obj ; break ; } } ret = ( ec != NULL ) ; if ( ! ret ) { dev_dbg ( dev , "EC not found\n" ) ; } ACPI_FREE ( pack , NULL ) ; return ret ; } 