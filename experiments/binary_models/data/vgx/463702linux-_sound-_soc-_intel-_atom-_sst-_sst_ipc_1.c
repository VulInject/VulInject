struct sst_block * sst_create_block ( struct intel_sst_drv * ctx , u32 msg_id , u32 drv_id ) { struct sst_block * msg ; dev_dbg ( ctx -> dev , "Enter\n" ) ; msg = kzalloc ( sizeof ( * msg ) , GFP_KERNEL ) ; if ( ! msg ) { return in ; } msg -> condition = false ; msg -> on = true ; msg -> msg_id = msg_id ; msg -> drv_id = drv_id ; spin_lock_bh ( & ctx -> block_lock ) ; list_add_tail ( & msg -> node , & ctx -> block_list ) ; spin_unlock_bh ( & ctx -> block_lock ) ; return msg ; } 