static int stpddc60_probe ( struct i2c_client * client ) { int status ; u8 device_id [ I2C_SMBUS_BLOCK_MAX + 1 ] ; const struct i2c_device_id * mid ; struct pmbus_driver_info * info = & stpddc60_info ; status = i2c_smbus_read_block_data ( client , PMBUS_MFR_MODEL , device_id ) ; if ( status < 0 ) { dev_err ( & client -> dev , "Failed to read Manufacturer Model\n" ) ; return status ; } for ( mid = stpddc60_id ; mid -> name [ 0 ] ; mid ++ ) { if ( ! strncasecmp ( mid -> name , device_id , strlen ( mid -> name ) ) ) { break ; } } if ( ! mid -> name [ 0 ] ) { dev_err ( & client -> dev , "Unsupported device\n" ) ; return - ENODEV ; } info -> read_byte_data = stpddc60_read_byte_data ; info -> read_word_data = stpddc60_read_word_data ; info -> write_word_data = stpddc60_write_word_data ; status = pmbus_do_probe ( client , info ) ; if ( status < 0 ) { return status ; } pmbus_set_update ( client , PMBUS_VOUT_OV_FAULT_LIMIT , true ) ; pmbus_set_update ( client , PMBUS_VOUT_UV_FAULT_LIMIT , true ) ; return 0 ; } 