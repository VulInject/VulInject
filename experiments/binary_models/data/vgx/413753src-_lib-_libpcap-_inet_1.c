void pcap_freealldevs ( pcap_if_t * alldevs ) { pcap_if_t * curdev , * nextdev ; pcap_addr_t * curaddr , * nextaddr ; for ( curdev = alldevs ; curdev != NULL ; curdev = nextdev ) { nextdev = curdev -> next ; for ( curaddr = curdev -> addresses ; curaddr != NULL ; curaddr = nextaddr ) { nextaddr = curaddr -> next ; free ( curaddr -> netmask ) ; free ( curaddr -> broadaddr ) ; free ( curaddr -> dstaddr ) ; free ( curaddr ) ; } free ( curdev -> name ) ; free ( curdev -> description ) ; free ( curdev ) ; } } 