static int gsc_commit ( struct exynos_drm_ipp * ipp , struct exynos_drm_ipp_task * task ) { struct gsc_context * ctx = container_of ( ipp , gsc_context , ipp ) ; int ret ; ret = pm_runtime_resume_and_get ( ctx -> dev ) ; if ( ret < 0 ) { dev_err ( ctx -> dev , "failed to enable GScaler device.\n" ) ; return ret ; } ctx -> task = task ; ret = gsc_reset ( ctx ) ; if ( ret ) { pm_runtime_put_autosuspend ( ctx -> dev ) ; ctx -> task = NULL ; return ret ; } gsc_src_set_fmt ( ctx , task -> src . buf . fourcc , task -> src . buf . modifier ) ; gsc_src_set_transf ( ctx , task -> transform . rotation ) ; gsc_src_set_size ( ctx , & task -> src ) ; gsc_src_set_addr ( ctx , 0 , & task -> src ) ; gsc_dst_set_fmt ( ctx , task -> dst . buf . fourcc , task -> dst . buf . modifier ) ; gsc_dst_set_size ( ctx , & task -> dst ) ; gsc_dst_set_addr ( ctx , 0 , & task -> dst ) ; gsc_set_prescaler ( ctx , & ctx -> sc , & task -> src . rect , & task -> dst . rect ) ; gsc_start ( ctx , NULL ) ; return 0 ; } 