static int write_data ( struct rec_args * args , krb5_data * data ) { int ret ; char * hex ; struct rechandle * h = args -> rh ; struct tdopts * opts = args -> opts ; if ( data -> length == 0 && ! opts -> emptyhex_empty ) { if ( writefield ( h , "-1" ) < 0 ) { return - 1 ; } return 0 ; } ret = k5_hex_encode ( data -> data , data -> length , FALSE , & hex ) ; if ( ret ) { errno = ret ; return - 1 ; } ret = writefield ( h , "%s" , hex ) ; return ret ; } 