void RTC_GetDate ( uint32_t RTC_Format , RTC_DateTypeDef * RTC_DateStruct ) { int tmpreg = 0 ; assert_param ( IS_RTC_FORMAT ( RTC_Format ) ) ; tmpreg = ( uint32_t ) ( RTC -> DR & RTC_DR_RESERVED_MASK ) ; RTC_DateStruct -> RTC_Year = ( uint8_t ) ( ( tmpreg & ( RTC_DR_YT | RTC_DR_YU ) ) >> 16 ) ; RTC_DateStruct -> RTC_Month = ( uint8_t ) ( ( tmpreg & ( RTC_DR_MT | RTC_DR_MU ) ) >> 8 ) ; RTC_DateStruct -> RTC_Date = ( uint8_t ) ( tmpreg & ( RTC_DR_DT | RTC_DR_DU ) ) ; RTC_DateStruct -> RTC_WeekDay = ( uint8_t ) ( ( tmpreg & ( RTC_DR_WDU ) ) >> 13 ) ; if ( RTC_Format == RTC_Format_BIN ) { RTC_DateStruct -> RTC_Year = ( uint8_t ) RTC_Bcd2ToByte ( RTC_DateStruct -> RTC_Year ) ; RTC_DateStruct -> RTC_Month = ( uint8_t ) RTC_Bcd2ToByte ( RTC_DateStruct -> RTC_Month ) ; RTC_DateStruct -> RTC_Date = ( uint8_t ) RTC_Bcd2ToByte ( RTC_DateStruct -> RTC_Date ) ; } } 