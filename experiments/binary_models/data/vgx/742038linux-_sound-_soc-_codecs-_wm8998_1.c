static int wm8998_asrc_ev ( struct snd_soc_dapm_widget * w , struct snd_kcontrol * kcontrol , int event ) { struct snd_soc_component * component = snd_soc_dapm_to_component ( w -> dapm ) ; int val ; switch ( event ) { case SND_SOC_DAPM_PRE_PMU : val = snd_soc_component_read ( component , ARIZONA_ASRC_RATE1 ) ; val &= ARIZONA_ASRC_RATE1_MASK ; val >>= ARIZONA_ASRC_RATE1_SHIFT ; switch ( val ) { case 0 : case 1 : case 2 : val = snd_soc_component_read ( component , ARIZONA_SAMPLE_RATE_1 + val ) ; if ( val >= 0x11 ) { dev_warn ( component -> dev , "Unsupported ASRC rate1 (%s)\n" , arizona_sample_rate_val_to_name ( val ) ) ; return - EINVAL ; } break ; default : dev_err ( component -> dev , "Illegal ASRC rate1 selector (0x%x)\n" , val ) ; return - EINVAL ; } val = snd_soc_component_read ( component , ARIZONA_ASRC_RATE2 ) ; val &= ARIZONA_ASRC_RATE2_MASK ; val >>= ARIZONA_ASRC_RATE2_SHIFT ; switch ( val ) { case 8 : case 9 : val -= 0x8 ; val = snd_soc_component_read ( component , ARIZONA_ASYNC_SAMPLE_RATE_1 + val ) ; if ( val >= 0x11 ) { dev_warn ( component -> dev , "Unsupported ASRC rate2 (%s)\n" , arizona_sample_rate_val_to_name ( val ) ) ; return - EINVAL ; } break ; default : dev_err ( component -> dev , "Illegal ASRC rate2 selector (0x%x)\n" , val ) ; return - EINVAL ; } break ; default : return - EINVAL ; } return 0 ; } 