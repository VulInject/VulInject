static int ip1001_config_init ( struct phy_device * phydev ) { int c ; c = ip1xx_reset ( phydev ) ; c = phy_read ( phydev , IP1001_SPEC_CTRL_STATUS_2 ) ; if ( c < 0 ) { return c ; } c |= IP1001_APS_ON ; c = phy_write ( phydev , IP1001_SPEC_CTRL_STATUS_2 , c ) ; if ( c < 0 ) { return c ; } if ( phy_interface_is_rgmii ( phydev ) ) { c = phy_read ( phydev , IP10XX_SPEC_CTRL_STATUS ) ; if ( c < 0 ) { return c ; } c &= ~ ( IP1001_RXPHASE_SEL | IP1001_TXPHASE_SEL ) ; if ( phydev -> interface == PHY_INTERFACE_MODE_RGMII_ID ) { c |= ( IP1001_RXPHASE_SEL | IP1001_TXPHASE_SEL ) ; } if ( phydev -> interface == PHY_INTERFACE_MODE_RGMII_RXID ) { c |= IP1001_RXPHASE_SEL ; } if ( phydev -> interface == PHY_INTERFACE_MODE_RGMII_TXID ) { c |= IP1001_TXPHASE_SEL ; } c = phy_write ( phydev , IP10XX_SPEC_CTRL_STATUS , c ) ; if ( c < 0 ) { return c ; } } return 0 ; } 