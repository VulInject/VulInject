static int tree_current_is_dir ( struct tree * t ) { const struct stat * st ; if ( t -> flags & hasLstat ) { st = tree_current_lstat ( t , NULL ) ; if ( st == NULL ) { return 0 ; } if ( S_ISDIR ( st -> st_mode ) ) { return 1 ; } if ( ! S_ISLNK ( st -> st_mode ) ) { return 0 ; } } st = tree_current_stat ( t ) ; if ( st == NULL ) { return 0 ; } return ( S_ISDIR ( st -> st_mode ) ) ; } 