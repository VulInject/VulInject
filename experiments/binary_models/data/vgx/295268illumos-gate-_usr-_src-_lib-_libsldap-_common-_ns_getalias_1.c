int __s_api_merge_SSD_filter ( const ns_ldap_search_desc_t * desc , char * * realfilter , const void * userdata ) { int len ; char * checker ; * realfilter = NULL ; if ( desc == NULL || desc -> filter == NULL || userdata == NULL ) { return ( NS_LDAP_INVALID_PARAM ) ; } len = 0 ; checker = ( char * ) userdata ; { checker = strchr ( checker , '%' ) ; if ( checker != NULL ) { if ( len > 0 || * ( checker + 1 ) != 's' ) { return ( NS_LDAP_INVALID_PARAM ) ; } len ++ ; checker += 2 ; } if ( len != 1 ) { return ( NS_LDAP_INVALID_PARAM ) ; } } checker != NULL ; len = strlen ( userdata ) + strlen ( desc -> filter ) + 1 ; * realfilter = ( char * ) malloc ( len ) ; if ( * realfilter == NULL ) { return ( NS_LDAP_MEMORY ) ; } ( void ) sprintf ( * realfilter , ( char * ) userdata , desc -> filter ) ; return ( NS_LDAP_SUCCESS ) ; } 