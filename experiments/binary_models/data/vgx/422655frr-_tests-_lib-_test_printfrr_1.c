static void printcmp ( const char * fmt , ... ) { va_list ap ; char buf [ 256 ] , bufrr [ 256 ] , * p ; int cmp ; memset ( bufrr , 0xcc , sizeof ( bufrr ) ) ; va_start ( ap , fmt ) ; vsnprintf ( buf , sizeof ( buf ) , fmt , ap ) ; va_end ( ap ) ; va_start ( ap , fmt ) ; vsnprintfrr ( bufrr , sizeof ( bufrr ) , fmt , ap ) ; va_end ( ap ) ; cmp = strcmp ( buf , bufrr ) ; if ( cmp && ( p = strstr ( bufrr , "+nan" ) ) ) { p [ 0 ] = ' ' ; if ( ! strcmp ( buf , bufrr ) ) { cmp = 0 ; } p [ 0 ] = '+' ; } printf ( "fmt: \"%s\"\nsys: \"%s\"\nfrr: \"%s\"\n%s\n\n" , fmt , buf , bufrr , cmp ?"ERROR" : "ok" ) ; if ( cmp ) { errors ++ ; } } 