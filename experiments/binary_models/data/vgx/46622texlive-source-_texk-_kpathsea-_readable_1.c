( ! p && len > 2 ) { p = strstr ( fn + 2 , "/\\" ) } ; if ( ! p && len > 2 && ( ( fn [ 0 ] == '/' && fn [ 1 ] == '/' ) || ( fn [ 0 ] == '\\' && fn [ 1 ] == '\\' && fn [ 2 ] != '?' ) ) ) { fn += 2 ; strcpy ( fnn , "\\\\?\\UNC\\" ) ; strcat ( fnn , fn ) ; } if ( ! p && len > 2 && fn [ 1 ] == ':' ) { strcpy ( fnn , "\\\\?\\" ) ; strcat ( fnn , fn ) ; } else { strcpy ( fnn , fn ) ; } for ( p = fnn ; * p ; p ++ ) { if ( * p == '/' ) { * p = '\\' ; } } fnw = get_wstring_from_mbstring ( kpse -> File_system_codepage , fnn , fnw = NULL ) ; if ( ( st = GetFileAttributesW ( fnw ) ) != 0xFFFFFFFF ) { errno = 0 ; } else { switch ( GetLastError ( ) ) { case ERROR_BUFFER_OVERFLOW : errno = ENAMETOOLONG ; break ; case ERROR_ACCESS_DENIED : errno = EACCES ; break ; default : errno = EIO ; break ; } } if ( fnw ) { free ( fnw ) ; } return ( ( st != 0xFFFFFFFF ) && ! ( st & FILE_ATTRIBUTE_DIRECTORY ) ) ; 