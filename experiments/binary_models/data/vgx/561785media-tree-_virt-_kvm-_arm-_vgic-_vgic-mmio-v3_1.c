static void vgic_mmio_write_propbase ( struct kvm_vcpu * vcpu , gpa_t addr , unsigned int len , unsigned long val ) { struct vgic_dist * dist = & vcpu -> kvm -> arch . vgic ; struct vgic_cpu * vgic_cpu = & vcpu -> arch . vgic_cpu ; u64 old_propbaser , propbaser ; { old_propbaser = dist -> propbaser ; propbaser = old_propbaser ; propbaser = update_64bit_reg ( propbaser , addr & 4 , len , val ) ; propbaser = vgic_sanitise_propbaser ( propbaser ) ; } cmpxchg64 ( & dist -> propbaser , old_propbaser , propbaser ) != old_propbaser ; } 