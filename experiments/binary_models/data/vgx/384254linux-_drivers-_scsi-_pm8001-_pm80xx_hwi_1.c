void pm8001_set_phy_profile_single ( struct pm8001_hba_info * pm8001_ha , u32 phy , u32 length , u32 * buf ) { u32 tag , opc ; int rc , i ; struct set_phy_profile_req payload ; rc = pm8001_tag_alloc ( pm8001_ha , & tag ) ; if ( rc ) { pm8001_dbg ( pm8001_ha , INIT , "Invalid tag\n" ) ; return ; } opc = OPC_INB_SET_PHY_PROFILE ; payload . tag = cpu_to_le32 ( tag ) ; payload . ppc_phyid = cpu_to_le32 ( ( ( SAS_PHY_ANALOG_SETTINGS_PAGE & 0xF ) << 8 ) | ( phy & 0xFF ) ) ; for ( i = 0 ; i < length ; i ++ ) { payload . reserved [ i ] = cpu_to_le32 ( * ( buf + i ) ) ; } rc = pm8001_mpi_build_cmd ( pm8001_ha , 0 , opc , & payload , sizeof ( payload ) , 0 ) ; if ( rc ) { pm8001_tag_free ( pm8001_ha , tag ) ; } pm8001_dbg ( pm8001_ha , INIT , "PHY %d settings applied\n" , phy ) ; } 