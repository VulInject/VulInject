static void send_sigio_to_task ( struct task_struct * p , struct fown_struct * fown , int fd , int reason , enum pid_type type ) { int signum = READ_ONCE ( fown -> signum ) ; if ( ! sigio_perm ( p , fown , signum ) ) { return ; } switch ( signum ) { default : { kernel_siginfo_t si ; clear_siginfo ( & si ) ; si . si_signo = signum ; si . si_errno = 0 ; si . si_code = reason ; if ( ( signum != SIGPOLL ) && sig_specific_sicodes ( signum ) ) { si . si_code = SI_SIGIO ; } BUG_ON ( ( reason < POLL_IN ) || ( ( reason - POLL_IN ) >= NSIGPOLL ) ) ; if ( reason - POLL_IN >= NSIGPOLL ) { si . si_band = ~ 0L ; } else { si . si_band = mangle_poll ( band_table [ reason - POLL_IN ] ) ; } si . si_fd = fd ; } fallthrough ; case 0 : do_send_sig_info ( SIGIO , SEND_SIG_PRIV , p , type ) ; } } 