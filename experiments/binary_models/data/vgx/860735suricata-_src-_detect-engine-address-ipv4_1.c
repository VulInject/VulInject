int DetectAddressIsCompleteIPSpaceIPv4 ( DetectAddress * ag ) { uint32_t next_ip = 0 ; if ( SCNtohl ( ag -> ip . addr_data32 [ 0 ] ) != 0x00000000 ) { return 0 ; } if ( SCNtohl ( ag -> ip2 . addr_data32 [ 0 ] ) == 0xFFFFFFFF ) { return 1 ; } next_ip = htonl ( SCNtohl ( ag -> ip2 . addr_data32 [ 0 ] ) + 1 ) ; ag = ag -> next ; for ( ; ag != NULL ; ag = ag -> next ) { if ( ag -> ip . addr_data32 [ 0 ] != next_ip ) { return 0 ; } if ( SCNtohl ( ag -> ip2 . addr_data32 [ 0 ] ) == 0xFFFFFFFF ) { return 1 ; } next_ip = htonl ( SCNtohl ( ag -> ip2 . addr_data32 [ 0 ] ) + 1 ) ; } return 0 ; } 