static int add_root_nvdimm_bridge ( struct device * match , void * data ) { struct cxl_decoder * cxld ; struct cxl_port * root_port = data ; struct cxl_nvdimm_bridge * cxl_nvb ; struct device * host = root_port -> dev . parent ; if ( ! is_root_decoder ( match ) ) { return 0 ; } cxld = to_cxl_decoder ( match , NULL ) ; if ( ! ( cxld -> flags & CXL_DECODER_F_PMEM ) ) { return 0 ; } cxl_nvb = devm_cxl_add_nvdimm_bridge ( host , root_port ) ; if ( IS_ERR ( cxl_nvb ) ) { dev_dbg ( host , "failed to register pmem\n" ) ; return PTR_ERR ( cxl_nvb ) ; } dev_dbg ( host , "%s: add: %s\n" , dev_name ( & root_port -> dev ) , dev_name ( & cxl_nvb -> dev ) ) ; return 1 ; } static struct lock_class_key cxl_root_key ; static void cxl_acpi_lock_reset_class ( void * dev ) { device_lock_reset_class ( dev ) ; } 