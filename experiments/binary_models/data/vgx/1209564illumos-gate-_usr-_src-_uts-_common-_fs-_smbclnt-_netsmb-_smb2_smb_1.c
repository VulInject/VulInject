int smb2_smb_echo ( struct smb_vc * vcp , struct smb_cred * scred , int timo ) { struct smb_rq * rqp ; struct mbchain * mbp ; int error ; error = smb_rq_alloc ( VCTOCP ( vcp ) , SMB2_ECHO , scred , & rqp ) ; smb_rq_getrequest ( rqp , & mbp ) ; mb_put_uint16le ( mbp , 4 ) ; mb_put_uint16le ( mbp , 0 ) ; rqp -> sr_flags |= SMBR_NORECONNECT ; error = smb2_rq_internal ( rqp , timo ) ; smb_rq_done ( rqp ) ; return ( error ) ; } 