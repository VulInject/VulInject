int FUN1 ( VAR1 * VAR2 ) { char VAR3 [ VAR4 ] , * * VAR5 , * VAR6 , * VAR7 ; pid_t VAR8 ; int VAR9 ; struct sigaction VAR10 , VAR11 ; smb_share_t VAR12 ; if ( FUN2 ( VAR2 -> VAR13 , & VAR12 ) != 0 ) { return ( - 1 ) ; } * VAR3 = '' ; ( void ) FUN3 ( & VAR14 ) ; switch ( VAR2 -> VAR15 ) { case VAR16 : ( void ) FUN4 ( VAR3 , VAR17 , sizeof ( VAR3 ) ) ; break ; case VAR18 : ( void ) FUN4 ( VAR3 , VAR19 , sizeof ( VAR3 ) ) ; break ; default : ( void ) FUN5 ( & VAR14 ) ; return ( - 1 ) ; } ( void ) FUN5 ( & VAR14 ) ; if ( * VAR3 == '' ) { return ( 0 ) ; } if ( FUN6 ( ) != 0 ) { return ( - 1 ) ; } VAR10 . VAR20 = VAR21 ; VAR10 . VAR22 = 0 ; ( void ) FUN7 ( & VAR10 . VAR23 ) ; FUN8 ( VAR24 , & VAR10 , NULL ) ; ( void ) FUN9 ( VAR25 , VAR26 , VAR27 , NULL ) ; if ( ( VAR8 = FUN10 ( ) ) == - 1 ) { ( void ) FUN9 ( VAR28 , VAR26 , VAR27 , NULL ) ; FUN11 ( ) ; return ( - 1 ) ; } if ( VAR8 == 0 ) { VAR11 . VAR20 = VAR29 ; VAR11 . VAR22 = 0 ; ( void ) FUN7 ( & VAR11 . VAR23 ) ; FUN8 ( VAR30 , & VAR11 , NULL ) ; FUN8 ( VAR31 , & VAR11 , NULL ) ; FUN8 ( VAR32 , & VAR11 , NULL ) ; if ( FUN9 ( VAR25 , VAR26 , VAR33 , VAR34 , NULL ) ) { FUN12 ( - 1 ) ; } if ( FUN13 ( ) ) { FUN12 ( - 1 ) ; } FUN14 ( ) ; ( void ) FUN15 ( VAR3 ) ; ( void ) FUN16 ( VAR3 , "" ) ; if ( ( VAR5 = FUN17 ( VAR3 ) ) != NULL ) { if ( FUN18 ( VAR5 , & VAR12 , VAR2 ) != 0 ) { free ( VAR5 [ 0 ] ) ; FUN12 ( - 1 ) ; } VAR7 = VAR3 ; VAR6 = FUN19 ( & VAR7 , "" ) ; ( void ) execv ( VAR6 , VAR5 ) ; } FUN12 ( - 1 ) ; } ( void ) FUN9 ( VAR28 , VAR26 , VAR27 , NULL ) ; FUN11 ( ) ; while ( FUN20 ( VAR8 , & VAR9 , 0 ) < 0 ) { if ( VAR35 != VAR36 ) { break ; } VAR35 = 0 ; continue ; } if ( FUN21 ( VAR9 ) ) { return ( FUN22 ( VAR9 ) ) ; } return ( VAR9 ) ; }