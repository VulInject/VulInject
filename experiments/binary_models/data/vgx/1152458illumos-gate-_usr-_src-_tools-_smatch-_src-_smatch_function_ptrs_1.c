static void match_returns_function_pointer ( struct expression * expr ) { struct symbol * type ; char * fn_name ; char ptr_name [ 256 ] ; type = get_real_base_type ( cur_func_sym ) ; if ( ! type || type -> type != SYM_FN ) { return ; } type = get_real_base_type ( type ) ; if ( ! type || type -> type != SYM_PTR ) { return ; } type = get_real_base_type ( type ) ; if ( ! type || type -> type != SYM_FN ) { return ; } if ( expr -> type == EXPR_PREOP && expr -> op == '&' ) { expr = strip_expr ( expr -> unop ) ; } fn_name = get_fnptr_name ( expr ) ; if ( ! fn_name ) { return ; } snprintf ( ptr_name , sizeof ( ptr_name ) , "r %s()" , get_function ( ) ) ; sql_insert_function_ptr ( fn_name , ptr_name ) ; } 