static int set_msr_configuration ( struct i2c_client * client , uint8_t * bufptr , unsigned int size ) { u8 * ptr = bufptr ; while ( ptr < bufptr + size ) { struct i2c_msg msg = { . addr = client -> addr . flags = 0 } ; int ret ; msg . len = * ptr ++ ; msg . buf = ptr ; ptr += msg . len ; ret = i2c_transfer ( client -> adapter , & msg , 1 ) ; if ( ret < 0 ) { dev_err ( & client -> dev , "i2c write error: %d" , ret ) ; return ret ; } } return 0 ; } 