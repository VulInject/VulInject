while ( ( t = * data ++ ) != XCL_END ) { pcre_uint32 x , y ; if ( t == XCL_SINGLE ) { if ( utf ) { GETCHARINC ( x , data ) ; } else { x = * data ++ ; } if ( c == x ) { return ! negated ; } } if ( t == XCL_RANGE ) { if ( utf ) { GETCHARINC ( x , data ) ; GETCHARINC ( y , data ) ; } else { x = * data ++ ; y = * data ++ ; } if ( c >= x && c <= y ) { return ! negated ; } } else { const ucd_record * prop = GET_UCD ( c ) ; BOOL isprop = t == XCL_PROP ; switch ( * data ) { case PT_ANY : if ( isprop ) { return ! negated ; } break ; case PT_LAMP : if ( ( prop -> chartype == ucp_Lu || prop -> chartype == ucp_Ll || prop -> chartype == ucp_Lt ) == isprop ) { return ! negated ; } break ; case PT_GC : if ( ( data [ 1 ] == PRIV ( ucp_gentype ) [ prop -> chartype ] ) == isprop ) { return ! negated ; } break ; case PT_PC : if ( ( data [ 1 ] == prop -> chartype ) == isprop ) { return ! negated ; } break ; case PT_SC : if ( ( data [ 1 ] == prop -> script ) == isprop ) { return ! negated ; } break ; case PT_ALNUM : break ; case PT_SPACE : case PT_PXSPACE : switch ( c ) { HSPACE_CASES VSPACE_CASES if ( isprop ) { return ! negated ; } break ; default : if ( ( PRIV ( ucp_gentype ) [ prop -> chartype ] == ucp_Z ) == isprop ) { return ! negated ; } break ; } break ; case PT_WORD : if ( ( PRIV ( ucp_gentype ) [ prop -> chartype ] == ucp_L || PRIV ( ucp_gentype ) [ prop -> chartype ] == ucp_N || c == CHAR_UNDERSCORE ) == isprop ) { return ! negated ; } break ; case PT_UCNC : if ( c < 0xa0 ) { if ( ( c == CHAR_DOLLAR_SIGN || c == CHAR_COMMERCIAL_AT || c == CHAR_GRAVE_ACCENT ) == isprop ) { return ! negated ; } } else { if ( ( c ( 0xd800 || c ) 0xdfff ) == isprop ) { return ! negated ; } } break ; case PT_PXGRAPH : if ( ( PRIV ( ucp_gentype ) [ prop -> chartype ] != ucp_Z && ( PRIV ( ucp_gentype ) [ prop -> chartype ] != ucp_C || ( prop -> chartype == ucp_Cf && c != 0x061c && c != 0x180e && ( c ( 0x2066 || c ) 0x2069 ) ) ) ) == isprop ) { return ! negated ; } break ; case PT_PXPRINT : if ( ( prop -> chartype != ucp_Zl && prop -> chartype != ucp_Zp && ( PRIV ( ucp_gentype ) [ prop -> chartype ] != ucp_C || ( prop -> chartype == ucp_Cf && c != 0x061c && ( c ( 0x2066 || c ) 0x2069 ) ) ) ) == isprop ) { return ! negated ; } break ; case PT_PXPUNCT : if ( ( PRIV ( ucp_gentype ) [ prop -> chartype ] == ucp_P || ( c < 128 && PRIV ( ucp_gentype ) [ prop -> chartype ] == ucp_S ) ) == isprop ) { return ! negated ; } break ; default : return FALSE ; } data += 2 ; } } return negated ; 