MagickExport MagickBooleanType SetMagickSecurityPolicy ( const char * policy , ExceptionInfo * exception ) { PolicyInfo * p ; MagickBooleanType status ; assert ( exception != ( ExceptionInfo * ) NULL ) ; if ( policy == ( const char * ) NULL ) { return ( MagickFalse ) ; } if ( IsPolicyCacheInstantiated ( exception ) == MagickFalse ) { return ( MagickFalse ) ; } LockSemaphoreInfo ( policy_semaphore , NULL ) ; ResetLinkedListIterator ( policy_cache ) ; p = ( PolicyInfo * ) GetNextValueInLinkedList ( policy_cache ) ; if ( ( p != ( PolicyInfo * ) NULL ) && ( p -> domain != UndefinedPolicyDomain ) ) { UnlockSemaphoreInfo ( policy_semaphore ) ; return ( MagickFalse ) ; } UnlockSemaphoreInfo ( policy_semaphore ) ; status = LoadPolicyCache ( policy_cache , policy , "[user-policy]" , 0 , exception ) ; if ( status == MagickFalse ) { return ( MagickFalse ) ; } return ( ResourceComponentGenesis ( ) ) ; } 