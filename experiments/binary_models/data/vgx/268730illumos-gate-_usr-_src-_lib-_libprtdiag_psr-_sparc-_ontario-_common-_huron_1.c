int huron_get_first_compatible_value ( picl_nodehdl_t nodeh , char * * outbuf ) { int err ; picl_prophdl_t proph ; picl_propinfo_t pinfo ; picl_prophdl_t tblh ; picl_prophdl_t rowproph ; char * pval ; err = picl_get_propinfo_by_name ( nodeh , OBP_PROP_COMPATIBLE , & pinfo , & proph ) ; if ( err != PICL_SUCCESS ) { return ( err ) ; } if ( pinfo . type == PICL_PTYPE_CHARSTRING ) { pval = malloc ( pinfo . size ) ; if ( pval == NULL ) { return ( PICL_FAILURE ) ; } err = picl_get_propval ( proph , pval , pinfo . size ) ; if ( err != PICL_SUCCESS ) { return ( err ) ; } * outbuf = pval ; return ( PICL_SUCCESS ) ; } if ( pinfo . type != PICL_PTYPE_TABLE ) { return ( PICL_FAILURE ) ; } err = picl_get_propval ( proph , & tblh , pinfo . size ) ; if ( err != PICL_SUCCESS ) { return ( err ) ; } err = picl_get_next_by_row ( tblh , & rowproph ) ; if ( err != PICL_SUCCESS ) { return ( err ) ; } err = picl_get_propinfo ( rowproph , & pinfo ) ; if ( err != PICL_SUCCESS ) { return ( err ) ; } pval = malloc ( pinfo . size ) ; if ( pval == NULL ) { return ( PICL_FAILURE ) ; } err = picl_get_propval ( rowproph , pval , pinfo . size ) ; if ( err != PICL_SUCCESS ) { free ( pval ) ; return ( err ) ; } * outbuf = pval ; return ( PICL_SUCCESS ) ; } 