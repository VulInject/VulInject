show_help_on_idle ( ) { IdleClosure * closure = user_data ; GimpHelpDomain * domain ; GimpHelpProgress * progress = NULL ; GimpHelpLocale * locale ; GList * locales ; char * uri ; gboolean fatal_error ; domain = gimp_help_lookup_domain ( closure -> help_domain ) ; if ( ! domain ) { return G_SOURCE_REMOVE ; } locales = gimp_help_parse_locales ( closure -> help_locales ) ; if ( ! g_str_has_prefix ( domain -> help_uri , "file:" ) ) { progress = help_browser_progress_new ( ) ; } uri = gimp_help_domain_map ( domain , locales , closure -> help_id , progress , & locale , & fatal_error ) ; if ( progress ) { gimp_help_progress_free ( progress ) ; } g_list_free_full ( locales , ( GDestroyNotify ) g_free ) ; if ( uri ) { gimp_help_browser_dialog_make_index ( closure -> browser -> window , domain , locale ) ; gimp_help_browser_dialog_load ( closure -> browser -> window , uri ) ; } return G_SOURCE_REMOVE ; } 