void qedi_dbg_host_init ( struct qedi_dbg_ctx * qedi , struct qedi_debugfs_ops * dops , const struct file_operations * fops ) { char host_dirname [ 32 ] ; struct dentry * file_dentry = NULL ; sprintf ( host_dirname , "host%u" , qedi -> host_no ) ; qedi -> bdf_dentry = debugfs_create_dir ( host_dirname , qedi_dbg_root ) ; if ( ! qedi -> bdf_dentry ) { return ; } while ( dops ) { if ( ! ( dops -> name ) ) { break ; } file_dentry = debugfs_create_file ( dops -> name , 0600 , qedi -> bdf_dentry , qedi , fops ) ; if ( ! file_dentry ) { QEDI_INFO ( qedi , QEDI_LOG_DEBUGFS , "Debugfs entry %s creation failed\n" , dops -> name ) ; debugfs_remove_recursive ( qedi -> bdf_dentry , NULL ) ; return ; } dops ++ ; fops ++ ; } } 