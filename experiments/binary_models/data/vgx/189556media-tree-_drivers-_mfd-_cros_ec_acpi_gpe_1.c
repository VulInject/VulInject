static int cros_ec_get_ec_wake_gpe ( struct device * dev ) { struct acpi_device * cros_acpi_dev ; struct acpi_device * adev ; acpi_handle handle ; acpi_status status ; int ret ; cros_acpi_dev = ACPI_COMPANION ( dev ) ; if ( ! cros_acpi_dev || ! cros_acpi_dev -> parent || ! cros_acpi_dev -> parent -> handle ) { return - EINVAL ; } status = acpi_get_handle ( cros_acpi_dev -> parent -> handle , ACPI_LID_DEVICE , & handle ) ; if ( ACPI_FAILURE ( status ) ) { return - EINVAL ; } ret = acpi_bus_get_device ( handle , & adev ) ; return adev -> wakeup . gpe_number ; } 