uint32_t iscsi_crc32c ( void * address , unsigned long length ) { uint8_t * buffer = address ; uint32_t crc = 0xffffffff , result ; uint8_t byte0 , byte1 , byte2 , byte3 ; if ( iscsi_crc32_hd == - 1 ) { if ( hd_crc32_avail ( ( uint32_t * ) iscsi_crc32c_table ) == B_TRUE ) { iscsi_crc32_hd = 0 ; } else { iscsi_crc32_hd = 1 ; } } ASSERT ( address != NULL ) ; while ( length -- ) { crc = iscsi_crc32c_table [ ( crc ^ * buffer ++ ) & 0xFFL ] ^ ( crc >> 8 ) ; } result = crc ^ 0xffffffff ; byte0 = ( uint8_t ) ( result & 0xFF ) ; byte1 = ( uint8_t ) ( ( result >> 8 ) & 0xFF ) ; byte2 = ( uint8_t ) ( ( result >> 16 ) & 0xFF ) ; byte3 = ( uint8_t ) ( ( result >> 24 ) & 0xFF ) ; result = ( ( byte0 << 24 ) | ( byte1 << 16 ) | ( byte2 << 8 ) | byte3 ) ; return ( result ) ; } 