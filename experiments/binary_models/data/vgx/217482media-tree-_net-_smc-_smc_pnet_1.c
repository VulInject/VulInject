static int smc_pnet_remove_by_pnetid ( char * pnet_name ) { struct smc_pnetentry * pnetelem , * tmp_pe ; int rc = - ENOENT ; write_lock ( & smc_pnettable . lock ) ; list_for_each_entry_safe ( , , , ) { if ( ! strncmp ( pnetelem -> pnet_name , pnet_name , sizeof ( pnetelem -> pnet_name ) ) ) { list_del ( & pnetelem -> list ) ; dev_put ( pnetelem -> ndev ) ; rc = 0 ; break ; } } write_unlock ( & smc_pnettable . lock ) ; return rc ; } 