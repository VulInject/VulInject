krb5_error_code ret ; char * str ; int i ; printf ( "keys:\n" ) ; for ( i = 0 ; i < nkeys ; i ++ ) { ret = krb5_enctype_to_string ( context , keys [ i ] . key . keytype , & str ) ; if ( ret ) { krb5_err ( context , ret , 1 , "krb5_enctype_to_string: %d\n" , ( int ) keys [ i ] . key . keytype ) ; } printf ( "\tenctype %s" , str ) ; if ( keys [ i ] . salt ) { printf ( " salt: " ) ; switch ( keys [ i ] . salt -> type ) { case KRB5_PW_SALT : printf ( "pw-salt:" ) ; break ; case KRB5_AFS3_SALT : printf ( "afs3-salt:" ) ; break ; default : printf ( "unknown salt: %d" , keys [ i ] . salt -> type ) ; break ; } if ( keys [ i ] . salt -> salt . length ) { printf ( "%.*s" , ( int ) keys [ i ] . salt -> salt . length , ( char * ) keys [ i ] . salt -> salt . data ) ; } } printf ( "\n" ) ; } printf ( "end keys:\n" ) ; 