int board_mmc_init ( struct bd_info * bis ) { int ret ; u32 index = 0 ; for ( index = 0 ; index < CFG_SYS_FSL_USDHC_NUM ; ++ index ) { switch ( index ) { case 0 : SETUP_IOMUX_PADS ( usdhc3_pads ) ; usdhc_cfg [ 0 ] . sdhc_clk = mxc_get_clock ( MXC_ESDHC3_CLK ) ; usdhc_cfg [ 0 ] . max_bus_width = 8 ; break ; case 1 : SETUP_IOMUX_PADS ( usdhc2_pads ) ; usdhc_cfg [ 1 ] . sdhc_clk = mxc_get_clock ( MXC_ESDHC_CLK ) ; usdhc_cfg [ 1 ] . max_bus_width = 4 ; gpio_direction_input ( USDHC2_CD_GPIO ) ; break ; default : printf ( "Warning: More USDHC controllers (%d) than supported (%d)\n" , index + 1 , CFG_SYS_FSL_USDHC_NUM ) ; return - EINVAL ; } ret = fsl_esdhc_initialize ( bis , & usdhc_cfg [ index ] ) ; } return 0 ; } 