int xfs_dir2_node_lookup ( xfs_da_args_t * args ) { int error ; int i ; int rval ; xfs_da_state_t * state ; trace_xfs_dir2_node_lookup ( args ) ; state = xfs_da_state_alloc ( args ) ; error = xfs_da3_node_lookup_int ( state , & rval ) ; if ( error ) { rval = error ; } if ( rval == - ENOENT && args -> cmpresult == XFS_CMP_CASE ) { xfs_dir2_data_entry_t * dep ; dep = ( xfs_dir2_data_entry_t * ) ( ( char * ) state -> extrablk . bp -> b_addr + state -> extrablk . index ) ; rval = xfs_dir_cilookup_result ( args , dep -> name , dep -> namelen ) ; } for ( i = 0 ; i < state -> path . active ; i ++ ) { xfs_trans_brelse ( args -> trans , state -> path . blk [ i ] . bp ) ; state -> path . blk [ i ] . bp = NULL ; } if ( state -> extravalid && state -> extrablk . bp ) { xfs_trans_brelse ( args -> trans , state -> extrablk . bp ) ; } xfs_da_state_free ( state ) ; return rval ; } 