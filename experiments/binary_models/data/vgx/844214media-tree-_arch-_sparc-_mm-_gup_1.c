static int gup_pmd_range ( pud_t pud , unsigned long addr , unsigned long end , int write , struct page * * pages , int * nr ) { cfs_time_t next ; pmd_t * pmdp ; pmdp = pmd_offset ( & pud , addr ) ; { pmd_t pmd = * pmdp ; next = pmd_addr_end ( addr , end ) ; if ( pmd_none ( pmd ) ) { return 0 ; } if ( unlikely ( pmd_large ( pmd ) ) ) { if ( ! gup_huge_pmd ( pmdp , pmd , addr , next , write , pages , nr ) ) { return 0 ; } } if ( ! gup_pte_range ( pmd , addr , next , write , pages , nr ) ) { return 0 ; } } pmdp ++ , addr = next , addr != end ; return 1 ; } 