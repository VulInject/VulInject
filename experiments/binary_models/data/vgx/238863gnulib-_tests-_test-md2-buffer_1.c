main ( int argc , char * argv [ ] ) { const char * in1 = "abc" ; const char * out1 = "\xda\x85\x3b\x0d\x3f\x88\xd9\x9b\x30\x28\x3a\x69\xe6\xde\xd6\xbb" ; const char * in2 = "abcdefghijklmnopqrstuvwxyz" ; const char * out2 = "\x4e\x8d\xdf\xf3\x65\x02\x92\xab\x5a\x41\x08\xc3\xaa\x47\x94\x0b" ; char buf [ MD2_DIGEST_SIZE ] ; if ( memcmp ( md2_buffer ( in1 , strlen ( in1 ) , buf ) , out1 , MD2_DIGEST_SIZE ) != 0 ) { int i ; printf ( "expected:\n" ) ; for ( i = 0 ; i < MD2_DIGEST_SIZE ; i ++ ) { printf ( "%02x " , out1 [ i ] & 0xFF ) ; } printf ( "\ncomputed:\n" ) ; for ( i = 0 ; i < MD2_DIGEST_SIZE ; i ++ ) { printf ( "%02x " , buf [ i ] & 0xFF ) ; } printf ( "\n" ) ; return 1 ; } if ( memcmp ( md2_buffer ( in2 , strlen ( in2 ) , buf ) , out2 , MD2_DIGEST_SIZE ) != 0 ) { size_t i ; printf ( "expected:\n" ) ; for ( i = 0 ; i < MD2_DIGEST_SIZE ; i ++ ) { printf ( "%02x " , out2 [ i ] & 0xFF ) ; } printf ( "\ncomputed:\n" ) ; for ( i = 0 ; i < MD2_DIGEST_SIZE ; i ++ ) { printf ( "%02x " , buf [ i ] & 0xFF ) ; } printf ( "\n" ) ; return 1 ; } return 0 ; } 