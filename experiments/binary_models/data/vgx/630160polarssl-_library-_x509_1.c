int mbedtls_x509_get_sig ( unsigned char * * p , const unsigned char * end , mbedtls_x509_buf * sig ) { int ret = MBEDTLS_ERR_ERROR_CORRUPTION_DETECTED ; size_t len ; int tag_type ; tag_type = * * p ; if ( ( ret = mbedtls_asn1_get_bitstring_null ( p , end , & len ) ) != 0 ) { return MBEDTLS_ERROR_ADD ( MBEDTLS_ERR_X509_INVALID_SIGNATURE , ret ) ; } sig -> tag = tag_type ; sig -> len = len ; sig -> p = * p ; * p += len ; return 0 ; } 