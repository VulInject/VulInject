static void FUN1 ( char * VAR1 ) static struct VAR2 * VAR3 = NULL ; static void FUN2 ( VAR4 * ) static void FUN3 ( VAR4 * ) int FUN4 ( struct VAR5 * VAR6 , VAR4 * * VAR7 , int VAR8 , int VAR9 , int * VAR10 ) { struct stat VAR11 ; struct nfsl_flush_args VAR12 ; struct VAR13 * VAR14 = NULL ; struct VAR15 * VAR16 ; char * VAR17 = NULL ; char * VAR18 = NULL ; char * VAR19 = NULL ; int VAR20 ; int VAR21 = 0 ; VAR4 * VAR22 = NULL , * VAR23 ; char * VAR24 = VAR6 -> VAR25 ; char * VAR1 ; boolean_t VAR26 = VAR27 ; boolean_t VAR28 = VAR27 ; assert ( VAR10 != NULL ) ; assert ( VAR24 != NULL ) ; if ( FUN5 ( VAR24 , & VAR11 ) == - 1 ) { VAR21 = VAR29 ; if ( VAR21 == VAR30 ) { VAR21 = 0 ; VAR20 = strlen ( VAR24 ) + strlen ( VAR31 ) + 1 ; VAR19 = ( char * ) malloc ( VAR20 ) ; if ( VAR19 == NULL ) { syslog ( VAR32 , FUN6 ( "" ) ) ; return ( VAR33 ) ; } ( void ) sprintf ( VAR19 , "" , VAR24 , VAR31 ) ; if ( FUN5 ( VAR19 , & VAR11 ) == - 1 ) { VAR21 = VAR29 ; if ( VAR6 -> VAR34 != VAR21 ) { syslog ( VAR32 , FUN6 ( "" ) , VAR19 , strerror ( VAR21 ) ) ; } return ( VAR21 ) ; } free ( VAR19 ) ; if ( ( VAR11 . VAR35 < VAR8 ) && ( ( FUN7 ( 0 ) - VAR6 -> VAR36 ) < VAR9 ) ) { return ( 0 ) ; } ( void ) memset ( ( void * ) & VAR12 , 0 , sizeof ( VAR12 ) ) ; VAR12 . VAR37 = VAR38 ; VAR12 . VAR39 = VAR40 | VAR41 ; VAR12 . VAR42 = VAR24 ; VAR12 . VAR43 = strlen ( VAR24 ) + 1 ; if ( FUN8 ( VAR44 , & VAR12 ) < 0 ) { VAR21 = VAR29 ; if ( VAR6 -> VAR34 != VAR21 ) { syslog ( VAR32 , FUN6 ( "" ) , VAR12 . VAR42 , strerror ( VAR21 ) ) ; } return ( VAR21 ) ; } } else { if ( VAR6 -> VAR34 != VAR21 ) { syslog ( VAR32 , FUN6 ( "" ) , VAR24 , strerror ( VAR21 ) ) ; } return ( VAR21 ) ; } } VAR21 = VAR6 -> VAR34 ; if ( ( VAR14 = FUN9 ( VAR24 , & VAR21 ) ) == NULL ) { VAR45 } if ( ( VAR22 = VAR23 = FUN10 ( * VAR7 , "" , & VAR21 ) ) == NULL ) { assert ( VAR21 != 0 ) ; FUN11 ( VAR7 ) ; if ( VAR21 != VAR6 -> VAR34 ) { syslog ( VAR32 , FUN6 ( "" ) , strerror ( VAR21 ) ) ; } VAR45 } assert ( VAR21 == 0 ) ; while ( ( VAR16 = FUN12 ( VAR14 ) ) != NULL && VAR46 ) { if ( * VAR10 == 0 ) { ( * VAR10 ) ++ ; } VAR1 = VAR16 -> VAR47 . VAR48 ; if ( strcmp ( VAR1 , VAR23 -> VAR49 ) != 0 ) { VAR22 = FUN10 ( * VAR7 , VAR1 , & VAR21 ) ; if ( VAR21 ) { if ( VAR21 != VAR6 -> VAR34 ) { syslog ( VAR32 , FUN6 ( "" ) , strerror ( VAR21 ) ) ; } FUN11 ( VAR7 ) ; VAR45 } if ( VAR22 == NULL ) { FUN1 ( VAR1 ) ; VAR22 = VAR23 ; VAR50 } VAR23 = VAR22 ; } if ( VAR22 -> VAR51 & VAR52 ) { FUN2 ( VAR22 ) ; FUN3 ( VAR22 ) ; VAR22 -> VAR51 &= ~ VAR52 ; VAR26 = VAR28 = VAR27 ; } if ( VAR22 -> VAR53 != NULL ) { if ( ! VAR26 && VAR22 -> VAR54 != NULL ) { if ( FUN5 ( VAR22 -> VAR53 , & VAR11 ) == - 1 && VAR29 == VAR30 ) { FUN2 ( VAR22 ) ; } VAR26 = VAR55 ; } if ( VAR22 -> VAR54 == NULL ) { VAR21 = VAR6 -> VAR34 ; VAR22 -> VAR54 = FUN13 ( VAR22 -> VAR53 , & VAR14 -> VAR56 , & VAR21 ) ; if ( VAR22 -> VAR54 == NULL ) { VAR6 -> VAR34 = VAR21 ; VAR45 } } } if ( VAR22 -> VAR57 != NULL ) { if ( ! VAR28 && VAR22 -> VAR58 != NULL ) { if ( FUN5 ( VAR22 -> VAR57 , & VAR11 ) == - 1 && VAR29 == VAR30 ) { FUN3 ( VAR22 ) ; } VAR28 = VAR55 ; } if ( VAR22 -> VAR58 == NULL ) { int VAR59 ; VAR59 = ( VAR22 -> VAR60 == VAR61 ) ?VAR62 : VAR63 ; VAR21 = VAR6 -> VAR34 ; VAR22 -> VAR58 = FUN14 ( VAR22 -> VAR57 , VAR22 -> VAR60 , VAR59 , & VAR21 ) ; if ( VAR22 -> VAR58 == NULL ) { VAR6 -> VAR34 = VAR21 ; VAR45 } } } assert ( VAR22 -> VAR64 != NULL ) ; if ( FUN15 ( VAR16 , VAR22 -> VAR64 , & VAR17 , & VAR18 , VAR22 -> VAR54 != NULL ) ) { if ( VAR22 -> VAR54 != NULL ) { ( void ) FUN16 ( VAR22 -> VAR54 , & VAR16 -> VAR47 , VAR17 , VAR18 ) ; } if ( VAR22 -> VAR58 != NULL ) { ( void ) FUN17 ( VAR22 -> VAR58 , & VAR16 -> VAR47 , VAR22 -> VAR64 , VAR17 , VAR18 ) ; } } skip if ( VAR17 != NULL ) { free ( VAR17 ) ; } if ( VAR18 != NULL ) { free ( VAR18 ) ; } VAR17 = VAR18 = NULL ; FUN18 ( VAR16 , VAR65 ) ; } if ( ! VAR21 && VAR46 ) { VAR6 -> VAR36 = FUN7 ( 0 ) ; if ( VAR66 && * VAR10 != 0 ) { if ( FUN19 ( VAR24 , VAR67 ) ) { syslog ( VAR32 , FUN6 ( ""%VAR68\"" ) , VAR24 ) ; } } else { if ( unlink ( VAR24 ) ) { VAR21 = VAR29 ; syslog ( VAR32 , FUN6 ( "" ) , VAR24 , strerror ( VAR21 ) ) ; VAR21 = 0 ; } } } done if ( VAR14 != NULL ) { FUN20 ( VAR14 , VAR69 ) ; } if ( VAR22 && ! VAR69 ) { FUN2 ( VAR22 ) ; } return ( VAR21 ) ; }