( mpc512x_lpbfifo_submit ) ; static int get_cs_ranges ( struct device * dev ) { int ret = - ENODEV ; struct device_node * lb_node ; const u32 * addr_cells_p ; const u32 * size_cells_p ; int proplen ; size_t i ; lb_node = of_find_compatible_node ( NULL , NULL , "fsl,mpc5121-localbus" ) ; addr_cells_p = of_get_property ( lb_node , "#address-cells" , NULL ) ; size_cells_p = of_get_property ( lb_node , "#size-cells" , NULL ) ; if ( addr_cells_p == NULL || * addr_cells_p != 2 || size_cells_p == NULL || * size_cells_p != 1 ) { end } proplen = of_property_count_u32_elems ( lb_node , "ranges" ) ; if ( proplen <= 0 || proplen % 4 != 0 ) { end } lpbfifo . cs_n = proplen / 4 ; lpbfifo . cs_ranges = devm_kcalloc ( dev , lpbfifo . cs_n , sizeof ( cs_range ) , GFP_KERNEL ) ; if ( ! lpbfifo . cs_ranges ) { end } if ( of_property_read_u32_array ( lb_node , "ranges" , ( u32 * ) lpbfifo . cs_ranges , proplen ) != 0 ) { end } for ( i = 0 ; i < lpbfifo . cs_n ; i ++ ) { if ( lpbfifo . cs_ranges [ i ] . base != 0 ) { end } } ret = 0 ; end of_node_put ( lb_node ) ; return ret ; } 