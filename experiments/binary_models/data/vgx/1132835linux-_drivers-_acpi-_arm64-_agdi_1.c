static int agdi_remove ( struct platform_device * pdev ) { struct agdi_data * adata = dev_get_platdata ( & pdev -> dev ) ; int err , i ; err = sdei_event_disable ( adata -> sdei_event ) ; for ( i = 0 ; i < 3 ; i ++ ) { err = sdei_event_unregister ( adata -> sdei_event ) ; if ( err != - EINPROGRESS ) { break ; } schedule ( ) ; } return err ; } static struct platform_driver agdi_driver = { . driver = { . name = "agdi" } . probe = agdi_probe . remove = agdi_remove } ; 