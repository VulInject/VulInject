void BotInitInfoEntities ( void ) { char classname [ MAX_EPAIRKEY ] ; maplocation_t * ml ; campspot_t * cs ; int ent , numlocations , numcampspots ; BotFreeInfoEntities ( ) ; numcampspots = 0 ; for ( ent = AAS_NextBSPEntity ( 0 ) ; ent ; ent = AAS_NextBSPEntity ( ent ) ) { if ( ! AAS_ValueForBSPEpairKey ( ent , "classname" , classname , MAX_EPAIRKEY ) ) { continue ; } if ( ! strcmp ( classname , "target_location" ) ) { ml = ( maplocation_t * ) GetClearedMemory ( sizeof ( maplocation_t ) ) ; AAS_VectorForBSPEpairKey ( ent , "origin" , ml -> origin ) ; AAS_ValueForBSPEpairKey ( ent , "message" , ml -> name , sizeof ( ml -> name ) ) ; ml -> areanum = AAS_PointAreaNum ( ml -> origin ) ; ml -> next = maplocations ; maplocations = ml ; numlocations ++ ; } if ( ! strcmp ( classname , "info_camp" ) ) { cs = ( campspot_t * ) GetClearedMemory ( sizeof ( campspot_t ) ) ; AAS_VectorForBSPEpairKey ( ent , "origin" , cs -> origin ) ; AAS_ValueForBSPEpairKey ( ent , "message" , cs -> name , sizeof ( cs -> name ) ) ; AAS_FloatForBSPEpairKey ( ent , "range" , & cs -> range ) ; AAS_FloatForBSPEpairKey ( ent , "weight" , & cs -> weight ) ; AAS_FloatForBSPEpairKey ( ent , "wait" , & cs -> wait ) ; AAS_FloatForBSPEpairKey ( ent , "random" , & cs -> random ) ; cs -> areanum = AAS_PointAreaNum ( cs -> origin ) ; if ( ! cs -> areanum ) { botimport . Print ( PRT_MESSAGE , "camp spot at %1.1f %1.1f %1.1f in solid\n" , cs -> origin [ 0 ] , cs -> origin [ 1 ] , cs -> origin [ 2 ] ) ; FreeMemory ( cs ) ; continue ; } cs -> next = campspots ; campspots = cs ; numcampspots ++ ; } } if ( botDeveloper ) { botimport . Print ( PRT_MESSAGE , "%d map locations\n" , numlocations ) ; botimport . Print ( PRT_MESSAGE , "%d camp spots\n" , numcampspots ) ; } } 