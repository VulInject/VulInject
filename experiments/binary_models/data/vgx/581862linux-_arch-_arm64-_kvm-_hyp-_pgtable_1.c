static int stage2_map_walk_table_pre ( const struct kvm_pgtable_visit_ctx * ctx , struct stage2_map_data * data ) { struct kvm_pgtable_mm_ops * mm_ops = ctx -> mm_ops ; kvm_pte_t * childp = kvm_pte_follow ( ctx -> old , mm_ops ) ; int ret ; if ( ! stage2_leaf_mapping_allowed ( ctx , data ) ) { return 0 ; } ret = stage2_map_walker_try_leaf ( ctx , data ) ; mm_ops -> free_removed_table ( childp , ctx -> level ) ; return 0 ; } 