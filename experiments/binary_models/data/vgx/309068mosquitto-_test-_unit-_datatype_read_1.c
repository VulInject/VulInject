static void TEST_varint_read_boundaries ( void ) { uint8_t payload [ 20 ] ; payload [ 0 ] = 0x00 ; varint_read_helper ( payload , 1 , MOSQ_ERR_SUCCESS , 0 , 1 ) ; memset ( payload , 0 , sizeof ( payload ) ) ; payload [ 0 ] = 0x7F ; varint_read_helper ( payload , 1 , MOSQ_ERR_SUCCESS , 127 , 1 ) ; memset ( payload , 0 , sizeof ( payload ) ) ; payload [ 0 ] = 0x80 ; payload [ 1 ] = 0x01 ; varint_read_helper ( payload , 2 , MOSQ_ERR_SUCCESS , 128 , 2 ) ; memset ( payload , 0 , sizeof ( payload ) ) ; payload [ 0 ] = 0xFF ; payload [ 1 ] = 0x7F ; varint_read_helper ( payload , 2 , MOSQ_ERR_SUCCESS , 16383 , 2 ) ; memset ( payload , 0 , sizeof ( payload ) ) ; payload [ 0 ] = 0x80 ; payload [ 1 ] = 0x80 ; payload [ 2 ] = 0x01 ; varint_read_helper ( payload , 3 , MOSQ_ERR_SUCCESS , 16384 , 3 ) ; memset ( payload , 0 , sizeof ( payload ) ) ; payload [ 0 ] = 0xFF ; payload [ 1 ] = 0xFF ; payload [ 2 ] = 0x7F ; varint_read_helper ( payload , 3 , MOSQ_ERR_SUCCESS , 2097151 , 3 ) ; memset ( payload , 0 , sizeof ( payload ) ) ; payload [ 0 ] = 0x80 ; payload [ 1 ] = 0x80 ; payload [ 2 ] = 0x80 ; payload [ 3 ] = 0x01 ; varint_read_helper ( payload , 4 , MOSQ_ERR_SUCCESS , 2097152 , 4 ) ; memset ( payload , 0 , sizeof ( payload ) ) ; payload [ 0 ] = 0xFF ; payload [ 1 ] = 0xFF ; payload [ 2 ] = 0xFF ; payload [ 3 ] = 0x7F ; varint_read_helper ( payload , 4 , MOSQ_ERR_SUCCESS , 268435455 , 4 ) ; } 