( seg6_hmac_info_del ) ; int seg6_push_hmac ( struct net * net , struct in6_addr * saddr , struct ipv6_sr_hdr * srh ) { struct seg6_hmac_info * hinfo ; struct sr6_tlv_hmac * tlv ; int err = - ENOENT ; tlv = seg6_get_tlv_hmac ( srh ) ; rcu_read_lock ( ) ; hinfo = seg6_hmac_info_lookup ( net , be32_to_cpu ( tlv -> hmackeyid ) ) ; if ( ! hinfo ) { out } memset ( tlv -> hmac , 0 , SEG6_HMAC_FIELD_LEN ) ; err = seg6_hmac_compute ( hinfo , srh , saddr , tlv -> hmac ) ; out rcu_read_unlock ( ) ; return err ; } 