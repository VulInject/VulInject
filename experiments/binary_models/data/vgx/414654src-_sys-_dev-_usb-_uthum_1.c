int uthum_detach ( struct device * self , int flags ) { struct uthum_softc * sc = ( uthum_softc * ) self ; int i , rv = 0 ; if ( sc -> sc_num_sensors > 0 ) { wakeup ( & sc -> sc_sensortask ) ; sensordev_deinstall ( & sc -> sc_sensordev ) ; for ( i = 0 ; i < UTHUM_MAX_SENSORS ; i ++ ) { if ( sc -> sc_sensor [ i ] . attached ) { sensor_detach ( & sc -> sc_sensordev , & sc -> sc_sensor [ i ] . sensor ) ; } } if ( sc -> sc_sensortask != NULL ) { sensor_task_unregister ( sc -> sc_sensortask ) ; } } uthum_reset_device ( sc , NULL ) ; return ( rv ) ; } 