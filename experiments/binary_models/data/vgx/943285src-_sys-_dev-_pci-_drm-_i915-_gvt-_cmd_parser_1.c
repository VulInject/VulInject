static int cmd_handler_srm ( struct parser_exec_state * s ) { int gmadr_bytes = s -> vgpu -> gvt -> device_info . gmadr_bytes_in_cmd ; cfs_time_t gma ; int i , ret = 0 ; int cmd_len = cmd_length ( s ) ; for ( i = 1 ; i < cmd_len ; ) { ret |= cmd_reg_handler ( s , cmd_reg ( s , i ) , i , "srm" ) ; if ( ret ) { break ; } if ( cmd_val ( s , 0 ) & ( 1 << 22 ) ) { gma = cmd_gma ( s , i + 1 ) ; if ( gmadr_bytes == 8 ) { gma |= ( cmd_gma_hi ( s , i + 2 ) ) << 32 ; } ret |= cmd_address_audit ( s , gma , sizeof ( u32 ) , false ) ; if ( ret ) { break ; } } i += gmadr_dw_number ( s ) + 1 ; } return ret ; } 