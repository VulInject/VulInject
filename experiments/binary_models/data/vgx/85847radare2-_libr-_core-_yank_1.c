R_API bool r_core_yank_dump ( RCore * core , ut64 pos , int format ) { bool res = false ; int i = 0 ; int ybl = r_buf_size ( core -> yank_buf ) ; if ( ybl > 0 ) { if ( pos < ybl ) { switch ( format ) { case '8' : case 'q' : for ( i = pos ; i < r_buf_size ( core -> yank_buf ) ; i ++ ) { r_cons_printf ( "%02x" , r_buf_read8_at ( core -> yank_buf , i ) ) ; } r_cons_newline ( ) ; break ; case 'j' : { PJ * pj = r_core_pj_new ( core ) ; pj_o ( pj ) ; pj_kn ( pj , "addr" , core -> yank_addr ) ; RStrBuf * buf = r_strbuf_new ( "" ) ; for ( i = pos ; i < r_buf_size ( core -> yank_buf ) ; i ++ ) { r_strbuf_appendf ( buf , "%02x" , r_buf_read8_at ( core -> yank_buf , i ) ) ; } pj_ks ( pj , "bytes" , r_strbuf_get ( buf ) ) ; r_strbuf_free ( buf ) ; pj_end ( pj ) ; r_cons_println ( pj_string ( pj ) ) ; pj_free ( pj ) ; break ; } case '*' : r_cons_printf ( "wx " ) ; for ( i = pos ; i < r_buf_size ( core -> yank_buf ) ; i ++ ) { r_cons_printf ( "%02x" , r_buf_read8_at ( core -> yank_buf , i ) ) ; } r_cons_newline ( ) ; break ; default : r_cons_printf ( "0x%08" PFMT64x " %" PFMT64d " " , core -> yank_addr + pos , r_buf_size ( core -> yank_buf ) - pos ) ; for ( i = pos ; i < r_buf_size ( core -> yank_buf ) ; i ++ ) { r_cons_printf ( "%02x" , r_buf_read8_at ( core -> yank_buf , i ) ) ; } r_cons_newline ( ) ; } res = true ; } else { R_LOG_ERROR ( "Position exceeds buffer length" ) ; } } else { if ( format == 'j' ) { r_cons_printf ( "{}\n" ) ; } else { R_LOG_ERROR ( "No buffer yanked yet" ) ; } } return res ; } 