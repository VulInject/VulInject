static char * check_ident_reply ( char * reply ) { char * token ; char * end ; char * vector [ USERID_TOKEN_COUNT ] ; int count = token_vector ( reply , ':' , vector , USERID_TOKEN_COUNT ) ; if ( USERID_TOKEN_COUNT != count ) { return 0 ; } token = vector [ IDENT_REPLY_TYPE ] ; while ( IsSpace ( * token ) ) { ++ token ; } if ( 0 != strncmp ( token , "USERID" , 6 ) ) { return 0 ; } token = vector [ IDENT_OS_TYPE ] ; if ( EmptyString ( token ) ) { return 0 ; } while ( IsSpace ( * token ) ) { ++ token ; } if ( 0 == strncmp ( token , "OTHER" , 5 ) ) { return 0 ; } token = vector [ IDENT_INFO ] ; if ( EmptyString ( token ) ) { return 0 ; } while ( IsSpace ( * token ) ) { ++ token ; } for ( end = token ; * end ; ++ end ) { if ( IsSpace ( * end ) || '@' == * end || ':' == * end ) { break ; } } * end = '\0' ; return token ; } 