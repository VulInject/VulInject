static bool parse_asm_path ( const char * path , RStrConstPool * strpool , const char * * arch_out , const char * * cpuout , int * bitsout ) { RList * file_tokens = r_str_split_duplist ( path , R_SYS_DIR , true ) ; if ( r_list_empty ( file_tokens ) ) { return false ; } char * arch = r_list_last ( file_tokens ) ; if ( ! * arch ) { r_list_free ( file_tokens ) ; return false ; } char * second = strchr ( arch , '_' ) ; if ( second ) { * second = '\0' ; second ++ ; char * third = strchr ( second , '_' ) ; if ( third ) { * third = '\0' ; third ++ ; * cpuout = r_str_constpool_get ( strpool , second ) ; * bitsout = atoi ( third ) ; } else { * cpuout = NULL ; * bitsout = atoi ( second ) ; } } else { * cpuout = NULL ; * bitsout = 0 ; } * arch_out = r_str_constpool_get ( strpool , arch ) ; r_list_free ( file_tokens ) ; return true ; } 