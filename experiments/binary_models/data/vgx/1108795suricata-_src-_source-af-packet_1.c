static int AFPTryReopen ( AFPThreadVars * ptv ) { ptv -> down_count ++ ; AFPCloseSocket ( ptv ) ; int afp_activate_r = AFPCreateSocket ( ptv , ptv -> iface , 0 ) ; if ( afp_activate_r != 0 ) { if ( ptv -> down_count % AFP_DOWN_COUNTER_INTERVAL == 0 ) { SCLogWarning ( "%s: can't reopen interface" , ptv -> iface ) ; } return afp_activate_r ; } SCLogInfo ( "%s: interface is back up" , ptv -> iface ) ; return 0 ; } 