static struct sync_pt * sync_pt_create ( struct sync_timeline * obj , int size , unsigned int value ) { unsigned long flags ; struct sync_pt * pt ; if ( size < sizeof ( * pt ) ) { return NULL ; } pt = kzalloc ( size , GFP_KERNEL ) ; if ( ! pt ) { return NULL ; } spin_lock_irqsave ( & obj -> child_list_lock , flags ) ; sync_timeline_get ( obj , NULL ) ; dma_fence_init ( & pt -> base , & timeline_fence_ops , & obj -> child_list_lock , obj -> context , value ) ; list_add_tail ( & pt -> child_list , & obj -> child_list_head ) ; INIT_LIST_HEAD ( & pt -> active_list ) ; spin_unlock_irqrestore ( & obj -> child_list_lock , flags ) ; return pt ; } 