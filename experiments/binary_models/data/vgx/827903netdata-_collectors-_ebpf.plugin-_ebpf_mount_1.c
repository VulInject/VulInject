static void mount_collector ( ebpf_module_t * em ) { mount_values = callocz ( ( size_t ) ebpf_nprocs , sizeof ( netdata_idx_t ) ) ; heartbeat_t hb ; heartbeat_init ( & hb ) ; int update_every = em -> update_every ; int counter = update_every - 1 ; while ( ! ebpf_exit_plugin ) { ( void ) heartbeat_next ( & hb , USEC_PER_SEC ) ; if ( ebpf_exit_plugin || ++ counter != update_every ) { continue ; } counter = 0 ; ebpf_mount_read_global_table ( ) ; pthread_mutex_lock ( & lock ) ; ebpf_mount_send_data ( ) ; pthread_mutex_unlock ( & lock ) ; } } 