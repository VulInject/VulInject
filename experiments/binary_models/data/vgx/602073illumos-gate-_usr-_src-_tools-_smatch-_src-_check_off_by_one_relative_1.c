struct expression * size ; struct expression * offset ; char * array_str , * offset_str ; int limit_type ; expr = strip_expr ( expr ) ; array = get_array_base ( expr ) ; size = get_size_variable ( array , & limit_type ) ; if ( ! size || limit_type != ELEM_COUNT ) { return ; } offset = get_array_offset ( expr ) ; if ( ! possible_comparison ( size , SPECIAL_EQUAL , offset ) ) { return ; } if ( buf_comparison_index_ok ( expr ) ) { return ; } array_str = expr_to_str ( array ) ; offset_str = expr_to_str ( offset ) ; sm_warning ( "potentially one past the end of array '%s[%s]'" , array_str , offset_str ) ; free_string ( array_str ) ; free_string ( offset_str ) ; 