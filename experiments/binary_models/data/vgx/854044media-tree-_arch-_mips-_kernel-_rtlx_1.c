static inline int write_spacefree ( int read , int write , int size ) { return ( ( read + size - write ) % size ) - 1 ; } 