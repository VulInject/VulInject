static int hns_nic_net_set_mac_address ( struct net_device * ndev , void * p ) { struct hns_nic_priv * priv = netdev_priv ( ndev ) ; struct hnae_handle * h = priv -> ae_handle ; struct sockaddr * mac_addr = p ; int ret ; ret = h -> dev -> ops -> set_mac_addr ( h , mac_addr -> sa_data ) ; if ( ret ) { netdev_err ( ndev , "set_mac_address fail, ret=%d!\n" , ret ) ; return ret ; } eth_hw_addr_set ( ndev , mac_addr -> sa_data ) ; return 0 ; } 