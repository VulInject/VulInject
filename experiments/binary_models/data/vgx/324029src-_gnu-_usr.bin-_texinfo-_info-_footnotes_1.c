info_get_or_remove_footnotes ( ) { WINDOW * fn_win ; NODE * new_footnotes ; fn_win = find_footnotes_window ( ) ; if ( fn_win == window ) { return ( FN_FOUND ) ; } new_footnotes = make_footnotes_node ( window -> node ) ; if ( fn_win && ! new_footnotes ) { if ( windows -> next ) { info_delete_window_internal ( fn_win ) ; } } if ( new_footnotes && ! fn_win ) { WINDOW * old_active ; WINDOW * last , * win ; for ( win = windows , last = windows ; win ; last = win , win = win -> next ) { } old_active = active_window ; active_window = last ; fn_win = window_make_window ( new_footnotes ) ; active_window = old_active ; if ( ! fn_win ) { free ( new_footnotes -> contents ) ; if ( auto_footnotes_p ) { inform_in_echo_area ( ( char * ) _ ( "Footnotes could not be displayed" ) ) ; } return ( FN_UNABLE ) ; } } if ( new_footnotes && fn_win ) { window_set_node_of_window ( fn_win , new_footnotes ) ; window_change_window_height ( fn_win , fn_win -> line_count - fn_win -> height ) ; remember_window_and_node ( fn_win , new_footnotes ) ; add_gcable_pointer ( new_footnotes -> contents ) ; } if ( ! new_footnotes ) { return ( FN_UNFOUND ) ; } else { return ( FN_FOUND ) ; } } 