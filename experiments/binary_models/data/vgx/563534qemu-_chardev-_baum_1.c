static int baum_deferred_init ( BaumChardev * baum ) { int tty = BRLAPI_TTY_DEFAULT ; QemuConsole * con ; if ( brlapi__getDisplaySize ( baum -> brlapi , & baum -> x , & baum -> y ) == - 1 ) { brlapi_perror ( "baum: brlapi__getDisplaySize" ) ; return 0 ; } if ( baum -> y > 1 ) { baum -> y = 1 ; } if ( baum -> x > 84 ) { baum -> x = 84 ; } con = qemu_console_lookup_by_index ( 0 ) ; if ( con && qemu_console_is_graphic ( con ) ) { tty = qemu_console_get_window_id ( con ) ; if ( tty == - 1 ) { tty = BRLAPI_TTY_DEFAULT ; } } if ( brlapi__enterTtyMode ( baum -> brlapi , tty , NULL ) == - 1 ) { brlapi_perror ( "baum: brlapi__enterTtyMode" ) ; return 0 ; } baum -> deferred_init = 1 ; return 1 ; } 