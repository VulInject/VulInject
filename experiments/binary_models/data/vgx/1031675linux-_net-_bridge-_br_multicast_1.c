void br_multicast_open ( struct net_bridge * br ) { ASSERT_RTNL ( ) ; if ( br_opt_get ( br , BROPT_MCAST_VLAN_SNOOPING_ENABLED ) ) { struct net_bridge_vlan_group * vg ; struct net_bridge_vlan * vlan ; vg = br_vlan_group ( br , NULL ) ; if ( vg ) { list_for_each_entry ( , , ) { struct net_bridge_mcast * brmctx ; brmctx = & vlan -> br_mcast_ctx ; if ( br_vlan_is_brentry ( vlan ) && ! br_multicast_ctx_vlan_disabled ( brmctx ) ) { __br_multicast_open ( & vlan -> br_mcast_ctx ) ; } } } } else { __br_multicast_open ( & br -> multicast_ctx ) ; } } 