bool bgp_attr_rmac ( struct attr * attr , struct ethaddr * rmac ) { uint32_t i = 0 ; struct ecommunity * ecom ; ecom = bgp_attr_get_ecommunity ( attr ) ; for ( i = 0 ; i < ecom -> size ; i ++ ) { uint8_t * pnt = NULL ; uint8_t type = 0 ; uint8_t sub_type = 0 ; pnt = ( ecom -> val + ( i * ECOMMUNITY_SIZE ) ) ; type = * pnt ++ ; sub_type = * pnt ++ ; if ( ! ( type == ECOMMUNITY_ENCODE_EVPN && sub_type == ECOMMUNITY_EVPN_SUBTYPE_ROUTERMAC ) ) { continue ; } memcpy ( rmac , pnt , ETH_ALEN ) ; return true ; } return false ; } 