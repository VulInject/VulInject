static int get_xfer_size ( struct tree * t , int fd , const char * path ) { t -> current_filesystem -> xfer_align = - 1 ; if ( fd >= 0 ) { t -> current_filesystem -> incr_xfer_size = fpathconf ( fd , _PC_REC_INCR_XFER_SIZE ) ; t -> current_filesystem -> max_xfer_size = fpathconf ( fd , _PC_REC_MAX_XFER_SIZE ) ; t -> current_filesystem -> min_xfer_size = fpathconf ( fd , _PC_REC_MIN_XFER_SIZE ) ; t -> current_filesystem -> xfer_align = fpathconf ( fd , _PC_REC_XFER_ALIGN ) ; } if ( path != NULL ) { t -> current_filesystem -> incr_xfer_size = pathconf ( path , _PC_REC_INCR_XFER_SIZE ) ; t -> current_filesystem -> max_xfer_size = pathconf ( path , _PC_REC_MAX_XFER_SIZE ) ; t -> current_filesystem -> min_xfer_size = pathconf ( path , _PC_REC_MIN_XFER_SIZE ) ; t -> current_filesystem -> xfer_align = pathconf ( path , _PC_REC_XFER_ALIGN ) ; } if ( t -> current_filesystem -> xfer_align == - 1 ) { return ( ( errno == EINVAL ) ?1 : - 1 ) ; } else { return ( 0 ) ; } } 