static int w1_gpio_remove ( struct platform_device * pdev ) { struct w1_bus_master * master = platform_get_drvdata ( pdev ) ; struct w1_gpio_platform_data * pdata = dev_get_platdata ( & pdev -> dev ) ; if ( pdata -> enable_external_pullup ) { pdata -> enable_external_pullup ( 0 ) ; } if ( pdata -> pullup_gpiod ) { gpiod_set_value ( pdata -> pullup_gpiod , 0 ) ; } w1_remove_master_device ( master , NULL ) ; return 0 ; } 