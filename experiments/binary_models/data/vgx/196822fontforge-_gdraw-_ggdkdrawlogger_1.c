void LogEx ( int level , const char * funct , const char * file , int line , const char * fmt , ... ) { int buffer [ BUFSIZ ] ; va_list va ; if ( level > log_level ) { return ; } va_start ( va , fmt ) ; vsnprintf ( buffer , BUFSIZ , fmt , va ) ; va_end ( va ) ; if ( funct == NULL ) { funct = unspecified_funct ; } const char * severity ; switch ( level ) { case LOGERR : severity = "ERROR" ; break ; case LOGWARN : severity = "WARNING" ; break ; case LOGINFO : severity = "INFO" ; break ; default : severity = "DEBUG" ; break ; } GDateTime * now = g_date_time_new_now_local ( ) ; fprintf ( stderr , "%02d:%02d:%02.3f %s: %s (%s:%d) - %s\n" , g_date_time_get_hour ( now ) , g_date_time_get_minute ( now ) , g_date_time_get_seconds ( now ) , severity , funct , file , line , buffer ) ; fflush ( stderr ) ; g_date_time_unref ( now ) ; } 