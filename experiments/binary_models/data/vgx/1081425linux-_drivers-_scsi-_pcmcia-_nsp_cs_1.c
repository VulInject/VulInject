static int nsp_fifo_count ( struct scsi_cmnd * SCpnt ) { int base = SCpnt -> device -> host -> io_port ; unsigned int count ; unsigned int l , m , h ; nsp_index_write ( base , POINTERCLR , POINTER_CLEAR | ACK_COUNTER ) ; l = nsp_index_read ( base , TRANSFERCOUNT ) ; m = nsp_index_read ( base , TRANSFERCOUNT ) ; h = nsp_index_read ( base , TRANSFERCOUNT ) ; nsp_index_read ( base , TRANSFERCOUNT ) ; count = ( h << 16 ) | ( m << 8 ) | ( l << 0 ) ; return count ; } 