int FUN1 ( const char * VAR1 , int * VAR2 , int * VAR3 , short * * VAR4 ) { int VAR5 , VAR6 , VAR7 , VAR8 , VAR9 ; short * VAR10 ; VAR11 * VAR12 = FUN2 ( VAR1 , & VAR9 , NULL ) ; VAR8 = VAR12 -> VAR2 * 4096 ; * VAR2 = VAR12 -> VAR2 ; if ( VAR3 ) { * VAR3 = VAR12 -> VAR3 ; } VAR6 = VAR5 = 0 ; VAR7 = VAR8 ; VAR10 = ( short * ) malloc ( VAR7 * sizeof ( * VAR10 ) ) ; if ( VAR10 == NULL ) { FUN3 ( VAR12 ) ; return - 2 ; } for ( ; ; ) { int VAR13 = FUN4 ( VAR12 , VAR12 -> VAR2 , VAR10 + VAR6 , VAR7 - VAR6 ) ; if ( VAR13 == 0 ) { break ; } VAR5 += VAR13 ; VAR6 += VAR13 * VAR12 -> VAR2 ; if ( VAR6 + VAR8 > VAR7 ) { short * VAR14 ; VAR7 *= 2 ; VAR14 = ( short * ) realloc ( VAR10 , VAR7 * sizeof ( * VAR10 ) ) ; if ( VAR14 == NULL ) { free ( VAR10 ) ; FUN3 ( VAR12 ) ; return - 2 ; } VAR10 = VAR14 ; } } * VAR4 = VAR10 ; FUN3 ( VAR12 ) ; return VAR5 ; }