int uwsgi_queue_set ( uint64_t pos , char * message , uint64_t size ) { struct uwsgi_queue_item * uqi ; char * ptr = ( char * ) uwsgi . queue ; if ( ! size ) { return 0 ; } if ( pos >= uwsgi . queue_size ) { return 0 ; } ptr = ptr + ( uwsgi . queue_blocksize * pos ) ; uqi = ( uwsgi_queue_item * ) ptr ; ptr += sizeof ( uwsgi_queue_item ) ; uqi -> size = size ; uqi -> ts = uwsgi_now ( ) ; memcpy ( ptr , message , size ) ; return 1 ; } 