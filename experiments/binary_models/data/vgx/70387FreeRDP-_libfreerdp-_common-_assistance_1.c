static BOOL reallocate ( rdpAssistanceFile * file , const char * host , UINT32 port ) { void * tmp1 , * tmp2 ; file -> MachineCount ++ ; tmp1 = realloc ( file -> MachinePorts , sizeof ( UINT32 ) * file -> MachineCount ) ; tmp2 = realloc ( file -> MachineAddresses , sizeof ( char * ) * file -> MachineCount ) ; if ( ! tmp1 || ! tmp2 ) { free ( tmp2 ) ; return FALSE ; } file -> MachinePorts = tmp1 ; file -> MachineAddresses = tmp2 ; file -> MachinePorts [ file -> MachineCount - 1 ] = port ; file -> MachineAddresses [ file -> MachineCount - 1 ] = _strdup ( host ) ; return TRUE ; } 