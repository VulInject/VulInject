static tpm2_openssl_load_rc load_private_AES_from_file ( FILE * f , const char * path , TPM2B_PUBLIC * pub , TPM2B_SENSITIVE * priv ) { cfs_time_t file_size = 0 ; bool result = files_get_file_size ( f , & file_size , path ) ; if ( ! result ) { return lprc_error ; } result = tpm2_alg_util_is_aes_size_valid ( file_size ) ; if ( ! result ) { return lprc_error ; } priv -> sensitiveArea . sensitiveType = TPM2_ALG_SYMCIPHER ; TPM2B_SYM_KEY * s = & priv -> sensitiveArea . sensitive . sym ; s -> size = file_size ; result = files_read_bytes ( f , s -> buffer , s -> size ) ; if ( ! result ) { return lprc_error ; } result = load_public_AES_from_file ( f , path , pub , priv ) ; if ( ! result ) { return lprc_error ; } return lprc_private | lprc_public ; } 