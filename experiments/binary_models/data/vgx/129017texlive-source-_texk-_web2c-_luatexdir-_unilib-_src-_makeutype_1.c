static void dump_alttable ( ) { int i , j ; FILE * file ; if ( ( file = fopen ( "unialt.c" , "w" ) ) == NULL ) { fprintf ( stderr , CantSaveFile , "unialt.c" ) ; return ; } fprintf ( file , "#include<chardata.h>\n" ) ; fprintf ( file , GeneratedFileMessage ) ; for ( i = 32 ; i < MAXC ; ++ i ) { if ( alts [ i ] [ 0 ] != 0 ) { fprintf ( file , "static const unichar_t str_%x[] = { 0x%04x, " , i , alts [ i ] [ 0 ] ) ; for ( j = 1 ; j < MAXA && alts [ i ] [ j ] != 0 ; ++ j ) { fprintf ( file , "0x%04x, " , alts [ i ] [ j ] ) ; } fprintf ( file , "0 };\n" ) ; } } fprintf ( file , "\n" ) ; fprintf ( file , "static const unichar_t *const up_allzeros[256] = { NULL };\n\n" ) ; for ( i = 32 ; i < 0xffff ; ++ i ) { if ( alts [ i ] [ 0 ] != 0 ) { fprintf ( file , "static const unichar_t * const tab_%x[] = {\n" , i >> 8 ) ; for ( j = ( i & 0xff00 ) ; j <= ( i & 0xff00 ) + 0xff ; ++ j ) { if ( alts [ j ] [ 0 ] == 0 ) { fprintf ( file , "0, " ) ; } else { fprintf ( file , "str_%x,\n" , j ) ; } } fprintf ( file , "0};\n\n" ) ; i = j ; } } fprintf ( file , "const unichar_t *const * const unicode_alternates[] = {\n" ) ; for ( i = 0 ; i <= 0xff ; ++ i ) { if ( AnyAlts ( i ) ) { fprintf ( file , "tab_%x,\n" , i ) ; } else { fprintf ( file , "up_allzeros, " ) ; } } fprintf ( file , "0};\n" ) ; fclose ( file , NULL ) ; file = fopen ( "chardata.h" , "a" ) ; fprintf ( file , GeneratedFileMessage ) ; fprintf ( file , "\nextern const unichar_t *const * const unicode_alternates[];\n" ) ; fclose ( file ) ; } 