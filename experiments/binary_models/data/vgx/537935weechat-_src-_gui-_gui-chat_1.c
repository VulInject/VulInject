gui_chat_prefix_build ( ) { const char * ptr_prefix ; char prefix [ 512 ] , * pos_color ; int prefix_color [ GUI_CHAT_NUM_PREFIXES ] { GUI_COLOR_CHAT_PREFIX_ERROR GUI_COLOR_CHAT_PREFIX_NETWORK GUI_COLOR_CHAT_PREFIX_ACTION GUI_COLOR_CHAT_PREFIX_JOIN GUI_COLOR_CHAT_PREFIX_QUIT } ; ; int i ; for ( i = 0 ; i < GUI_CHAT_NUM_PREFIXES ; i ++ ) { if ( gui_chat_prefix [ i ] ) { gui_chat_prefix [ i ] = NULL ; } ptr_prefix = CONFIG_STRING ( config_look_prefix [ i ] ) ; pos_color = strstr ( ptr_prefix , "${" ) ; snprintf ( prefix , sizeof ( prefix ) , "%s%s\t" , ( ptr_prefix [ 0 ] && ( ! pos_color || ( pos_color > ptr_prefix ) ) ) ?GUI_COLOR ( prefix_color [ i ] ) : "" , ptr_prefix ) ; if ( pos_color ) { gui_chat_prefix [ i ] = eval_expression ( prefix , NULL , NULL , NULL ) ; } else { gui_chat_prefix [ i ] = strdup ( prefix ) ; } } } 