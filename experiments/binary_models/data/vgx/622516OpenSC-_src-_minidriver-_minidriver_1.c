static DWORD FUN1 ( PCARD_DATA VAR1 , DWORD VAR2 , VAR3 * VAR4 ) { VAR5 * VAR6 = NULL ; struct VAR7 * VAR8 ; int VAR9 = 0 , VAR10 , VAR11 = 0 , VAR12 ; if ( ! VAR4 ) { return VAR13 ; } if ( VAR4 -> VAR14 != VAR15 && VAR4 -> VAR14 != 0 ) { return VAR16 ; } FUN2 ( VAR1 , 1 , "" , ( unsigned long ) VAR2 ) ; VAR6 = ( VAR5 * ) ( VAR1 -> VAR17 ) ; if ( ! VAR6 ) { return VAR13 ; } VAR9 = VAR6 -> VAR18 -> VAR19 -> VAR20 ; VAR4 -> VAR14 = VAR15 ; VAR4 -> VAR21 = 0 ; VAR4 -> VAR22 = 0 ; VAR4 -> VAR23 = 0 ; if ( ( VAR2 == 0 ) || ( VAR2 == VAR24 ) || ( VAR2 == VAR25 ) ) { for ( VAR10 = 0 ; VAR10 < VAR9 ; VAR10 ++ ) { VAR8 = VAR6 -> VAR18 -> VAR19 -> VAR26 + VAR10 ; if ( VAR8 -> VAR27 == VAR28 ) { if ( VAR4 -> VAR29 == 0 || VAR4 -> VAR29 > VAR8 -> VAR30 ) { VAR4 -> VAR29 = VAR8 -> VAR30 ; } if ( VAR4 -> VAR22 == 0 || VAR4 -> VAR22 < VAR8 -> VAR30 ) { VAR4 -> VAR22 = VAR8 -> VAR30 ; } if ( VAR8 -> VAR30 == 2048 ) { VAR4 -> VAR21 = VAR8 -> VAR30 ; } if ( VAR8 -> VAR30 == 1536 ) { VAR4 -> VAR23 = 512 ; } } } if ( VAR4 -> VAR29 == 0 ) { FUN2 ( VAR1 , 0 , "" ) ; return VAR13 ; } if ( VAR4 -> VAR21 == 0 ) { FUN2 ( VAR1 , 3 , "" ) ; VAR4 -> VAR21 = VAR4 -> VAR22 ; } if ( VAR4 -> VAR23 == 0 ) { VAR4 -> VAR23 = 1024 ; } } else { VAR11 = 0 ; for ( VAR10 = 0 ; VAR10 < VAR9 ; VAR10 ++ ) { VAR8 = VAR6 -> VAR18 -> VAR19 -> VAR26 + VAR10 ; if ( VAR8 -> VAR27 == VAR31 ) { VAR12 = VAR32 ; if ( ( VAR2 == VAR33 ) && ( VAR8 -> VAR30 == 256 ) && ( VAR8 -> VAR34 & VAR12 ) ) { VAR11 = 256 ; break ; } if ( ( VAR2 == VAR35 ) && ( VAR8 -> VAR30 == 384 ) && ( VAR8 -> VAR34 & VAR12 ) ) { VAR11 = 384 ; break ; } if ( ( VAR2 == VAR36 ) && ( VAR8 -> VAR30 == 521 ) && ( VAR8 -> VAR34 & VAR12 ) ) { VAR11 = 521 ; break ; } VAR12 = VAR37 | VAR38 | VAR39 | VAR40 | VAR41 ; if ( ( VAR2 == VAR42 ) && ( VAR8 -> VAR30 == 256 ) && ( VAR8 -> VAR34 & VAR12 ) ) { VAR11 = 256 ; break ; } if ( ( VAR2 == VAR43 ) && ( VAR8 -> VAR30 == 384 ) && ( VAR8 -> VAR34 & VAR12 ) ) { VAR11 = 384 ; break ; } if ( ( VAR2 == VAR44 ) && ( VAR8 -> VAR30 == 521 ) && ( VAR8 -> VAR34 & VAR12 ) ) { VAR11 = 521 ; break ; } } if ( VAR11 ) { VAR4 -> VAR29 = VAR11 ; VAR4 -> VAR21 = VAR11 ; VAR4 -> VAR22 = VAR11 ; VAR4 -> VAR23 = 1 ; } else { FUN2 ( VAR1 , 0 , "" , ( unsigned long ) VAR2 ) ; return VAR13 ; } } } FUN2 ( VAR1 , 3 , "" ) ; FUN2 ( VAR1 , 3 , "" , ( unsigned long ) VAR4 -> VAR29 ) ; FUN2 ( VAR1 , 3 , "" , ( unsigned long ) VAR4 -> VAR21 ) ; FUN2 ( VAR1 , 3 , "" , ( unsigned long ) VAR4 -> VAR22 ) ; FUN2 ( VAR1 , 3 , "" , ( unsigned long ) VAR4 -> VAR23 ) ; return VAR45 ; }