int kvm_put_vcpu_events ( ARMCPU * cpu ) { CPUARMState * env = & cpu -> env ; struct kvm_vcpu_events events ; int ret ; if ( ! kvm_has_vcpu_events ( ) ) { return 0 ; } events . exception . serror_pending = env -> serror . pending ; if ( cap_has_inject_serror_esr ) { events . exception . serror_has_esr = env -> serror . has_esr ; events . exception . serror_esr = env -> serror . esr ; } ret = kvm_vcpu_ioctl ( CPU ( cpu ) , KVM_SET_VCPU_EVENTS , & events ) ; if ( ret ) { error_report ( "failed to put vcpu events" ) ; } return ret ; } 