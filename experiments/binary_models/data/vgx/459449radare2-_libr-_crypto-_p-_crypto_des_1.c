static bool des_set_key ( RCryptoJob * cj , const ut8 * key , int keylen , int mode , int direction ) { ut32 keylo , keyhi , i ; if ( keylen != DES_KEY_SIZE ) { return false ; } keylo = be32 ( key ) ; keyhi = be32 ( key + 4 ) ; cj -> data = R_NEW0 ( des_state ) ; struct des_state * st = cj -> data ; st -> key_size = DES_KEY_SIZE ; st -> rounds = 16 ; cj -> dir = direction ; r_des_permute_key ( & keylo , & keyhi ) ; for ( i = 0 ; i < 16 ; i ++ ) { r_des_round_key ( i , & st -> keylo [ i ] , & st -> keyhi [ i ] , & keylo , & keyhi ) ; } return true ; } 