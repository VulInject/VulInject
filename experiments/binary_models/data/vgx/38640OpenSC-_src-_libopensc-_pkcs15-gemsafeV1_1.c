static int FUN1 ( VAR1 * VAR2 ) { int VAR3 ; unsigned int VAR4 ; struct sc_path VAR5 ; struct VAR6 * VAR7 = NULL ; struct VAR8 * VAR9 = VAR2 -> VAR9 ; struct sc_apdu VAR10 ; u8 VAR11 [ VAR12 ] ; FUN2 ( VAR2 -> VAR9 -> VAR13 , "" ) ; FUN3 ( & VAR2 -> VAR14 -> VAR15 , VAR16 ) ; if ( ! VAR2 -> VAR14 -> VAR15 ) { return VAR17 ; } FUN3 ( & VAR2 -> VAR14 -> VAR18 , VAR19 ) ; if ( ! VAR2 -> VAR14 -> VAR18 ) { VAR2 -> VAR14 -> VAR15 = NULL ; return VAR17 ; } FUN4 ( VAR9 , & VAR10 , VAR20 , 0xca , 0xdf , 0x03 ) ; VAR10 . VAR21 = 0x80 ; VAR10 . VAR22 = VAR11 ; VAR10 . VAR23 = sizeof ( VAR11 ) ; VAR10 . VAR24 = 0x08 ; VAR10 . VAR25 = 0 ; VAR10 . VAR26 = 0 ; VAR3 = FUN5 ( VAR9 , & VAR10 ) ; if ( VAR3 < 0 ) { FUN6 ( VAR2 ) ; } FUN7 ( VAR9 -> VAR13 , VAR3 , "" ) ; if ( VAR10 . VAR27 != 0x90 || VAR10 . VAR28 != 0x00 || VAR3 != VAR29 ) { FUN6 ( VAR2 ) ; return VAR17 ; } FUN3 ( & VAR2 -> VAR14 -> VAR30 , VAR31 ) ; if ( ! VAR2 -> VAR14 -> VAR30 ) { FUN6 ( VAR2 ) ; return VAR17 ; } VAR3 = FUN8 ( VAR9 ) ; if ( VAR3 != VAR29 ) { FUN6 ( VAR2 ) ; return VAR17 ; } FUN2 ( VAR2 -> VAR9 -> VAR13 , "" ) ; for ( VAR4 = 0 ; VAR4 < VAR32 ; VAR4 ++ ) { struct sc_pkcs15_id VAR33 ; struct sc_path VAR5 ; if ( VAR34 [ VAR4 ] . VAR15 == NULL ) { continue ; } FUN9 ( VAR34 [ VAR4 ] . VAR5 , & VAR5 ) ; FUN10 ( VAR34 [ VAR4 ] . VAR35 , & VAR33 ) ; VAR5 . VAR36 = VAR34 [ VAR4 ] . VAR36 ; VAR5 . VAR37 = VAR34 [ VAR4 ] . VAR37 ; FUN11 ( VAR2 , VAR38 , VAR34 [ VAR4 ] . VAR39 , & VAR5 , & VAR33 , VAR34 [ VAR4 ] . VAR15 , VAR34 [ VAR4 ] . VAR40 ) ; } FUN2 ( VAR2 -> VAR9 -> VAR13 , "" ) ; for ( VAR4 = 0 ; VAR4 < VAR41 ; VAR4 ++ ) { struct sc_pkcs15_id VAR33 ; struct sc_path VAR5 ; FUN10 ( VAR42 [ VAR4 ] . VAR35 , & VAR33 ) ; FUN9 ( VAR42 [ VAR4 ] . VAR5 , & VAR5 ) ; if ( VAR42 [ VAR4 ] . VAR43 == 0 || ( VAR42 [ VAR4 ] . VAR43 == VAR2 -> VAR9 -> VAR44 . VAR45 && memcmp ( VAR2 -> VAR9 -> VAR44 . VAR46 , VAR42 [ VAR4 ] . VAR44 , VAR2 -> VAR9 -> VAR44 . VAR45 ) == 0 ) ) { FUN12 ( VAR2 , & VAR33 , VAR42 [ VAR4 ] . VAR15 , & VAR5 , VAR42 [ VAR4 ] . VAR47 , VAR42 [ VAR4 ] . VAR48 , VAR42 [ VAR4 ] . VAR49 , VAR42 [ VAR4 ] . VAR50 , VAR42 [ VAR4 ] . VAR51 , VAR42 [ VAR4 ] . VAR52 , VAR42 [ VAR4 ] . VAR53 , VAR42 [ VAR4 ] . VAR40 ) ; break ; } } FUN2 ( VAR2 -> VAR9 -> VAR13 , "" ) ; for ( VAR4 = 0 ; VAR4 < VAR32 ; VAR4 ++ ) { struct sc_pkcs15_id VAR33 , VAR54 , * VAR55 ; struct sc_path VAR5 ; int VAR56 = 0x03 ; if ( VAR57 [ VAR4 ] . VAR15 == NULL ) { continue ; } FUN10 ( VAR57 [ VAR4 ] . VAR35 , & VAR33 ) ; if ( VAR57 [ VAR4 ] . VAR58 ) { FUN10 ( VAR57 [ VAR4 ] . VAR58 , & VAR54 ) ; VAR55 = & VAR54 ; } else { VAR55 = NULL ; } FUN9 ( VAR57 [ VAR4 ] . VAR5 , & VAR5 ) ; if ( VAR2 -> VAR9 -> VAR51 & 0x0F ) { VAR56 = VAR2 -> VAR9 -> VAR51 & 0x0F ; FUN2 ( VAR2 -> VAR9 -> VAR13 , "" , VAR57 [ VAR4 ] . VAR47 , VAR56 ) ; } else { VAR56 = VAR57 [ VAR4 ] . VAR47 ; } FUN13 ( VAR2 , & VAR33 , VAR57 [ VAR4 ] . VAR15 , VAR59 , VAR57 [ VAR4 ] . VAR60 , VAR57 [ VAR4 ] . VAR61 , & VAR5 , VAR56 , VAR55 , VAR57 [ VAR4 ] . VAR40 ) ; } FUN2 ( VAR2 -> VAR9 -> VAR13 , "" ) ; FUN9 ( VAR62 , & VAR5 ) ; VAR3 = FUN14 ( VAR9 , & VAR5 , & VAR7 ) ; if ( VAR3 != VAR29 || ! VAR7 ) { FUN6 ( VAR2 ) ; return VAR17 ; } FUN15 ( VAR2 -> VAR63 ) ; VAR2 -> VAR63 = VAR7 ; return VAR29 ; }