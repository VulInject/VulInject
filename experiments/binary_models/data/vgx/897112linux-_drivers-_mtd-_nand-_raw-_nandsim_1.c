static int ns_parse_gravepages ( void ) { char * g ; int zero_ok ; unsigned int page_no ; unsigned int max_reads ; struct grave_page * gp ; g = gravepages ; { zero_ok = ( * g == '0' ?1 : 0 ) ; page_no = simple_strtoul ( g , & g , 0 ) ; if ( ! zero_ok && ! page_no ) { NS_ERR ( "invalid gravepagess.\n" ) ; return - EINVAL ; } max_reads = 3 ; if ( * g == ':' ) { g += 1 ; max_reads = simple_strtoul ( g , & g , 0 ) ; } if ( * g == ',' ) { g += 1 ; } gp = kzalloc ( sizeof ( * gp ) , GFP_KERNEL ) ; if ( ! gp ) { NS_ERR ( "unable to allocate memory.\n" ) ; return - ENOMEM ; } gp -> page_no = page_no ; gp -> max_reads = max_reads ; list_add ( & gp -> list , & grave_pages ) ; } * g ; return 0 ; } 