file_gex_validate_path ( , , , , ) { gchar * dirname = g_path_get_dirname ( path ) ; gboolean valid = TRUE ; if ( g_path_is_absolute ( path ) || g_strcmp0 ( dirname , "/" ) == 0 ) { * error = g_error_new ( GIMP_EXTENSION_ERROR , GIMP_EXTENSION_FAILED , _ ( "Absolute path are forbidden in GIMP extension '%s': %s" ) , file_name , path ) ; return FALSE ; } if ( g_strcmp0 ( dirname , "." ) == 0 ) { if ( first ) { * error = g_error_new ( GIMP_EXTENSION_ERROR , GIMP_EXTENSION_FAILED , _ ( "File not allowed in root of GIMP extension '%s': %s" ) , file_name , path ) ; valid = FALSE ; } else { if ( * plugin_id ) { if ( g_strcmp0 ( path , * plugin_id ) != 0 ) { * error = g_error_new ( GIMP_EXTENSION_ERROR , GIMP_EXTENSION_FAILED , _ ( "File not in GIMP extension '%s' folder id '%s': %s" ) , file_name , * plugin_id , path ) ; valid = FALSE ; } } else { * plugin_id = g_strdup ( path ) ; } } } else { valid = file_gex_validate_path ( dirname , file_name , FALSE , plugin_id , error ) ; } g_free ( dirname ) ; return valid ; } 