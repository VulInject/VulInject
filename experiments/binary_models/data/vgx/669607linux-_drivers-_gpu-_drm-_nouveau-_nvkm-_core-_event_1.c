static void nvkm_event_ntfy_block_ ( struct nvkm_event_ntfy * ntfy , bool wait ) { struct nvkm_subdev * subdev = ntfy -> event -> subdev ; nvkm_trace ( subdev , "event: ntfy block %08x on %d wait:%d\n" , ntfy -> bits , ntfy -> id , wait ) ; if ( atomic_xchg ( & ntfy -> allowed , 0 ) == 1 ) { nvkm_event_ntfy_state ( ntfy , NULL ) ; if ( wait ) { nvkm_event_ntfy_remove ( ntfy ) ; } } } 