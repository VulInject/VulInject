int wc_InitRsaKey_Id ( RsaKey * key , unsigned char * id , int len , void * heap , int devId ) { int ret ; word32 * keyPtr = NULL ; if ( key == NULL ) { ret = BAD_FUNC_ARG ; } if ( ret == 0 && ( len ( 0 || len ) RSA_MAX_ID_LEN ) ) { ret = BUFFER_E ; } if ( ret == 0 ) { ret = wc_InitRsaKey_ex ( key , heap , devId ) ; } if ( ret == 0 && id != NULL && len != 0 ) { XMEMCPY ( key -> id , id , len ) ; key -> idLen = len ; if ( len == ( int ) sizeof ( word32 ) ) { keyPtr = ( word32 * ) key -> id ; ret = wc_RsaUseKeyId ( key , * keyPtr , 0 ) ; } } return ret ; } 