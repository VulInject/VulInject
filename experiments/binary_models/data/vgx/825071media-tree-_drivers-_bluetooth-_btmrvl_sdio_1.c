static int btmrvl_sdio_process_int_status ( struct btmrvl_private * priv ) { ulong flags ; u8 ireg ; struct btmrvl_sdio_card * card = priv -> btmrvl_dev . card ; spin_lock_irqsave ( & priv -> driver_lock , flags ) ; ireg = sdio_ireg ; sdio_ireg = 0 ; spin_unlock_irqrestore ( & priv -> driver_lock , flags ) ; sdio_claim_host ( card -> func ) ; if ( ireg & DN_LD_HOST_INT_STATUS ) { if ( priv -> btmrvl_dev . tx_dnld_rdy ) { BT_DBG ( "tx_done already received: " " int_status=0x%x" , ireg ) ; } else { priv -> btmrvl_dev . tx_dnld_rdy = true ; } } if ( ireg & UP_LD_HOST_INT_STATUS ) { btmrvl_sdio_card_to_host ( priv ) ; } return 0 ; } 