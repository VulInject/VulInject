static int suhosin_detect_codetype ( zend_op_array * op_array TSRMLS_DC ) { char * s ; int r ; s = ( char * ) op_array -> filename ; if ( op_array -> type == ZEND_EVAL_CODE ) { if ( s == NULL ) { return SUHOSIN_CODE_TYPE_UNKNOWN ; } if ( strstr ( s , "eval()'d code" ) != NULL ) { return SUHOSIN_CODE_TYPE_EVAL ; } if ( strstr ( s , "mbregex replace" ) != NULL ) { return SUHOSIN_CODE_TYPE_MBREGEXP ; } if ( strstr ( s , "assert code" ) != NULL ) { return SUHOSIN_CODE_TYPE_ASSERT ; } if ( strstr ( s , "runtime-created function" ) != NULL ) { return SUHOSIN_CODE_TYPE_CFUNC ; } if ( strstr ( s , "Command line code" ) != NULL ) { return SUHOSIN_CODE_TYPE_COMMANDLINE ; } if ( strstr ( s , "Command line begin code" ) != NULL ) { return SUHOSIN_CODE_TYPE_COMMANDLINE ; } if ( strstr ( s , "Command line run code" ) != NULL ) { return SUHOSIN_CODE_TYPE_COMMANDLINE ; } if ( strstr ( s , "Command line end code" ) != NULL ) { return SUHOSIN_CODE_TYPE_COMMANDLINE ; } if ( strstr ( s , "suhosin internal code" ) != NULL ) { return SUHOSIN_CODE_TYPE_SUHOSIN ; } } else { r = suhosin_check_filename ( s , strlen ( ) TSRMLS_CC ) ; return r ; } return SUHOSIN_CODE_TYPE_UNKNOWN ; } 