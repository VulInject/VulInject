int sp_ecc_proj_add_point_256 ( mp_int * pX , mp_int * pY , mp_int * pZ , mp_int * qX , mp_int * qY , mp_int * qZ , mp_int * rX , mp_int * rY , mp_int * rZ ) { sp_digit * tmp = NULL ; sp_point_256 * p ; sp_digit tmp [ 2 * 8 * 6 ] ; sp_point_256 p [ 2 ] ; sp_point_256 * q = NULL ; int err = MP_OKAY ; if ( err == MP_OKAY ) { p = ( sp_point_256 * ) XMALLOC ( sizeof ( sp_point_256 ) * 2 , NULL , DYNAMIC_TYPE_ECC ) ; if ( p == NULL ) { err = MEMORY_E ; } } if ( err == MP_OKAY ) { tmp = ( sp_digit * ) XMALLOC ( sizeof ( sp_digit ) * 2 * 8 * 6 , NULL , DYNAMIC_TYPE_ECC ) ; if ( tmp == NULL ) { err = MEMORY_E ; } } if ( err == MP_OKAY ) { q = p + 1 ; sp_256_from_mp ( p -> x , 8 , pX ) ; sp_256_from_mp ( p -> y , 8 , pY ) ; sp_256_from_mp ( p -> z , 8 , pZ ) ; sp_256_from_mp ( q -> x , 8 , qX ) ; sp_256_from_mp ( q -> y , 8 , qY ) ; sp_256_from_mp ( q -> z , 8 , qZ ) ; p -> infinity = sp_256_iszero_8 ( p -> x ) & sp_256_iszero_8 ( p -> y ) ; q -> infinity = sp_256_iszero_8 ( q -> x ) & sp_256_iszero_8 ( q -> y ) ; sp_256_proj_point_add_8 ( p , p , q , tmp ) ; } if ( err == MP_OKAY ) { err = sp_256_to_mp ( p -> x , rX ) ; } if ( err == MP_OKAY ) { err = sp_256_to_mp ( p -> y , rY ) ; } if ( err == MP_OKAY ) { err = sp_256_to_mp ( p -> z , rZ ) ; } if ( tmp != NULL ) { XFREE ( tmp , NULL , DYNAMIC_TYPE_ECC ) ; } if ( p != NULL ) { XFREE ( p , NULL , DYNAMIC_TYPE_ECC ) ; } return err ; } 