static void pwquality_register_hook ( struct hook_user_register_check * const restrict hdata ) { return_if_fail ( hdata != NULL ) ; return_if_fail ( hdata -> si != NULL ) ; return_if_fail ( hdata -> password != NULL ) ; if ( pwquality_password_okay ( hdata -> si , hdata -> password ) ) { return ; } if ( pwquality_warn_only ) { ( void ) command_fail ( hdata -> si , fault_badparams , _ ( "You may want to set a different password with: " "\2/msg %s SET PASSWORD<newpassword>\2" ) , nicksvs . me -> disp ) ; return ; } ( void ) command_fail ( hdata -> si , fault_badparams , _ ( "Registration denied due to insecure password" ) ) ; hdata -> approved ++ ; } 