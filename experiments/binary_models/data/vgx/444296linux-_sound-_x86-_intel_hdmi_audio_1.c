static int had_chmap_ctl_get ( struct snd_kcontrol * kcontrol , struct snd_ctl_elem_value * ucontrol ) { struct snd_pcm_chmap * info = snd_kcontrol_chip ( kcontrol ) ; struct snd_intelhad * intelhaddata = info -> private_data ; int i ; const struct snd_pcm_chmap_elem * chmap ; mutex_lock ( & intelhaddata -> mutex ) ; if ( ! intelhaddata -> chmap -> chmap ) { mutex_unlock ( & intelhaddata -> mutex ) ; return 0 ; } chmap = intelhaddata -> chmap -> chmap ; for ( i = 0 ; i < chmap -> channels ; i ++ ) { ucontrol -> value . integer . value [ i ] = chmap -> map [ i ] ; } mutex_unlock ( & intelhaddata -> mutex ) ; return 0 ; } 