MtMethodAnalysisWalkEnd ( , , ) { ASL_ANALYSIS_WALK_INFO * WalkInfo = ( ASL_ANALYSIS_WALK_INFO * ) Context ; ASL_METHOD_INFO * MethodInfo = WalkInfo -> MethodStack ; char * ExternalPath ; switch ( Op -> Asl . ParseOpcode ) { case PARSEOP_METHOD : case PARSEOP_RETURN : if ( ! MethodInfo ) { printf ( "No method info for method! [%s]\n" , Op -> Asl . Namepath ) ; AslError ( ASL_ERROR , ASL_MSG_COMPILER_INTERNAL , Op , "No method info for this method" ) ; CmCleanupAndExit ( ) ; return ( AE_AML_INTERNAL ) ; } break ; default : break ; } switch ( Op -> Asl . ParseOpcode ) { case PARSEOP_METHOD : WalkInfo -> MethodStack = MethodInfo -> Next ; if ( ( ! AnLastStatementIsReturn ( Op ) ) && ( ! ( Op -> Asl . CompileFlags & OP_HAS_NO_EXIT ) ) ) { MethodInfo -> NumReturnNoValue ++ ; } if ( MethodInfo -> NumReturnNoValue && MethodInfo -> NumReturnWithValue ) { ExternalPath = AcpiNsGetNormalizedPathname ( Op -> Asl . Node , TRUE ) ; AslError ( ASL_WARNING , ASL_MSG_RETURN_TYPES , Op , ExternalPath ) ; if ( ExternalPath ) { ACPI_FREE ( ExternalPath ) ; } } if ( MethodInfo -> NumReturnNoValue ) { if ( MethodInfo -> NumReturnWithValue ) { Op -> Asl . CompileFlags |= OP_METHOD_SOME_NO_RETVAL ; } else { Op -> Asl . CompileFlags |= OP_METHOD_NO_RETVAL ; } } if ( ApCheckForPredefinedMethod ( Op , MethodInfo ) ) { ApCheckForGpeNameConflict ( Op ) ; ApCheckRegMethod ( Op ) ; } ACPI_FREE ( MethodInfo , NULL ) ; break ; case PARSEOP_NAME : ApCheckForGpeNameConflict ( Op ) ; break ; case PARSEOP_RETURN : ApCheckPredefinedReturnValue ( Op , MethodInfo ) ; Op -> Asl . Parent -> Asl . CompileFlags |= OP_HAS_NO_EXIT ; Op -> Asl . ParentMethod = MethodInfo -> Op ; if ( Op -> Asl . Next ) { AslError ( ASL_WARNING , ASL_MSG_UNREACHABLE_CODE , Op -> Asl . Next , NULL ) ; } break ; case PARSEOP_IF : if ( ( Op -> Asl . CompileFlags & OP_HAS_NO_EXIT ) && ( Op -> Asl . Next ) && ( Op -> Asl . Next -> Asl . ParseOpcode == PARSEOP_ELSE ) ) { Op -> Asl . Next -> Asl . CompileFlags |= OP_IF_HAS_NO_EXIT ; } break ; case PARSEOP_ELSE : if ( ( Op -> Asl . CompileFlags & OP_HAS_NO_EXIT ) && ( Op -> Asl . CompileFlags & OP_IF_HAS_NO_EXIT ) ) { Op -> Asl . Parent -> Asl . CompileFlags |= OP_HAS_NO_EXIT ; } break ; default : if ( ( Op -> Asl . CompileFlags & OP_HAS_NO_EXIT ) && ( Op -> Asl . Parent ) ) { Op -> Asl . Parent -> Asl . CompileFlags |= OP_HAS_NO_EXIT ; } break ; } return ( AE_OK ) ; } 