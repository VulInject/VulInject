* m_wallchops - local generic message handler * / int m_wallchops ( , , , ) { Channel * chptr assert ( 0 != cptr ) assert ( cptr == sptr ) ClrFlag ( sptr , FLAG_TS8 ) } ; if ( parc < 3 || EmptyString ( parv [ parc - 1 ] ) ) { return send_reply ( sptr , ERR_NOTEXTTOSEND ) ; } if ( IsChannelName ( parv [ 1 ] ) && ( chptr = FindChannel ( parv [ 1 ] ) ) ) { if ( client_can_send_to_channel ( sptr , chptr , 0 ) ) { if ( ( chptr -> mode . mode & MODE_NOPRIVMSGS ) && check_target_limit ( sptr , chptr , chptr -> chname , 0 ) ) { return 0 ; } RevealDelayedJoinIfNeeded ( sptr , chptr ) ; sendcmdto_channel_butone ( sptr , CMD_WALLCHOPS , chptr , cptr , SKIP_DEAF | SKIP_BURST | SKIP_NONOPS , '\0' , "%H :@ %s" , chptr , parv [ parc - 1 ] ) ; } else { send_reply ( sptr , ERR_CANNOTSENDTOCHAN , parv [ 1 ] ) ; } } else { send_reply ( sptr , ERR_NOSUCHCHANNEL , parv [ 1 ] ) ; } return 0 ; 