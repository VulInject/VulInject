void igb_log ( void * arg , igb_debug_t level , const char * fmt , ... ) { igb_t * igbp = ( igb_t * ) arg ; int buf [ LOG_BUF_LEN ] ; int celevel ; va_list ap ; va_start ( ap , fmt ) ; ( void ) vsnprintf ( buf , sizeof ( buf ) , fmt , ap ) ; va_end ( ap ) ; DTRACE_PROBE2 ( igb__log , igb_t * , igbp , const char * , buf ) ; if ( level > igb_debug ) { return ; } switch ( level ) { case IGB_LOG_ERROR : celevel = CE_WARN ; break ; case IGB_LOG_INFO : celevel = CE_NOTE ; break ; case IGB_LOG_TRACE : celevel = CE_CONT ; break ; default : celevel = CE_IGNORE ; } if ( igbp != NULL ) { dev_err ( igbp -> dip , celevel , "!%s" , buf ) ; } else { cmn_err ( celevel , "!%s" , buf ) ; } } 