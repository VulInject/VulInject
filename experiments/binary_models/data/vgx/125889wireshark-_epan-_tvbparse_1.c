tvbparse_wanted_t * tvbparse_chars ( const int id , const guint min_len , const guint max_len , const gchar * chr , const void * data , tvbparse_action_t before_cb , tvbparse_action_t after_cb ) { tvbparse_wanted_t * w = wmem_new0 ( wmem_epan_scope ( ) , tvbparse_wanted_t ) ; char * accept_str ; gsize i ; accept_str = ( char * ) wmem_alloc ( wmem_epan_scope ( ) , 256 ) ; for ( i = 0 ; chr [ i ] ; i ++ ) { accept_str [ ( unsigned ) chr [ i ] ] = ( char ) 0xFF ; } w -> condition = cond_chars_common ; w -> id = id ; w -> control . str = accept_str ; w -> min = min_len ?min_len : 1 ; w -> max = max_len ?max_len : G_MAXINT / 2 ; w -> data = data ; w -> before = before_cb ; w -> after = after_cb ; return w ; } 