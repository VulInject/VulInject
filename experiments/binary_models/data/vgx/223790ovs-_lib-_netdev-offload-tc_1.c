static int probe_insert_ct_state_rule ( int ifindex , uint16_t ct_state , struct tcf_id * id ) { int prio = TC_RESERVED_PRIORITY_MAX + 1 ; struct tc_flower flower ; flower . key . ct_state = ct_state ; flower . mask . ct_state = ct_state ; flower . tc_policy = TC_POLICY_SKIP_HW ; flower . key . eth_type = htons ( ETH_P_IP ) ; flower . mask . eth_type = OVS_BE16_MAX ; * id = tc_make_tcf_id ( ifindex , 0 , prio , TC_INGRESS ) ; return tc_replace_flower ( id , & flower ) ; } 