static int sd_callback ( uintptr_t addr , const void * walk_data , void * flg_silent ) { struct sd_lun sdLun ; int silent = * ( int * ) flg_silent ; if ( SD_DATA_IN_CBACK ( current_list_count ) == 0 ) { mdb_printf ( "walk_addr = %lx\n" , SD_DATA_IN_CBACK ( sd_state ) ) ; mdb_printf ( "walking sd_state units via ptr: %lx\n" , SD_DATA_IN_CBACK ( current_root ) ) ; mdb_printf ( "%d entries in sd_state table\n" , SD_DATA_IN_CBACK ( sd_state_data . n_items ) ) ; } mdb_printf ( "\nun %d: %lx\n" , SD_DATA_IN_CBACK ( current_list_count ) , addr ) ; mdb_printf ( "--------------\n" ) ; if ( addr == 0 ) { print_footer ( walk_data , NULL ) ; return ( SUCCESS ) ; } if ( mdb_vread ( & sdLun , sizeof ( sd_lun ) , ( uintptr_t ) addr ) == sizeof ( sdLun ) ) { if ( ! silent ) { mdb_set_dot ( addr ) ; mdb_eval ( "$<sd_lun" ) ; mdb_printf ( "---\n" ) ; } } else { mdb_warn ( "failed to read softstate at %p" , addr ) ; return ( FAIL ) ; } process_xbuf ( ( uintptr_t ) sdLun . un_xbuf_attr , silent ) ; process_sdlun_waitq ( ( uintptr_t ) sdLun . un_waitq_headp , silent ) ; print_footer ( walk_data ) ; return ( SUCCESS ) ; } 