AvifInfoStatus AvifInfoGetFeaturesStream ( void * stream , read_stream_t read , skip_stream_t skip , AvifInfoFeatures * features ) { if ( features != NULL ) { memset ( features , 0 , sizeof ( * features ) ) ; } AvifInfoInternalStream internal_stream ; internal_stream . stream = stream ; internal_stream . read = read ; internal_stream . skip = skip ; uint32_t num_parsed_boxes = 0 ; AvifInfoInternalFeatures internal_features ; memset ( & internal_features , AVIFINFO_UNDEFINED , sizeof ( internal_features ) ) ; const AvifInfoInternalStatus status = ParseFile ( & internal_stream , & num_parsed_boxes , & internal_features ) ; if ( status == kFound && features != NULL ) { memcpy ( features , & internal_features . primary_item_features , sizeof ( * features ) ) ; } return AvifInfoInternalConvertStatus ( status ) ; } 