static int pkcs1pad_set_pub_key ( struct crypto_akcipher * tfm , const void * key , unsigned int keylen ) { struct pkcs1pad_ctx * ctx = akcipher_tfm_ctx ( tfm ) ; int err ; err = crypto_akcipher_set_pub_key ( ctx -> child , key , keylen ) ; if ( err ) { return err ; } err = crypto_akcipher_maxsize ( ctx -> child ) ; if ( err < 0 ) { return err ; } if ( err > PAGE_SIZE ) { return - ENOTSUPP ; } ctx -> key_size = err ; return 0 ; } 