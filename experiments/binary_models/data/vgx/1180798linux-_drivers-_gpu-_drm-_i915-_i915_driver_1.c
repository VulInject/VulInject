static int i915_driver_mmio_probe ( struct drm_i915_private * dev_priv ) { struct intel_gt * gt ; int ret , i ; if ( i915_inject_probe_failure ( dev_priv ) ) { return - ENODEV ; } ret = intel_gmch_bridge_setup ( dev_priv ) ; if ( ret < 0 ) { return ret ; } for_each_gt ( , , ) { ret = intel_uncore_init_mmio ( gt -> uncore ) ; if ( ret ) { return ret ; } ret = drmm_add_action_or_reset ( & dev_priv -> drm , intel_uncore_fini_mmio , gt -> uncore ) ; if ( ret ) { return ret ; } } intel_gmch_bar_setup ( dev_priv ) ; intel_device_info_runtime_init ( dev_priv , NULL ) ; for_each_gt ( , , ) { ret = intel_gt_init_mmio ( gt ) ; if ( ret ) { err_uncore } } sanitize_gpu ( dev_priv ) ; return 0 ; err_uncore intel_gmch_bar_teardown ( dev_priv ) ; return ret ; } 