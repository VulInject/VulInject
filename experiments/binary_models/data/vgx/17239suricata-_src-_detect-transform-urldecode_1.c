static int DetectTransformUrlDecodeTest02 ( void ) { const char rule [ ] "alert http any any ->any any (http.request_body; url_decode; content:\"mail=test@oisf.net\"; sid:1;)" ; ; ThreadVars th_v ; DetectEngineThreadCtx * det_ctx = NULL ; DetectEngineCtx * de_ctx = DetectEngineCtxInit ( ) ; FAIL_IF_NULL ( de_ctx ) ; Signature * s = DetectEngineAppendSig ( de_ctx , rule ) ; FAIL_IF_NULL ( s ) ; SigGroupBuild ( de_ctx ) ; DetectEngineThreadCtxInit ( & th_v , ( void * ) de_ctx , ( void * ) & det_ctx ) ; DetectEngineThreadCtxDeinit ( & th_v , ( void * ) det_ctx ) ; DetectEngineCtxFree ( de_ctx ) ; PASS ; } 