static int rtq6752_set_vdd_disable ( struct regulator_dev * rdev ) { struct rtq6752_priv * priv = rdev_get_drvdata ( rdev ) ; int rid = rdev_get_id ( rdev ) , ret ; ret = regulator_disable_regmap ( rdev ) ; mutex_lock ( & priv -> lock ) ; priv -> enable_flag &= ~ BIT ( rid ) ; if ( ! priv -> enable_flag ) { regcache_cache_only ( priv -> regmap , true ) ; regcache_mark_dirty ( priv -> regmap ) ; if ( priv -> enable_gpio ) { gpiod_set_value ( priv -> enable_gpio , 0 ) ; } } mutex_unlock ( & priv -> lock ) ; return 0 ; } 