int ata_tport_add ( struct device * parent , struct ata_port * ap ) { int error ; struct device * dev = & ap -> tdev ; device_initialize ( dev ) ; dev -> type = & ata_port_type ; dev -> parent = parent ; ata_host_get ( ap -> host ) ; dev -> release = ata_tport_release ; dev_set_name ( dev , "ata%d" , ap -> print_id ) ; transport_setup_device ( dev ) ; ata_acpi_bind_port ( ap ) ; error = device_add ( dev ) ; if ( error ) { tport_err } device_enable_async_suspend ( dev ) ; pm_runtime_set_active ( dev ) ; pm_runtime_enable ( dev ) ; pm_runtime_forbid ( dev ) ; error = transport_add_device ( dev ) ; if ( error ) { tport_transport_add_err } transport_configure_device ( dev ) ; error = ata_tlink_add ( & ap -> link ) ; if ( error ) { tport_link_err } return 0 ; tport_link_err transport_remove_device ( dev ) ; tport_transport_add_err device_del ( dev ) ; tport_err transport_destroy_device ( dev ) ; put_device ( dev , NULL ) ; return error ; } 