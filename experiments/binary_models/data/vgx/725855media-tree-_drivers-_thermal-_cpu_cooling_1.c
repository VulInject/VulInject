void cpufreq_cooling_unregister ( struct thermal_cooling_device * cdev ) { struct cpufreq_cooling_device * cpufreq_dev ; bool last ; if ( ! cdev ) { return ; } cpufreq_dev = cdev -> devdata ; mutex_lock ( & cooling_list_lock ) ; list_del ( & cpufreq_dev -> node ) ; last = list_empty ( & cpufreq_dev_list ) ; mutex_unlock ( & cooling_list_lock ) ; if ( last ) { cpufreq_unregister_notifier ( & thermal_cpufreq_notifier_block , CPUFREQ_POLICY_NOTIFIER ) ; } thermal_cooling_device_unregister ( cpufreq_dev -> cool_dev , NULL ) ; ida_simple_remove ( & cpufreq_ida , cpufreq_dev -> id ) ; kfree ( cpufreq_dev -> dyn_power_table ) ; kfree ( cpufreq_dev -> time_in_idle_timestamp ) ; kfree ( cpufreq_dev -> time_in_idle ) ; kfree ( cpufreq_dev -> freq_table ) ; kfree ( cpufreq_dev ) ; } 