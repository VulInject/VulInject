static bool record_context ( struct i915_gem_context_coredump * e , struct intel_context * ce ) { struct i915_gem_context * ctx ; struct task_struct * task ; bool simulated ; rcu_read_lock ( ) ; ctx = rcu_dereference ( ce -> gem_context ) ; if ( ctx && ! kref_get_unless_zero ( & ctx -> ref ) ) { ctx = NULL ; } rcu_read_unlock ( ) ; if ( ! ctx ) { return true ; } rcu_read_lock ( ) ; task = pid_task ( ctx -> pid , PIDTYPE_PID ) ; if ( task ) { strcpy ( e -> comm , task -> comm ) ; e -> pid = task -> pid ; } rcu_read_unlock ( ) ; e -> sched_attr = ctx -> sched ; e -> guilty = atomic_read ( & ctx -> guilty_count ) ; e -> active = atomic_read ( & ctx -> active_count ) ; e -> total_runtime = intel_context_get_total_runtime_ns ( ce , NULL ) ; e -> avg_runtime = intel_context_get_avg_runtime_ns ( ce ) ; simulated = i915_gem_context_no_error_capture ( ctx ) ; i915_gem_context_put ( ctx ) ; return simulated ; } intel_engine_capture_vma { struct intel_engine_capture_vma * next ; struct i915_vma_resource * vma_res ; char name [ 16 ] ; bool lockdep_cookie ; } 