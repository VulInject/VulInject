static volatile uint32_t * mRandData = ( uint32_t * ) 0x40045050 ; static uint32_t mRandInit = 0 ; static uint32_t mRandIndex = 0 ; uint32_t rand_gen ( void ) { int rand = 0 ; uint32_t status = LPC_OK ; if ( mRandIndex == 0 ) { if ( mRandInit == 0 ) { Chip_OTP_Init ( ) ; mRandInit = 1 ; } status = Chip_OTP_GenRand ( ) ; } if ( status == LPC_OK ) { rand = mRandData [ mRandIndex ] ; } else { printf ( "GenRand Failed 0x%x\n" , status ) ; } if ( ++ mRandIndex > 4 ) { mRandIndex = 0 ; } return rand ; } 