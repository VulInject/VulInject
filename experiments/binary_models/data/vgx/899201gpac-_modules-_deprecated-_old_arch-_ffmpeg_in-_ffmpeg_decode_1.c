void * FFDEC_Load ( ) { GF_MediaDecoder * ptr ; FFDec * priv ; GF_SAFEALLOC ( ptr , GF_MediaDecoder ) ; if ( ! ptr ) { return NULL ; } GF_SAFEALLOC ( priv , FFDec ) ; if ( ! priv ) { return NULL ; } ptr -> privateStack = priv ; GF_LOG ( GF_LOG_INFO , GF_LOG_CONTAINER , ( "[FFMPEG Decoder] Registering all ffmpeg codecs...\n" ) ) ; avcodec_init ( ) ; avcodec_register_all ( ) ; GF_LOG ( GF_LOG_DEBUG , GF_LOG_CONTAINER , ( "[FFMPEG Decoder] Done registering all ffmpeg codecs.\n" ) ) ; ptr -> AttachStream = FFDEC_AttachStream ; ptr -> DetachStream = FFDEC_DetachStream ; ptr -> GetCapabilities = FFDEC_GetCapabilities ; ptr -> SetCapabilities = FFDEC_SetCapabilities ; ptr -> CanHandleStream = FFDEC_CanHandleStream ; ptr -> GetName = FFDEC_GetCodecName ; ptr -> ProcessData = FFDEC_ProcessData ; ptr -> GetOutputBuffer = FFDEC_GetOutputBuffer ; ptr -> GetOutputFrame = FFDEC_GetOutputFrame ; GF_REGISTER_MODULE_INTERFACE ( ptr , GF_MEDIA_DECODER_INTERFACE , "FFMPEG decoder" , "gpac distribution" ) ; return ( GF_BaseInterface * ) ptr ; } 