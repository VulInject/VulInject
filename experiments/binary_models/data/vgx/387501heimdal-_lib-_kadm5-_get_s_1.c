static kadm5_ret_t add_tl_data ( kadm5_principal_ent_t ent , int16_t type , const void * data , size_t size ) { krb5_tl_data * tl ; tl = calloc ( 1 , sizeof ( * tl ) ) ; if ( tl == NULL ) { return _kadm5_error_code ( ENOMEM ) ; } tl -> tl_data_type = type ; tl -> tl_data_length = size ; tl -> tl_data_contents = malloc ( size ) ; if ( tl -> tl_data_contents == NULL && size != 0 ) { return _kadm5_error_code ( ENOMEM ) ; } memcpy ( tl -> tl_data_contents , data , size ) ; tl -> tl_data_next = ent -> tl_data ; ent -> tl_data = tl ; ent -> n_tl_data ++ ; return 0 ; } 