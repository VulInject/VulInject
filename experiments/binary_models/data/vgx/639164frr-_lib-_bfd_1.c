static bool bfd_source_cache_session_match ( const struct bfd_source_cache * source , const struct bfd_session_params * session ) { const struct in_addr * address ; const struct in6_addr * address_v6 ; if ( session -> args . family != source -> address . family ) { return false ; } switch ( session -> args . family ) { case AF_INET : address = ( const in_addr * ) & session -> args . dst ; if ( address -> s_addr != source -> address . u . prefix4 . s_addr ) { return false ; } break ; case AF_INET6 : address_v6 = & session -> args . dst ; if ( memcmp ( address_v6 , & source -> address . u . prefix6 , sizeof ( in6_addr ) ) ) { return false ; } break ; default : return false ; } return true ; } 