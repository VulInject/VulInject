static int idt_smb_read_word ( struct idt_89hpesx_dev * pdev , struct idt_smb_seq * seq ) { s32 sts ; u8 ccode ; int idx , evencnt ; evencnt = seq -> bytecnt - ( seq -> bytecnt % 2 ) ; for ( idx = 0 ; idx < evencnt ; idx += 2 ) { ccode = seq -> ccode | CCODE_WORD ; if ( idx == 0 ) { ccode |= CCODE_START ; } if ( idx == evencnt - 2 ) { ccode |= CCODE_END ; } sts = idt_smb_safe ( read_word , pdev -> client , ccode ) ; * ( u16 * ) & seq -> data [ idx ] = ( u16 ) sts ; } if ( seq -> bytecnt != evencnt ) { ccode = seq -> ccode | CCODE_BYTE | CCODE_END ; if ( idx == 0 ) { ccode |= CCODE_START ; } sts = idt_smb_safe ( read_byte , pdev -> client , ccode ) ; if ( sts < 0 ) { return ( int ) sts ; } seq -> data [ idx ] = ( u8 ) sts ; } return 0 ; } 