static char * file_full_path ( LHAFileHeader * header , LHAOptions * options ) { int len ; char * result ; char * p ; len = 0 ; if ( options -> extract_path != NULL ) { len += strlen ( options -> extract_path ) + 1 ; } if ( options -> use_path && header -> path != NULL ) { len += strlen ( header -> path ) ; } if ( header -> filename != NULL ) { len += strlen ( header -> filename ) ; } result = malloc ( len + 1 ) ; if ( result == NULL ) { exit ( - 1 ) ; } result [ 0 ] = '\0' ; if ( options -> extract_path != NULL ) { strcat ( result , options -> extract_path ) ; strcat ( result , "/" ) ; } if ( options -> use_path && header -> path != NULL ) { p = header -> path ; while ( * p == '/' ) { ++ p ; } strcat ( result , p ) ; } if ( header -> filename != NULL ) { p = header -> filename ; while ( * p == '/' ) { ++ p ; } strcat ( result , p ) ; } return result ; } 