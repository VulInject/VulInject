struct ias_object * irias_new_object ( char * name , int id ) { struct ias_object * obj ; obj = kzalloc ( sizeof ( ias_object ) , GFP_ATOMIC ) ; if ( obj == NULL ) { net_warn_ratelimited ( "%s(), Unable to allocate object!\n" , __func__ ) ; return NULL ; } obj -> magic = IAS_OBJECT_MAGIC ; obj -> name = kstrndup ( name , IAS_MAX_CLASSNAME , GFP_ATOMIC ) ; if ( ! obj -> name ) { net_warn_ratelimited ( "%s(), Unable to allocate name!\n" , __func__ ) ; return NULL ; } obj -> id = id ; obj -> attribs = hashbin_new ( HB_LOCK ) ; if ( obj -> attribs == NULL ) { net_warn_ratelimited ( "%s(), Unable to allocate attribs!\n" , __func__ ) ; kfree ( obj -> name ) ; kfree ( obj ) ; return NULL ; } return obj ; } 