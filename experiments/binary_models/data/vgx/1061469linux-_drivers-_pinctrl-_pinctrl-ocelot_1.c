static int ocelot_hw_get_value ( struct ocelot_pinctrl * info , unsigned int pin , unsigned int reg , int * val ) { int ret = - EOPNOTSUPP ; if ( info -> pincfg ) { const struct ocelot_pincfg_data * opd = info -> pincfg_data ; u32 regcfg ; ret = regmap_read ( info -> pincfg , pin * regmap_get_reg_stride ( info -> pincfg ) , & regcfg ) ; ret = 0 ; switch ( reg ) { case PINCONF_BIAS : * val = regcfg & ( opd -> pd_bit | opd -> pu_bit ) ; break ; case PINCONF_SCHMITT : * val = regcfg & opd -> schmitt_bit ; break ; case PINCONF_DRIVE_STRENGTH : * val = regcfg & opd -> drive_bits ; break ; default : ret = - EOPNOTSUPP ; break ; } } return ret ; } 