static int dax_hmem_probe ( struct platform_device * pdev ) { unsigned long flags = IORESOURCE_DAX_KMEM ; struct device * dev = & pdev -> dev ; struct dax_region * dax_region ; struct memregion_info * mri ; struct dev_dax_data data ; struct dev_dax * dev_dax ; if ( region_idle ) { flags = 0 ; } mri = dev -> platform_data ; dax_region = alloc_dax_region ( dev , pdev -> id , & mri -> range , mri -> target_node , PMD_SIZE , flags ) ; data = ( dev_dax_data ) { . dax_region = dax_region . id = - 1 . size = region_idle ? 0 : range_len ( & mri -> range ) } ; dev_dax = devm_create_dev_dax ( & data ) ; if ( IS_ERR ( dev_dax ) ) { return PTR_ERR ( dev_dax ) ; } dax_region_put ( dax_region ) ; return 0 ; } 