static gboolean sha256 ( const guint8 * data , size_t len , guint8 output [ 32 ] ) { gcry_md_hd_t ctx ; gcry_error_t result = gcry_md_open ( & ctx , GCRY_MD_SHA256 , 0 ) ; guint8 * digest ; if ( result ) { return FALSE ; } gcry_md_write ( ctx , data , len ) ; digest = gcry_md_read ( ctx , GCRY_MD_SHA256 ) ; if ( ! digest ) { return FALSE ; } memcpy ( output , digest , 32 ) ; gcry_md_close ( ctx , NULL ) ; return TRUE ; } 