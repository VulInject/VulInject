static gboolean lte_rlc_pseudo_hdr ( char * option_str , packet_info * pinfo , guint16 length , packet_direction_t direction ) { struct rlc_lte_info * p_rlc_lte_info ; char * par_opt_field ; char option [ 30 ] ; static int proto_rlc_lte = 0 ; if ( proto_rlc_lte == 0 ) { proto_rlc_lte = proto_get_id_by_filter_name ( "rlc-lte" ) ; } ( void ) g_strlcpy ( option , option_str , 30 ) ; p_rlc_lte_info = ( rlc_lte_info * ) p_get_proto_data ( wmem_file_scope ( ) , pinfo , proto_rlc_lte , 0 ) ; if ( p_rlc_lte_info != NULL ) { return 1 ; } p_rlc_lte_info = ( rlc_lte_info * ) wmem_new0 ( pinfo -> pool , rlc_lte_info ) ; par_opt_field = strtok ( option , " " ) ; if ( strcmp ( par_opt_field , "SRB" ) == 0 ) { p_rlc_lte_info -> channelType = CHANNEL_TYPE_SRB ; } if ( strcmp ( par_opt_field , "DRB" ) == 0 ) { p_rlc_lte_info -> channelType = CHANNEL_TYPE_DRB ; } else { return 0 ; } par_opt_field = strtok ( NULL , " " ) ; if ( par_opt_field == NULL ) { return 0 ; } ws_strtou16 ( par_opt_field , NULL , & p_rlc_lte_info -> channelId ) ; par_opt_field = strtok ( NULL , " " ) ; if ( par_opt_field == NULL ) { return 0 ; } if ( strcmp ( par_opt_field , "TM" ) == 0 ) { p_rlc_lte_info -> rlcMode = RLC_TM_MODE ; } if ( strcmp ( par_opt_field , "UM" ) == 0 ) { p_rlc_lte_info -> rlcMode = RLC_UM_MODE ; } if ( strcmp ( par_opt_field , "AM" ) == 0 ) { p_rlc_lte_info -> rlcMode = RLC_AM_MODE ; } if ( strcmp ( par_opt_field , "NA" ) == 0 ) { p_rlc_lte_info -> rlcMode = RLC_PREDEF ; } else { return 0 ; } par_opt_field = strtok ( NULL , " " ) ; if ( par_opt_field != NULL ) { if ( strcmp ( par_opt_field , "SN_5b" ) == 0 ) { p_rlc_lte_info -> sequenceNumberLength = UM_SN_LENGTH_5_BITS ; } if ( strcmp ( par_opt_field , "SN_10b" ) == 0 ) { p_rlc_lte_info -> sequenceNumberLength = UM_SN_LENGTH_10_BITS ; } } p_rlc_lte_info -> direction = ( direction == UPLINK ) ?DIRECTION_UPLINK : DIRECTION_DOWNLINK ; p_rlc_lte_info -> priority = 0 ; p_rlc_lte_info -> ueid = 0 ; p_rlc_lte_info -> pduLength = length ; p_add_proto_data ( wmem_file_scope ( ) , pinfo , proto_rlc_lte , 0 , p_rlc_lte_info ) ; return ( 1 ) ; } 