selfautoloc_prog ( ) { char * ret ; char * p , * q , * r ; char * selfautoloc = kpse_var_value ( "SELFAUTOLOC" ) ; for ( p = selfautoloc ; * p ; p ++ ) { if ( * p == '/' ) { * p = '\\' ; } } q = xstrdup ( prog , NULL ) ; r = q ; while ( * r && * r != ' ' && * r != '\t' ) { r ++ ; } if ( * r == '\0' ) { ret = concatn ( "\"" , selfautoloc , "\\" , q , "\"" , NULL ) ; } else { * r = '\0' ; r ++ ; if ( * r ) { ret = concatn ( "\"" , selfautoloc , "\\" , q , "\" " , r , NULL ) ; } else { ret = concatn ( "\"" , selfautoloc , "\\" , q , "\"" , NULL ) ; } } free ( q ) ; free ( selfautoloc ) ; ret = xstrdup ( prog ) ; return ret ; } 