void ipsecctl_free_rule ( struct ipsec_rule * rp ) { if ( rp -> src ) { free ( rp -> src -> name ) ; free ( rp -> src ) ; } if ( rp -> dst ) { free ( rp -> dst -> name ) ; } if ( rp -> dst2 ) { free ( rp -> dst2 -> name ) ; free ( rp -> dst2 ) ; } if ( rp -> local ) { free ( rp -> local -> name ) ; free ( rp -> local ) ; } if ( rp -> peer ) { free ( rp -> peer -> name ) ; free ( rp -> peer ) ; } if ( rp -> auth ) { free ( rp -> auth -> srcid ) ; free ( rp -> auth -> dstid ) ; free ( rp -> auth ) ; } if ( rp -> ikeauth ) { free ( rp -> ikeauth -> string ) ; free ( rp -> ikeauth ) ; } free ( rp -> xfs ) ; free ( rp -> p1xfs ) ; free ( rp -> p2xfs ) ; free ( rp -> p1life ) ; free ( rp -> p2life ) ; if ( rp -> authkey ) { free ( rp -> authkey -> data ) ; free ( rp -> authkey ) ; } if ( rp -> enckey ) { free ( rp -> enckey -> data ) ; free ( rp -> enckey ) ; } free ( rp -> p1name ) ; free ( rp -> p2name ) ; free ( rp -> p2lid ) ; free ( rp -> p2nid ) ; free ( rp -> p2rid ) ; free ( rp ) ; } 