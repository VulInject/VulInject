static kv_status_t iser_handle_numerical ( nvpair_t * nvp , uint64_t value , const idm_kv_xlate_t * ikvx , uint64_t min_value , uint64_t max_value , uint64_t iser_max_value , nvlist_t * request_nvl , nvlist_t * response_nvl , nvlist_t * negotiated_nvl ) { kv_status_t kvrc = KV_UNHANDLED ; int nvrc ; boolean_t respond = B_FALSE ; if ( ( value < min_value ) || ( value > max_value ) ) { kvrc = KV_VALUE_ERROR ; } else { if ( value > iser_max_value ) { value = iser_max_value ; nvrc = nvlist_add_uint64 ( negotiated_nvl , ikvx -> ik_key_name , value ) ; if ( nvrc == 0 ) { kvrc = KV_HANDLED_NO_TRANSIT ; respond = B_TRUE ; } } else { nvrc = nvlist_add_nvpair ( negotiated_nvl , nvp ) ; respond = ( ikvx -> ik_declarative == B_FALSE ) ; } if ( nvrc == 0 && respond ) { nvrc = nvlist_add_uint64 ( response_nvl , ikvx -> ik_key_name , value ) ; ( void ) nvlist_remove_all ( request_nvl , ikvx -> ik_key_name ) ; } } return ( idm_nvstat_to_kvstat ( nvrc ) ) ; } 