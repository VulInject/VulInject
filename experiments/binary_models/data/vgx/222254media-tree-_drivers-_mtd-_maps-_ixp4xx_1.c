static void ixp4xx_write16 ( struct map_info * map , map_word d , unsigned long adr ) { flash_write16 ( d . x [ 0 ] , map -> virt + adr ) ; } ixp4xx_flash_info { struct mtd_info * mtd ; struct map_info map ; struct resource * res ; } static const char * const probes [ ] { "RedBoot" "cmdlinepart" NULL } ; ; static int ixp4xx_flash_remove ( struct platform_device * dev ) { struct flash_platform_data * plat = dev_get_platdata ( & dev -> dev ) ; struct ixp4xx_flash_info * info = platform_get_drvdata ( dev ) ; if ( info -> mtd ) { mtd_device_unregister ( info -> mtd ) ; map_destroy ( info -> mtd ) ; } if ( plat -> exit ) { plat -> exit ( ) ; } return 0 ; } 