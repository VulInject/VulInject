int EC_GROUP_set_generator ( EC_GROUP * group , const EC_POINT * generator , const BIGNUM * order , const BIGNUM * cofactor ) { if ( generator == NULL ) { ECerror ( ERR_R_PASSED_NULL_PARAMETER ) ; return 0 ; } if ( BN_is_zero ( & group -> field ) || BN_is_negative ( & group -> field ) ) { ECerror ( EC_R_INVALID_FIELD ) ; return 0 ; } if ( order == NULL || BN_cmp ( order , BN_value_one ( ) ) <= 0 || BN_num_bits ( order ) > BN_num_bits ( & group -> field ) + 1 ) { ECerror ( EC_R_INVALID_GROUP_ORDER , NULL ) ; return 0 ; } if ( cofactor != NULL && BN_is_negative ( cofactor ) ) { ECerror ( EC_R_UNKNOWN_COFACTOR ) ; return 0 ; } if ( group -> generator == NULL ) { group -> generator = EC_POINT_new ( group ) ; if ( group -> generator == NULL ) { return 0 ; } } if ( ! EC_POINT_copy ( group -> generator , generator ) ) { return 0 ; } if ( ! BN_copy ( & group -> order , order ) ) { return 0 ; } if ( cofactor != NULL && ! BN_is_zero ( cofactor ) ) { if ( ! BN_copy ( & group -> cofactor , cofactor ) ) { return 0 ; } } if ( ! ec_guess_cofactor ( group ) ) { return 0 ; } if ( BN_num_bits ( & group -> cofactor ) > BN_num_bits ( & group -> field ) + 1 ) { ECerror ( EC_R_INVALID_GROUP_ORDER ) ; return 0 ; } return 1 ; } 