static void qlcnic_dcb_get_pg_tc_cfg_tx ( struct net_device * netdev , int tc , u8 * prio , u8 * pgid , u8 * bw_per , u8 * up_tc_map ) { struct qlcnic_adapter * adapter = netdev_priv ( netdev ) ; struct qlcnic_dcb_tc_cfg * tc_cfg , * temp ; struct qlcnic_dcb_cee * type ; u8 i , cnt , pg ; type = & adapter -> dcb -> cfg -> type [ QLC_DCB_OPER_IDX ] ; * prio = * pgid = * bw_per = * up_tc_map = 0 ; if ( ! test_bit ( QLCNIC_DCB_STATE , & adapter -> dcb -> state ) || ! type -> tc_param_valid ) { return ; } if ( tc < 0 || ( tc >= QLC_DCB_MAX_TC ) ) { return ; } tc_cfg = & type -> tc_cfg [ tc ] ; * pgid = tc_cfg -> pgid ; * prio = tc_cfg -> prio_type ; * up_tc_map = tc_cfg -> up_tc_map ; pg = * pgid ; for ( i = 0 , cnt = 0 ; i < QLC_DCB_MAX_TC ; i ++ ) { temp = & type -> tc_cfg [ i ] ; if ( temp -> valid && ( pg == temp -> pgid ) ) { cnt ++ ; } } tc_cfg -> bwg_percent = ( 100 / cnt ) ; * bw_per = tc_cfg -> bwg_percent ; } 