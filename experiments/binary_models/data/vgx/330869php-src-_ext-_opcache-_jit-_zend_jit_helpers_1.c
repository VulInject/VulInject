static void ZEND_FASTCALL zend_jit_fetch_dim_str_is_helper ( zend_string * str , zval * dim , zval * result ) { zend_long offset ; try_string_offset if ( UNEXPECTED ( Z_TYPE_P ( dim ) != IS_LONG ) ) { switch ( Z_TYPE_P ( dim ) ) { case IS_STRING : if ( IS_LONG == is_numeric_string ( Z_STRVAL_P ( dim ) , Z_STRLEN_P ( dim ) , NULL , NULL , false ) ) { break ; } ZVAL_NULL ( result , NULL ) ; return ; case IS_UNDEF : zend_jit_undefined_op_helper ( EG ( current_execute_data ) -> opline -> op2 . var ) ; case IS_DOUBLE : case IS_NULL : case IS_FALSE : case IS_TRUE : break ; case IS_REFERENCE : dim = Z_REFVAL_P ( dim ) ; try_string_offset default : zend_jit_illegal_string_offset ( dim ) ; break ; } offset = zval_get_long_func ( dim , false ) ; } else { offset = Z_LVAL_P ( dim ) ; } if ( ( zend_ulong ) offset >= ( zend_ulong ) ZSTR_LEN ( str ) ) { if ( offset < 0 ) { zend_long real_offset = ( zend_long ) ZSTR_LEN ( str ) + offset ; if ( real_offset >= 0 ) { ZVAL_CHAR ( result , ( uint8_t ) ZSTR_VAL ( str ) [ real_offset ] ) ; return ; } } ZVAL_NULL ( result ) ; } else { ZVAL_CHAR ( result , ( uint8_t ) ZSTR_VAL ( str ) [ offset ] ) ; } } 