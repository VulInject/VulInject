static int keystone_platform_notifier ( struct notifier_block * nb , unsigned long event , void * data ) { struct device * dev = data ; if ( ! dev ) { return NOTIFY_BAD ; } if ( ! dev -> of_node ) { int ret = dma_direct_set_offset ( dev , KEYSTONE_HIGH_PHYS_START , KEYSTONE_LOW_PHYS_START , KEYSTONE_HIGH_PHYS_SIZE ) ; dev_err ( dev , "set dma_offset%08llx%s\n" , KEYSTONE_HIGH_PHYS_START - KEYSTONE_LOW_PHYS_START , ret ?" failed" : "" ) ; } return NOTIFY_OK ; } 