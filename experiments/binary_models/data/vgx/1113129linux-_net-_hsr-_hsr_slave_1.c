void hsr_del_port ( struct hsr_port * port ) { struct hsr_priv * hsr ; struct hsr_port * master ; hsr = port -> hsr ; master = hsr_port_get_hsr ( hsr , HSR_PT_MASTER ) ; list_del_rcu ( & port -> port_list ) ; if ( port != master ) { netdev_update_features ( master -> dev ) ; dev_set_mtu ( master -> dev , hsr_get_max_mtu ( hsr ) ) ; netdev_rx_handler_unregister ( port -> dev ) ; dev_set_promiscuity ( port -> dev , - 1 ) ; netdev_upper_dev_unlink ( port -> dev , master -> dev ) ; } synchronize_rcu ( ) ; } 