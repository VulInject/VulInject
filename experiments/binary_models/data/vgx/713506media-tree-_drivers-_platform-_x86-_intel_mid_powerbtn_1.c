static irqreturn_t mid_pb_isr ( int irq , void * dev_id ) { struct mid_pb_ddata * ddata = dev_id ; struct input_dev * input = ddata -> input ; int value = 0 ; int ret ; ret = mid_pbstat ( ddata , & value ) ; if ( ret < 0 ) { dev_err ( input -> dev . parent , "Read error %d while reading MSIC_PB_STATUS\n" , ret ) ; } else { input_event ( input , EV_KEY , KEY_POWER , value ) ; input_sync ( input ) ; } mid_irq_ack ( ddata , NULL ) ; return IRQ_HANDLED ; } static struct mid_pb_ddata mfld_ddata = { . mirqlvl1_addr = INTEL_MSIC_IRQLVL1MSK . pbstat_addr = INTEL_MSIC_PBSTATUS . pbstat_mask = MSIC_PB_LEVEL } ; 