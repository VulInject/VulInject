int Digest_MD5_Update ( Digest_MD5_CTX * ctx , const uint8_t * input , size_t ilen ) { int ret = - 1 ; size_t fill ; uint32_t left ; left = ctx -> total [ 0 ] & 0x3F ; fill = 64 - left ; ctx -> total [ 0 ] += ( uint32_t ) ilen ; ctx -> total [ 0 ] &= 0xFFFFFFFF ; if ( ctx -> total [ 0 ] < ( uint32_t ) ilen ) { ctx -> total [ 1 ] ++ ; } if ( left && ilen >= fill ) { memcpy ( ( void * ) ( ctx -> buffer + left ) , input , fill ) ; if ( ( ret = Digest_Internal_MD5_Process ( ctx , ctx -> buffer ) ) != 0 ) { return ( ret ) ; } input += fill ; ilen -= fill ; left = 0 ; } while ( ilen >= 64 ) { if ( ( ret = Digest_Internal_MD5_Process ( ctx , input ) ) != 0 ) { return ( ret ) ; } input += 64 ; ilen -= 64 ; } if ( ilen > 0 ) { memcpy ( ( void * ) ( ctx -> buffer + left ) , input , ilen ) ; } return ( 0 ) ; } 