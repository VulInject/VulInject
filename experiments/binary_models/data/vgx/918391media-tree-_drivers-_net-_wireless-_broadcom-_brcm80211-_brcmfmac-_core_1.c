static int brcmf_net_p2p_attach ( struct brcmf_if * ifp ) { struct net_device * ndev ; brcmf_dbg ( TRACE , "Enter, bsscfgidx=%d mac=%pM\n" , ifp -> bsscfgidx , ifp -> mac_addr ) ; ndev = ifp -> ndev ; ndev -> netdev_ops = & brcmf_netdev_ops_p2p ; memcpy ( ndev -> dev_addr , ifp -> mac_addr , ETH_ALEN ) ; if ( register_netdev ( ndev ) != 0 ) { brcmf_err ( "couldn't register the p2p net device\n" ) ; fail } brcmf_dbg ( INFO , "%s: Broadcom Dongle Host Driver\n" , ndev -> name ) ; return 0 ; fail ifp -> drvr -> iflist [ ifp -> bsscfgidx ] = NULL ; ndev -> netdev_ops = NULL ; return - EBADE ; } 