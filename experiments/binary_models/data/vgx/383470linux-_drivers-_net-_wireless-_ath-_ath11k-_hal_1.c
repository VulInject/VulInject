static int ath11k_hal_srng_create_config ( struct ath11k_base * ab ) { struct ath11k_hal * hal = & ab -> hal ; struct hal_srng_config * s ; hal -> srng_config = kmemdup ( hw_srng_config_template , sizeof ( hw_srng_config_template ) , GFP_KERNEL ) ; s = & hal -> srng_config [ HAL_REO_DST ] ; s -> reg_start [ 0 ] = HAL_SEQ_WCSS_UMAC_REO_REG + HAL_REO1_RING_BASE_LSB ( ab ) ; s -> reg_start [ 1 ] = HAL_SEQ_WCSS_UMAC_REO_REG + HAL_REO1_RING_HP ( ab ) ; s -> reg_size [ 0 ] = HAL_REO2_RING_BASE_LSB ( ab ) - HAL_REO1_RING_BASE_LSB ( ab ) ; s -> reg_size [ 1 ] = HAL_REO2_RING_HP ( ab ) - HAL_REO1_RING_HP ( ab ) ; s = & hal -> srng_config [ HAL_REO_EXCEPTION ] ; s -> reg_start [ 0 ] = HAL_SEQ_WCSS_UMAC_REO_REG + HAL_REO_TCL_RING_BASE_LSB ( ab ) ; s -> reg_start [ 1 ] = HAL_SEQ_WCSS_UMAC_REO_REG + HAL_REO_TCL_RING_HP ( ab ) ; s = & hal -> srng_config [ HAL_REO_REINJECT ] ; s -> reg_start [ 0 ] = HAL_SEQ_WCSS_UMAC_REO_REG + HAL_SW2REO_RING_BASE_LSB ( ab ) ; s -> reg_start [ 1 ] = HAL_SEQ_WCSS_UMAC_REO_REG + HAL_SW2REO_RING_HP ( ab ) ; s = & hal -> srng_config [ HAL_REO_CMD ] ; s -> reg_start [ 0 ] = HAL_SEQ_WCSS_UMAC_REO_REG + HAL_REO_CMD_RING_BASE_LSB ( ab ) ; s -> reg_start [ 1 ] = HAL_SEQ_WCSS_UMAC_REO_REG + HAL_REO_CMD_HP ( ab ) ; s = & hal -> srng_config [ HAL_REO_STATUS ] ; s -> reg_start [ 0 ] = HAL_SEQ_WCSS_UMAC_REO_REG + HAL_REO_STATUS_RING_BASE_LSB ( ab ) ; s -> reg_start [ 1 ] = HAL_SEQ_WCSS_UMAC_REO_REG + HAL_REO_STATUS_HP ( ab ) ; s = & hal -> srng_config [ HAL_TCL_DATA ] ; s -> reg_start [ 0 ] = HAL_SEQ_WCSS_UMAC_TCL_REG + HAL_TCL1_RING_BASE_LSB ( ab ) ; s -> reg_start [ 1 ] = HAL_SEQ_WCSS_UMAC_TCL_REG + HAL_TCL1_RING_HP ; s -> reg_size [ 0 ] = HAL_TCL2_RING_BASE_LSB ( ab ) - HAL_TCL1_RING_BASE_LSB ( ab ) ; s -> reg_size [ 1 ] = HAL_TCL2_RING_HP - HAL_TCL1_RING_HP ; s = & hal -> srng_config [ HAL_TCL_CMD ] ; s -> reg_start [ 0 ] = HAL_SEQ_WCSS_UMAC_TCL_REG + HAL_TCL_RING_BASE_LSB ( ab ) ; s -> reg_start [ 1 ] = HAL_SEQ_WCSS_UMAC_TCL_REG + HAL_TCL_RING_HP ; s = & hal -> srng_config [ HAL_TCL_STATUS ] ; s -> reg_start [ 0 ] = HAL_SEQ_WCSS_UMAC_TCL_REG + HAL_TCL_STATUS_RING_BASE_LSB ( ab ) ; s -> reg_start [ 1 ] = HAL_SEQ_WCSS_UMAC_TCL_REG + HAL_TCL_STATUS_RING_HP ; s = & hal -> srng_config [ HAL_CE_SRC ] ; s -> reg_start [ 0 ] = HAL_SEQ_WCSS_UMAC_CE0_SRC_REG ( ab ) + HAL_CE_DST_RING_BASE_LSB + ATH11K_CE_OFFSET ( ab ) ; s -> reg_start [ 1 ] = HAL_SEQ_WCSS_UMAC_CE0_SRC_REG ( ab ) + HAL_CE_DST_RING_HP + ATH11K_CE_OFFSET ( ab ) ; s -> reg_size [ 0 ] = HAL_SEQ_WCSS_UMAC_CE1_SRC_REG ( ab ) - HAL_SEQ_WCSS_UMAC_CE0_SRC_REG ( ab ) ; s -> reg_size [ 1 ] = HAL_SEQ_WCSS_UMAC_CE1_SRC_REG ( ab ) - HAL_SEQ_WCSS_UMAC_CE0_SRC_REG ( ab ) ; s = & hal -> srng_config [ HAL_CE_DST ] ; s -> reg_start [ 0 ] = HAL_SEQ_WCSS_UMAC_CE0_DST_REG ( ab ) + HAL_CE_DST_RING_BASE_LSB + ATH11K_CE_OFFSET ( ab ) ; s -> reg_start [ 1 ] = HAL_SEQ_WCSS_UMAC_CE0_DST_REG ( ab ) + HAL_CE_DST_RING_HP + ATH11K_CE_OFFSET ( ab ) ; s -> reg_size [ 0 ] = HAL_SEQ_WCSS_UMAC_CE1_DST_REG ( ab ) - HAL_SEQ_WCSS_UMAC_CE0_DST_REG ( ab ) ; s -> reg_size [ 1 ] = HAL_SEQ_WCSS_UMAC_CE1_DST_REG ( ab ) - HAL_SEQ_WCSS_UMAC_CE0_DST_REG ( ab ) ; s = & hal -> srng_config [ HAL_CE_DST_STATUS ] ; s -> reg_start [ 0 ] = HAL_SEQ_WCSS_UMAC_CE0_DST_REG ( ab ) + HAL_CE_DST_STATUS_RING_BASE_LSB + ATH11K_CE_OFFSET ( ab ) ; s -> reg_start [ 1 ] = HAL_SEQ_WCSS_UMAC_CE0_DST_REG ( ab ) + HAL_CE_DST_STATUS_RING_HP + ATH11K_CE_OFFSET ( ab ) ; s -> reg_size [ 0 ] = HAL_SEQ_WCSS_UMAC_CE1_DST_REG ( ab ) - HAL_SEQ_WCSS_UMAC_CE0_DST_REG ( ab ) ; s -> reg_size [ 1 ] = HAL_SEQ_WCSS_UMAC_CE1_DST_REG ( ab ) - HAL_SEQ_WCSS_UMAC_CE0_DST_REG ( ab ) ; s = & hal -> srng_config [ HAL_WBM_IDLE_LINK ] ; s -> reg_start [ 0 ] = HAL_SEQ_WCSS_UMAC_WBM_REG + HAL_WBM_IDLE_LINK_RING_BASE_LSB ( ab ) ; s -> reg_start [ 1 ] = HAL_SEQ_WCSS_UMAC_WBM_REG + HAL_WBM_IDLE_LINK_RING_HP ; s = & hal -> srng_config [ HAL_SW2WBM_RELEASE ] ; s -> reg_start [ 0 ] = HAL_SEQ_WCSS_UMAC_WBM_REG + HAL_WBM_RELEASE_RING_BASE_LSB ( ab ) ; s -> reg_start [ 1 ] = HAL_SEQ_WCSS_UMAC_WBM_REG + HAL_WBM_RELEASE_RING_HP ; s = & hal -> srng_config [ HAL_WBM2SW_RELEASE ] ; s -> reg_start [ 0 ] = HAL_SEQ_WCSS_UMAC_WBM_REG + HAL_WBM0_RELEASE_RING_BASE_LSB ( ab ) ; s -> reg_start [ 1 ] = HAL_SEQ_WCSS_UMAC_WBM_REG + HAL_WBM0_RELEASE_RING_HP ; s -> reg_size [ 0 ] = HAL_WBM1_RELEASE_RING_BASE_LSB ( ab ) - HAL_WBM0_RELEASE_RING_BASE_LSB ( ab ) ; s -> reg_size [ 1 ] = HAL_WBM1_RELEASE_RING_HP - HAL_WBM0_RELEASE_RING_HP ; return 0 ; } 