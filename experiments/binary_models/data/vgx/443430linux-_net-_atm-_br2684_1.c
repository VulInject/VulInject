static void __exit br2684_exit ( void ) { struct net_device * net_dev ; struct br2684_dev * brdev ; struct br2684_vcc * brvcc ; deregister_atm_ioctl ( & br2684_ioctl_ops ) ; remove_proc_entry ( "br2684" , atm_proc_root ) ; unregister_atmdevice_notifier ( & atm_dev_notifier ) ; while ( ! list_empty ( & br2684_devs ) ) { net_dev = list_entry_brdev ( br2684_devs . next ) ; brdev = BRPRIV ( net_dev ) ; while ( ! list_empty ( & brdev -> brvccs ) ) { brvcc = list_entry_brvcc ( brdev -> brvccs . next ) ; br2684_close_vcc ( brvcc ) ; } list_del ( & brdev -> br2684_devs ) ; unregister_netdev ( net_dev ) ; } } 