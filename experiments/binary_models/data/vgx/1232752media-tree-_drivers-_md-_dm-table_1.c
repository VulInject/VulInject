static int alloc_targets ( struct dm_table * t , unsigned int num ) { sector_t * n_highs ; struct dm_target * n_targets ; n_highs = ( sector_t * ) dm_vcalloc ( num + 1 , sizeof ( dm_target ) + sizeof ( sector_t ) ) ; if ( ! n_highs ) { return - ENOMEM ; } n_targets = ( dm_target * ) ( n_highs + num ) ; vfree ( t -> highs ) ; t -> num_allocated = num ; t -> highs = n_highs ; t -> targets = n_targets ; return 0 ; } 