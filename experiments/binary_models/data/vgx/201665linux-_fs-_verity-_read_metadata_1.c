static int fsverity_read_descriptor ( struct inode * inode , void __user * buf , u64 offset , int length ) { struct fsverity_descriptor * desc ; size_t desc_size ; int res ; res = fsverity_get_descriptor ( inode , & desc ) ; if ( res ) { return res ; } desc_size = offsetof ( fsverity_descriptor , signature ) ; desc -> sig_size = 0 ; res = fsverity_read_buffer ( buf , offset , length , desc , desc_size ) ; return res ; } 