static krb5_error_code dump_iterator ( void * ptr , krb5_db_entry * entry ) { krb5_error_code ret ; struct dump_args * args = ptr ; char * name ; ret = krb5_unparse_name ( args -> context , entry -> princ , & name ) ; if ( ret ) { com_err ( progname , ret , _ ( "while unparsing principal name" ) ) ; return ret ; } if ( mkey_convert ) { ret = master_key_convert ( args -> context , entry ) ; if ( ret ) { com_err ( progname , ret , _ ( "while converting %s to new master key" ) , name ) ; cleanup } } if ( args -> nnames > 0 && ! name_matches ( name , args ) ) { cleanup } ret = args -> dump -> dump_princ ( args -> context , entry , name , args -> ofile , args -> verbose , args -> omit_nra ) ; cleanup return ret ; } 