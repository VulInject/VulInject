static int lynxfb_ops_cursor ( struct fb_info * info , struct fb_cursor * fbcursor ) { struct lynxfb_par * par ; struct lynxfb_crtc * crtc ; struct lynx_cursor * cursor ; par = info -> par ; crtc = & par -> crtc ; cursor = & crtc -> cursor ; sm750_hw_cursor_disable ( cursor ) ; if ( fbcursor -> set & FB_CUR_SETSIZE ) { sm750_hw_cursor_setSize ( cursor , fbcursor -> image . width , fbcursor -> image . height ) ; } if ( fbcursor -> set & FB_CUR_SETPOS ) { sm750_hw_cursor_setPos ( cursor , fbcursor -> image . dx - info -> var . xoffset , fbcursor -> image . dy - info -> var . yoffset ) ; } if ( fbcursor -> set & FB_CUR_SETCMAP ) { u16 fg , bg ; fg = ( ( info -> cmap . red [ fbcursor -> image . fg_color ] & 0xf800 ) ) | ( ( info -> cmap . green [ fbcursor -> image . fg_color ] & 0xfc00 ) >> 5 ) | ( ( info -> cmap . blue [ fbcursor -> image . fg_color ] & 0xf800 ) >> 11 ) ; bg = ( ( info -> cmap . red [ fbcursor -> image . bg_color ] & 0xf800 ) ) | ( ( info -> cmap . green [ fbcursor -> image . bg_color ] & 0xfc00 ) >> 5 ) | ( ( info -> cmap . blue [ fbcursor -> image . bg_color ] & 0xf800 ) >> 11 ) ; sm750_hw_cursor_setColor ( cursor , fg , bg ) ; } if ( fbcursor -> set & ( FB_CUR_SETSHAPE | FB_CUR_SETIMAGE ) ) { sm750_hw_cursor_setData ( cursor , fbcursor -> rop , fbcursor -> image . data , fbcursor -> mask ) ; } if ( fbcursor -> enable ) { sm750_hw_cursor_enable ( cursor ) ; } return 0 ; } 