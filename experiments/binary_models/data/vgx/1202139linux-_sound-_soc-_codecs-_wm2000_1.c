static int wm2000_speaker_put ( struct snd_kcontrol * kcontrol , struct snd_ctl_elem_value * ucontrol ) { struct snd_soc_component * component = snd_soc_kcontrol_component ( kcontrol ) ; struct wm2000_priv * wm2000 = dev_get_drvdata ( component -> dev ) ; unsigned int val = ucontrol -> value . integer . value [ 0 ] ; int ret ; mutex_lock ( & wm2000 -> lock ) ; wm2000 -> spk_ena = val ; ret = wm2000_anc_set_mode ( wm2000 ) ; mutex_unlock ( & wm2000 -> lock ) ; return ret ; } 