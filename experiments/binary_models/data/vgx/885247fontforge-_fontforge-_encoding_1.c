SplineFontFree ( cidmaster ) ; return ( NULL ) ; -> cidregistry = copy ( map -> registry ) ; cidmaster -> ordering = copy ( map -> ordering ) ; cidmaster -> supplement = map -> supplement ; SFEncodeToMap ( sf , map ) ; ( sf -> uni_interp != ui_none && sf -> uni_interp != ui_unset ) cidmaster -> uni_interp = sf -> uni_interp ; if ( strstrmatch ( cidmaster -> ordering , "japan" ) != NULL ) { cidmaster -> uni_interp = ui_japanese ; } if ( strstrmatch ( cidmaster -> ordering , "CNS" ) != NULL ) { cidmaster -> uni_interp = ui_trad_chinese ; } if ( strstrmatch ( cidmaster -> ordering , "GB" ) != NULL ) { cidmaster -> uni_interp = ui_simp_chinese ; } if ( strstrmatch ( cidmaster -> ordering , "Korea" ) != NULL ) { cidmaster -> uni_interp = ui_korean ; } sf -> uni_interp = cidmaster -> uni_interp ; cidmaster -> fontname = copy ( sf -> fontname ) ; cidmaster -> fullname = copy ( sf -> fullname ) ; cidmaster -> familyname = copy ( sf -> familyname ) ; cidmaster -> weight = copy ( sf -> weight ) ; cidmaster -> copyright = copy ( sf -> copyright ) ; cidmaster -> cidversion = 1.0 ; cidmaster -> display_antialias = sf -> display_antialias ; cidmaster -> display_size = sf -> display_size ; cidmaster -> ascent = sf -> ascent ; cidmaster -> descent = sf -> descent ; cidmaster -> changed = cidmaster -> changed_since_autosave = true ; for ( fvs = sf -> fv ; fvs != NULL ; fvs = fvs -> nextsame ) { fvs -> cidmaster = cidmaster ; } cidmaster -> fv = sf -> fv ; sf -> cidmaster = cidmaster ; cidmaster -> subfontcnt = 1 ; cidmaster -> subfonts = calloc ( 2 , sizeof ( SplineFont * ) ) ; cidmaster -> subfonts [ 0 ] = sf ; cidmaster -> gpos_lookups = sf -> gpos_lookups ; sf -> gpos_lookups = NULL ; cidmaster -> gsub_lookups = sf -> gsub_lookups ; sf -> gsub_lookups = NULL ; cidmaster -> horiz_base = sf -> horiz_base ; sf -> horiz_base = NULL ; cidmaster -> vert_base = sf -> vert_base ; sf -> vert_base = NULL ; cidmaster -> possub = sf -> possub ; sf -> possub = NULL ; cidmaster -> kerns = sf -> kerns ; sf -> kerns = NULL ; cidmaster -> vkerns = sf -> vkerns ; sf -> vkerns = NULL ; if ( sf -> private == NULL ) { sf -> private = calloc ( 1 , sizeof ( psdict ) ) ; } if ( ! PSDictHasEntry ( sf -> private , "lenIV" ) ) { PSDictChangeEntry ( sf -> private , "lenIV" , "1" ) ; } for ( fvs = sf -> fv ; fvs != NULL ; fvs = fvs -> nextsame ) { fvs -> selected = calloc ( fvs -> sf -> glyphcnt , sizeof ( uint8_t ) ) ; EncMapFree ( fvs -> map ) ; fvs -> map = EncMap1to1 ( fvs -> sf -> glyphcnt ) ; FVSetTitle ( fvs ) ; } CIDMasterAsDes ( sf ) ; FontViewReformatAll ( sf ) ; return ( cidmaster ) ; 