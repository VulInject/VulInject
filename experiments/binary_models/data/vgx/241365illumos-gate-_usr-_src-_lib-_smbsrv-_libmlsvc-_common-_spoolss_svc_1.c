static int FUN1 ( void * VAR1 , VAR2 * VAR3 ) { static spoolss_winreg_t VAR4 [ ] { { "" 0x0050acf2 } { "" 0x00000000 } { "" 0x00000000 } { "" 0x0000001f } { "" 0x00000000 } { "" 0x00000000 } { "" 0x00000003 } { "" 0x00000000 } { "" 0x00000000 } } ; ; struct VAR5 * VAR6 = VAR1 ; char * VAR7 = ( char * ) VAR6 -> VAR8 ; char VAR9 [ VAR10 ] ; static uint8_t VAR11 [ 4 ] ; VAR12 * VAR13 ; smb_share_t VAR14 ; VAR15 * VAR16 ; struct utsname VAR17 ; VAR18 * VAR19 ; uint32_t VAR20 ; uint32_t VAR21 ; int wcslen ; int VAR22 ; if ( VAR7 == NULL || * VAR7 == '' ) { VAR21 = VAR23 ; VAR24 } for ( VAR22 = 0 ; VAR22 < sizeof ( VAR4 ) / sizeof ( VAR4 [ 0 ] ) ; ++ VAR22 ) { VAR6 -> VAR25 = VAR26 ; VAR6 -> VAR27 = sizeof ( VAR28 ) ; VAR13 = & VAR4 [ VAR22 ] ; if ( FUN2 ( VAR7 , VAR13 -> VAR7 ) != 0 ) { continue ; } if ( VAR6 -> VAR29 < sizeof ( VAR28 ) ) { VAR6 -> VAR29 = 0 ; VAR30 } if ( ( VAR6 -> VAR31 = FUN3 ( VAR3 , VAR28 ) ) == NULL ) { VAR21 = VAR32 ; VAR24 } VAR20 = VAR13 -> VAR20 ; if ( ( FUN2 ( VAR7 , "" ) == 0 ) && ( FUN4 ( ) == VAR33 ) ) { VAR20 = 0x00000001 ; } bcopy ( & VAR20 , VAR6 -> VAR31 , sizeof ( VAR28 ) ) ; VAR6 -> VAR29 = sizeof ( VAR28 ) ; VAR6 -> VAR21 = VAR34 ; return ( VAR35 ) ; } if ( FUN2 ( VAR7 , "" ) == 0 ) { VAR6 -> VAR25 = VAR36 ; VAR6 -> VAR27 = sizeof ( VAR15 ) ; if ( VAR6 -> VAR29 < sizeof ( VAR15 ) ) { VAR6 -> VAR29 = sizeof ( VAR15 ) ; VAR30 } if ( ( VAR16 = FUN3 ( VAR3 , VAR15 ) ) == NULL ) { VAR21 = VAR32 ; VAR24 } FUN5 ( VAR16 , NULL ) ; VAR6 -> VAR31 = ( VAR37 * ) VAR16 ; VAR6 -> VAR21 = VAR34 ; return ( VAR35 ) ; } if ( FUN2 ( VAR7 , "" ) == 0 ) { VAR6 -> VAR25 = VAR38 ; VAR9 [ 0 ] = '' ; ( void ) FUN6 ( VAR9 , VAR39 ) ; VAR40 } if ( FUN2 ( VAR7 , "" ) == 0 ) { VAR6 -> VAR25 = VAR38 ; VAR9 [ 0 ] = '' ; if ( FUN7 ( VAR41 , & VAR14 ) != VAR42 ) { VAR21 = VAR23 ; VAR24 } ( void ) snprintf ( VAR9 , VAR10 , "" , VAR14 . VAR43 ) ; ( void ) FUN8 ( VAR9 , "" ) ; ( void ) FUN9 ( VAR9 , '' , '' ) ; VAR40 } if ( FUN2 ( VAR7 , "" ) == 0 ) { VAR6 -> VAR25 = VAR38 ; if ( FUN10 ( & VAR17 ) < 0 ) { ( void ) FUN11 ( VAR9 , "" , VAR10 ) ; } else { ( void ) snprintf ( VAR9 , VAR10 , "" , VAR17 . VAR17 , VAR17 . VAR44 ) ; } VAR40 } VAR21 = VAR23 ; report_error FUN12 ( VAR6 , sizeof ( VAR5 ) ) ; VAR6 -> VAR31 = VAR11 ; VAR6 -> VAR21 = VAR21 ; return ( VAR35 ) ; encode_string wcslen = FUN13 ( VAR9 ) + sizeof ( VAR18 ) ; if ( VAR6 -> VAR29 < wcslen ) { VAR6 -> VAR27 = wcslen ; VAR30 } if ( ( VAR19 = FUN14 ( VAR3 , wcslen ) ) == NULL ) { VAR21 = VAR32 ; VAR24 } ( void ) FUN15 ( NULL , VAR19 , VAR9 , wcslen ) ; VAR6 -> VAR31 = ( VAR37 * ) VAR19 ; VAR6 -> VAR27 = wcslen ; VAR6 -> VAR21 = VAR34 ; return ( VAR35 ) ; need_more_data VAR6 -> VAR29 = 0 ; VAR6 -> VAR31 = VAR11 ; VAR6 -> VAR21 = VAR45 ; return ( VAR35 ) ; }