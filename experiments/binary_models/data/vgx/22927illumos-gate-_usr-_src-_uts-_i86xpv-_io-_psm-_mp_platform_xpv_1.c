void apic_init_common ( void ) { int i , j , indx ; int * iptr ; for ( i = 0 ; i < ( APIC_AVAIL_VECTOR / APIC_VECTOR_PER_IPL ) ; i ++ ) { indx = i * APIC_VECTOR_PER_IPL ; for ( j = 0 ; j < APIC_VECTOR_PER_IPL ; j ++ , indx ++ ) { apic_ipls [ indx ] = apic_vectortoipl [ i ] ; } } apic_cpus [ 0 ] . aci_status = APIC_CPU_ONLINE | APIC_CPU_INTR_ENABLE ; iptr = ( int * ) & apic_irq_table [ 0 ] ; for ( i = 0 ; i <= APIC_MAX_VECTOR ; i ++ ) { apic_level_intr [ i ] = 0 ; * iptr ++ = 0 ; apic_vector_to_irq [ i ] = APIC_RESV_IRQ ; apic_reprogram_info [ i ] . done = B_TRUE ; apic_reprogram_info [ i ] . irqp = NULL ; apic_reprogram_info [ i ] . tries = 0 ; apic_reprogram_info [ i ] . bindcpu = 0 ; } apic_irq_table [ APIC_RESV_IRQ ] = kmem_zalloc ( sizeof ( apic_irq_t ) , KM_SLEEP ) ; mutex_init ( & airq_mutex , MUTEX_DEFAULT , NULL ) ; } 