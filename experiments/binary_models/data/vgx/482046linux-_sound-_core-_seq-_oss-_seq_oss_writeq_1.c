struct seq_oss_writeq * snd_seq_oss_writeq_new ( struct seq_oss_devinfo * dp , int maxlen ) { struct seq_oss_writeq * q ; struct snd_seq_client_pool pool ; q = kzalloc ( sizeof ( * q ) , GFP_KERNEL ) ; if ( ! q ) { return in ; } q -> dp = dp ; q -> maxlen = maxlen ; spin_lock_init ( & q -> sync_lock ) ; q -> sync_event_put = 0 ; q -> sync_time = 0 ; init_waitqueue_head ( & q -> sync_sleep ) ; memset ( & pool , 0 , sizeof ( pool ) ) ; pool . client = dp -> cseq ; pool . output_pool = maxlen ; pool . output_room = maxlen / 2 ; snd_seq_oss_control ( dp , SNDRV_SEQ_IOCTL_SET_CLIENT_POOL , & pool ) ; return q ; } 