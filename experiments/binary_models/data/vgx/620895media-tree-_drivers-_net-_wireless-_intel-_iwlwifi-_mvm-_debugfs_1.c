static ssize_t iwl_dbgfs_sram_write ( struct iwl_mvm * mvm , char * buf , size_t count , loff_t * ppos ) { const struct fw_img * img ; u32 offset , len ; u32 img_offset , img_len ; if ( ! mvm -> ucode_loaded ) { return - EINVAL ; } img = & mvm -> fw -> img [ mvm -> cur_ucode ] ; img_offset = img -> sec [ IWL_UCODE_SECTION_DATA ] . offset ; img_len = img -> sec [ IWL_UCODE_SECTION_DATA ] . len ; if ( sscanf ( buf , "%x,%x" , & offset , & len ) == 2 ) { if ( ( offset & 0x3 ) || ( len & 0x3 ) ) { return - EINVAL ; } if ( offset + len > img_offset + img_len ) { return - EINVAL ; } mvm -> dbgfs_sram_offset = offset ; mvm -> dbgfs_sram_len = len ; } else { mvm -> dbgfs_sram_len = 0 ; } return count ; } 