file_monitor_do ( ) { update_real_monitor ( data ) ; copy_file ( data -> source , monitor_dir ) ; if ( strcmp ( data -> source , "/etc/localtime" ) == 0 ) { char * dest = g_build_filename ( monitor_dir , "timezone" , NULL ) ; g_autofree char * raw_timezone = flatpak_get_timezone ( ) ; g_autofree char * timezone_content = g_strdup_printf ( "%s\n" , raw_timezone ) ; g_file_set_contents ( dest , timezone_content , - 1 ) ; } } 