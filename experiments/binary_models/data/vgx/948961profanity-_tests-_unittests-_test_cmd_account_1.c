void cmd_account_list_shows_accounts ( void * * state ) { gchar * args [ ] { "list" NULL } ; ; gchar * * accounts = malloc ( sizeof ( gchar * ) * 4 ) ; accounts [ 0 ] = strdup ( "account1" ) ; accounts [ 1 ] = strdup ( "account2" ) ; accounts [ 2 ] = strdup ( "account3" ) ; accounts [ 3 ] = NULL ; will_return ( accounts_get_list , accounts ) ; expect_memory ( cons_show_account_list , accounts , accounts , sizeof ( accounts ) ) ; gboolean result = cmd_account_list ( NULL , CMD_ACCOUNT , args ) ; } 