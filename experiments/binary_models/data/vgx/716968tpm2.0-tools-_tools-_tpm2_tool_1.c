static const tpm2_tool * tpm2_tool_lookup ( int * argc , char * * * argv ) { const char * name = tpm2_tool_name ( ( * argv ) [ 0 ] ) ; if ( strcmp ( name , "tpm2" ) == 0 ) { if ( -- ( * argc ) == 0 ) { return NULL ; } ( * argv ) ++ ; name = tpm2_tool_name ( ( * argv ) [ 0 ] ) ; } for ( unsigned i = 0 ; i < tool_count ; i ++ ) { const tpm2_tool * const tool = tools [ i ] ; if ( strcmp ( name , tool -> name ) == 0 ) { return tool ; } } return NULL ; } static tool_context { ESYS_CONTEXT * ectx ; tpm2_options * tool_opts ; } , ctx 