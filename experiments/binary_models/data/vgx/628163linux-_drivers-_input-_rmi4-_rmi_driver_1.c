static int rmi_read_pdt_entry ( struct rmi_device * rmi_dev , struct pdt_entry * entry , u16 pdt_address ) { int buf [ RMI_PDT_ENTRY_SIZE ] ; int error ; error = rmi_read_block ( rmi_dev , pdt_address , buf , RMI_PDT_ENTRY_SIZE ) ; if ( error ) { dev_err ( & rmi_dev -> dev , "Read PDT entry at %#06x failed, code: %d.\n" , pdt_address , error ) ; return error ; } entry -> page_start = pdt_address & RMI4_PAGE_MASK ; entry -> query_base_addr = buf [ 0 ] ; entry -> command_base_addr = buf [ 1 ] ; entry -> control_base_addr = buf [ 2 ] ; entry -> data_base_addr = buf [ 3 ] ; entry -> interrupt_source_count = buf [ 4 ] & RMI_PDT_INT_SOURCE_COUNT_MASK ; entry -> function_version = ( buf [ 4 ] & RMI_PDT_FUNCTION_VERSION_MASK ) >> 5 ; entry -> function_number = buf [ 5 ] ; return 0 ; } 