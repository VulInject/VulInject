static int feiyang_unprepare ( struct drm_panel * panel ) { struct feiyang * ctx = panel_to_feiyang ( panel ) ; int ret ; ret = mipi_dsi_dcs_set_display_off ( ctx -> dsi ) ; if ( ret < 0 ) { dev_err ( panel -> dev , "failed to set display off: %d\n" , ret ) ; } ret = mipi_dsi_dcs_enter_sleep_mode ( ctx -> dsi ) ; if ( ret < 0 ) { dev_err ( panel -> dev , "failed to enter sleep mode: %d\n" , ret ) ; } msleep ( 200 ) ; gpiod_set_value ( ctx -> reset , 0 ) ; regulator_disable ( ctx -> avdd , NULL ) ; msleep ( 10 ) ; regulator_disable ( ctx -> dvdd ) ; return 0 ; } 