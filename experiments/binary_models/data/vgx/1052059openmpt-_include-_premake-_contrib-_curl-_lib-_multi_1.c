static CURLMcode multi_addtimeout ( struct curl_llist * timeoutlist , struct timeval * stamp ) { struct curl_llist_element * e ; struct timeval * timedup ; struct curl_llist_element * prev = NULL ; timedup = malloc ( sizeof ( * timedup ) ) ; if ( ! timedup ) { return CURLM_OUT_OF_MEMORY ; } memcpy ( timedup , stamp , sizeof ( * timedup ) ) ; if ( Curl_llist_count ( timeoutlist ) ) { for ( e = timeoutlist -> head ; e ; e = e -> next ) { struct timeval * checktime = e -> ptr ; time_t diff = curlx_tvdiff ( * checktime , * timedup ) ; if ( diff > 0 ) { break ; } prev = e ; } } if ( ! Curl_llist_insert_next ( timeoutlist , prev , timedup ) ) { return CURLM_OUT_OF_MEMORY ; } return CURLM_OK ; } 