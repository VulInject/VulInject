static struct sc_pkcs15_card * p15card ; static int enum_pins ( struct sc_pkcs15_object * * * ret ) { struct sc_pkcs15_object * * objs ; int i , n ; n = sc_pkcs15_get_objects ( p15card , SC_PKCS15_TYPE_AUTH_PIN , NULL , 0 ) ; if ( n < 0 ) { fprintf ( stderr , "Error enumerating PIN codes: %s\n" , sc_strerror ( n ) ) ; return 1 ; } if ( n == 0 ) { fprintf ( stderr , "No PIN codes found!\n" ) ; return 0 ; } objs = calloc ( n , sizeof ( * objs ) ) ; if ( ! objs ) { fprintf ( stderr , "Not enough memory!\n" ) ; return 1 ; } if ( 0 > sc_pkcs15_get_objects ( p15card , SC_PKCS15_TYPE_AUTH_PIN , objs , n ) ) { fprintf ( stderr , "Error enumerating PIN codes\n" ) ; return 1 ; } for ( i = 0 ; i < n ; i ++ ) { sc_test_print_object ( objs [ i ] ) ; } * ret = objs ; return n ; } 