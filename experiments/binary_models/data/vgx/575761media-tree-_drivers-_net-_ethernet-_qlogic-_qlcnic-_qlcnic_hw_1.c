int qlcnic_82xx_config_hw_lro ( struct qlcnic_adapter * adapter , int enable ) { struct qlcnic_nic_req req ; u64 word ; int rv ; memset ( & req , 0 , sizeof ( qlcnic_nic_req ) ) ; req . qhdr = cpu_to_le64 ( QLCNIC_HOST_REQUEST << 23 ) ; word = QLCNIC_H2C_OPCODE_CONFIG_HW_LRO | ( ( u64 ) adapter -> portnum << 16 ) ; req . req_hdr = cpu_to_le64 ( word ) ; word = 0 ; if ( enable ) { word = QLCNIC_ENABLE_IPV4_LRO ; if ( adapter -> ahw -> extra_capability [ 0 ] & QLCNIC_FW_CAP2_HW_LRO_IPV6 ) { word |= QLCNIC_ENABLE_IPV6_LRO ; } } req . words [ 0 ] = cpu_to_le64 ( word ) ; rv = qlcnic_send_cmd_descs ( adapter , ( cmd_desc_type0 * ) & req , 1 ) ; if ( rv != 0 ) { dev_err ( & adapter -> netdev -> dev , "Could not send configure hw lro request\n" ) ; } return rv ; } 