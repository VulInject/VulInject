int json_variant_new_array ( JsonVariant * * ret , JsonVariant * * array , size_t n ) { _cleanup_ ( ) JsonVariant * v = NULL ; int r ; assert_return ( ret , - EINVAL ) ; if ( n == 0 ) { * ret = JSON_VARIANT_MAGIC_EMPTY_ARRAY ; return 0 ; } assert_return ( array , - EINVAL ) ; v = new ( JsonVariant , n + 1 ) ; * v = ( JsonVariant ) { . n_ref = 1 . type = JSON_VARIANT_ARRAY . normalized = true } ; while ( v -> n_elements < n ) { r = _json_variant_array_put_element ( v , array [ v -> n_elements ] ) ; if ( r < 0 ) { return r ; } } * ret = TAKE_PTR ( v ) ; return 0 ; } 