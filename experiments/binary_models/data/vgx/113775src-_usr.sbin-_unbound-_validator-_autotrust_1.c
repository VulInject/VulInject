static void verbose_key ( struct autr_ta * ta , enum verbosity_value level , const char * format , ... ) { va_list args ; va_start ( args , format ) ; if ( verbosity >= level ) { char * str = sldns_wire2str_dname ( ta -> rr , ta -> dname_len ) ; int keytag = ( int ) sldns_calc_keytag_raw ( sldns_wirerr_get_rdata ( ta -> rr , ta -> rr_len , ta -> dname_len ) , sldns_wirerr_get_rdatalen ( ta -> rr , ta -> rr_len , ta -> dname_len ) ) ; char msg [ MAXSYSLOGMSGLEN ] ; vsnprintf ( msg , sizeof ( msg ) , format , args ) ; verbose ( level , "%s key %d %s" , str ?str : "??" , keytag , msg ) ; } va_end ( args ) ; } 