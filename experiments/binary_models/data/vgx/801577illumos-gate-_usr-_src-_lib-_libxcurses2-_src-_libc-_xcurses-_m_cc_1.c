int __m_cc_replace ( WINDOW * w , int y , int x , const cchar_t * cc , int as_is ) { int i , width ; cchar_t * cp , * np ; width = __m_cc_width ( cc ) ; if ( width <= 0 ) { return ( __m_cc_modify ( w , y , x , cc ) ) ; } if ( 0 < width && w -> _maxx < x + width ) { ( void ) __m_cc_erase ( w , y , x , y , w -> _maxx - 1 ) ; return ( - 1 ) ; } ( void ) __m_cc_erase ( w , y , x , y , x + width - 1 ) ; cp = & w -> _line [ y ] [ x ++ ] ; if ( cc -> _wc [ 0 ] == L ' ' ) { * cp = w -> _bg ; cp -> _at = cc -> _at | w -> _fg . _at ; cp -> _co = ( cc -> _co ) ?cc -> _co : w -> _fg . _co ; } else { if ( __m_wacs_cc ( cc , cp ) ) { cp -> _at = ( cc -> _at | w -> _fg . _at ) & ~ WA_ALTCHARSET ; } else { cp -> _at = cc -> _at | w -> _fg . _at ; } cp -> _co = ( cc -> _co ) ?cc -> _co : w -> _fg . _co ; } for ( np = cp + 1 , i = 1 ; i < width ; ++ i , ++ x , ++ np ) { * np = * cp ; np -> _f = 0 ; } return ( width ) ; } 