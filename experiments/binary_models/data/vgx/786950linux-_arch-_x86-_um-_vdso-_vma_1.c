extern char vdso_start [ ] , vdso_end [ ] ; static struct page * * vdsop ; static int __init init_vdso ( void ) { struct page * um_vdso ; BUG_ON ( vdso_end - vdso_start > PAGE_SIZE ) ; um_vdso_addr = task_size - PAGE_SIZE ; vdsop = kmalloc ( sizeof ( page * ) , GFP_KERNEL ) ; if ( ! vdsop ) { oom } um_vdso = alloc_page ( GFP_KERNEL ) ; if ( ! um_vdso ) { oom } copy_page ( page_address ( um_vdso ) , vdso_start ) ; * vdsop = um_vdso ; return 0 ; oom printk ( KERN_ERR "Cannot allocate vdso\n" ) ; vdso_enabled = 0 ; return - ENOMEM ; } 