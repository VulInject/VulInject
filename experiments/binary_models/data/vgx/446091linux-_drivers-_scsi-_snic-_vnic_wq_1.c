int vnic_wq_devcmd2_alloc ( struct vnic_dev * vdev , struct vnic_wq * wq , unsigned int desc_count , unsigned int desc_size ) { int err ; wq -> index = 0 ; wq -> vdev = vdev ; err = vnic_wq_get_ctrl ( vdev , wq , 0 , RES_TYPE_DEVCMD2 ) ; if ( err ) { pr_err ( "Failed to get devcmd2 resource\n" ) ; return err ; } svnic_wq_disable ( wq ) ; err = vnic_wq_alloc_ring ( vdev , wq , 0 , desc_count , desc_size ) ; return 0 ; } 