static bool netsnmp_session_set_auth_protocol ( struct snmp_session * s , zend_string * prot ) { if ( zend_string_equals_literal_ci ( prot , "MD5" ) ) { s -> securityAuthProto = usmHMACMD5AuthProtocol ; return true ; } if ( zend_string_equals_literal_ci ( prot , "SHA" ) ) { s -> securityAuthProto = usmHMACSHA1AuthProtocol ; s -> securityAuthProtoLen = USM_AUTH_PROTO_SHA_LEN ; return true ; } if ( zend_string_equals_literal_ci ( prot , "SHA256" ) ) { s -> securityAuthProto = usmHMAC192SHA256AuthProtocol ; s -> securityAuthProtoLen = sizeof ( usmHMAC192SHA256AuthProtocol ) / sizeof ( oid ) ; return true ; } if ( zend_string_equals_literal_ci ( prot , "SHA512" ) ) { s -> securityAuthProto = usmHMAC384SHA512AuthProtocol ; s -> securityAuthProtoLen = sizeof ( usmHMAC384SHA512AuthProtocol ) / sizeof ( oid ) ; return true ; } smart_string err = { 0 } ; smart_string_appends ( & err , "Authentication protocol must be \"SHA\"" ) ; smart_string_appends ( & err , " or \"SHA256\"" ) ; smart_string_appends ( & err , " or \"SHA512\"" ) ; smart_string_appends ( & err , " or \"MD5\"" ) ; smart_string_0 ( & err ) ; zend_value_error ( "%s" , err . c ) ; smart_string_free ( & err ) ; return false ; } 