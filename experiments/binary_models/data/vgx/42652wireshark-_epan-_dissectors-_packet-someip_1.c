static void post_update_someip_parameter_list_read_in_data ( someip_parameter_list_uat_t * data , guint data_num , GHashTable * ht ) { guint i = 0 ; gint64 * key = NULL ; someip_parameter_list_t * list = NULL ; someip_payload_parameter_item_t * item = NULL ; someip_payload_parameter_item_t * items = NULL ; for ( i = 0 ; i < data_num ; i ++ ) { key = wmem_new ( wmem_epan_scope ( ) , gint64 ) ; * key = someip_parameter_key ( ( guint16 ) data [ i ] . service_id , ( guint16 ) data [ i ] . method_id , ( guint8 ) data [ i ] . version , ( guint8 ) data [ i ] . message_type ) ; list = ( someip_parameter_list_t * ) g_hash_table_lookup ( ht , key ) ; if ( list == NULL ) { list = wmem_new ( wmem_epan_scope ( ) , someip_parameter_list_t ) ; list -> service_id = data [ i ] . service_id ; list -> method_id = data [ i ] . method_id ; list -> version = data [ i ] . version ; list -> message_type = data [ i ] . message_type ; list -> wtlv_encoding = data [ i ] . wtlv_encoding ; list -> num_of_items = data [ i ] . num_of_params ; items = ( someip_payload_parameter_item_t * ) wmem_alloc0_array ( wmem_epan_scope ( ) , someip_payload_parameter_item_t , data [ i ] . num_of_params ) ; list -> items = items ; g_hash_table_insert ( ht , key , list ) ; } else { wmem_free ( wmem_epan_scope ( ) , key ) ; } if ( data [ i ] . num_of_params == list -> num_of_items && data [ i ] . pos < list -> num_of_items ) { item = & ( list -> items [ data [ i ] . pos ] ) ; item -> name = data [ i ] . name ; item -> id_ref = data [ i ] . id_ref ; item -> pos = data [ i ] . pos ; item -> data_type = data [ i ] . data_type ; item -> filter_string = data [ i ] . filter_string ; } } } 