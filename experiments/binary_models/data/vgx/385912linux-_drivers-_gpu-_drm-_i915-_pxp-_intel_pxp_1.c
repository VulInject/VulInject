int intel_pxp_init ( struct drm_i915_private * i915 ) { struct intel_gt * gt ; bool is_full_feature = false ; gt = find_gt_for_required_protected_content ( i915 ) ; if ( gt ) { is_full_feature = true ; } else { gt = find_gt_for_required_teelink ( i915 ) ; } if ( ! gt ) { return - ENODEV ; } i915 -> pxp = kmalloc ( sizeof ( * i915 -> pxp ) , GFP_KERNEL ) ; if ( ! i915 -> pxp ) { return - ENOMEM ; } i915 -> pxp -> ctrl_gt = gt ; if ( is_full_feature ) { pxp_init_full ( i915 -> pxp ) ; } else { intel_pxp_tee_component_init ( i915 -> pxp ) ; } return 0 ; } 