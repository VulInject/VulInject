static kadm5_ret_t FUN1 ( VAR1 * VAR2 ) { kadm5_ret_t VAR3 ; krb5_principal VAR4 = NULL ; krb5_ccache VAR5 = NULL ; rk_socket_t VAR6 = VAR7 ; struct VAR8 * VAR9 , * VAR10 ; struct addrinfo VAR11 ; int VAR12 = 0 ; int VAR13 ; int VAR14 = 0 ; const char * VAR15 = NULL ; char VAR16 [ VAR17 ] ; const char * VAR18 , * VAR19 ; char * VAR20 = NULL ; krb5_context VAR21 = VAR2 -> VAR21 ; int VAR22 = 0 ; if ( VAR2 -> VAR23 ) { FUN2 ( VAR21 , VAR2 -> VAR23 ) ; } VAR2 -> VAR23 = NULL ; if ( ! VAR2 -> VAR24 ) { VAR15 = VAR2 -> VAR25 ; VAR14 = VAR2 -> VAR26 ; } if ( VAR15 == NULL ) { VAR15 = VAR2 -> VAR15 ; VAR22 = 1 ; } if ( VAR14 < 1 ) { VAR14 = VAR2 -> VAR27 ; } memset ( & VAR11 , 0 , sizeof ( VAR11 ) ) ; VAR11 . VAR28 = VAR29 ; VAR11 . VAR30 = VAR31 ; snprintf ( VAR16 , sizeof ( VAR16 ) , "" , FUN3 ( VAR14 ) ) ; VAR18 = VAR15 ; VAR19 = strchr ( VAR18 , '' ) ; if ( VAR19 != NULL ) { VAR18 = VAR19 + 1 ; } VAR13 = getaddrinfo ( VAR18 , VAR16 , & VAR11 , & VAR9 ) ; if ( VAR13 ) { VAR3 = VAR32 ; VAR33 } VAR12 = 1 ; for ( VAR10 = VAR9 ; VAR10 != NULL ; VAR10 = VAR10 -> VAR34 ) { VAR6 = socket ( VAR10 -> VAR35 , VAR10 -> VAR28 , VAR10 -> VAR30 ) ; if ( VAR6 < 0 ) { continue ; } if ( connect ( VAR6 , VAR10 -> VAR36 , VAR10 -> VAR37 ) < 0 ) { FUN4 ( VAR21 , VAR38 , "" , VAR18 ) ; FUN5 ( VAR6 , NULL ) ; VAR6 = VAR7 ; continue ; } break ; } if ( VAR10 == NULL ) { FUN6 ( VAR21 , VAR3 = VAR39 , "" , VAR18 ) ; VAR33 } VAR3 = FUN7 ( VAR21 , VAR2 -> VAR40 , VAR2 -> VAR20 , NULL , VAR2 -> VAR41 , VAR2 -> VAR42 , VAR2 -> VAR43 , & VAR5 ) ; if ( VAR3 ) { VAR33 } if ( VAR2 -> VAR44 ) { VAR13 = asprintf ( & VAR20 , "" , VAR45 , VAR2 -> VAR44 ) ; } else { VAR13 = asprintf ( & VAR20 , "" , VAR45 ) ; } if ( VAR13 == - 1 || VAR20 == NULL ) { VAR3 = FUN8 ( VAR21 ) ; VAR33 } VAR3 = FUN9 ( VAR21 , VAR20 , & VAR4 ) ; if ( VAR3 ) { VAR33 } VAR3 = FUN10 ( VAR21 , & VAR2 -> VAR23 , & VAR6 , VAR46 , NULL , VAR4 , VAR47 , NULL , NULL , VAR5 , NULL , NULL , NULL ) ; if ( VAR3 == 0 ) { krb5_data VAR48 ; kadm5_config_params VAR49 ; memset ( & VAR49 , 0 , sizeof ( VAR49 ) ) ; if ( VAR2 -> VAR44 ) { VAR49 . VAR50 |= VAR51 ; VAR49 . VAR44 = VAR2 -> VAR44 ; } VAR3 = FUN11 ( VAR21 , & VAR49 , & VAR48 ) ; if ( VAR3 == 0 ) { VAR3 = FUN12 ( VAR21 , VAR2 -> VAR23 , & VAR6 , & VAR48 ) ; FUN13 ( & VAR48 ) ; } } if ( VAR3 == 0 ) { VAR2 -> VAR52 = VAR6 ; VAR2 -> VAR53 = ! ! VAR22 ; } out free ( VAR20 ) ; FUN14 ( VAR21 , VAR5 ) ; FUN15 ( VAR21 , VAR4 ) ; if ( VAR12 ) { FUN16 ( VAR9 ) ; } if ( VAR3 ) { if ( VAR6 != VAR7 ) { FUN5 ( VAR6 ) ; } FUN2 ( VAR21 , VAR2 -> VAR23 ) ; VAR2 -> VAR23 = NULL ; } return VAR3 ; }