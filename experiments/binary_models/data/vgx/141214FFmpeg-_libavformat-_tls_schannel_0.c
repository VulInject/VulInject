static int FUN1(VAR1 *VAR2, int VAR3)
{
VAR4 *VAR5 = VAR2->VAR6;
VAR7 *VAR8 = &VAR5->VAR9;
SECURITY_STATUS VAR10;
SecBuffer VAR11[3] = { 0 };
SecBufferDesc VAR12;
SecBuffer VAR13[2];
SecBufferDesc VAR14;
int VAR15, VAR16 = 0, VAR17 = VAR3;

if (VAR5->VAR18 == NULL) {
VAR5->VAR19 = 0;
VAR16 = FUN2(&VAR5->VAR18, VAR20);
if (VAR16 < 0)
goto VAR21;
VAR5->VAR22 = VAR20;
}

if (VAR5->VAR23 == NULL) {
VAR5->VAR24 = 0;
VAR16 = FUN2(&VAR5->VAR23, VAR20);
if (VAR16 < 0)
goto VAR21;
VAR5->VAR25 = VAR20;
}

while (1) {
if (VAR5->VAR22 - VAR5->VAR19 < VAR26) {
VAR5->VAR22 = VAR5->VAR19 + VAR26;
VAR16 = FUN2(&VAR5->VAR18, VAR5->VAR22);
if (VAR16 < 0) {
VAR5->VAR22 = VAR5->VAR19 = 0;
goto VAR21;
}
}

if (VAR17) {
VAR16 = FUN3(VAR5->VAR9.VAR27, VAR5->VAR18 + VAR5->VAR19,
VAR5->VAR22 - VAR5->VAR19);
if (VAR16 < 0) {
FUN4(VAR2, VAR28, "");
goto VAR21;
}
VAR5->VAR19 += VAR16;
}


FUN5(&VAR13[0], VAR29, FUN6(VAR5->VAR19), VAR5->VAR19);
FUN5(&VAR13[1], VAR30, NULL, 0);
FUN7(&VAR14, VAR13, 2);

if (VAR13[0].VAR31 == NULL) {
FUN4(VAR2, VAR28, "");
VAR16 = FUN8(VAR32);
goto VAR21;
}

memcpy(VAR13[0].VAR31, VAR5->VAR18, VAR5->VAR19);


FUN5(&VAR11[0], VAR29, NULL, 0);
FUN5(&VAR11[1], VAR33, NULL, 0);
FUN5(&VAR11[2], VAR30, NULL, 0);
FUN7(&VAR12, VAR11, 3);

VAR10 = FUN9(&VAR5->VAR34, &VAR5->VAR35, VAR8->VAR36, VAR5->VAR37,
0, 0, &VAR14, 0, NULL, &VAR12, &VAR5->VAR38,
&VAR5->VAR39);
FUN10(&VAR13[0].VAR31);

if (VAR10 == VAR40) {
FUN4(VAR2, VAR41, "");
VAR17 = 1;
continue;
}


if (VAR10 == VAR42 &&
!(VAR5->VAR37 & VAR43)) {
FUN4(VAR2, VAR44, "");
VAR5->VAR37 |= VAR43;
VAR17 = 0;
continue;
}


if (VAR10 == VAR45 || VAR10 == VAR46) {
for (VAR15 = 0; VAR15 < 3; VAR15++) {
if (VAR11[VAR15].VAR47 == VAR29 && VAR11[VAR15].VAR48 > 0) {
VAR16 = FUN11(VAR5->VAR9.VAR27, VAR11[VAR15].VAR31, VAR11[VAR15].VAR48);
if (VAR16 < 0 || VAR16 != VAR11[VAR15].VAR48) {
FUN4(VAR2, VAR44, "");
VAR16 = FUN8(VAR49);
goto VAR21;
}
}

if (VAR11[VAR15].VAR31 != NULL) {
FUN12(VAR11[VAR15].VAR31);
VAR11[VAR15].VAR31 = NULL;
}
}
} else {
if (VAR10 == VAR50)
FUN4(VAR2, VAR28, "");
else
FUN4(VAR2, VAR28, "", VAR10);
VAR16 = VAR51;
goto VAR21;
}

if (VAR13[1].VAR47 == VAR52 && VAR13[1].VAR48 > 0) {
if (VAR5->VAR19 > VAR13[1].VAR48) {
memmove(VAR5->VAR18, (VAR5->VAR18 + VAR5->VAR19) - VAR13[1].VAR48,
VAR13[1].VAR48);
VAR5->VAR19 = VAR13[1].VAR48;
if (VAR10 == VAR45) {
VAR17 = 0;
continue;
}
}
} else {
VAR5->VAR19  = 0;
}

if (VAR10 == VAR45) {
VAR17 = 1;
continue;
}

break;
}

return 0;

VAR21:

for (VAR15 = 0; VAR15 < 3; VAR15++) {
if (VAR11[VAR15].VAR31 != NULL) {
FUN12(VAR11[VAR15].VAR31);
VAR11[VAR15].VAR31 = NULL;
}
}

return VAR16;
}