static void auf_msgsys ( struct t_audit_data * tad , int error , rval_t * rval ) { int id ; if ( tad -> tad_event == AUE_MSGGET ) { uint32_t scid ; uint32_t sy_flags ; scid = tad -> tad_scid ; if ( lwp_getdatamodel ( ttolwp ( curthread ) ) == DATAMODEL_NATIVE ) { sy_flags = sysent [ scid ] . sy_flags & SE_RVAL_MASK ; } else { sy_flags = sysent32 [ scid ] . sy_flags & SE_RVAL_MASK ; } sy_flags = sysent [ scid ] . sy_flags & SE_RVAL_MASK ; if ( sy_flags == SE_32RVAL1 ) { id = rval -> r_val1 ; } if ( sy_flags == ( SE_32RVAL2 | SE_32RVAL1 ) ) { id = rval -> r_val1 ; } if ( sy_flags == SE_64RVAL ) { id = ( int ) rval -> r_vals ; } au_uwrite ( au_to_ipc ( AT_IPC_MSG , id ) ) ; } } 