static int process_access_response_info ( const char __user * info , size_t info_len , struct fanotify_response_info_audit_rule * friar ) { if ( info_len != sizeof ( * friar ) ) { return - EINVAL ; } if ( copy_from_user ( friar , info , sizeof ( * friar ) ) ) { return - EFAULT ; } if ( friar -> hdr . type != FAN_RESPONSE_INFO_AUDIT_RULE ) { return - EINVAL ; } if ( friar -> hdr . len != sizeof ( * friar ) ) { return - EINVAL ; } return info_len ; } 