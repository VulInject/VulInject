static void free_server ( server_t * server ) { cork_dllist_remove ( & server -> entries ) ; if ( server -> remote != NULL ) { server -> remote -> server = NULL ; } if ( server -> e_ctx != NULL ) { crypto -> ctx_release ( server -> e_ctx ) ; ss_free ( server -> e_ctx ) ; } if ( server -> d_ctx != NULL ) { crypto -> ctx_release ( server -> d_ctx ) ; ss_free ( server -> d_ctx ) ; } if ( server -> buf != NULL ) { ss_free ( server -> buf ) ; } if ( server -> abuf != NULL ) { bfree ( server -> abuf ) ; ss_free ( server -> abuf ) ; } ss_free ( server -> recv_ctx ) ; ss_free ( server -> send_ctx ) ; ss_free ( server ) ; } 