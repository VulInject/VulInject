extern char * F77_aloc ( ) , * getenv ( ) ; "C" { extern char * F77_aloc ( ftnlen , char * ) VOID getenv_ ( fname , value , flen , vlen ) char * value , * fname ; ftnlen vlen , flen ; void getenv_ ( char * fname , char * value , ftnlen flen , ftnlen vlen ) { char buf [ 256 ] , * ep , * fp ; integer i ; if ( flen <= 0 ) { add_blanks } for ( i = 0 ; i < sizeof ( buf ) ; i ++ ) { if ( i == flen || ( buf [ i ] = fname [ i ] ) == ' ' ) { buf [ i ] = 0 ; ep = getenv ( buf ) ; have_ep } } while ( i < flen && fname [ i ] != ' ' ) { i ++ ; } strncpy ( fp = F77_aloc ( i + 1 , "getenv_" ) , fname , ( int ) i ) ; fp [ i ] = 0 ; ep = getenv ( fp ) ; have_ep if ( ep ) { while ( * ep && vlen -- > 0 ) { * value ++ = * ep ++ ; } } add_blanks while ( vlen -- > 0 ) { * value ++ = ' ' ; } } } 