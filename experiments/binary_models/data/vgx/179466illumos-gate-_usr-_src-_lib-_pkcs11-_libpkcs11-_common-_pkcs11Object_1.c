CK_RV C_FindObjectsFinal ( CK_SESSION_HANDLE hSession ) { CK_RV rv ; pkcs11_session_t * sessp ; if ( purefastpath || policyfastpath ) { return ( fast_funcs -> C_FindObjectsFinal ( hSession ) ) ; } if ( ! pkcs11_initialized ) { return ( CKR_CRYPTOKI_NOT_INITIALIZED ) ; } HANDLE2SESSION ( hSession , sessp , rv ) ; rv = FUNCLIST ( sessp -> se_slotid ) -> C_FindObjectsFinal ( sessp -> se_handle ) ; if ( rv == CKR_FUNCTION_NOT_SUPPORTED ) { return ( CKR_FUNCTION_FAILED ) ; } return ( rv ) ; } 