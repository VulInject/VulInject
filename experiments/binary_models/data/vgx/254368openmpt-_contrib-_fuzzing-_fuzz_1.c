int main ( int argc , char * argv [ ] ) { static FILE * file = NULL ; static openmpt_module * mod = NULL ; static size_t count = 0 ; static int i = 0 ; ( void ) argc ; __AFL_INIT ( ) ; file = fopen ( argv [ 1 ] , "rb" ) ; mod = openmpt_module_create ( openmpt_stream_get_file_callbacks ( ) , file , NULL , NULL , NULL ) ; fclose ( file ) ; if ( mod == NULL ) { return 1 ; } openmpt_module_ctl_set ( mod , "render.resampler.emulate_amiga" , ( openmpt_module_get_num_orders ( mod ) & 1 ) ?"0" : "1" ) ; for ( ; i < 50 ; i ++ ) { count = openmpt_module_read_mono ( mod , SAMPLERATE , BUFFERSIZE , buffer ) ; if ( count == 0 ) { break ; } } openmpt_module_set_position_seconds ( mod , 1.0 ) ; openmpt_module_read_mono ( mod , SAMPLERATE , BUFFERSIZE , buffer ) ; openmpt_module_set_position_order_row ( mod , 3 , 16 ) ; openmpt_module_read_mono ( mod , SAMPLERATE , BUFFERSIZE , buffer ) ; openmpt_free_string ( openmpt_module_get_metadata ( mod , "date" ) ) ; openmpt_free_string ( openmpt_module_get_metadata ( mod , "message" ) ) ; return 0 ; } 