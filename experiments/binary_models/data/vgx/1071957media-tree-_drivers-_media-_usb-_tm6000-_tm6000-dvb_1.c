static int dvb_init ( struct tm6000_core * dev ) { struct tm6000_dvb * dvb ; int rc ; if ( ! dev ) { return 0 ; } if ( ! dev -> caps . has_dvb ) { return 0 ; } if ( dev -> udev -> speed == USB_SPEED_FULL ) { printk ( KERN_INFO "This USB2.0 device cannot be run on a USB1.1 port. (it lacks a hardware PID filter)\n" ) ; return 0 ; } dvb = kzalloc ( sizeof ( tm6000_dvb ) , GFP_KERNEL ) ; if ( ! dvb ) { printk ( KERN_INFO "Cannot allocate memory\n" ) ; return - ENOMEM ; } dev -> dvb = dvb ; rc = register_dvb ( dev ) ; if ( rc < 0 ) { dev -> dvb = NULL ; return 0 ; } return 0 ; } 