static int mpc83xx_spisel_boot_plat_to_priv ( struct udevice * dev ) { struct mpc83xx_spisel_boot * priv = dev_get_priv ( dev ) ; struct mpc8xxx_gpio_plat * plat = dev_get_plat ( dev ) ; cfs_time_t size = plat -> size ; ulong driver_data = dev_get_driver_data ( dev ) ; if ( size == 0 ) { size = 0x04 ; } priv -> addr = plat -> addr ; priv -> spi_cs = map_sysmem ( plat -> addr , size ) ; if ( ! priv -> spi_cs ) { return - ENOMEM ; } priv -> gpio_count = plat -> ngpios ; priv -> type = driver_data ; return 0 ; } 