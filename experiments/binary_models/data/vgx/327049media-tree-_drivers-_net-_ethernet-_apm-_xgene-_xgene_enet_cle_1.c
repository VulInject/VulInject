static int xgene_cle_setup_rss ( struct xgene_enet_pdata * pdata ) { struct xgene_enet_cle * cle = & pdata -> cle ; void __iomem * base = cle -> base ; u32 offset , val = 0 ; int i , ret ; offset = CLE_PORT_OFFSET ; for ( i = 0 ; i < cle -> parsers ; i ++ ) { if ( cle -> active_parser != PARSER_ALL ) { offset = cle -> active_parser * CLE_PORT_OFFSET ; } else { offset = i * CLE_PORT_OFFSET ; } val = ( RSS_IPV4_12B << 1 ) | 0x1 ; writel ( val , base + RSS_CTRL0 + offset ) ; } ret = xgene_cle_set_rss_sband ( cle ) ; if ( ret ) { return ret ; } ret = xgene_cle_set_rss_idt ( pdata ) ; if ( ret ) { return ret ; } return 0 ; } 