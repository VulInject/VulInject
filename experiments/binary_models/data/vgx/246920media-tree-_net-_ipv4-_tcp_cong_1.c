void tcp_assign_congestion_control ( struct sock * sk ) { struct inet_connection_sock * icsk = inet_csk ( sk ) ; struct tcp_congestion_ops * ca ; rcu_read_lock ( ) ; list_for_each_entry_rcu ( , , ) { if ( likely ( try_module_get ( ca -> owner ) ) ) { icsk -> icsk_ca_ops = ca ; out } } out rcu_read_unlock ( ) ; if ( ca -> flags & TCP_CONG_NEEDS_ECN ) { INET_ECN_xmit ( sk ) ; } else { INET_ECN_dontxmit ( sk ) ; } } 