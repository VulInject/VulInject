int pcap_platform_finddevs ( pcap_if_list_t * devlistp , char * errbuf ) { int retv = 0 ; linknamelist_t * entry , * next ; linkwalk_t lw = { NULL 0 } ; int save_errno ; if ( pcap_findalldevs_interfaces ( devlistp , errbuf , is_dlpi_interface , get_if_flags ) == - 1 ) { return ( - 1 ) ; } dlpi_walk ( list_interfaces , & lw , 0 ) ; if ( lw . lw_err != 0 ) { pcap_fmt_errmsg_for_errno ( errbuf , PCAP_ERRBUF_SIZE , lw . lw_err , "dlpi_walk" ) ; retv = - 1 ; done } for ( entry = lw . lw_list ; entry != NULL ; entry = entry -> lnl_next ) { if ( find_or_add_dev ( devlistp , entry -> linkname , 0 , get_if_flags , NULL , errbuf ) == NULL ) { retv = - 1 ; } } done save_errno = errno ; for ( entry = lw . lw_list ; entry != NULL ; entry = next ) { next = entry -> lnl_next ; } errno = save_errno ; return ( retv ) ; } 