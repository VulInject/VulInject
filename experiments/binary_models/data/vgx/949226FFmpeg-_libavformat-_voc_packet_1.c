av_log ( s , AV_LOG_ERROR , "unknown codec tag\n" ) ; return AVERROR ( EINVAL ) ; ( s , AV_LOG_WARNING , "unknown codec tag\n" ) ; par -> bit_rate = par -> sample_rate * par -> ch_layout . nb_channels * par -> bits_per_coded_sample ; if ( max_size <= 0 ) { max_size = 2048 ; } size = FFMIN ( voc -> remaining_size , max_size ) ; voc -> remaining_size -= size ; ret = av_get_packet ( pb , pkt , size ) ; pkt -> dts = pkt -> pts = voc -> pts ; duration = av_get_audio_frame_duration2 ( st -> codecpar , size ) ; if ( duration > 0 && voc -> pts != AV_NOPTS_VALUE ) { voc -> pts += duration ; } else { voc -> pts = AV_NOPTS_VALUE ; } return ret ; 