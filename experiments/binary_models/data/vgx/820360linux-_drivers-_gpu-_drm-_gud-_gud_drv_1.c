static int gud_usb_get_status ( struct usb_interface * intf ) { int ret , status = - EIO ; u8 * buf ; buf = kmalloc ( sizeof ( * buf ) , GFP_KERNEL ) ; ret = gud_usb_control_msg ( intf , true , GUD_REQ_GET_STATUS , 0 , buf , sizeof ( * buf ) ) ; if ( ret == sizeof ( * buf ) ) { status = gud_status_to_errno ( * buf ) ; } kfree ( buf ) ; if ( ret < 0 ) { return ret ; } return status ; } 