int fru_get_segments ( section_hdl_t section , segment_t * segment , int maxseg , door_cred_t * cred ) { int count ; hash_obj_t * sec_object ; hash_obj_t * seg_object ; section_obj_t * sec_obj ; sec_object = lookup_handle_object ( section , SECTION_TYPE ) ; sec_obj = sec_object -> u . sec_obj ; if ( sec_obj == NULL ) { return ( - 1 ) ; } if ( sec_obj -> num_of_segment > maxseg ) { return ( - 1 ) ; } seg_object = sec_object -> u . sec_obj -> seg_obj_list ; if ( seg_object == NULL ) { return ( - 1 ) ; } for ( count = 0 ; count < sec_obj -> num_of_segment ; count ++ ) { segment -> handle = seg_object -> obj_hdl ; ( void ) memcpy ( segment -> name , seg_object -> u . seg_obj -> segment . name , SEG_NAME_LEN ) ; segment -> descriptor = seg_object -> u . seg_obj -> segment . descriptor ; segment -> offset = seg_object -> u . seg_obj -> segment . offset ; segment -> length = seg_object -> u . seg_obj -> segment . length ; seg_object = seg_object -> u . seg_obj -> next ; segment ++ ; } return ( 0 ) ; } 