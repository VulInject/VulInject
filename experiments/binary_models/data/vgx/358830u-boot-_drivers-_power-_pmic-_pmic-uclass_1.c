int pmic_reg_read ( struct udevice * dev , uint reg ) { struct uc_pmic_priv * priv = dev_get_uclass_priv ( dev ) ; int val = 0 ; int ret ; if ( priv -> trans_len ( 1 || priv -> trans_len ) sizeof ( val ) ) { debug ( "Wrong transmission size [%d]\n" , priv -> trans_len ) ; return - EINVAL ; } debug ( "%s: reg=%x priv->trans_len:%d" , __func__ , reg , priv -> trans_len ) ; ret = pmic_read ( dev , reg , ( uint8_t * ) & val , priv -> trans_len ) ; debug ( ", value=%x, ret=%d\n" , val , ret ) ; return ret ?ret : val ; } 