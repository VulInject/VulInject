static int firebird_stmt_fetch ( pdo_stmt_t * stmt , enum pdo_fetch_orientation ori , zend_long offset ) { pdo_firebird_stmt * S = ( pdo_firebird_stmt * ) stmt -> driver_data ; pdo_firebird_db_handle * H = S -> H ; if ( ! stmt -> executed ) { strcpy ( stmt -> error_code , "HY000" ) ; H -> last_app_error = "Cannot fetch from a closed cursor" ; } if ( ! S -> exhausted ) { if ( S -> statement_type == isc_info_sql_stmt_exec_procedure ) { stmt -> row_count = 1 ; return 1 ; } if ( isc_dsql_fetch ( H -> isc_status , & S -> stmt , PDO_FB_SQLDA_VERSION , & S -> out_sqlda ) ) { if ( H -> isc_status [ 0 ] && H -> isc_status [ 1 ] ) { RECORD_ERROR ( stmt ) ; } S -> exhausted = 1 ; return 0 ; } stmt -> row_count ++ ; return 1 ; } return 0 ; } 