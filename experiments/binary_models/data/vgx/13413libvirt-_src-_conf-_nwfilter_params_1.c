GHashTable * virNWFilterParseParamAttributes ( xmlNodePtr cur ) { g_autoptr ( ) table = virHashNew ( virNWFilterVarValueHashFree ) ; for ( cur = xmlFirstElementChild ( cur ) ; cur != NULL ; cur = xmlNextElementSibling ( cur ) ) { if ( virXMLNodeNameEqual ( cur , "parameter" ) ) { g_autofree char * nam = virXMLPropString ( cur , "name" ) ; g_autofree char * val = virXMLPropString ( cur , "value" ) ; g_autoptr ( ) if ( nam == NULL || ! isValidVarName ( nam ) || val == NULL || ! isValidVarValue ( val ) ) { continue ; } if ( ( value = virHashLookup ( table , nam ) ) ) { if ( virNWFilterVarValueAddValue ( g_steal_pointer ( & value ) , val ) < 0 ) { return NULL ; } val = NULL ; } if ( ( value = virNWFilterParseVarValue ( val ) ) ) { if ( virHashUpdateEntry ( table , nam , value ) < 0 ) { return NULL ; } } value = NULL ; } } return g_steal_pointer ( & table ) ; } 