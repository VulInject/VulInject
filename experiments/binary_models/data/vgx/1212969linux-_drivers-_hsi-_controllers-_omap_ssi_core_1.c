void ssi_waketest ( struct hsi_client * cl , unsigned int enable ) { struct hsi_port * port = hsi_get_port ( cl ) ; struct omap_ssi_port * omap_port = hsi_port_drvdata ( port ) ; struct hsi_controller * ssi = to_hsi_controller ( port -> device . parent ) ; struct omap_ssi_controller * omap_ssi = hsi_controller_drvdata ( ssi ) ; omap_port -> wktest = ! ! enable ; if ( omap_port -> wktest ) { pm_runtime_get_sync ( ssi -> device . parent ) ; writel_relaxed ( SSI_WAKE ( 0 ) , omap_ssi -> sys + SSI_SET_WAKE_REG ( port -> num ) ) ; } else { writel_relaxed ( SSI_WAKE ( 0 ) , omap_ssi -> sys + SSI_CLEAR_WAKE_REG ( port -> num ) ) ; pm_runtime_put ( ssi -> device . parent , NULL ) ; } } 