int sandbox_fs_write_at ( const char * filename , loff_t pos , void * buffer , loff_t towrite , loff_t * actwrite ) { ssize_t size ; int fd , ret ; fd = os_open ( filename , OS_O_RDWR | OS_O_CREAT ) ; if ( fd < 0 ) { return fd ; } ret = os_lseek ( fd , pos , OS_SEEK_SET ) ; if ( ret == - 1 ) { os_close ( fd , NULL ) ; return ret ; } size = os_write ( fd , buffer , towrite ) ; os_close ( fd ) ; if ( size == - 1 ) { ret = - 1 ; } else { ret = 0 ; * actwrite = size ; } return ret ; } 