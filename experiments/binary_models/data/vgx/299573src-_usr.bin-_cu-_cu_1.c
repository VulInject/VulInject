extern char * __progname ; FILE * record_file ; struct termios saved_tio ; struct bufferevent * input_ev ; struct bufferevent * output_ev ; int escape_char = '~' ; int is_direct = - 1 ; int restricted ; const char * line_path = NULL ; int line_speed = - 1 ; int line_fd ; struct termios line_tio ; struct bufferevent * line_ev ; struct event sigterm_ev ; struct event sighup_ev ; { STATE_NONE , STATE_NEWLINE , STATE_ESCAPE } , last_state = STATE_NEWLINE 