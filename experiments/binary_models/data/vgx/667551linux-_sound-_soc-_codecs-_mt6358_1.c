static int mt6358_platform_driver_probe ( struct platform_device * pdev ) { struct mt6358_priv * priv ; struct mt6397_chip * mt6397 = dev_get_drvdata ( pdev -> dev . parent ) ; priv = devm_kzalloc ( & pdev -> dev , sizeof ( mt6358_priv ) , GFP_KERNEL ) ; dev_set_drvdata ( & pdev -> dev , priv ) ; priv -> dev = & pdev -> dev ; priv -> regmap = mt6397 -> regmap ; if ( IS_ERR ( priv -> regmap ) ) { return PTR_ERR ( priv -> regmap ) ; } mt6358_parse_dt ( priv ) ; dev_info ( priv -> dev , "%s(), dev name %s\n" , __func__ , dev_name ( & pdev -> dev ) ) ; return devm_snd_soc_register_component ( & pdev -> dev , & mt6358_soc_component_driver , mt6358_dai_driver , ARRAY_SIZE ( mt6358_dai_driver ) ) ; } 