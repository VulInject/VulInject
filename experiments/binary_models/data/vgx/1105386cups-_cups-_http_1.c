coding . * / httpGetContentEncoding ( ) { if ( http && http -> fields [ HTTP_FIELD_ACCEPT_ENCODING ] ) { int i ; char temp [ HTTP_MAX_VALUE ] , * start , * end ; double qvalue ; struct lconv * loc localeconv ( ) ; ; static const char * const codings [ ] { "deflate" "gzip" "x-deflate" "x-gzip" } ; ; strlcpy ( temp , http -> fields [ HTTP_FIELD_ACCEPT_ENCODING ] , sizeof ( temp ) ) ; for ( start = temp ; * start ; start = end ) { qvalue = 1.0 ; end = start ; while ( * end && * end != ';' && * end != ',' && ! isspace ( * end & 255 ) ) { end ++ ; } if ( * end == ';' ) { if ( ! strncmp ( end , ";q=" , 3 ) ) { qvalue = _cupsStrScand ( end + 3 , NULL , loc ) ; } * end ++ = '\0' ; while ( * end && * end != ',' && ! isspace ( * end & 255 ) ) { end ++ ; } ; } } } } ; if ( * end ) { * end ++ = '\0' ; } while ( * end && isspace ( * end & 255 ) ) { end ++ ; } if ( qvalue <= 0.0 ) { continue ; } for ( i = 0 ; i < ( int ) ( sizeof ( codings ) / sizeof ( codings [ 0 ] ) ) ; i ++ ) { if ( ! strcmp ( start , codings [ i ] ) ) { return ( codings [ i ] ) ; } } return ( NULL ) ; 