char * cclenter ( const char * argp ) { int i , c , c2 ; const uschar * op , * p = ( const uschar * ) argp ; uschar * bp ; static uschar * buf = NULL ; static int bufsz = 100 ; op = p ; if ( buf == NULL && ( buf = ( uschar * ) malloc ( bufsz ) ) == NULL ) { FATAL ( "out of space for character class [%.10s...] 1" , p ) ; } bp = buf ; for ( i = 0 ; ( c = * p ++ ) != 0 ; ) { if ( c == '\\' ) { c = quoted ( & p ) ; } if ( c == '-' && i > 0 && bp [ - 1 ] != 0 ) { if ( * p != 0 ) { c = bp [ - 1 ] ; c2 = * p ++ ; if ( c2 == '\\' ) { c2 = quoted ( & p ) ; } if ( c > c2 ) { bp -- ; i -- ; continue ; } while ( c < c2 ) { if ( ! adjbuf ( ( char * * ) & buf , & bufsz , bp - buf + 2 , 100 , ( char * * ) & bp , "cclenter1" ) ) { FATAL ( "out of space for character class [%.10s...] 2" , p ) ; } * bp ++ = ++ c ; i ++ ; } continue ; } } if ( ! adjbuf ( ( char * * ) & buf , & bufsz , bp - buf + 2 , 100 , ( char * * ) & bp , "cclenter2" ) ) { FATAL ( "out of space for character class [%.10s...] 3" , p ) ; } * bp ++ = c ; i ++ ; } * bp = 0 ; DPRINTF ( "cclenter: in = |%s|, out = |%s|\n" , op , buf ) ; return ( char * ) tostring ( ( char * ) buf ) ; } 