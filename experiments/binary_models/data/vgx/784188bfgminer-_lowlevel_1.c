bool lowlevel_match_id ( const struct lowlevel_device_info * const info , const struct lowlevel_driver * const lowl , const int32_t vid , const int32_t pid ) { if ( info -> lowl != lowl ) { return false ; } if ( vid != - 1 && vid != info -> vid ) { return false ; } if ( pid != - 1 && pid != info -> pid ) { return false ; } return true ; } struct lowlevel_device_info * info , * tmp ; int found = 0 ; LL_FOREACH_SAFE ( , , ) { LL_DELETE ( devinfo_list , info ) ; ++ found ; } return found ; int _lowlevel_detect ( lowl_found_devinfo_func_t cb , const char * serial , const char * * product_needles , void * const userp ) { DETECT_BEGIN if ( serial && ( ( ! info -> serial ) || strcmp ( serial , info -> serial ) ) ) { continue ; } if ( product_needles [ 0 ] && ! _lowlevel_match_product ( info , product_needles ) ) { continue ; } DETECT_END ; } 