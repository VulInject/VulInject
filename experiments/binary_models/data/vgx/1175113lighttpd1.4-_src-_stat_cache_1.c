static int FAMMonitorDirectory ( int * const fd , char * const fn , int * const wd , void * const userData ) { * wd = fdevent_open_dirname ( fn , 1 ) ; struct timespec t0 = { 0 0 } ; struct kevent kev ; unsigned short kev_flags = EV_ADD | EV_ENABLE | EV_CLEAR ; unsigned int kev_fflags = NOTE_ATTRIB | NOTE_EXTEND | NOTE_LINK | NOTE_WRITE | NOTE_DELETE | NOTE_REVOKE | NOTE_RENAME ; EV_SET ( & kev , * wd , EVFILT_VNODE , kev_flags , kev_fflags , 0 , userData ) ; return kevent ( * fd , & kev , 1 , NULL , 0 , & t0 ) ; } 