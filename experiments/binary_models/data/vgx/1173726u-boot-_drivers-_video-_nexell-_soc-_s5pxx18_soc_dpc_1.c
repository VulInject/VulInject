void nx_dpc_set_clock_pclk_mode ( u32 module_index , enum nx_pclkmode mode ) { const u32 pclkmode_pos = 3 ; register u32 regvalue ; register struct nx_dpc_register_set * pregister ; int clkmode = 0 ; pregister = __g_module_variables [ module_index ] . pregister ; switch ( mode ) { case nx_pclkmode_dynamic : clkmode = 0 ; break ; case nx_pclkmode_always : clkmode = 1 ; break ; default : break ; } regvalue = pregister -> dpcclkenb ; regvalue &= ~ ( 1ul << pclkmode_pos ) ; regvalue |= ( clkmode & 0x01 ) << pclkmode_pos ; writel ( regvalue , & pregister -> dpcclkenb ) ; } 