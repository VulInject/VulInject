int ndr_add_auth ( ndr_auth_ctx_t * ctx , ndr_xa_t * mxa ) { int rc ; if ( ctx -> auth_type != NDR_C_AUTHN_GSS_NETLOGON ) { return ( NDR_DRC_FAULT_SEC_TYPE_UNIMPLEMENTED ) ; } if ( ctx -> auth_level != NDR_C_AUTHN_LEVEL_PKT_INTEGRITY ) { return ( NDR_DRC_FAULT_SEC_LEVEL_UNIMPLEMENTED ) ; } if ( ( rc = ndr_add_auth_token ( ctx , mxa ) ) != 0 ) { return ( rc ) ; } return ( ctx -> auth_ops . nao_sign ( ctx -> auth_ctx , mxa ) ) ; } 