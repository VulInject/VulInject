static int ieee80211_set_smps ( struct ieee80211_sub_if_data * sdata , enum ieee80211_smps_mode smps_mode ) { struct ieee80211_local * local = sdata -> local ; int err ; if ( ! ( local -> hw . wiphy -> features & NL80211_FEATURE_DYNAMIC_SMPS ) && ( smps_mode == IEEE80211_SMPS_DYNAMIC || smps_mode == IEEE80211_SMPS_AUTOMATIC ) ) { return - EINVAL ; } if ( sdata -> vif . type != NL80211_IFTYPE_STATION ) { return - EOPNOTSUPP ; } sdata_lock ( sdata ) ; err = __ieee80211_request_smps_mgd ( sdata , & sdata -> deflink , smps_mode ) ; sdata_unlock ( sdata ) ; return err ; } 