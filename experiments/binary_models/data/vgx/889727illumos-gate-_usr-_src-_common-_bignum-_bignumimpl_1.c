BIG_ERR_CODE big_copy ( BIGNUM * dest , BIGNUM * src ) { BIG_CHUNK_TYPE * newptr ; int i , len ; len = src -> len ; while ( ( len > 1 ) && ( src -> value [ len - 1 ] == 0 ) ) { len -- ; } src -> len = len ; if ( dest -> size < len ) { if ( dest -> malloced == 1 ) { newptr = ( BIG_CHUNK_TYPE * ) big_realloc ( dest -> value , BIGNUM_WORDSIZE * dest -> size , BIGNUM_WORDSIZE * len ) ; } else { newptr = ( BIG_CHUNK_TYPE * ) big_malloc ( BIGNUM_WORDSIZE * len ) ; if ( newptr != NULL ) { dest -> malloced = 1 ; } } dest -> value = newptr ; dest -> size = len ; } dest -> len = len ; dest -> sign = src -> sign ; for ( i = 0 ; i < len ; i ++ ) { dest -> value [ i ] = src -> value [ i ] ; } return ( BIG_OK ) ; } 