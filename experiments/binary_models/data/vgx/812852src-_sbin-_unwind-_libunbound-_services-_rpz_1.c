int rpz_clear ( struct rpz * r ) { local_zones_delete ( r -> local_zones ) ; r -> local_zones = NULL ; local_zones_delete ( r -> nsdname_zones ) ; r -> nsdname_zones = NULL ; respip_set_delete ( r -> respip_set ) ; r -> respip_set = NULL ; rpz_clientip_synthesized_set_delete ( r -> client_set , NULL ) ; r -> client_set = NULL ; rpz_clientip_synthesized_set_delete ( r -> ns_set ) ; r -> ns_set = NULL ; if ( ! ( r -> local_zones = local_zones_create ( ) ) ) { return 0 ; } r -> nsdname_zones = local_zones_create ( ) ; if ( r -> nsdname_zones == NULL ) { return 0 ; } if ( ! ( r -> respip_set = respip_set_create ( ) ) ) { return 0 ; } if ( ! ( r -> client_set = rpz_clientip_synthesized_set_create ( ) ) ) { return 0 ; } if ( ! ( r -> ns_set = rpz_clientip_synthesized_set_create ( ) ) ) { return 0 ; } return 1 ; } 