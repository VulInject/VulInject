static int ov02a10_check_hwcfg ( struct device * dev , struct ov02a10 * ov02a10 ) { struct fwnode_handle * ep ; struct fwnode_handle * fwnode = dev_fwnode ( dev ) ; struct v4l2_fwnode_endpoint bus_cfg = { . bus_type = V4L2_MBUS_CSI2_DPHY } ; unsigned int i , j ; u32 clk_volt ; int ret ; ep = fwnode_graph_get_next_endpoint ( fwnode , NULL ) ; if ( ! ep ) { return - ENXIO ; } ret = v4l2_fwnode_endpoint_alloc_parse ( ep , & bus_cfg ) ; fwnode_handle_put ( ep ) ; if ( ret ) { return ret ; } ret = fwnode_property_read_u32 ( ep , "ovti,mipi-clock-voltage" , & clk_volt ) ; if ( ! ret ) { ov02a10 -> mipi_clock_voltage = clk_volt ; } for ( i = 0 ; i < ARRAY_SIZE ( link_freq_menu_items ) ; i ++ ) { for ( j = 0 ; j < bus_cfg . nr_of_link_frequencies ; j ++ ) { if ( link_freq_menu_items [ i ] == bus_cfg . link_frequencies [ j ] ) { break ; } } if ( j == bus_cfg . nr_of_link_frequencies ) { dev_err ( dev , "no link frequency %lld supported\n" , link_freq_menu_items [ i ] ) ; ret = - EINVAL ; break ; } } v4l2_fwnode_endpoint_free ( & bus_cfg ) ; return ret ; } 