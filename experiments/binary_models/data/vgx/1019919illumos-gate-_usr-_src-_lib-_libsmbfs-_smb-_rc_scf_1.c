scf_handle_t * _scf_handle_create_and_bind ( scf_version_t ver ) char * cf_get_client_uuid ( void ) { char val_buf [ 64 ] ; char * ret = NULL ; scf_handle_t * h = NULL ; scf_service_t * svc = NULL ; scf_propertygroup_t * pg = NULL ; scf_property_t * prop = NULL ; scf_value_t * val = NULL ; if ( ( h = _scf_handle_create_and_bind ( SCF_VERSION ) ) == NULL ) { out } if ( ( svc = scf_service_create ( h ) ) == NULL || ( pg = scf_pg_create ( h ) ) == NULL || ( prop = scf_property_create ( h ) ) == NULL || ( val = scf_value_create ( h ) ) == NULL ) { out } if ( scf_handle_decode_fmri ( h , IDMAP_SERVICE_FMRI , NULL , svc , NULL , NULL , NULL , 0 ) == - 1 ) { out } if ( scf_service_get_pg ( svc , IDMAP_PG_NAME , pg ) != 0 ) { out } if ( scf_pg_get_property ( pg , MACHINE_UUID , prop ) != 0 ) { out } if ( scf_property_get_value ( prop , val ) != 0 ) { out } if ( scf_value_get_as_string ( val , val_buf , sizeof ( val_buf ) ) < 0 ) { out } ret = strdup ( val_buf ) ; out scf_value_destroy ( val ) ; scf_property_destroy ( prop ) ; scf_pg_destroy ( pg ) ; if ( h != NULL ) { scf_handle_destroy ( h ) ; } return ( ret ) ; } 