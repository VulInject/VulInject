static sf_count_t gsm610_read_i ( SF_PRIVATE * psf , int * ptr , sf_count_t len ) { GSM610_PRIVATE * pgsm610 ; BUF_UNION ubuf ; short * sptr ; int k , bufferlen , readcount = 0 , count ; sf_count_t total = 0 ; pgsm610 = ( GSM610_PRIVATE * ) psf -> codec_data ; sptr = ubuf . sbuf ; bufferlen = ARRAY_LEN ( ubuf . sbuf ) ; while ( len > 0 ) { readcount = ( len >= bufferlen ) ?bufferlen : ( int ) len ; count = gsm610_read_block ( psf , pgsm610 , sptr , readcount ) ; for ( k = 0 ; k < readcount ; k ++ ) { ptr [ total + k ] = arith_shift_left ( sptr [ k ] , 16 ) ; } total += count ; len -= readcount ; } return total ; } 