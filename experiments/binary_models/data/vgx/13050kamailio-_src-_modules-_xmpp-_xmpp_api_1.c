int register_xmpp_cb ( int types , xmpp_cb_f f , void * param ) { xmpp_callback_t * it ; if ( _xmpp_cb_list == 0 ) { LM_CRIT ( "null callback list\n" ) ; return E_BUG ; } if ( f == 0 ) { LM_CRIT ( "null callback function\n" ) ; return E_BUG ; } if ( ! ( it = ( xmpp_callback_t * ) shm_malloc ( sizeof ( xmpp_callback_t ) ) ) ) { SHM_MEM_ERROR ; return E_OUT_OF_MEM ; } it -> next = _xmpp_cb_list -> first ; _xmpp_cb_list -> first = it ; _xmpp_cb_list -> types |= types ; it -> cbf = f ; it -> cbp = param ; it -> types = types ; return 1 ; } 