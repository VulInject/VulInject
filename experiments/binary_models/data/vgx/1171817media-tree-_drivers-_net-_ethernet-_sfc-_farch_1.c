int efx_farch_filter_remove_safe ( struct efx_nic * efx , enum efx_filter_priority priority , u32 filter_id ) { struct efx_farch_filter_state * state = efx -> filter_state ; enum efx_farch_filter_table_id table_id ; struct efx_farch_filter_table * table ; unsigned int filter_idx ; struct efx_farch_filter_spec * spec ; int rc ; table_id = efx_farch_filter_id_table_id ( filter_id ) ; if ( ( unsigned int ) table_id >= EFX_FARCH_FILTER_TABLE_COUNT ) { return - ENOENT ; } table = & state -> table [ table_id ] ; filter_idx = efx_farch_filter_id_index ( filter_id ) ; spec = & table -> spec [ filter_idx ] ; spin_lock_bh ( & efx -> filter_lock ) ; rc = efx_farch_filter_remove ( efx , table , filter_idx , priority ) ; spin_unlock_bh ( & efx -> filter_lock ) ; return rc ; } 