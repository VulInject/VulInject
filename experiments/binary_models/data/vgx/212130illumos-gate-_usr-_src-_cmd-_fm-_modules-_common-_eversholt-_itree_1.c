static struct node * tname_dup_to_epname ( struct node * oldepname , struct node * epname ) { struct node * npref , * npend , * np1 , * np2 ; struct node * ret ; int foundmatch = 0 ; if ( epname == NULL ) { return ( NULL ) ; } npend = NULL ; for ( npref = epname ; npref ; npref = npref -> u . name . next ) { if ( npref -> u . name . s == oldepname -> u . name . s ) { for ( np1 = npref , np2 = oldepname ; np1 != NULL && np2 != NULL ; np1 = np1 -> u . name . next , np2 = np2 -> u . name . next ) { if ( np1 -> u . name . s != np2 -> u . name . s ) { break ; } } if ( np2 == NULL ) { foundmatch = 1 ; npend = np1 ; if ( np1 == NULL ) { break ; } } } } if ( foundmatch == 0 ) { return ( tname_dup ( oldepname , CN_DUP ) ) ; } for ( npref = epname ; ! ( npref == NULL || npref == npend ) ; npref = npref -> u . name . next ) { struct node * newnp = newnode ( T_NAME , oldepname -> file , oldepname -> line ) ; newnp -> u . name . t = npref -> u . name . t ; newnp -> u . name . s = npref -> u . name . s ; newnp -> u . name . last = newnp ; newnp -> u . name . it = npref -> u . name . it ; newnp -> u . name . cp = npref -> u . name . cp ; newnp -> u . name . child = newnode ( T_NUM , oldepname -> file , oldepname -> line ) ; if ( npref -> u . name . child == NULL || npref -> u . name . child -> t != T_NUM ) { int childnum ; ASSERT ( npref -> u . name . cp != NULL ) ; config_getcompname ( npref -> u . name . cp , NULL , & childnum ) ; newnp -> u . name . child -> u . ull = childnum ; } else { newnp -> u . name . child -> u . ull = npref -> u . name . child -> u . ull ; } if ( ret == NULL ) { ret = newnp ; } else { ret -> u . name . last -> u . name . next = newnp ; ret -> u . name . last = newnp ; } } return ( ret ) ; } 