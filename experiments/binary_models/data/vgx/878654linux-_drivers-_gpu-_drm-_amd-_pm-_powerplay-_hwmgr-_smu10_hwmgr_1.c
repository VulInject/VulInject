static const unsigned long SMU10_Magic = ( unsigned long ) PHM_Rv_Magic ; static int smu10_display_clock_voltage_request ( struct pp_hwmgr * hwmgr , struct pp_display_clock_request * clock_req ) { struct smu10_hwmgr * smu10_data = ( smu10_hwmgr * ) ( hwmgr -> backend ) ; enum amd_pp_clock_type clk_type = clock_req -> clock_type ; uint32_t clk_freq = clock_req -> clock_freq_in_khz / 1000 ; PPSMC_Msg msg ; switch ( clk_type ) { case amd_pp_dcf_clock : msg = PPSMC_MSG_SetHardMinDcefclkByFreq ; smu10_data -> dcf_actual_hard_min_freq = clk_freq ; break ; case amd_pp_soc_clock : msg = PPSMC_MSG_SetHardMinSocclkByFreq ; break ; case amd_pp_f_clock : if ( clk_freq == smu10_data -> f_actual_hard_min_freq ) { return 0 ; } smu10_data -> f_actual_hard_min_freq = clk_freq ; msg = PPSMC_MSG_SetHardMinFclkByFreq ; break ; default : pr_info ( "[DisplayClockVoltageRequest]Invalid Clock Type!" ) ; return - EINVAL ; } smum_send_msg_to_smc_with_parameter ( hwmgr , msg , clk_freq , NULL ) ; return 0 ; } 