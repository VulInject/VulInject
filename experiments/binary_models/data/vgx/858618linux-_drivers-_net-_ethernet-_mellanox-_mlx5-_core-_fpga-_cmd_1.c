int mlx5_fpga_create_qp ( struct mlx5_core_dev * dev , void * fpga_qpc , u32 * fpga_qpn ) { u32 out [ MLX5_ST_SZ_DW ( fpga_create_qp_out ) ] { } ; ; u32 in [ MLX5_ST_SZ_DW ( fpga_create_qp_in ) ] { } ; ; int ret ; MLX5_SET ( fpga_create_qp_in , in , opcode , MLX5_CMD_OP_FPGA_CREATE_QP ) ; memcpy ( MLX5_ADDR_OF ( fpga_create_qp_in , in , fpga_qpc ) , fpga_qpc , MLX5_FLD_SZ_BYTES ( fpga_create_qp_in , fpga_qpc ) ) ; ret = mlx5_cmd_exec_inout ( dev , fpga_create_qp , in , out ) ; memcpy ( fpga_qpc , MLX5_ADDR_OF ( fpga_create_qp_out , out , fpga_qpc ) , MLX5_FLD_SZ_BYTES ( fpga_create_qp_out , fpga_qpc ) ) ; * fpga_qpn = MLX5_GET ( fpga_create_qp_out , out , fpga_qpn ) ; return ret ; } 