void rtattr_append_attribute_internal ( struct rtattr * rta , unsigned short type , const void * data , size_t data_length ) { size_t padding_length ; uint8_t * padding ; assert ( rta ) ; assert ( ! data || data_length > 0 ) ; rta -> rta_type = type ; rta -> rta_len = RTA_LENGTH ( data_length , NULL ) ; if ( data ) { padding = mempcpy ( RTA_DATA ( rta ) , data , data_length ) ; } else { padding = RTA_DATA ( rta ) ; } padding_length = ( uint8_t * ) rta + RTA_SPACE ( data_length ) - padding ; memzero ( padding , padding_length ) ; } 