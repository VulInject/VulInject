static int SCACTest29 ( void ) { uint8_t buf [ ] "onetwothreefourfivesixseveneightnine" ; ; uint16_t buflen = sizeof ( buf ) - 1 ; Packet * p = NULL ; ThreadVars th_v ; DetectEngineThreadCtx * det_ctx = NULL ; int result = 0 ; memset ( & th_v , 0 , sizeof ( th_v ) ) ; p = UTHBuildPacket ( buf , buflen , IPPROTO_TCP ) ; DetectEngineCtx * de_ctx = DetectEngineCtxInit ( ) ; if ( de_ctx == NULL ) { end } de_ctx -> flags |= DE_QUIET ; de_ctx -> sig_list = SigInit ( de_ctx , "alert tcp any any ->any any " "(content:\"onetwothreefourfivesixseveneightnine\"; sid:1;)" ) ; if ( de_ctx -> sig_list == NULL ) { end } de_ctx -> sig_list -> next = SigInit ( de_ctx , "alert tcp any any ->any any " "(content:\"onetwothreefourfivesixseveneightnine\"; fast_pattern:3,3; sid:2;)" ) ; if ( de_ctx -> sig_list -> next == NULL ) { end } SigGroupBuild ( de_ctx , NULL ) ; DetectEngineThreadCtxInit ( & th_v , ( void * ) de_ctx , ( void * ) & det_ctx ) ; SigMatchSignatures ( & th_v , de_ctx , det_ctx , p ) ; if ( PacketAlertCheck ( p , 1 ) != 1 ) { printf ( "if (PacketAlertCheck(p, 1) != 1) failure\n" ) ; end } if ( PacketAlertCheck ( p , 2 ) != 1 ) { printf ( "if (PacketAlertCheck(p, 1) != 2) failure\n" ) ; end } result = 1 ; end if ( de_ctx != NULL ) { SigGroupCleanup ( de_ctx ) ; SigCleanSignatures ( de_ctx ) ; DetectEngineThreadCtxDeinit ( & th_v , ( void * ) det_ctx ) ; DetectEngineCtxFree ( de_ctx ) ; } UTHFreePackets ( & p , 1 ) ; return result ; } 