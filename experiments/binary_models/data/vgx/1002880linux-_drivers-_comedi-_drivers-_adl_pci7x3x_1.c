static int adl_pci7x3x_asy_cmd ( struct comedi_device * dev , struct comedi_subdevice * s ) { struct adl_pci7x3x_dev_private_data * dev_private = dev -> private ; struct adl_pci7x3x_sd_private_data * sd_priv = s -> private ; unsigned long cpu_flags ; unsigned int int_enab ; if ( s -> index == 2 ) { int_enab = PLX9052_INTCSR_LI1ENAB ; } else { int_enab = PLX9052_INTCSR_LI2ENAB ; } spin_lock_irqsave ( & dev -> spinlock , cpu_flags ) ; dev_private -> int_ctrl |= int_enab ; outl ( dev_private -> int_ctrl , dev_private -> lcr_io_base + PLX9052_INTCSR ) ; spin_unlock_irqrestore ( & dev -> spinlock , cpu_flags ) ; spin_lock_irqsave ( & sd_priv -> subd_slock , cpu_flags ) ; spin_unlock_irqrestore ( & sd_priv -> subd_slock , cpu_flags ) ; return 0 ; } 