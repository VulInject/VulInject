TSK_FS_DIR * tsk_fs_dir_open ( TSK_FS_INFO * a_fs , const char * a_dir ) { TSK_INUM_T inum ; int8_t retval ; TSK_FS_DIR * fs_dir ; TSK_FS_NAME * fs_name ; if ( ( a_fs == NULL ) || ( a_fs -> tag != TSK_FS_INFO_TAG ) ) { tsk_error_set_errno ( TSK_ERR_FS_ARG ) ; tsk_error_set_errstr ( "tsk_fs_dir_open: called with NULL or unallocated structures" ) ; return NULL ; } if ( ( fs_name = tsk_fs_name_alloc ( 128 , 32 ) ) == NULL ) { return NULL ; } retval = tsk_fs_path2inum ( a_fs , a_dir , & inum , fs_name ) ; if ( retval == - 1 ) { return NULL ; } if ( retval == 1 ) { tsk_error_set_errno ( TSK_ERR_FS_ARG ) ; tsk_error_set_errstr ( "tsk_fs_dir_open: path not found: %s" , a_dir ) ; tsk_fs_name_free ( fs_name ) ; return NULL ; } fs_dir = tsk_fs_dir_open_meta ( a_fs , inum ) ; if ( ( fs_dir ) && ( fs_dir -> fs_file ) ) { fs_dir -> fs_file -> name = fs_name ; } return fs_dir ; } 