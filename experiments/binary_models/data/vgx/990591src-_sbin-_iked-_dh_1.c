struct dh_group * group_get ( uint32_t id ) { const struct group_id * p ; struct dh_group * group ; if ( ( p = group_getid ( id ) ) == NULL ) { return ( NULL ) ; } group -> id = id ; group -> spec = p ; switch ( p -> type ) { case GROUP_MODP : group -> init = modp_init ; group -> getlen = modp_getlen ; group -> exchange = modp_create_exchange ; group -> shared = modp_create_shared ; break ; case GROUP_ECP : group -> init = ec_init ; group -> getlen = ec_getlen ; group -> secretlen = ec_secretlen ; group -> exchange = ec_create_exchange ; group -> shared = ec_create_shared ; break ; case GROUP_CURVE25519 : group -> init = ec25519_init ; group -> getlen = ec25519_getlen ; group -> exchange = ec25519_create_exchange ; group -> shared = ec25519_create_shared ; break ; case GROUP_SNTRUP761X25519 : group -> init = kemsx_init ; group -> getlen = kemsx_getlen ; group -> exchange2 = kemsx_create_exchange2 ; group -> shared2 = kemsx_create_shared2 ; break ; default : group_free ( group ) ; return ( NULL ) ; } if ( dh_init ( group ) != 0 ) { group_free ( group ) ; return ( NULL ) ; } return ( group ) ; } 