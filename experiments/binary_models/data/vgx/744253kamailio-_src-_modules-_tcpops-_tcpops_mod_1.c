static int w_tcp_keepalive_enable3 ( sip_msg_t * msg , char * idle , char * cnt , char * intvl ) { int fd ; if ( unlikely ( msg -> rcv . proto != PROTO_TCP && msg -> rcv . proto != PROTO_TLS && msg -> rcv . proto != PROTO_WS && msg -> rcv . proto != PROTO_WSS ) ) { LM_ERR ( "the current message does not come from a TCP connection\n" ) ; return - 1 ; } if ( ! tcpops_get_current_fd ( msg -> rcv . proto_reserved1 , & fd ) ) { return - 1 ; } _IVALUE ( ) _IVALUE ( ) _IVALUE ( ) return tcpops_keepalive_enable ( fd , i_idle , i_cnt , i_intvl , 0 ) ; } 