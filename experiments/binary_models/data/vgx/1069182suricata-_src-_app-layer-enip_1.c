static void ENIPTransactionFree ( ENIPTransaction * tx , ENIPState * state ) { SCEnter ( ) ; SCLogDebug ( "ENIPTransactionFree" ) ; CIPServiceEntry * svc ; while ( ( svc = TAILQ_FIRST ( & tx -> service_list ) ) ) { TAILQ_REMOVE ( & tx -> service_list , svc , next ) ; SegmentEntry * seg = NULL ; while ( ( seg = TAILQ_FIRST ( & svc -> segment_list ) ) ) { TAILQ_REMOVE ( & svc -> segment_list , seg , next ) ; SCFree ( seg ) ; } AttributeEntry * attr = NULL ; while ( ( attr = TAILQ_FIRST ( & svc -> attrib_list ) ) ) { TAILQ_REMOVE ( & svc -> attrib_list , attr , next ) ; SCFree ( attr ) ; } SCFree ( svc ) ; } AppLayerDecoderEventsFreeEvents ( & tx -> tx_data . events ) ; if ( tx -> tx_data . de_state != NULL ) { DetectEngineStateFree ( tx -> tx_data . de_state ) ; state -> tx_with_detect_state_cnt -- ; } if ( state -> iter == tx ) { state -> iter = NULL ; } SCFree ( tx ) ; SCReturn ; } 