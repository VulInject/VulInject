static void sis190_down ( struct net_device * dev ) { struct sis190_private * tp = netdev_priv ( dev ) ; void __iomem * ioaddr = tp -> mmio_addr ; unsigned int poll_locked = 0 ; sis190_delete_timer ( dev ) ; netif_stop_queue ( dev ) ; { spin_lock_irq ( & tp -> lock ) ; sis190_asic_down ( ioaddr , NULL ) ; spin_unlock_irq ( & tp -> lock ) ; synchronize_irq ( tp -> pci_dev -> irq ) ; if ( ! poll_locked ) { poll_locked ++ ; } synchronize_sched ( ) ; } SIS_R32 ( IntrMask ) ; sis190_tx_clear ( tp ) ; sis190_rx_clear ( tp ) ; } 