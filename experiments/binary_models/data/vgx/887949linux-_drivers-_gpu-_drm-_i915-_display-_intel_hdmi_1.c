u32 intel_hdmi_infoframes_enabled ( struct intel_encoder * encoder , const struct intel_crtc_state * crtc_state ) { struct drm_i915_private * dev_priv = to_i915 ( encoder -> base . dev ) ; struct intel_digital_port * dig_port = enc_to_dig_port ( encoder ) ; u32 val , ret = 0 ; int i ; val = dig_port -> infoframes_enabled ( encoder , crtc_state ) ; for ( i = 0 ; i < ARRAY_SIZE ( infoframe_type_to_idx ) ; i ++ ) { int type = infoframe_type_to_idx [ i ] ; if ( HAS_DDI ( dev_priv ) ) { if ( val & hsw_infoframe_enable ( type ) ) { ret |= BIT ( i ) ; } } else { if ( val & g4x_infoframe_enable ( type ) ) { ret |= BIT ( i ) ; } } } return ret ; } 