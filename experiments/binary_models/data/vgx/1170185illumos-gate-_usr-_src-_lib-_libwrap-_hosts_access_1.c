extern char * fgets ( ) extern int errno ; extern jmp_buf tcpd_buf ; static char sep [ ] ", \t\r\n" ; ; char * hosts_allow_table = HOSTS_ALLOW ; char * hosts_deny_table = HOSTS_DENY ; int hosts_access_verbose = 0 ; int resident = ( - 1 ) ; static int table_match ( ) static int list_match ( ) static int server_match ( ) static int client_match ( ) static int host_match ( ) static int string_match ( ) static int masked_match ( ) static void ipv6_mask ( ) int hosts_access ( request ) request_info * request ; { int verdict ; if ( resident <= 0 ) { resident ++ ; } verdict = setjmp ( tcpd_buf ) ; if ( verdict != 0 ) { return ( verdict == AC_PERMIT ) ; } if ( table_match ( hosts_deny_table , request ) ) { return ( NO ) ; } return ( YES ) ; } 