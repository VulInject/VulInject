int svc_format ( char * buf , struct svcfields * entry ) { char * ptr ; char * tmp ; entry -> pmtag = buf ; if ( ( ptr = strchr ( buf , ':' ) ) == NULL ) { return ( BADPMFMT ) ; } * ptr ++ = '\0' ; entry -> pmtype = ptr ; * ptr ++ = '\0' ; entry -> svc_code = ptr ; if ( strcmp ( entry -> pmtype , LISTENTYPE ) != 0 ) { return ( NOTLISTEN ) ; } if ( ( ptr = strchr ( entry -> svc_code , ':' ) ) == NULL ) { return ( BADPMFMT ) ; } * ptr ++ = '\0' ; entry -> flags = ptr ; if ( ( ptr = strchr ( entry -> flags , ':' ) ) == NULL ) { return ( BADPMFMT ) ; } * ptr ++ = '\0' ; entry -> id = ptr ; if ( ( ptr = strchr ( entry -> id , ':' ) ) == NULL ) { return ( BADPMFMT ) ; } * ptr ++ = '\0' ; entry -> res1 = ptr ; if ( ( ptr = strchr ( entry -> res1 , ':' ) ) == NULL ) { return ( BADPMFMT ) ; } * ptr ++ = '\0' ; entry -> res2 = ptr ; if ( ( ptr = strchr ( entry -> res2 , ':' ) ) == NULL ) { return ( BADPMFMT ) ; } * ptr ++ = '\0' ; entry -> res3 = ptr ; if ( ( ptr = strchr ( entry -> res3 , ':' ) ) == NULL ) { return ( BADPMFMT ) ; } * ptr ++ = '\0' ; entry -> addr = ptr ; if ( ( ptr = strchr ( entry -> addr , ':' ) ) == NULL ) { return ( BADLISFMT ) ; } * ptr ++ = '\0' ; entry -> rpc = ptr ; if ( ( ptr = strchr ( entry -> rpc , ':' ) ) == NULL ) { return ( BADLISFMT ) ; } * ptr ++ = '\0' ; if ( * entry -> rpc ) { if ( ( tmp = strchr ( entry -> rpc , ',' ) ) == NULL ) { return ( BADLISFMT ) ; } * tmp = ':' ; } entry -> lflags = ptr ; if ( ( ptr = strchr ( entry -> lflags , ':' ) ) == NULL ) { return ( BADLISFMT ) ; } * ptr ++ = '\0' ; entry -> modules = ptr ; if ( ( ptr = strchr ( entry -> modules , ':' ) ) == NULL ) { return ( BADLISFMT ) ; } * ptr ++ = '\0' ; entry -> command = ptr ; if ( ( ptr = strchr ( entry -> command , '#' ) ) == NULL ) { return ( BADLISFMT ) ; } * ptr ++ = '\0' ; entry -> comment = ptr ; return ( NLS_OK ) ; } 