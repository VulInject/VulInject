static krb5_error_code an2ln_rule ( krb5_context context , krb5_localauth_moddata data , const char * type , const char * rule , krb5_const_principal aname , char * * lname_out ) { krb5_error_code ret ; const char * current ; char * selstring = NULL ; * lname_out = NULL ; if ( rule == NULL ) { return KRB5_CONFIG_BADFORMAT ; } current = rule ; ret = aname_get_selstring ( context , aname , & current , & selstring ) ; if ( ret ) { return ret ; } if ( * current == '(' ) { ret = aname_do_match ( selstring , & current ) ; if ( ret ) { cleanup } } ret = aname_replacer ( selstring , & current , lname_out ) ; cleanup return ret ; } 