static int __ip6addrlbl_del ( struct net * net , const struct in6_addr * prefix , int prefixlen , int ifindex ) { struct ip6addrlbl_entry * p = NULL ; struct hlist_node * n ; int ret = - ESRCH ; ADDRLABEL ( KERN_DEBUG "%s(prefix=%pI6, prefixlen=%d, ifindex=%d)\n" , __func__ , prefix , prefixlen , ifindex ) ; hlist_for_each_entry_safe ( , , , ) { if ( p -> prefixlen == prefixlen && net_eq ( ip6addrlbl_net ( p ) , net ) && p -> ifindex == ifindex && ipv6_addr_equal ( & p -> prefix , prefix ) ) { hlist_del_rcu ( & p -> list ) ; ip6addrlbl_put ( p ) ; break ; } } return ret ; } 