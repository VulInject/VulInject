int generator_write_device_deps ( const char * dir , const char * what , const char * where , const char * opts ) { _cleanup_free_ char * node = NULL , * unit = NULL ; int r ; if ( fstab_is_extrinsic ( where , opts ) ) { return 0 ; } if ( ! fstab_test_option ( opts , "_netdev\0" ) ) { return 0 ; } node = fstab_node_to_udev_node ( what ) ; if ( ! node ) { return log_oom ( ) ; } r = unit_name_from_path ( node , ".device" , & unit ) ; if ( r < 0 ) { return log_error_errno ( r , "Failed to make unit name from path \"%s\": %m" , node ) ; } return write_drop_in_format ( dir , unit , 50 , "netdev-dependencies" , "# Automatically generated by %s\n\n" "[Unit]\n" "After=" SPECIAL_NETWORK_ONLINE_TARGET " " SPECIAL_NETWORK_TARGET "\n" "Wants=" SPECIAL_NETWORK_ONLINE_TARGET "\n" , program_invocation_short_name ) ; } 