void cpuidle_cooling_register ( struct cpuidle_driver * drv ) { struct device_node * cooling_node ; struct device_node * cpu_node ; int cpu , ret ; for_each_cpu ( , ) { cpu_node = of_cpu_device_node_get ( cpu ) ; cooling_node = of_get_child_by_name ( cpu_node , "thermal-idle" ) ; of_node_put ( cpu_node , NULL ) ; if ( ! cooling_node ) { pr_debug ( "'thermal-idle' node not found for cpu%d\n" , cpu ) ; continue ; } ret = __cpuidle_cooling_register ( cooling_node , drv ) ; of_node_put ( cooling_node ) ; if ( ret ) { pr_err ( "Failed to register the cpuidle cooling device" "for cpu%d: %d\n" , cpu , ret ) ; break ; } } } 