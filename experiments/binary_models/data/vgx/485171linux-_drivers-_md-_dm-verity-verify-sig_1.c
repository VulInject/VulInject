int verity_verify_sig_parse_opt_args ( struct dm_arg_set * as , struct dm_verity * v , struct dm_verity_sig_opts * sig_opts , unsigned int * argc , const char * arg_name ) { struct dm_target * ti = v -> ti ; int ret = 0 ; const char * sig_key = NULL ; if ( ! * argc ) { ti -> error = DM_VERITY_VERIFY_ERR ( "Signature key not specified" ) ; return - EINVAL ; } sig_key = dm_shift_arg ( as ) ; ( * argc ) -- ; ret = verity_verify_get_sig_from_key ( sig_key , sig_opts ) ; if ( ret < 0 ) { ti -> error = DM_VERITY_VERIFY_ERR ( "Invalid key specified" ) ; } v -> signature_key_desc = kstrdup ( sig_key , GFP_KERNEL ) ; return ret ; } 