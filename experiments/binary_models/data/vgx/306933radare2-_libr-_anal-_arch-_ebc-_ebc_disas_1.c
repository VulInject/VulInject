static int decode_jmp ( const ut8 * bytes , ebc_command_t * cmd ) { int ret ; int bits = 32 ; char op1 [ 32 ] { 0 } ; ; int immed32 ; ebc_index_t idx32 ; char sign ; unsigned long immed ; snprintf ( cmd -> instr , EBC_INSTR_MAXLEN , "%s%d%s" , instr_names [ EBC_JMP ] , bits , TEST_BIT ( bytes [ 1 ] , 7 ) ?TEST_BIT ( bytes [ 1 ] , 6 ) ?"cs" : "cc" else "" ) ; if ( TEST_BIT ( bytes [ 0 ] , 6 ) ) { immed = * ( ut64 * ) ( bytes + 2 ) ; bits = 64 ; ret = 10 ; snprintf ( cmd -> operands , EBC_OPERANDS_MAXLEN , "0x%lx" , immed ) ; } else { if ( ( bytes [ 1 ] & 0x7 ) != 0 ) { { snprintf ( op1 , sizeof ( op1 ) , "%sr%u " , TEST_BIT ( bytes [ 1 ] , 3 ) ?"@" : "" , bytes [ 1 ] & 0x7 ) ; } } if ( TEST_BIT ( bytes [ 0 ] , 7 ) ) { if ( TEST_BIT ( bytes [ 1 ] , 3 ) ) { decode_index32 ( bytes + 2 , & idx32 ) ; sign = idx32 . sign ?'+' : '-' ; CHK_SNPRINTF ( cmd -> operands , EBC_OPERANDS_MAXLEN , "%s(%c%u, %c%u)" , op1 , sign , idx32 . n , sign , idx32 . c ) ; } else { immed32 = * ( int32_t * ) ( bytes + 2 ) ; CHK_SNPRINTF ( cmd -> operands , EBC_OPERANDS_MAXLEN , "%s0x%x" , op1 , immed32 ) ; } ret = 6 ; } else { snprintf ( cmd -> operands , EBC_OPERANDS_MAXLEN , "%s" , op1 ) ; ret = 2 ; } } return ret ; } 