module_param_array ( mode , charp , NULL , 0 ) ; MODULE_PARM_DESC ( mode , "baycom operating mode; * for software DCD" ) ; module_param_hw_array ( iobase , int , ioport , NULL , 0 ) ; MODULE_PARM_DESC ( iobase , "baycom io base address" ) ; module_param_hw_array ( irq , int , irq , NULL , 0 ) ; MODULE_PARM_DESC ( irq , "baycom irq number" ) ; MODULE_AUTHOR ( "Thomas M. Sailer, sailer@ife.ee.ethz.ch, hb9jnx@hb9w.che.eu" ) ; MODULE_DESCRIPTION ( "Baycom ser12 half duplex amateur radio modem driver" ) ; MODULE_LICENSE ( "GPL" ) ; static int __init init_baycomserhdx ( void ) { int i , found = 0 ; char set_hw = 1 ; printk ( bc_drvinfo ) ; for ( i = 0 ; i < NR_PORTS ; i ++ ) { struct net_device * dev ; struct baycom_state * bc ; char ifname [ IFNAMSIZ ] ; sprintf ( ifname , "bcsh%d" , i ) ; if ( ! mode [ i ] ) { set_hw = 0 ; } if ( ! set_hw ) { iobase [ i ] = irq [ i ] = 0 ; } dev = hdlcdrv_register ( & ser12_ops , sizeof ( baycom_state ) , ifname , iobase [ i ] , irq [ i ] , 0 ) ; if ( IS_ERR ( dev ) ) { break ; } bc = netdev_priv ( dev ) ; if ( set_hw && baycom_setmode ( bc , mode [ i ] ) ) { set_hw = 0 ; } found ++ ; baycom_device [ i ] = dev ; } return 0 ; } 