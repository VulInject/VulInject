static int xdb_get_request ( xdb_t * vdp , blkif_request_t * req ) { void * src = xvdi_ring_get_request ( vdp -> xs_ring ) ; switch ( vdp -> xs_blk_protocol ) { case BLKIF_PROTOCOL_NATIVE : ( void ) memcpy ( req , src , sizeof ( * req ) ) ; break ; case BLKIF_PROTOCOL_X86_32 : blkif_get_x86_32_req ( req , src ) ; break ; case BLKIF_PROTOCOL_X86_64 : blkif_get_x86_64_req ( req , src ) ; break ; default : cmn_err ( CE_PANIC , "xdb@%s: unrecognised protocol: %d" , ddi_get_name_addr ( vdp -> xs_dip ) , vdp -> xs_blk_protocol ) ; } return ( 1 ) ; } 