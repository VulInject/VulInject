static int stm32_counter_validate_trigger ( struct iio_dev * indio_dev , struct iio_trigger * trig ) { struct stm32_timer_trigger * priv = iio_priv ( indio_dev ) ; const char * const * cur = priv -> valids ; int i = 0 ; if ( ! is_stm32_timer_trigger ( trig ) ) { return - EINVAL ; } while ( cur && * cur ) { if ( ! strncmp ( trig -> name , * cur , strlen ( trig -> name ) ) ) { regmap_update_bits ( priv -> regmap , TIM_SMCR , TIM_SMCR_TS , i << TIM_SMCR_TS_SHIFT ) ; return 0 ; } cur ++ ; i ++ ; } return - EINVAL ; } 