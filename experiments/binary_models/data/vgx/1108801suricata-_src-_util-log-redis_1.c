static SCLogRedisContext * SCLogRedisContextAsyncAlloc ( void ) { SCLogRedisContext * ctx = ( SCLogRedisContext * ) SCCalloc ( 1 , sizeof ( SCLogRedisContext ) ) ; if ( unlikely ( ctx == NULL ) ) { FatalError ( "Unable to allocate redis context" ) ; } ctx -> async = NULL ; ctx -> ev_base = NULL ; ctx -> connected = 0 ; ctx -> batch_count = 0 ; ctx -> last_push = 0 ; ctx -> tried = 0 ; return ctx ; } 