static void acpi_tb_convert_fadt ( void ) { const char * name ; struct acpi_generic_address * address64 ; u32 address32 ; u8 length ; u8 flags ; u32 i ; if ( acpi_gbl_FADT . header . length <= ACPI_FADT_V2_SIZE ) { acpi_gbl_FADT . preferred_profile = 0 ; acpi_gbl_FADT . pstate_control = 0 ; acpi_gbl_FADT . cst_control = 0 ; } acpi_gbl_FADT . header . length = sizeof ( acpi_table_fadt ) ; acpi_gbl_FADT . Xdsdt = acpi_tb_select_address ( "DSDT" , acpi_gbl_FADT . dsdt , acpi_gbl_FADT . Xdsdt ) ; if ( acpi_gbl_reduced_hardware ) { return ; } for ( i = 0 ; i < ACPI_FADT_INFO_ENTRIES ; i ++ ) { address32 = * ACPI_ADD_PTR ( u32 , & acpi_gbl_FADT , fadt_info_table [ i ] . address32 ) ; address64 = ACPI_ADD_PTR ( acpi_generic_address , & acpi_gbl_FADT , fadt_info_table [ i ] . address64 ) ; length = * ACPI_ADD_PTR ( u8 , & acpi_gbl_FADT , fadt_info_table [ i ] . length ) ; name = fadt_info_table [ i ] . name ; flags = fadt_info_table [ i ] . flags ; if ( address32 ) { if ( address64 -> address ) { if ( address64 -> address != ( u64 ) address32 ) { ACPI_BIOS_WARNING ( ( AE_INFO , "32/64X address mismatch in FADT/%s: " "0x%8.8X/0x%8.8X%8.8X, using %u-bit address" , name , address32 , ACPI_FORMAT_UINT64 ( address64 -> address ) , acpi_gbl_use32_bit_fadt_addresses ?32 : 64 ) ) ; } if ( ( ACPI_MUL_8 ( length ) <= ACPI_UINT8_MAX ) && ( address64 -> bit_width != ACPI_MUL_8 ( length ) ) ) { ACPI_BIOS_WARNING ( ( AE_INFO , "32/64X length mismatch in FADT/%s: %u/%u" , name , ACPI_MUL_8 ( length ) , address64 -> bit_width ) ) ; } } if ( ! address64 -> address || acpi_gbl_use32_bit_fadt_addresses ) { acpi_tb_init_generic_address ( address64 , ACPI_ADR_SPACE_SYSTEM_IO , length , ( u64 ) address32 , name , flags ) ; } } if ( fadt_info_table [ i ] . flags & ACPI_FADT_REQUIRED ) { if ( ! address64 -> address || ! length ) { ACPI_BIOS_ERROR ( ( AE_INFO , "Required FADT field %s has zero address and/or length: " "0x%8.8X%8.8X/0x%X" , name , ACPI_FORMAT_UINT64 ( address64 -> address ) , length ) ) ; } } if ( fadt_info_table [ i ] . flags & ACPI_FADT_SEPARATE_LENGTH ) { if ( ( address64 -> address && ! length ) || ( ! address64 -> address && length ) ) { ACPI_BIOS_WARNING ( ( AE_INFO , "Optional FADT field %s has valid %s but zero %s: " "0x%8.8X%8.8X/0x%X" , name , ( length ?"Length" : "Address" ) , ( length ?"Address" : "Length" ) , ACPI_FORMAT_UINT64 ( address64 -> address ) , length ) ) ; } } } } 