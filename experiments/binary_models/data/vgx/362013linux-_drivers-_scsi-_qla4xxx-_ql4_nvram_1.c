int qla4xxx_is_nvram_configuration_valid ( struct scsi_qla_host * ha ) { int status = QLA_ERROR ; uint16_t checksum = 0 ; uint32_t index ; cfs_time_t flags ; spin_lock_irqsave ( & ha -> hardware_lock , flags ) ; for ( index = 0 ; index < eeprom_size ( ha ) ; index ++ ) { checksum += rd_nvram_word ( ha , index ) ; } spin_unlock_irqrestore ( & ha -> hardware_lock , flags ) ; if ( checksum == 0 ) { status = QLA_SUCCESS ; } return status ; } 