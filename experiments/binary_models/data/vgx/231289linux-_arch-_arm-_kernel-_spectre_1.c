ssize_t cpu_show_spectre_v2 ( struct device * dev , struct device_attribute * attr , char * buf ) { const char * method ; if ( spectre_v2_state == SPECTRE_UNAFFECTED ) { return sprintf ( buf , "%s\n" , "Not affected" ) ; } if ( _unprivileged_ebpf_enabled ( ) ) { return sprintf ( buf , "Vulnerable: Unprivileged eBPF enabled\n" ) ; } switch ( spectre_v2_methods ) { case SPECTRE_V2_METHOD_BPIALL : method = "Branch predictor hardening" ; break ; case SPECTRE_V2_METHOD_ICIALLU : method = "I-cache invalidation" ; break ; case SPECTRE_V2_METHOD_SMC : case SPECTRE_V2_METHOD_HVC : method = "Firmware call" ; break ; case SPECTRE_V2_METHOD_LOOP8 : method = "History overwrite" ; break ; default : method = "Multiple mitigations" ; break ; } return sprintf ( buf , "Mitigation: %s\n" , method ) ; } 