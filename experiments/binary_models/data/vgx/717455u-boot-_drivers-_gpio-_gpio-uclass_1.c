int dm_gpio_lookup_name ( const char * name , struct gpio_desc * desc ) { struct gpio_dev_priv * uc_priv = NULL ; struct udevice * dev ; ulong offset ; int numeric ; numeric = isdigit ( * name ) ?dectoul ( name , NULL ) : - 1 ; for ( uclass_first_device ( UCLASS_GPIO , & dev ) ; dev ; uclass_next_device ( & dev ) ) { int len ; uc_priv = dev_get_uclass_priv ( dev ) ; if ( numeric != - 1 ) { offset = numeric - uc_priv -> gpio_base ; if ( offset < uc_priv -> gpio_count ) { break ; } } len = uc_priv -> bank_name ?strlen ( uc_priv -> bank_name ) : 0 ; if ( ! strncasecmp ( name , uc_priv -> bank_name , len ) ) { if ( ! strict_strtoul ( name + len , 10 , & offset ) ) { if ( offset < uc_priv -> gpio_count ) { break ; } } } if ( ! dm_gpio_lookup_label ( name , uc_priv , & offset ) ) { break ; } } gpio_desc_init ( desc , dev , offset ) ; return 0 ; } 