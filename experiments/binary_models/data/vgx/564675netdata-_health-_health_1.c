static void health_silencers_init ( void ) { FILE * fd = fopen ( silencers_filename , "r" ) ; if ( fd ) { fseek ( fd , 0 , SEEK_END ) ; off_t length = ( off_t ) ftell ( fd ) ; fseek ( fd , 0 , SEEK_SET ) ; if ( length > 0 && length < HEALTH_SILENCERS_MAX_FILE_LEN ) { char * str = mallocz ( ( length + 1 ) * sizeof ( char ) ) ; if ( str ) { size_t copied ; copied = fread ( str , sizeof ( char ) , length , fd ) ; if ( copied == ( length * sizeof ( char ) ) ) { str [ length ] = 0x00 ; json_parse ( str , health_silencers_json_read_callback ) ; info ( "Parsed health silencers file %s" , silencers_filename ) ; } else { error ( "Cannot read the data from health silencers file %s" , silencers_filename ) ; } freez ( str ) ; } } else { error ( "Health silencers file %s has the size %" PRId64 " that is out of range[ 1 , %d ]. Aborting read." , silencers_filename , ( int64_t ) length , HEALTH_SILENCERS_MAX_FILE_LEN ) ; } fclose ( fd ) ; } else { info ( "Cannot open the file %s, so Netdata will work with the default health configuration." , silencers_filename ) ; } } 