mDNSlocal mStatus handle_client_request ( request_state * req ) { mStatus err = mStatus_NoError ; SetupAuditTokenForRequest ( req ) ; switch ( req -> hdr . op ) { case connection_request : LogRedact ( MDNS_LOG_CATEGORY_DEFAULT , MDNS_LOG_INFO , "[R%d] DNSServiceCreateConnection START PID[%d](" PUB_S ")" , req -> request_id , req -> process_id , req -> pid_name ) ; req -> terminate = connection_termination ; break ; case connection_delegate_request : LogRedact ( MDNS_LOG_CATEGORY_DEFAULT , MDNS_LOG_INFO , "[R%d] DNSServiceCreateDelegateConnection START PID[%d](" PRI_S ")" , req -> request_id , req -> process_id , req -> pid_name ) ; req -> terminate = connection_termination ; handle_connection_delegate_request ( req ) ; break ; case resolve_request : err = handle_resolve_request ( req ) ; break ; case query_request : err = handle_queryrecord_request ( req ) ; break ; case browse_request : err = handle_browse_request ( req ) ; break ; case reg_service_request : err = handle_regservice_request ( req ) ; break ; case enumeration_request : err = handle_enum_request ( req ) ; break ; case reconfirm_record_request : err = handle_reconfirm_request ( req ) ; break ; case setdomain_request : err = handle_setdomain_request ( req ) ; break ; case getproperty_request : handle_getproperty_request ( req , NULL ) ; break ; case port_mapping_request : err = handle_port_mapping_request ( req ) ; break ; case addrinfo_request : err = handle_addrinfo_request ( req ) ; break ; case send_bpf : break ; case reg_record_request : err = handle_regrecord_request ( req ) ; break ; case add_record_request : err = handle_add_request ( req ) ; break ; case update_record_request : err = handle_update_request ( req ) ; break ; case remove_record_request : err = handle_removerecord_request ( req ) ; break ; case cancel_request : handle_cancel_request ( req ) ; break ; case release_request : err = handle_release_request ( req ) ; break ; default : LogMsg ( "request_callback: %3d:ERROR: Unsupported UDS req:%d PID[%d][%s]" , req -> sd , req -> hdr . op , req -> process_id , req -> pid_name ) ; err = mStatus_BadParamErr ; break ; } return err ; } 