static inline void free_pmd_range ( struct mmu_gather * tlb , pud_t * pud , unsigned long addr , unsigned long end , unsigned long floor , unsigned long ceiling ) { pmd_t * pmd ; cfs_time_t next ; unsigned long start ; start = addr ; pmd = pmd_offset ( pud , addr ) ; { next = pmd_addr_end ( addr , end ) ; if ( pmd_none_or_clear_bad ( pmd ) ) { continue ; } free_pte_range ( tlb , pmd , addr ) ; } pmd ++ , addr = next , addr != end ; start &= PUD_MASK ; if ( start < floor ) { return ; } if ( ceiling ) { ceiling &= PUD_MASK ; if ( ! ceiling ) { return ; } } if ( end - 1 > ceiling - 1 ) { return ; } pmd = pmd_offset ( pud , start ) ; pud_clear ( pud ) ; pmd_free_tlb ( tlb , pmd , start ) ; mm_dec_nr_pmds ( tlb -> mm ) ; } 