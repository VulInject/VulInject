static acpi_status acpi_ut_remove_allocation ( struct acpi_debug_mem_block * allocation , u32 component , const char * module , u32 line ) { struct acpi_memory_list * mem_list ; acpi_status status ; ACPI_FUNCTION_NAME ( ut_remove_allocation ) ; mem_list = acpi_gbl_global_list ; if ( NULL == mem_list -> list_head ) { ACPI_ERROR ( ( module , line , "Empty allocation list, nothing to free!" ) ) ; return ( AE_OK ) ; } status = acpi_ut_acquire_mutex ( ACPI_MTX_MEMORY ) ; if ( ACPI_FAILURE ( status ) ) { return ( status ) ; } if ( allocation -> previous ) { ( allocation -> previous ) -> next = allocation -> next ; } else { mem_list -> list_head = allocation -> next ; } if ( allocation -> next ) { ( allocation -> next ) -> previous = allocation -> previous ; } ACPI_DEBUG_PRINT ( ( ACPI_DB_ALLOCATIONS , "Freeing %p, size 0%X\n" , & allocation -> user_space , allocation -> size ) ) ; memset ( & allocation -> user_space , 0xEA , allocation -> size ) ; status = acpi_ut_release_mutex ( ACPI_MTX_MEMORY ) ; return ( status ) ; } 