static VAR1 FUN1(HANDLE VAR2, LPCSTR VAR3, int VAR4)
{
BOOL VAR5;
DWORD VAR6;
LUID VAR7;
TOKEN_PRIVILEGES VAR8;
TOKEN_PRIVILEGES VAR9;

VAR6 = 16;
VAR5 = FUN2(0, VAR3, &VAR7);
if (VAR5) {
VAR9.VAR10 = 1;
VAR9.VAR11[0].VAR12 = VAR7;
VAR9.VAR11[0].VAR13 = 0;
VAR5 = FUN3(VAR2, 0, &VAR9,
(VAR14)((VAR15)&(VAR9.VAR11[1]) - (VAR15)&VAR9),
&VAR8, &VAR6);
if (VAR5) {
VAR8.VAR10 = 1;
VAR8.VAR11[0].VAR12 = VAR7;
VAR8.VAR11[0].VAR13 = VAR4 != 0 ? 2 : 0;
VAR5 = FUN3(VAR2, 0, &VAR8,
VAR6, 0, 0);
}
}
return VAR5;
}