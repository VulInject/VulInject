int compat_open ( const char * filename , int flags ) { int ret ; wchar_t * frag = NULL ; frag = u2wlongpath ( filename ) ; if ( ! frag ) { open_fallback } ret = _wopen ( frag , flags | _O_BINARY , _S_IREAD | _S_IWRITE ) ; if ( ret != - 1 ) { open_ok } open_fallback ret = _open ( filename , flags | _O_BINARY , _S_IREAD | _S_IWRITE ) ; ret = open ( filename , flags , S_IRUSR | S_IWUSR | S_IRGRP | S_IWGRP | S_IROTH | S_IWOTH ) ; open_ok return ret ; } 