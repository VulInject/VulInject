static TmEcode LogTlsStoreLogThreadInit ( ThreadVars * t , const void * initdata , void * * data ) { LogTlsStoreLogThread * aft = SCMalloc ( sizeof ( LogTlsStoreLogThread ) ) ; memset ( aft , 0 , sizeof ( LogTlsStoreLogThread ) ) ; if ( initdata == NULL ) { SCLogDebug ( "Error getting context for LogTLSStore. \"initdata\" argument NULL" ) ; SCFree ( aft ) ; return TM_ECODE_FAILED ; } struct stat stat_buf ; if ( stat ( tls_logfile_base_dir , & stat_buf ) != 0 ) { int ret ; ret = SCMkDir ( tls_logfile_base_dir , S_IRWXU | S_IXGRP | S_IRGRP ) ; if ( ret != 0 ) { int err = errno ; if ( err != EEXIST ) { SCLogError ( "Cannot create certs drop directory %s: %s" , tls_logfile_base_dir , strerror ( err ) ) ; exit ( EXIT_FAILURE ) ; } } else { SCLogInfo ( "Created certs drop directory %s" , tls_logfile_base_dir ) ; } } * data = ( void * ) aft ; return TM_ECODE_OK ; } 