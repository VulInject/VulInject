PG_FUNCTION_INFO_V1 ( euc_jis_2004_to_utf8 ) ; PG_FUNCTION_INFO_V1 ( utf8_to_euc_jis_2004 ) ; Datum euc_jis_2004_to_utf8 ( PG_FUNCTION_ARGS ) { unsigned char * src = ( unsigned char * ) PG_GETARG_CSTRING ( 2 ) ; unsigned char * dest = ( unsigned char * ) PG_GETARG_CSTRING ( 3 ) ; int len = PG_GETARG_INT32 ( 4 ) ; bool noError = PG_GETARG_BOOL ( 5 ) ; int converted ; CHECK_ENCODING_CONVERSION_ARGS ( PG_EUC_JIS_2004 , PG_UTF8 ) ; converted = LocalToUtf ( src , len , dest , & euc_jis_2004_to_unicode_tree , LUmapEUC_JIS_2004_combined , lengthof ( LUmapEUC_JIS_2004_combined ) , NULL , PG_EUC_JIS_2004 , noError ) ; PG_RETURN_INT32 ( converted , NULL ) ; } 