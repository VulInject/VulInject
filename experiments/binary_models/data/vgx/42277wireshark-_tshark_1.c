static void list_read_capture_types ( void ) { guint i ; size_t num_file_types ; struct string_elem * captypes ; GSList * list = NULL ; const char * magic = "Magic-value-based" ; const char * heuristic = "Heuristics-based" ; num_file_types = 0 ; for ( i = 0 ; open_routines [ i ] . name != NULL ; i ++ ) { num_file_types ++ ; } captypes = g_new ( string_elem , num_file_types ) ; fprintf ( stderr , "tshark: The available read file types for the \"-X read_format:\" option are:\n" ) ; for ( i = 0 ; i < num_file_types && open_routines [ i ] . name != NULL ; i ++ ) { captypes [ i ] . sstr = open_routines [ i ] . name ; captypes [ i ] . lstr = ( open_routines [ i ] . type == OPEN_INFO_MAGIC ) ?magic : heuristic ; list = g_slist_insert_sorted ( list , & captypes [ i ] , string_compare ) ; } g_slist_free_full ( list , string_elem_print ) ; } 