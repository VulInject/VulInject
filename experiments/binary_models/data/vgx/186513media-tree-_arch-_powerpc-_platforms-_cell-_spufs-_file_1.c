static ssize_t __spufs_proxydma_info_read ( struct spu_context * ctx , char __user * buf , size_t len , loff_t * pos ) { struct spu_proxydma_info info ; struct mfc_cq_sr * qp , * puqp ; int ret = sizeof info ; int i ; if ( len < ret ) { return - EINVAL ; } info . proxydma_info_type = ctx -> csa . prob . dma_querytype_RW ; info . proxydma_info_mask = ctx -> csa . prob . dma_querymask_RW ; info . proxydma_info_status = ctx -> csa . prob . dma_tagstatus_R ; for ( i = 0 ; i < 8 ; i ++ ) { qp = & info . proxydma_info_command_data [ i ] ; puqp = & ctx -> csa . priv2 . puq [ i ] ; qp -> mfc_cq_data0_RW = puqp -> mfc_cq_data0_RW ; qp -> mfc_cq_data1_RW = puqp -> mfc_cq_data1_RW ; qp -> mfc_cq_data2_RW = puqp -> mfc_cq_data2_RW ; qp -> mfc_cq_data3_RW = puqp -> mfc_cq_data3_RW ; } return simple_read_from_buffer ( buf , len , pos , & info , sizeof info ) ; } 