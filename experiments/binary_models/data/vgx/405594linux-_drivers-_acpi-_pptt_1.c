int find_acpi_cpu_topology_cluster ( unsigned int cpu ) { struct acpi_table_header * table ; struct acpi_pptt_processor * cpu_node , * cluster_node ; u32 acpi_cpu_id ; int retval ; int is_thread ; table = acpi_get_pptt ( ) ; if ( ! table ) { return - ENOENT ; } acpi_cpu_id = get_acpi_id_for_cpu ( cpu ) ; cpu_node = acpi_find_processor_node ( table , acpi_cpu_id ) ; if ( ! cpu_node || ! cpu_node -> parent ) { return - ENOENT ; } is_thread = cpu_node -> flags & ACPI_PPTT_ACPI_PROCESSOR_IS_THREAD ; cluster_node = fetch_pptt_node ( table , cpu_node -> parent ) ; if ( ! cluster_node ) { return - ENOENT ; } if ( is_thread ) { cluster_node = fetch_pptt_node ( table , cluster_node -> parent ) ; if ( ! cluster_node ) { return - ENOENT ; } } if ( cluster_node -> flags & ACPI_PPTT_ACPI_PROCESSOR_ID_VALID ) { retval = cluster_node -> acpi_processor_id ; } else { retval = ACPI_PTR_DIFF ( cluster_node , table ) ; } return retval ; } 