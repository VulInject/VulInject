static int check_header ( struct z_file * zf ) { int method ; int flags ; uInt len ; int c ; zf -> zf_dataoffset = 0 ; for ( len = 0 ; len < 2 ; len ++ ) { c = get_byte ( zf , & zf -> zf_dataoffset ) ; } method = get_byte ( zf , & zf -> zf_dataoffset ) ; flags = get_byte ( zf , & zf -> zf_dataoffset ) ; if ( method != Z_DEFLATED || ( flags & RESERVED ) != 0 ) { return ( 1 ) ; } for ( len = 0 ; len < 6 ; len ++ ) { ( void ) get_byte ( zf , & zf -> zf_dataoffset ) ; } if ( ( flags & EXTRA_FIELD ) != 0 ) { len = ( uInt ) get_byte ( zf , & zf -> zf_dataoffset ) ; len += ( ( uInt ) get_byte ( zf , & zf -> zf_dataoffset ) ) << 8 ; while ( len -- != 0 && get_byte ( zf , & zf -> zf_dataoffset ) != - 1 ) { } } if ( ( flags & ORIG_NAME ) != 0 ) { while ( ( c = get_byte ( zf , & zf -> zf_dataoffset ) ) != 0 && c != - 1 ) { } } if ( ( flags & COMMENT ) != 0 ) { while ( ( c = get_byte ( zf , & zf -> zf_dataoffset ) ) != 0 && c != - 1 ) { } } if ( ( flags & HEAD_CRC ) != 0 ) { for ( len = 0 ; len < 2 ; len ++ ) { c = get_byte ( zf , & zf -> zf_dataoffset ) ; } } return ( ( c == - 1 ) ?1 : 0 ) ; } 