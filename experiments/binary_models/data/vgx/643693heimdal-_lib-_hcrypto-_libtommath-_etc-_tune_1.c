static uint64_t s_time_mul ( int size ) { int x ; mp_err e ; mp_int a , b , c , d ; uint64_t t1 ; if ( ( e = mp_init_multi ( & a , & b , & c , & d , NULL ) ) != MP_OKAY ) { t1 = UINT64_MAX ; LTM_ERR } if ( ( e = mp_rand ( & a , size * s_offset ) ) != MP_OKAY ) { t1 = UINT64_MAX ; LTM_ERR } if ( ( e = mp_rand ( & b , size ) ) != MP_OKAY ) { t1 = UINT64_MAX ; LTM_ERR } s_timer_start ( ) ; for ( x = 0 ; x < s_number_of_test_loops ; x ++ ) { if ( ( e = mp_mul ( & a , & b , & c ) ) != MP_OKAY ) { t1 = UINT64_MAX ; LTM_ERR } if ( s_check_result == 1 ) { if ( ( e = s_mp_mul ( & a , & b , & d ) ) != MP_OKAY ) { t1 = UINT64_MAX ; LTM_ERR } if ( mp_cmp ( & c , & d ) != MP_EQ ) { t1 = 0uLL ; LTM_ERR } } } t1 = s_timer_stop ( ) ; LTM_ERR mp_clear_multi ( & a , & b , & c , & d ) ; return t1 ; } 