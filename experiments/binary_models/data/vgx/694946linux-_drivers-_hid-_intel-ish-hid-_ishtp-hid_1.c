static int ishtp_wait_for_response ( struct hid_device * hid ) { struct ishtp_hid_data * hid_data = hid -> driver_data ; int rv ; hid_ishtp_trace ( client_data , "%s hid %p\n" , __func__ , hid ) ; rv = ishtp_hid_link_ready_wait ( hid_data -> client_data ) ; if ( ! hid_data -> request_done ) { wait_event_interruptible_timeout ( hid_data -> hid_wait , hid_data -> request_done , 3 * HZ ) ; } if ( ! hid_data -> request_done ) { hid_err ( hid , "timeout waiting for response from ISHTP device\n" ) ; return - ETIMEDOUT ; } hid_ishtp_trace ( client_data , "%s hid %p done\n" , __func__ , hid ) ; hid_data -> request_done = false ; return 0 ; } 