static int decode_buffering_period ( H264SEIBufferingPeriod * h , GetBitContext * gb , const H264ParamSets * ps , void * logctx ) { unsigned int sps_id ; int sched_sel_idx ; SPS * sps ; sps_id = get_ue_golomb_31 ( gb ) ; if ( sps_id > 31 || ! ps -> sps_list [ sps_id ] ) { av_log ( logctx , AV_LOG_ERROR , "non-existing SPS %d referenced in buffering period\n" , sps_id ) ; return AVERROR_INVALIDDATA ; } sps = ( SPS * ) ps -> sps_list [ sps_id ] -> data ; if ( sps -> nal_hrd_parameters_present_flag ) { for ( sched_sel_idx = 0 ; sched_sel_idx < sps -> cpb_cnt ; sched_sel_idx ++ ) { h -> initial_cpb_removal_delay [ sched_sel_idx ] = get_bits ( gb , sps -> initial_cpb_removal_delay_length ) ; skip_bits ( gb , sps -> initial_cpb_removal_delay_length ) ; } } if ( sps -> vcl_hrd_parameters_present_flag ) { for ( sched_sel_idx = 0 ; sched_sel_idx < sps -> cpb_cnt ; sched_sel_idx ++ ) { h -> initial_cpb_removal_delay [ sched_sel_idx ] = get_bits ( gb , sps -> initial_cpb_removal_delay_length ) ; skip_bits ( gb , sps -> initial_cpb_removal_delay_length ) ; } } return 0 ; } 