static void il3945_configure_filter ( struct ieee80211_hw * hw , unsigned int changed_flags , unsigned int * total_flags , u64 multicast ) { struct il_priv * il = hw -> priv ; __le32 filter_or = 0 , filter_nand = 0 ; if ( * total_flags & ( test ) ) { filter_or |= ( flag ) ; } else { filter_nand |= ( flag ) ; } } while ( 0 ) { D_MAC80211 ( "Enter: changed: 0x%x, total: 0x%x\n" , changed_flags , * total_flags ) ; } CHK ( FIF_OTHER_BSS , RXON_FILTER_PROMISC_MSK ) ; CHK ( FIF_CONTROL , RXON_FILTER_CTL2HOST_MSK ) ; CHK ( FIF_BCN_PRBRESP_PROMISC , RXON_FILTER_BCON_AWARE_MSK ) ; il -> staging . filter_flags &= ~ filter_nand ; il -> staging . filter_flags |= filter_or ; mutex_unlock ( & il -> mutex ) ; * total_flags &= FIF_OTHER_BSS | FIF_ALLMULTI | FIF_BCN_PRBRESP_PROMISC | FIF_CONTROL ; 