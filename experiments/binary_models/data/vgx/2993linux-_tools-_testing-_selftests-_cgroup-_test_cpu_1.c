static int test_cpucg_subtree_control ( const char * root ) { char * parent = NULL , * child = NULL , * parent2 = NULL , * child2 = NULL ; int ret = KSFT_FAIL ; parent = cg_name ( root , "cpucg_test_0" ) ; if ( ! parent ) { cleanup } if ( cg_create ( parent ) ) { cleanup } if ( cg_write ( parent , "cgroup.subtree_control" , "+cpu" ) ) { cleanup } child = cg_name ( parent , "cpucg_test_child" ) ; if ( ! child ) { cleanup } if ( cg_create ( child ) ) { cleanup } if ( cg_read_strstr ( child , "cgroup.controllers" , "cpu" ) ) { cleanup } parent2 = cg_name ( root , "cpucg_test_1" ) ; if ( ! parent2 ) { cleanup } if ( cg_create ( parent2 ) ) { cleanup } child2 = cg_name ( parent2 , "cpucg_test_child" ) ; if ( ! child2 ) { cleanup } if ( cg_create ( child2 ) ) { cleanup } if ( ! cg_read_strstr ( child2 , "cgroup.controllers" , "cpu" ) ) { cleanup } ret = KSFT_PASS ; cleanup cg_destroy ( child ) ; cg_destroy ( child2 ) ; free ( child2 ) ; cg_destroy ( parent ) ; free ( parent ) ; cg_destroy ( parent2 ) ; free ( parent2 ) ; return ret ; } 