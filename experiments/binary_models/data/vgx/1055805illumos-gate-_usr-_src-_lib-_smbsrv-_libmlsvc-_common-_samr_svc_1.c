static DWORD samr_s_enum_local_domains ( struct samr_EnumLocalDomain * param , ndr_xa_t * mxa ) { struct samr_LocalDomainInfo * info ; struct samr_LocalDomainEntry * entry ; char * hostname ; hostname = NDR_MALLOC ( mxa , NETBIOS_NAME_SZ ) ; if ( smb_getnetbiosname ( hostname , NETBIOS_NAME_SZ ) != 0 ) { return ( NT_STATUS_NO_MEMORY ) ; } entry = NDR_NEWN ( mxa , samr_LocalDomainEntry , 2 ) ; if ( entry == NULL ) { return ( NT_STATUS_NO_MEMORY ) ; } bzero ( entry , ( sizeof ( samr_LocalDomainEntry ) * 2 ) ) ; ( void ) NDR_MSTRING ( mxa , hostname , ( ndr_mstring_t * ) & entry [ 0 ] . name ) ; ( void ) NDR_MSTRING ( mxa , "Builtin" , ( ndr_mstring_t * ) & entry [ 1 ] . name ) ; info = NDR_NEW ( mxa , samr_LocalDomainInfo ) ; if ( info == NULL ) { return ( NT_STATUS_NO_MEMORY ) ; } info -> entries_read = 2 ; info -> entry = entry ; param -> info = info ; return ( NT_STATUS_SUCCESS ) ; } 