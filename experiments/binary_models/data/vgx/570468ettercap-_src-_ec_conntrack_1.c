int conntrack_countrystr ( struct conn_object * conn , char * pstr , int len ) { char ccode_src [ 3 ] ; char ccode_dst [ 3 ] ; char * src , * dst ; if ( pstr == NULL || conn == NULL || len < 8 ) { return - E_INVALID ; } if ( ( src = geoip_get_by_ip ( & conn -> L3_addr1 , GEOIP_CCODE , ccode_src , 3 ) ) == NULL ) { return - E_INITFAIL ; } if ( ( dst = geoip_get_by_ip ( & conn -> L3_addr2 , GEOIP_CCODE , ccode_dst , 3 ) ) == NULL ) { return - E_INITFAIL ; } snprintf ( pstr , len , "%2s>%2s" , src , dst ) ; return E_SUCCESS ; } 