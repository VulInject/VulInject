void amdgpu_atombios_crtc_set_dtd_timing ( struct drm_crtc * crtc , struct drm_display_mode * mode ) { struct amdgpu_crtc * amdgpu_crtc = to_amdgpu_crtc ( crtc ) ; struct drm_device * dev = crtc -> dev ; struct amdgpu_device * adev = dev -> dev_private ; SET_CRTC_USING_DTD_TIMING_PARAMETERS args ; int index = GetIndexIntoMasterTable ( COMMAND , SetCRTC_UsingDTDTiming ) ; u16 misc = 0 ; args . usH_Size = cpu_to_le16 ( mode -> crtc_hdisplay - ( amdgpu_crtc -> h_border * 2 ) ) ; args . usH_Blanking_Time = cpu_to_le16 ( mode -> crtc_hblank_end - mode -> crtc_hdisplay + ( amdgpu_crtc -> h_border * 2 ) ) ; args . usV_Size = cpu_to_le16 ( mode -> crtc_vdisplay - ( amdgpu_crtc -> v_border * 2 ) ) ; args . usV_Blanking_Time = cpu_to_le16 ( mode -> crtc_vblank_end - mode -> crtc_vdisplay + ( amdgpu_crtc -> v_border * 2 ) ) ; args . usH_SyncOffset = cpu_to_le16 ( mode -> crtc_hsync_start - mode -> crtc_hdisplay + amdgpu_crtc -> h_border ) ; args . usH_SyncWidth = cpu_to_le16 ( mode -> crtc_hsync_end - mode -> crtc_hsync_start ) ; args . usV_SyncOffset = cpu_to_le16 ( mode -> crtc_vsync_start - mode -> crtc_vdisplay + amdgpu_crtc -> v_border ) ; args . usV_SyncWidth = cpu_to_le16 ( mode -> crtc_vsync_end - mode -> crtc_vsync_start ) ; args . ucH_Border = amdgpu_crtc -> h_border ; args . ucV_Border = amdgpu_crtc -> v_border ; if ( mode -> flags & DRM_MODE_FLAG_NVSYNC ) { misc |= ATOM_VSYNC_POLARITY ; } if ( mode -> flags & DRM_MODE_FLAG_NHSYNC ) { misc |= ATOM_HSYNC_POLARITY ; } if ( mode -> flags & DRM_MODE_FLAG_CSYNC ) { misc |= ATOM_COMPOSITESYNC ; } if ( mode -> flags & DRM_MODE_FLAG_INTERLACE ) { misc |= ATOM_INTERLACE ; } if ( mode -> flags & DRM_MODE_FLAG_DBLSCAN ) { misc |= ATOM_DOUBLE_CLOCK_MODE ; } args . susModeMiscInfo . usAccess = cpu_to_le16 ( misc ) ; args . ucCRTC = amdgpu_crtc -> crtc_id ; amdgpu_atom_execute_table ( adev -> mode_info . atom_context , index , ( uint32_t * ) & args ) ; } atom_enable_ss { ENABLE_SPREAD_SPECTRUM_ON_PPLL_PS_ALLOCATION v1 ; ENABLE_SPREAD_SPECTRUM_ON_PPLL_V2 v2 ; ENABLE_SPREAD_SPECTRUM_ON_PPLL_V3 v3 ; } 