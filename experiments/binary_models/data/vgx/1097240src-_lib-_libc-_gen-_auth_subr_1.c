( auth_open ) ; void auth_clean ( auth_session_t * as ) { struct rmfiles * rm ; struct authdata * data ; as -> state = 0 ; auth_clrenv ( as ) ; while ( ( rm = as -> rmlist ) != NULL ) { as -> rmlist = rm -> next ; unlink ( rm -> file , NULL ) ; free ( rm ) ; } while ( ( data = as -> data ) != NULL ) { if ( as -> data -> len ) { explicit_bzero ( as -> data -> ptr , as -> data -> len ) ; } as -> data = data -> next ; free ( data ) ; } auth_setitem ( as , AUTHV_ALL , NULL ) ; if ( as -> pwd != NULL ) { explicit_bzero ( as -> pwd -> pw_passwd , strlen ( as -> pwd -> pw_passwd ) ) ; free ( as -> pwd ) ; as -> pwd = NULL ; } if ( as -> fd != - 1 ) { close ( as -> fd ) ; as -> fd = - 1 ; } } 