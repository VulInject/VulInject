static int __init ps3_setup_vuart_device ( enum ps3_match_id match_id , unsigned int port_number ) { int result ; layout { struct ps3_system_bus_device dev ; } , * p pr_debug ( " ->%s:%d: match_id %u, port %u\n" , __func__ , __LINE__ , match_id , port_number ) ; p = kzalloc ( sizeof ( layout ) , GFP_KERNEL ) ; p -> dev . match_id = match_id ; p -> dev . dev_type = PS3_DEVICE_TYPE_VUART ; p -> dev . port_number = port_number ; result = ps3_system_bus_device_register ( & p -> dev ) ; if ( result ) { pr_debug ( "%s:%d ps3_system_bus_device_register failed\n" , __func__ , __LINE__ ) ; fail_device_register } pr_debug ( "<- %s:%d\n" , __func__ , __LINE__ ) ; return 0 ; fail_device_register kfree ( p ) ; pr_debug ( "<- %s:%d fail\n" , __func__ , __LINE__ ) ; return result ; } 