static void remove_expired ( struct CookieInfo * cookies ) { struct Cookie * co , * nx ; curl_off_t now = ( curl_off_t ) time ( NULL ) ; int i ; if ( now < cookies -> next_expiration && cookies -> next_expiration != CURL_OFF_T_MAX ) { return ; } else { cookies -> next_expiration = CURL_OFF_T_MAX ; } for ( i = 0 ; i < COOKIE_HASH_SIZE ; i ++ ) { struct Cookie * pv = NULL ; co = cookies -> cookies [ i ] ; while ( co ) { nx = co -> next ; if ( co -> expires && co -> expires < now ) { if ( ! pv ) { cookies -> cookies [ i ] = co -> next ; } else { pv -> next = co -> next ; } cookies -> numcookies -- ; freecookie ( co ) ; } else { if ( co -> expires && co -> expires < cookies -> next_expiration ) { cookies -> next_expiration = co -> expires ; } pv = co ; } co = nx ; } } } 