static irqreturn_t hub_rt_counter_handler ( int irq , void * dev_id ) { int cpu = smp_processor_id ( ) ; struct clock_event_device * cd = & per_cpu ( hub_rt_clockevent , cpu ) ; int slice = cputoslice ( cpu ) ; LOCAL_HUB_S ( PI_RT_PEND_A + PI_COUNT_OFFSET * slice , 0 ) ; cd -> event_handler ( cd ) ; return IRQ_HANDLED ; } struct irqaction hub_rt_irqaction = { . handler = hub_rt_counter_handler . percpu_dev_id = & hub_rt_clockevent . flags = IRQF_PERCPU | IRQF_TIMER . name = "hub-rt" } ; 