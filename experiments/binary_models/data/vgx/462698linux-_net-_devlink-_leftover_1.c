static int devlink_nl_port_function_attrs_put ( struct sk_buff * msg , struct devlink_port * port , struct netlink_ext_ack * extack ) { const struct devlink_ops * ops ; struct nlattr * function_attr ; bool msg_updated = false ; int err ; function_attr = nla_nest_start_noflag ( msg , DEVLINK_ATTR_PORT_FUNCTION ) ; ops = port -> devlink -> ops ; err = devlink_port_fn_hw_addr_fill ( ops , port , msg , extack , & msg_updated ) ; if ( err ) { out } err = devlink_port_fn_caps_fill ( ops , port , msg , extack , & msg_updated ) ; if ( err ) { out } err = devlink_port_fn_state_fill ( ops , port , msg , extack , & msg_updated ) ; out if ( err || ! msg_updated ) { nla_nest_cancel ( msg , function_attr ) ; } else { nla_nest_end ( msg , function_attr ) ; } return err ; } 