static int set_sregs_base ( struct kvm_vcpu * vcpu , struct kvm_sregs * sregs ) { vcpu -> arch . csrr0 = sregs -> u . e . csrr0 ; vcpu -> arch . csrr1 = sregs -> u . e . csrr1 ; vcpu -> arch . mcsr = sregs -> u . e . mcsr ; kvmppc_set_esr ( vcpu , sregs -> u . e . esr ) ; kvmppc_set_dar ( vcpu , sregs -> u . e . dear ) ; vcpu -> arch . vrsave = sregs -> u . e . vrsave ; kvmppc_set_tcr ( vcpu , sregs -> u . e . tcr ) ; if ( sregs -> u . e . update_special & KVM_SREGS_E_UPDATE_DEC ) { vcpu -> arch . dec = sregs -> u . e . dec ; kvmppc_emulate_dec ( vcpu ) ; } if ( sregs -> u . e . update_special & KVM_SREGS_E_UPDATE_TSR ) { kvmppc_set_tsr ( vcpu , sregs -> u . e . tsr ) ; } return 0 ; } 