asmlinkage int sys_metag_setglobalbit ( char __user * addr , int mask ) { char tmp ; int ret = 0 ; unsigned int flags ; __global_lock2 ( flags ) ; metag_data_cache_flush ( ( __force void * ) addr , sizeof ( mask ) ) ; ret = __get_user ( tmp , addr ) ; if ( ret ) { out } tmp |= mask ; ret = __put_user ( tmp , addr ) ; metag_data_cache_flush ( ( __force void * ) addr , sizeof ( mask ) ) ; out __global_unlock2 ( flags ) ; return ret ; } 