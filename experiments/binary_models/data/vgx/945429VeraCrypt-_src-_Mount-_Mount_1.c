BOOL SelectItem ( HWND hTree , wchar_t nLetter ) { if ( nLetter == 0 ) { nLetter = ( wchar_t ) ( HIWORD ( GetSelectedLong ( hTree ) ) ) ; } int i ; LVITEM item ; for ( i = 0 ; i < ListView_GetItemCount ( hTree ) ; i ++ ) { item . mask = LVIF_PARAM ; item . iItem = i ; if ( ListView_GetItem ( hTree , & item ) == FALSE ) { return FALSE ; } else { if ( HIWORD ( item . lParam ) == nLetter ) { memset ( & item , 0 , sizeof ( LVITEM ) ) ; item . state = LVIS_FOCUSED | LVIS_SELECTED ; item . stateMask = LVIS_FOCUSED | LVIS_SELECTED ; item . mask = LVIF_STATE ; item . iItem = i ; SendMessage ( hTree , LVM_SETITEMSTATE , i , ( LPARAM ) & item ) ; return TRUE ; } } } return TRUE ; } 