static int getExpireMillisecondsOrReply ( client * c , robj * expire , int flags , int unit , long long * milliseconds ) { int ret = getLongLongFromObjectOrReply ( c , expire , milliseconds , NULL ) ; if ( ret != C_OK ) { return ret ; } if ( * milliseconds <= 0 || ( unit == UNIT_SECONDS && * milliseconds > LLONG_MAX / 1000 ) ) { addReplyErrorExpireTime ( c , NULL ) ; return C_ERR ; } if ( unit == UNIT_SECONDS ) { * milliseconds *= 1000 ; } if ( ( flags & OBJ_PX ) || ( flags & OBJ_EX ) ) { * milliseconds += commandTimeSnapshot ( ) ; } if ( * milliseconds <= 0 ) { addReplyErrorExpireTime ( c ) ; return C_ERR ; } return C_OK ; } 