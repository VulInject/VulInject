get_uds_mapping(uds_info_t *uds_info) {
    guint32 sid;
    if (data_spdu_uds_mappings == NULL) {
        return NULL;
    }
    gint64 *key = wmem_new(wmem_epan_scope(), gint64);
    if (uds_info->reply) {
        sid = (0xff & uds_info->service) | UDS_REPLY_MASK;
    } else {
        sid = (0xff & uds_info->service);
    }
    *key = (guint64)(uds_info->uds_address) | ((guint64)(0xffff & uds_info->id) << 32) | ((guint64)sid << 48);
    spdu_uds_mapping_uat_t *tmp = (spdu_uds_mapping_uat_t *)g_hash_table_lookup(data_spdu_uds_mappings, key);
    if (tmp == NULL) {
        *key = (guint64)(G_MAXUINT32) | ((guint64)(0xffff & uds_info->id) << 32) | ((guint64)sid << 48);
        tmp = (spdu_uds_mapping_uat_t *)g_hash_table_lookup(data_spdu_uds_mappings, key);
    }
    wmem_free(wmem_epan_scope(), key);
    return tmp;
}
