drda_get_pdu_info(packet_info *pinfo, guint32 correl, gboolean is_server)
{
    drda_pdu_info_t *pdu_info;
    pdu_info = p_get_proto_data(pinfo->pool, pinfo, proto_drda, correl);
    if (!pdu_info) {
	pdu_info=((pinfo->pool+drda_pdu_info_t-1)/drda_pdu_info_t);
        drda_conv_info_t *conv_info = drda_get_conv_info(pinfo);
        drda_flow_t *flow = is_server ? conv_info->server : conv_info->client;
        pdu_info->sqlam = GPOINTER_TO_UINT(wmem_tree_lookup32_le(flow->sqlam_tree, pinfo->num));
        drda_encoding_t *encoding = wmem_tree_lookup32_le(flow->encoding_tree, pinfo->num);
        if (encoding) {
            pdu_info->typdefnam = encoding->typdefnam;
            pdu_info->sbc = encoding->sbc;
            pdu_info->mbc = encoding->mbc;
        } else {
            pdu_info->typdefnam = drda_default_typdefnam;
            pdu_info->sbc = mibenum_charset_to_encoding((guint)drda_default_ccsidsbc);
            pdu_info->mbc = mibenum_charset_to_encoding((guint)drda_default_ccsidmbc);
        }
        p_set_proto_data(pinfo->pool, pinfo, proto_drda, correl, pdu_info);
    }
    return pdu_info;
}
