bgp_mp_af_print(netdissect_options *ndo,
	        const u_char *tptr, u_int tlen,
		unsigned short *afp, unsigned char *safip)
{
	unsigned short af;
	unsigned char safi;
        af = GET_BE_U_2(tptr);
	*afp = af;
        safi = GET_U_1(tptr + 2);
	*safip = safi;
        ND_PRINT("\n\t    AFI: %s (%u), %sSAFI: %s (%u)",
                  tok2str(af_values, "Unknown AFI", af),
                  af,
                  (safi>128) ? "vendor specific " : "", 
                  tok2str(bgp_safi_values, "Unknown SAFI", safi),
                  safi);
        switch(af<<8 | safi) {
        case (AFNUM_IP<<8 | SAFNUM_UNICAST):
        case (AFNUM_IP<<8 | SAFNUM_MULTICAST):
        case (AFNUM_IP<<8 | SAFNUM_UNIMULTICAST):
        case (AFNUM_IP<<8 | SAFNUM_LABUNICAST):
        case (AFNUM_IP<<8 | SAFNUM_RT_ROUTING_INFO):
        case (AFNUM_IP<<8 | SAFNUM_VPNUNICAST):
        case (AFNUM_IP<<8 | SAFNUM_VPNMULTICAST):
        case (AFNUM_IP<<8 | SAFNUM_VPNUNIMULTICAST):
        case (AFNUM_IP<<8 | SAFNUM_MULTICAST_VPN):
        case (AFNUM_IP<<8 | SAFNUM_MDT):
        case (AFNUM_IP6<<8 | SAFNUM_UNICAST):
        case (AFNUM_IP6<<8 | SAFNUM_MULTICAST):
        case (AFNUM_IP6<<8 | SAFNUM_UNIMULTICAST):
        case (AFNUM_IP6<<8 | SAFNUM_LABUNICAST):
        case (AFNUM_IP6<<8 | SAFNUM_VPNUNICAST):
        case (AFNUM_IP6<<8 | SAFNUM_VPNMULTICAST):
        case (AFNUM_IP6<<8 | SAFNUM_VPNUNIMULTICAST):
        case (AFNUM_NSAP<<8 | SAFNUM_UNICAST):
        case (AFNUM_NSAP<<8 | SAFNUM_MULTICAST):
        case (AFNUM_NSAP<<8 | SAFNUM_UNIMULTICAST):
        case (AFNUM_NSAP<<8 | SAFNUM_VPNUNICAST):
        case (AFNUM_NSAP<<8 | SAFNUM_VPNMULTICAST):
        case (AFNUM_NSAP<<8 | SAFNUM_VPNUNIMULTICAST):
        case (AFNUM_L2VPN<<8 | SAFNUM_VPNUNICAST):
        case (AFNUM_L2VPN<<8 | SAFNUM_VPNMULTICAST):
        case (AFNUM_L2VPN<<8 | SAFNUM_VPNUNIMULTICAST):
        case (AFNUM_VPLS<<8 | SAFNUM_VPLS):
            break;
        default:
            ND_PRINT("\n\t    no AFI %u / SAFI %u decoder", af, safi);
            if (ndo->ndo_vflag <= 1)
                print_unknown_data(ndo, tptr, "\n\t    ", tlen);
            return -1;
        }
	return 0;
trunc:
	return -2;
}
