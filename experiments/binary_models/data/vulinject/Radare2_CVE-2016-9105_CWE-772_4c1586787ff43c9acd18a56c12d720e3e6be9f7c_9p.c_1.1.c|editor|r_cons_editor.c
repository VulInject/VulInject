R_API char *r_cons_editor(const char *file, const char *str) {
	const char *line;
	_n = 1;
	if (I->cb_editor) {
		return I->cb_editor (I->user, file, str);
	}
	free (path);
	if (file) {
		path = strdup (file);
		bytes = 0;
		size_t sz = 0;
		lines = r_file_slurp (file, &sz);
		bytes = (int)sz;
		if (!lines) {
			R_LOG_ERROR ("Failed to load '%s'", file);
			R_FREE (path);
			return NULL;
		}
		nlines = r_str_split (lines, '\n');
		R_LOG_INFO ("Loaded %d lines on %d byte(s)", (nlines? (nlines - 1): 0), bytes);
	} else {
		path = NULL;
	}
	I->line->hist_up = up;
	I->line->hist_down = down;
	I->line->contents = I->line->buffer.data;
	I->echo = false;
	down (NULL);
	up (NULL);
	for (;;) {
		char *curline = r_file_slurp_line (file, _n, 0);
		I->line->contents = curline;
		setnewline (_n);
		line = r_line_readline ();
		if (line && *line && curline && strcmp (curline, line)) {
		}
		down (NULL);
		setnewline (_n);
		if (!line) {
			break;
		}
	}
	I->line->hist_up = NULL;
	I->line->hist_down = NULL;
	I->line->contents = NULL;
	return lines;
}
