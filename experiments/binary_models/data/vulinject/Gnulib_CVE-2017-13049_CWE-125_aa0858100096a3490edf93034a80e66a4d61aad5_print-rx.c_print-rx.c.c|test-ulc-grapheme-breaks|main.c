main ()
{
  if (setlocale (LC_ALL, "") == NULL)
    return 1;
  ulc_grapheme_breaks (NULL, 0, NULL);
#if HAVE_ICONV
  {
    static const char s[] = "ZYX\352\353W\360\361V\362";
    enum { LENGTH = sizeof s - 1 };
    char p[LENGTH];
    size_t i;
    ulc_grapheme_breaks (s, LENGTH, p);
    for (i = 0; i < LENGTH; i++)
      if (p[i] != is_8859_6_break (s[i]))
        {
          size_t j;
          fprintf (stderr, "wrong grapheme breaks:\n");
          fprintf (stderr, "   input:");
          for (j = 0; j < LENGTH; j++)
            fprintf (stderr, " %02X", (unsigned char) s[j]);
          putc ('\n', stderr);
          fprintf (stderr, "expected:");
          for (j = 0; j < LENGTH; j++)
            fprintf (stderr, "  %d", is_8859_6_break (s[j]));
          putc ('\n', stderr);
          fprintf (stderr, "  actual:");
          for (j = 0; j < LENGTH; j++)
            fprintf (stderr, "  %d", p[j]);
          putc ('\n', stderr);
          abort ();
        }
  }
#endif
  return test_exit_status;
}
