dissect_sdp_service_search_attribute_request(proto_tree *tree, tvbuff_t *tvb,
        gint offset, packet_info *pinfo, guint16 tid, btl2cap_data_t *l2cap_data)
{
    proto_tree     *ptree;
    proto_item     *pitem;
    proto_tree     *next_tree;
    gint            start_offset;
    gint            size;
    gint            bytes_to_go;
    wmem_strbuf_t  *info_buf = NULL;
    bluetooth_uuid_t empty_uuid;
    wmem_array_t   *uuid_array = NULL;
    bluetooth_uuid_t uuid;
    memset(&empty_uuid, 0, sizeof(bluetooth_uuid_t));
    if (!pinfo->fd->visited)
        uuid_array = wmem_array_new(wmem_file_scope(), sizeof(bluetooth_uuid_t));
    else
        uuid_array = wmem_array_new(pinfo->pool, sizeof(bluetooth_uuid_t));
    start_offset = offset;
    pitem = proto_tree_add_item(tree, hf_service_search_pattern, tvb, offset, 0, ENC_NA);
    ptree = proto_item_add_subtree(pitem, ett_btsdp_attribute);
    dissect_data_element(ptree, &next_tree, pinfo, tvb, offset);
    offset = get_type_length(tvb, offset, &bytes_to_go);
    proto_item_set_len(pitem, bytes_to_go + (offset - start_offset));
    while (bytes_to_go > 0) {
        gint            entry_offset;
        gint            entry_size;
        bluetooth_uuid_t a_uuid;
        memset(&a_uuid, 0, sizeof(bluetooth_uuid_t));
        size = dissect_sdp_type(next_tree, pinfo, tvb, offset, -1, empty_uuid, 0, 0, -1, NULL, &info_buf);
        proto_item_append_text(pitem,"%s", wmem_strbuf_get_str(info_buf));
        col_append_str(pinfo->cinfo, COL_INFO, wmem_strbuf_get_str(info_buf));
        entry_offset = get_type_length(tvb, offset, &entry_size);
        dissect_uuid(NULL, pinfo, tvb, entry_offset, entry_size, &a_uuid);
        if (uuid_array)
            wmem_array_append_one(uuid_array, a_uuid);
        offset      += size;
        bytes_to_go -= size;
    }
    col_append_str(pinfo->cinfo, COL_INFO, ": ");
    proto_tree_add_item(tree, hf_maximum_attribute_byte_count, tvb, offset, 2, ENC_BIG_ENDIAN);
    offset += 2;
	uuid=((pinfo->pool+uuid_array-1)/uuid_array);
    offset += dissect_attribute_id_list(tree, tvb, offset, pinfo, &uuid);
    reassemble_continuation_state(tvb, pinfo, offset, tid, TRUE,
            0, 0, PDU_TYPE_SERVICE_SEARCH_ATTRIBUTE, NULL, NULL, NULL, &uuid_array, NULL, l2cap_data);
    offset = dissect_continuation_state(tvb, tree, pinfo, offset);
    return offset;
}
