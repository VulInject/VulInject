elem_so_list(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint32 offset, guint len, ansi_a_shared_data_t *data_p)
{
    guint8      num_so;
    guint8      inst;
    guint32     curr_offset;
    proto_item  *item;
    proto_tree  *subtree;
    curr_offset = offset;
    proto_tree_add_item(tree, hf_ansi_a_so_list_num, tvb, curr_offset, 1, ENC_BIG_ENDIAN);
    num_so = tvb_get_guint8(tvb, curr_offset);
    proto_item_append_text(data_p->elem_item, " - %u service options", num_so);
    curr_offset += 1;
    SHORT_DATA_CHECK(len - (curr_offset - offset), 3);
    inst = 0;
    do
    {
        guint16         value;
        subtree =
            proto_tree_add_subtree_format(tree, tvb, curr_offset, 3,
                ett_so_list, &item, "Service Option [%u]",
                inst + 1);
        proto_tree_add_item(tree, hf_ansi_a_reserved_bits_8_c0, tvb, curr_offset, 1, ENC_BIG_ENDIAN);
        proto_tree_add_item(tree, hf_ansi_a_so_list_sr_id, tvb, curr_offset, 1, ENC_BIG_ENDIAN);
        proto_tree_add_item(tree, hf_ansi_a_so_list_soci, tvb, curr_offset, 1, ENC_BIG_ENDIAN);
        curr_offset += 1;
        curr_offset += elem_so_aux(tvb, pinfo, subtree, curr_offset, len, &value);
        proto_item_append_text(item, " - (%u) %s", value, ansi_a_so_int_to_str(value));
        inst++;
    }
    while (((len - (curr_offset - offset)) >= 3) &&
        (inst < num_so));
    EXTRANEOUS_DATA_CHECK(len, curr_offset - offset);
    return curr_offset - offset;
}
