find_conversation_pinfo_ro(const packet_info *pinfo, const guint options)
{
    conversation_t *conv = NULL;
    DINSTR(gchar *src_str = address_to_str(NULL, &pinfo->src));
    DINSTR(gchar *dst_str = address_to_str(NULL, &pinfo->dst));
    DPRINT(("called for frame #%u: %s:%d -> %s:%d (ptype=%d)",
                pinfo->num, src_str, pinfo->srcport,
                dst_str, pinfo->destport, pinfo->ptype));
    DINDENT();
    DINSTR(wmem_free(NULL, src_str));
    DINSTR(wmem_free(NULL, dst_str));
    if (pinfo->use_conv_addr_port_endpoints) {
        if ((conv = find_conversation(pinfo->num, &pinfo->conv_addr_port_endpoints->addr1, &pinfo->conv_addr_port_endpoints->addr2,
                        pinfo->conv_addr_port_endpoints->ctype, pinfo->conv_addr_port_endpoints->port1,
                        pinfo->conv_addr_port_endpoints->port2, 0)) != NULL) {
            DPRINT(("found previous conversation for frame #%u (last_frame=%d)",
                    pinfo->num, conv->last_frame));
        }
    } else if (pinfo->conv_elements) {
        if ((conv = find_conversation_full(pinfo->num, pinfo->conv_elements)) != NULL) {
            DPRINT(("found previous conversation elements for frame #%u (last_frame=%d)",
                        pinfo->num, conv->last_frame));
        }
    } else {
        if ((conv = find_conversation_strat(pinfo, conversation_pt_to_conversation_type(pinfo->ptype), options)) != NULL) {
            DPRINT(("found previous conversation for frame #%u (last_frame=%d)",
                        pinfo->num, conv->last_frame));
        }
    }
    DENDENT();
    return conv;
}
