eopt_print(netdissect_options *ndo,
          const u_char *cp)
{
    u_int opt, data_len, i;
    if (!ND_TTEST_2(cp))
        return (NULL);
    opt = GET_BE_U_2(cp);
    cp += 2;
    ND_PRINT("%s", tok2str(edns_opt2str, "Opt%u", opt));
    if (!ND_TTEST_2(cp))
        return (NULL);
    data_len = GET_BE_U_2(cp);
    cp += 2;
    if (data_len > 0) {
        ND_PRINT(" ");
        switch (opt) {
        case E_ECS:
            print_eopt_ecs(ndo, cp, data_len);
            break;
        case E_COOKIE:
            if (data_len < 8 || (data_len > 8 && data_len < 16) || data_len > 40)
                nd_print_invalid(ndo);
            else {
                for (i = 0; i < data_len; ++i) {
                    if (i == 8)
                        ND_PRINT(" ");
                    ND_PRINT("%02x", GET_U_1(cp + i));
                }
            }
            break;
        case E_KEEPALIVE:
            if (data_len != 2)
                nd_print_invalid(ndo);
            else
                ND_PRINT("%0.1f sec", (GET_BE_U_2(cp) / 10.0));
            break;
        case E_EXPIRE:
            if (data_len != 4)
                nd_print_invalid(ndo);
            else
                ND_PRINT("%u sec", GET_BE_U_4(cp));
            break;
        case E_PADDING:
            ND_PRINT("(%u)", data_len);
            break;
        case E_KEYTAG:
            if (data_len % 2 != 0)
                nd_print_invalid(ndo);
            else
                for (i = 0; i < data_len; i += 2) {
                    if (i > 0)
                        ND_PRINT(" ");
                    ND_PRINT("%u", GET_BE_U_2(cp + i));
                }
            break;
        case E_DAU:
            for (i = 0; i < data_len; ++i) {
                if (i > 0)
                    ND_PRINT(" ");
                ND_PRINT("%s", tok2str(dau_alg2str, "Alg_%u", GET_U_1(cp + i)));
            }
            break;
        case E_DHU:
            for (i = 0; i < data_len; ++i) {
                if (i > 0)
                    ND_PRINT(" ");
                ND_PRINT("%s", tok2str(dhu_alg2str, "Alg_%u", GET_U_1(cp + i)));
            }
            break;
        case E_N3U:
            for (i = 0; i < data_len; ++i) {
                if (i > 0)
                    ND_PRINT(" ");
                ND_PRINT("%s", tok2str(n3u_alg2str, "Alg_%u", GET_U_1(cp + i)));
            }
            break;
        case E_CHAIN:
            fqdn_print(ndo, cp, cp + data_len);
            break;
        case E_NSID:
        default:
            for (i = 0; i < data_len; ++i)
                ND_PRINT("%02x", GET_U_1(cp + i));
            break;
        }
    }
    return (cp + data_len);
  trunc:
    return (NULL);
}
