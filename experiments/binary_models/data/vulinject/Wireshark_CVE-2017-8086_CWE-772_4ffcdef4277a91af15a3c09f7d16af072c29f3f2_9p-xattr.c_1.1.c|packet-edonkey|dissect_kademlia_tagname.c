static int dissect_kademlia_tagname(tvbuff_t *tvb, packet_info *pinfo,
                                    int offset, proto_tree *tree, const gchar** outputTagName, const gchar** outputExtendedTagName)
{
    const gchar * tagname;
    const gchar * tag_full_name = NULL;
    guint8 tagname_value;
    proto_item *ti, *hidden_item;
    guint16 string_length = tvb_get_letohs(tvb, offset);
    proto_tree_add_uint(tree, hf_kademlia_tag_name_length, tvb, offset, 2, string_length);
    hidden_item = proto_tree_add_uint(tree, hf_edonkey_string_length, tvb, offset, 2, string_length);
    tagname = tvb_get_string_enc(pinfo->pool, tvb, offset + 2, string_length, ENC_ASCII|ENC_NA);
    tag_full_name = "UnknownTagName";
    if ( tagname && string_length == 1 ) {
        tagname_value = *(const guint8*)tagname;
        tag_full_name = val_to_str_const( tagname_value, kademlia_tags, tag_full_name );
    }
    ti = proto_tree_add_item(tree, hf_kademlia_tag_name, tvb, offset + 2, string_length, ENC_BIG_ENDIAN);
    proto_item_append_text(ti, " [%s]", tag_full_name);
    if (outputTagName)
        *outputTagName = tagname;
    if (outputExtendedTagName)
        *outputExtendedTagName = tag_full_name;
    return offset+2+string_length;
}
