SEC(PROGNAME)
int ngx_quic_select_socket_by_dcid(struct sk_reuseport_md *ctx)
{
    int             rc;
    __u64           key;
    size_t          len, offset;
    unsigned char  *start, *end, *data, *dcid;
    start = ctx->data;
    end = (unsigned char *) ctx->data_end;
    offset = 0;
    advance_data(sizeof(struct udphdr)); 
    advance_data(1); 
    if (data[0] & NGX_QUIC_PKT_LONG) {
        advance_data(4); 
        advance_data(1); 
        len = data[0];   
        if (len < 8) {
            return SK_PASS;
        }
    } else {
        len = NGX_QUIC_SERVER_CID_LEN;
    }
    dcid = &data[1];
    if (dcid + sizeof(__u64) > end) {
        goto failed;
    }
    key = ngx_quic_parse_uint64(dcid);
    rc = bpf_sk_select_reuseport(ctx, &ngx_quic_sockmap, &key, 0);
    switch (rc) {
    case 0:
        debugmsg("nginx quic socket selected by key 0x%llx", key);
        return SK_PASS;
    case -ENOENT:
        debugmsg("nginx quic default route for key 0x%llx", key);
        return SK_PASS;
    default:
        debugmsg("nginx quic bpf_sk_select_reuseport err: %d key 0x%llx",
                 rc, key);
        goto failed;
    }
failed:
    return SK_PASS;
}
