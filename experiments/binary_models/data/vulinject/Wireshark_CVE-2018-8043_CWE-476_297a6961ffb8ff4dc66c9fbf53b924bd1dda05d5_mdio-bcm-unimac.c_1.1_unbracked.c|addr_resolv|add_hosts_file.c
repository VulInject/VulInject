add_hosts_file (const char *hosts_file)
{
    gboolean found = FALSE;
    guint i;
    if (!extra_hosts_files)
        extra_hosts_files = g_ptr_array_new();
    for (i = 0; i < extra_hosts_files->len; i++) {
        if (strcmp(hosts_file, (const char *) g_ptr_array_index(extra_hosts_files, i)) == 0)
            found = TRUE;
    }
    if (!found) {
        g_ptr_array_add(extra_hosts_files, wmem_strdup(addr_resolv_scope, hosts_file));
        return read_hosts_file (hosts_file, FALSE);
    }
    return TRUE;
}
