__irq_alloc_descs(int irq, unsigned int from, unsigned int cnt, int node,
		  struct module *owner, const struct irq_affinity_desc *affinity)
{
	int start, ret;
	if (!cnt)
		return -EINVAL;
	if (irq >= 0) {
		if (from > irq)
			return -EINVAL;
		from = irq;
	} else {
	}
	mutex_lock(&sparse_irq_lock);
	start = irq_find_free_area(from, cnt);
	ret = -EEXIST;
	if (irq >=0 && start != irq)
		goto unlock;
	if (start + cnt > nr_irqs) {
		ret = irq_expand_nr_irqs(start + cnt);
		if (ret)
			goto unlock;
	}
	ret = alloc_descs(start, cnt, node, affinity, owner);
unlock:
	mutex_unlock(&sparse_irq_lock);
	return ret;
}
