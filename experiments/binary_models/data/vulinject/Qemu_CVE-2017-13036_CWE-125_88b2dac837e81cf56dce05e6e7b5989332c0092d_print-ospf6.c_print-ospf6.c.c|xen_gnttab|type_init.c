type_init(xen_gnttab_register_types)
int xen_gnttab_map_page(uint64_t idx, uint64_t gfn)
{
    XenGnttabState *s = xen_gnttab_singleton;
    uint64_t gpa = gfn << XEN_PAGE_SHIFT;
    if (!s) {
        return -ENOTSUP;
    }
    if (idx >= s->max_frames) {
        return -EINVAL;
    }
    BQL_LOCK_GUARD();
    xen_overlay_do_map_page(&s->gnt_aliases[idx], gpa);
    s->gnt_frame_gpas[idx] = gpa;
    if (s->nr_frames <= idx) {
        s->nr_frames = idx + 1;
    }
    return 0;
}
