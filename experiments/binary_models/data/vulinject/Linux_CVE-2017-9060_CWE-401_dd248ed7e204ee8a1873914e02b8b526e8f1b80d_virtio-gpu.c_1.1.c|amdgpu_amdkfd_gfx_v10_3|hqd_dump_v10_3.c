static int hqd_dump_v10_3(struct amdgpu_device *adev,
			unsigned int pipe_id, unsigned int queue_id,
			unsigned int (**dump)[2], unsigned int *n_regs, unsigned int inst)
{
	unsigned int i = 0, reg;
#define HQD_N_REGS 56
#define DUMP_REG(addr) do {				\
		if (WARN_ON_ONCE(i >= HQD_N_REGS))	\
			break;				\
		(*dump)[i][0] = (addr) << 2;		\
		(*dump)[i++][1] = RREG32_SOC15_IP(GC, addr);		\
	} while (0)
	*dump = kmalloc(HQD_N_REGS*2*sizeof(unsigned int), GFP_KERNEL);
	if (*dump == NULL)
		return -ENOMEM;
	acquire_queue(adev, pipe_id, queue_id);
	for (reg = SOC15_REG_OFFSET(GC, 0, mmCP_MQD_BASE_ADDR);
	     reg <= SOC15_REG_OFFSET(GC, 0, mmCP_HQD_PQ_WPTR_HI); reg++)
	release_queue(adev);
	WARN_ON_ONCE(i != HQD_N_REGS);
	*n_regs = i;
	return 0;
}
