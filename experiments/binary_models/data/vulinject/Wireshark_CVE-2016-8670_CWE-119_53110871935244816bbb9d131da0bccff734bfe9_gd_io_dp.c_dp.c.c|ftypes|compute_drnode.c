compute_drnode(size_t field_length, drange_node *drnode, size_t *offset_ptr, size_t *length_ptr)
{
	ssize_t		start_offset;
	ssize_t		length = 0;
	ssize_t		end_offset = 0;
	drange_node_end_t	ending;
	start_offset = drange_node_get_start_offset(drnode);
	ending = drange_node_get_ending(drnode);
	if (start_offset < 0) {
		start_offset = field_length + start_offset;
		if (start_offset < 0) {
			return false;
		}
	}
	if (ending == DRANGE_NODE_END_T_TO_THE_END) {
		length = field_length - start_offset;
		if(length == 0) {
			return false;
		}
	}
	else if (ending == DRANGE_NODE_END_T_LENGTH) {
		length = drange_node_get_length(drnode);
		if (start_offset + length > (int) field_length) {
			return false;
		}
	}
	else if (ending == DRANGE_NODE_END_T_OFFSET) {
		end_offset = drange_node_get_end_offset(drnode);
		if (end_offset < 0) {
			end_offset = field_length + end_offset;
			if (end_offset < start_offset) {
				return false;
			}
		} else if (end_offset >= (int) field_length) {
			return false;
		}
		length = end_offset - start_offset + 1;
	}
	else {
		ws_assert_not_reached();
	}
	*offset_ptr = start_offset;
	*length_ptr = length;
	return true;
}
