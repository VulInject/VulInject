static void dissect_mih_tlv(tvbuff_t *tvb,int offset, proto_tree *tlv_tree, guint8 type, guint32 length)
{
        guint8 mihf_id_len = 0;
        char mihf_id_first_char = 0;
        guint8 i = 0;
        guint8 len = 0;
        tvbuff_t *volatile tvb_mihf_id = NULL;
        tvbuff_t* tvb_temp = NULL;
        volatile gboolean composite_error = FALSE;
        switch (type)
        {
                case SRC_MIHF_ID :
                case DEST_MIHF_ID :
                case MN_MIHF_ID :
                        mihf_id_len = tvb_get_guint8(tvb, offset);
                        mihf_id_first_char = (char)tvb_get_guint8(tvb, offset+1);
                        if(mihf_id_first_char!='\\')
                                proto_tree_add_item(tlv_tree, hf_mihf_id, tvb, offset+1, mihf_id_len, ENC_ASCII);
                        else
                        {
                                if(mihf_id_len<tvb_reported_length_remaining(tvb,0) && (mihf_id_len==12 || mihf_id_len==64 || mihf_id_len==128))
                                {
                                        tvb_mihf_id = tvb_new_composite();
                                        for(i=0; i < mihf_id_len/2; i++)
                                        {
                                                tvb_temp = tvb_new_subset_length(tvb, offset + 2 + 2*i, 1);
                                                if (tvb_captured_length(tvb_temp)) {
                                                        tvb_composite_append(tvb_mihf_id, tvb_temp);
                                                }
                                        }
                                        TRY
                                        {
                                        }
                                        CATCH_ALL
                                        {
                                                composite_error = TRUE;
                                        }
                                        ENDTRY;
                                        if(!composite_error)
                                        {
                                                switch(mihf_id_len)
                                                {
                                                        case 12:  
                                                                proto_tree_add_item(tlv_tree, hf_mihf_id_mac, tvb_mihf_id, 0, mihf_id_len/2, ENC_NA);
                                                                break;
                                                        case 64:  
                                                                proto_tree_add_item(tlv_tree, hf_mihf_id_ipv4, tvb_mihf_id, 0, mihf_id_len/2, ENC_BIG_ENDIAN);
                                                                break;
                                                        case 128: 
                                                                proto_tree_add_item(tlv_tree, hf_mihf_id_ipv6, tvb_mihf_id, 0, mihf_id_len/2, ENC_NA);
                                                                break;
                                                }
                                        }
                                        else
                                                tvb_free(tvb_mihf_id);
                                }
                        }
                        break;
                case STATUS :
                        proto_tree_add_item(tlv_tree, hf_status, tvb, offset, 1, ENC_BIG_ENDIAN);
                        break;
                case LINK_TYPE :
                        proto_tree_add_item(tlv_tree, hf_link_type, tvb, offset, 1, ENC_BIG_ENDIAN);
                        break;
                case MIH_EVT_LIST :
                        proto_tree_add_bitmask(tlv_tree, tvb, offset, hf_event_list, ett_event_bitmap, event_fields, ENC_BIG_ENDIAN);
                        break;
                case MIH_CMD_LIST :
                        proto_tree_add_bitmask(tlv_tree, tvb, offset, hf_cmd_list, ett_cmd_bitmap, cmd_fields, ENC_BIG_ENDIAN);
                        break;
                case MIH_IQ_TYPE_LIST :
                        proto_tree_add_bitmask(tlv_tree, tvb, offset, hf_iq_list, ett_iq_type_bitmap, iq_type_fields, ENC_BIG_ENDIAN);
                        break;
                case MIH_TRANS_LIST :
                        proto_tree_add_bitmask(tlv_tree, tvb, offset, hf_trans_list, ett_trans_list_bitmap, trans_fields, ENC_BIG_ENDIAN);
                        break;
                case LINK_ADDR_LIST :
                        dissect_mih_list(tvb, offset, tlv_tree, dissect_net_type_addr);
                        break;
                case MBB_HO_SUPP_LIST :
                        dissect_mih_list(tvb, offset, tlv_tree, dissect_mbb_ho_supp);
                        break;
                case REG_REQUEST_CODE :
                        proto_tree_add_item(tlv_tree, hf_reg_request_code, tvb, offset, 1, ENC_BIG_ENDIAN);
                        break;
                case VALID_TIME_INTR :
                        proto_tree_add_item(tlv_tree, hf_valid_time_interval, tvb, offset, 4, ENC_BIG_ENDIAN);
                        break;
                case LINK_ID :
                case NEW_LINK_ID :
                case MN_LINK_ID :
                        dissect_link_id(tvb, offset, tlv_tree);
                        break;
                case OLD_ACCESS_ROUTER :
                case NEW_ACCESS_ROUTER :
                case POA_LINK_ADDR :
                        dissect_link_addr(tvb, offset, tlv_tree);
                        break;
                case IP_RENEWAL_FLAG :
                        proto_tree_add_item(tlv_tree, hf_ip_renewal, tvb, offset, 1, ENC_BIG_ENDIAN);
                        break;
                case IP_MOB_MGMT :
                        proto_tree_add_bitmask(tlv_tree, tvb, offset, hf_mob_list, ett_mob_mgt_bitmap, mob_fields, ENC_BIG_ENDIAN);
                        break;
                case IP_CFG_MTHDS :
                        proto_tree_add_bitmask(tlv_tree, tvb, offset, hf_cfg_mthds, ett_cfg_mtd_bitmap, cfg_fields, ENC_BIG_ENDIAN);
                        break;
                case LINK_DN_REASON :
                        proto_tree_add_item(tlv_tree, hf_link_dn_reason, tvb, offset, 1, ENC_BIG_ENDIAN);
                        break;
                case TIMER_INTERVAL :
                        proto_tree_add_item(tlv_tree, hf_time_interval, tvb, offset, 2, ENC_BIG_ENDIAN);
                        break;
                case LINK_GOING_DN_REASON :
                        proto_tree_add_item(tlv_tree, hf_link_gdn_reason, tvb, offset, 1, ENC_BIG_ENDIAN);
                        break;
                case LINK_PARAM_RPT_LIST :
                        dissect_mih_list(tvb, offset, tlv_tree, dissect_link_param_rpt);
                        break;
                case DEV_STATES_REQ :
                        proto_tree_add_bitmask(tlv_tree, tvb, offset, hf_dev_states_req, ett_dev_states_bitmap, dev_states_fields, ENC_BIG_ENDIAN);
                        break;
                case LINK_ID_LIST :
                        dissect_mih_list(tvb, offset, tlv_tree, dissect_link_id);
                        break;
                case DEV_STATES_RSP_LIST :
                        dissect_mih_list(tvb, offset, tlv_tree, dissect_dev_states);
                        break;
                case STATUS_REQ_SET :
                        dissect_link_status_req(tvb, offset, tlv_tree);
                        break;
                case STATUS_RSP_LIST :
                        dissect_mih_list(tvb, offset, tlv_tree, dissect_status_list);
                        break;
                case CFG_REQ_LIST :
                        dissect_mih_list(tvb, offset, tlv_tree, dissect_link_cfg_param);
                        break;
                case CFG_RSP_LIST :
                        dissect_mih_list(tvb, offset, tlv_tree, dissect_link_cfg_status);
                        break;
                case LINK_POA_LIST :
                        dissect_mih_list(tvb, offset, tlv_tree, dissect_link_poa);
                        break;
                case PREF_LINK_LIST :
                        dissect_mih_list(tvb, offset, tlv_tree, dissect_rq_result);
                        break;
                case HO_REQ_QUERY_LIST :
                        dissect_qos_list(tvb, offset, tlv_tree);
                        break;
                case HO_STATUS:
                        proto_tree_add_item(tlv_tree, hf_ho_status, tvb, offset, 1, ENC_BIG_ENDIAN);
                        break;
                case ACCESS_ROUTER_ADDR :
                case DHCP_SER_ADDR :
                case FA_ADDR :
                        dissect_ip_addr(tvb, offset, tlv_tree);
                        break;
                case LINK_ACTION_REQ_LIST :
                        dissect_mih_list(tvb, offset, tlv_tree, dissect_link_action_req);
                        break;
                case LINK_ACTION_RSP_LIST :
                        dissect_mih_list(tvb, offset, tlv_tree, dissect_link_action_rsp);
                        break;
                case HO_RESULT :
                        proto_tree_add_item(tlv_tree, hf_status, tvb, offset, 1, ENC_BIG_ENDIAN);
                        break;
                case LINK_RES_STATUS :
                        proto_tree_add_item(tlv_tree, hf_link_res_status, tvb, offset, 1, ENC_BIG_ENDIAN);
                        break;
                case RES_RETENTION_STATUS :
                        proto_tree_add_item(tlv_tree, hf_res_retention_status, tvb, offset, 1, ENC_BIG_ENDIAN);
                        break;
                case IQ_RDF_SCHEMA_URL :
                        proto_tree_add_item(tlv_tree, hf_iq_rdf_sch_url, tvb, offset, 1, ENC_BIG_ENDIAN);
                        break;
                case Q_RES_RPT_FLAG :
                        proto_tree_add_item(tlv_tree, hf_res_rpt_flag, tvb, offset, 1, ENC_BIG_ENDIAN);
                        break;
                case UNAUTH_INFO_REQ :
                        proto_tree_add_item(tlv_tree, hf_unauth_info_req, tvb, offset, 1, ENC_BIG_ENDIAN);
                        break;
                case IQ_BIN_DATA_LIST :
                        proto_tree_add_item(tlv_tree, hf_iq_bin_data_x, tvb, offset, length, ENC_ASCII);
                        break;
                case IQ_RDF_DATA_LIST :
                case IR_RDF_DATA_LIST :
                case IR_RDF_SCHM_LIST :
                        dissect_mih_list(tvb, offset, tlv_tree, dissect_iq_rdf_data);
                        break;
                case IQ_RDF_SCHM_LIST :
                        for(i=0; i < tvb_get_guint8(tvb, offset); i++)
                        {
                                len = tvb_get_guint8(tvb, offset+1);
                                proto_tree_add_item(tlv_tree, hf_rdf_sch, tvb, offset+2, len, ENC_ASCII);
                                offset += len;
                        }
                        break;
                case MAX_RSP_SIZE :
                        proto_tree_add_item(tlv_tree, hf_max_resp_size, tvb, offset, 2, ENC_BIG_ENDIAN);
                        break;
                case IR_BIN_DATA_LIST :
                        proto_tree_add_item(tlv_tree, hf_ir_bin_data, tvb, offset, length, ENC_ASCII);
                        break;
                case IR_SCHM_URL_LIST :
                        for(i=0; i < tvb_get_guint8(tvb, offset); i++)
                        {
                                len = tvb_get_guint8(tvb, offset+1);
                                proto_tree_add_item(tlv_tree, hf_rdf_sch_url, tvb, offset+2, len, ENC_ASCII);
                                offset += len;
                        }
                        break;
                case EVT_CFG_INFO_LIST :
                        dissect_mih_list(tvb, offset, tlv_tree, dissect_mih_evt_cfg_info);
                        break;
                case TGT_NET_INFO :
                        dissect_tgt_net_info(tvb, offset, tlv_tree);
                        break;
                case TGT_NET_INFO_LIST :
                        dissect_mih_list(tvb, offset, tlv_tree, dissect_tgt_net_info);
                        break;
                case ASGN_RES_SET :
                        offset = dissect_qos_list(tvb, offset, tlv_tree);
                        dissect_tsp_container(tvb, offset, tlv_tree);
                        break;
                case LINK_DET_INFO_LIST :
                        dissect_mih_list(tvb, offset, tlv_tree, dissect_link_det_info);
                        break;
                case NET_TYPE :
                        dissect_net_type(tvb, offset, tlv_tree);
                        break;
                case REQ_RES_SET :
                        offset = dissect_qos_list(tvb, offset, tlv_tree);
                        offset = dissect_tsp_container(tvb, offset, tlv_tree);
                        proto_tree_add_item(tlv_tree, hf_ho_reason, tvb, offset, 1, ENC_BIG_ENDIAN );
                        break;
                case VEND_SPECIFIC_TLV :
                        proto_tree_add_item(tlv_tree, hf_vendor_specific_tlv, tvb, offset, length, ENC_ASCII);
                        break;
                default :
                        if(type > 63 && type < 100)
                                proto_tree_add_item(tlv_tree, hf_reserved_tlv, tvb, offset, length, ENC_ASCII);
                        else if(type > 100 && type < 255)
                                proto_tree_add_item(tlv_tree, hf_experimental_tlv, tvb, offset, length, ENC_ASCII);
                        else
                                proto_tree_add_item(tlv_tree, hf_unknown_tlv, tvb, offset, length, ENC_ASCII);
        }
        return;
}
