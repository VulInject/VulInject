report_new_capture_file(const char *filename)
{
    if (capture_child) {
        ws_debug("File: %s", filename);
        if (global_ld.pcapng_passthrough) {
            ws_debug("Delaying SP_FILE until first SHB");
            report_capture_filename = filename;
        } else {
            sync_pipe_write_string_msg(sync_pipe_fd, SP_FILE, filename);
        }
    } else {
#ifdef SIGINFO
        infodelay = TRUE;
#endif 
        fprintf(stderr, "File: %s\n", filename);
#ifdef SIGINFO
        infodelay = FALSE;
        if (infoprint)
          report_counts_for_siginfo();
#endif 
    }
}
