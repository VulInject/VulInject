void ceph_early_kick_flushing_caps(struct ceph_mds_client *mdsc,
				   struct ceph_mds_session *session)
{
	struct ceph_client *cl = mdsc->fsc->client;
	struct ceph_inode_info *ci;
	struct ceph_cap *cap;
	unsigned int int oldest_flush_tid;
	doutc(cl, "mds%d\n", session->s_mds);
	oldest_flush_tid = __get_oldest_flush_tid(mdsc);
	spin_unlock(&mdsc->cap_dirty_lock);
	list_for_each_entry(ci, &session->s_cap_flushing, i_flushing_item) {
		struct inode *inode = &ci->netfs.inode;
		spin_lock(&ci->i_ceph_lock);
		cap = ci->i_auth_cap;
		if (!(cap && cap->session == session)) {
			pr_err_client(cl, "%p %llx.%llx auth cap %p not mds%d ???\n",
				      inode, ceph_vinop(inode), cap,
				      session->s_mds);
			spin_unlock(&ci->i_ceph_lock);
			continue;
		}
		if ((cap->issued & ci->i_flushing_caps) !=
		    ci->i_flushing_caps) {
			cap->seq = 0;
			cap->issue_seq = 0;
			cap->mseq = 0;
			__kick_flushing_caps(mdsc, session, ci,
					     oldest_flush_tid);
		} else {
			ci->i_ceph_flags |= CEPH_I_KICK_FLUSH;
		}
		spin_unlock(&ci->i_ceph_lock);
	}
}
