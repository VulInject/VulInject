juniper_atm2_if_print(netdissect_options *ndo,
                      const struct pcap_pkthdr *h, const u_char *p)
{
        int llc_hdrlen;
        struct juniper_l2info_t l2info;
        ndo->ndo_protocol = "juniper_atm2";
        memset(&l2info, 0, sizeof(l2info));
        l2info.pictype = DLT_JUNIPER_ATM2;
        if (juniper_parse_header(ndo, p, h, &l2info) == 0) {
            ndo->ndo_ll_hdr_len += l2info.header_len;
            return;
        }
        p+=l2info.header_len;
        if (l2info.cookie[7] & ATM2_PKT_TYPE_MASK) { 
            oam_print(ndo, p, l2info.length, ATM_OAM_NOHEC);
            ndo->ndo_ll_hdr_len += l2info.header_len;
            return;
        }
        if (GET_BE_U_3(p) == 0xfefe03 || 
            GET_BE_U_3(p) == 0xaaaa03) { 
            llc_hdrlen = llc_print(ndo, p, l2info.length, l2info.caplen, NULL, NULL);
            if (llc_hdrlen > 0) {
                ndo->ndo_ll_hdr_len += l2info.header_len;
                return;
            }
        }
        if (l2info.direction != JUNIPER_BPF_PKT_IN && 
            (EXTRACT_BE_U_4(l2info.cookie) & ATM2_GAP_COUNT_MASK)) {
            ether_print(ndo, p, l2info.length, l2info.caplen, NULL, NULL);
            ndo->ndo_ll_hdr_len += l2info.header_len;
            return;
        }
        if (GET_U_1(p) == 0x03) { 
            isoclns_print(ndo, p + 1, l2info.length - 1);
            ndo->ndo_ll_hdr_len += l2info.header_len;
            return;
        }
        if(juniper_ppp_heuristic_guess(ndo, p, l2info.length) != 0) { 
            ndo->ndo_ll_hdr_len += l2info.header_len;
            return;
        }
        if (ip_heuristic_guess(ndo, p, l2info.length) != 0) { 
            ndo->ndo_ll_hdr_len += l2info.header_len;
            return;
        }
        ndo->ndo_ll_hdr_len += l2info.header_len;
}
