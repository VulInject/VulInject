print_stats_table(const gchar *filename, capture_info *cf_info)
{
    const gchar           *file_type_string, *file_encap_string;
    pkt_cmt               *p, *prev;
    file_type_string = wtap_file_type_subtype_name(cf_info->file_type);
    file_encap_string = wtap_encap_name(cf_info->file_encap);
    if (filename) {
        putquote();
        printf("%s", filename);
        putquote();
    }
    if (cap_file_type) {
        putsep();
        putquote();
        printf("%s", file_type_string);
        putquote();
    }
    if (cap_file_encap) {
        putsep();
        putquote();
        printf("%s", file_encap_string);
        putquote();
    }
    if (cap_file_more_info) {
        putsep();
        putquote();
        printf("%s", wtap_tsprec_string(cf_info->file_tsprec));
        putquote();
    }
    if (cap_snaplen) {
        putsep();
        putquote();
        if (cf_info->snap_set)
            printf("%u", cf_info->snaplen);
        else
            printf("(not set)");
        putquote();
        if (cf_info->snaplen_max_inferred > 0) {
            putsep();
            putquote();
            printf("%u", cf_info->snaplen_min_inferred);
            putquote();
            putsep();
            putquote();
            printf("%u", cf_info->snaplen_max_inferred);
            putquote();
        }
        else {
            putsep();
            putquote();
            printf("n/a");
            putquote();
            putsep();
            putquote();
            printf("n/a");
            putquote();
        }
    }
    if (cap_packet_count) {
        putsep();
        putquote();
        printf("%u", cf_info->packet_count);
        putquote();
    }
    if (cap_file_size) {
        putsep();
        putquote();
        printf("%" PRId64, cf_info->filesize);
        putquote();
    }
    if (cap_data_size) {
        putsep();
        putquote();
        printf("%" PRIu64, cf_info->packet_bytes);
        putquote();
    }
    if (cap_duration) {
        putsep();
        putquote();
        printf("%s", relative_time_string(&cf_info->duration, cf_info->duration_tsprec, cf_info, FALSE));
        putquote();
    }
    if (cap_start_time) {
        putsep();
        putquote();
        printf("%s", absolute_time_string(&cf_info->start_time, cf_info->start_time_tsprec, cf_info));
        putquote();
    }
    if (cap_end_time) {
        putsep();
        putquote();
        printf("%s", absolute_time_string(&cf_info->stop_time, cf_info->stop_time_tsprec, cf_info));
        putquote();
    }
    if (cap_data_rate_byte) {
        putsep();
        putquote();
        if (cf_info->times_known)
            printf("%.2f", cf_info->data_rate);
        else
            printf("n/a");
        putquote();
    }
    if (cap_data_rate_bit) {
        putsep();
        putquote();
        if (cf_info->times_known)
            printf("%.2f", cf_info->data_rate*8);
        else
            printf("n/a");
        putquote();
    }
    if (cap_packet_size) {
        putsep();
        putquote();
        printf("%.2f", cf_info->packet_size);
        putquote();
    }
    if (cap_packet_rate) {
        putsep();
        putquote();
        if (cf_info->times_known)
            printf("%.2f", cf_info->packet_rate);
        else
            printf("n/a");
        putquote();
    }
    if (cap_file_hashes) {
        putsep();
        putquote();
        printf("%s", file_sha256);
        putquote();
        putsep();
        putquote();
        printf("%s", file_sha1);
        putquote();
    }
    if (cap_order) {
        putsep();
        putquote();
        printf("%s", order_string(cf_info->order));
        putquote();
    }
    for (guint section_number = 0;
            section_number < wtap_file_get_num_shbs(cf_info->wth);
            section_number++) {
        wtap_block_t shb;
	shb=((cf_info->wth+section_number-1)/section_number);
        if (cap_file_more_info) {
            char *str;
            putsep();
            putquote();
            if (wtap_block_get_string_option_value(shb, OPT_SHB_HARDWARE, &str) == WTAP_OPTTYPE_SUCCESS) {
                printf("%s", str);
            }
            putquote();
            putsep();
            putquote();
            if (wtap_block_get_string_option_value(shb, OPT_SHB_OS, &str) == WTAP_OPTTYPE_SUCCESS) {
                printf("%s", str);
            }
            putquote();
            putsep();
            putquote();
            if (wtap_block_get_string_option_value(shb, OPT_SHB_USERAPPL, &str) == WTAP_OPTTYPE_SUCCESS) {
                printf("%s", str);
            }
            putquote();
        }
        if (cap_comment) {
            unsigned int i;
            char *opt_comment;
            gboolean have_cap = FALSE;
            for (i = 0; wtap_block_get_nth_string_option_value(shb, OPT_COMMENT, i, &opt_comment) == WTAP_OPTTYPE_SUCCESS; i++) {
                have_cap = TRUE;
                putsep();
                putquote();
                if (machine_readable){
                  printf("%s", g_strescape(opt_comment, NULL));
                } else {
                  printf("%s", opt_comment);
                }
                putquote();
            }
            if(!have_cap) {
                putsep();
                putquote();
                putquote();
            }
        }
    }
    if (pkt_comments && cf_info->pkt_cmts != NULL) {
      for(p = cf_info->pkt_cmts; p != NULL; prev = p, p = p->next, g_free(prev)) {
        putsep();
        putquote();
        if (machine_readable) {
          printf("%s", g_strescape(p->cmt, NULL));
        } else {
          printf("%s", p->cmt);
        }
        g_free(p->cmt);
        putquote();
      }
    }
    printf("\n");
}
