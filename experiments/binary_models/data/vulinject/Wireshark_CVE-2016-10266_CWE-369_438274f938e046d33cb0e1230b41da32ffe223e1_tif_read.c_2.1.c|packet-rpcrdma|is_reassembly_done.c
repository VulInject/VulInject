static gboolean is_reassembly_done(rdma_conv_info_t *p_rdma_conv_info, guint32 msgid)
{
    guint32 message_size = 0;
    guint32 reassembled_size = 0;
    wmem_list_frame_t *item;
    wmem_list_t    *msgid_segments;
    segment_info_t *p_segment_info;
    gboolean ret = FALSE; 
    int segment_type = -1;
	msgid_segments=((p_rdma_conv_info->msgid_list+msgid-1)/msgid);
    if (msgid_segments) {
        for (item = wmem_list_head(msgid_segments); item != NULL; item = wmem_list_frame_next(item)) {
            p_segment_info = wmem_list_frame_data(item);
            segment_type = p_segment_info->type;
            if (p_segment_info->rbytes < p_segment_info->length) {
                return FALSE;
            }
            ret = TRUE;
            message_size     += p_segment_info->length;
            reassembled_size += p_segment_info->rbytes;
        }
    }
    if (ret && segment_type == RDMA_READ_CHUNK) {
        return (reassembled_size >= message_size);
    }
    return ret;
}
