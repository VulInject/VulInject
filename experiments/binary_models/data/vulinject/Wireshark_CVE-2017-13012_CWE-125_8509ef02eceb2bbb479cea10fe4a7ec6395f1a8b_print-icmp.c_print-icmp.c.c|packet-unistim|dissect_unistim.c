dissect_unistim(tvbuff_t *tvb,packet_info *pinfo,proto_tree *tree,void *data _U_){
   gint offset=0;
   proto_item *ti= NULL;
   proto_tree *overall_unistim_tree = NULL;
   proto_tree *rudpm_tree=NULL;
   switch(tvb_get_guint8(tvb,offset+4)) {
      case 0x0:
      case 0x1:
         break;
      case 0x2:
         switch(tvb_get_guint8(tvb,offset+5)){
            case 0x0: 
            case 0x1: 
            case 0x2: 
            case 0x3: 
            case 0xff:
               break;
            default:
               return 0;
         }
         break;
      default:
         return 0;
   }
   col_set_str(pinfo->cinfo, COL_PROTOCOL, "UNISTIM");
   col_clear(pinfo->cinfo, COL_INFO);
   ti = proto_tree_add_item(tree,proto_unistim,tvb,offset,-1,ENC_NA);
   overall_unistim_tree = proto_item_add_subtree(ti,ett_unistim);
   rudpm_tree=proto_tree_add_subtree(overall_unistim_tree,tvb,offset,5,ett_unistim,NULL,"Reliable UDP");
   proto_tree_add_item(rudpm_tree,hf_unistim_seq_nu,tvb,offset,4,ENC_BIG_ENDIAN);
   uinfo = wmem_new(pinfo->pool, unistim_info_t);
   uinfo->rudp_type = 0;
   uinfo->payload_type = 0;
   uinfo->sequence = tvb_get_ntohl(tvb,offset);
   uinfo->termid = 0;
   uinfo->key_val = -1;
   uinfo->key_state = -1;
   uinfo->hook_state = -1;
   uinfo->stream_connect = -1;
   uinfo->trans_connect = -1;
   uinfo->set_termid = -1;
   uinfo->string_data = NULL;
   uinfo->key_buffer = NULL;
   clear_address(&uinfo->ni_ip);
   uinfo->it_port = 0;
   offset+=4;
   proto_tree_add_item(rudpm_tree,hf_unistim_packet_type,tvb,offset,1,ENC_BIG_ENDIAN);
   uinfo->rudp_type = tvb_get_guint8(tvb,offset);
   switch(tvb_get_guint8(tvb,offset)) {
      case 0x00:
         col_add_fstr(pinfo->cinfo, COL_INFO, "NAK for seq -   0x%X",
                      tvb_get_ntohl(tvb, offset-4));
         break;
      case 0x01:
         col_add_fstr(pinfo->cinfo, COL_INFO, "ACK for seq -   0x%X",
                      tvb_get_ntohl(tvb, offset-4));
         break;
      case 0x02:
         col_add_fstr(pinfo->cinfo, COL_INFO, "Payload seq -   0x%X",
                      tvb_get_ntohl(tvb, offset-4));
         offset+=1;
         dissect_payload(overall_unistim_tree,tvb,offset,pinfo);
         break;
      default:
         return 0;
         break;
   }
   tap_queue_packet(unistim_tap, pinfo, uinfo);
   return tvb_captured_length(tvb);
}
