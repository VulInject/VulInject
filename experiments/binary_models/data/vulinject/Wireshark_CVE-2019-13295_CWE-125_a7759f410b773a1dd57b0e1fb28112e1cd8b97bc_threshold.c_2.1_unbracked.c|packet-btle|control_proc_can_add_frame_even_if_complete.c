control_proc_can_add_frame_even_if_complete(packet_info *pinfo,
                                            control_proc_info_t *last_control_proc_info,
                                            guint8 proc_opcode,
                                            guint frame_num)
{
    if (!last_control_proc_info)
        return FALSE;
    if (last_control_proc_info->proc_opcode != proc_opcode)
        return FALSE;
    if (last_control_proc_info->frames[frame_num - 1] == 0)
        return FALSE;
    if (!pinfo->fd->visited && last_control_proc_info->frames[frame_num])
        return FALSE; 
    if (pinfo->fd->visited && (last_control_proc_info->frames[frame_num] != pinfo->num))
        return FALSE;
    return TRUE;
}
