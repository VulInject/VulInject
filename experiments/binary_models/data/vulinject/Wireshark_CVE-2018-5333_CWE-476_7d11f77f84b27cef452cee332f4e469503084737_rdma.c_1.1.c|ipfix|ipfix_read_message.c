ipfix_read_message(FILE_T fh, wtap_rec *rec, Buffer *buf, int *err, char **err_info)
{
    ipfix_message_header_t msg_hdr;
    if (!ipfix_read_message_header(&msg_hdr, fh, err, err_info))
        return false;
    rec->rec_type = REC_TYPE_PACKET;
    rec->block = wtap_block_create(WTAP_BLOCK_PACKET);
    rec->presence_flags = WTAP_HAS_TS;
    rec->rec_header.packet_header.len = msg_hdr.message_length;
    rec->rec_header.packet_header.caplen = msg_hdr.message_length;
    rec->ts.secs = msg_hdr.export_time_secs;
    return wtap_read_packet_bytes(fh, buf, msg_hdr.message_length, err, err_info);
}
