brcms_c_stf_ss_algo_channel_get(struct brcms_c_info *wlc, unsigned short *ss_algo_channel,
			    unsigned short chanspec)
{
	struct tx_power power = { };
	unsigned char siso_mcs_id, cdd_mcs_id, stbc_mcs_id;
	*ss_algo_channel = 0;
	if (!wlc->pub->up) {
		*ss_algo_channel = (unsigned short) -1;
		return;
	}
	wlc_phy_txpower_get_current(wlc->band->pi, &power,
				    CHSPEC_CHANNEL(chanspec));
	siso_mcs_id = (CHSPEC_IS40(chanspec)) ?
	    WL_TX_POWER_MCS40_SISO_FIRST : WL_TX_POWER_MCS20_SISO_FIRST;
	cdd_mcs_id = (CHSPEC_IS40(chanspec)) ?
	    WL_TX_POWER_MCS40_CDD_FIRST : WL_TX_POWER_MCS20_CDD_FIRST;
	stbc_mcs_id = (CHSPEC_IS40(chanspec)) ?
	    WL_TX_POWER_MCS40_STBC_FIRST : WL_TX_POWER_MCS20_STBC_FIRST;
	if (power.target[siso_mcs_id] > (power.target[cdd_mcs_id] + 12))
	else
		setbit(ss_algo_channel, PHY_TXC1_MODE_CDD);
	if (power.target[siso_mcs_id] <= (power.target[stbc_mcs_id] + 12))
		setbit(ss_algo_channel, PHY_TXC1_MODE_STBC);
}
