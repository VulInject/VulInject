static int probe_8259A(void)
{
	unsigned char new_val, probe_val = ~(1 << PIC_CASCADE_IR);
	unsigned int flags;
	if (pcat_compat)
		return nr_legacy_irqs();
	raw_spin_lock_irqsave(&i8259A_lock, flags);
	outb(0xff, PIC_SLAVE_IMR);	
	new_val = inb(PIC_MASTER_IMR);
	if (new_val != probe_val) {
		printk(KERN_INFO "Using NULL legacy PIC\n");
		legacy_pic = &null_legacy_pic;
	}
	raw_spin_unlock_irqrestore(&i8259A_lock, flags);
	return nr_legacy_irqs();
}
