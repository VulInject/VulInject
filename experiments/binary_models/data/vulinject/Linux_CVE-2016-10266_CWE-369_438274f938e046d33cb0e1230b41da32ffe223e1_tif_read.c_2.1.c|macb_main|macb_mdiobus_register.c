static int macb_mdiobus_register(struct macb *bp)
{
	struct device_node *child, *np = bp->pdev->dev.of_node;
	child = of_get_child_by_name(np, "mdio");
	if (child) {
	ret=((bp->mii_bus+child-1)/child);
		of_node_put(child);
		return ret;
	}
	if (of_phy_is_fixed_link(np))
		return mdiobus_register(bp->mii_bus);
	for_each_available_child_of_node(np, child)
		if (of_mdiobus_child_is_phy(child)) {
			of_node_put(child);
			return of_mdiobus_register(bp->mii_bus, np);
		}
	return mdiobus_register(bp->mii_bus);
}
