fAbstractSyntaxNType(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint offset)
{
    guint8  tag_no, tag_info;
    guint32 lvt;
    guint   lastoffset = 0, depth = 0;
    char    ar[256];
    guint32 save_object_type;
    gboolean do_default_handling;
    if (propertyIdentifier >= 0) {
        snprintf(ar, sizeof(ar), "%s: ",
            val_to_split_str(propertyIdentifier, 512,
                BACnetPropertyIdentifier,
                ASHRAE_Reserved_Fmt,
                Vendor_Proprietary_Fmt));
    } else {
        snprintf(ar, sizeof(ar), "Abstract Type: ");
    }
    unsigned recursion_depth = p_get_proto_depth(pinfo, proto_bacapp);
    if (recursion_depth > BACAPP_MAX_RECURSION_DEPTH) {
        proto_tree_add_expert(tree, pinfo, &ei_bacapp_max_recursion_depth_reached, tvb, 0, 0);
        return offset;
    }
    p_set_proto_depth(pinfo, proto_bacapp, recursion_depth + 1);
    while (tvb_reported_length_remaining(tvb, offset) > 0) {  
        lastoffset = offset;
        fTagHeader(tvb, pinfo, offset, &tag_no, &tag_info, &lvt);
        if (tag_is_closing(tag_info)) { 
		if(depth == 0) {
                goto cleanup;
            }
        }
        do_default_handling = FALSE;
        switch (propertyIdentifier) {
        case 0: 
        case 35: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar,
            BACnetAcknowledgedTransitions);
            break;
        case 2: 
                if (tag_is_context_specific(tag_info)) {
                    offset = fActionList(tvb, pinfo, tree, offset);
                } else {
                    offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar,
                        BACnetAction);
                }
                break;
        case 7: 
            switch (object_type) {
            case 21: 
            case 22: 
              offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetLifeSafetyState);
              break;
            case 30: 
              offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetDoorAlarmState);
              break;
            case 31: 
              offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetTimerState);
              break;
            case 36: 
              offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetAccessZoneOccupancyState);
              break;
            case 39: 
            default:
              if (tag_info) {
                if (tag_is_opening(tag_info)) {
                  ++depth;
                  offset += fTagHeaderTree(tvb, pinfo, tree, offset, &tag_no, &tag_info, &lvt);
                }
                else if (tag_is_closing(tag_info)) {
                  --depth;
                  offset += fTagHeaderTree(tvb, pinfo, tree, offset, &tag_no, &tag_info, &lvt);
                }
                else {
                  offset = fContextTaggedValue(tvb, pinfo, tree, offset, ar);
                }
              }
              else {
                offset = fApplicationTypes(tvb, pinfo, tree, offset, ar);
              }
              break;
            }
            break;
        case 37: 
            offset = fEventType(tvb, pinfo, tree, offset);
            break;
        case 39: 
            switch (object_type) {
            case 21: 
            case 22: 
              offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetLifeSafetyState);
              break;
            case 30: 
              offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetDoorAlarmState);
              break;
            case 31: 
              offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetTimerState);
              break;
            case 36: 
              offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetAccessZoneOccupancyState);
              break;
            case 39: 
            default:
              if (tag_info) {
                if (tag_is_opening(tag_info)) {
                  ++depth;
                  offset += fTagHeaderTree(tvb, pinfo, tree, offset, &tag_no, &tag_info, &lvt);
                }
                else if (tag_is_closing(tag_info)) {
                  --depth;
                  offset += fTagHeaderTree(tvb, pinfo, tree, offset, &tag_no, &tag_info, &lvt);
                }
                else {
                  offset = fContextTaggedValue(tvb, pinfo, tree, offset, ar);
                }
              }
              else {
                offset = fApplicationTypes(tvb, pinfo, tree, offset, ar);
              }
              break;
            }
            break;
        case 30: 
        case 331: 
            offset = fAddressBinding(tvb, pinfo, tree, offset);
            break;
        case 52: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetLimitEnable);
            break;
        case 54: 
            offset = fLOPR(tvb, pinfo, tree, offset);
            break;
        case 55: 
            fSessionKey(tvb, pinfo, tree, offset);
            break;
        case 77: 
            offset = fObjectName(tvb, pinfo, tree, offset);
            break;
        case 79: 
        case 96: 
            offset = fApplicationTypesEnumeratedSplit(tvb, pinfo, tree, offset, ar,
                BACnetObjectType, 128);
            break;
        case 97: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar,
                BACnetServicesSupported);
            break;
        case 102: 
            offset = fDestination(tvb, pinfo, tree, offset);
            break;
        case 107: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar,
                BACnetSegmentation);
            break;
        case 111: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar,
                BACnetStatusFlags);
            break;
        case 112: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar,
                BACnetDeviceStatus);
            break;
        case 117: 
        case 455: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar,
                BACnetEngineeringUnits);
            break;
        case 87:    
            if (propertyArrayIndex == 0) {
                offset = fApplicationTypes(tvb, pinfo, tree, offset, ar);
            } else {
                offset = fPriorityArray(tvb, pinfo, tree, offset);
            }
            break;
        case 38:    
            if (object_type < 128) {
                if (propertyArrayIndex == 0) {
                    offset = fApplicationTypes(tvb, pinfo, tree, offset, ar);
                } else {
                    offset = fSpecialEvent(tvb, pinfo, tree, offset);
                }
            }
            break;
        case 19:  
        case 60:  
        case 78:  
        case 181: 
        case 355: 
            offset = fObjectPropertyReference(tvb, pinfo, tree, offset);
            break;
        case 132: 
            offset = fDeviceObjectPropertyReference(tvb, pinfo, tree, offset);
            break;
        case 109: 
            offset += fTagHeaderTree(tvb, pinfo, tree, offset, &tag_no, &tag_info, &lvt);
            offset = fBACnetObjectPropertyReference(tvb, pinfo, tree, offset);
            offset += fTagHeaderTree(tvb, pinfo, tree, offset, &tag_no, &tag_info, &lvt);
            break;
        case 123:   
            if (object_type < 128) {
                if (propertyArrayIndex == 0) {
                    offset = fApplicationTypes(tvb, pinfo, tree, offset, ar);
                } else {
                    offset = fWeeklySchedule(tvb, pinfo, tree, offset);
                }
            }
            break;
        case 127:   
            offset = fClientCOV(tvb, pinfo, tree, offset);
            break;
        case 131:  
            if ( object_type == 61 )
                offset = fAuditLogRecord(tvb, pinfo, tree, offset);
            else if ( object_type == 25 )
                offset = fEventLogRecord(tvb, pinfo, tree, offset);
            else if ( object_type == 27 )
                offset = fLogMultipleRecord(tvb, pinfo, tree, offset);
            else
                offset = fLogRecord(tvb, pinfo, tree, offset);
            break;
        case 159: 
        case 165: 
        case 211: 
        case 246: 
        case 249: 
        case 252: 
        case 265: 
        case 266: 
        case 277: 
        case 279: 
        case 286: 
        case 320: 
        case 321: 
        case 461: 
        case 491: 
            offset = fDeviceObjectReference(tvb, pinfo, tree, offset);
            break;
        case 196: 
            offset = fRestartReason(tvb, pinfo, tree, offset);
            break;
        case 212: 
        case 214: 
        case 218: 
            offset = fShedLevel(tvb, pinfo, tree, offset);
            break;
        case 152: 
            offset = fCOVSubscription(tvb, pinfo, tree, offset);
            break;
        case 23: 
            offset = fCalendarEntry(tvb, pinfo, tree, offset);
            break;
        case 116: 
        case 206: 
        case 202: 
            offset = fRecipient(tvb, pinfo, tree, offset);
            break;
        case 83: 
            offset = fEventParameter(tvb, pinfo, tree, offset);
            break;
        case 130: 
            if (propertyArrayIndex == 0) {
                offset = fApplicationTypes(tvb, pinfo, tree, offset, ar);
            } else {
                offset = fEventTimeStamps(tvb, pinfo, tree, offset);
            }
            break;
        case 197: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetLoggingType);
            break;
        case 36: 
            offset = fApplicationTypesEnumeratedSplit(tvb, pinfo, tree, offset, ar, BACnetEventState, 64);
            break;
        case 103: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetReliability);
            break;
        case 72: 
            offset = fNotifyType(tvb, pinfo, tree, offset);
            break;
        case 208: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetNodeType);
            break;
        case 231: 
        case 450: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetDoorStatus);
            break;
        case 233: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetLockStatus);
            break;
        case 235: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetDoorSecuredStatus);
            break;
        case 158: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetMaintenance);
            break;
        case 92: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetProgramState);
            break;
        case 90: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetProgramRequest);
            break;
        case 100: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetProgramError);
            break;
        case 157: 
            offset = fTimeStamp(tvb, pinfo, tree, offset, ar);
            break;
        case 160: 
        case 175: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetLifeSafetyMode);
            break;
        case 163: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetSilencedState);
            break;
        case 161: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetLifeSafetyOperation);
            break;
        case 164: 
            if (object_type == 21 || object_type == 22) 
                offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetLifeSafetyState);
            else if (object_type == 63) 
                offset = fXyColor(tvb, pinfo, tree, offset, ar);
            else if (object_type == 64) 
                offset = fUnsignedTag(tvb, pinfo, tree, offset, ar);
            else if (object_type == 54) 
                offset = fRealTag(tvb, pinfo, tree, offset, ar);
            break;
        case 166: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetLifeSafetyState);
            break;
        case 41: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetFileAccessMethod);
            break;
        case 185:  
            offset = fPrescale(tvb, pinfo, tree, offset);
            break;
        case 187:  
            offset = fScale(tvb, pinfo, tree, offset);
            break;
        case 189: 
            if (object_type == 37) 
                offset = fTimeStamp(tvb, pinfo, tree, offset, ar);
            else
                offset = fDateTime(tvb, pinfo, tree, offset, ar);
            break;
        case 184: 
            offset = fLoggingRecord(tvb, pinfo, tree, offset);
            break;
        case 203: 
            offset = fTimeStamp(tvb, pinfo, tree, offset, ar);
            break;
        case 226: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetDoorAlarmState);
            break;
        case 228: 
            offset = fDoorMembers(tvb, pinfo, tree, offset);
            break;
        case 234: 
            offset = fSequenceOfEnums(tvb, pinfo, tree, offset, ar, BACnetDoorAlarmState);
            break;
        case 248: 
            offset = fAuthenticationFactor(tvb, pinfo, tree, offset);
            break;
        case 261: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetAuthorizationMode);
            break;
        case 53:  
            save_object_type = object_type;
            offset = fListOfGroupMembers(tvb, pinfo, tree, offset);
            object_type = save_object_type;
            break;
        case 296: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetAccessZoneOccupancyState);
            break;
        case 300: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetAccessPassbackMode);
            break;
        case 303: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetAccessCredentialDisableReason);
            break;
        case 318: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetAccessUserType);
            break;
        case 330: 
            offset = fSecurityKeySet(tvb, pinfo, tree, offset);
            break;
        case 332: 
            offset = fNetworkSecurityPolicy(tvb, pinfo, tree, offset);
            break;
        case 338: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetBackupState);
            break;
        case 370: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetWriteStatus);
            break;
        case 385: 
            if (object_type == 54) 
                offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetLightingTransition);
            else if (object_type == 63) 
                offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetColorTransition);
            else if (object_type == 64) 
                offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetColorTransition);
            break;
        case 288: 
        case 302: 
            offset = fAccessRule(tvb, pinfo, tree, offset);
            break;
        case 304: 
            offset = fAuthenticationFactorFormat(tvb, pinfo, tree, offset);
            break;
        case 327: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetSecurityLevel);
            break;
        case 371: 
            offset = fSequenceOfEnums(tvb, pinfo, tree, offset, ar, BACnetPropertyIdentifier);
            break;
        case 358: 
            offset = fFaultParameter(tvb, pinfo, tree, offset);
            break;
        case 359: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetFaultType);
            break;
        case 362: 
            offset = fEventNotificationSubscription(tvb, pinfo, tree, offset);
            break;
        case 364: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetAuthorizationExemption);
            break;
        case 378: 
            if (object_type == 54) 
                offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetLightingInProgress);
            else if (object_type == 63) 
                offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetColorOperationInProgress);
            else if (object_type == 64) 
                offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetColorOperationInProgress);
            break;
        case 380: 
            offset = fLightingCommand(tvb, pinfo, tree, offset, ar);
            break;
        case 16:  
        case 71:  
        case 114: 
        case 115: 
        case 142: 
        case 143: 
        case 149: 
        case 150: 
        case 179: 
        case 192: 
        case 254: 
        case 270: 
        case 278: 
        case 280: 
        case 281: 
        case 392: 
            offset = fDateTime(tvb, pinfo, tree, offset, ar);
            break;
        case 258: 
            offset = fAuthenticationPolicy(tvb, pinfo, tree, offset);
            break;
        case 395: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetTimerTransition);
            break;
        case 396: 
            offset = fTimerStateChangeValue(tvb, pinfo, tree, offset);
            break;
        case 398: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetTimerState);
            break;
        case 407: 
        case 418: 
            offset = fHostNPort(tvb, pinfo, tree, offset, ar);
            break;
        case 408: 
        case 435: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetIpMode);
            break;
        case 414: 
            offset = fBDTEntry(tvb, pinfo, tree, offset, ar);
            break;
        case 415: 
            offset = fFDTEntry(tvb, pinfo, tree, offset, ar);
            break;
        case 417: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetNetworkPortCommand);
            break;
        case 426: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetNetworkNumberQuality);
            break;
        case 427: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetNetworkType);
            break;
        case 428: 
            offset = fRouterEntry(tvb, pinfo, tree, offset);
            break;
        case 429: 
            offset = fVMACEntry(tvb, pinfo, tree, offset);
            break;
        case 430: 
            if (propertyArrayIndex == 0) {
                offset = fApplicationTypes(tvb, pinfo, tree, offset, ar);
            } else {
                offset = fTimeStamp(tvb, pinfo, tree, offset, ar);
            }
            break;
        case 432: 
            offset = fTimeStamp(tvb, pinfo, tree, offset, ar);
            break;
        case 433: 
            offset = fValueSource(tvb, pinfo, tree, offset);
            break;
        case 434: 
            if (propertyArrayIndex == 0) {
                offset = fApplicationTypes(tvb, pinfo, tree, offset, ar);
            } else {
                offset = fValueSource(tvb, pinfo, tree, offset);
            }
            break;
        case 447: 
            offset = fAssignedLandingCalls(tvb, pinfo, tree, offset);
            break;
        case 448: 
        case 457: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetLiftCarDirection);
            break;
        case 449: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetLiftCarDoorCommand);
            break;
        case 453: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetLiftCarDriveStatus);
            break;
        case 456: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetLiftCarMode);
            break;
        case 462: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetEscalatorMode);
            break;
        case 463: 
            if (propertyArrayIndex == 0) {
                offset = fApplicationTypes(tvb, pinfo, tree, offset, ar);
            } else {
                if (object_type == 59) 
                    offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetLiftFault);
                else
                    offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetEscalatorFault);
            }
            break;
        case 467: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetLiftGroupMode);
            break;
        case 470: 
            if (propertyArrayIndex == 0) {
                offset = fApplicationTypes(tvb, pinfo, tree, offset, ar);
            } else {
                offset = fLandingCallStatus(tvb, pinfo, tree, offset);
            }
            break;
        case 471: 
            offset = fLandingCallStatus(tvb, pinfo, tree, offset);
            break;
        case 472: 
            if (propertyArrayIndex == 0) {
                offset = fApplicationTypes(tvb, pinfo, tree, offset, ar);
            } else {
                offset = fLandingDoorStatus(tvb, pinfo, tree, offset);
            }
            break;
        case 477: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetEscalatorOperationDirection);
            break;
        case 481: 
            if (propertyArrayIndex == 0) {
                offset = fApplicationTypes(tvb, pinfo, tree, offset, ar);
            } else {
                offset = fCOVMultipleSubscription(tvb, pinfo, tree, offset);
            }
            break;
        case 482: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetProtocolLevel);
            break;
        case 486: 
            if (propertyArrayIndex == 0) {
                offset = fApplicationTypes(tvb, pinfo, tree, offset, ar);
            } else {
                offset = fNameValue(tvb, pinfo, tree, offset);
            }
            break;
        case 487: 
            if (propertyArrayIndex == 0) {
                offset = fApplicationTypes(tvb, pinfo, tree, offset, ar);
            } else {
                offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetNodeType);
            }
            break;
        case 488: 
            if (propertyArrayIndex == 0) {
                offset = fApplicationTypes(tvb, pinfo, tree, offset, ar);
            } else {
                offset = fNameValueCollection(tvb, pinfo, tree, offset);
            }
            break;
        case 489: 
            if (propertyArrayIndex == 0) {
                offset = fApplicationTypes(tvb, pinfo, tree, offset, ar);
            } else {
                offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetRelationship);
            }
            break;
        case 490: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetRelationship);
            break;
        case 494: 
            if (propertyArrayIndex == 0) {
                offset = fApplicationTypes(tvb, pinfo, tree, offset, ar);
            } else {
                offset = fStageLimitValue(tvb, pinfo, tree, offset);
            }
            break;
        case 498: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetAuditLevel);
            break;
        case 500: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetAuditPriorityFilter);
            break;
        case 501: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetAuditOperation);
            break;
        case 504: 
            if (propertyArrayIndex == 0) {
                offset = fApplicationTypes(tvb, pinfo, tree, offset, ar);
            } else {
                offset = fObjectSelector(tvb, pinfo, tree, offset);
            }
            break;
        case 510:     
        case 4194307: 
            offset = fHealth(tvb, pinfo, tree, offset);
            break;
        case 4194312: 
            offset = fSCDirectConnection(tvb, pinfo, tree, offset);
            break;
        case 4194315: 
            offset = fSCFailedConnectionRequest(tvb, pinfo, tree, offset);
            break;
        case 4194316: 
        case 4194324: 
            offset = fSCHubConnection(tvb, pinfo, tree, offset);
            break;
        case 4194318: 
            offset = fApplicationTypesEnumerated(tvb, pinfo, tree, offset, ar, BACnetSCHubConnectorState);
            break;
        case 4194321: 
            offset = fSCHubFunctionConnection(tvb, pinfo, tree, offset);
            break;
        case 4194330: 
            offset = fXyColor(tvb, pinfo, tree, offset, ar);
            break;
        case 4194334: 
            offset = fColorCommand(tvb, pinfo, tree, offset, ar);
            break;
        case 85:  
            if ( object_type == 11 )    
            {
                offset = fReadAccessResult(tvb, pinfo, tree, offset);
            }
            else if (object_type == 30)  
            {
                offset = fPresentValue(tvb, pinfo, tree, offset, BACnetDoorValue, 0, BACAPP_PRESENT_VALUE_ENUM);
            }
            else if (object_type == 21)  
            {
                offset = fPresentValue(tvb, pinfo, tree, offset, BACnetLifeSafetyState, 0, BACAPP_PRESENT_VALUE_ENUM);
            }
            else if (object_type == 22)  
            {
                offset = fPresentValue(tvb, pinfo, tree, offset, BACnetLifeSafetyState, 0, BACAPP_PRESENT_VALUE_ENUM);
            }
            else if (object_type == 53) 
            {
                offset = fChannelValue(tvb, pinfo, tree, offset, ar);
            }
            else if (object_type == 37) 
            {
                offset = fAuthenticationFactor(tvb, pinfo, tree, offset);
            }
            else if (object_type == 26) 
            {
                offset = fPropertyAccessResult(tvb, pinfo, tree, offset);
            }
            else if (object_type == 28) 
            {
                offset = fPresentValue(tvb, pinfo, tree, offset, BACnetShedState, 0, BACAPP_PRESENT_VALUE_ENUM);
            }
            else if (object_type == 43) 
            {
                offset = fDateTime(tvb, pinfo, tree, offset, ar);
            }
            else if (object_type == 44) 
            {
                offset = fDateTime(tvb, pinfo, tree, offset, ar);
            }
            else if (object_type == 63) 
            {
                offset = fXyColor(tvb, pinfo, tree, offset, ar);
            }
            else
            {
                if (!tag_info) {
                    fTagHeader(tvb, pinfo, offset, &tag_no, &tag_info, &lvt);
                    if (!tag_is_context_specific(tag_info) && tag_no <= 12) {
                        offset = fPresentValue(tvb, pinfo, tree, offset, NULL, 0, (BacappPresentValueType) tag_no);
                    }
                } else {
                    do_default_handling = TRUE;
                }
            }
            break;
        default:
            do_default_handling = TRUE;
            break;
        }
        if (do_default_handling) {
            if (tag_info) {
                if (tag_is_opening(tag_info)) {
                    ++depth;
                    offset += fTagHeaderTree(tvb, pinfo, tree, offset, &tag_no, &tag_info, &lvt);
                } else if (tag_is_closing(tag_info)) {
                    --depth;
                    offset += fTagHeaderTree(tvb, pinfo, tree, offset, &tag_no, &tag_info, &lvt);
                } else {
                    offset  = fContextTaggedValue(tvb, pinfo, tree, offset, ar);
                }
            } else {
                offset = fApplicationTypes(tvb, pinfo, tree, offset, ar);
            }
        }
        if (offset <= lastoffset) break;     
    }
cleanup:
    recursion_depth = p_get_proto_depth(pinfo, proto_bacapp);
    p_set_proto_depth(pinfo, proto_bacapp, recursion_depth);
    return offset;
}
