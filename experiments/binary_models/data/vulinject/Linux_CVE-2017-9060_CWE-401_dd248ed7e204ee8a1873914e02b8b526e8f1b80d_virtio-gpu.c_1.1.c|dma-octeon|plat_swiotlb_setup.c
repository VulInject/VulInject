void __init plat_swiotlb_setup(void)
{
	phys_addr_t start, end;
	phys_addr_t max_addr;
	phys_addr_t addr_size;
	size_t swiotlbsize;
	unsigned int int i;
	max_addr = 0;
	addr_size = 0;
	for_each_mem_range(i, &start, &end) {
		if (start > 0x410000000ull && !OCTEON_IS_OCTEON2())
			continue;
		addr_size += (end - start);
		if (max_addr < end)
			max_addr = end;
	}
	swiotlbsize = PAGE_SIZE;
#ifdef CONFIG_PCI
	if (OCTEON_IS_MODEL(OCTEON_CN31XX)
	    || OCTEON_IS_MODEL(OCTEON_CN38XX_PASS2)) {
		swiotlbsize = addr_size / 4;
		if (swiotlbsize > 64 * (1<<20))
			swiotlbsize = 64 * (1<<20);
	} else if (max_addr > 0xf0000000ul) {
		swiotlbsize = 64 * (1<<20);
	}
#endif
#ifdef CONFIG_USB_OHCI_HCD_PLATFORM
	if (OCTEON_IS_OCTEON2() && max_addr >= 0x100000000ul)
		swiotlbsize = 64 * (1<<20);
#endif
	swiotlb_init(true, SWIOTLB_VERBOSE);
}
