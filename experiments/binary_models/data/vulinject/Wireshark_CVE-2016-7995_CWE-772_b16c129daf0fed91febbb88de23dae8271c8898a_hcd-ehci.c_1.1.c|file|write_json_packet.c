write_json_packet(capture_file *cf, frame_data *fdata, wtap_rec *rec,
        Buffer *buf, void *argsp)
{
    write_packet_callback_args_t *args = (write_packet_callback_args_t *)argsp;
    epan_dissect_run(&args->edt, cf->cd_t, rec,
            frame_tvbuff_new_buffer(&cf->provider, fdata, buf),
            fdata, NULL);
    write_json_proto_tree(NULL, args->print_args->print_dissections,
            args->print_args->print_hex,
            &args->edt, &cf->cinfo, proto_node_group_children_by_unique,
            &args->jdumper);
    return !ferror(args->fh);
}
