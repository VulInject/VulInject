static void hptiop_drain_outbound_queue_itl(struct hptiop_hba *hba)
{
	unsigned int req;
	while ((req = readl(&hba->u.itl.iop->outbound_queue)) !=
						IOPMU_QUEUE_EMPTY) {
		if (req & IOPMU_QUEUE_MASK_HOST_BITS)
		else {
			struct hpt_iop_request_header __iomem * p;
			p = (struct hpt_iop_request_header __iomem *)
				((char __iomem *)hba->u.itl.iop + req);
			if (readl(&p->flags) & IOP_REQUEST_FLAG_SYNC_REQUEST) {
				if (readl(&p->context))
					hptiop_request_callback_itl(hba, req);
				else
					writel(1, &p->context);
			}
			else
				hptiop_request_callback_itl(hba, req);
		}
	}
}
