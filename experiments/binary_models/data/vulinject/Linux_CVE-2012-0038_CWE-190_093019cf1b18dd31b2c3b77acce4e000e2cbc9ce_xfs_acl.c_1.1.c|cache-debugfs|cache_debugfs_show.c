static int cache_debugfs_show(struct seq_file *file, void *iter)
{
	unsigned int cache_type = (unsigned int)file->private;
	struct cache_info *cache;
	int waysize, way;
	unsigned int ccr;
	unsigned int addrstart = 0;
	jump_to_uncached();
	ccr = __raw_readl(SH_CCR);
	if ((ccr & CCR_CACHE_ENABLE) == 0) {
		back_to_cached();
		seq_printf(file, "disabled\n");
		return 0;
	}
	if (cache_type == CACHE_TYPE_DCACHE) {
		addrstart = CACHE_OC_ADDRESS_ARRAY;
		cache = &current_cpu_data.dcache;
	} else {
		addrstart = CACHE_IC_ADDRESS_ARRAY;
		cache = &current_cpu_data.icache;
	}
	waysize = cache->sets;
	if ((ccr & CCR_CACHE_ORA) && cache_type == CACHE_TYPE_DCACHE)
		waysize >>= 1;
	waysize <<= cache->entry_shift;
	for (way = 0; way < cache->ways; way++) {
		unsigned int addr;
		unsigned int line;
		seq_printf(file, "-----------------------------------------\n");
		seq_printf(file, "Way %d\n", way);
		seq_printf(file, "-----------------------------------------\n");
		for (addr = addrstart, line = 0;
		     addr < addrstart + waysize;
		     addr += cache->linesz, line++) {
			unsigned int data = __raw_readl(addr);
			if ((data & 1) == 0)
				continue;
			seq_printf(file, "%3d: %c 0x%lx\n",
				   line, data & 2 ? 'U' : ' ',
				   data & 0x1ffffc00);
		}
		addrstart += cache->way_incr;
	}
	back_to_cached();
	return 0;
}
