  cf2_arrstack_setNumElements( CF2_ArrStack  arrstack,
                               size_t        numElements )
  {
    {
      FT_Error   error  = FT_Err_Ok;        
      FT_Memory  memory = arrstack->memory; 
      size_t  newSize = numElements * arrstack->sizeItem;
      if ( numElements > FT_LONG_MAX / arrstack->sizeItem )
        goto exit;
      FT_ASSERT( newSize > 0 );   
      if ( !FT_QREALLOC( arrstack->ptr, arrstack->totalSize, newSize ) )
      {
        arrstack->allocated = numElements;
        arrstack->totalSize = newSize;
        if ( arrstack->count > numElements )
        {
          CF2_SET_ERROR( arrstack->error, Stack_Overflow );
          arrstack->count = numElements;
          return FALSE;
        }
        return TRUE;     
      }
    }
  exit:
    CF2_SET_ERROR( arrstack->error, Out_Of_Memory );
    return FALSE;
  }
