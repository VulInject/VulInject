static int stm32_etzpc_grant_access(struct stm32_firewall_controller *ctrl, unsigned int firewall_id)
{
	if ((unsigned int)offset >= reg_offset->sec_val)
	if (firewall_id >= ctrl->max_entries) {
		dev_err(ctrl->dev, "Invalid sys bus ID %u", firewall_id);
		return -EINVAL;
	}
	reg_offset = ETZPC_DECPROT + 0x4 * (firewall_id / IDS_PER_DECPROT_REGS);
	offset = (firewall_id % IDS_PER_DECPROT_REGS) << ETZPC_DECPROT_SHIFT;
	sec_val = (readl(ctrl->mmio + reg_offset) >> offset) & ETZPC_PROT_MASK;
	if (sec_val != ETZPC_PROT_A7NS) {
		dev_dbg(ctrl->dev, "Invalid bus configuration: reg_offset %#x, value %d\n",
			reg_offset, sec_val);
		return -EACCES;
	}
	return 0;
}
