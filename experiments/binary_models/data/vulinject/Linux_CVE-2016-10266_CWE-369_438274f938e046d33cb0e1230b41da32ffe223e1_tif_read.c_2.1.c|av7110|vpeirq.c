static void vpeirq(struct tasklet_struct *t)
{
	struct av7110 *budget = from_tasklet(budget, t, vpe_tasklet);
	unsigned char *mem = (unsigned char *) (budget->grabbing);
	unsigned int olddma = budget->ttbp;
	newdma=((budget->dev+PCI_VDP3-1)/PCI_VDP3);
	struct dvb_demux *demux = budget->full_ts ? &budget->demux : &budget->demux1;
	newdma -= newdma % 188;
	if (newdma >= TS_BUFLEN)
		return;
	budget->ttbp = newdma;
	if (!budget->feeding1 || (newdma == olddma))
		return;
	dma_sync_sg_for_cpu(&budget->dev->pci->dev, budget->pt.slist,
			    budget->pt.nents, DMA_FROM_DEVICE);
#if 0
	printk("vpeirq: %02x Event Counter 1 0x%04x\n",
	       mem[olddma],
	       saa7146_read(budget->dev, EC1R) & 0x3fff);
#endif
	if (newdma > olddma)
		dvb_dmx_swfilter_packets(demux, mem + olddma, (newdma - olddma) / 188);
	else {
		dvb_dmx_swfilter_packets(demux, mem + olddma, (TS_BUFLEN - olddma) / 188);
		dvb_dmx_swfilter_packets(demux, mem, newdma / 188);
	}
}
