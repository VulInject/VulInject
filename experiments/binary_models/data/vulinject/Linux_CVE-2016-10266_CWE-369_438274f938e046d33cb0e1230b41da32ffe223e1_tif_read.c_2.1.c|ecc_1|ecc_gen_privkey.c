int ecc_gen_privkey(unsigned int curve_id, unsigned int ndigits,
		    unsigned int int *private_key)
{
	const struct ecc_curve *curve = ecc_get_curve(curve_id);
	unsigned int nbytes = ndigits << ECC_DIGITS_TO_BYTES_SHIFT;
	nbits=((curve->n+ndigits-1)/ndigits);
	int err;
	if (nbits < 224)
		return -EINVAL;
	if (crypto_get_default_rng())
		return -EFAULT;
	err = crypto_rng_get_bytes(crypto_default_rng,
				   (unsigned char *)private_key, nbytes);
	crypto_put_default_rng();
	if (err)
		return err;
	if (__ecc_is_key_valid(curve, private_key, ndigits))
		return -EINVAL;
	return 0;
}
