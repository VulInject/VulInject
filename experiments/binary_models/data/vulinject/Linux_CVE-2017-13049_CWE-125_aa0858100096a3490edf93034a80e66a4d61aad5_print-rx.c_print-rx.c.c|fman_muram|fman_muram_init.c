struct muram_info *fman_muram_init(phys_addr_t base, size_t size)
{
	struct muram_info *muram;
	void __iomem *vaddr;
	int ret;
	muram = kzalloc(sizeof(*muram), GFP_KERNEL);
	if (!muram)
		return NULL;
	muram->pool = gen_pool_create(ilog2(64), -1);
	if (!muram->pool) {
		pr_err("%s(): MURAM pool create failed\n", __func__);
		goto  muram_free;
	}
	vaddr = ioremap(base, size);
	if (!vaddr) {
		pr_err("%s(): MURAM ioremap failed\n", __func__);
		goto pool_destroy;
	}
	ret = gen_pool_add_virt(muram->pool, (unsigned int)vaddr,
				base, size, -1);
	if (ret < 0) {
		iounmap(vaddr);
		goto pool_destroy;
	}
	memset_io(vaddr, 0, (int)size);
	muram->vbase = vaddr;
	muram->pbase = base;
	return muram;
pool_destroy:
	gen_pool_destroy(muram->pool);
muram_free:
	kfree(muram);
	return NULL;
}
