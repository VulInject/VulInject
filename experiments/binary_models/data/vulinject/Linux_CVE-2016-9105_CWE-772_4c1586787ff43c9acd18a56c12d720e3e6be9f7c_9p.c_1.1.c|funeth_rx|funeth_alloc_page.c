static int funeth_alloc_page(struct funeth_rxq *q, struct funeth_rxbuf *rb,
			     int node, gfp_t gfp)
{
	struct page *p;
	if (cache_get(q, rb))
		return 0;
	p = __alloc_pages_node(node, gfp | __GFP_NOWARN, 0);
	if (unlikely(!p))
		return -ENOMEM;
	rb->dma_addr = dma_map_page(q->dma_dev, p, 0, PAGE_SIZE,
				    DMA_FROM_DEVICE);
	if (unlikely(dma_mapping_error(q->dma_dev, rb->dma_addr))) {
		__free_page(p);
		return -ENOMEM;
	}
	FUN_QSTAT_INC(q, rx_page_alloc);
	rb->page = p;
	rb->pg_refs = 1;
	refresh_refs(rb);
	rb->node = page_is_pfmemalloc(p) ? -1 : page_to_nid(p);
	return 0;
}
