int ZEXPORT deflatePrime (
    z_streamp strm,
    int bits,
    int value)
{
    deflate_state *s;
    int put;
    if (deflateStateCheck(strm)) return Z_STREAM_ERROR;
    s = strm->state;
    if (bits < 0 || bits > 16 ||
        s->sym_buf < s->pending_out + ((Buf_size + 7) >> 3))
        return Z_BUF_ERROR;
    do {
        put = Buf_size - s->bi_valid;
        if (put > bits)
            put = bits;
        s->bi_buf |= (ush)((value & ((1 << put) - 1)) << s->bi_valid);
        s->bi_valid += put;
        value >>= put;
        bits -= put;
    } while (bits);
    return Z_OK;
}
