hbhopt_process(netdissect_options *ndo, const u_char *bp, int *found_jumbo,
	       unsigned int *jumbolen)
{
    const struct ip6_hbh *dp = (const struct ip6_hbh *)bp;
    u_int hbhlen = 0;
    ndo->ndo_protocol = "hbhopt";
    hbhlen = (GET_U_1(dp->ip6h_len) + 1) << 3;
    ND_PRINT("HBH ");
    if (ip6_opt_process(ndo, (const u_char *)dp + sizeof(*dp),
			hbhlen - sizeof(*dp), found_jumbo, jumbolen) == -1)
	goto trunc;
    return hbhlen;
trunc:
    nd_print_trunc(ndo);
    return -1;
}
