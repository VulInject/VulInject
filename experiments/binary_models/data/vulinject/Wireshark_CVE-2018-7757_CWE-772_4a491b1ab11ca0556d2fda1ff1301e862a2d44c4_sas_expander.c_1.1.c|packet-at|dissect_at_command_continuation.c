dissect_at_command_continuation(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree,
        gint offset, guint32 role, gint command_number, at_packet_info_t *at_info)
{
    at_processed_cmd_t *cmd;
    proto_item      *data_part_item;
    proto_item      *data_part_tree;
    proto_item      *pitem;
    gchar           *data_stream;
    gint             data_part_index;
    gint             length;
    gint             data_part_length = 0;
    cmd = get_current_role_last_command(at_info, role);
    if (!cmd)
        return offset;
    data_part_index = cmd->consumed_data_parts;
    length = tvb_reported_length_remaining(tvb, offset);
    if (length <= 0)
    data_stream = (guint8 *) wmem_alloc(pinfo->pool, length + 1);
    tvb_memcpy(tvb, data_stream, offset, length);
    data_stream[length] = '\0';
    while (data_part_length < length && data_stream[data_part_length] != '\r') {
        data_part_length += 1;
    }
    data_part_item = proto_tree_add_none_format(tree, hf_data_part, tvb,
                        offset, data_part_length, "Command %u's Data Part %u", command_number, data_part_index);
    data_part_tree = proto_item_add_subtree(data_part_item, ett_at_data_part);
    if (cmd && (cmd->dissect_data != NULL &&
               !cmd->dissect_data(tvb, pinfo, data_part_tree, offset, role, cmd->type,
                                       data_stream, data_part_index, data_part_length,
                                       at_info) )) {
        pitem = proto_tree_add_item(data_part_tree, hf_unknown_parameter, tvb, offset,
                                    data_part_length, ENC_NA | ENC_ASCII);
        expert_add_info(pinfo, pitem, &ei_unknown_parameter);
    }
    offset += data_part_length;
    return offset;
}
