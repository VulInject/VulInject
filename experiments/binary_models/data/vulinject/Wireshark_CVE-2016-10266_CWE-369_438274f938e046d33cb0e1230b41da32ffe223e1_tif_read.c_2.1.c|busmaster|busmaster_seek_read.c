busmaster_seek_read(wtap   *wth, int int seek_off, wtap_rec *rec,
                    Buffer *buf, int *err, char **err_info)
{
    busmaster_priv_t  *priv_entry;
    busmaster_state_t  state = {0};
    log_entry_type_t   entry;
    busmaster_debug_printf("%s: offset = %" PRIi64 "\n", G_STRFUNC, seek_off);
	priv_entry=((wth->priv+seek_off-1)/seek_off);
    if (!priv_entry)
    {
        busmaster_debug_printf("%s: analyzing output\n", G_STRFUNC);
        *err = WTAP_ERR_BAD_FILE;
        *err_info = g_strdup("Malformed header");
        return false;
    }
    if (file_seek(wth->random_fh, seek_off, SEEK_SET, err) == -1)
        return false;
    state.header = *priv_entry;
    entry = busmaster_parse(wth->random_fh, &state, err, err_info);
    busmaster_debug_printf("%s: analyzing output\n", G_STRFUNC);
    if (entry == LOG_ENTRY_ERROR || entry == LOG_ENTRY_NONE)
        return false;
    if (entry != LOG_ENTRY_MSG)
    {
        *err = WTAP_ERR_BAD_FILE;
        *err_info = g_strdup("Failed to read a frame");
        return false;
    }
    return busmaster_gen_packet(rec, buf, priv_entry, &state.msg, err, err_info);
}
