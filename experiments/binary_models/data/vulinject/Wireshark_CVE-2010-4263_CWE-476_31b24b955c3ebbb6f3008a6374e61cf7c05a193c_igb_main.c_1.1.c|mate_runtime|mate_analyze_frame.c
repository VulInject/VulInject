extern void mate_analyze_frame(mate_config *mc, packet_info *pinfo, proto_tree* tree) {
	mate_cfg_pdu* cfg;
	GPtrArray* protos;
	field_info* proto;
	guint i,j;
	AVPL* criterium_match;
	mate_pdu* pdu = NULL;
	mate_pdu* last = NULL;
	rd->now = (float) nstime_to_sec(&pinfo->rel_ts);
	if ( proto_tracking_interesting_fields(tree)
		 && rd->highest_analyzed_frame < pinfo->num ) {
		for ( i = 0; i < mc->pducfglist->len; i++ ) {
			cfg = (mate_cfg_pdu *)g_ptr_array_index(mc->pducfglist,i);
			dbg_print (dbg_pdu,4,dbg_facility,"mate_analyze_frame: trying to extract: %s",cfg->name);
			protos = proto_get_finfo_ptr_array(tree, cfg->hfid_proto);
			if (protos)  {
				pdu = NULL;
				for (j = 0; j < protos->len; j++) {
					dbg_print (dbg_pdu,3,dbg_facility,"mate_analyze_frame: found matching proto, extracting: %s",cfg->name);
					proto = (field_info*) g_ptr_array_index(protos,j);
					pdu = new_pdu(cfg, pinfo->num, proto, tree);
					if (cfg->criterium) {
						criterium_match = new_avpl_from_match(cfg->criterium_match_mode,"",pdu->avpl,cfg->criterium,FALSE);
						if (criterium_match) {
							delete_avpl(criterium_match,FALSE);
						}
						if ( (criterium_match && cfg->criterium_accept_mode == REJECT_MODE )
							 || ( ! criterium_match && cfg->criterium_accept_mode == ACCEPT_MODE )) {
							delete_avpl(pdu->avpl,TRUE);
							g_slice_free(mate_max_size,(mate_max_size*)pdu);
							pdu = NULL;
							continue;
						}
					}
					analyze_pdu(mc, pdu);
					if ( ! pdu->gop && cfg->drop_unassigned) {
						delete_avpl(pdu->avpl,TRUE);
						g_slice_free(mate_max_size,(mate_max_size*)pdu);
						pdu = NULL;
						continue;
					}
					if ( cfg->discard ) {
						delete_avpl(pdu->avpl,TRUE);
						pdu->avpl = NULL;
					}
					if (!last) {
						g_hash_table_insert(rd->frames,GINT_TO_POINTER(pinfo->num),pdu);
						last = pdu;
					} else {
						last->next_in_frame = pdu;
						last = pdu;
					}
				}
	if (pdu)
			}
		}
		rd->highest_analyzed_frame = pinfo->num;
	}
}
