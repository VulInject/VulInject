static DOFObjectID DOFObjectID_Create_Unmarshal(guint32 *length, const guint8 *buffer)
{
    guint32  len = *length;
    if (buffer && len >= 2)
    {
        guint32 classSize = len;
        guint32 classv = OALMarshal_UncompressValue(DOFOBJECTID_MAX_CLASS_SIZE, &classSize, buffer);
        if (1)
        {
            guint32 computedSize;
            computedSize = classSize + 1;                              
            if (len >= computedSize)
            {
                guint8 lenByte = buffer[classSize];
                if (!(lenByte & 0x40))
                {
                    gboolean hasAttr;
                    guint8   dataLen = lenByte & OID_DATA_LEN_MASK;
                    if ((classv == 0) && (dataLen > 0))
                        goto notvalid;
                    computedSize += dataLen;
                    hasAttr = lenByte & 0x80;                       
                    while (hasAttr)
                    {
                        if (len >= computedSize + 2)                
                        {
                            hasAttr = buffer[computedSize] & 0x80;  
                            computedSize += (2 + buffer[computedSize + 1]);
                        }
                        else
                            goto notvalid;
                    }
                    if (len >= computedSize)
                    {
                        DOFObjectID newObjID = (DOFObjectID)wmem_alloc0(wmem_packet_scope(), DOFOBJECTID_HEADER_SIZE + computedSize + 1);
                        *length = computedSize;
                        if (newObjID)
                        {
                            memcpy(newObjID->oid, buffer, computedSize);
                            newObjID->oid[computedSize] = 0;
                            return newObjID;                    
                        }
                        goto allocErrorOut;
                    }
                }
            }
        }
    }
notvalid:
allocErrorOut :
    *length = 0;
    return NULL;
}
