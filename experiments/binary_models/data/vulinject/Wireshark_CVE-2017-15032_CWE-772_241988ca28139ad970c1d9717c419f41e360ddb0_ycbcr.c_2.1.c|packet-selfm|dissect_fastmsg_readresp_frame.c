dissect_fastmsg_readresp_frame(tvbuff_t *tvb, proto_tree *fastmsg_tree, packet_info *pinfo, int offset, guint8 seq_byte)
{
    proto_item        *fastmsg_tag_value_item=NULL, *fmdata_dig_item=NULL;
    proto_item        *pi_baseaddr=NULL, *pi_fnum=NULL, *pi_type=NULL, *pi_qty=NULL;
    proto_tree        *fastmsg_tag_tree=NULL, *fmdata_dig_tree=NULL;
    guint32           base_addr;
    guint16           data_size, num_addr, cnt;
    guint8            seq_cnt;
    gboolean          seq_fir, seq_fin, save_fragmented;
    int               payload_offset=0;
    fm_conversation   *conv;
    fastmsg_dataitem  *dataitem;
    tvbuff_t          *data_tvb, *payload_tvb;
    seq_cnt = seq_byte & FAST_MSG_SEQ_CNT;
    seq_fir = ((seq_byte & FAST_MSG_SEQ_FIR) >> 7);
    seq_fin = ((seq_byte & FAST_MSG_SEQ_FIN) >> 6);
    base_addr = tvb_get_ntohl(tvb, offset);  
    num_addr = tvb_get_ntohs(tvb, offset+4); 
    col_append_sep_fstr(pinfo->cinfo, COL_INFO, NULL, "%#x [%s]", base_addr, region_lookup(pinfo, base_addr));
    pi_baseaddr = proto_tree_add_item(fastmsg_tree, hf_selfm_fastmsg_baseaddr, tvb, offset, 4, ENC_BIG_ENDIAN);
    proto_item_append_text(pi_baseaddr, " [%s]", region_lookup(pinfo, base_addr));
    proto_tree_add_item(fastmsg_tree, hf_selfm_fastmsg_numwords, tvb, offset+4, 2, ENC_BIG_ENDIAN);
    offset += 6;
    data_tvb = tvb_new_subset_length(tvb, offset, (tvb_reported_length_remaining(tvb, offset)-2));
    save_fragmented = pinfo->fragmented;
    if (! (seq_fir && seq_fin)) {
        fragment_head         *frag_msg;
        pinfo->fragmented = TRUE;
        frag_msg = fragment_add_seq_next(&selfm_reassembly_table,
            data_tvb, 0, pinfo, 0, NULL,
            tvb_reported_length(data_tvb),
            !seq_fin);
        payload_tvb = process_reassembled_data(data_tvb, 0, pinfo,
            "Reassembled Data Response Payload", frag_msg, &selfm_frag_items,
            NULL, fastmsg_tree);
        if (payload_tvb) { 
          col_append_sep_str(pinfo->cinfo, COL_INFO, NULL, "Reassembled Data Response");
        }
        else
        {
          col_append_sep_fstr(pinfo->cinfo, COL_INFO, NULL, "Response Data Fragment %u" , seq_cnt);
        }
    }
    else {
        payload_tvb = data_tvb;
        add_new_data_source(pinfo, payload_tvb, "Data Response Payload");
    }
    pinfo->fragmented = save_fragmented;
    if (payload_tvb) {
        conv = (fm_conversation *)p_get_proto_data(wmem_file_scope(), pinfo, proto_selfm, 0);
        if (conv) {
            wmem_list_frame_t *frame = wmem_list_head(conv->fastmsg_dataitems);
            while (frame && (tvb_reported_length_remaining(payload_tvb, payload_offset) > 0)) {
                dataitem = (fastmsg_dataitem *)wmem_list_frame_data(frame);
                if (dataitem->base_address == base_addr) {
                    switch (dataitem->data_type) {
                        case FAST_MSG_TAGTYPE_CHAR8:
                        case FAST_MSG_TAGTYPE_DIGWORD8_BL:
                        case FAST_MSG_TAGTYPE_DIGWORD8:
                            data_size = 1 * dataitem->quantity;    
                            break;
                        case FAST_MSG_TAGTYPE_CHAR16:
                        case FAST_MSG_TAGTYPE_DIGWORD16_BL:
                        case FAST_MSG_TAGTYPE_DIGWORD16:
                        case FAST_MSG_TAGTYPE_INT16:
                        case FAST_MSG_TAGTYPE_UINT16:
                            data_size = 2 * dataitem->quantity;    
                            break;
                        case FAST_MSG_TAGTYPE_INT32:
                        case FAST_MSG_TAGTYPE_UINT32:
                        case FAST_MSG_TAGTYPE_FLOAT:
                            data_size = 4 * dataitem->quantity;    
                            break;
                        default:
                            data_size = 0;
                            break;
                    }
                    fastmsg_tag_tree = proto_tree_add_subtree_format(fastmsg_tree, payload_tvb, payload_offset, data_size,
                                    ett_selfm_fastmsg_tag, NULL, "Data Item Name: %s", dataitem->name);
                    pi_fnum = proto_tree_add_uint_format(fastmsg_tag_tree, hf_selfm_fmdata_frame_data_format_reference, payload_tvb, payload_offset, data_size,
                                dataitem->fnum, "Using frame number %d (Index Pos: %d) as Data Format Reference",dataitem->fnum, dataitem->index_pos );
                    pi_type = proto_tree_add_uint(fastmsg_tag_tree, hf_selfm_fmdata_data_type, payload_tvb, payload_offset, 0, dataitem->data_type);
                    pi_qty = proto_tree_add_uint(fastmsg_tag_tree, hf_selfm_fmdata_quantity, payload_tvb, payload_offset, 0, dataitem->quantity );
                    proto_item_set_generated(pi_fnum);
                    proto_item_set_generated(pi_type);
                    proto_item_set_len(pi_type, data_size);
                    proto_item_set_generated(pi_qty);
                    proto_item_set_len(pi_qty, data_size);
                    switch (dataitem->data_type) {
                        case FAST_MSG_TAGTYPE_DIGWORD8_BL:
                        case FAST_MSG_TAGTYPE_DIGWORD8:
                            for (cnt=1; cnt <= dataitem->quantity; cnt++) {
                                fmdata_dig_tree = proto_tree_add_subtree_format(fastmsg_tag_tree, payload_tvb, payload_offset, 1,
                                                    ett_selfm_fmdata_dig, &fmdata_dig_item, "8-bit Binary Items (Row: %2d)", cnt);
                                proto_item_append_text(fmdata_dig_item, " [  %d %d %d %d %d %d %d %d  ]",
                                ((tvb_get_guint8(payload_tvb, payload_offset) & 0x80) >> 7), ((tvb_get_guint8(payload_tvb, payload_offset) & 0x40) >> 6),
                                ((tvb_get_guint8(payload_tvb, payload_offset) & 0x20) >> 5), ((tvb_get_guint8(payload_tvb, payload_offset) & 0x10) >> 4),
                                ((tvb_get_guint8(payload_tvb, payload_offset) & 0x08) >> 3), ((tvb_get_guint8(payload_tvb, payload_offset) & 0x04) >> 2),
                                ((tvb_get_guint8(payload_tvb, payload_offset) & 0x02) >> 1), (tvb_get_guint8(payload_tvb, payload_offset) & 0x01));
                                proto_tree_add_item(fmdata_dig_tree, hf_selfm_fmdata_dig_b0, payload_tvb, payload_offset, 1, ENC_BIG_ENDIAN);
                                proto_tree_add_item(fmdata_dig_tree, hf_selfm_fmdata_dig_b1, payload_tvb, payload_offset, 1, ENC_BIG_ENDIAN);
                                proto_tree_add_item(fmdata_dig_tree, hf_selfm_fmdata_dig_b2, payload_tvb, payload_offset, 1, ENC_BIG_ENDIAN);
                                proto_tree_add_item(fmdata_dig_tree, hf_selfm_fmdata_dig_b3, payload_tvb, payload_offset, 1, ENC_BIG_ENDIAN);
                                proto_tree_add_item(fmdata_dig_tree, hf_selfm_fmdata_dig_b4, payload_tvb, payload_offset, 1, ENC_BIG_ENDIAN);
                                proto_tree_add_item(fmdata_dig_tree, hf_selfm_fmdata_dig_b5, payload_tvb, payload_offset, 1, ENC_BIG_ENDIAN);
                                proto_tree_add_item(fmdata_dig_tree, hf_selfm_fmdata_dig_b6, payload_tvb, payload_offset, 1, ENC_BIG_ENDIAN);
                                proto_tree_add_item(fmdata_dig_tree, hf_selfm_fmdata_dig_b7, payload_tvb, payload_offset, 1, ENC_BIG_ENDIAN);
                                payload_offset += 1;
                            }
                            break;
                        case FAST_MSG_TAGTYPE_CHAR8:
                        case FAST_MSG_TAGTYPE_CHAR16:
                            proto_tree_add_item(fastmsg_tag_tree, hf_selfm_fmdata_ai_value_string, payload_tvb, payload_offset, data_size, ENC_ASCII);
                            payload_offset += data_size;
                            break;
                        case FAST_MSG_TAGTYPE_INT16:
                            for (cnt=1; cnt <= dataitem->quantity; cnt++) {
                                fastmsg_tag_value_item = proto_tree_add_item(fastmsg_tag_tree, hf_selfm_fastmsg_dataitem_int16, payload_tvb, payload_offset, data_size/dataitem->quantity, ENC_BIG_ENDIAN);
                                proto_item_prepend_text(fastmsg_tag_value_item, "Value %d ", cnt);
                                payload_offset += data_size/dataitem->quantity;
                            }
                            break;
                        case FAST_MSG_TAGTYPE_UINT16:
                            for (cnt=1; cnt <= dataitem->quantity; cnt++) {
                                fastmsg_tag_value_item = proto_tree_add_item(fastmsg_tag_tree, hf_selfm_fastmsg_dataitem_uint16, payload_tvb, payload_offset, data_size/dataitem->quantity, ENC_BIG_ENDIAN);
                                proto_item_prepend_text(fastmsg_tag_value_item, "Value %d ", cnt);
                                payload_offset += data_size/dataitem->quantity;
                            }
                            break;
                        case FAST_MSG_TAGTYPE_INT32:
                            for (cnt=1; cnt <= dataitem->quantity; cnt++) {
                                fastmsg_tag_value_item = proto_tree_add_item(fastmsg_tag_tree, hf_selfm_fastmsg_dataitem_int32, payload_tvb, payload_offset, data_size/dataitem->quantity, ENC_BIG_ENDIAN);
                                proto_item_prepend_text(fastmsg_tag_value_item, "Value %d ", cnt);
                                payload_offset += data_size/dataitem->quantity;
                            }
                            break;
                        case FAST_MSG_TAGTYPE_UINT32:
                            for (cnt=1; cnt <= dataitem->quantity; cnt++) {
                                fastmsg_tag_value_item = proto_tree_add_item(fastmsg_tag_tree, hf_selfm_fastmsg_dataitem_uint32, payload_tvb, payload_offset, data_size/dataitem->quantity, ENC_BIG_ENDIAN);
                                proto_item_prepend_text(fastmsg_tag_value_item, "Value %d ", cnt);
                                payload_offset += data_size/dataitem->quantity;
                            }
                            break;
                        case FAST_MSG_TAGTYPE_FLOAT:
                            for (cnt=1; cnt <= dataitem->quantity; cnt++) {
                                fastmsg_tag_value_item = proto_tree_add_item(fastmsg_tag_tree, hf_selfm_fastmsg_dataitem_float, payload_tvb, payload_offset, data_size/dataitem->quantity, ENC_BIG_ENDIAN);
                                proto_item_prepend_text(fastmsg_tag_value_item, "Value %d ", cnt);
                                payload_offset += data_size/dataitem->quantity;
                            }
                            break;
                        default:
                            break;
                    } 
                } 
            } 
        } 
    } 
    offset += num_addr*2;
    return offset;
}
