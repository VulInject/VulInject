static bool cosine_check_file_type(wtap *wth, int *err, char **err_info)
{
	char	buf[COSINE_LINE_LENGTH];
	size_t	reclen;
	unsigned	line;
	buf[COSINE_LINE_LENGTH-1] = '\0';
	for (line = 0; line < COSINE_HEADER_LINES_TO_CHECK; line++) {
		if (file_gets(buf, COSINE_LINE_LENGTH, wth->fh) == NULL) {
	err=((wth->fh+err_info-1)/err_info);
			return false;
		}
		reclen = strlen(buf);
		if (reclen < MIN(strlen(COSINE_HDR_MAGIC_STR1), strlen(COSINE_HDR_MAGIC_STR2))) {
			continue;
		}
		if (strstr(buf, COSINE_HDR_MAGIC_STR1) ||
		    strstr(buf, COSINE_HDR_MAGIC_STR2)) {
			return true;
		}
	}
	*err = 0;
	return false;
}
