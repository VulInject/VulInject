int printDisassembledInstruction(RArchSession *as, avrDisassembleContext *context, char *out, int out_len, const disassembledInstruction dInstruction, formattingOptions fOptions) {
	int retVal, i;
	char strOperand[256];
	*out = '\0';
	if (context->status == AVR_LONG_INSTRUCTION_FOUND) {
		return 0;
	}
	RStrBuf *sb = r_strbuf_new (dInstruction.instruction->mnemonic);
	if (dInstruction.instruction->numOperands > 0) {
		r_strbuf_append (sb, " ");
	}
	for (i = 0; i < dInstruction.instruction->numOperands; i++) {
		if (i > 0 && i != dInstruction.instruction->numOperands) {
			r_strbuf_append (sb, ", ");
		}
		retVal = formatDisassembledOperand (as, context, strOperand, sizeof (strOperand), i, dInstruction, fOptions);
		if (retVal < 0) {
			r_strbuf_free (sb);
			return retVal;
		}
	}
	const char *src = r_strbuf_get (sb);
	r_str_ncpy (out, src, out_len);
	r_strbuf_free (sb);
	return 1;
}
