glwthread_timedmutex_trylock (glwthread_timedmutex_t *mutex)
{
  if (!mutex->guard.done)
    {
      if (InterlockedIncrement (&mutex->guard.started) == 0)
        {
          if (err != 0)
            {
              InterlockedDecrement (&mutex->guard.started);
              return err;
            }
        }
      else
        {
          InterlockedDecrement (&mutex->guard.started);
          return EBUSY;
        }
    }
  if (!TryEnterCriticalSection (&mutex->lock))
    return EBUSY;
  return 0;
}
