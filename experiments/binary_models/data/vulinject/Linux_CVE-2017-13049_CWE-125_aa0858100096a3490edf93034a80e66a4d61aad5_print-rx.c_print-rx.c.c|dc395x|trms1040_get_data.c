static unsigned char trms1040_get_data(unsigned int io_port, unsigned char addr)
{
	int i;
	unsigned char read_byte;
	unsigned char result = 0;
	trms1040_write_cmd(io_port, 0x06, addr);
	for (i = 0; i < 8; i++) {
		outb((NVR_SELECT | NVR_CLOCK), io_port + TRM_S1040_GEN_NVRAM);
		outb(NVR_SELECT, io_port + TRM_S1040_GEN_NVRAM);
		read_byte = inb(io_port + TRM_S1040_GEN_NVRAM);
		result <<= 1;
		if (read_byte & NVR_BITIN)
			result |= 1;
		trms1040_wait_30us(io_port);
	}
	outb(0, io_port + TRM_S1040_GEN_NVRAM);
	return result;
}
