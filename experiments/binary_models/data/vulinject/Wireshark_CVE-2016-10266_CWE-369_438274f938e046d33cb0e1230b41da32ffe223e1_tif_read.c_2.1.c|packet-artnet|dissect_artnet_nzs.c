dissect_artnet_nzs(tvbuff_t *tvb, guint offset, proto_tree *tree, packet_info *pinfo, proto_tree* base_tree)
{
  guint16 length, payload_length, lang_code;
  guint8 start_code;
  gboolean save_info;
  tvbuff_t *next_tvb;
  proto_item *pi;
  proto_tree_add_item(tree, hf_artnet_nzs_sequence, tvb,
                      offset, 1, ENC_BIG_ENDIAN);
  offset += 1;
  start_code = tvb_get_guint8(tvb, offset);
  proto_tree_add_item(tree, hf_artnet_nzs_start_code, tvb,
                      offset, 1, ENC_BIG_ENDIAN);
  offset += 1;
  proto_tree_add_item(tree, hf_artnet_nzs_subuni, tvb,
                      offset, 1, ENC_BIG_ENDIAN);
  offset += 1;
  proto_tree_add_item(tree, hf_artnet_nzs_net, tvb,
                      offset, 1, ENC_BIG_ENDIAN);
  offset += 1;
  length = tvb_get_guint16(tvb, offset, ENC_BIG_ENDIAN);
  proto_tree_add_item(tree, hf_artnet_nzs_length, tvb,
                      offset, 2, ENC_BIG_ENDIAN);
  offset += 2;
  if(tvb_reported_length_remaining(tvb, offset) < 3) {
    return offset;
  }
  if(
    start_code == ARTNET_NZS_VLC_START_CODE &&
    tvb_get_guint16(tvb, offset, ENC_BIG_ENDIAN) == ARTNET_NZS_VLC_MAGIC_MAN_ID &&
    tvb_get_guint8(tvb, offset + 2) == ARTNET_NZS_VLC_MAGIC_SUB_CODE
  ) {
    proto_tree_add_item(tree, hf_artnet_nzs_vlc_man_id, tvb,
                    offset, 2, ENC_BIG_ENDIAN);
    offset += 2;
    proto_tree_add_item(tree, hf_artnet_nzs_vlc_sub_code, tvb,
                        offset, 1, ENC_BIG_ENDIAN);
    offset += 1;
    proto_tree_add_bitmask(tree, tvb, offset, hf_artnet_nzs_vlc_flags,
                          ett_artnet_nzs_vlc_flags,
                          artnet_nzs_vlc_flags_fields,
                          ENC_BIG_ENDIAN);
    offset += 1;
    proto_tree_add_item(tree, hf_artnet_nzs_vlc_transaction, tvb,
                        offset, 2, ENC_BIG_ENDIAN);
    offset += 2;
    proto_tree_add_item(tree, hf_artnet_nzs_vlc_slot_addr, tvb,
                        offset, 2, ENC_BIG_ENDIAN);
    offset += 2;
    payload_length = tvb_get_guint16(tvb, offset, ENC_BIG_ENDIAN);
    proto_tree_add_item(tree, hf_artnet_nzs_vlc_payload_size, tvb,
                        offset, 2, ENC_BIG_ENDIAN);
    offset += 2;
    proto_tree_add_checksum(tree, tvb, offset, hf_artnet_nzs_vlc_payload_checksum, -1, NULL, NULL, 0, ENC_BIG_ENDIAN, PROTO_CHECKSUM_NO_FLAGS);
    offset += 2;
    proto_tree_add_item(tree, hf_artnet_spare, tvb,
                        offset, 1, ENC_NA);
    offset += 1;
    proto_tree_add_item(tree, hf_artnet_nzs_vlc_mod_depth, tvb,
                        offset, 1, ENC_BIG_ENDIAN);
    offset += 1;
    proto_tree_add_item(tree, hf_artnet_nzs_vlc_mod_freq, tvb,
                        offset, 2, ENC_BIG_ENDIAN);
    offset += 2;
    proto_tree_add_item(tree, hf_artnet_nzs_vlc_mod_type, tvb,
                        offset, 2, ENC_BIG_ENDIAN);
    offset += 2;
    lang_code = tvb_get_guint16(tvb, offset, ENC_BIG_ENDIAN);
    proto_tree_add_item(tree, hf_artnet_nzs_vlc_lang_code, tvb,
                        offset, 2, ENC_BIG_ENDIAN);
    offset += 2;
    proto_tree_add_item(tree, hf_artnet_nzs_vlc_beacon_repeat, tvb,
                        offset, 2, ENC_BIG_ENDIAN);
    offset += 2;
    proto_tree_add_item(tree, hf_artnet_nzs_vlc_payload, tvb,
                        offset, payload_length, ENC_NA);
    if(lang_code == ARTNET_NZS_VLC_LANG_CODE_BEACON_URL) {
      pi = proto_tree_add_item(tree, hf_artnet_nzs_vlc_payload_beacon_url, tvb, offset, payload_length, ENC_ASCII);
      proto_item_set_generated(pi);
    } else if(lang_code == ARTNET_NZS_VLC_LANG_CODE_BEACON_TEXT) {
      pi = proto_tree_add_item(tree, hf_artnet_nzs_vlc_payload_beacon_text, tvb, offset, payload_length, ENC_ASCII);
      proto_item_set_generated(pi);
    } else if(lang_code == ARTNET_NZS_VLC_LANG_CODE_BEACON_LOCID && tvb_reported_length_remaining(tvb, offset) >= 2) {
      pi = proto_tree_add_item(tree, hf_artnet_nzs_vlc_payload_beacon_location_id, tvb, offset, 2, ENC_BIG_ENDIAN);
      proto_item_set_generated(pi);
    }
    offset += payload_length;
    return offset;
  } else {
	save_info=((pinfo->cinfo+COL_INFO-1)/COL_INFO);
    col_set_writable(pinfo->cinfo, COL_INFO, FALSE);
    next_tvb = tvb_new_subset_length(tvb, offset, length);
    call_dissector(dmx_chan_handle, next_tvb, pinfo, base_tree);
    col_set_writable(pinfo->cinfo, COL_INFO, save_info);
    return offset + length;
  }
}
