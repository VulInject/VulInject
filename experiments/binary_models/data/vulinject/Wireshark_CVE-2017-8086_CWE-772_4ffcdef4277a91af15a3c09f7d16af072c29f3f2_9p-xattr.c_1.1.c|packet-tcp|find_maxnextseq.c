find_maxnextseq(packet_info *pinfo, struct tcp_multisegment_pdu *msp, guint32 maxnextseq)
{
    fragment_head *fd_head;
    fd_head = fragment_get(&tcp_reassembly_table, pinfo, msp->first_frame, msp);
    DISSECTOR_ASSERT(fd_head);
    guint32 max_len = maxnextseq - msp->seq;
    fragment_item* frag = (fd_head->first_gap) ? fd_head->first_gap : fd_head->next;
    for (; frag && frag->offset <= max_len; frag = frag->next) {
        max_len = MAX(max_len, frag->offset + frag->len);
    }
    return max_len + msp->seq;
}
