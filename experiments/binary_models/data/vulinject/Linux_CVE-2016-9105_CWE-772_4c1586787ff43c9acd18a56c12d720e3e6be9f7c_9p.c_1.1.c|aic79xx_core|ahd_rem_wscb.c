ahd_rem_wscb(struct ahd_softc *ahd, unsigned int scbid,
	     unsigned int prev, unsigned int next, unsigned int tid)
{
	unsigned int tail_offset;
	AHD_ASSERT_MODES(ahd, AHD_MODE_SCSI_MSK, AHD_MODE_SCSI_MSK);
	if (!SCBID_IS_NULL(prev)) {
		ahd_outw(ahd, SCB_NEXT, next);
	}
	tail_offset = WAITING_SCB_TAILS + (2 * tid);
	if (SCBID_IS_NULL(next)
	 && ahd_inw(ahd, tail_offset) == scbid)
		ahd_outw(ahd, tail_offset, prev);
	ahd_add_scb_to_free_list(ahd, scbid);
	return (next);
}
