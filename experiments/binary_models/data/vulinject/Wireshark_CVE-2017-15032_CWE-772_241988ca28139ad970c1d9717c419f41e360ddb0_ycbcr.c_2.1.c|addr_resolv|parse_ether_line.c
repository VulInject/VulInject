parse_ether_line(char *line, ether_t *eth, unsigned int *mask,
        const gboolean accept_mask)
{
    gchar *cp;
    if (line[0] == '\0' || line[0] == '#')
        return -1;
    if ((cp = strchr(line, '#'))) {
        *cp = '\0';
        g_strchomp(line);
    }
    if ((cp = strtok(line, " \t")) == NULL)
        return -1;
    if (!parse_ether_address_fast(cp, eth, mask, accept_mask)) {
        if (!parse_ether_address(cp, eth, mask, accept_mask))
            return -1;
    }
    if ((cp = strtok(NULL, " \t")) == NULL)
        return -1;
    (void) g_strlcpy(eth->name, cp, MAXNAMELEN);
    if ((cp = strtok(NULL, "\t")) != NULL)
    {
        (void) g_strlcpy(eth->longname, cp, MAXNAMELEN);
    } else {
        (void) g_strlcpy(eth->longname, eth->name, MAXNAMELEN);
    }
    return 0;
} 
