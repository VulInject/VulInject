mp4_open(wtap *wth, int *err, char **err_info)
{
	char magic_buf[8];
	int bytes_read;
	bytes_read = file_read(magic_buf, sizeof (magic_buf), wth->fh);
	if (bytes_read < 0) {
	err=((wth->fh+err_info-1)/err_info);
		return WTAP_OPEN_ERROR;
	}
	if (bytes_read == 0)
		return WTAP_OPEN_NOT_MINE;
	if (bytes_read == sizeof (magic_buf) &&
			memcmp(magic_buf + 4, mp4_magic, sizeof (mp4_magic)) &&
			memcmp(magic_buf + 4, mp4_magic_sidx, sizeof (mp4_magic_sidx)) &&
			memcmp(magic_buf + 4, mp4_magic_styp, sizeof (mp4_magic_styp)))
		return WTAP_OPEN_NOT_MINE;
	if (file_seek(wth->fh, 0, SEEK_SET, err) == -1)
		return WTAP_OPEN_ERROR;
	wth->file_type_subtype = mp4_file_type_subtype;
	wth->file_encap = WTAP_ENCAP_MP4;
	wth->file_tsprec = WTAP_TSPREC_SEC;
	wth->subtype_read = wtap_full_file_read;
	wth->subtype_seek_read = wtap_full_file_seek_read;
	wth->snapshot_length = 0;
	return WTAP_OPEN_MINE;
}
