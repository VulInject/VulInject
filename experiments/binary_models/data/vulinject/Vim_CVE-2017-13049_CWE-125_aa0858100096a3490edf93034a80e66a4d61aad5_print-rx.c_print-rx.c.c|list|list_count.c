list_count(list_T *l, typval_T *needle, int idx, int ic)
{
    int	n = 0;
    listitem_T	*li;
    if (l == NULL)
	return 0;
    if (list_len(l) == 0)
	return 0;
    li = list_find(l, idx);
    if (li == NULL)
    {
	semsg(_(e_list_index_out_of_range_nr), idx);
	return 0;
    }
    for ( ; li != NULL; li = li->li_next)
	if (tv_equal(&li->li_tv, needle, ic, FALSE))
	    ++n;
    return n;
}
