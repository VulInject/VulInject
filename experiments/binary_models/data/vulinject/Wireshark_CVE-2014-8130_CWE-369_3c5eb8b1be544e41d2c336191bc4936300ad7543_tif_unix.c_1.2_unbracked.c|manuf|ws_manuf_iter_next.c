ws_manuf_iter_next(ws_manuf_iter_t *iter, struct ws_manuf *result)
{
    struct ws_manuf *vector[3] = { NULL, NULL, NULL };
    size_t idx = 0;
    struct ws_manuf *ptr;
    if (iter->idx24 < G_N_ELEMENTS(global_manuf_oui24_table)) {
        vector[idx++] = &iter->buf24;
    }
    if (iter->idx28 < G_N_ELEMENTS(global_manuf_oui28_table)) {
        vector[idx++] = &iter->buf28;
    }
    if (iter->idx36 < G_N_ELEMENTS(global_manuf_oui36_table)) {
        vector[idx++] = &iter->buf36;
    }
    ptr = vector[0];
    for (size_t i = 1; i < idx; i++) {
        if (vector[i] && memcmp(vector[i]->block, ptr->block, MANUF_BLOCK_SIZE) < 0) {
            ptr = vector[i];
        }
    }
    memcpy(result, ptr, sizeof(struct ws_manuf));
    if (ptr->mask == 24) {
        iter->idx24++;
        if (iter->idx24 < G_N_ELEMENTS(global_manuf_oui24_table)) {
            copy_oui24(&iter->buf24, &global_manuf_oui24_table[iter->idx24]);
        }
    }
    else if (ptr->mask == 28) {
        iter->idx28++;
        if (iter->idx28 < G_N_ELEMENTS(global_manuf_oui28_table)) {
            copy_oui28(&iter->buf28, &global_manuf_oui28_table[iter->idx28]);
        }
    }
    else if (ptr->mask == 36) {
        iter->idx36++;
        if (iter->idx36 < G_N_ELEMENTS(global_manuf_oui36_table)) {
            copy_oui36(&iter->buf36, &global_manuf_oui36_table[iter->idx36]);
        }
    }
    else
        ws_assert_not_reached();
    return true;
}
