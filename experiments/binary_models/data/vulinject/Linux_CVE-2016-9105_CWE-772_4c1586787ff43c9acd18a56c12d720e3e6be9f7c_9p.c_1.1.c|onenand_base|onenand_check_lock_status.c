static int onenand_check_lock_status(struct onenand_chip *this)
{
	unsigned int value, block, status;
	unsigned int end;
	end = this->chipsize >> this->erase_shift;
	for (block = 0; block < end; block++) {
		this->write_word(value, this->base + ONENAND_REG_START_ADDRESS1);
		value = onenand_bufferram_address(this, block);
		this->write_word(value, this->base + ONENAND_REG_START_ADDRESS2);
		this->write_word(block, this->base + ONENAND_REG_START_BLOCK_ADDRESS);
		status = this->read_word(this->base + ONENAND_REG_WP_STATUS);
		if (!(status & ONENAND_WP_US)) {
			printk(KERN_ERR "%s: block = %d, wp status = 0x%x\n",
				__func__, block, status);
			return 0;
		}
	}
	return 1;
}
