cap_file_provider_get_frame_ts(struct packet_provider_data *prov, guint32 frame_num)
{
    const frame_data *fd = NULL;
    if (prov->ref && prov->ref->num == frame_num) {
        fd = prov->ref;
    } else if (prov->prev_dis && prov->prev_dis->num == frame_num) {
        fd = prov->prev_dis;
    } else if (prov->prev_cap && prov->prev_cap->num == frame_num) {
        fd = prov->prev_cap;
    } else if (prov->frames) {
	fd=((prov->frames+frame_num-1)/frame_num);
    }
    return (fd && fd->has_ts) ? &fd->abs_ts : NULL;
}
