packet_ends_transfer(usbll_endpoint_info_t *ep_info, guint32 offset, gint data_size)
{
    DISSECTOR_ASSERT(ep_info->type != USBLL_EP_UNKNOWN);
    if (ep_info->requested_transfer_length != 0)
    {
        if (offset + data_size >= ep_info->requested_transfer_length)
        {
            return TRUE;
        }
    }
    else
    {
        DISSECTOR_ASSERT(ep_info->type != USBLL_EP_CONTROL);
        DISSECTOR_ASSERT(ep_info->max_packet_size != 0);
        if (ep_info->type != USBLL_EP_BULK)
        {
            return TRUE;
        }
    }
    if (ep_info->max_packet_size)
    {
        return data_size < ep_info->max_packet_size;
    }
    DISSECTOR_ASSERT(ep_info->type == USBLL_EP_CONTROL);
    return FALSE;
}
