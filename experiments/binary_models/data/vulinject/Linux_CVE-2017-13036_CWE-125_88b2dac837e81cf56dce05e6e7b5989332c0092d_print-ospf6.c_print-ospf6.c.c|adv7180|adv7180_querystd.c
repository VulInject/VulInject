static int adv7180_querystd(struct v4l2_subdev *sd, v4l2_std_id *std)
{
	struct adv7180_state *state = to_state(sd);
	if (err)
		return err;
	if (state->streaming) {
		err = -EBUSY;
		goto unlock;
	}
	err = adv7180_set_video_standard(state,
			ADV7180_STD_AD_PAL_BG_NTSC_J_SECAM);
	if (err)
		goto unlock;
	msleep(100);
	__adv7180_status(state, NULL, std);
	err = v4l2_std_to_adv7180(state->curr_norm);
	if (err < 0)
		goto unlock;
	err = adv7180_set_video_standard(state, err);
unlock:
	mutex_unlock(&state->mutex);
	return err;
}
