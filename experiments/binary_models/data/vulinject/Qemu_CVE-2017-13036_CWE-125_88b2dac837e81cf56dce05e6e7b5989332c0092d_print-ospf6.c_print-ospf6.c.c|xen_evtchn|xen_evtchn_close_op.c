int xen_evtchn_close_op(struct evtchn_close *close)
{
    XenEvtchnState *s = xen_evtchn_singleton;
    bool flush_kvm_routes = false;
    int ret;
    if (!s) {
        return -ENOTSUP;
    }
    if (!valid_port(close->port)) {
        return -EINVAL;
    }
    BQL_LOCK_GUARD();
    ret = close_port(s, close->port, &flush_kvm_routes);
    qemu_mutex_unlock(&s->port_lock);
    if (flush_kvm_routes) {
        kvm_update_msi_routes_all(NULL, true, 0, 0);
    }
    return ret;
}
