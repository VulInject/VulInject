static void test_machine(const void *machine)
{
    const char *extra_args = "";
    QTestState *qts;
    /*
     * The pseries firmware boots much faster without the default
     * devices, it also needs Spectre/Meltdown workarounds disabled to
     * avoid warnings with TCG
     */
    if (strcmp(machine, "pseries") == 0) {
        extra_args = "-nodefaults"
            " -machine " PSERIES_DEFAULT_CAPABILITIES;
    }
    qts = qtest_initf("-M %s -accel tcg %s -prom-env \"use-nvramrc?=true\" "
                      "-prom-env \"nvramrc=%x %x l!\" ", (const char *)machine,
                      extra_args, MAGIC, ADDRESS);
    qtest_quit(qts);
}
