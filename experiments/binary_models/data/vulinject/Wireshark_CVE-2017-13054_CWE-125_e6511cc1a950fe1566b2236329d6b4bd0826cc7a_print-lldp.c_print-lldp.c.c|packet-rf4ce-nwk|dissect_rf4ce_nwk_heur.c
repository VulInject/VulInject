static gboolean dissect_rf4ce_nwk_heur(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void *data)
{
    guint reported_length = tvb_reported_length(tvb);
    guint length = tvb_captured_length(tvb);
    guint8 fcf;
    guint8 frame_type;
    guint8 security_enabled;
    guint8 reserved;
    guint8 profile_id;
    guint16 vendor_id;
    guint8 command_id;
    if (reported_length >= RF4CE_MIN_NWK_LENGTH && reported_length <= RF4CE_MAX_NWK_LENGTH)
    {
        if (length < RF4CE_MIN_NWK_LENGTH)
        {
            return FALSE;
        }
        fcf = tvb_get_guint8(tvb, 0);
        frame_type = fcf & RF4CE_NWK_FCF_FRAME_TYPE_MASK;
        security_enabled = fcf & RF4CE_NWK_FCF_SECURITY_MASK;
        reserved = (fcf & RF4CE_NWK_FCF_RESERVED_MASK) >> 5;
        switch (frame_type)
        {
            case RF4CE_NWK_FCF_FRAME_TYPE_DATA:
            case RF4CE_NWK_FCF_FRAME_TYPE_CMD:
            case RF4CE_NWK_FCF_FRAME_TYPE_VENDOR_SPECIFIC:
                break;
            default:
                return FALSE;
        }
        if (reserved != 1)
        {
            return FALSE;
        }
        if((frame_type == RF4CE_NWK_FCF_FRAME_TYPE_DATA) || (frame_type == RF4CE_NWK_FCF_FRAME_TYPE_VENDOR_SPECIFIC))
        {
            profile_id = tvb_get_guint8(tvb, 5);
            if ((profile_id >= 0x04) && (profile_id <= 0xbf))
            {
                return FALSE;
            }
            if (frame_type == RF4CE_NWK_FCF_FRAME_TYPE_VENDOR_SPECIFIC)
            {
                if (length < 8)
                {
                    return FALSE;
                }
                vendor_id = tvb_get_letohs(tvb, 6);
                switch (vendor_id)
                {
                    case RF4CE_VENDOR_ID_PANASONIC:
                    case RF4CE_VENDOR_ID_SONY:
                    case RF4CE_VENDOR_ID_SAMSUNG:
                    case RF4CE_VENDOR_ID_PHILIPS:
                    case RF4CE_VENDOR_ID_FREESCALE:
                    case RF4CE_VENDOR_ID_OKI:
                    case RF4CE_VENDOR_ID_TEXAS_INSTRUMENTS:
                    case RF4CE_VENDOR_ID_TEST_1:
                    case RF4CE_VENDOR_ID_TEST_2:
                    case RF4CE_VENDOR_ID_TEST_3:
                        break;
                    default:
                        return FALSE;
                }
            }
        }
        else if(frame_type == RF4CE_NWK_FCF_FRAME_TYPE_CMD)
        {
            if (length < 6)
            {
                return FALSE;
            }
            if (!security_enabled)
            {
                command_id = tvb_get_guint8(tvb, 5);
                switch (command_id)
                {
                    case RF4CE_NWK_CMD_DISCOVERY_REQ:
                    case RF4CE_NWK_CMD_DISCOVERY_RSP:
                    case RF4CE_NWK_CMD_PAIR_REQ:
                    case RF4CE_NWK_CMD_PAIR_RSP:
                    case RF4CE_NWK_CMD_UNPAIR_REQ:
                    case RF4CE_NWK_CMD_KEY_SEED:
                    case RF4CE_NWK_CMD_PING_REQ:
                    case RF4CE_NWK_CMD_PING_RSP:
                        break;
                    default:
                        return FALSE;
                }
            }
        }
        col_set_str(pinfo->cinfo, COL_PROTOCOL, "RF4CE NWK");
        col_clear(pinfo->cinfo, COL_INFO);
        dissect_rf4ce_nwk_common(tvb, pinfo, tree, data);
        return TRUE;
    }
    return FALSE;
}
