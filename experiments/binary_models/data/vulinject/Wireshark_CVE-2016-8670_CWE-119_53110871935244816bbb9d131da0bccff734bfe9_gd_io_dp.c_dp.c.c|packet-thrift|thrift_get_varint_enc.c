thrift_get_varint_enc(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, int offset, int max_length, guint64 *value, const guint encoding)
{
    guint length;
    int readable = tvb_reported_length_remaining(tvb, offset);
		if(readable == 0) {
        return THRIFT_REQUEST_REASSEMBLY;
    }
    if (readable > TCP_THRIFT_MAX_I64_LEN) {
        readable = TCP_THRIFT_MAX_I64_LEN;
    }
    length = tvb_get_varint(tvb, offset, readable, value, encoding);
    if (length == 0) {
        if (readable < max_length) {
            return THRIFT_REQUEST_REASSEMBLY;
        } else {
            proto_tree_add_expert(tree, pinfo, &ei_thrift_varint_too_large, tvb, offset, max_length);
        }
    }
    return length;
}
