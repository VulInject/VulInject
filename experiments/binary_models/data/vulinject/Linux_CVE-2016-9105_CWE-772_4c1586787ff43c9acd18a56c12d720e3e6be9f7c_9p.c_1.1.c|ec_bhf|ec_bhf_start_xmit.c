static netdev_tx_t ec_bhf_start_xmit(struct sk_buff *skb,
				     struct net_device *net_dev)
{
	struct ec_bhf_priv *priv = netdev_priv(net_dev);
	struct tx_desc *desc;
	unsigned len;
	desc = &priv->tx_descs[priv->tx_dnext];
	skb_copy_and_csum_dev(skb, desc->data);
	len = skb->len;
	memset(&desc->header, 0, sizeof(desc->header));
	desc->header.len = cpu_to_le16(len);
	desc->header.port = TX_HDR_PORT_0;
	priv->tx_dnext = (priv->tx_dnext + 1) % priv->tx_dcount;
	if (!ec_bhf_desc_sent(&priv->tx_descs[priv->tx_dnext])) {
		smp_wmb();
		netif_stop_queue(net_dev);
	}
	priv->stat_tx_bytes += len;
	dev_kfree_skb(skb);
	return NETDEV_TX_OK;
}
