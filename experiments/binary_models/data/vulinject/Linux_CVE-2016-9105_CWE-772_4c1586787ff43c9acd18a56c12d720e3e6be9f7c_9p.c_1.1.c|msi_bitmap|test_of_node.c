static void __init test_of_node(void)
{
	unsigned int prop_data[] = { 10, 10, 25, 3, 40, 1, 100, 100, 200, 20 };
	const char *expected_str = "0-9,20-24,28-39,41-99,220-255";
	char *prop_name = "msi-available-ranges";
	char *node_name = "/fakenode";
	struct device_node of_node;
	struct property prop;
	struct msi_bitmap bmp;
	memset(&of_node, 0, sizeof(of_node));
	of_node_init(&of_node);
	of_node.full_name = node_name;
	WARN_ON(msi_bitmap_alloc(&bmp, SIZE_EXPECTED, &of_node));
	WARN_ON(msi_bitmap_reserve_dt_hwirqs(&bmp) <= 0);
	WARN_ON(bitmap_find_free_region(bmp.bitmap, SIZE_EXPECTED,
					get_count_order(SIZE_EXPECTED)));
	bitmap_release_region(bmp.bitmap, 0, get_count_order(SIZE_EXPECTED));
	memset(&prop, 0, sizeof(prop));
	prop.name = prop_name;
	prop.value = &prop_data;
	prop.length = sizeof(prop_data);
	of_node.properties = &prop;
	WARN_ON(msi_bitmap_reserve_dt_hwirqs(&bmp));
	WARN_ON(bitmap_parselist(expected_str, expected, SIZE_EXPECTED));
	WARN_ON(!bitmap_equal(expected, bmp.bitmap, SIZE_EXPECTED));
	msi_bitmap_free(&bmp);
	kfree(bmp.bitmap);
}
