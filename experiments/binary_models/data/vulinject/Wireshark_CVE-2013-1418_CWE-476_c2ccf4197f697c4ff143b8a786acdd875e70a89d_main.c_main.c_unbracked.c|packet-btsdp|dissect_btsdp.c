dissect_btsdp(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void *data)
{
    proto_item    *ti;
    proto_tree    *st;
    gint          offset = 0;
    guint8        pdu_id;
    guint16       tid;
    btl2cap_data_t   *l2cap_data;
    l2cap_data = (btl2cap_data_t *) data;
    ti = proto_tree_add_item(tree, proto_btsdp, tvb, 0, tvb_captured_length(tvb), ENC_NA);
    st = proto_item_add_subtree(ti, ett_btsdp);
    col_set_str(pinfo->cinfo, COL_PROTOCOL, "SDP");
    switch (pinfo->p2p_dir) {
        case P2P_DIR_SENT:
            col_set_str(pinfo->cinfo, COL_INFO, "Sent ");
            break;
        case P2P_DIR_RECV:
            col_set_str(pinfo->cinfo, COL_INFO, "Rcvd ");
            break;
        default:
            col_set_str(pinfo->cinfo, COL_INFO, "UnknownDirection ");
            break;
    }
    proto_tree_add_item(st, hf_pdu_id, tvb, offset, 1, ENC_BIG_ENDIAN);
    pdu_id = tvb_get_guint8(tvb, offset);
    offset += 1;
    col_append_fstr(pinfo->cinfo, COL_INFO, "%s ",
            val_to_str_const(pdu_id, vs_pduid, "Unknown"));
    proto_tree_add_item(st, hf_tid, tvb, offset, 2, ENC_BIG_ENDIAN);
    tid = tvb_get_ntohs(tvb, offset);
    offset += 2;
    proto_tree_add_item(st, hf_parameter_length, tvb, offset, 2, ENC_BIG_ENDIAN);
    offset += 2;
    switch (pdu_id) {
        case 0x01:
            offset = dissect_sdp_error_response(st, tvb, offset);
            break;
        case 0x02:
            offset = dissect_sdp_service_search_request(st, tvb, offset, pinfo, tid, l2cap_data);
            break;
        case 0x03:
            offset = dissect_sdp_service_search_response(st, tvb, offset, pinfo, tid, l2cap_data);
            break;
        case 0x04:
            offset = dissect_sdp_service_attribute_request(st, tvb, offset, pinfo, tid, l2cap_data);
            break;
        case 0x05:
            offset = dissect_sdp_service_attribute_response(st, tvb, offset, pinfo, tid, l2cap_data);
            break;
        case 0x06:
            offset = dissect_sdp_service_search_attribute_request(st, tvb, offset, pinfo, tid, l2cap_data);
            break;
        case 0x07:
            offset = dissect_sdp_service_search_attribute_response(st, tvb, offset, pinfo, tid, l2cap_data);
            break;
    }
    return offset;
}
