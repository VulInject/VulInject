build_column_format_array(column_info *cinfo, const int num_cols, const bool reset_fences)
{
  int i;
  col_item_t* col_item;
  for (i = 0; i < cinfo->num_cols; i++) {
    col_item = &cinfo->columns[i];
    col_item->col_fmt = get_column_format(i);
    col_item->col_title = g_strdup(get_column_title(i));
    if (col_item->col_fmt == COL_CUSTOM) {
      col_item->col_custom_fields = g_strdup(get_column_custom_fields(i));
      col_item->col_custom_occurrence = get_column_custom_occurrence(i);
    }
    col_item->hf_id = proto_registrar_get_id_byname(col_format_abbrev(col_item->col_fmt));
    if(reset_fences)
      col_item->col_fence = 0;
  }
  col_finalize(cinfo);
}
