advance_to_end_of_signature(packet_info *pinfo, const guint8 **signature, guint8  *signature_length)
{
    gboolean done = FALSE;
    gint8 current_type;
    gint8 end_type = ARG_INVALID;
    while (*signature_length > 0 && **signature && !done) {
        current_type = *(++(*signature));
        --*signature_length;
        if(end_type != ARG_INVALID) {
            if(end_type == current_type) {
                done = TRUE; 
            }
            continue;
        }
        switch(current_type)
        {
        case ARG_ARRAY:
            advance_to_end_of_signature(pinfo, signature, signature_length);
            break;
        case ARG_STRUCT:
            end_type = ')';
            advance_to_end_of_signature(pinfo, signature, signature_length);
            break;
        case ARG_DICT_ENTRY:
            end_type = '}';
            advance_to_end_of_signature(pinfo, signature, signature_length);
            break;
        case ARG_BYTE:
        case ARG_DOUBLE:
        case ARG_UINT64:
        case ARG_INT64:
        case ARG_SIGNATURE:
        case ARG_HANDLE:
        case ARG_INT32:
        case ARG_UINT32:
        case ARG_BOOLEAN:
        case ARG_INT16:
        case ARG_UINT16:
        case ARG_STRING:
        case ARG_VARIANT:
        case ARG_OBJ_PATH:
            done = TRUE;
            break;
        default:    
            done = TRUE;
            break;
        }
    }
    decrement_dissection_depth(pinfo);
}
