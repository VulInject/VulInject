static bool can_access(unsigned int dom_id, GList *perms, const char *letters)
{
	int i, n;
    char perm_letter;
    unsigned int perm_dom_id;
    bool access;
    if (dom_id == 0) {
        return true;
    }
    n = g_list_length(perms);
    assert(n >= 1);
    /*
     * The dom_id of the first perm is the owner, and the owner always has
     * read-write access.
     */
    parse_perm(g_list_nth_data(perms, 0), &perm_letter, &perm_dom_id);
    if (dom_id == perm_dom_id) {
        return true;
    }
    /*
     * The letter of the first perm specified the default access for all other
     * domains.
     */
    access = !!strchr(letters, perm_letter);
    for (i = 1; i < n; i++) {
        parse_perm(g_list_nth_data(perms, i), &perm_letter, &perm_dom_id);
        if (dom_id != perm_dom_id) {
            continue;
        }
        access = !!strchr(letters, perm_letter);
    }
    return access;
}
