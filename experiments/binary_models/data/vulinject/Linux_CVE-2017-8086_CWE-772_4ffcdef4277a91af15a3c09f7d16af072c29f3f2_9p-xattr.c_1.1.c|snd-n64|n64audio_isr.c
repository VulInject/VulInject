static irqreturn_t n64audio_isr(int irq, void *dev_id)
{
	struct n64audio *priv = dev_id;
	const unsigned int intrs = n64mi_read_reg(priv, MI_INTR_REG);
	unsigned int flags;
	if (!(intrs & MI_INTR_AI))
		return IRQ_NONE;
	n64audio_write_reg(priv, AI_STATUS_REG, 1);
	if (priv->chan.substream && snd_pcm_running(priv->chan.substream)) {
		spin_lock_irqsave(&priv->chan.lock, flags);
		priv->chan.pos = priv->chan.nextpos;
		spin_unlock_irqrestore(&priv->chan.lock, flags);
		snd_pcm_period_elapsed(priv->chan.substream);
		if (priv->chan.substream && snd_pcm_running(priv->chan.substream))
	}
	return IRQ_HANDLED;
}
