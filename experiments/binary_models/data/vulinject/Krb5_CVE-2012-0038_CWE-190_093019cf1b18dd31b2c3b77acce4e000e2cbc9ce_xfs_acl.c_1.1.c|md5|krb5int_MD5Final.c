krb5int_MD5Final (krb5_MD5_CTX *mdContext)
{
    krb5_ui_4 in[16];
    int mdi;
	int i, ii;
    unsigned int padLen;
    in[14] = mdContext->i[0];
    in[15] = mdContext->i[1];
    mdi = (int)((mdContext->i[0] >> 3) & 0x3F);
    padLen = (mdi < 56) ? (56 - mdi) : (120 - mdi);
    krb5int_MD5Update (mdContext, PADDING, padLen);
    for (i = 0, ii = 0; i < 14; i++, ii += 4)
        in[i] = load_32_le(mdContext->in+ii);
    Transform (mdContext->buf, in);
    for (i = 0, ii = 0; i < 4; i++, ii += 4) {
        store_32_le(mdContext->buf[i], mdContext->digest+ii);
    }
}
