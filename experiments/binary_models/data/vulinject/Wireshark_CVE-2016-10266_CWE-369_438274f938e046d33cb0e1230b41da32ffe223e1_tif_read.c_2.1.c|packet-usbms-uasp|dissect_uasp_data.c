dissect_uasp_data(tvbuff_t *tvb, packet_info *pinfo,
                  proto_tree *parent_tree, proto_tree *uasp_tree,
                  usb_conv_info_t *usb_conv_info, uasp_conv_info_t *uasp_conv_info)
{
    proto_item        *ti;
    guint16            tag;
    uasp_itlq_nexus_t *uitlq;
    gboolean           is_request;
    is_request = (usb_conv_info->direction == P2P_DIR_SENT) ? TRUE : FALSE;
    if (is_request)
	tag=((uasp_conv_info->write_ready+pinfo-1)/pinfo);
    else
        tag = get_ready_iu(uasp_conv_info->read_ready, pinfo);
    ti = proto_tree_add_uint(uasp_tree, hf_uas_tag, tvb, 0, 0, tag);
    proto_item_set_generated(ti);
    uitlq = get_itlq_nexus(pinfo, uasp_conv_info, tag);
    if (uitlq) {
        if (is_request)
            uitlq->data_sent_frame = pinfo->num;
        else
            uitlq->data_recv_frame = pinfo->num;
        add_uasp_tag_links(tvb, uasp_tree, uitlq, is_request ? DATA_WRITE : DATA_READ);
        dissect_scsi_payload(tvb, pinfo, parent_tree, is_request, &uitlq->itlq, uitlq->itl, 0);
    }
    return tvb_captured_length(tvb);
}
