static gint dissect_parameter_transport_rtps_type(
        tvbuff_t *tvb,
        proto_tree *rtpsvt_tree_general,
        proto_tree *rtpsvt_tree_identifier,
        proto_tree *rtpsvt_tree_information,
        gint offset,
        packet_info *pinfo,
        struct rtpsvt_data *transport_data)
{
    guint16 param_id = tvb_get_guint16(tvb, offset, ENC_BIG_ENDIAN);
    guint16 param_length = tvb_get_guint16(tvb, offset + 2, ENC_BIG_ENDIAN);
    const gint OFFSET_TO_VAL = offset + 4;
		if(param_length == 0) {
        return OFFSET_TO_VAL;
    }
    switch(param_id) {
        case PARAM_ID_TRANSPORT_CLASS:
            {
                proto_tree *rtpsvt_tree_information_class;
                gint32 classId = tvb_get_gint32(tvb, OFFSET_TO_VAL, ENC_BIG_ENDIAN);
                const gchar *className = val_to_str(
                        classId,
                        ndds_transport_class_id_vals,
                        "%d");
                rtpsvt_tree_information_class = proto_tree_add_subtree_format(
                        rtpsvt_tree_information,
                        tvb,
                        offset,
                        0,
                        ett_rtpsvt_information_class,
                        NULL,
                        "Class: %s",
                        className);
                proto_tree_add_uint(
                        rtpsvt_tree_information_class,
                        hf_rtpsvt_param_id,
                        tvb,
                        offset,
                        2, 
                        param_id);
                offset += 2;
                proto_tree_add_uint(
                        rtpsvt_tree_information_class,
                        hf_rtpsvt_param_length,
                        tvb,
                        offset,
                        2, 
                        param_length);
                offset += 2;
                proto_tree_add_string(
                        rtpsvt_tree_information_class,
                        hf_rtpsvt_class,
                        tvb,
                        offset,
                        param_length,
                        className);
                offset += param_length;
                proto_item_append_text(rtpsvt_tree_general, ", %s", className);
                proto_item_append_text(
                        rtpsvt_tree_information,
                        ", %s",
                        className);
            }
            break;
        case PARAM_ID_MONITORING_GUID:
            {
                proto_tree *rtpsvt_tree_monitoring_guid;
                const guint8 *guid_bytes = tvb_get_ptr(
                        tvb,
                        OFFSET_TO_VAL,
                        param_length);
                const gchar *guid_string = bytes_to_str_punct(
                        pinfo->pool,
                        guid_bytes,
                        MIN(param_length, 12),
                        0);
                rtpsvt_tree_monitoring_guid = proto_tree_add_subtree_format(
                        rtpsvt_tree_identifier,
                        tvb,
                        offset,
                        0,
                        ett_rtpsvt_information_src_addr,
                        NULL,
                        "Monitoring GUID Prefix: %s",
                        guid_string);
                proto_tree_add_uint(
                        rtpsvt_tree_monitoring_guid,
                        hf_rtpsvt_param_id,
                        tvb,
                        offset,
                        2, 
                        param_id);
                offset += 2;
                proto_tree_add_uint(
                        rtpsvt_tree_monitoring_guid,
                        hf_rtpsvt_param_length,
                        tvb,
                        offset,
                        2, 
                        param_length);
                offset += 2;
                proto_tree_add_item(
                        rtpsvt_tree_monitoring_guid,
                        hf_rtpsvt_monitoring_guid,
                        tvb,
                        offset,
                        param_length,
                        ENC_NA);
                offset += param_length;
                proto_item_append_text(
                        rtpsvt_tree_identifier,
                       ", GUID: %s",
                       guid_string);
            }
            break;
        case PARAM_ID_MONITORING_SN:
            {
                proto_tree *rtpsvt_tree_seqNr;
                guint64 seqNr = tvb_get_guint64(tvb, OFFSET_TO_VAL, ENC_BIG_ENDIAN);
                rtpsvt_tree_seqNr = proto_tree_add_subtree_format(
                        rtpsvt_tree_identifier,
                        tvb,
                        offset,
                        0,
                        ett_rtpsvt_monitoring_sn,
                        NULL,
                        "Monitoring Sequence Number: %" PRIu64,
                        seqNr);
                proto_tree_add_uint(
                        rtpsvt_tree_seqNr,
                        hf_rtpsvt_param_id,
                        tvb,
                        offset,
                        2, 
                        param_id);
                offset += 2;
                proto_tree_add_uint(
                        rtpsvt_tree_seqNr,
                        hf_rtpsvt_param_length,
                        tvb,
                        offset,
                        2, 
                        param_length);
                offset += 2;
                proto_tree_add_uint64(
                        rtpsvt_tree_seqNr,
                        hf_rtpsvt_monitoring_seqNr,
                        tvb,
                        offset,
                        param_length,
                        seqNr);
                offset += param_length;
                proto_item_append_text(
                        rtpsvt_tree_identifier,
                        ", SeqNum: %" PRIu64,
                        seqNr);
            }
            break;
        case PARAM_ID_SOURCE_IP_ADDRESS:
            {
                proto_tree *rtpsvt_tree_information_address;
                gint temporary_hf = hf_rtpsvt_source_address;
                const gchar *prefix = "shmem_prefix";
                const gchar *title_tree = "Source address";
                gchar addr[COL_MAX_LEN];
                ws_in6_addr addr_raw;
                static const guint8 bytes_zeroed[12] = {0};
                tvb_get_ipv6(tvb, OFFSET_TO_VAL, &addr_raw);
                if (memcmp(&addr_raw.bytes, prefix, strlen(prefix)) == 0) {
                    temporary_hf = hf_rtpsvt_source_pid;
                    title_tree = "Source process ID";
                    guint32 pid = tvb_get_guint32(
                            tvb,
                            OFFSET_TO_VAL + (gint) (strlen(prefix)),
                            ENC_BIG_ENDIAN);
                    snprintf(addr, sizeof(addr), "%u", pid);
                } else if (memcmp(
                        &addr_raw.bytes,
                        bytes_zeroed,
                        sizeof(bytes_zeroed)) == 0){
                    snprintf(
                            addr,
                            sizeof(addr),
                            "%s",
                            tvb_ip_to_str(pinfo->pool, tvb, OFFSET_TO_VAL + sizeof(bytes_zeroed)));
                } else {
                    snprintf(
                            addr,
                            sizeof(addr),
                            "%s",
                            tvb_ip6_to_str(pinfo->pool, tvb, OFFSET_TO_VAL));
                }
                if (pinfo->cinfo) {
                    col_append_str(pinfo->cinfo, COL_DEF_SRC, addr);
                }
                rtpsvt_tree_information_address = proto_tree_add_subtree_format(
                        rtpsvt_tree_information,
                        tvb,
                        offset,
                        0,
                        ett_rtpsvt_information_src_addr,
                        NULL,
                        "%s: %s",
                        title_tree,
                        addr);
                proto_tree_add_uint(
                        rtpsvt_tree_information_address,
                        hf_rtpsvt_param_id,
                        tvb,
                        offset,
                        2, 
                        param_id);
                offset += 2;
                proto_tree_add_uint(
                        rtpsvt_tree_information_address,
                        hf_rtpsvt_param_length,
                        tvb,
                        offset,
                        2, 
                        param_length);
                offset += 2;
                proto_tree_add_string(
                        rtpsvt_tree_information_address,
                        temporary_hf,
                        tvb,
                        offset,
                        param_length,
                        addr);
                offset += param_length;
                proto_item_append_text(rtpsvt_tree_general, ", Src: (%s", addr);
                proto_item_append_text(
                        rtpsvt_tree_information,
                        ", Src: (%s",
                        addr);
            }
            break;
        case PARAM_ID_SOURCE_PORT:
            {
                proto_tree *rtpsvt_tree_information_port;
                guint32 port = tvb_get_guint32(
                        tvb,
                        OFFSET_TO_VAL,
                        ENC_BIG_ENDIAN);
                rtpsvt_tree_information_port = proto_tree_add_subtree_format(
                        rtpsvt_tree_information,
                        tvb,
                        offset,
                        0,
                        ett_rtpsvt_information_src_port,
                        NULL,
                        "Source port: %d",
                        port);
                proto_tree_add_uint(
                        rtpsvt_tree_information_port,
                        hf_rtpsvt_param_id,
                        tvb,
                        offset,
                        2, 
                        param_id);
                offset += 2;
                proto_tree_add_uint(
                        rtpsvt_tree_information_port,
                        hf_rtpsvt_param_length,
                        tvb,
                        offset,
                        2, 
                        param_length);
                offset += 2;
                proto_tree_add_uint(
                        rtpsvt_tree_information_port,
                        hf_rtpsvt_source_port,
                        tvb,
                        offset,
                        param_length,
                        port);
                offset += param_length;
                proto_item_append_text(rtpsvt_tree_general, ":%d)", port);
                proto_item_append_text(
                        rtpsvt_tree_information,
                        ":%d)",
                        port);
                pinfo->srcport = port;
            }
            break;
        case PARAM_ID_DESTINATION_IP_ADDRESS:
            {
                proto_tree *rtpsvt_tree_information_address;
                gint temporary_hf= hf_rtpsvt_destination_address;
                const gchar *prefix = "shmem_prefix";
                const gchar *title_tree = "Destination address";
                gchar addr[COL_MAX_LEN];
                ws_in6_addr addr_raw;
                static const guint8 bytes_zeroed[12] = {0};
                tvb_get_ipv6(tvb, OFFSET_TO_VAL, &addr_raw);
                if (memcmp(&addr_raw.bytes, prefix, strlen(prefix)) == 0) {
                    temporary_hf = hf_rtpsvt_destination_pid;
                    title_tree = "Destination process ID";
                    guint32 pid = tvb_get_guint32(
                            tvb,
                            OFFSET_TO_VAL + (gint) (strlen(prefix)),
                            ENC_BIG_ENDIAN);
                    snprintf(addr, sizeof(addr), "%u", pid);
                } else if (memcmp(
                        &addr_raw.bytes,
                        bytes_zeroed,
                        sizeof(bytes_zeroed)) == 0){
                    snprintf(
                            addr,
                            sizeof(addr),
                            "%s",
                            tvb_ip_to_str(pinfo->pool, tvb, OFFSET_TO_VAL + sizeof(bytes_zeroed)));
                } else {
                    snprintf(
                            addr,
                            sizeof(addr),
                            "%s",
                            tvb_ip6_to_str(pinfo->pool, tvb, OFFSET_TO_VAL));
                }
                if (pinfo->cinfo) {
                    col_append_str(pinfo->cinfo, COL_DEF_DST, addr);
                }
                rtpsvt_tree_information_address = proto_tree_add_subtree_format(
                        rtpsvt_tree_information,
                        tvb,
                        offset,
                        0,
                        ett_rtpsvt_information_dst_addr,
                        NULL,
                        "%s: %s",
                        title_tree,
                        addr);
                proto_tree_add_uint(
                        rtpsvt_tree_information_address,
                        hf_rtpsvt_param_id,
                        tvb,
                        offset,
                        2, 
                        param_id);
                offset += 2;
                proto_tree_add_uint(
                        rtpsvt_tree_information_address,
                        hf_rtpsvt_param_length,
                        tvb,
                        offset,
                        2, 
                        param_length);
                offset += 2;
                proto_tree_add_string(
                        rtpsvt_tree_information_address,
                        temporary_hf,
                        tvb,
                        offset,
                        param_length,
                        addr);
                offset += param_length;
                proto_item_append_text(rtpsvt_tree_general, ", Dst: (%s", addr);
                proto_item_append_text(
                        rtpsvt_tree_information,
                        ", Dst: (%s",
                        addr);
            }
            break;
        case PARAM_ID_DESTINATION_RTPS_PORT:
            {
                guint32 port = tvb_get_guint32(tvb, OFFSET_TO_VAL, ENC_BIG_ENDIAN);
                proto_tree_add_uint(
                        rtpsvt_tree_information,
                        hf_rtpsvt_destination_rtps_port,
                        tvb,
                        OFFSET_TO_VAL,
                        param_length,
                        port);
                offset = OFFSET_TO_VAL + param_length;
            }
            break;
        case PARAM_ID_DESTINATION_PORT:
            {
                proto_tree *rtpsvt_tree_information_port;
                guint32 port = tvb_get_guint32(tvb, OFFSET_TO_VAL, ENC_BIG_ENDIAN);
                rtpsvt_tree_information_port = proto_tree_add_subtree_format(
                        rtpsvt_tree_information,
                        tvb,
                        offset,
                        0,
                        ett_rtpsvt_information_dst_port,
                        NULL,
                        "Destination port: %d",
                        port);
                proto_tree_add_uint(
                        rtpsvt_tree_information_port,
                        hf_rtpsvt_param_id,
                        tvb,
                        offset,
                        2, 
                        param_id);
                offset += 2;
                proto_tree_add_uint(
                        rtpsvt_tree_information_port,
                        hf_rtpsvt_param_length,
                        tvb,
                        offset,
                        2, 
                        param_length);
                offset += 2;
                proto_tree_add_uint(
                        rtpsvt_tree_information_port,
                        hf_rtpsvt_destination_port,
                        tvb,
                        offset,
                        param_length,
                        port);
                offset += param_length;
                proto_item_append_text(rtpsvt_tree_general, ":%d)", port);
                proto_item_append_text(
                        rtpsvt_tree_information,
                        ":%d)",
                        port);
                pinfo->destport = port;
            }
            break;
        case PARAM_ID_DIRECTION:
            {
                proto_tree *rtpsvt_tree_direction;
                guint8 value = tvb_get_guint8(tvb, OFFSET_TO_VAL);
                const gchar *direction = value ? "INBOUND" : "OUTBOUND";
                rtpsvt_tree_direction = proto_tree_add_subtree_format(
                        rtpsvt_tree_general,
                        tvb,
                        offset,
                        0,
                        ett_rtpsvt_information_src_addr,
                        NULL,
                        "Traffic Direction: %s",
                        direction);
                proto_tree_add_uint(
                        rtpsvt_tree_direction,
                        hf_rtpsvt_param_id,
                        tvb,
                        offset,
                        2, 
                        param_id);
                offset += 2;
                proto_tree_add_uint(
                        rtpsvt_tree_direction,
                        hf_rtpsvt_param_length,
                        tvb,
                        offset,
                        2, 
                        param_length);
                proto_tree_add_string(
                        rtpsvt_tree_direction,
                        hf_rtpsvt_direction,
                        tvb,
                        OFFSET_TO_VAL,
                        param_length,
                        direction);
                offset = OFFSET_TO_VAL + param_length;
                transport_data->direction = value;
            }
            break;
    }
    return offset;
}
