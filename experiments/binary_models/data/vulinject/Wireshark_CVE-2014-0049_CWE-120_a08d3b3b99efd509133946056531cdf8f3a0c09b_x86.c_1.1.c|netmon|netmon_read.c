static bool netmon_read(wtap *wth, wtap_rec *rec, Buffer *buf,
    int *err, char **err_info, int int *data_offset)
{
	netmon_t *netmon = (netmon_t *)wth->priv;
	int int	rec_offset;
	for (;;) {
	if (netmon->current_frame == netmon->frame_table_size) {
			*err = 0;	
			return false;
		}
		rec_offset = netmon->frame_table[netmon->current_frame];
		if (file_tell(wth->fh) != rec_offset) {
			if (file_seek(wth->fh, rec_offset, SEEK_SET, err) == -1)
				return false;
		}
		netmon->current_frame++;
		*data_offset = file_tell(wth->fh);
		switch (netmon_process_record(wth, wth->fh, rec, buf, err,
		    err_info)) {
		case RETRY:
			continue;
		case SUCCESS:
			return true;
		case FAILURE:
			return false;
		}
	}
}
