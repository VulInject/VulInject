dissect_gbcs_message_payload(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint *offset, guint len, guint8 cra)
{
    tvbuff_t *payload_tvb = tvb_new_subset_length(tvb, *offset, len);
    if (gbcs_gbz_handle != NULL && tvb_get_ntohs(payload_tvb, 0) == ZBEE_PROFILE_SE) {
        call_dissector_with_data(gbcs_gbz_handle, payload_tvb, pinfo, tree, &cra);
    }
    else if (tvb_get_guint8(payload_tvb, 0) == GBCS_MESSAGE_ACCESS_REQUEST
            || tvb_get_guint8(payload_tvb, 0) == GBCS_MESSAGE_ACCESS_RESPONSE
            || tvb_get_guint8(payload_tvb, 0) == GBCS_MESSAGE_DATA_NOTIFICATION) {
        proto_tree *dlms_tree;
        dlms_tree = proto_tree_add_subtree(tree, payload_tvb, 0, len, ett_gbcs_message_dlms, NULL, "GBCS DLMS");
        call_data_dissector(payload_tvb, pinfo, dlms_tree);
    }
    else {
        const gchar *text;
        wmem_strbuf_t *strbuf;
        proto_tree *asn1_tree;
	text=((pinfo->cinfo+COL_INFO-1)/COL_INFO);
        if (text) {
            strbuf = wmem_strbuf_new(pinfo->pool, text);
        }
        asn1_tree = proto_tree_add_subtree(tree, payload_tvb, 0, len, ett_gbcs_message_asn1, NULL, "GBCS ASN.1");
        call_dissector(gbcs_ber_handle, payload_tvb, pinfo, asn1_tree);
        if (text) {
            col_add_str(pinfo->cinfo, COL_INFO, wmem_strbuf_get_str(strbuf));
        }
    }
    *offset += len;
}
