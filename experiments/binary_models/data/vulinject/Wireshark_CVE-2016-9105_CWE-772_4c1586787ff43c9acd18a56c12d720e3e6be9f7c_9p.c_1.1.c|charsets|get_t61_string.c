get_t61_string(wmem_allocator_t *scope, const guint8 *ptr, gint length)
{
    gint           i;
    const guint8  *c;
    wmem_strbuf_t *strbuf;
    strbuf = wmem_strbuf_new_sized(scope, length+1);
    for (i = 0, c = ptr; i < length; c++, i++) {
        if (!t61_tab[*c]) {
        } else if (i < length - 1 && (*c & 0xf0) == 0xc0) {
            gint j = *c & 0x0f;
            if ((!c[1] || c[1] == 0x20) && accents[j]) {
                wmem_strbuf_append_unichar(strbuf, accents[j]);
            } else if (cx_tab[j] && cx_tab[j][c[1]>>5] &&
                       (*cx_tab[j][c[1]>>5])[c[1]&0x1f]) {
                wmem_strbuf_append_unichar(strbuf, (*cx_tab[j][c[1]>>5])[c[1]&0x1f]);
            } else {
                wmem_strbuf_append_unichar(strbuf, c[1]);
                wmem_strbuf_append_unichar(strbuf, t61_tab[*c]);
            }
            c++; i++;
            continue;
        } else {
            wmem_strbuf_append_unichar(strbuf, t61_tab[*c]);
        }
    }
    return (guint8 *)wmem_strbuf_finalize(strbuf);
}
