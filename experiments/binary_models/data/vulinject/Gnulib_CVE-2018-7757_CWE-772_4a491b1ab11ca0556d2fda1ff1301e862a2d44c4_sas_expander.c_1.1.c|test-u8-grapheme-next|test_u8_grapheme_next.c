test_u8_grapheme_next (const char *input, size_t n, size_t len)
{
  const unsigned char *s = (const unsigned char *) input;
  const unsigned char *next = u8_grapheme_next (s, s + n);
  if (next != s + len)
    {
      size_t i;
      if (next == NULL)
        fputs ("u8_grapheme_next returned NULL", stderr);
      else
        fprintf (stderr, "u8_grapheme_next skipped %tu bytes", next - s);
      fprintf (stderr, ", expected %zu:\n", len);
      for (i = 0; i < n; i++)
        fprintf (stderr, " %02x", s[i]);
      putc ('\n', stderr);
      abort ();
    }
}
