static void expect_response(command_data_t **cmd_data, packet_info *pinfo, proto_tree *tree,
                            ftdi_mpsse_info_t *mpsse_info, guint8 cmd, guint16 response_length)
{
    if (pinfo->fd->visited)
    {
        DISSECTOR_ASSERT(*cmd_data);
        DISSECTOR_ASSERT((*cmd_data)->cmd == cmd);
        DISSECTOR_ASSERT((*cmd_data)->response_length == response_length);
        if ((*cmd_data)->is_response_set)
        {
            proto_tree *response_in = proto_tree_add_uint(tree, hf_mpsse_response_in, NULL, 0, 0, (*cmd_data)->response_in_packet);
            DISSECTOR_ASSERT((*cmd_data)->command_in_packet == pinfo->num);
        }
        *cmd_data = (*cmd_data)->next;
    }
    else
    {
        record_command_data(cmd_data, pinfo, mpsse_info, cmd, response_length, FALSE);
    }
}
