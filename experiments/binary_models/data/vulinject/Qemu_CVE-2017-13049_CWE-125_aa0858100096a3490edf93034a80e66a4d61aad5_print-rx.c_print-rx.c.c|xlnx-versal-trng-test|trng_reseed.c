static void trng_reseed(const uint32_t *seed)
{
    const char *act;
    uint32_t ctl;
    ctl = TRNG_CTRL_PRNGSTART_MASK |
          TRNG_CTRL_PRNGXS_MASK |
          TRNG_CTRL_TRSSEN_MASK;
    trng_ctrl_clr(ctl | TRNG_CTRL_PRNGMODE_MASK);
    if (seed) {
        trng_load(R_TRNG_EXT_SEED_0, seed);
        act = "Reseed PRNG";
        ctl &= ~TRNG_CTRL_TRSSEN_MASK;
    } else {
        trng_write(R_TRNG_OSC_EN, TRNG_OSC_EN_VAL_MASK);
        act = "Reseed TRNG";
        ctl &= ~TRNG_CTRL_PRNGXS_MASK;
    }
    trng_check_done_status(act);
    trng_ctrl_clr(TRNG_CTRL_PRNGSTART_MASK);
}
