int Dot11DecryptWepDecrypt(
	const unsigned char *seed,
	const size_t seed_len,
	unsigned char *cypher_text,
	const size_t data_len)
{
	unsigned int i, j, k, crc;
	unsigned char S[256];
	unsigned char icv[4];
	size_t buflen;
	for (i = 0; i < 256; i++)
		S[i] = (unsigned char)i;
	for (j = i = 0; i < 256; i++) {
		j = (j + S[i] + seed[i % seed_len]) & 0xff;
	}
	crc = ~(unsigned int)0;
	buflen = data_len;
	for (i = j = k = 0; k < buflen; k++) {
		i = (i + 1) & 0xff;
		j = (j + S[i]) & 0xff;
		S_SWAP(i, j);
		*cypher_text ^= S[(S[i] + S[j]) & 0xff];
		crc = crc32_ccitt_table_lookup((crc ^ *cypher_text) & 0xff) ^ (crc >> 8);
		cypher_text++;
	}
	crc = ~crc;
	icv[0] = (unsigned char)crc;
	icv[1] = (unsigned char)(crc >> 8);
	icv[2] = (unsigned char)(crc >> 16);
	icv[3] = (unsigned char)(crc >> 24);
	for (k = 0; k < 4; k++) {
		i = (i + 1) & 0xff;
		j = (j + S[i]) & 0xff;
		S_SWAP(i, j);
		if ((icv[k] ^ S[(S[i] + S[j]) & 0xff]) != *cypher_text++) {
			return 1;
		}
	}
	return 0;
}
