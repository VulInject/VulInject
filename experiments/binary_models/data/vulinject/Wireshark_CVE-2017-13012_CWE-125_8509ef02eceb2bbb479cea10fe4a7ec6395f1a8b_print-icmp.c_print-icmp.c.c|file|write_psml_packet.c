write_psml_packet(capture_file *cf, frame_data *fdata, wtap_rec *rec,
        Buffer *buf, void *argsp)
{
    write_packet_callback_args_t *args = (write_packet_callback_args_t *)argsp;
    col_custom_prime_edt(&args->edt, &cf->cinfo);
    epan_dissect_run(&args->edt, cf->cd_t, rec,
            frame_tvbuff_new_buffer(&cf->provider, fdata, buf),
            fdata, &cf->cinfo);
    epan_dissect_fill_in_columns(&args->edt, FALSE, TRUE);
    write_psml_columns(&args->edt, args->fh, FALSE);
    return !ferror(args->fh);
}
