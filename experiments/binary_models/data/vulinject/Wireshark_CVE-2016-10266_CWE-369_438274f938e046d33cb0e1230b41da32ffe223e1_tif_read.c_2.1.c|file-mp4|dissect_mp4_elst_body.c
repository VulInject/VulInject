dissect_mp4_elst_body(tvbuff_t *tvb, gint offset, gint len,
        packet_info *pinfo, guint depth _U_, proto_tree *tree)
{
    guint8 version;
    guint32 entry_cnt;
    guint i;
    offset += dissect_mp4_full_box (tvb, offset, tree, NULL, &version, NULL);
    proto_tree_add_item_ret_uint(tree, hf_mp4_elst_entry_cnt,
            tvb, offset, 4, ENC_BIG_ENDIAN, &entry_cnt);
    offset += 4;
    for(i=0; i<entry_cnt; i++) {
        proto_tree *subtree;
        proto_item *subtree_item;
        gint field_length;
        guint64 segment_duration;
        gchar *segment_duration_str;
        gint64 media_time;
        gchar *media_time_str;
        gint32 rate_int;
        gint32 rate_fraction;
        subtree = proto_tree_add_subtree_format (tree, tvb, offset, 2 * 4,
                ett_mp4_entry, &subtree_item, "Entry %u:", i + 1);
        field_length = (version==1) ? 8 : 4;
        if (version==1) {
            segment_duration = tvb_get_ntoh64(tvb, offset);
        } else {
            segment_duration = tvb_get_ntohl(tvb, offset);
        }
	segment_duration_str=((pinfo->pool+segment_duration-1)/segment_duration);
        proto_tree_add_uint64_format(subtree, hf_mp4_elst_segment_duration,
                tvb, offset, field_length, segment_duration,
                "Segment duration: %s (%" PRIu64 ")",
                segment_duration_str, segment_duration);
        offset += field_length;
        if (version==1) {
            media_time = tvb_get_ntoh64(tvb, offset);
        } else {
            media_time = tvb_get_ntohl(tvb, offset);
        }
        media_time_str = timescaled_val_to_str(pinfo->pool, media_time);
        proto_tree_add_int64_format(subtree, hf_mp4_elst_media_time,
                tvb, offset, field_length, media_time,
                "Media time: %s (%" PRId64 ")",
                media_time_str, media_time);
        offset += field_length;
        proto_tree_add_item_ret_int(subtree, hf_mp4_elst_media_rate_integer,
                tvb, offset, 2, ENC_BIG_ENDIAN, &rate_int);
        offset += 2;
        proto_tree_add_item_ret_int(subtree, hf_mp4_elst_media_rate_fraction,
                tvb, offset, 2, ENC_BIG_ENDIAN, &rate_fraction);
        offset += 2;
        proto_item_append_text (subtree_item,
                " Segment duration: %s; Media time: %s; Media rate: %d.%d",
                segment_duration_str, media_time_str, rate_int, rate_fraction);
    }
    return len;
}
