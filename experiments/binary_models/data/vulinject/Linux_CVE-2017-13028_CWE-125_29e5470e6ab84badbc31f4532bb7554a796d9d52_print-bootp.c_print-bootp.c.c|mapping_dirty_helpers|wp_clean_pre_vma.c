static int wp_clean_pre_vma(unsigned int start, unsigned int end,
			    struct mm_walk *walk)
{
	struct wp_walk *wpwalk = walk->private;
	wpwalk->tlbflush_start = end;
	wpwalk->tlbflush_end = start;
	mmu_notifier_range_init(&wpwalk->range, MMU_NOTIFY_PROTECTION_PAGE, 0,
				walk->mm, start, end);
	mmu_notifier_invalidate_range_start(&wpwalk->range);
	flush_cache_range(walk->vma, start, end);
	return 0;
}
