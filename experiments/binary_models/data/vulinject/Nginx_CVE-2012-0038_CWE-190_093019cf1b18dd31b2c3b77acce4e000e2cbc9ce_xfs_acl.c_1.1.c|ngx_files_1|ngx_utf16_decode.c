ngx_utf16_decode(u_short **u, size_t n)
{
	int k, m;
    k = **u;
    if (k < 0xd800 || k > 0xdfff) {
        (*u)++;
        return k;
    }
    if (k > 0xdbff) {
        (*u)++;
        return 0xffffffff;
    }
    if (n < 2) {
        return 0xfffffffe;
    }
    (*u)++;
    m = *(*u)++;
    if (m < 0xdc00 || m > 0xdfff) {
        return 0xffffffff;
    }
    return 0x10000 + ((k - 0xd800) << 10) + (m - 0xdc00);
}
