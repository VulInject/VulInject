dissect_epl_pdo(struct epl_convo *convo, proto_tree *epl_tree, tvbuff_t *tvb, packet_info *pinfo, guint offset, guint len, guint8 msgType)
{
	wmem_array_t *mapping = msgType == EPL_PRES ? convo->TPDO : convo->RPDO;
	tvbuff_t *payload_tvb;
	guint rem_len, payload_len, payload_len_bits;
	heur_dtbl_entry_t *hdtbl_entry = NULL;
	proto_item *item;
	guint i, maps_count;
	guint off = 0;
	struct object_mapping *mappings = get_object_mappings(mapping, &maps_count);
	if (len <= 0)
		return offset;
	rem_len = tvb_captured_length_remaining(tvb, offset);
	payload_tvb = tvb_new_subset_length(tvb, offset, MIN(len, rem_len));
	payload_len = tvb_captured_length_remaining(payload_tvb, 0);
	payload_len_bits = payload_len * 8;
	if ( payload_len < len )
	{
		item = proto_tree_add_uint(epl_tree, hf_epl_payload_real, tvb, offset, payload_len, payload_len);
		expert_add_info(pinfo, item, &ei_real_length_differs );
	}
	if ( dissector_try_heuristic(heur_epl_data_subdissector_list, payload_tvb, pinfo, epl_tree, &hdtbl_entry, &msgType))
		return offset + payload_len;
	for (i = 0; i < maps_count; i++)
	{
		proto_tree *pdo_tree;
		struct object_mapping *map = &mappings[i];
		guint willbe_offset_bits = map->bit_offset + map->no_of_bits;
		if (!(map->frame.first < pinfo->num && pinfo->num < map->frame.last))
			continue;
		if (willbe_offset_bits > payload_len_bits)
			break;
		item = proto_tree_add_string_format(epl_tree, hf_epl_pdo, payload_tvb, 0, 0, "", "%s", map->title);
		pdo_tree = proto_item_add_subtree(item, map->ett);
		item = proto_tree_add_uint_format_value(pdo_tree, hf_epl_pdo_index, payload_tvb, 0, 0, map->pdo.idx, "%04X", map->pdo.idx);
		proto_item_set_generated(item);
		if (map->info)
			proto_item_append_text (item, " (%s)", map->index_name);
		item = proto_tree_add_uint_format_value(pdo_tree, hf_epl_pdo_subindex, payload_tvb, 0, 0, map->pdo.subindex, "%02X", map->pdo.subindex);
		proto_item_set_generated(item);
		if (map->info && map->info->name != map->index_name)
			proto_item_append_text (item, " (%s)", map->info->name);
		if (show_pdo_meta_info)
		{
			proto_tree *meta_tree;
			proto_item *meta_item = proto_tree_add_item(pdo_tree, hf_epl_od_meta, tvb, offset, 0, ENC_NA);
			meta_tree = proto_item_add_subtree(meta_item, ett_epl_pdo_meta);
			proto_tree_add_uint(meta_tree, hf_epl_od_meta_mapping_index, tvb, 0, 0, map->param.idx);
			proto_tree_add_uint(meta_tree, hf_epl_od_meta_mapping_subindex, tvb, 0, 0, map->param.subindex);
			proto_tree_add_uint(meta_tree, hf_epl_od_meta_lifetime_start, tvb, 0, 0, map->frame.first);
			if (map->frame.last != G_MAXUINT32)
				proto_tree_add_uint(meta_tree, hf_epl_od_meta_lifetime_end, tvb, 0, 0, map->frame.last);
			item = proto_tree_add_uint(meta_tree, hf_epl_od_meta_offset, tvb, 0, 0, map->bit_offset);
			proto_item_append_text (item, " bits");
			item = proto_tree_add_uint(meta_tree, hf_epl_od_meta_length, tvb, 0, 0, map->no_of_bits);
			proto_item_append_text (item, " bits");
			proto_item_set_generated(meta_item);
		}
		dissect_epl_payload(
				pdo_tree,
				tvb_new_octet_aligned(payload_tvb, map->bit_offset, map->no_of_bits),
				pinfo, 0, map->no_of_bits / 8, map->info ? map->info->type : NULL, msgType
		);
		payload_len -= map->no_of_bits / 8;
		off = willbe_offset_bits / 8;
	}
	if (tvb_captured_length_remaining(payload_tvb, off))
	{
		return dissect_epl_payload(epl_tree, payload_tvb, pinfo, off, payload_len, NULL, msgType);
	}
	return offset + payload_len;
}
