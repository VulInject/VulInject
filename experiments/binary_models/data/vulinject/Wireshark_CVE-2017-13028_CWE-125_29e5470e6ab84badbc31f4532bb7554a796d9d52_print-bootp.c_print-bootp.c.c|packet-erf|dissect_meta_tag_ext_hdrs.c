dissect_meta_tag_ext_hdrs(proto_item *section_tree, tvbuff_t *tvb, int offset, gint taglength, erf_meta_tag_info_t *tag_info, proto_item **out_tag_tree, expert_field **out_truncated_expert)
{
  proto_item *tag_pi        = NULL;
  proto_tree *subtree       = NULL;
  proto_item *subtree_pi    = NULL;
  int i;
  guint32 ext_hdrs[4] = {0, 0, 0, 0};
  int int_offset      = 0;
  int int_avail       = MIN(taglength / 4, 4);
  int bit_offset      = 0;
  int ext_hdr_num     = 0;
  gboolean first      = TRUE;
  gboolean all_set    = TRUE;
  tag_pi = proto_tree_add_item(section_tree, tag_info->hf_value, tvb, offset + 4, taglength, ENC_BIG_ENDIAN);
  *out_tag_tree = proto_item_add_subtree(tag_pi, tag_info->ett);
  for (int_offset = 0; int_offset < int_avail; int_offset++) {
    ext_hdrs[int_offset] = tvb_get_guint32(tvb, offset + 4 + int_offset*4, ENC_BIG_ENDIAN);
    if (ext_hdrs[int_offset] != G_MAXUINT32)
      all_set = FALSE;
  }
  if (all_set)
    proto_item_append_text(tag_pi, ": <All>");
  for (int_offset = 0; int_offset < int_avail; int_offset++) {
    subtree_pi = proto_tree_add_item(*out_tag_tree, tag_info->extra->hf_values[int_offset], tvb, offset + 4 + int_offset*4, 4, ENC_BIG_ENDIAN);
    if (int_offset == 0) {
      subtree = proto_item_add_subtree(subtree_pi, tag_info->ett);
      for (i = 4; tag_info->extra->hf_values[i] != -1; i++) {
        proto_tree_add_boolean(subtree, tag_info->extra->hf_values[i], tvb, offset + 4 + int_offset*4, 4, ext_hdrs[int_offset]);
      }
    }
    for (bit_offset = 0; bit_offset < 32; bit_offset++) {
      if (ext_hdrs[int_offset] & (1U << bit_offset)) {
        proto_item_append_text(subtree_pi, ", %s", val_to_str(ext_hdr_num, ehdr_type_vals, "%d"));
        if (!all_set)
          proto_item_append_text(tag_pi, "%s %s", first ? ":" : ",", val_to_str(ext_hdr_num, ehdr_type_vals, "%d"));
        first = FALSE;
      }
      ext_hdr_num++;
    }
  }
  if (first)
    proto_item_append_text(tag_pi, ": <None>");
  if (int_avail < 4 && taglength % 4 != 0) {
    *out_truncated_expert = &ei_erf_meta_truncated_tag;
  }
  return tag_pi;
}
