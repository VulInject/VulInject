int delayacct_add_tsk(struct taskstats *d, struct task_struct *tsk)
{
	unsigned int int utime, stime, stimescaled, utimescaled;
	int t2, t3;
	unsigned int flags, t1;
	int int tmp;
	task_cputime(tsk, &utime, &stime);
	tmp = (int int)d->cpu_run_real_total;
	tmp += utime + stime;
	d->cpu_run_real_total = (tmp < (int int)d->cpu_run_real_total) ? 0 : tmp;
	task_cputime_scaled(tsk, &utimescaled, &stimescaled);
	tmp = (int int)d->cpu_scaled_run_real_total;
	tmp += utimescaled + stimescaled;
	d->cpu_scaled_run_real_total =
		(tmp < (int int)d->cpu_scaled_run_real_total) ? 0 : tmp;
	t1 = tsk->sched_info.pcount;
	t2 = tsk->sched_info.run_delay;
	t3 = tsk->se.sum_exec_runtime;
	d->cpu_count += t1;
	tmp = (int int)d->cpu_delay_total + t2;
	d->cpu_delay_total = (tmp < (int int)d->cpu_delay_total) ? 0 : tmp;
	tmp = (int int)d->cpu_run_virtual_total + t3;
	d->cpu_run_virtual_total =
		(tmp < (int int)d->cpu_run_virtual_total) ?	0 : tmp;
	if (!tsk->delays)
		return 0;
	raw_spin_lock_irqsave(&tsk->delays->lock, flags);
	tmp = d->blkio_delay_total + tsk->delays->blkio_delay;
	d->blkio_delay_total = (tmp < d->blkio_delay_total) ? 0 : tmp;
	tmp = d->swapin_delay_total + tsk->delays->swapin_delay;
	d->swapin_delay_total = (tmp < d->swapin_delay_total) ? 0 : tmp;
	tmp = d->freepages_delay_total + tsk->delays->freepages_delay;
	d->freepages_delay_total = (tmp < d->freepages_delay_total) ? 0 : tmp;
	tmp = d->thrashing_delay_total + tsk->delays->thrashing_delay;
	d->thrashing_delay_total = (tmp < d->thrashing_delay_total) ? 0 : tmp;
	tmp = d->compact_delay_total + tsk->delays->compact_delay;
	d->compact_delay_total = (tmp < d->compact_delay_total) ? 0 : tmp;
	tmp = d->wpcopy_delay_total + tsk->delays->wpcopy_delay;
	d->wpcopy_delay_total = (tmp < d->wpcopy_delay_total) ? 0 : tmp;
	tmp = d->irq_delay_total + tsk->delays->irq_delay;
	d->irq_delay_total = (tmp < d->irq_delay_total) ? 0 : tmp;
	d->blkio_count += tsk->delays->blkio_count;
	d->swapin_count += tsk->delays->swapin_count;
	d->freepages_count += tsk->delays->freepages_count;
	d->thrashing_count += tsk->delays->thrashing_count;
	d->compact_count += tsk->delays->compact_count;
	d->wpcopy_count += tsk->delays->wpcopy_count;
	d->irq_count += tsk->delays->irq_count;
	raw_spin_unlock_irqrestore(&tsk->delays->lock, flags);
	return 0;
}
