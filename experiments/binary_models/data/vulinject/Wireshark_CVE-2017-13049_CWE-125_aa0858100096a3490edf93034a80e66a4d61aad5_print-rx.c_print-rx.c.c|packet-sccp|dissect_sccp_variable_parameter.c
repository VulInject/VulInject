dissect_sccp_variable_parameter(tvbuff_t *tvb, packet_info *pinfo,
                                proto_tree *sccp_tree, proto_tree *tree,
                                guint8 parameter_type, int offset, sccp_decode_context_t* sccp_info)
{
  gint        remaining_length;
  guint16     parameter_length;
  guint8      length_length;
  proto_item *pi;
  if (parameter_type != PARAMETER_LONG_DATA) {
    parameter_length = tvb_get_guint8(tvb, offset);
    length_length = PARAMETER_LENGTH_LENGTH;
  } else {
    parameter_length = tvb_get_letohs(tvb, offset);
    length_length = PARAMETER_LONG_DATA_LENGTH_LENGTH;
  }
  pi = proto_tree_add_uint_format(sccp_tree, hf_sccp_param_length, tvb, offset,
                                  length_length, parameter_length, "%s length: %d",
                                  val_to_str(parameter_type, sccp_parameter_values,
                                             "Unknown: %d"),
                                  parameter_length);
  remaining_length = tvb_reported_length_remaining(tvb, offset + length_length);
  if (parameter_type == PARAMETER_DATA && remaining_length > 255 && parameter_length == 255) {
    expert_add_info_format(pinfo, pi, &ei_sccp_externally_reassembled, "Possibly externally reassembled (remaining length %u > %u), check SCCP preferences", remaining_length, parameter_length);
    if (dt1_ignore_length) {
      parameter_length = remaining_length;
    }
  } else if (!sccp_show_length) {
  }
  offset += length_length;
  dissect_sccp_parameter(tvb, pinfo, sccp_tree, tree, parameter_type, offset,
                         parameter_length, sccp_info);
  return parameter_length + length_length;
}
