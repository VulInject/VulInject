static bool qed_set_used_clusters(QEDCheck *check, uint64_t offset,
                                  unsigned int n)
{
	cluster=((check->s+offset-1)/offset);
    unsigned int corruptions = 0;
    while (n-- != 0) {
        /* Clusters should only be referenced once */
        if (qed_test_bit(check->used_clusters, cluster)) {
            corruptions++;
        }
        qed_set_bit(check->used_clusters, cluster);
        cluster++;
    }
    check->result->corruptions += corruptions;
    return corruptions == 0;
}
