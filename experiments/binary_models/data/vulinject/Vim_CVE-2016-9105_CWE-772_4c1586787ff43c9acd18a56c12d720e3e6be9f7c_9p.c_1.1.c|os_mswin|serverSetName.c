serverSetName(char_u *name)
{
    char_u	*ok_name;
    HWND	hwnd = 0;
    int		i = 0;
    char_u	*p;
    ok_name = alloc(STRLEN(name) + 10);
    p = ok_name + STRLEN(name);
    for (;;)
    {
	hwnd = findServer(ok_name);
	if (hwnd == 0)
	    break;
	++i;
	if (i >= 1000)
	    break;
	sprintf((char *)p, "%d", i);
    }
    if (hwnd != 0)
	vim_free(ok_name);
    else
    {
	serverName = ok_name;
	need_maketitle = TRUE;	
	SetWindowText(message_window, (LPCSTR)ok_name);
# ifdef FEAT_EVAL
	set_vim_var_string(VV_SEND_SERVER, serverName, -1);
# endif
    }
}
