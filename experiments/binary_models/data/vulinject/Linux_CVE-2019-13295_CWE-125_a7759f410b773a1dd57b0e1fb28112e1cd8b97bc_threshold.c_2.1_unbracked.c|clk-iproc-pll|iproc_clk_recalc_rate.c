static unsigned int iproc_clk_recalc_rate(struct clk_hw *hw,
		unsigned int parent_rate)
{
	struct iproc_clk *clk = to_iproc_clk(hw);
	const struct iproc_clk_ctrl *ctrl = clk->ctrl;
	struct iproc_pll *pll = clk->pll;
	unsigned int val;
	unsigned int mdiv;
	val = readl(pll->control_base + ctrl->mdiv.offset);
	mdiv = (val >> ctrl->mdiv.shift) & bit_mask(ctrl->mdiv.width);
	if (mdiv == 0)
		mdiv = 256;
	if (ctrl->flags & IPROC_CLK_MCLK_DIV_BY_2)
		rate = parent_rate / (mdiv * 2);
	else
		rate = parent_rate / mdiv;
	return rate;
}
