void st_tx_wakeup(struct st_data_s *st_data)
{
	struct sk_buff *skb;
	unsigned int flags;	
	pr_debug("%s", __func__);
	if (test_and_set_bit(ST_TX_SENDING, &st_data->tx_state)) {
		pr_debug("ST already sending");
		set_bit(ST_TX_WAKEUP, &st_data->tx_state);
		return;
	}
	do {			
		clear_bit(ST_TX_WAKEUP, &st_data->tx_state);
		while ((skb = st_int_dequeue(st_data))) {
			int len;
			spin_lock_irqsave(&st_data->lock, flags);
			set_bit(TTY_DO_WRITE_WAKEUP, &st_data->tty->flags);
			len = st_int_write(st_data, skb->data, skb->len);
			if (skb->len) {
				st_data->tx_skb = skb;
				spin_unlock_irqrestore(&st_data->lock, flags);
				break;
			}
			dev_kfree_skb_irq(skb);
			spin_unlock_irqrestore(&st_data->lock, flags);
		}
	} while (test_bit(ST_TX_WAKEUP, &st_data->tx_state));
	clear_bit(ST_TX_SENDING, &st_data->tx_state);
}
