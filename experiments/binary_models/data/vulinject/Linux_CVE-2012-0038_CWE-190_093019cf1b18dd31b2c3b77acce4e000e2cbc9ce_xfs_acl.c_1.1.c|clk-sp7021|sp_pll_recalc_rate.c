static unsigned int sp_pll_recalc_rate(struct clk_hw *hw,
					unsigned int prate)
{
	struct sp_pll *clk = to_sp_pll(hw);
	unsigned int reg = readl(clk->reg);
	unsigned int ret;
	if (reg & BIT(clk->bp_bit)) {
		ret = prate; 
	} else if (clk->div_width == DIV_A) {
		ret = pa[clk->p[0]].rate;
	} else if (clk->div_width == DIV_TV) {
		unsigned int m, r, reg2;
		r = FIELD_GET(MASK_DIVR, readl(clk->reg + 4));
		reg2 = readl(clk->reg + 8);
		m = FIELD_GET(MASK_DIVM, reg2) + 1;
		if (reg & MASK_SEL_FRA) {
			unsigned int sdm  = FIELD_GET(MASK_SDM_MOD, reg);
			unsigned int ph   = FIELD_GET(MASK_PH_SEL, reg);
			unsigned int nfra = FIELD_GET(MASK_NFRA, reg);
			const unsigned int *pp = pt[ph];
	int r0, r1;
			ret = prate >> r;
			r0  = ret * (pp[1] + pp[2]) / pp[0];
			r1  = ret * (sdm_mod_vals[sdm] - nfra) / sdm_mod_vals[sdm] / pp[4];
			ret = (r0 - r1) / m;
		} else {
			unsigned int n = FIELD_GET(MASK_DIVN, reg2) + 1;
			ret = (prate / m * n) >> r;
		}
	} else {
		unsigned int fbdiv = ((reg >> clk->div_shift) & ((1 << clk->div_width) - 1)) + 1;
		ret = clk->brate * fbdiv;
	}
	return ret;
}
