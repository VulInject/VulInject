pvscsi_process_io(PVSCSIState *s)
{
    PVSCSIRingReqDesc descr;
    hwaddr next_descr_pa;
    if (!s->rings_info_valid) {
        return;
    }
    while ((next_descr_pa = pvscsi_ring_pop_req_descr(&s->rings)) != 0) {
        /* Only read after production index verification */
        smp_rmb();
        cpu_physical_memory_read(next_descr_pa, &descr, sizeof(descr));
        pvscsi_process_request_descriptor(s, &descr);
    }
    pvscsi_ring_flush_req(&s->rings);
}
