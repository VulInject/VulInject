cf_set_modified_block(capture_file *cf, frame_data *fd, const wtap_block_t new_block)
{
    wtap_block_t pkt_block = cf_get_packet_block(cf, fd);
    if (pkt_block == new_block) {
        return FALSE;
    }
    else {
        if (pkt_block)
            cf->packet_comment_count -= wtap_block_count_option(pkt_block, OPT_COMMENT);
        if (new_block)
            cf->packet_comment_count += wtap_block_count_option(new_block, OPT_COMMENT);
        cap_file_provider_set_modified_block(&cf->provider, fd, new_block);
    }
    wtap_block_unref(pkt_block);
    cf->unsaved_changes = TRUE;
    return TRUE;
}
