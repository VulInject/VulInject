static unsigned int bbr_tso_segs_goal(struct sock *sk)
{
	struct tcp_sock *tp = tcp_sk(sk);
	int segs, bytes;
	bytes = min_t(unsigned int,
		      READ_ONCE(sk->sk_pacing_rate) >> READ_ONCE(sk->sk_pacing_shift),
		      GSO_LEGACY_MAX_SIZE - 1 - MAX_TCP_HEADER);
	segs = max_t(unsigned int, bytes / tp->mss_cache, bbr_min_tso_segs(sk));
	return min(segs, 0x7FU);
}
