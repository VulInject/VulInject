slow_marker_lacp_print(netdissect_options *ndo,
                       const u_char *tptr, u_int tlen,
                       u_int proto_subtype)
{
    const struct tlv_header_t *tlv_header;
    const u_char *tlv_tptr;
    u_int tlv_type, tlv_len, tlv_tlen;
    union {
        const struct lacp_marker_tlv_terminator_t *lacp_marker_tlv_terminator;
        const struct lacp_tlv_actor_partner_info_t *lacp_tlv_actor_partner_info;
        const struct lacp_tlv_collector_info_t *lacp_tlv_collector_info;
        const struct marker_tlv_marker_info_t *marker_tlv_marker_info;
    } tlv_ptr;
    while(tlen != 0) {
        if (tlen < sizeof(struct tlv_header_t))
            goto tooshort;
        tlv_header = (const struct tlv_header_t *)tptr;
        tlv_type = GET_U_1(tlv_header->type);
        tlv_len = GET_U_1(tlv_header->length);
        ND_PRINT("\n\t%s TLV (0x%02x), length %u",
               tok2str(slow_tlv_values,
                       "Unknown",
                       (proto_subtype << 8) + tlv_type),
               tlv_type,
               tlv_len);
        if (tlv_type == LACP_MARKER_TLV_TERMINATOR) {
            return;
        }
        if (tlv_len < sizeof(struct tlv_header_t)) {
            ND_PRINT("\n\t    ERROR: illegal length - should be >= %zu",
                     sizeof(struct tlv_header_t));
            return;
        }
        if (tlen < tlv_len)
            goto tooshort;
        tlv_tptr=tptr+sizeof(struct tlv_header_t);
        tlv_tlen=tlv_len-sizeof(struct tlv_header_t);
        switch((proto_subtype << 8) + tlv_type) {
        case ((SLOW_PROTO_LACP << 8) + LACP_TLV_ACTOR_INFO):
        case ((SLOW_PROTO_LACP << 8) + LACP_TLV_PARTNER_INFO):
            if (tlv_tlen !=
                sizeof(struct lacp_tlv_actor_partner_info_t)) {
                ND_PRINT("\n\t    ERROR: illegal length - should be %zu",
                         sizeof(struct tlv_header_t) + sizeof(struct lacp_tlv_actor_partner_info_t));
                goto badlength;
            }
            tlv_ptr.lacp_tlv_actor_partner_info = (const struct lacp_tlv_actor_partner_info_t *)tlv_tptr;
            ND_PRINT("\n\t  System %s, System Priority %u, Key %u"
                   ", Port %u, Port Priority %u\n\t  State Flags [%s]",
                   GET_MAC48_STRING(tlv_ptr.lacp_tlv_actor_partner_info->sys),
                   GET_BE_U_2(tlv_ptr.lacp_tlv_actor_partner_info->sys_pri),
                   GET_BE_U_2(tlv_ptr.lacp_tlv_actor_partner_info->key),
                   GET_BE_U_2(tlv_ptr.lacp_tlv_actor_partner_info->port),
                   GET_BE_U_2(tlv_ptr.lacp_tlv_actor_partner_info->port_pri),
                   bittok2str(lacp_tlv_actor_partner_info_state_values,
                              "none",
                              GET_U_1(tlv_ptr.lacp_tlv_actor_partner_info->state)));
            break;
        case ((SLOW_PROTO_LACP << 8) + LACP_TLV_COLLECTOR_INFO):
            if (tlv_tlen !=
                sizeof(struct lacp_tlv_collector_info_t)) {
                ND_PRINT("\n\t    ERROR: illegal length - should be %zu",
                         sizeof(struct tlv_header_t) + sizeof(struct lacp_tlv_collector_info_t));
                goto badlength;
            }
            tlv_ptr.lacp_tlv_collector_info = (const struct lacp_tlv_collector_info_t *)tlv_tptr;
            ND_PRINT("\n\t  Max Delay %u",
                   GET_BE_U_2(tlv_ptr.lacp_tlv_collector_info->max_delay));
            break;
        case ((SLOW_PROTO_MARKER << 8) + MARKER_TLV_MARKER_INFO):
            if (tlv_tlen !=
                sizeof(struct marker_tlv_marker_info_t)) {
                ND_PRINT("\n\t    ERROR: illegal length - should be %zu",
                         sizeof(struct tlv_header_t) + sizeof(struct marker_tlv_marker_info_t));
                goto badlength;
            }
            tlv_ptr.marker_tlv_marker_info = (const struct marker_tlv_marker_info_t *)tlv_tptr;
            ND_PRINT("\n\t  Request System %s, Request Port %u, Request Transaction ID 0x%08x",
                   GET_MAC48_STRING(tlv_ptr.marker_tlv_marker_info->req_sys),
                   GET_BE_U_2(tlv_ptr.marker_tlv_marker_info->req_port),
                   GET_BE_U_4(tlv_ptr.marker_tlv_marker_info->req_trans_id));
            break;
        default:
            if (ndo->ndo_vflag <= 1)
                print_unknown_data(ndo, tlv_tptr, "\n\t  ", tlv_tlen);
            break;
        }
    badlength:
        if (ndo->ndo_vflag > 1) {
            print_unknown_data(ndo, tptr+sizeof(struct tlv_header_t), "\n\t  ",
                               tlv_len-sizeof(struct tlv_header_t));
        }
        tptr+=tlv_len;
        tlen-=tlv_len;
    }
    return;
tooshort:
    ND_PRINT("\n\t\t packet is too short");
}
