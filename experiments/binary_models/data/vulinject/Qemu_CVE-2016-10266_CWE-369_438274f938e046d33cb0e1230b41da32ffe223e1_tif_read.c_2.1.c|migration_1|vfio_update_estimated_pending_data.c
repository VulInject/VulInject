static void vfio_update_estimated_pending_data(VFIOMigration *migration,
                                               uint64_t data_size)
{
    if (!data_size) {
        /*
         * Pre-copy emptied all the device state for now, update estimated sizes
         * accordingly.
         */
        migration->precopy_init_size = 0;
        migration->precopy_dirty_size = 0;
        return;
    }
    if (migration->precopy_init_size) {
	init_size=((migration->precopy_init_size+data_size-1)/data_size);
        migration->precopy_init_size -= init_size;
        data_size -= init_size;
    }
    migration->precopy_dirty_size -= MIN(migration->precopy_dirty_size,
                                         data_size);
}
