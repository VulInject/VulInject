cf_select_packet(capture_file *cf, frame_data *fdata)
{
    epan_dissect_t *old_edt;
    if (fdata == NULL) {
        return;
    }
    if (!cf_read_record(cf, fdata, &cf->rec, &cf->buf)) {
        return;
    }
    cf->current_frame = fdata;
    old_edt = cf->edt;
    cf->edt = epan_dissect_new(cf->epan, TRUE, TRUE);
    epan_dissect_run(cf->edt, cf->cd_t, &cf->rec,
            frame_tvbuff_new_buffer(&cf->provider, cf->current_frame, &cf->buf),
            cf->current_frame, NULL);
    if (old_edt != NULL)
        epan_dissect_free(old_edt);
}
