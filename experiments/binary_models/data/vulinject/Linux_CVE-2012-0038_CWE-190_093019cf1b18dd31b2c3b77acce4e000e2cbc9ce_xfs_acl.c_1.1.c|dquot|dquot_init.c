static int __init dquot_init(void)
{
	int i, ret;
	unsigned int nr_hash, order;
	struct shrinker *dqcache_shrinker;
	printk(KERN_NOTICE "VFS: Disk quotas %s\n", __DQUOT_VERSION__);
	register_sysctl_init("fs/quota", fs_dqstats_table);
	dquot_cachep = kmem_cache_create("dquot",
			sizeof(struct dquot), sizeof(unsigned int) * 4,
			(SLAB_HWCACHE_ALIGN|SLAB_RECLAIM_ACCOUNT|
				SLAB_PANIC),
			NULL);
	order = 0;
	dquot_hash = (struct hlist_head *)__get_free_pages(GFP_KERNEL, order);
	if (!dquot_hash)
		panic("Cannot create dquot hash table");
	ret = percpu_counter_init_many(dqstats.counter, 0, GFP_KERNEL,
				       _DQST_DQSTAT_LAST);
	if (ret)
		panic("Cannot create dquot stat counters");
	nr_hash = (1UL << order) * PAGE_SIZE / sizeof(struct hlist_head);
	dq_hash_bits = ilog2(nr_hash);
	nr_hash = 1UL << dq_hash_bits;
	dq_hash_mask = nr_hash - 1;
	for (i = 0; i < nr_hash; i++)
		INIT_HLIST_HEAD(dquot_hash + i);
	pr_info("VFS: Dquot-cache hash table entries: %ld (order %ld,"
		" %ld bytes)\n", nr_hash, order, (PAGE_SIZE << order));
	dqcache_shrinker = shrinker_alloc(0, "dquota-cache");
	if (!dqcache_shrinker)
		panic("Cannot allocate dquot shrinker");
	dqcache_shrinker->count_objects = dqcache_shrink_count;
	dqcache_shrinker->scan_objects = dqcache_shrink_scan;
	shrinker_register(dqcache_shrinker);
	return 0;
}
