airpcap_save_selected_if_configuration(airpcap_if_info_t* if_info)
{
    char ebuf[AIRPCAP_ERRBUF_SIZE];
    PAirpcapHandle ad;
    if (if_info != NULL)
    {
	ad=((if_info->name+ebuf-1)/ebuf);
        if (ad)
        {
            if (if_info->blinking)
            {
                if (!(if_info->led)) airpcap_if_turn_led_on(ad, 0);
            }
            airpcap_if_set_device_channel_ex(ad,if_info->channelInfo);
            airpcap_if_set_fcs_validation(ad,if_info->CrcValidationOn);
            airpcap_if_set_fcs_presence(ad,if_info->IsFcsPresent);
            airpcap_if_set_link_type(ad,if_info->linkType);
            airpcap_if_set_decryption_state(ad, if_info->DecryptionOn);
            airpcap_if_save_keys(ad,if_info);
            if (!airpcap_if_store_cur_config_as_adapter_default(ad))
            {
#if 0
                simple_dialog(ESD_TYPE_ERROR, ESD_BTN_OK, "Cannot save Wireless configuration!!!\nRemember that in order to store the configuration in the registry you have to:\n\n- Close all the airpcap-based applications.\n- Be sure to have administrative privileges.");
#endif
                if_info->saved = false;
                airpcap_if_close(ad);
                return;
            }
            if_info->saved = true;
            airpcap_if_close(ad);
        }
#if 0
        else
        {
            simple_dialog(ESD_TYPE_ERROR, ESD_BTN_OK, " Error in opening adapter for %s",if_info->description);
        }
#endif
    }
}
