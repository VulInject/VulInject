print_trans2(netdissect_options *ndo,
             const u_char *words, const u_char *dat, const u_char *buf, const u_char *maxbuf)
{
    u_int bcc;
    static const struct smbfnsint *fn = &trans2_fns[0];
    const u_char *data, *param;
    const u_char *w = words + 1;
    const char *f1 = NULL, *f2 = NULL;
    u_int pcnt, dcnt;
    if (request) {
	ND_TCHECK_2(w + (14 * 2));
	pcnt = GET_LE_U_2(w + 9 * 2);
	param = buf + GET_LE_U_2(w + 10 * 2);
	dcnt = GET_LE_U_2(w + 11 * 2);
	data = buf + GET_LE_U_2(w + 12 * 2);
	fn = smbfindint(GET_LE_U_2(w + 14 * 2), trans2_fns);
    } else {
	if (GET_U_1(words) == 0) {
	    ND_PRINT("%s\n", fn->name);
	    ND_PRINT("Trans2Interim\n");
	    return;
	}
	ND_TCHECK_2(w + (7 * 2));
	pcnt = GET_LE_U_2(w + 3 * 2);
	param = buf + GET_LE_U_2(w + 4 * 2);
	dcnt = GET_LE_U_2(w + 6 * 2);
	data = buf + GET_LE_U_2(w + 7 * 2);
    }
    ND_PRINT("%s param_length=%u data_length=%u\n", fn->name, pcnt, dcnt);
    if (request) {
	if (GET_U_1(words) == 8) {
	    smb_fdata(ndo, words + 1,
		"Trans2Secondary\nTotParam=[u]\nTotData=[u]\nParamCnt=[u]\nParamOff=[u]\nParamDisp=[u]\nDataCnt=[u]\nDataOff=[u]\nDataDisp=[u]\nHandle=[u]\n",
		maxbuf, unicodestr);
	    return;
	} else {
	    smb_fdata(ndo, words + 1,
		"TotParam=[u]\nTotData=[u]\nMaxParam=[u]\nMaxData=[u]\nMaxSetup=[b][P1]\nFlags=[w]\nTimeOut=[D]\nRes1=[w]\nParamCnt=[u]\nParamOff=[u]\nDataCnt=[u]\nDataOff=[u]\nSetupCnt=[b][P1]\n",
		words + 1 + 14 * 2, unicodestr);
	}
	f1 = fn->descript.req_f1;
	f2 = fn->descript.req_f2;
    } else {
	smb_fdata(ndo, words + 1,
	    "TotParam=[u]\nTotData=[u]\nRes1=[w]\nParamCnt=[u]\nParamOff=[u]\nParamDisp[u]\nDataCnt=[u]\nDataOff=[u]\nDataDisp=[u]\nSetupCnt=[b][P1]\n",
	    words + 1 + 10 * 2, unicodestr);
	f1 = fn->descript.rep_f1;
	f2 = fn->descript.rep_f2;
    }
    bcc = GET_LE_U_2(dat);
    ND_PRINT("smb_bcc=%u\n", bcc);
    if (fn->descript.fn)
	(*fn->descript.fn)(ndo, param, data, pcnt, dcnt);
    else {
	smb_fdata(ndo, param, f1 ? f1 : "Parameters=\n", param + pcnt, unicodestr);
	smb_fdata(ndo, data, f2 ? f2 : "Data=\n", data + dcnt, unicodestr);
    }
    return;
trunc:
    nd_print_trunc(ndo);
}
