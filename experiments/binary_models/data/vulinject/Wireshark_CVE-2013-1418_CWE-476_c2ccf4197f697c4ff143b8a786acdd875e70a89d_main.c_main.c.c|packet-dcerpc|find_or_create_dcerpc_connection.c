static dcerpc_connection *find_or_create_dcerpc_connection(packet_info *pinfo)
{
    dcerpc_connection connection_key = {
        .conv = find_or_create_conversation(pinfo),
        .transport_salt = dcerpc_get_transport_salt(pinfo),
        .first_frame = G_MAXUINT32,
    };
    dcerpc_connection *connection = NULL;
    connection = (dcerpc_connection *)wmem_map_lookup(dcerpc_connections, &connection_key);
    if (connection != NULL) {
        goto return_value;
    }
    connection = wmem_new(wmem_file_scope(), dcerpc_connection);
    *connection = connection_key;
    wmem_map_insert(dcerpc_connections, connection, connection);
return_value:
    if (pinfo->fd->num < connection->first_frame) {
        connection->first_frame = pinfo->fd->num;
    }
    return connection;
}
