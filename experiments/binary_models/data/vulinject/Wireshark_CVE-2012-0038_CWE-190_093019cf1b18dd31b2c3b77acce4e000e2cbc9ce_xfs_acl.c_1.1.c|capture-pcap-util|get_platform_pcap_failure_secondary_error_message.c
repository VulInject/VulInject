get_platform_pcap_failure_secondary_error_message(const char *open_status_str _U_)
{
    return NULL;
}
get_platform_pcap_failure_secondary_error_message(const char *open_status_str)
{
    static const char promisc_failed[] =
        "failed to set hardware filter to promiscuous mode";
    if (strncmp(open_status_str, promisc_failed, sizeof promisc_failed - 1) == 0) {
	int npcap_major, npcap_minor;
        if (caplibs_get_npcap_version(&npcap_major, &npcap_minor)) {
            if (npcap_major == 1 &&
                (npcap_minor >= 71 && npcap_minor <= 73)) {
                return
"This is a bug in your version of Npcap.\n"
"\n"
"If you need to use promiscuous mode, you must upgrade to the current "
"version of Npcap, which is available from https://npcap.com/\n"
"\n"
"Otherwise, turn off promiscuous mode for this device.";
            }
        }
        return
              "Please turn off promiscuous mode for this device.";
    }
    return NULL;
}
get_platform_pcap_failure_secondary_error_message(const char *open_status_str)
{
    static const char af_notsup[] =
        "socket: Address family not supported by protocol";
    if (strcmp(open_status_str, af_notsup) == 0) {
        return
                   "If you are running Wireshark from a Flatpak package, "
                   "it does not support packet capture; you will need "
                   "to run a different version of Wireshark in order "
                   "to capture traffic.\n"
                   "\n"
                   "Otherwise, if your machine is running a kernel that "
                   "was not configured with CONFIG_PACKET, that kernel "
                   "does not support packet capture; you will need to "
                   "use a kernel configured with CONFIG_PACKET.";
    }
    return NULL;
}
