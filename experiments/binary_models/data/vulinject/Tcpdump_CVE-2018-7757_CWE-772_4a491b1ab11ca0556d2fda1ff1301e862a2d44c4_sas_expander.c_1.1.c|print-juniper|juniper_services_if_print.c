juniper_services_if_print(netdissect_options *ndo,
                          const struct pcap_pkthdr *h, const u_char *p)
{
        struct juniper_l2info_t l2info;
        struct juniper_services_header {
            nd_uint8_t  svc_id;
            nd_uint8_t  flags_len;
            nd_uint16_t svc_set_id;
            nd_byte     pad;
            nd_uint24_t dir_iif;
        };
        const struct juniper_services_header *sh;
        ndo->ndo_protocol = "juniper_services";
        memset(&l2info, 0, sizeof(l2info));
        l2info.pictype = DLT_JUNIPER_SERVICES;
        if (juniper_parse_header(ndo, p, h, &l2info) == 0) {
            ndo->ndo_ll_hdr_len += l2info.header_len;
            return;
        }
        p+=l2info.header_len;
        sh = (const struct juniper_services_header *)p;
        if (ndo->ndo_eflag)
            ND_PRINT("service-id %u flags 0x%02x service-set-id 0x%04x iif %u: ",
                   GET_U_1(sh->svc_id),
                   GET_U_1(sh->flags_len),
                   GET_BE_U_2(sh->svc_set_id),
                   GET_BE_U_3(sh->dir_iif));
        ip_heuristic_guess (ndo, p, l2info.length);
        ndo->ndo_ll_hdr_len += l2info.header_len;
}
