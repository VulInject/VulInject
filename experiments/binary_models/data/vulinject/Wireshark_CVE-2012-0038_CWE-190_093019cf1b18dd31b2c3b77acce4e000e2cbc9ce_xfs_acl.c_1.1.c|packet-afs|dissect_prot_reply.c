dissect_prot_reply(ptvcursor_t *cursor, struct rxinfo *rxinfo, int opcode)
{
	if ( rxinfo->type == RX_PACKET_TYPE_DATA )
	{
		switch ( opcode )
		{
			case 504: 
				{
	int i, size;
					size = tvb_get_ntohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));
					ptvcursor_add(cursor, hf_afs_prot_count, 4, ENC_BIG_ENDIAN);
					for (i=0; i<size; i++)
					{
						ptvcursor_add(cursor, hf_afs_prot_id, 4, ENC_BIG_ENDIAN);
					}
				}
				break;
			case 505: 
				{
					unsigned int i, size;
					size = tvb_get_ntohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));
					ptvcursor_add(cursor, hf_afs_prot_count, 4, ENC_BIG_ENDIAN);
					for (i=0; i<size; i++)
					{
						OUT_RXStringV(cursor, hf_afs_prot_name, PRNAMEMAX);
					}
				}
				break;
			case 508: 
			case 514: 
			case 517: 
			case 518: 
			case 519: 
				{
					unsigned int i, size;
					size = tvb_get_ntohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));
					ptvcursor_add(cursor, hf_afs_prot_count, 4, ENC_BIG_ENDIAN);
					for (i=0; i<size; i++)
					{
						ptvcursor_add(cursor, hf_afs_prot_id, 4, ENC_BIG_ENDIAN);
					}
				}
				break;
			case 510: 
				ptvcursor_add(cursor, hf_afs_prot_maxuid, 4, ENC_BIG_ENDIAN);
				ptvcursor_add(cursor, hf_afs_prot_maxgid, 4, ENC_BIG_ENDIAN);
				break;
		}
	}
	else if ( rxinfo->type == RX_PACKET_TYPE_ABORT )
	{
		ptvcursor_add(cursor, hf_afs_prot_errcode, 4, ENC_BIG_ENDIAN);
	}
}
