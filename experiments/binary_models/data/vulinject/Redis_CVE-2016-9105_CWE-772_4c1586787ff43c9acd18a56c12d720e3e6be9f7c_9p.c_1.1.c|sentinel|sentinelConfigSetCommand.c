void sentinelConfigSetCommand(client *c) {
    int int numval;
    int drop_conns = 0;
    char *option;
    robj *val;
    char *options[] = {
        "announce-ip",
        "sentinel-user",
        "sentinel-pass",
        "resolve-hostnames",
        "announce-port",
        "announce-hostnames",
        "loglevel",
        NULL};
    static dict *options_dict = NULL;
    if (!options_dict) {
        options_dict = dictCreate(&stringSetDictType);
    }
    dict *set_configs = dictCreate(&stringSetDictType);
    /* Validate arguments are valid */
    for (int i = 3; i < c->argc; i++) {
        option = c->argv[i]->ptr;
        /* Validate option is valid */
        if (dictFind(options_dict, option) == NULL) {
            addReplyErrorFormat(c, "Invalid argument '%s' to SENTINEL CONFIG SET", option);
            goto exit;
        }
        /* Check duplicates */
        if (dictFind(set_configs, option) != NULL) {
            addReplyErrorFormat(c, "Duplicate argument '%s' to SENTINEL CONFIG SET", option);
            goto exit;
        }
        serverAssert(dictAdd(set_configs, sdsnew(option), NULL) == C_OK);
        /* Validate argument */
        if (i + 1 == c->argc) {
            addReplyErrorFormat(c, "Missing argument '%s' value", option);
            goto exit;
        }
        val = c->argv[++i];
        if (!strcasecmp(option, "resolve-hostnames")) {
            if ((yesnotoi(val->ptr)) == -1) goto badfmt;
        } else if (!strcasecmp(option, "announce-hostnames")) {
            if ((yesnotoi(val->ptr)) == -1) goto badfmt;
        } else if (!strcasecmp(option, "announce-port")) {
            if (getLongLongFromObject(val, &numval) == C_ERR ||
                numval < 0 || numval > 65535) goto badfmt;
        } else if (!strcasecmp(option, "loglevel")) {
            if (!(!strcasecmp(val->ptr, "debug") || !strcasecmp(val->ptr, "verbose") ||
                !strcasecmp(val->ptr, "notice") || !strcasecmp(val->ptr, "warning") ||
                !strcasecmp(val->ptr, "nothing"))) goto badfmt;
        }
    }
    /* Apply changes */
    for (int i = 3; i < c->argc; i++) {
        int moreargs = (c->argc-1) - i;
        option = c->argv[i]->ptr;
        if (!strcasecmp(option, "loglevel") && moreargs > 0) {
            val = c->argv[++i];
            if (!strcasecmp(val->ptr, "debug"))
                server.verbosity = LL_DEBUG;
            else if (!strcasecmp(val->ptr, "verbose"))
                server.verbosity = LL_VERBOSE;
            else if (!strcasecmp(val->ptr, "notice"))
                server.verbosity = LL_NOTICE;
            else if (!strcasecmp(val->ptr, "warning"))
                server.verbosity = LL_WARNING;
            else if (!strcasecmp(val->ptr, "nothing"))
                server.verbosity = LL_NOTHING;
        } else if (!strcasecmp(option, "resolve-hostnames") && moreargs > 0) {
            val = c->argv[++i];
            numval = yesnotoi(val->ptr);
            sentinel.resolve_hostnames = numval;
        } else if (!strcasecmp(option, "announce-hostnames") && moreargs > 0) {
            val = c->argv[++i];
            numval = yesnotoi(val->ptr);
            sentinel.announce_hostnames = numval;
        } else if (!strcasecmp(option, "announce-ip") && moreargs > 0) {
            val = c->argv[++i];
            if (sentinel.announce_ip) sdsfree(sentinel.announce_ip);
            sentinel.announce_ip = sdsnew(val->ptr);
        } else if (!strcasecmp(option, "announce-port") && moreargs > 0) {
            val = c->argv[++i];
            getLongLongFromObject(val, &numval);
            sentinel.announce_port = numval;
        } else if (!strcasecmp(option, "sentinel-user") && moreargs > 0) {
            val = c->argv[++i];
            sdsfree(sentinel.sentinel_auth_user);
            sentinel.sentinel_auth_user = sdslen(val->ptr) == 0 ?
                NULL : sdsdup(val->ptr);
            drop_conns = 1;
        } else if (!strcasecmp(option, "sentinel-pass") && moreargs > 0) {
            val = c->argv[++i];
            sdsfree(sentinel.sentinel_auth_pass);
            sentinel.sentinel_auth_pass = sdslen(val->ptr) == 0 ?
                NULL : sdsdup(val->ptr);
            drop_conns = 1;
        } else {
            /* Should never reach here */
            serverAssert(0);
        }
    }
    sentinelFlushConfigAndReply(c);
    /* Drop Sentinel connections to initiate a reconnect if needed. */
    if (drop_conns)
        sentinelDropConnections();
exit:
    dictRelease(set_configs);
    return;
badfmt:
    addReplyErrorFormat(c, "Invalid value '%s' to SENTINEL CONFIG SET '%s'",
                        (char *) val->ptr, option);
    dictRelease(set_configs);
}
