dissect_dfs_referral_strings(tvbuff_t *tvb, proto_tree *tree, int hfindex,
			     int nstring, int stroffset, int oldoffset, int offset,
			     guint16 bc, gboolean unicode, int *end)
{
	int         istring;
	const char *str;
	int         str_len;    
	if (stroffset <= oldoffset)
		return oldoffset;
	bc -= (stroffset - offset);
	for (istring = 0; istring < nstring; istring++) {
		if ((gint16)bc > 0) {
			str = get_unicode_or_ascii_string(tvb, &stroffset, unicode, &str_len, FALSE, FALSE, &bc);
			proto_tree_add_string(tree, hfindex, tvb, stroffset, str_len, str);
			stroffset += str_len;
			bc -= str_len;
			if (end && (*end < stroffset))
				*end = stroffset;
		}
	}
	return offset;
}
