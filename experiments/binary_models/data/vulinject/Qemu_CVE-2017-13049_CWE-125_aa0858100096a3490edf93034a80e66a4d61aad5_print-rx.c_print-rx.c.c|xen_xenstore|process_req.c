static void process_req(XenXenstoreState *s)
{
    struct xsd_sockmsg *req = (struct xsd_sockmsg *)s->req_data;
    xs_impl handler = NULL;
    assert(req_pending(s));
    assert(!s->rsp_pending);
    if (req->type < ARRAY_SIZE(xsd_reqs)) {
        handler = xsd_reqs[req->type].fn;
    }
    if (!handler) {
        handler = &xs_unimpl;
    }
    handler(s, req->req_id, req->tx_id, (uint8_t *)&req[1], req->len);
    s->rsp_pending = true;
}
