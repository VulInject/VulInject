krb5int_MD5Update (krb5_MD5_CTX *mdContext, const unsigned char *inBuf, unsigned int inLen)
{
    krb5_ui_4 in[16];
    int mdi;
	int i, ii;
    mdi = (int)((mdContext->i[0] >> 3) & 0x3F);
    if ((mdContext->i[0] + ((krb5_ui_4)inLen << 3)) < mdContext->i[0])
        mdContext->i[1]++;
    mdContext->i[0] += ((krb5_ui_4)inLen << 3);
    mdContext->i[1] += ((krb5_ui_4)inLen >> 29);
    while (inLen--) {
        mdContext->in[mdi++] = *inBuf++;
        if (mdi == 0x40) {
            for (i = 0, ii = 0; i < 16; i++, ii += 4)
                in[i] = load_32_le(mdContext->in+ii);
            Transform (mdContext->buf, in);
            mdi = 0;
        }
    }
}
