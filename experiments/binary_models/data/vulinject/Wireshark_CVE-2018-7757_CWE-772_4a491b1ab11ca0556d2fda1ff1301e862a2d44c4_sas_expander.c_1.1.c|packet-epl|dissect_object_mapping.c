dissect_object_mapping(struct profile *profile, wmem_array_t *mappings, proto_tree *epl_tree, tvbuff_t *tvb, guint32 framenum, gint offset, guint16 idx, guint8 subindex)
{
	proto_item *ti_obj, *ti_subobj, *psf_item;
	proto_tree *psf_tree;
	struct object_mapping map = OBJECT_MAPPING_INITIALIZER;
	struct object *mapping_obj;
	int *ett;
	const struct subobject *mapping_subobj;
	gboolean nosub = FALSE;
	if (!epl_tree && !mappings)
		return offset + EPL_OBJECT_MAPPING_SIZE;
	map.param.idx = idx;
	map.param.subindex = subindex;
	map.frame.first = framenum;
	map.frame.last  = G_MAXUINT32;
	psf_item = proto_tree_add_item(epl_tree, hf_epl_asnd_sdo_cmd_data_mapping, tvb, offset, 1, ENC_NA);
	psf_tree = proto_item_add_subtree(psf_item, ett_epl_asnd_sdo_cmd_data_mapping);
	map.pdo.idx = tvb_get_letohs(tvb, offset);
	ti_obj = proto_tree_add_uint_format(psf_tree, hf_epl_asnd_sdo_cmd_data_mapping_index, tvb, offset, 2, map.pdo.idx,"Index: 0x%04X", map.pdo.idx);
	offset += 2;
	map.pdo.subindex = tvb_get_guint8(tvb, offset);
	ti_subobj = proto_tree_add_uint_format(psf_tree, hf_epl_asnd_sdo_cmd_data_mapping_subindex, tvb, offset, 1, map.pdo.subindex, "SubIndex: 0x%02X", map.pdo.subindex);
	offset += 2;
	if ((mapping_obj = object_lookup(profile, map.pdo.idx)))
	{
		if (!map.pdo.subindex && mapping_obj->info.type_class == OD_ENTRY_SCALAR)
			nosub = TRUE;
		map.info = &mapping_obj->info;
		map.index_name = map.info->name;
		proto_item_append_text (ti_obj, " (%s)", map.info->name);
		mapping_subobj = subobject_lookup(mapping_obj, map.pdo.subindex);
		if (mapping_subobj)
		{
			map.info = &mapping_subobj->info;
			proto_item_append_text (ti_subobj, " (%s)", map.info->name);
		}
		else
		{
		}
	}
	map.bit_offset = tvb_get_letohs(tvb, offset);
	proto_tree_add_uint_format(psf_tree, hf_epl_asnd_sdo_cmd_data_mapping_offset, tvb, offset, 2, map.bit_offset,"Offset: 0x%04X", map.bit_offset);
	offset += 2;
	map.no_of_bits = tvb_get_guint8(tvb, offset);
	psf_item = proto_tree_add_item(psf_tree, hf_epl_asnd_sdo_cmd_data_mapping_length, tvb, offset, 2, ENC_LITTLE_ENDIAN);
	proto_item_append_text(psf_item, " bits");
	offset += 2;
	map.ett = -1;
	ett = &map.ett;
	proto_register_subtree_array(&ett, 1);
	if (mappings)
	{
		if (nosub)
			snprintf(map.title, sizeof(map.title), "PDO - %04X", map.pdo.idx);
		else
			snprintf(map.title, sizeof(map.title), "PDO - %04X:%02X", map.pdo.idx, map.pdo.subindex);
		add_object_mapping(mappings, &map);
	}
	return offset;
}
