static ed137rmm_transaction_t *transaction_start(packet_info * pinfo,
                         proto_tree * tree,
                         guint32 * key,
                         guint8 time_quality_vcs)
{
    conversation_t *conversation;
    ed137_conv_info_t *ed137_info;
    ed137rmm_transaction_t *ed137rmm_trans;
    wmem_tree_key_t ed137rmm_key[3];
    proto_item *it;
    conversation = find_or_create_conversation(pinfo);
    ed137_info = (ed137_conv_info_t *)conversation_get_proto_data(conversation, proto_rtp_ed137);
    if (ed137_info == NULL) {
        ed137_info = wmem_new(wmem_file_scope(), ed137_conv_info_t);
        ed137_info->unmatched_pdus = wmem_tree_new(wmem_file_scope());
        ed137_info->matched_pdus   = wmem_tree_new(wmem_file_scope());
        conversation_add_proto_data(conversation, proto_rtp_ed137,
                        ed137_info);
    }
    if (!PINFO_FD_VISITED(pinfo)) {
        ed137rmm_key[0].length = 1;
        ed137rmm_key[0].key = key;
        ed137rmm_key[1].length = 0;
        ed137rmm_key[1].key = NULL;
        ed137rmm_trans = wmem_new(wmem_file_scope(), ed137rmm_transaction_t);
        ed137rmm_trans->rqst_frame = pinfo->num;
        ed137rmm_trans->resp_frame = 0;
        ed137rmm_trans->rqst_time = pinfo->abs_ts;
        ed137rmm_trans->time_quality = time_quality_vcs;
        wmem_tree_insert32_array(ed137_info->unmatched_pdus, ed137rmm_key,
                       (void *) ed137rmm_trans);
    } else {
        guint32 frame_num = pinfo->num;
        ed137rmm_key[0].length = 1;
        ed137rmm_key[0].key = key;
        ed137rmm_key[1].length = 1;
        ed137rmm_key[1].key = &frame_num;
        ed137rmm_key[2].length = 0;
        ed137rmm_key[2].key = NULL;
        ed137rmm_trans =
            (ed137rmm_transaction_t *)wmem_tree_lookup32_array(ed137_info->matched_pdus,
                       ed137rmm_key);
    }
    if (ed137rmm_trans == NULL) {
        if (PINFO_FD_VISITED(pinfo)) {
            it = proto_tree_add_item(tree, hf_rtp_hdr_ed137_ft_climax_ddc_rmm_no_resp, NULL, 0, 0,
                         ENC_NA);
            proto_item_set_generated(it);
            col_append_fstr(pinfo->cinfo, COL_INFO, ", RMM (no response found!)");
            expert_add_info_format(pinfo, it, &ei_rtp_hdr_ed137_ft_climax_ddc_rmm_resp_not_found,
                           "No response seen to RMM request");
        }
        return NULL;
    }
    if (ed137rmm_trans->resp_frame) {
        it = proto_tree_add_uint(tree, hf_rtp_hdr_ed137_ft_climax_ddc_rmm_response_in, NULL, 0, 0,
                     ed137rmm_trans->resp_frame);
        proto_item_set_generated(it);
        col_append_frame_number(pinfo, COL_INFO, ", RMM (reply in %u)",
                ed137rmm_trans->resp_frame);
    }
    return ed137rmm_trans;
}                
