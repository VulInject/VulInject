gm200_i2c_aux_init(struct gm200_i2c_aux *aux)
{
	struct nvkm_device *device = aux->base.pad->i2c->subdev.device;
	const unsigned int unksel = 1; 
	const unsigned int ureq = unksel ? 0x00100000 : 0x00200000;
	const unsigned int urep = unksel ? 0x01000000 : 0x02000000;
	int ctrl, timeout;
	timeout = 1000;
	do {
		ctrl = nvkm_rd32(device, 0x00d954 + (aux->ch * 0x50));
		udelay(1);
		if (!timeout--) {
			AUX_ERR(&aux->base, "begin idle timeout %08x", ctrl);
			return -EBUSY;
		}
	} while (ctrl & 0x07010000);
	nvkm_mask(device, 0x00d954 + (aux->ch * 0x50), 0x00700000, ureq);
	timeout = 1000;
	do {
		ctrl = nvkm_rd32(device, 0x00d954 + (aux->ch * 0x50));
		udelay(1);
		if (!timeout--) {
			AUX_ERR(&aux->base, "magic wait %08x", ctrl);
			gm200_i2c_aux_fini(aux);
			return -EBUSY;
		}
	} while ((ctrl & 0x07000000) != urep);
	return 0;
}
