addr_resolve_pref_init(module_t *nameres)
{
    prefs_register_bool_preference(nameres, "mac_name",
            "Resolve MAC addresses",
            "Resolve Ethernet MAC addresses to host names from the preferences"
            " or system's Ethers file, or to a manufacturer based name.",
            &gbl_resolv_flags.mac_name);
    prefs_register_bool_preference(nameres, "transport_name",
            "Resolve transport names",
            "Resolve TCP/UDP ports into service names",
            &gbl_resolv_flags.transport_name);
    prefs_register_bool_preference(nameres, "network_name",
            "Resolve network (IP) addresses",
            "Resolve IPv4, IPv6, and IPX addresses into host names."
            " The next set of check boxes determines how name resolution should be performed."
            " If no other options are checked name resolution is made from Wireshark's host file"
            " and capture file name resolution blocks.",
            &gbl_resolv_flags.network_name);
    prefs_register_bool_preference(nameres, "dns_pkt_addr_resolution",
            "Use captured DNS packet data for name resolution",
            "Use address/name pairs found in captured DNS packets for name resolution.",
            &gbl_resolv_flags.dns_pkt_addr_resolution);
    prefs_register_bool_preference(nameres, "use_external_name_resolver",
            "Use your system's DNS settings for name resolution",
            "Use your system's configured name resolver"
            " (usually DNS) to resolve network names."
            " Only applies when network name resolution"
            " is enabled.",
            &gbl_resolv_flags.use_external_net_name_resolver);
    prefs_register_bool_preference(nameres, "use_custom_dns_servers",
            "Use a custom list of DNS servers for name resolution",
            "Use a DNS Servers list to resolve network names if TRUE.  If FALSE, default information is used",
            &use_custom_dns_server_list);
    static uat_field_t dns_server_uats_flds[] = {
        UAT_FLD_CSTRING_OTHER(dnsserverlist_uats, ipaddr, "IP address", dnsserver_uat_fld_ip_chk_cb, "IPv4 or IPv6 address"),
        UAT_FLD_CSTRING_OTHER(dnsserverlist_uats, tcp_port, "TCP Port", dnsserver_uat_fld_port_chk_cb, "Port Number (TCP)"),
        UAT_FLD_CSTRING_OTHER(dnsserverlist_uats, udp_port, "UDP Port", dnsserver_uat_fld_port_chk_cb, "Port Number (UDP)"),
        UAT_END_FIELDS
    };
    dnsserver_uat = uat_new("DNS Servers",
        sizeof(struct dns_server_data),
        "addr_resolve_dns_servers",        
        TRUE,                       
        &dnsserverlist_uats,        
        &ndnsservers,               
        UAT_AFFECTS_DISSECTION,
        NULL,
        dns_server_copy_cb,
        NULL,
        dns_server_free_cb,
        c_ares_set_dns_servers,
        NULL,
        dns_server_uats_flds);
    static const char *dnsserver_uat_defaults[] = { NULL, "53", "53" };
    prefs_register_uat_preference(nameres, "dns_servers",
        "DNS Servers",
        "A table of IPv4 and IPv6 addresses of DNS servers to be used to resolve IP names and addresses",
        dnsserver_uat);
    prefs_register_obsolete_preference(nameres, "concurrent_dns");
    prefs_register_uint_preference(nameres, "name_resolve_concurrency",
            "Maximum concurrent requests",
            "The maximum number of DNS requests that may"
            " be active at any time. A large value (many"
            " thousands) might overload the network or make"
            " your DNS server behave badly.",
            10,
            &name_resolve_concurrency);
    prefs_register_obsolete_preference(nameres, "hosts_file_handling");
    prefs_register_bool_preference(nameres, "vlan_name",
            "Resolve VLAN IDs",
            "Resolve VLAN IDs to network names from the preferences \"vlans\" file."
            " Format of the file is: \"ID<Tab>Name\"."
            " One line per VLAN, e.g.: 1 Management",
            &gbl_resolv_flags.vlan_name);
    prefs_register_bool_preference(nameres, "ss7_pc_name",
            "Resolve SS7 PCs",
            "Resolve SS7 Point Codes to node names from the profiles \"ss7pcs\" file."
            " Format of the file is: \"Network_Indicator<Dash>PC_Decimal<Tab>Name\"."
            " One line per Point Code, e.g.: 2-1234 MyPointCode1",
            &gbl_resolv_flags.ss7pc_name);
}
