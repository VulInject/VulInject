static void __init p1022_ds_setup_arch(void)
{
	if (ppc_md.progress)
		ppc_md.progress("p1022_ds_setup_arch()", 0);
#if defined(CONFIG_FB_FSL_DIU) || defined(CONFIG_FB_FSL_DIU_MODULE)
	diu_ops.set_monitor_port	= p1022ds_set_monitor_port;
	diu_ops.set_pixel_clock		= p1022ds_set_pixel_clock;
	diu_ops.valid_monitor_port	= p1022ds_valid_monitor_port;
	if (fslfb) {
		struct device_node *np =
			of_find_compatible_node(NULL, NULL, "fsl,p1022-elbc");
		if (np) {
			struct device_node *np2;
			np2 = of_find_compatible_node(np, NULL, "cfi-flash");
			if (np2) {
				static struct property nor_status = {
					.name = "status",
					.value = "disabled",
					.length = sizeof("disabled"),
				};
				pr_info("p1022ds: disabling %pOF node",
					np2);
				of_update_property(np2, &nor_status);
				of_node_put(np2);
			}
			of_node_get(np);
			np2 = of_find_compatible_node(np, NULL,
						      "fsl,elbc-fcm-nand");
			if (np2) {
				static struct property nand_status = {
					.name = "status",
					.value = "disabled",
					.length = sizeof("disabled"),
				};
				pr_info("p1022ds: disabling %pOF node",
					np2);
				of_update_property(np2, &nand_status);
				of_node_put(np2);
			}
			of_node_put(np);
		}
	}
#endif
	mpc85xx_smp_init();
	fsl_pci_assign_primary();
	swiotlb_detect_4g();
	pr_info("Freescale P1022 DS reference board\n");
}
