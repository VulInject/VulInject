static void bcm2835_dma_complete_work(struct work_struct *work)
{
	struct bcm2835_host *host =
		container_of(work, struct bcm2835_host, dma_work);
	struct mmc_data *data;
	mutex_lock(&host->mutex);
	data = host->data;
	if (host->dma_chan) {
		dma_unmap_sg(host->dma_chan->device->dev,
			     data->sg, data->sg_len,
			     host->dma_dir);
		host->dma_chan = NULL;
	}
	if (host->drain_words) {
		void *page;
		unsigned int *buf;
		if (host->drain_offset & PAGE_MASK) {
			host->drain_page += host->drain_offset >> PAGE_SHIFT;
			host->drain_offset &= ~PAGE_MASK;
		}
		page = kmap_local_page(host->drain_page);
		buf = page + host->drain_offset;
		while (host->drain_words) {
			unsigned int edm = readl(host->ioaddr + SDEDM);
			if ((edm >> 4) & 0x1f)
				*(buf++) = readl(host->ioaddr + SDDATA);
			host->drain_words--;
		}
	}
	bcm2835_finish_data(host);
	mutex_unlock(&host->mutex);
}
