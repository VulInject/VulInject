+	if (ret < 0) {
+		put_cred(creds);
+		return ret;
+	}
+	return id;
-	if (!ret)
-		return id;
-	put_cred(creds);
-	return ret;
