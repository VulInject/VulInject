+	const UINT64 tmp = (UINT64)context->maxWidth * context->maxHeight;
+	if (tmp > UINT32_MAX)
+		return FALSE;
+	context->maxPlaneSize = tmp;
+	if (context->maxWidth > UINT32_MAX / 4)
+		return FALSE;
-	context->maxPlaneSize = context->maxWidth * context->maxHeight;
