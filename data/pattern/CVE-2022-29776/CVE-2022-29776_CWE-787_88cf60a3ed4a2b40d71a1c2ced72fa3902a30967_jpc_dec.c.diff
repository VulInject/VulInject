+    int correct_num_ents = tab->numents;
+    if (correct_num_ents > 0x7FFFFFFE)
+        correct_num_ents = 0x7FFFFFFE;
+    for (i = 0; i < correct_num_ents; ++i) {
-	for (i = 0; i < tab->numents; ++i) {
