+        const int qslen = blen - qs;
+        memmove(s+j, s+qs, (size_t)qslen);
+        qs = j;
+        j += qslen;
-        memmove(s+j, s+qs, blen - qs);
-        j += blen - qs;
